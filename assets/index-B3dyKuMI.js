(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const d of a)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function r(a){const d={};return a.integrity&&(d.integrity=a.integrity),a.referrerPolicy&&(d.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?d.credentials="include":a.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(a){if(a.ep)return;a.ep=!0;const d=r(a);fetch(a.href,d)}})();function vp(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var nc={exports:{}},Ks={},rc={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lh;function Hg(){if(lh)return Le;lh=1;var s=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),h=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),y=Symbol.iterator;function v(w){return w===null||typeof w!="object"?null:(w=y&&w[y]||w["@@iterator"],typeof w=="function"?w:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O=Object.assign,H={};function Z(w,A,te){this.props=w,this.context=A,this.refs=H,this.updater=te||S}Z.prototype.isReactComponent={},Z.prototype.setState=function(w,A){if(typeof w!="object"&&typeof w!="function"&&w!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,w,A,"setState")},Z.prototype.forceUpdate=function(w){this.updater.enqueueForceUpdate(this,w,"forceUpdate")};function le(){}le.prototype=Z.prototype;function se(w,A,te){this.props=w,this.context=A,this.refs=H,this.updater=te||S}var we=se.prototype=new le;we.constructor=se,O(we,Z.prototype),we.isPureReactComponent=!0;var ue=Array.isArray,Ae=Object.prototype.hasOwnProperty,G={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function R(w,A,te){var D,L={},Q=null,me=null;if(A!=null)for(D in A.ref!==void 0&&(me=A.ref),A.key!==void 0&&(Q=""+A.key),A)Ae.call(A,D)&&!M.hasOwnProperty(D)&&(L[D]=A[D]);var Ce=arguments.length-2;if(Ce===1)L.children=te;else if(1<Ce){for(var T=Array(Ce),X=0;X<Ce;X++)T[X]=arguments[X+2];L.children=T}if(w&&w.defaultProps)for(D in Ce=w.defaultProps,Ce)L[D]===void 0&&(L[D]=Ce[D]);return{$$typeof:s,type:w,key:Q,ref:me,props:L,_owner:G.current}}function ye(w,A){return{$$typeof:s,type:w.type,key:A,ref:w.ref,props:w.props,_owner:w._owner}}function P(w){return typeof w=="object"&&w!==null&&w.$$typeof===s}function ee(w){var A={"=":"=0",":":"=2"};return"$"+w.replace(/[=:]/g,function(te){return A[te]})}var ie=/\/+/g;function Ie(w,A){return typeof w=="object"&&w!==null&&w.key!=null?ee(""+w.key):A.toString(36)}function We(w,A,te,D,L){var Q=typeof w;(Q==="undefined"||Q==="boolean")&&(w=null);var me=!1;if(w===null)me=!0;else switch(Q){case"string":case"number":me=!0;break;case"object":switch(w.$$typeof){case s:case t:me=!0}}if(me)return me=w,L=L(me),w=D===""?"."+Ie(me,0):D,ue(L)?(te="",w!=null&&(te=w.replace(ie,"$&/")+"/"),We(L,A,te,"",function(X){return X})):L!=null&&(P(L)&&(L=ye(L,te+(!L.key||me&&me.key===L.key?"":(""+L.key).replace(ie,"$&/")+"/")+w)),A.push(L)),1;if(me=0,D=D===""?".":D+":",ue(w))for(var Ce=0;Ce<w.length;Ce++){Q=w[Ce];var T=D+Ie(Q,Ce);me+=We(Q,A,te,T,L)}else if(T=v(w),typeof T=="function")for(w=T.call(w),Ce=0;!(Q=w.next()).done;)Q=Q.value,T=D+Ie(Q,Ce++),me+=We(Q,A,te,T,L);else if(Q==="object")throw A=String(w),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(w).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.");return me}function lt(w,A,te){if(w==null)return w;var D=[],L=0;return We(w,D,"","",function(Q){return A.call(te,Q,L++)}),D}function Qe(w){if(w._status===-1){var A=w._result;A=A(),A.then(function(te){(w._status===0||w._status===-1)&&(w._status=1,w._result=te)},function(te){(w._status===0||w._status===-1)&&(w._status=2,w._result=te)}),w._status===-1&&(w._status=0,w._result=A)}if(w._status===1)return w._result.default;throw w._result}var ze={current:null},V={transition:null},J={ReactCurrentDispatcher:ze,ReactCurrentBatchConfig:V,ReactCurrentOwner:G};return Le.Children={map:lt,forEach:function(w,A,te){lt(w,function(){A.apply(this,arguments)},te)},count:function(w){var A=0;return lt(w,function(){A++}),A},toArray:function(w){return lt(w,function(A){return A})||[]},only:function(w){if(!P(w))throw Error("React.Children.only expected to receive a single React element child.");return w}},Le.Component=Z,Le.Fragment=r,Le.Profiler=a,Le.PureComponent=se,Le.StrictMode=o,Le.Suspense=g,Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J,Le.cloneElement=function(w,A,te){if(w==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+w+".");var D=O({},w.props),L=w.key,Q=w.ref,me=w._owner;if(A!=null){if(A.ref!==void 0&&(Q=A.ref,me=G.current),A.key!==void 0&&(L=""+A.key),w.type&&w.type.defaultProps)var Ce=w.type.defaultProps;for(T in A)Ae.call(A,T)&&!M.hasOwnProperty(T)&&(D[T]=A[T]===void 0&&Ce!==void 0?Ce[T]:A[T])}var T=arguments.length-2;if(T===1)D.children=te;else if(1<T){Ce=Array(T);for(var X=0;X<T;X++)Ce[X]=arguments[X+2];D.children=Ce}return{$$typeof:s,type:w.type,key:L,ref:Q,props:D,_owner:me}},Le.createContext=function(w){return w={$$typeof:h,_currentValue:w,_currentValue2:w,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},w.Provider={$$typeof:d,_context:w},w.Consumer=w},Le.createElement=R,Le.createFactory=function(w){var A=R.bind(null,w);return A.type=w,A},Le.createRef=function(){return{current:null}},Le.forwardRef=function(w){return{$$typeof:p,render:w}},Le.isValidElement=P,Le.lazy=function(w){return{$$typeof:k,_payload:{_status:-1,_result:w},_init:Qe}},Le.memo=function(w,A){return{$$typeof:x,type:w,compare:A===void 0?null:A}},Le.startTransition=function(w){var A=V.transition;V.transition={};try{w()}finally{V.transition=A}},Le.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},Le.useCallback=function(w,A){return ze.current.useCallback(w,A)},Le.useContext=function(w){return ze.current.useContext(w)},Le.useDebugValue=function(){},Le.useDeferredValue=function(w){return ze.current.useDeferredValue(w)},Le.useEffect=function(w,A){return ze.current.useEffect(w,A)},Le.useId=function(){return ze.current.useId()},Le.useImperativeHandle=function(w,A,te){return ze.current.useImperativeHandle(w,A,te)},Le.useInsertionEffect=function(w,A){return ze.current.useInsertionEffect(w,A)},Le.useLayoutEffect=function(w,A){return ze.current.useLayoutEffect(w,A)},Le.useMemo=function(w,A){return ze.current.useMemo(w,A)},Le.useReducer=function(w,A,te){return ze.current.useReducer(w,A,te)},Le.useRef=function(w){return ze.current.useRef(w)},Le.useState=function(w){return ze.current.useState(w)},Le.useSyncExternalStore=function(w,A,te){return ze.current.useSyncExternalStore(w,A,te)},Le.useTransition=function(){return ze.current.useTransition()},Le.version="18.2.0",Le}var ah;function Fc(){return ah||(ah=1,rc.exports=Hg()),rc.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ch;function Vg(){if(ch)return Ks;ch=1;var s=Fc(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function h(p,g,x){var k,y={},v=null,S=null;x!==void 0&&(v=""+x),g.key!==void 0&&(v=""+g.key),g.ref!==void 0&&(S=g.ref);for(k in g)o.call(g,k)&&!d.hasOwnProperty(k)&&(y[k]=g[k]);if(p&&p.defaultProps)for(k in g=p.defaultProps,g)y[k]===void 0&&(y[k]=g[k]);return{$$typeof:t,type:p,key:v,ref:S,props:y,_owner:a.current}}return Ks.Fragment=r,Ks.jsx=h,Ks.jsxs=h,Ks}var uh;function Yg(){return uh||(uh=1,nc.exports=Vg()),nc.exports}var c=Yg(),$=Fc();const yp=vp($);var Do={},sc={exports:{}},Ft={},ic={exports:{}},oc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dh;function Qg(){return dh||(dh=1,(function(s){function t(V,J){var w=V.length;V.push(J);e:for(;0<w;){var A=w-1>>>1,te=V[A];if(0<a(te,J))V[A]=J,V[w]=te,w=A;else break e}}function r(V){return V.length===0?null:V[0]}function o(V){if(V.length===0)return null;var J=V[0],w=V.pop();if(w!==J){V[0]=w;e:for(var A=0,te=V.length,D=te>>>1;A<D;){var L=2*(A+1)-1,Q=V[L],me=L+1,Ce=V[me];if(0>a(Q,w))me<te&&0>a(Ce,Q)?(V[A]=Ce,V[me]=w,A=me):(V[A]=Q,V[L]=w,A=L);else if(me<te&&0>a(Ce,w))V[A]=Ce,V[me]=w,A=me;else break e}}return J}function a(V,J){var w=V.sortIndex-J.sortIndex;return w!==0?w:V.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;s.unstable_now=function(){return d.now()}}else{var h=Date,p=h.now();s.unstable_now=function(){return h.now()-p}}var g=[],x=[],k=1,y=null,v=3,S=!1,O=!1,H=!1,Z=typeof setTimeout=="function"?setTimeout:null,le=typeof clearTimeout=="function"?clearTimeout:null,se=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function we(V){for(var J=r(x);J!==null;){if(J.callback===null)o(x);else if(J.startTime<=V)o(x),J.sortIndex=J.expirationTime,t(g,J);else break;J=r(x)}}function ue(V){if(H=!1,we(V),!O)if(r(g)!==null)O=!0,Qe(Ae);else{var J=r(x);J!==null&&ze(ue,J.startTime-V)}}function Ae(V,J){O=!1,H&&(H=!1,le(R),R=-1),S=!0;var w=v;try{for(we(J),y=r(g);y!==null&&(!(y.expirationTime>J)||V&&!ee());){var A=y.callback;if(typeof A=="function"){y.callback=null,v=y.priorityLevel;var te=A(y.expirationTime<=J);J=s.unstable_now(),typeof te=="function"?y.callback=te:y===r(g)&&o(g),we(J)}else o(g);y=r(g)}if(y!==null)var D=!0;else{var L=r(x);L!==null&&ze(ue,L.startTime-J),D=!1}return D}finally{y=null,v=w,S=!1}}var G=!1,M=null,R=-1,ye=5,P=-1;function ee(){return!(s.unstable_now()-P<ye)}function ie(){if(M!==null){var V=s.unstable_now();P=V;var J=!0;try{J=M(!0,V)}finally{J?Ie():(G=!1,M=null)}}else G=!1}var Ie;if(typeof se=="function")Ie=function(){se(ie)};else if(typeof MessageChannel<"u"){var We=new MessageChannel,lt=We.port2;We.port1.onmessage=ie,Ie=function(){lt.postMessage(null)}}else Ie=function(){Z(ie,0)};function Qe(V){M=V,G||(G=!0,Ie())}function ze(V,J){R=Z(function(){V(s.unstable_now())},J)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(V){V.callback=null},s.unstable_continueExecution=function(){O||S||(O=!0,Qe(Ae))},s.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ye=0<V?Math.floor(1e3/V):5},s.unstable_getCurrentPriorityLevel=function(){return v},s.unstable_getFirstCallbackNode=function(){return r(g)},s.unstable_next=function(V){switch(v){case 1:case 2:case 3:var J=3;break;default:J=v}var w=v;v=J;try{return V()}finally{v=w}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(V,J){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var w=v;v=V;try{return J()}finally{v=w}},s.unstable_scheduleCallback=function(V,J,w){var A=s.unstable_now();switch(typeof w=="object"&&w!==null?(w=w.delay,w=typeof w=="number"&&0<w?A+w:A):w=A,V){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=w+te,V={id:k++,callback:J,priorityLevel:V,startTime:w,expirationTime:te,sortIndex:-1},w>A?(V.sortIndex=w,t(x,V),r(g)===null&&V===r(x)&&(H?(le(R),R=-1):H=!0,ze(ue,w-A))):(V.sortIndex=te,t(g,V),O||S||(O=!0,Qe(Ae))),V},s.unstable_shouldYield=ee,s.unstable_wrapCallback=function(V){var J=v;return function(){var w=v;v=J;try{return V.apply(this,arguments)}finally{v=w}}}})(oc)),oc}var fh;function Gg(){return fh||(fh=1,ic.exports=Qg()),ic.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hh;function Xg(){if(hh)return Ft;hh=1;var s=Fc(),t=Gg();function r(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)n+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function d(e,n){h(e,n),h(e+"Capture",n)}function h(e,n){for(a[e]=n,e=0;e<n.length;e++)o.add(n[e])}var p=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),g=Object.prototype.hasOwnProperty,x=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,k={},y={};function v(e){return g.call(y,e)?!0:g.call(k,e)?!1:x.test(e)?y[e]=!0:(k[e]=!0,!1)}function S(e,n,i,l){if(i!==null&&i.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return l?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function O(e,n,i,l){if(n===null||typeof n>"u"||S(e,n,i,l))return!0;if(l)return!1;if(i!==null)switch(i.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function H(e,n,i,l,u,f,m){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=l,this.attributeNamespace=u,this.mustUseProperty=i,this.propertyName=e,this.type=n,this.sanitizeURL=f,this.removeEmptyString=m}var Z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Z[e]=new H(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];Z[n]=new H(n,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){Z[e]=new H(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Z[e]=new H(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Z[e]=new H(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){Z[e]=new H(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){Z[e]=new H(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){Z[e]=new H(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){Z[e]=new H(e,5,!1,e.toLowerCase(),null,!1,!1)});var le=/[\-:]([a-z])/g;function se(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(le,se);Z[n]=new H(n,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(le,se);Z[n]=new H(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(le,se);Z[n]=new H(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){Z[e]=new H(e,1,!1,e.toLowerCase(),null,!1,!1)}),Z.xlinkHref=new H("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){Z[e]=new H(e,1,!1,e.toLowerCase(),null,!0,!0)});function we(e,n,i,l){var u=Z.hasOwnProperty(n)?Z[n]:null;(u!==null?u.type!==0:l||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(O(n,i,u,l)&&(i=null),l||u===null?v(n)&&(i===null?e.removeAttribute(n):e.setAttribute(n,""+i)):u.mustUseProperty?e[u.propertyName]=i===null?u.type===3?!1:"":i:(n=u.attributeName,l=u.attributeNamespace,i===null?e.removeAttribute(n):(u=u.type,i=u===3||u===4&&i===!0?"":""+i,l?e.setAttributeNS(l,n,i):e.setAttribute(n,i))))}var ue=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ae=Symbol.for("react.element"),G=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),ye=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),ee=Symbol.for("react.context"),ie=Symbol.for("react.forward_ref"),Ie=Symbol.for("react.suspense"),We=Symbol.for("react.suspense_list"),lt=Symbol.for("react.memo"),Qe=Symbol.for("react.lazy"),ze=Symbol.for("react.offscreen"),V=Symbol.iterator;function J(e){return e===null||typeof e!="object"?null:(e=V&&e[V]||e["@@iterator"],typeof e=="function"?e:null)}var w=Object.assign,A;function te(e){if(A===void 0)try{throw Error()}catch(i){var n=i.stack.trim().match(/\n( *(at )?)/);A=n&&n[1]||""}return`
`+A+e}var D=!1;function L(e,n){if(!e||D)return"";D=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(I){var l=I}Reflect.construct(e,[],n)}else{try{n.call()}catch(I){l=I}e.call(n.prototype)}else{try{throw Error()}catch(I){l=I}e()}}catch(I){if(I&&l&&typeof I.stack=="string"){for(var u=I.stack.split(`
`),f=l.stack.split(`
`),m=u.length-1,_=f.length-1;1<=m&&0<=_&&u[m]!==f[_];)_--;for(;1<=m&&0<=_;m--,_--)if(u[m]!==f[_]){if(m!==1||_!==1)do if(m--,_--,0>_||u[m]!==f[_]){var b=`
`+u[m].replace(" at new "," at ");return e.displayName&&b.includes("<anonymous>")&&(b=b.replace("<anonymous>",e.displayName)),b}while(1<=m&&0<=_);break}}}finally{D=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?te(e):""}function Q(e){switch(e.tag){case 5:return te(e.type);case 16:return te("Lazy");case 13:return te("Suspense");case 19:return te("SuspenseList");case 0:case 2:case 15:return e=L(e.type,!1),e;case 11:return e=L(e.type.render,!1),e;case 1:return e=L(e.type,!0),e;default:return""}}function me(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case M:return"Fragment";case G:return"Portal";case ye:return"Profiler";case R:return"StrictMode";case Ie:return"Suspense";case We:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ee:return(e.displayName||"Context")+".Consumer";case P:return(e._context.displayName||"Context")+".Provider";case ie:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case lt:return n=e.displayName||null,n!==null?n:me(e.type)||"Memo";case Qe:n=e._payload,e=e._init;try{return me(e(n))}catch{}}return null}function Ce(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return me(n);case 8:return n===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function T(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function X(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function de(e){var n=X(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),l=""+e[n];if(!e.hasOwnProperty(n)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var u=i.get,f=i.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return u.call(this)},set:function(m){l=""+m,f.call(this,m)}}),Object.defineProperty(e,n,{enumerable:i.enumerable}),{getValue:function(){return l},setValue:function(m){l=""+m},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function be(e){e._valueTracker||(e._valueTracker=de(e))}function Ct(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var i=n.getValue(),l="";return e&&(l=X(e)?e.checked?"true":"false":e.value),e=l,e!==i?(n.setValue(e),!0):!1}function hn(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function j(e,n){var i=n.checked;return w({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function ae(e,n){var i=n.defaultValue==null?"":n.defaultValue,l=n.checked!=null?n.checked:n.defaultChecked;i=T(n.value!=null?n.value:i),e._wrapperState={initialChecked:l,initialValue:i,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function ge(e,n){n=n.checked,n!=null&&we(e,"checked",n,!1)}function Ee(e,n){ge(e,n);var i=T(n.value),l=n.type;if(i!=null)l==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?Fe(e,n.type,i):n.hasOwnProperty("defaultValue")&&Fe(e,n.type,T(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function Se(e,n,i){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var l=n.type;if(!(l!=="submit"&&l!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,i||n===e.value||(e.value=n),e.defaultValue=n}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function Fe(e,n,i){(n!=="number"||hn(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var je=Array.isArray;function He(e,n,i,l){if(e=e.options,n){n={};for(var u=0;u<i.length;u++)n["$"+i[u]]=!0;for(i=0;i<e.length;i++)u=n.hasOwnProperty("$"+e[i].value),e[i].selected!==u&&(e[i].selected=u),u&&l&&(e[i].defaultSelected=!0)}else{for(i=""+T(i),n=null,u=0;u<e.length;u++){if(e[u].value===i){e[u].selected=!0,l&&(e[u].defaultSelected=!0);return}n!==null||e[u].disabled||(n=e[u])}n!==null&&(n.selected=!0)}}function nt(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(r(91));return w({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function F(e,n){var i=n.value;if(i==null){if(i=n.children,n=n.defaultValue,i!=null){if(n!=null)throw Error(r(92));if(je(i)){if(1<i.length)throw Error(r(93));i=i[0]}n=i}n==null&&(n=""),i=n}e._wrapperState={initialValue:T(i)}}function re(e,n){var i=T(n.value),l=T(n.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),n.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),l!=null&&(e.defaultValue=""+l)}function _e(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function q(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function U(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?q(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var he,Te=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,i,l,u){MSApp.execUnsafeLocalFunction(function(){return e(n,i,l,u)})}:e})(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(he=he||document.createElement("div"),he.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=he.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function Oe(e,n){if(n){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=n;return}}e.textContent=n}var Ye={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},yn=["Webkit","ms","Moz","O"];Object.keys(Ye).forEach(function(e){yn.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),Ye[n]=Ye[e]})});function Ht(e,n,i){return n==null||typeof n=="boolean"||n===""?"":i||typeof n!="number"||n===0||Ye.hasOwnProperty(e)&&Ye[e]?(""+n).trim():n+"px"}function or(e,n){e=e.style;for(var i in n)if(n.hasOwnProperty(i)){var l=i.indexOf("--")===0,u=Ht(i,n[i],l);i==="float"&&(i="cssFloat"),l?e.setProperty(i,u):e[i]=u}}var lr=w({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pl(e,n){if(n){if(lr[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(r(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(r(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(r(61))}if(n.style!=null&&typeof n.style!="object")throw Error(r(62))}}function ml(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gl=null;function xl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var vl=null,Tr=null,Rr=null;function bu(e){if(e=Os(e)){if(typeof vl!="function")throw Error(r(280));var n=e.stateNode;n&&(n=Xi(n),vl(e.stateNode,e.type,n))}}function Nu(e){Tr?Rr?Rr.push(e):Rr=[e]:Tr=e}function ku(){if(Tr){var e=Tr,n=Rr;if(Rr=Tr=null,bu(e),n)for(e=0;e<n.length;e++)bu(n[e])}}function Cu(e,n){return e(n)}function Su(){}var yl=!1;function Eu(e,n,i){if(yl)return e(n,i);yl=!0;try{return Cu(e,n,i)}finally{yl=!1,(Tr!==null||Rr!==null)&&(Su(),ku())}}function ms(e,n){var i=e.stateNode;if(i===null)return null;var l=Xi(i);if(l===null)return null;i=l[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(r(231,n,typeof i));return i}var _l=!1;if(p)try{var gs={};Object.defineProperty(gs,"passive",{get:function(){_l=!0}}),window.addEventListener("test",gs,gs),window.removeEventListener("test",gs,gs)}catch{_l=!1}function qm(e,n,i,l,u,f,m,_,b){var I=Array.prototype.slice.call(arguments,3);try{n.apply(i,I)}catch(B){this.onError(B)}}var xs=!1,Ei=null,ji=!1,wl=null,Km={onError:function(e){xs=!0,Ei=e}};function Jm(e,n,i,l,u,f,m,_,b){xs=!1,Ei=null,qm.apply(Km,arguments)}function Zm(e,n,i,l,u,f,m,_,b){if(Jm.apply(this,arguments),xs){if(xs){var I=Ei;xs=!1,Ei=null}else throw Error(r(198));ji||(ji=!0,wl=I)}}function ar(e){var n=e,i=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(i=n.return),e=n.return;while(e)}return n.tag===3?i:null}function ju(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function Iu(e){if(ar(e)!==e)throw Error(r(188))}function e0(e){var n=e.alternate;if(!n){if(n=ar(e),n===null)throw Error(r(188));return n!==e?null:e}for(var i=e,l=n;;){var u=i.return;if(u===null)break;var f=u.alternate;if(f===null){if(l=u.return,l!==null){i=l;continue}break}if(u.child===f.child){for(f=u.child;f;){if(f===i)return Iu(u),e;if(f===l)return Iu(u),n;f=f.sibling}throw Error(r(188))}if(i.return!==l.return)i=u,l=f;else{for(var m=!1,_=u.child;_;){if(_===i){m=!0,i=u,l=f;break}if(_===l){m=!0,l=u,i=f;break}_=_.sibling}if(!m){for(_=f.child;_;){if(_===i){m=!0,i=f,l=u;break}if(_===l){m=!0,l=f,i=u;break}_=_.sibling}if(!m)throw Error(r(189))}}if(i.alternate!==l)throw Error(r(190))}if(i.tag!==3)throw Error(r(188));return i.stateNode.current===i?e:n}function Tu(e){return e=e0(e),e!==null?Ru(e):null}function Ru(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=Ru(e);if(n!==null)return n;e=e.sibling}return null}var Pu=t.unstable_scheduleCallback,Lu=t.unstable_cancelCallback,t0=t.unstable_shouldYield,n0=t.unstable_requestPaint,at=t.unstable_now,r0=t.unstable_getCurrentPriorityLevel,bl=t.unstable_ImmediatePriority,Mu=t.unstable_UserBlockingPriority,Ii=t.unstable_NormalPriority,s0=t.unstable_LowPriority,Du=t.unstable_IdlePriority,Ti=null,pn=null;function i0(e){if(pn&&typeof pn.onCommitFiberRoot=="function")try{pn.onCommitFiberRoot(Ti,e,void 0,(e.current.flags&128)===128)}catch{}}var tn=Math.clz32?Math.clz32:a0,o0=Math.log,l0=Math.LN2;function a0(e){return e>>>=0,e===0?32:31-(o0(e)/l0|0)|0}var Ri=64,Pi=4194304;function vs(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Li(e,n){var i=e.pendingLanes;if(i===0)return 0;var l=0,u=e.suspendedLanes,f=e.pingedLanes,m=i&268435455;if(m!==0){var _=m&~u;_!==0?l=vs(_):(f&=m,f!==0&&(l=vs(f)))}else m=i&~u,m!==0?l=vs(m):f!==0&&(l=vs(f));if(l===0)return 0;if(n!==0&&n!==l&&(n&u)===0&&(u=l&-l,f=n&-n,u>=f||u===16&&(f&4194240)!==0))return n;if((l&4)!==0&&(l|=i&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=l;0<n;)i=31-tn(n),u=1<<i,l|=e[i],n&=~u;return l}function c0(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function u0(e,n){for(var i=e.suspendedLanes,l=e.pingedLanes,u=e.expirationTimes,f=e.pendingLanes;0<f;){var m=31-tn(f),_=1<<m,b=u[m];b===-1?((_&i)===0||(_&l)!==0)&&(u[m]=c0(_,n)):b<=n&&(e.expiredLanes|=_),f&=~_}}function Nl(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ou(){var e=Ri;return Ri<<=1,(Ri&4194240)===0&&(Ri=64),e}function kl(e){for(var n=[],i=0;31>i;i++)n.push(e);return n}function ys(e,n,i){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-tn(n),e[n]=i}function d0(e,n){var i=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<i;){var u=31-tn(i),f=1<<u;n[u]=0,l[u]=-1,e[u]=-1,i&=~f}}function Cl(e,n){var i=e.entangledLanes|=n;for(e=e.entanglements;i;){var l=31-tn(i),u=1<<l;u&n|e[l]&n&&(e[l]|=n),i&=~u}}var Ve=0;function Au(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var Fu,Sl,zu,$u,Uu,El=!1,Mi=[],Mn=null,Dn=null,On=null,_s=new Map,ws=new Map,An=[],f0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bu(e,n){switch(e){case"focusin":case"focusout":Mn=null;break;case"dragenter":case"dragleave":Dn=null;break;case"mouseover":case"mouseout":On=null;break;case"pointerover":case"pointerout":_s.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":ws.delete(n.pointerId)}}function bs(e,n,i,l,u,f){return e===null||e.nativeEvent!==f?(e={blockedOn:n,domEventName:i,eventSystemFlags:l,nativeEvent:f,targetContainers:[u]},n!==null&&(n=Os(n),n!==null&&Sl(n)),e):(e.eventSystemFlags|=l,n=e.targetContainers,u!==null&&n.indexOf(u)===-1&&n.push(u),e)}function h0(e,n,i,l,u){switch(n){case"focusin":return Mn=bs(Mn,e,n,i,l,u),!0;case"dragenter":return Dn=bs(Dn,e,n,i,l,u),!0;case"mouseover":return On=bs(On,e,n,i,l,u),!0;case"pointerover":var f=u.pointerId;return _s.set(f,bs(_s.get(f)||null,e,n,i,l,u)),!0;case"gotpointercapture":return f=u.pointerId,ws.set(f,bs(ws.get(f)||null,e,n,i,l,u)),!0}return!1}function Wu(e){var n=cr(e.target);if(n!==null){var i=ar(n);if(i!==null){if(n=i.tag,n===13){if(n=ju(i),n!==null){e.blockedOn=n,Uu(e.priority,function(){zu(i)});return}}else if(n===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Di(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var i=Il(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var l=new i.constructor(i.type,i);gl=l,i.target.dispatchEvent(l),gl=null}else return n=Os(i),n!==null&&Sl(n),e.blockedOn=i,!1;n.shift()}return!0}function Hu(e,n,i){Di(e)&&i.delete(n)}function p0(){El=!1,Mn!==null&&Di(Mn)&&(Mn=null),Dn!==null&&Di(Dn)&&(Dn=null),On!==null&&Di(On)&&(On=null),_s.forEach(Hu),ws.forEach(Hu)}function Ns(e,n){e.blockedOn===n&&(e.blockedOn=null,El||(El=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,p0)))}function ks(e){function n(u){return Ns(u,e)}if(0<Mi.length){Ns(Mi[0],e);for(var i=1;i<Mi.length;i++){var l=Mi[i];l.blockedOn===e&&(l.blockedOn=null)}}for(Mn!==null&&Ns(Mn,e),Dn!==null&&Ns(Dn,e),On!==null&&Ns(On,e),_s.forEach(n),ws.forEach(n),i=0;i<An.length;i++)l=An[i],l.blockedOn===e&&(l.blockedOn=null);for(;0<An.length&&(i=An[0],i.blockedOn===null);)Wu(i),i.blockedOn===null&&An.shift()}var Pr=ue.ReactCurrentBatchConfig,Oi=!0;function m0(e,n,i,l){var u=Ve,f=Pr.transition;Pr.transition=null;try{Ve=1,jl(e,n,i,l)}finally{Ve=u,Pr.transition=f}}function g0(e,n,i,l){var u=Ve,f=Pr.transition;Pr.transition=null;try{Ve=4,jl(e,n,i,l)}finally{Ve=u,Pr.transition=f}}function jl(e,n,i,l){if(Oi){var u=Il(e,n,i,l);if(u===null)Yl(e,n,l,Ai,i),Bu(e,l);else if(h0(u,e,n,i,l))l.stopPropagation();else if(Bu(e,l),n&4&&-1<f0.indexOf(e)){for(;u!==null;){var f=Os(u);if(f!==null&&Fu(f),f=Il(e,n,i,l),f===null&&Yl(e,n,l,Ai,i),f===u)break;u=f}u!==null&&l.stopPropagation()}else Yl(e,n,l,null,i)}}var Ai=null;function Il(e,n,i,l){if(Ai=null,e=xl(l),e=cr(e),e!==null)if(n=ar(e),n===null)e=null;else if(i=n.tag,i===13){if(e=ju(n),e!==null)return e;e=null}else if(i===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Ai=e,null}function Vu(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(r0()){case bl:return 1;case Mu:return 4;case Ii:case s0:return 16;case Du:return 536870912;default:return 16}default:return 16}}var Fn=null,Tl=null,Fi=null;function Yu(){if(Fi)return Fi;var e,n=Tl,i=n.length,l,u="value"in Fn?Fn.value:Fn.textContent,f=u.length;for(e=0;e<i&&n[e]===u[e];e++);var m=i-e;for(l=1;l<=m&&n[i-l]===u[f-l];l++);return Fi=u.slice(e,1<l?1-l:void 0)}function zi(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function $i(){return!0}function Qu(){return!1}function Vt(e){function n(i,l,u,f,m){this._reactName=i,this._targetInst=u,this.type=l,this.nativeEvent=f,this.target=m,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(i=e[_],this[_]=i?i(f):f[_]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?$i:Qu,this.isPropagationStopped=Qu,this}return w(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=$i)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=$i)},persist:function(){},isPersistent:$i}),n}var Lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rl=Vt(Lr),Cs=w({},Lr,{view:0,detail:0}),x0=Vt(Cs),Pl,Ll,Ss,Ui=w({},Cs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Dl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ss&&(Ss&&e.type==="mousemove"?(Pl=e.screenX-Ss.screenX,Ll=e.screenY-Ss.screenY):Ll=Pl=0,Ss=e),Pl)},movementY:function(e){return"movementY"in e?e.movementY:Ll}}),Gu=Vt(Ui),v0=w({},Ui,{dataTransfer:0}),y0=Vt(v0),_0=w({},Cs,{relatedTarget:0}),Ml=Vt(_0),w0=w({},Lr,{animationName:0,elapsedTime:0,pseudoElement:0}),b0=Vt(w0),N0=w({},Lr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),k0=Vt(N0),C0=w({},Lr,{data:0}),Xu=Vt(C0),S0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},E0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},j0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function I0(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=j0[e])?!!n[e]:!1}function Dl(){return I0}var T0=w({},Cs,{key:function(e){if(e.key){var n=S0[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=zi(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?E0[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Dl,charCode:function(e){return e.type==="keypress"?zi(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?zi(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),R0=Vt(T0),P0=w({},Ui,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qu=Vt(P0),L0=w({},Cs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Dl}),M0=Vt(L0),D0=w({},Lr,{propertyName:0,elapsedTime:0,pseudoElement:0}),O0=Vt(D0),A0=w({},Ui,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),F0=Vt(A0),z0=[9,13,27,32],Ol=p&&"CompositionEvent"in window,Es=null;p&&"documentMode"in document&&(Es=document.documentMode);var $0=p&&"TextEvent"in window&&!Es,Ku=p&&(!Ol||Es&&8<Es&&11>=Es),Ju=" ",Zu=!1;function ed(e,n){switch(e){case"keyup":return z0.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function td(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Mr=!1;function U0(e,n){switch(e){case"compositionend":return td(n);case"keypress":return n.which!==32?null:(Zu=!0,Ju);case"textInput":return e=n.data,e===Ju&&Zu?null:e;default:return null}}function B0(e,n){if(Mr)return e==="compositionend"||!Ol&&ed(e,n)?(e=Yu(),Fi=Tl=Fn=null,Mr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Ku&&n.locale!=="ko"?null:n.data;default:return null}}var W0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nd(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!W0[e.type]:n==="textarea"}function rd(e,n,i,l){Nu(l),n=Yi(n,"onChange"),0<n.length&&(i=new Rl("onChange","change",null,i,l),e.push({event:i,listeners:n}))}var js=null,Is=null;function H0(e){wd(e,0)}function Bi(e){var n=zr(e);if(Ct(n))return e}function V0(e,n){if(e==="change")return n}var sd=!1;if(p){var Al;if(p){var Fl="oninput"in document;if(!Fl){var id=document.createElement("div");id.setAttribute("oninput","return;"),Fl=typeof id.oninput=="function"}Al=Fl}else Al=!1;sd=Al&&(!document.documentMode||9<document.documentMode)}function od(){js&&(js.detachEvent("onpropertychange",ld),Is=js=null)}function ld(e){if(e.propertyName==="value"&&Bi(Is)){var n=[];rd(n,Is,e,xl(e)),Eu(H0,n)}}function Y0(e,n,i){e==="focusin"?(od(),js=n,Is=i,js.attachEvent("onpropertychange",ld)):e==="focusout"&&od()}function Q0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Bi(Is)}function G0(e,n){if(e==="click")return Bi(n)}function X0(e,n){if(e==="input"||e==="change")return Bi(n)}function q0(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var nn=typeof Object.is=="function"?Object.is:q0;function Ts(e,n){if(nn(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var i=Object.keys(e),l=Object.keys(n);if(i.length!==l.length)return!1;for(l=0;l<i.length;l++){var u=i[l];if(!g.call(n,u)||!nn(e[u],n[u]))return!1}return!0}function ad(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cd(e,n){var i=ad(e);e=0;for(var l;i;){if(i.nodeType===3){if(l=e+i.textContent.length,e<=n&&l>=n)return{node:i,offset:n-e};e=l}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ad(i)}}function ud(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?ud(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function dd(){for(var e=window,n=hn();n instanceof e.HTMLIFrameElement;){try{var i=typeof n.contentWindow.location.href=="string"}catch{i=!1}if(i)e=n.contentWindow;else break;n=hn(e.document)}return n}function zl(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function K0(e){var n=dd(),i=e.focusedElem,l=e.selectionRange;if(n!==i&&i&&i.ownerDocument&&ud(i.ownerDocument.documentElement,i)){if(l!==null&&zl(i)){if(n=l.start,e=l.end,e===void 0&&(e=n),"selectionStart"in i)i.selectionStart=n,i.selectionEnd=Math.min(e,i.value.length);else if(e=(n=i.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var u=i.textContent.length,f=Math.min(l.start,u);l=l.end===void 0?f:Math.min(l.end,u),!e.extend&&f>l&&(u=l,l=f,f=u),u=cd(i,f);var m=cd(i,l);u&&m&&(e.rangeCount!==1||e.anchorNode!==u.node||e.anchorOffset!==u.offset||e.focusNode!==m.node||e.focusOffset!==m.offset)&&(n=n.createRange(),n.setStart(u.node,u.offset),e.removeAllRanges(),f>l?(e.addRange(n),e.extend(m.node,m.offset)):(n.setEnd(m.node,m.offset),e.addRange(n)))}}for(n=[],e=i;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<n.length;i++)e=n[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var J0=p&&"documentMode"in document&&11>=document.documentMode,Dr=null,$l=null,Rs=null,Ul=!1;function fd(e,n,i){var l=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Ul||Dr==null||Dr!==hn(l)||(l=Dr,"selectionStart"in l&&zl(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Rs&&Ts(Rs,l)||(Rs=l,l=Yi($l,"onSelect"),0<l.length&&(n=new Rl("onSelect","select",null,n,i),e.push({event:n,listeners:l}),n.target=Dr)))}function Wi(e,n){var i={};return i[e.toLowerCase()]=n.toLowerCase(),i["Webkit"+e]="webkit"+n,i["Moz"+e]="moz"+n,i}var Or={animationend:Wi("Animation","AnimationEnd"),animationiteration:Wi("Animation","AnimationIteration"),animationstart:Wi("Animation","AnimationStart"),transitionend:Wi("Transition","TransitionEnd")},Bl={},hd={};p&&(hd=document.createElement("div").style,"AnimationEvent"in window||(delete Or.animationend.animation,delete Or.animationiteration.animation,delete Or.animationstart.animation),"TransitionEvent"in window||delete Or.transitionend.transition);function Hi(e){if(Bl[e])return Bl[e];if(!Or[e])return e;var n=Or[e],i;for(i in n)if(n.hasOwnProperty(i)&&i in hd)return Bl[e]=n[i];return e}var pd=Hi("animationend"),md=Hi("animationiteration"),gd=Hi("animationstart"),xd=Hi("transitionend"),vd=new Map,yd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zn(e,n){vd.set(e,n),d(n,[e])}for(var Wl=0;Wl<yd.length;Wl++){var Hl=yd[Wl],Z0=Hl.toLowerCase(),eg=Hl[0].toUpperCase()+Hl.slice(1);zn(Z0,"on"+eg)}zn(pd,"onAnimationEnd"),zn(md,"onAnimationIteration"),zn(gd,"onAnimationStart"),zn("dblclick","onDoubleClick"),zn("focusin","onFocus"),zn("focusout","onBlur"),zn(xd,"onTransitionEnd"),h("onMouseEnter",["mouseout","mouseover"]),h("onMouseLeave",["mouseout","mouseover"]),h("onPointerEnter",["pointerout","pointerover"]),h("onPointerLeave",["pointerout","pointerover"]),d("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),d("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),d("onBeforeInput",["compositionend","keypress","textInput","paste"]),d("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ps="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tg=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ps));function _d(e,n,i){var l=e.type||"unknown-event";e.currentTarget=i,Zm(l,n,void 0,e),e.currentTarget=null}function wd(e,n){n=(n&4)!==0;for(var i=0;i<e.length;i++){var l=e[i],u=l.event;l=l.listeners;e:{var f=void 0;if(n)for(var m=l.length-1;0<=m;m--){var _=l[m],b=_.instance,I=_.currentTarget;if(_=_.listener,b!==f&&u.isPropagationStopped())break e;_d(u,_,I),f=b}else for(m=0;m<l.length;m++){if(_=l[m],b=_.instance,I=_.currentTarget,_=_.listener,b!==f&&u.isPropagationStopped())break e;_d(u,_,I),f=b}}}if(ji)throw e=wl,ji=!1,wl=null,e}function Je(e,n){var i=n[Jl];i===void 0&&(i=n[Jl]=new Set);var l=e+"__bubble";i.has(l)||(bd(n,e,2,!1),i.add(l))}function Vl(e,n,i){var l=0;n&&(l|=4),bd(i,e,l,n)}var Vi="_reactListening"+Math.random().toString(36).slice(2);function Ls(e){if(!e[Vi]){e[Vi]=!0,o.forEach(function(i){i!=="selectionchange"&&(tg.has(i)||Vl(i,!1,e),Vl(i,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Vi]||(n[Vi]=!0,Vl("selectionchange",!1,n))}}function bd(e,n,i,l){switch(Vu(n)){case 1:var u=m0;break;case 4:u=g0;break;default:u=jl}i=u.bind(null,n,i,e),u=void 0,!_l||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(u=!0),l?u!==void 0?e.addEventListener(n,i,{capture:!0,passive:u}):e.addEventListener(n,i,!0):u!==void 0?e.addEventListener(n,i,{passive:u}):e.addEventListener(n,i,!1)}function Yl(e,n,i,l,u){var f=l;if((n&1)===0&&(n&2)===0&&l!==null)e:for(;;){if(l===null)return;var m=l.tag;if(m===3||m===4){var _=l.stateNode.containerInfo;if(_===u||_.nodeType===8&&_.parentNode===u)break;if(m===4)for(m=l.return;m!==null;){var b=m.tag;if((b===3||b===4)&&(b=m.stateNode.containerInfo,b===u||b.nodeType===8&&b.parentNode===u))return;m=m.return}for(;_!==null;){if(m=cr(_),m===null)return;if(b=m.tag,b===5||b===6){l=f=m;continue e}_=_.parentNode}}l=l.return}Eu(function(){var I=f,B=xl(i),W=[];e:{var z=vd.get(e);if(z!==void 0){var ne=Rl,ce=e;switch(e){case"keypress":if(zi(i)===0)break e;case"keydown":case"keyup":ne=R0;break;case"focusin":ce="focus",ne=Ml;break;case"focusout":ce="blur",ne=Ml;break;case"beforeblur":case"afterblur":ne=Ml;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ne=Gu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ne=y0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ne=M0;break;case pd:case md:case gd:ne=b0;break;case xd:ne=O0;break;case"scroll":ne=x0;break;case"wheel":ne=F0;break;case"copy":case"cut":case"paste":ne=k0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ne=qu}var fe=(n&4)!==0,ct=!fe&&e==="scroll",C=fe?z!==null?z+"Capture":null:z;fe=[];for(var N=I,E;N!==null;){E=N;var Y=E.stateNode;if(E.tag===5&&Y!==null&&(E=Y,C!==null&&(Y=ms(N,C),Y!=null&&fe.push(Ms(N,Y,E)))),ct)break;N=N.return}0<fe.length&&(z=new ne(z,ce,null,i,B),W.push({event:z,listeners:fe}))}}if((n&7)===0){e:{if(z=e==="mouseover"||e==="pointerover",ne=e==="mouseout"||e==="pointerout",z&&i!==gl&&(ce=i.relatedTarget||i.fromElement)&&(cr(ce)||ce[_n]))break e;if((ne||z)&&(z=B.window===B?B:(z=B.ownerDocument)?z.defaultView||z.parentWindow:window,ne?(ce=i.relatedTarget||i.toElement,ne=I,ce=ce?cr(ce):null,ce!==null&&(ct=ar(ce),ce!==ct||ce.tag!==5&&ce.tag!==6)&&(ce=null)):(ne=null,ce=I),ne!==ce)){if(fe=Gu,Y="onMouseLeave",C="onMouseEnter",N="mouse",(e==="pointerout"||e==="pointerover")&&(fe=qu,Y="onPointerLeave",C="onPointerEnter",N="pointer"),ct=ne==null?z:zr(ne),E=ce==null?z:zr(ce),z=new fe(Y,N+"leave",ne,i,B),z.target=ct,z.relatedTarget=E,Y=null,cr(B)===I&&(fe=new fe(C,N+"enter",ce,i,B),fe.target=E,fe.relatedTarget=ct,Y=fe),ct=Y,ne&&ce)t:{for(fe=ne,C=ce,N=0,E=fe;E;E=Ar(E))N++;for(E=0,Y=C;Y;Y=Ar(Y))E++;for(;0<N-E;)fe=Ar(fe),N--;for(;0<E-N;)C=Ar(C),E--;for(;N--;){if(fe===C||C!==null&&fe===C.alternate)break t;fe=Ar(fe),C=Ar(C)}fe=null}else fe=null;ne!==null&&Nd(W,z,ne,fe,!1),ce!==null&&ct!==null&&Nd(W,ct,ce,fe,!0)}}e:{if(z=I?zr(I):window,ne=z.nodeName&&z.nodeName.toLowerCase(),ne==="select"||ne==="input"&&z.type==="file")var pe=V0;else if(nd(z))if(sd)pe=X0;else{pe=Q0;var xe=Y0}else(ne=z.nodeName)&&ne.toLowerCase()==="input"&&(z.type==="checkbox"||z.type==="radio")&&(pe=G0);if(pe&&(pe=pe(e,I))){rd(W,pe,i,B);break e}xe&&xe(e,z,I),e==="focusout"&&(xe=z._wrapperState)&&xe.controlled&&z.type==="number"&&Fe(z,"number",z.value)}switch(xe=I?zr(I):window,e){case"focusin":(nd(xe)||xe.contentEditable==="true")&&(Dr=xe,$l=I,Rs=null);break;case"focusout":Rs=$l=Dr=null;break;case"mousedown":Ul=!0;break;case"contextmenu":case"mouseup":case"dragend":Ul=!1,fd(W,i,B);break;case"selectionchange":if(J0)break;case"keydown":case"keyup":fd(W,i,B)}var ve;if(Ol)e:{switch(e){case"compositionstart":var ke="onCompositionStart";break e;case"compositionend":ke="onCompositionEnd";break e;case"compositionupdate":ke="onCompositionUpdate";break e}ke=void 0}else Mr?ed(e,i)&&(ke="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(ke="onCompositionStart");ke&&(Ku&&i.locale!=="ko"&&(Mr||ke!=="onCompositionStart"?ke==="onCompositionEnd"&&Mr&&(ve=Yu()):(Fn=B,Tl="value"in Fn?Fn.value:Fn.textContent,Mr=!0)),xe=Yi(I,ke),0<xe.length&&(ke=new Xu(ke,e,null,i,B),W.push({event:ke,listeners:xe}),ve?ke.data=ve:(ve=td(i),ve!==null&&(ke.data=ve)))),(ve=$0?U0(e,i):B0(e,i))&&(I=Yi(I,"onBeforeInput"),0<I.length&&(B=new Xu("onBeforeInput","beforeinput",null,i,B),W.push({event:B,listeners:I}),B.data=ve))}wd(W,n)})}function Ms(e,n,i){return{instance:e,listener:n,currentTarget:i}}function Yi(e,n){for(var i=n+"Capture",l=[];e!==null;){var u=e,f=u.stateNode;u.tag===5&&f!==null&&(u=f,f=ms(e,i),f!=null&&l.unshift(Ms(e,f,u)),f=ms(e,n),f!=null&&l.push(Ms(e,f,u))),e=e.return}return l}function Ar(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Nd(e,n,i,l,u){for(var f=n._reactName,m=[];i!==null&&i!==l;){var _=i,b=_.alternate,I=_.stateNode;if(b!==null&&b===l)break;_.tag===5&&I!==null&&(_=I,u?(b=ms(i,f),b!=null&&m.unshift(Ms(i,b,_))):u||(b=ms(i,f),b!=null&&m.push(Ms(i,b,_)))),i=i.return}m.length!==0&&e.push({event:n,listeners:m})}var ng=/\r\n?/g,rg=/\u0000|\uFFFD/g;function kd(e){return(typeof e=="string"?e:""+e).replace(ng,`
`).replace(rg,"")}function Qi(e,n,i){if(n=kd(n),kd(e)!==n&&i)throw Error(r(425))}function Gi(){}var Ql=null,Gl=null;function Xl(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var ql=typeof setTimeout=="function"?setTimeout:void 0,sg=typeof clearTimeout=="function"?clearTimeout:void 0,Cd=typeof Promise=="function"?Promise:void 0,ig=typeof queueMicrotask=="function"?queueMicrotask:typeof Cd<"u"?function(e){return Cd.resolve(null).then(e).catch(og)}:ql;function og(e){setTimeout(function(){throw e})}function Kl(e,n){var i=n,l=0;do{var u=i.nextSibling;if(e.removeChild(i),u&&u.nodeType===8)if(i=u.data,i==="/$"){if(l===0){e.removeChild(u),ks(n);return}l--}else i!=="$"&&i!=="$?"&&i!=="$!"||l++;i=u}while(i);ks(n)}function $n(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function Sd(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(n===0)return e;n--}else i==="/$"&&n++}e=e.previousSibling}return null}var Fr=Math.random().toString(36).slice(2),mn="__reactFiber$"+Fr,Ds="__reactProps$"+Fr,_n="__reactContainer$"+Fr,Jl="__reactEvents$"+Fr,lg="__reactListeners$"+Fr,ag="__reactHandles$"+Fr;function cr(e){var n=e[mn];if(n)return n;for(var i=e.parentNode;i;){if(n=i[_n]||i[mn]){if(i=n.alternate,n.child!==null||i!==null&&i.child!==null)for(e=Sd(e);e!==null;){if(i=e[mn])return i;e=Sd(e)}return n}e=i,i=e.parentNode}return null}function Os(e){return e=e[mn]||e[_n],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function zr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(r(33))}function Xi(e){return e[Ds]||null}var Zl=[],$r=-1;function Un(e){return{current:e}}function Ze(e){0>$r||(e.current=Zl[$r],Zl[$r]=null,$r--)}function Xe(e,n){$r++,Zl[$r]=e.current,e.current=n}var Bn={},St=Un(Bn),Lt=Un(!1),ur=Bn;function Ur(e,n){var i=e.type.contextTypes;if(!i)return Bn;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===n)return l.__reactInternalMemoizedMaskedChildContext;var u={},f;for(f in i)u[f]=n[f];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=u),u}function Mt(e){return e=e.childContextTypes,e!=null}function qi(){Ze(Lt),Ze(St)}function Ed(e,n,i){if(St.current!==Bn)throw Error(r(168));Xe(St,n),Xe(Lt,i)}function jd(e,n,i){var l=e.stateNode;if(n=n.childContextTypes,typeof l.getChildContext!="function")return i;l=l.getChildContext();for(var u in l)if(!(u in n))throw Error(r(108,Ce(e)||"Unknown",u));return w({},i,l)}function Ki(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Bn,ur=St.current,Xe(St,e),Xe(Lt,Lt.current),!0}function Id(e,n,i){var l=e.stateNode;if(!l)throw Error(r(169));i?(e=jd(e,n,ur),l.__reactInternalMemoizedMergedChildContext=e,Ze(Lt),Ze(St),Xe(St,e)):Ze(Lt),Xe(Lt,i)}var wn=null,Ji=!1,ea=!1;function Td(e){wn===null?wn=[e]:wn.push(e)}function cg(e){Ji=!0,Td(e)}function Wn(){if(!ea&&wn!==null){ea=!0;var e=0,n=Ve;try{var i=wn;for(Ve=1;e<i.length;e++){var l=i[e];do l=l(!0);while(l!==null)}wn=null,Ji=!1}catch(u){throw wn!==null&&(wn=wn.slice(e+1)),Pu(bl,Wn),u}finally{Ve=n,ea=!1}}return null}var Br=[],Wr=0,Zi=null,eo=0,Xt=[],qt=0,dr=null,bn=1,Nn="";function fr(e,n){Br[Wr++]=eo,Br[Wr++]=Zi,Zi=e,eo=n}function Rd(e,n,i){Xt[qt++]=bn,Xt[qt++]=Nn,Xt[qt++]=dr,dr=e;var l=bn;e=Nn;var u=32-tn(l)-1;l&=~(1<<u),i+=1;var f=32-tn(n)+u;if(30<f){var m=u-u%5;f=(l&(1<<m)-1).toString(32),l>>=m,u-=m,bn=1<<32-tn(n)+u|i<<u|l,Nn=f+e}else bn=1<<f|i<<u|l,Nn=e}function ta(e){e.return!==null&&(fr(e,1),Rd(e,1,0))}function na(e){for(;e===Zi;)Zi=Br[--Wr],Br[Wr]=null,eo=Br[--Wr],Br[Wr]=null;for(;e===dr;)dr=Xt[--qt],Xt[qt]=null,Nn=Xt[--qt],Xt[qt]=null,bn=Xt[--qt],Xt[qt]=null}var Yt=null,Qt=null,tt=!1,rn=null;function Pd(e,n){var i=en(5,null,null,0);i.elementType="DELETED",i.stateNode=n,i.return=e,n=e.deletions,n===null?(e.deletions=[i],e.flags|=16):n.push(i)}function Ld(e,n){switch(e.tag){case 5:var i=e.type;return n=n.nodeType!==1||i.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,Yt=e,Qt=$n(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,Yt=e,Qt=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(i=dr!==null?{id:bn,overflow:Nn}:null,e.memoizedState={dehydrated:n,treeContext:i,retryLane:1073741824},i=en(18,null,null,0),i.stateNode=n,i.return=e,e.child=i,Yt=e,Qt=null,!0):!1;default:return!1}}function ra(e){return(e.mode&1)!==0&&(e.flags&128)===0}function sa(e){if(tt){var n=Qt;if(n){var i=n;if(!Ld(e,n)){if(ra(e))throw Error(r(418));n=$n(i.nextSibling);var l=Yt;n&&Ld(e,n)?Pd(l,i):(e.flags=e.flags&-4097|2,tt=!1,Yt=e)}}else{if(ra(e))throw Error(r(418));e.flags=e.flags&-4097|2,tt=!1,Yt=e}}}function Md(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Yt=e}function to(e){if(e!==Yt)return!1;if(!tt)return Md(e),tt=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!Xl(e.type,e.memoizedProps)),n&&(n=Qt)){if(ra(e))throw Dd(),Error(r(418));for(;n;)Pd(e,n),n=$n(n.nextSibling)}if(Md(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(r(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(n===0){Qt=$n(e.nextSibling);break e}n--}else i!=="$"&&i!=="$!"&&i!=="$?"||n++}e=e.nextSibling}Qt=null}}else Qt=Yt?$n(e.stateNode.nextSibling):null;return!0}function Dd(){for(var e=Qt;e;)e=$n(e.nextSibling)}function Hr(){Qt=Yt=null,tt=!1}function ia(e){rn===null?rn=[e]:rn.push(e)}var ug=ue.ReactCurrentBatchConfig;function sn(e,n){if(e&&e.defaultProps){n=w({},n),e=e.defaultProps;for(var i in e)n[i]===void 0&&(n[i]=e[i]);return n}return n}var no=Un(null),ro=null,Vr=null,oa=null;function la(){oa=Vr=ro=null}function aa(e){var n=no.current;Ze(no),e._currentValue=n}function ca(e,n,i){for(;e!==null;){var l=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,l!==null&&(l.childLanes|=n)):l!==null&&(l.childLanes&n)!==n&&(l.childLanes|=n),e===i)break;e=e.return}}function Yr(e,n){ro=e,oa=Vr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&n)!==0&&(Dt=!0),e.firstContext=null)}function Kt(e){var n=e._currentValue;if(oa!==e)if(e={context:e,memoizedValue:n,next:null},Vr===null){if(ro===null)throw Error(r(308));Vr=e,ro.dependencies={lanes:0,firstContext:e}}else Vr=Vr.next=e;return n}var hr=null;function ua(e){hr===null?hr=[e]:hr.push(e)}function Od(e,n,i,l){var u=n.interleaved;return u===null?(i.next=i,ua(n)):(i.next=u.next,u.next=i),n.interleaved=i,kn(e,l)}function kn(e,n){e.lanes|=n;var i=e.alternate;for(i!==null&&(i.lanes|=n),i=e,e=e.return;e!==null;)e.childLanes|=n,i=e.alternate,i!==null&&(i.childLanes|=n),i=e,e=e.return;return i.tag===3?i.stateNode:null}var Hn=!1;function da(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ad(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Cn(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function Vn(e,n,i){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,($e&2)!==0){var u=l.pending;return u===null?n.next=n:(n.next=u.next,u.next=n),l.pending=n,kn(e,i)}return u=l.interleaved,u===null?(n.next=n,ua(l)):(n.next=u.next,u.next=n),l.interleaved=n,kn(e,i)}function so(e,n,i){if(n=n.updateQueue,n!==null&&(n=n.shared,(i&4194240)!==0)){var l=n.lanes;l&=e.pendingLanes,i|=l,n.lanes=i,Cl(e,i)}}function Fd(e,n){var i=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,i===l)){var u=null,f=null;if(i=i.firstBaseUpdate,i!==null){do{var m={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};f===null?u=f=m:f=f.next=m,i=i.next}while(i!==null);f===null?u=f=n:f=f.next=n}else u=f=n;i={baseState:l.baseState,firstBaseUpdate:u,lastBaseUpdate:f,shared:l.shared,effects:l.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=n:e.next=n,i.lastBaseUpdate=n}function io(e,n,i,l){var u=e.updateQueue;Hn=!1;var f=u.firstBaseUpdate,m=u.lastBaseUpdate,_=u.shared.pending;if(_!==null){u.shared.pending=null;var b=_,I=b.next;b.next=null,m===null?f=I:m.next=I,m=b;var B=e.alternate;B!==null&&(B=B.updateQueue,_=B.lastBaseUpdate,_!==m&&(_===null?B.firstBaseUpdate=I:_.next=I,B.lastBaseUpdate=b))}if(f!==null){var W=u.baseState;m=0,B=I=b=null,_=f;do{var z=_.lane,ne=_.eventTime;if((l&z)===z){B!==null&&(B=B.next={eventTime:ne,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});e:{var ce=e,fe=_;switch(z=n,ne=i,fe.tag){case 1:if(ce=fe.payload,typeof ce=="function"){W=ce.call(ne,W,z);break e}W=ce;break e;case 3:ce.flags=ce.flags&-65537|128;case 0:if(ce=fe.payload,z=typeof ce=="function"?ce.call(ne,W,z):ce,z==null)break e;W=w({},W,z);break e;case 2:Hn=!0}}_.callback!==null&&_.lane!==0&&(e.flags|=64,z=u.effects,z===null?u.effects=[_]:z.push(_))}else ne={eventTime:ne,lane:z,tag:_.tag,payload:_.payload,callback:_.callback,next:null},B===null?(I=B=ne,b=W):B=B.next=ne,m|=z;if(_=_.next,_===null){if(_=u.shared.pending,_===null)break;z=_,_=z.next,z.next=null,u.lastBaseUpdate=z,u.shared.pending=null}}while(!0);if(B===null&&(b=W),u.baseState=b,u.firstBaseUpdate=I,u.lastBaseUpdate=B,n=u.shared.interleaved,n!==null){u=n;do m|=u.lane,u=u.next;while(u!==n)}else f===null&&(u.shared.lanes=0);gr|=m,e.lanes=m,e.memoizedState=W}}function zd(e,n,i){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var l=e[n],u=l.callback;if(u!==null){if(l.callback=null,l=i,typeof u!="function")throw Error(r(191,u));u.call(l)}}}var $d=new s.Component().refs;function fa(e,n,i,l){n=e.memoizedState,i=i(l,n),i=i==null?n:w({},n,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var oo={isMounted:function(e){return(e=e._reactInternals)?ar(e)===e:!1},enqueueSetState:function(e,n,i){e=e._reactInternals;var l=Pt(),u=Xn(e),f=Cn(l,u);f.payload=n,i!=null&&(f.callback=i),n=Vn(e,f,u),n!==null&&(an(n,e,u,l),so(n,e,u))},enqueueReplaceState:function(e,n,i){e=e._reactInternals;var l=Pt(),u=Xn(e),f=Cn(l,u);f.tag=1,f.payload=n,i!=null&&(f.callback=i),n=Vn(e,f,u),n!==null&&(an(n,e,u,l),so(n,e,u))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var i=Pt(),l=Xn(e),u=Cn(i,l);u.tag=2,n!=null&&(u.callback=n),n=Vn(e,u,l),n!==null&&(an(n,e,l,i),so(n,e,l))}};function Ud(e,n,i,l,u,f,m){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,f,m):n.prototype&&n.prototype.isPureReactComponent?!Ts(i,l)||!Ts(u,f):!0}function Bd(e,n,i){var l=!1,u=Bn,f=n.contextType;return typeof f=="object"&&f!==null?f=Kt(f):(u=Mt(n)?ur:St.current,l=n.contextTypes,f=(l=l!=null)?Ur(e,u):Bn),n=new n(i,f),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=oo,e.stateNode=n,n._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=u,e.__reactInternalMemoizedMaskedChildContext=f),n}function Wd(e,n,i,l){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(i,l),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(i,l),n.state!==e&&oo.enqueueReplaceState(n,n.state,null)}function ha(e,n,i,l){var u=e.stateNode;u.props=i,u.state=e.memoizedState,u.refs=$d,da(e);var f=n.contextType;typeof f=="object"&&f!==null?u.context=Kt(f):(f=Mt(n)?ur:St.current,u.context=Ur(e,f)),u.state=e.memoizedState,f=n.getDerivedStateFromProps,typeof f=="function"&&(fa(e,n,f,i),u.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(n=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),n!==u.state&&oo.enqueueReplaceState(u,u.state,null),io(e,i,u,l),u.state=e.memoizedState),typeof u.componentDidMount=="function"&&(e.flags|=4194308)}function As(e,n,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(r(309));var l=i.stateNode}if(!l)throw Error(r(147,e));var u=l,f=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===f?n.ref:(n=function(m){var _=u.refs;_===$d&&(_=u.refs={}),m===null?delete _[f]:_[f]=m},n._stringRef=f,n)}if(typeof e!="string")throw Error(r(284));if(!i._owner)throw Error(r(290,e))}return e}function lo(e,n){throw e=Object.prototype.toString.call(n),Error(r(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function Hd(e){var n=e._init;return n(e._payload)}function Vd(e){function n(C,N){if(e){var E=C.deletions;E===null?(C.deletions=[N],C.flags|=16):E.push(N)}}function i(C,N){if(!e)return null;for(;N!==null;)n(C,N),N=N.sibling;return null}function l(C,N){for(C=new Map;N!==null;)N.key!==null?C.set(N.key,N):C.set(N.index,N),N=N.sibling;return C}function u(C,N){return C=Kn(C,N),C.index=0,C.sibling=null,C}function f(C,N,E){return C.index=E,e?(E=C.alternate,E!==null?(E=E.index,E<N?(C.flags|=2,N):E):(C.flags|=2,N)):(C.flags|=1048576,N)}function m(C){return e&&C.alternate===null&&(C.flags|=2),C}function _(C,N,E,Y){return N===null||N.tag!==6?(N=qa(E,C.mode,Y),N.return=C,N):(N=u(N,E),N.return=C,N)}function b(C,N,E,Y){var pe=E.type;return pe===M?B(C,N,E.props.children,Y,E.key):N!==null&&(N.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===Qe&&Hd(pe)===N.type)?(Y=u(N,E.props),Y.ref=As(C,N,E),Y.return=C,Y):(Y=Eo(E.type,E.key,E.props,null,C.mode,Y),Y.ref=As(C,N,E),Y.return=C,Y)}function I(C,N,E,Y){return N===null||N.tag!==4||N.stateNode.containerInfo!==E.containerInfo||N.stateNode.implementation!==E.implementation?(N=Ka(E,C.mode,Y),N.return=C,N):(N=u(N,E.children||[]),N.return=C,N)}function B(C,N,E,Y,pe){return N===null||N.tag!==7?(N=_r(E,C.mode,Y,pe),N.return=C,N):(N=u(N,E),N.return=C,N)}function W(C,N,E){if(typeof N=="string"&&N!==""||typeof N=="number")return N=qa(""+N,C.mode,E),N.return=C,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Ae:return E=Eo(N.type,N.key,N.props,null,C.mode,E),E.ref=As(C,null,N),E.return=C,E;case G:return N=Ka(N,C.mode,E),N.return=C,N;case Qe:var Y=N._init;return W(C,Y(N._payload),E)}if(je(N)||J(N))return N=_r(N,C.mode,E,null),N.return=C,N;lo(C,N)}return null}function z(C,N,E,Y){var pe=N!==null?N.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return pe!==null?null:_(C,N,""+E,Y);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Ae:return E.key===pe?b(C,N,E,Y):null;case G:return E.key===pe?I(C,N,E,Y):null;case Qe:return pe=E._init,z(C,N,pe(E._payload),Y)}if(je(E)||J(E))return pe!==null?null:B(C,N,E,Y,null);lo(C,E)}return null}function ne(C,N,E,Y,pe){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return C=C.get(E)||null,_(N,C,""+Y,pe);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case Ae:return C=C.get(Y.key===null?E:Y.key)||null,b(N,C,Y,pe);case G:return C=C.get(Y.key===null?E:Y.key)||null,I(N,C,Y,pe);case Qe:var xe=Y._init;return ne(C,N,E,xe(Y._payload),pe)}if(je(Y)||J(Y))return C=C.get(E)||null,B(N,C,Y,pe,null);lo(N,Y)}return null}function ce(C,N,E,Y){for(var pe=null,xe=null,ve=N,ke=N=0,xt=null;ve!==null&&ke<E.length;ke++){ve.index>ke?(xt=ve,ve=null):xt=ve.sibling;var Ue=z(C,ve,E[ke],Y);if(Ue===null){ve===null&&(ve=xt);break}e&&ve&&Ue.alternate===null&&n(C,ve),N=f(Ue,N,ke),xe===null?pe=Ue:xe.sibling=Ue,xe=Ue,ve=xt}if(ke===E.length)return i(C,ve),tt&&fr(C,ke),pe;if(ve===null){for(;ke<E.length;ke++)ve=W(C,E[ke],Y),ve!==null&&(N=f(ve,N,ke),xe===null?pe=ve:xe.sibling=ve,xe=ve);return tt&&fr(C,ke),pe}for(ve=l(C,ve);ke<E.length;ke++)xt=ne(ve,C,ke,E[ke],Y),xt!==null&&(e&&xt.alternate!==null&&ve.delete(xt.key===null?ke:xt.key),N=f(xt,N,ke),xe===null?pe=xt:xe.sibling=xt,xe=xt);return e&&ve.forEach(function(Jn){return n(C,Jn)}),tt&&fr(C,ke),pe}function fe(C,N,E,Y){var pe=J(E);if(typeof pe!="function")throw Error(r(150));if(E=pe.call(E),E==null)throw Error(r(151));for(var xe=pe=null,ve=N,ke=N=0,xt=null,Ue=E.next();ve!==null&&!Ue.done;ke++,Ue=E.next()){ve.index>ke?(xt=ve,ve=null):xt=ve.sibling;var Jn=z(C,ve,Ue.value,Y);if(Jn===null){ve===null&&(ve=xt);break}e&&ve&&Jn.alternate===null&&n(C,ve),N=f(Jn,N,ke),xe===null?pe=Jn:xe.sibling=Jn,xe=Jn,ve=xt}if(Ue.done)return i(C,ve),tt&&fr(C,ke),pe;if(ve===null){for(;!Ue.done;ke++,Ue=E.next())Ue=W(C,Ue.value,Y),Ue!==null&&(N=f(Ue,N,ke),xe===null?pe=Ue:xe.sibling=Ue,xe=Ue);return tt&&fr(C,ke),pe}for(ve=l(C,ve);!Ue.done;ke++,Ue=E.next())Ue=ne(ve,C,ke,Ue.value,Y),Ue!==null&&(e&&Ue.alternate!==null&&ve.delete(Ue.key===null?ke:Ue.key),N=f(Ue,N,ke),xe===null?pe=Ue:xe.sibling=Ue,xe=Ue);return e&&ve.forEach(function(Wg){return n(C,Wg)}),tt&&fr(C,ke),pe}function ct(C,N,E,Y){if(typeof E=="object"&&E!==null&&E.type===M&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case Ae:e:{for(var pe=E.key,xe=N;xe!==null;){if(xe.key===pe){if(pe=E.type,pe===M){if(xe.tag===7){i(C,xe.sibling),N=u(xe,E.props.children),N.return=C,C=N;break e}}else if(xe.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===Qe&&Hd(pe)===xe.type){i(C,xe.sibling),N=u(xe,E.props),N.ref=As(C,xe,E),N.return=C,C=N;break e}i(C,xe);break}else n(C,xe);xe=xe.sibling}E.type===M?(N=_r(E.props.children,C.mode,Y,E.key),N.return=C,C=N):(Y=Eo(E.type,E.key,E.props,null,C.mode,Y),Y.ref=As(C,N,E),Y.return=C,C=Y)}return m(C);case G:e:{for(xe=E.key;N!==null;){if(N.key===xe)if(N.tag===4&&N.stateNode.containerInfo===E.containerInfo&&N.stateNode.implementation===E.implementation){i(C,N.sibling),N=u(N,E.children||[]),N.return=C,C=N;break e}else{i(C,N);break}else n(C,N);N=N.sibling}N=Ka(E,C.mode,Y),N.return=C,C=N}return m(C);case Qe:return xe=E._init,ct(C,N,xe(E._payload),Y)}if(je(E))return ce(C,N,E,Y);if(J(E))return fe(C,N,E,Y);lo(C,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,N!==null&&N.tag===6?(i(C,N.sibling),N=u(N,E),N.return=C,C=N):(i(C,N),N=qa(E,C.mode,Y),N.return=C,C=N),m(C)):i(C,N)}return ct}var Qr=Vd(!0),Yd=Vd(!1),Fs={},gn=Un(Fs),zs=Un(Fs),$s=Un(Fs);function pr(e){if(e===Fs)throw Error(r(174));return e}function pa(e,n){switch(Xe($s,n),Xe(zs,e),Xe(gn,Fs),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:U(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=U(n,e)}Ze(gn),Xe(gn,n)}function Gr(){Ze(gn),Ze(zs),Ze($s)}function Qd(e){pr($s.current);var n=pr(gn.current),i=U(n,e.type);n!==i&&(Xe(zs,e),Xe(gn,i))}function ma(e){zs.current===e&&(Ze(gn),Ze(zs))}var rt=Un(0);function ao(e){for(var n=e;n!==null;){if(n.tag===13){var i=n.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var ga=[];function xa(){for(var e=0;e<ga.length;e++)ga[e]._workInProgressVersionPrimary=null;ga.length=0}var co=ue.ReactCurrentDispatcher,va=ue.ReactCurrentBatchConfig,mr=0,st=null,ft=null,mt=null,uo=!1,Us=!1,Bs=0,dg=0;function Et(){throw Error(r(321))}function ya(e,n){if(n===null)return!1;for(var i=0;i<n.length&&i<e.length;i++)if(!nn(e[i],n[i]))return!1;return!0}function _a(e,n,i,l,u,f){if(mr=f,st=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,co.current=e===null||e.memoizedState===null?mg:gg,e=i(l,u),Us){f=0;do{if(Us=!1,Bs=0,25<=f)throw Error(r(301));f+=1,mt=ft=null,n.updateQueue=null,co.current=xg,e=i(l,u)}while(Us)}if(co.current=po,n=ft!==null&&ft.next!==null,mr=0,mt=ft=st=null,uo=!1,n)throw Error(r(300));return e}function wa(){var e=Bs!==0;return Bs=0,e}function xn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?st.memoizedState=mt=e:mt=mt.next=e,mt}function Jt(){if(ft===null){var e=st.alternate;e=e!==null?e.memoizedState:null}else e=ft.next;var n=mt===null?st.memoizedState:mt.next;if(n!==null)mt=n,ft=e;else{if(e===null)throw Error(r(310));ft=e,e={memoizedState:ft.memoizedState,baseState:ft.baseState,baseQueue:ft.baseQueue,queue:ft.queue,next:null},mt===null?st.memoizedState=mt=e:mt=mt.next=e}return mt}function Ws(e,n){return typeof n=="function"?n(e):n}function ba(e){var n=Jt(),i=n.queue;if(i===null)throw Error(r(311));i.lastRenderedReducer=e;var l=ft,u=l.baseQueue,f=i.pending;if(f!==null){if(u!==null){var m=u.next;u.next=f.next,f.next=m}l.baseQueue=u=f,i.pending=null}if(u!==null){f=u.next,l=l.baseState;var _=m=null,b=null,I=f;do{var B=I.lane;if((mr&B)===B)b!==null&&(b=b.next={lane:0,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null}),l=I.hasEagerState?I.eagerState:e(l,I.action);else{var W={lane:B,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null};b===null?(_=b=W,m=l):b=b.next=W,st.lanes|=B,gr|=B}I=I.next}while(I!==null&&I!==f);b===null?m=l:b.next=_,nn(l,n.memoizedState)||(Dt=!0),n.memoizedState=l,n.baseState=m,n.baseQueue=b,i.lastRenderedState=l}if(e=i.interleaved,e!==null){u=e;do f=u.lane,st.lanes|=f,gr|=f,u=u.next;while(u!==e)}else u===null&&(i.lanes=0);return[n.memoizedState,i.dispatch]}function Na(e){var n=Jt(),i=n.queue;if(i===null)throw Error(r(311));i.lastRenderedReducer=e;var l=i.dispatch,u=i.pending,f=n.memoizedState;if(u!==null){i.pending=null;var m=u=u.next;do f=e(f,m.action),m=m.next;while(m!==u);nn(f,n.memoizedState)||(Dt=!0),n.memoizedState=f,n.baseQueue===null&&(n.baseState=f),i.lastRenderedState=f}return[f,l]}function Gd(){}function Xd(e,n){var i=st,l=Jt(),u=n(),f=!nn(l.memoizedState,u);if(f&&(l.memoizedState=u,Dt=!0),l=l.queue,ka(Jd.bind(null,i,l,e),[e]),l.getSnapshot!==n||f||mt!==null&&mt.memoizedState.tag&1){if(i.flags|=2048,Hs(9,Kd.bind(null,i,l,u,n),void 0,null),gt===null)throw Error(r(349));(mr&30)!==0||qd(i,n,u)}return u}function qd(e,n,i){e.flags|=16384,e={getSnapshot:n,value:i},n=st.updateQueue,n===null?(n={lastEffect:null,stores:null},st.updateQueue=n,n.stores=[e]):(i=n.stores,i===null?n.stores=[e]:i.push(e))}function Kd(e,n,i,l){n.value=i,n.getSnapshot=l,Zd(n)&&ef(e)}function Jd(e,n,i){return i(function(){Zd(n)&&ef(e)})}function Zd(e){var n=e.getSnapshot;e=e.value;try{var i=n();return!nn(e,i)}catch{return!0}}function ef(e){var n=kn(e,1);n!==null&&an(n,e,1,-1)}function tf(e){var n=xn();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ws,lastRenderedState:e},n.queue=e,e=e.dispatch=pg.bind(null,st,e),[n.memoizedState,e]}function Hs(e,n,i,l){return e={tag:e,create:n,destroy:i,deps:l,next:null},n=st.updateQueue,n===null?(n={lastEffect:null,stores:null},st.updateQueue=n,n.lastEffect=e.next=e):(i=n.lastEffect,i===null?n.lastEffect=e.next=e:(l=i.next,i.next=e,e.next=l,n.lastEffect=e)),e}function nf(){return Jt().memoizedState}function fo(e,n,i,l){var u=xn();st.flags|=e,u.memoizedState=Hs(1|n,i,void 0,l===void 0?null:l)}function ho(e,n,i,l){var u=Jt();l=l===void 0?null:l;var f=void 0;if(ft!==null){var m=ft.memoizedState;if(f=m.destroy,l!==null&&ya(l,m.deps)){u.memoizedState=Hs(n,i,f,l);return}}st.flags|=e,u.memoizedState=Hs(1|n,i,f,l)}function rf(e,n){return fo(8390656,8,e,n)}function ka(e,n){return ho(2048,8,e,n)}function sf(e,n){return ho(4,2,e,n)}function of(e,n){return ho(4,4,e,n)}function lf(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function af(e,n,i){return i=i!=null?i.concat([e]):null,ho(4,4,lf.bind(null,n,e),i)}function Ca(){}function cf(e,n){var i=Jt();n=n===void 0?null:n;var l=i.memoizedState;return l!==null&&n!==null&&ya(n,l[1])?l[0]:(i.memoizedState=[e,n],e)}function uf(e,n){var i=Jt();n=n===void 0?null:n;var l=i.memoizedState;return l!==null&&n!==null&&ya(n,l[1])?l[0]:(e=e(),i.memoizedState=[e,n],e)}function df(e,n,i){return(mr&21)===0?(e.baseState&&(e.baseState=!1,Dt=!0),e.memoizedState=i):(nn(i,n)||(i=Ou(),st.lanes|=i,gr|=i,e.baseState=!0),n)}function fg(e,n){var i=Ve;Ve=i!==0&&4>i?i:4,e(!0);var l=va.transition;va.transition={};try{e(!1),n()}finally{Ve=i,va.transition=l}}function ff(){return Jt().memoizedState}function hg(e,n,i){var l=Xn(e);if(i={lane:l,action:i,hasEagerState:!1,eagerState:null,next:null},hf(e))pf(n,i);else if(i=Od(e,n,i,l),i!==null){var u=Pt();an(i,e,l,u),mf(i,n,l)}}function pg(e,n,i){var l=Xn(e),u={lane:l,action:i,hasEagerState:!1,eagerState:null,next:null};if(hf(e))pf(n,u);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=n.lastRenderedReducer,f!==null))try{var m=n.lastRenderedState,_=f(m,i);if(u.hasEagerState=!0,u.eagerState=_,nn(_,m)){var b=n.interleaved;b===null?(u.next=u,ua(n)):(u.next=b.next,b.next=u),n.interleaved=u;return}}catch{}finally{}i=Od(e,n,u,l),i!==null&&(u=Pt(),an(i,e,l,u),mf(i,n,l))}}function hf(e){var n=e.alternate;return e===st||n!==null&&n===st}function pf(e,n){Us=uo=!0;var i=e.pending;i===null?n.next=n:(n.next=i.next,i.next=n),e.pending=n}function mf(e,n,i){if((i&4194240)!==0){var l=n.lanes;l&=e.pendingLanes,i|=l,n.lanes=i,Cl(e,i)}}var po={readContext:Kt,useCallback:Et,useContext:Et,useEffect:Et,useImperativeHandle:Et,useInsertionEffect:Et,useLayoutEffect:Et,useMemo:Et,useReducer:Et,useRef:Et,useState:Et,useDebugValue:Et,useDeferredValue:Et,useTransition:Et,useMutableSource:Et,useSyncExternalStore:Et,useId:Et,unstable_isNewReconciler:!1},mg={readContext:Kt,useCallback:function(e,n){return xn().memoizedState=[e,n===void 0?null:n],e},useContext:Kt,useEffect:rf,useImperativeHandle:function(e,n,i){return i=i!=null?i.concat([e]):null,fo(4194308,4,lf.bind(null,n,e),i)},useLayoutEffect:function(e,n){return fo(4194308,4,e,n)},useInsertionEffect:function(e,n){return fo(4,2,e,n)},useMemo:function(e,n){var i=xn();return n=n===void 0?null:n,e=e(),i.memoizedState=[e,n],e},useReducer:function(e,n,i){var l=xn();return n=i!==void 0?i(n):n,l.memoizedState=l.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},l.queue=e,e=e.dispatch=hg.bind(null,st,e),[l.memoizedState,e]},useRef:function(e){var n=xn();return e={current:e},n.memoizedState=e},useState:tf,useDebugValue:Ca,useDeferredValue:function(e){return xn().memoizedState=e},useTransition:function(){var e=tf(!1),n=e[0];return e=fg.bind(null,e[1]),xn().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,i){var l=st,u=xn();if(tt){if(i===void 0)throw Error(r(407));i=i()}else{if(i=n(),gt===null)throw Error(r(349));(mr&30)!==0||qd(l,n,i)}u.memoizedState=i;var f={value:i,getSnapshot:n};return u.queue=f,rf(Jd.bind(null,l,f,e),[e]),l.flags|=2048,Hs(9,Kd.bind(null,l,f,i,n),void 0,null),i},useId:function(){var e=xn(),n=gt.identifierPrefix;if(tt){var i=Nn,l=bn;i=(l&~(1<<32-tn(l)-1)).toString(32)+i,n=":"+n+"R"+i,i=Bs++,0<i&&(n+="H"+i.toString(32)),n+=":"}else i=dg++,n=":"+n+"r"+i.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},gg={readContext:Kt,useCallback:cf,useContext:Kt,useEffect:ka,useImperativeHandle:af,useInsertionEffect:sf,useLayoutEffect:of,useMemo:uf,useReducer:ba,useRef:nf,useState:function(){return ba(Ws)},useDebugValue:Ca,useDeferredValue:function(e){var n=Jt();return df(n,ft.memoizedState,e)},useTransition:function(){var e=ba(Ws)[0],n=Jt().memoizedState;return[e,n]},useMutableSource:Gd,useSyncExternalStore:Xd,useId:ff,unstable_isNewReconciler:!1},xg={readContext:Kt,useCallback:cf,useContext:Kt,useEffect:ka,useImperativeHandle:af,useInsertionEffect:sf,useLayoutEffect:of,useMemo:uf,useReducer:Na,useRef:nf,useState:function(){return Na(Ws)},useDebugValue:Ca,useDeferredValue:function(e){var n=Jt();return ft===null?n.memoizedState=e:df(n,ft.memoizedState,e)},useTransition:function(){var e=Na(Ws)[0],n=Jt().memoizedState;return[e,n]},useMutableSource:Gd,useSyncExternalStore:Xd,useId:ff,unstable_isNewReconciler:!1};function Xr(e,n){try{var i="",l=n;do i+=Q(l),l=l.return;while(l);var u=i}catch(f){u=`
Error generating stack: `+f.message+`
`+f.stack}return{value:e,source:n,stack:u,digest:null}}function Sa(e,n,i){return{value:e,source:null,stack:i??null,digest:n??null}}function Ea(e,n){try{console.error(n.value)}catch(i){setTimeout(function(){throw i})}}var vg=typeof WeakMap=="function"?WeakMap:Map;function gf(e,n,i){i=Cn(-1,i),i.tag=3,i.payload={element:null};var l=n.value;return i.callback=function(){wo||(wo=!0,Ba=l),Ea(e,n)},i}function xf(e,n,i){i=Cn(-1,i),i.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var u=n.value;i.payload=function(){return l(u)},i.callback=function(){Ea(e,n)}}var f=e.stateNode;return f!==null&&typeof f.componentDidCatch=="function"&&(i.callback=function(){Ea(e,n),typeof l!="function"&&(Qn===null?Qn=new Set([this]):Qn.add(this));var m=n.stack;this.componentDidCatch(n.value,{componentStack:m!==null?m:""})}),i}function vf(e,n,i){var l=e.pingCache;if(l===null){l=e.pingCache=new vg;var u=new Set;l.set(n,u)}else u=l.get(n),u===void 0&&(u=new Set,l.set(n,u));u.has(i)||(u.add(i),e=Pg.bind(null,e,n,i),n.then(e,e))}function yf(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function _f(e,n,i,l,u){return(e.mode&1)===0?(e===n?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(n=Cn(-1,1),n.tag=2,Vn(i,n,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=u,e)}var yg=ue.ReactCurrentOwner,Dt=!1;function Rt(e,n,i,l){n.child=e===null?Yd(n,null,i,l):Qr(n,e.child,i,l)}function wf(e,n,i,l,u){i=i.render;var f=n.ref;return Yr(n,u),l=_a(e,n,i,l,f,u),i=wa(),e!==null&&!Dt?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~u,Sn(e,n,u)):(tt&&i&&ta(n),n.flags|=1,Rt(e,n,l,u),n.child)}function bf(e,n,i,l,u){if(e===null){var f=i.type;return typeof f=="function"&&!Xa(f)&&f.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(n.tag=15,n.type=f,Nf(e,n,f,l,u)):(e=Eo(i.type,null,l,n,n.mode,u),e.ref=n.ref,e.return=n,n.child=e)}if(f=e.child,(e.lanes&u)===0){var m=f.memoizedProps;if(i=i.compare,i=i!==null?i:Ts,i(m,l)&&e.ref===n.ref)return Sn(e,n,u)}return n.flags|=1,e=Kn(f,l),e.ref=n.ref,e.return=n,n.child=e}function Nf(e,n,i,l,u){if(e!==null){var f=e.memoizedProps;if(Ts(f,l)&&e.ref===n.ref)if(Dt=!1,n.pendingProps=l=f,(e.lanes&u)!==0)(e.flags&131072)!==0&&(Dt=!0);else return n.lanes=e.lanes,Sn(e,n,u)}return ja(e,n,i,l,u)}function kf(e,n,i){var l=n.pendingProps,u=l.children,f=e!==null?e.memoizedState:null;if(l.mode==="hidden")if((n.mode&1)===0)n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xe(Kr,Gt),Gt|=i;else{if((i&1073741824)===0)return e=f!==null?f.baseLanes|i:i,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,Xe(Kr,Gt),Gt|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=f!==null?f.baseLanes:i,Xe(Kr,Gt),Gt|=l}else f!==null?(l=f.baseLanes|i,n.memoizedState=null):l=i,Xe(Kr,Gt),Gt|=l;return Rt(e,n,u,i),n.child}function Cf(e,n){var i=n.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(n.flags|=512,n.flags|=2097152)}function ja(e,n,i,l,u){var f=Mt(i)?ur:St.current;return f=Ur(n,f),Yr(n,u),i=_a(e,n,i,l,f,u),l=wa(),e!==null&&!Dt?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~u,Sn(e,n,u)):(tt&&l&&ta(n),n.flags|=1,Rt(e,n,i,u),n.child)}function Sf(e,n,i,l,u){if(Mt(i)){var f=!0;Ki(n)}else f=!1;if(Yr(n,u),n.stateNode===null)go(e,n),Bd(n,i,l),ha(n,i,l,u),l=!0;else if(e===null){var m=n.stateNode,_=n.memoizedProps;m.props=_;var b=m.context,I=i.contextType;typeof I=="object"&&I!==null?I=Kt(I):(I=Mt(i)?ur:St.current,I=Ur(n,I));var B=i.getDerivedStateFromProps,W=typeof B=="function"||typeof m.getSnapshotBeforeUpdate=="function";W||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(_!==l||b!==I)&&Wd(n,m,l,I),Hn=!1;var z=n.memoizedState;m.state=z,io(n,l,m,u),b=n.memoizedState,_!==l||z!==b||Lt.current||Hn?(typeof B=="function"&&(fa(n,i,B,l),b=n.memoizedState),(_=Hn||Ud(n,i,_,l,z,b,I))?(W||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(n.flags|=4194308)):(typeof m.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=l,n.memoizedState=b),m.props=l,m.state=b,m.context=I,l=_):(typeof m.componentDidMount=="function"&&(n.flags|=4194308),l=!1)}else{m=n.stateNode,Ad(e,n),_=n.memoizedProps,I=n.type===n.elementType?_:sn(n.type,_),m.props=I,W=n.pendingProps,z=m.context,b=i.contextType,typeof b=="object"&&b!==null?b=Kt(b):(b=Mt(i)?ur:St.current,b=Ur(n,b));var ne=i.getDerivedStateFromProps;(B=typeof ne=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(_!==W||z!==b)&&Wd(n,m,l,b),Hn=!1,z=n.memoizedState,m.state=z,io(n,l,m,u);var ce=n.memoizedState;_!==W||z!==ce||Lt.current||Hn?(typeof ne=="function"&&(fa(n,i,ne,l),ce=n.memoizedState),(I=Hn||Ud(n,i,I,l,z,ce,b)||!1)?(B||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(l,ce,b),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(l,ce,b)),typeof m.componentDidUpdate=="function"&&(n.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof m.componentDidUpdate!="function"||_===e.memoizedProps&&z===e.memoizedState||(n.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&z===e.memoizedState||(n.flags|=1024),n.memoizedProps=l,n.memoizedState=ce),m.props=l,m.state=ce,m.context=b,l=I):(typeof m.componentDidUpdate!="function"||_===e.memoizedProps&&z===e.memoizedState||(n.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&z===e.memoizedState||(n.flags|=1024),l=!1)}return Ia(e,n,i,l,f,u)}function Ia(e,n,i,l,u,f){Cf(e,n);var m=(n.flags&128)!==0;if(!l&&!m)return u&&Id(n,i,!1),Sn(e,n,f);l=n.stateNode,yg.current=n;var _=m&&typeof i.getDerivedStateFromError!="function"?null:l.render();return n.flags|=1,e!==null&&m?(n.child=Qr(n,e.child,null,f),n.child=Qr(n,null,_,f)):Rt(e,n,_,f),n.memoizedState=l.state,u&&Id(n,i,!0),n.child}function Ef(e){var n=e.stateNode;n.pendingContext?Ed(e,n.pendingContext,n.pendingContext!==n.context):n.context&&Ed(e,n.context,!1),pa(e,n.containerInfo)}function jf(e,n,i,l,u){return Hr(),ia(u),n.flags|=256,Rt(e,n,i,l),n.child}var Ta={dehydrated:null,treeContext:null,retryLane:0};function Ra(e){return{baseLanes:e,cachePool:null,transitions:null}}function If(e,n,i){var l=n.pendingProps,u=rt.current,f=!1,m=(n.flags&128)!==0,_;if((_=m)||(_=e!==null&&e.memoizedState===null?!1:(u&2)!==0),_?(f=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(u|=1),Xe(rt,u&1),e===null)return sa(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((n.mode&1)===0?n.lanes=1:e.data==="$!"?n.lanes=8:n.lanes=1073741824,null):(m=l.children,e=l.fallback,f?(l=n.mode,f=n.child,m={mode:"hidden",children:m},(l&1)===0&&f!==null?(f.childLanes=0,f.pendingProps=m):f=jo(m,l,0,null),e=_r(e,l,i,null),f.return=n,e.return=n,f.sibling=e,n.child=f,n.child.memoizedState=Ra(i),n.memoizedState=Ta,e):Pa(n,m));if(u=e.memoizedState,u!==null&&(_=u.dehydrated,_!==null))return _g(e,n,m,l,_,u,i);if(f){f=l.fallback,m=n.mode,u=e.child,_=u.sibling;var b={mode:"hidden",children:l.children};return(m&1)===0&&n.child!==u?(l=n.child,l.childLanes=0,l.pendingProps=b,n.deletions=null):(l=Kn(u,b),l.subtreeFlags=u.subtreeFlags&14680064),_!==null?f=Kn(_,f):(f=_r(f,m,i,null),f.flags|=2),f.return=n,l.return=n,l.sibling=f,n.child=l,l=f,f=n.child,m=e.child.memoizedState,m=m===null?Ra(i):{baseLanes:m.baseLanes|i,cachePool:null,transitions:m.transitions},f.memoizedState=m,f.childLanes=e.childLanes&~i,n.memoizedState=Ta,l}return f=e.child,e=f.sibling,l=Kn(f,{mode:"visible",children:l.children}),(n.mode&1)===0&&(l.lanes=i),l.return=n,l.sibling=null,e!==null&&(i=n.deletions,i===null?(n.deletions=[e],n.flags|=16):i.push(e)),n.child=l,n.memoizedState=null,l}function Pa(e,n){return n=jo({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function mo(e,n,i,l){return l!==null&&ia(l),Qr(n,e.child,null,i),e=Pa(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function _g(e,n,i,l,u,f,m){if(i)return n.flags&256?(n.flags&=-257,l=Sa(Error(r(422))),mo(e,n,m,l)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(f=l.fallback,u=n.mode,l=jo({mode:"visible",children:l.children},u,0,null),f=_r(f,u,m,null),f.flags|=2,l.return=n,f.return=n,l.sibling=f,n.child=l,(n.mode&1)!==0&&Qr(n,e.child,null,m),n.child.memoizedState=Ra(m),n.memoizedState=Ta,f);if((n.mode&1)===0)return mo(e,n,m,null);if(u.data==="$!"){if(l=u.nextSibling&&u.nextSibling.dataset,l)var _=l.dgst;return l=_,f=Error(r(419)),l=Sa(f,l,void 0),mo(e,n,m,l)}if(_=(m&e.childLanes)!==0,Dt||_){if(l=gt,l!==null){switch(m&-m){case 4:u=2;break;case 16:u=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:u=32;break;case 536870912:u=268435456;break;default:u=0}u=(u&(l.suspendedLanes|m))!==0?0:u,u!==0&&u!==f.retryLane&&(f.retryLane=u,kn(e,u),an(l,e,u,-1))}return Ga(),l=Sa(Error(r(421))),mo(e,n,m,l)}return u.data==="$?"?(n.flags|=128,n.child=e.child,n=Lg.bind(null,e),u._reactRetry=n,null):(e=f.treeContext,Qt=$n(u.nextSibling),Yt=n,tt=!0,rn=null,e!==null&&(Xt[qt++]=bn,Xt[qt++]=Nn,Xt[qt++]=dr,bn=e.id,Nn=e.overflow,dr=n),n=Pa(n,l.children),n.flags|=4096,n)}function Tf(e,n,i){e.lanes|=n;var l=e.alternate;l!==null&&(l.lanes|=n),ca(e.return,n,i)}function La(e,n,i,l,u){var f=e.memoizedState;f===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:l,tail:i,tailMode:u}:(f.isBackwards=n,f.rendering=null,f.renderingStartTime=0,f.last=l,f.tail=i,f.tailMode=u)}function Rf(e,n,i){var l=n.pendingProps,u=l.revealOrder,f=l.tail;if(Rt(e,n,l.children,i),l=rt.current,(l&2)!==0)l=l&1|2,n.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Tf(e,i,n);else if(e.tag===19)Tf(e,i,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(Xe(rt,l),(n.mode&1)===0)n.memoizedState=null;else switch(u){case"forwards":for(i=n.child,u=null;i!==null;)e=i.alternate,e!==null&&ao(e)===null&&(u=i),i=i.sibling;i=u,i===null?(u=n.child,n.child=null):(u=i.sibling,i.sibling=null),La(n,!1,u,i,f);break;case"backwards":for(i=null,u=n.child,n.child=null;u!==null;){if(e=u.alternate,e!==null&&ao(e)===null){n.child=u;break}e=u.sibling,u.sibling=i,i=u,u=e}La(n,!0,i,null,f);break;case"together":La(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function go(e,n){(n.mode&1)===0&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function Sn(e,n,i){if(e!==null&&(n.dependencies=e.dependencies),gr|=n.lanes,(i&n.childLanes)===0)return null;if(e!==null&&n.child!==e.child)throw Error(r(153));if(n.child!==null){for(e=n.child,i=Kn(e,e.pendingProps),n.child=i,i.return=n;e.sibling!==null;)e=e.sibling,i=i.sibling=Kn(e,e.pendingProps),i.return=n;i.sibling=null}return n.child}function wg(e,n,i){switch(n.tag){case 3:Ef(n),Hr();break;case 5:Qd(n);break;case 1:Mt(n.type)&&Ki(n);break;case 4:pa(n,n.stateNode.containerInfo);break;case 10:var l=n.type._context,u=n.memoizedProps.value;Xe(no,l._currentValue),l._currentValue=u;break;case 13:if(l=n.memoizedState,l!==null)return l.dehydrated!==null?(Xe(rt,rt.current&1),n.flags|=128,null):(i&n.child.childLanes)!==0?If(e,n,i):(Xe(rt,rt.current&1),e=Sn(e,n,i),e!==null?e.sibling:null);Xe(rt,rt.current&1);break;case 19:if(l=(i&n.childLanes)!==0,(e.flags&128)!==0){if(l)return Rf(e,n,i);n.flags|=128}if(u=n.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),Xe(rt,rt.current),l)break;return null;case 22:case 23:return n.lanes=0,kf(e,n,i)}return Sn(e,n,i)}var Pf,Ma,Lf,Mf;Pf=function(e,n){for(var i=n.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Ma=function(){},Lf=function(e,n,i,l){var u=e.memoizedProps;if(u!==l){e=n.stateNode,pr(gn.current);var f=null;switch(i){case"input":u=j(e,u),l=j(e,l),f=[];break;case"select":u=w({},u,{value:void 0}),l=w({},l,{value:void 0}),f=[];break;case"textarea":u=nt(e,u),l=nt(e,l),f=[];break;default:typeof u.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=Gi)}pl(i,l);var m;i=null;for(I in u)if(!l.hasOwnProperty(I)&&u.hasOwnProperty(I)&&u[I]!=null)if(I==="style"){var _=u[I];for(m in _)_.hasOwnProperty(m)&&(i||(i={}),i[m]="")}else I!=="dangerouslySetInnerHTML"&&I!=="children"&&I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&I!=="autoFocus"&&(a.hasOwnProperty(I)?f||(f=[]):(f=f||[]).push(I,null));for(I in l){var b=l[I];if(_=u!=null?u[I]:void 0,l.hasOwnProperty(I)&&b!==_&&(b!=null||_!=null))if(I==="style")if(_){for(m in _)!_.hasOwnProperty(m)||b&&b.hasOwnProperty(m)||(i||(i={}),i[m]="");for(m in b)b.hasOwnProperty(m)&&_[m]!==b[m]&&(i||(i={}),i[m]=b[m])}else i||(f||(f=[]),f.push(I,i)),i=b;else I==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,_=_?_.__html:void 0,b!=null&&_!==b&&(f=f||[]).push(I,b)):I==="children"?typeof b!="string"&&typeof b!="number"||(f=f||[]).push(I,""+b):I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&(a.hasOwnProperty(I)?(b!=null&&I==="onScroll"&&Je("scroll",e),f||_===b||(f=[])):(f=f||[]).push(I,b))}i&&(f=f||[]).push("style",i);var I=f;(n.updateQueue=I)&&(n.flags|=4)}},Mf=function(e,n,i,l){i!==l&&(n.flags|=4)};function Vs(e,n){if(!tt)switch(e.tailMode){case"hidden":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function jt(e){var n=e.alternate!==null&&e.alternate.child===e.child,i=0,l=0;if(n)for(var u=e.child;u!==null;)i|=u.lanes|u.childLanes,l|=u.subtreeFlags&14680064,l|=u.flags&14680064,u.return=e,u=u.sibling;else for(u=e.child;u!==null;)i|=u.lanes|u.childLanes,l|=u.subtreeFlags,l|=u.flags,u.return=e,u=u.sibling;return e.subtreeFlags|=l,e.childLanes=i,n}function bg(e,n,i){var l=n.pendingProps;switch(na(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jt(n),null;case 1:return Mt(n.type)&&qi(),jt(n),null;case 3:return l=n.stateNode,Gr(),Ze(Lt),Ze(St),xa(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(to(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,rn!==null&&(Va(rn),rn=null))),Ma(e,n),jt(n),null;case 5:ma(n);var u=pr($s.current);if(i=n.type,e!==null&&n.stateNode!=null)Lf(e,n,i,l,u),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!l){if(n.stateNode===null)throw Error(r(166));return jt(n),null}if(e=pr(gn.current),to(n)){l=n.stateNode,i=n.type;var f=n.memoizedProps;switch(l[mn]=n,l[Ds]=f,e=(n.mode&1)!==0,i){case"dialog":Je("cancel",l),Je("close",l);break;case"iframe":case"object":case"embed":Je("load",l);break;case"video":case"audio":for(u=0;u<Ps.length;u++)Je(Ps[u],l);break;case"source":Je("error",l);break;case"img":case"image":case"link":Je("error",l),Je("load",l);break;case"details":Je("toggle",l);break;case"input":ae(l,f),Je("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!f.multiple},Je("invalid",l);break;case"textarea":F(l,f),Je("invalid",l)}pl(i,f),u=null;for(var m in f)if(f.hasOwnProperty(m)){var _=f[m];m==="children"?typeof _=="string"?l.textContent!==_&&(f.suppressHydrationWarning!==!0&&Qi(l.textContent,_,e),u=["children",_]):typeof _=="number"&&l.textContent!==""+_&&(f.suppressHydrationWarning!==!0&&Qi(l.textContent,_,e),u=["children",""+_]):a.hasOwnProperty(m)&&_!=null&&m==="onScroll"&&Je("scroll",l)}switch(i){case"input":be(l),Se(l,f,!0);break;case"textarea":be(l),_e(l);break;case"select":case"option":break;default:typeof f.onClick=="function"&&(l.onclick=Gi)}l=u,n.updateQueue=l,l!==null&&(n.flags|=4)}else{m=u.nodeType===9?u:u.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=q(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=m.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=m.createElement(i,{is:l.is}):(e=m.createElement(i),i==="select"&&(m=e,l.multiple?m.multiple=!0:l.size&&(m.size=l.size))):e=m.createElementNS(e,i),e[mn]=n,e[Ds]=l,Pf(e,n,!1,!1),n.stateNode=e;e:{switch(m=ml(i,l),i){case"dialog":Je("cancel",e),Je("close",e),u=l;break;case"iframe":case"object":case"embed":Je("load",e),u=l;break;case"video":case"audio":for(u=0;u<Ps.length;u++)Je(Ps[u],e);u=l;break;case"source":Je("error",e),u=l;break;case"img":case"image":case"link":Je("error",e),Je("load",e),u=l;break;case"details":Je("toggle",e),u=l;break;case"input":ae(e,l),u=j(e,l),Je("invalid",e);break;case"option":u=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},u=w({},l,{value:void 0}),Je("invalid",e);break;case"textarea":F(e,l),u=nt(e,l),Je("invalid",e);break;default:u=l}pl(i,u),_=u;for(f in _)if(_.hasOwnProperty(f)){var b=_[f];f==="style"?or(e,b):f==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,b!=null&&Te(e,b)):f==="children"?typeof b=="string"?(i!=="textarea"||b!=="")&&Oe(e,b):typeof b=="number"&&Oe(e,""+b):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(a.hasOwnProperty(f)?b!=null&&f==="onScroll"&&Je("scroll",e):b!=null&&we(e,f,b,m))}switch(i){case"input":be(e),Se(e,l,!1);break;case"textarea":be(e),_e(e);break;case"option":l.value!=null&&e.setAttribute("value",""+T(l.value));break;case"select":e.multiple=!!l.multiple,f=l.value,f!=null?He(e,!!l.multiple,f,!1):l.defaultValue!=null&&He(e,!!l.multiple,l.defaultValue,!0);break;default:typeof u.onClick=="function"&&(e.onclick=Gi)}switch(i){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return jt(n),null;case 6:if(e&&n.stateNode!=null)Mf(e,n,e.memoizedProps,l);else{if(typeof l!="string"&&n.stateNode===null)throw Error(r(166));if(i=pr($s.current),pr(gn.current),to(n)){if(l=n.stateNode,i=n.memoizedProps,l[mn]=n,(f=l.nodeValue!==i)&&(e=Yt,e!==null))switch(e.tag){case 3:Qi(l.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Qi(l.nodeValue,i,(e.mode&1)!==0)}f&&(n.flags|=4)}else l=(i.nodeType===9?i:i.ownerDocument).createTextNode(l),l[mn]=n,n.stateNode=l}return jt(n),null;case 13:if(Ze(rt),l=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(tt&&Qt!==null&&(n.mode&1)!==0&&(n.flags&128)===0)Dd(),Hr(),n.flags|=98560,f=!1;else if(f=to(n),l!==null&&l.dehydrated!==null){if(e===null){if(!f)throw Error(r(318));if(f=n.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(317));f[mn]=n}else Hr(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;jt(n),f=!1}else rn!==null&&(Va(rn),rn=null),f=!0;if(!f)return n.flags&65536?n:null}return(n.flags&128)!==0?(n.lanes=i,n):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(n.child.flags|=8192,(n.mode&1)!==0&&(e===null||(rt.current&1)!==0?ht===0&&(ht=3):Ga())),n.updateQueue!==null&&(n.flags|=4),jt(n),null);case 4:return Gr(),Ma(e,n),e===null&&Ls(n.stateNode.containerInfo),jt(n),null;case 10:return aa(n.type._context),jt(n),null;case 17:return Mt(n.type)&&qi(),jt(n),null;case 19:if(Ze(rt),f=n.memoizedState,f===null)return jt(n),null;if(l=(n.flags&128)!==0,m=f.rendering,m===null)if(l)Vs(f,!1);else{if(ht!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(m=ao(e),m!==null){for(n.flags|=128,Vs(f,!1),l=m.updateQueue,l!==null&&(n.updateQueue=l,n.flags|=4),n.subtreeFlags=0,l=i,i=n.child;i!==null;)f=i,e=l,f.flags&=14680066,m=f.alternate,m===null?(f.childLanes=0,f.lanes=e,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=m.childLanes,f.lanes=m.lanes,f.child=m.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=m.memoizedProps,f.memoizedState=m.memoizedState,f.updateQueue=m.updateQueue,f.type=m.type,e=m.dependencies,f.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Xe(rt,rt.current&1|2),n.child}e=e.sibling}f.tail!==null&&at()>Jr&&(n.flags|=128,l=!0,Vs(f,!1),n.lanes=4194304)}else{if(!l)if(e=ao(m),e!==null){if(n.flags|=128,l=!0,i=e.updateQueue,i!==null&&(n.updateQueue=i,n.flags|=4),Vs(f,!0),f.tail===null&&f.tailMode==="hidden"&&!m.alternate&&!tt)return jt(n),null}else 2*at()-f.renderingStartTime>Jr&&i!==1073741824&&(n.flags|=128,l=!0,Vs(f,!1),n.lanes=4194304);f.isBackwards?(m.sibling=n.child,n.child=m):(i=f.last,i!==null?i.sibling=m:n.child=m,f.last=m)}return f.tail!==null?(n=f.tail,f.rendering=n,f.tail=n.sibling,f.renderingStartTime=at(),n.sibling=null,i=rt.current,Xe(rt,l?i&1|2:i&1),n):(jt(n),null);case 22:case 23:return Qa(),l=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(n.flags|=8192),l&&(n.mode&1)!==0?(Gt&1073741824)!==0&&(jt(n),n.subtreeFlags&6&&(n.flags|=8192)):jt(n),null;case 24:return null;case 25:return null}throw Error(r(156,n.tag))}function Ng(e,n){switch(na(n),n.tag){case 1:return Mt(n.type)&&qi(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Gr(),Ze(Lt),Ze(St),xa(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 5:return ma(n),null;case 13:if(Ze(rt),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(r(340));Hr()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return Ze(rt),null;case 4:return Gr(),null;case 10:return aa(n.type._context),null;case 22:case 23:return Qa(),null;case 24:return null;default:return null}}var xo=!1,It=!1,kg=typeof WeakSet=="function"?WeakSet:Set,oe=null;function qr(e,n){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(l){it(e,n,l)}else i.current=null}function Da(e,n,i){try{i()}catch(l){it(e,n,l)}}var Df=!1;function Cg(e,n){if(Ql=Oi,e=dd(),zl(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var l=i.getSelection&&i.getSelection();if(l&&l.rangeCount!==0){i=l.anchorNode;var u=l.anchorOffset,f=l.focusNode;l=l.focusOffset;try{i.nodeType,f.nodeType}catch{i=null;break e}var m=0,_=-1,b=-1,I=0,B=0,W=e,z=null;t:for(;;){for(var ne;W!==i||u!==0&&W.nodeType!==3||(_=m+u),W!==f||l!==0&&W.nodeType!==3||(b=m+l),W.nodeType===3&&(m+=W.nodeValue.length),(ne=W.firstChild)!==null;)z=W,W=ne;for(;;){if(W===e)break t;if(z===i&&++I===u&&(_=m),z===f&&++B===l&&(b=m),(ne=W.nextSibling)!==null)break;W=z,z=W.parentNode}W=ne}i=_===-1||b===-1?null:{start:_,end:b}}else i=null}i=i||{start:0,end:0}}else i=null;for(Gl={focusedElem:e,selectionRange:i},Oi=!1,oe=n;oe!==null;)if(n=oe,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,oe=e;else for(;oe!==null;){n=oe;try{var ce=n.alternate;if((n.flags&1024)!==0)switch(n.tag){case 0:case 11:case 15:break;case 1:if(ce!==null){var fe=ce.memoizedProps,ct=ce.memoizedState,C=n.stateNode,N=C.getSnapshotBeforeUpdate(n.elementType===n.type?fe:sn(n.type,fe),ct);C.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var E=n.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Y){it(n,n.return,Y)}if(e=n.sibling,e!==null){e.return=n.return,oe=e;break}oe=n.return}return ce=Df,Df=!1,ce}function Ys(e,n,i){var l=n.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var u=l=l.next;do{if((u.tag&e)===e){var f=u.destroy;u.destroy=void 0,f!==void 0&&Da(n,i,f)}u=u.next}while(u!==l)}}function vo(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var l=i.create;i.destroy=l()}i=i.next}while(i!==n)}}function Oa(e){var n=e.ref;if(n!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof n=="function"?n(e):n.current=e}}function Of(e){var n=e.alternate;n!==null&&(e.alternate=null,Of(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[mn],delete n[Ds],delete n[Jl],delete n[lg],delete n[ag])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Af(e){return e.tag===5||e.tag===3||e.tag===4}function Ff(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Af(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Aa(e,n,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?i.nodeType===8?i.parentNode.insertBefore(e,n):i.insertBefore(e,n):(i.nodeType===8?(n=i.parentNode,n.insertBefore(e,i)):(n=i,n.appendChild(e)),i=i._reactRootContainer,i!=null||n.onclick!==null||(n.onclick=Gi));else if(l!==4&&(e=e.child,e!==null))for(Aa(e,n,i),e=e.sibling;e!==null;)Aa(e,n,i),e=e.sibling}function Fa(e,n,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?i.insertBefore(e,n):i.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(Fa(e,n,i),e=e.sibling;e!==null;)Fa(e,n,i),e=e.sibling}var bt=null,on=!1;function Yn(e,n,i){for(i=i.child;i!==null;)zf(e,n,i),i=i.sibling}function zf(e,n,i){if(pn&&typeof pn.onCommitFiberUnmount=="function")try{pn.onCommitFiberUnmount(Ti,i)}catch{}switch(i.tag){case 5:It||qr(i,n);case 6:var l=bt,u=on;bt=null,Yn(e,n,i),bt=l,on=u,bt!==null&&(on?(e=bt,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):bt.removeChild(i.stateNode));break;case 18:bt!==null&&(on?(e=bt,i=i.stateNode,e.nodeType===8?Kl(e.parentNode,i):e.nodeType===1&&Kl(e,i),ks(e)):Kl(bt,i.stateNode));break;case 4:l=bt,u=on,bt=i.stateNode.containerInfo,on=!0,Yn(e,n,i),bt=l,on=u;break;case 0:case 11:case 14:case 15:if(!It&&(l=i.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){u=l=l.next;do{var f=u,m=f.destroy;f=f.tag,m!==void 0&&((f&2)!==0||(f&4)!==0)&&Da(i,n,m),u=u.next}while(u!==l)}Yn(e,n,i);break;case 1:if(!It&&(qr(i,n),l=i.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=i.memoizedProps,l.state=i.memoizedState,l.componentWillUnmount()}catch(_){it(i,n,_)}Yn(e,n,i);break;case 21:Yn(e,n,i);break;case 22:i.mode&1?(It=(l=It)||i.memoizedState!==null,Yn(e,n,i),It=l):Yn(e,n,i);break;default:Yn(e,n,i)}}function $f(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new kg),n.forEach(function(l){var u=Mg.bind(null,e,l);i.has(l)||(i.add(l),l.then(u,u))})}}function ln(e,n){var i=n.deletions;if(i!==null)for(var l=0;l<i.length;l++){var u=i[l];try{var f=e,m=n,_=m;e:for(;_!==null;){switch(_.tag){case 5:bt=_.stateNode,on=!1;break e;case 3:bt=_.stateNode.containerInfo,on=!0;break e;case 4:bt=_.stateNode.containerInfo,on=!0;break e}_=_.return}if(bt===null)throw Error(r(160));zf(f,m,u),bt=null,on=!1;var b=u.alternate;b!==null&&(b.return=null),u.return=null}catch(I){it(u,n,I)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)Uf(n,e),n=n.sibling}function Uf(e,n){var i=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ln(n,e),vn(e),l&4){try{Ys(3,e,e.return),vo(3,e)}catch(fe){it(e,e.return,fe)}try{Ys(5,e,e.return)}catch(fe){it(e,e.return,fe)}}break;case 1:ln(n,e),vn(e),l&512&&i!==null&&qr(i,i.return);break;case 5:if(ln(n,e),vn(e),l&512&&i!==null&&qr(i,i.return),e.flags&32){var u=e.stateNode;try{Oe(u,"")}catch(fe){it(e,e.return,fe)}}if(l&4&&(u=e.stateNode,u!=null)){var f=e.memoizedProps,m=i!==null?i.memoizedProps:f,_=e.type,b=e.updateQueue;if(e.updateQueue=null,b!==null)try{_==="input"&&f.type==="radio"&&f.name!=null&&ge(u,f),ml(_,m);var I=ml(_,f);for(m=0;m<b.length;m+=2){var B=b[m],W=b[m+1];B==="style"?or(u,W):B==="dangerouslySetInnerHTML"?Te(u,W):B==="children"?Oe(u,W):we(u,B,W,I)}switch(_){case"input":Ee(u,f);break;case"textarea":re(u,f);break;case"select":var z=u._wrapperState.wasMultiple;u._wrapperState.wasMultiple=!!f.multiple;var ne=f.value;ne!=null?He(u,!!f.multiple,ne,!1):z!==!!f.multiple&&(f.defaultValue!=null?He(u,!!f.multiple,f.defaultValue,!0):He(u,!!f.multiple,f.multiple?[]:"",!1))}u[Ds]=f}catch(fe){it(e,e.return,fe)}}break;case 6:if(ln(n,e),vn(e),l&4){if(e.stateNode===null)throw Error(r(162));u=e.stateNode,f=e.memoizedProps;try{u.nodeValue=f}catch(fe){it(e,e.return,fe)}}break;case 3:if(ln(n,e),vn(e),l&4&&i!==null&&i.memoizedState.isDehydrated)try{ks(n.containerInfo)}catch(fe){it(e,e.return,fe)}break;case 4:ln(n,e),vn(e);break;case 13:ln(n,e),vn(e),u=e.child,u.flags&8192&&(f=u.memoizedState!==null,u.stateNode.isHidden=f,!f||u.alternate!==null&&u.alternate.memoizedState!==null||(Ua=at())),l&4&&$f(e);break;case 22:if(B=i!==null&&i.memoizedState!==null,e.mode&1?(It=(I=It)||B,ln(n,e),It=I):ln(n,e),vn(e),l&8192){if(I=e.memoizedState!==null,(e.stateNode.isHidden=I)&&!B&&(e.mode&1)!==0)for(oe=e,B=e.child;B!==null;){for(W=oe=B;oe!==null;){switch(z=oe,ne=z.child,z.tag){case 0:case 11:case 14:case 15:Ys(4,z,z.return);break;case 1:qr(z,z.return);var ce=z.stateNode;if(typeof ce.componentWillUnmount=="function"){l=z,i=z.return;try{n=l,ce.props=n.memoizedProps,ce.state=n.memoizedState,ce.componentWillUnmount()}catch(fe){it(l,i,fe)}}break;case 5:qr(z,z.return);break;case 22:if(z.memoizedState!==null){Hf(W);continue}}ne!==null?(ne.return=z,oe=ne):Hf(W)}B=B.sibling}e:for(B=null,W=e;;){if(W.tag===5){if(B===null){B=W;try{u=W.stateNode,I?(f=u.style,typeof f.setProperty=="function"?f.setProperty("display","none","important"):f.display="none"):(_=W.stateNode,b=W.memoizedProps.style,m=b!=null&&b.hasOwnProperty("display")?b.display:null,_.style.display=Ht("display",m))}catch(fe){it(e,e.return,fe)}}}else if(W.tag===6){if(B===null)try{W.stateNode.nodeValue=I?"":W.memoizedProps}catch(fe){it(e,e.return,fe)}}else if((W.tag!==22&&W.tag!==23||W.memoizedState===null||W===e)&&W.child!==null){W.child.return=W,W=W.child;continue}if(W===e)break e;for(;W.sibling===null;){if(W.return===null||W.return===e)break e;B===W&&(B=null),W=W.return}B===W&&(B=null),W.sibling.return=W.return,W=W.sibling}}break;case 19:ln(n,e),vn(e),l&4&&$f(e);break;case 21:break;default:ln(n,e),vn(e)}}function vn(e){var n=e.flags;if(n&2){try{e:{for(var i=e.return;i!==null;){if(Af(i)){var l=i;break e}i=i.return}throw Error(r(160))}switch(l.tag){case 5:var u=l.stateNode;l.flags&32&&(Oe(u,""),l.flags&=-33);var f=Ff(e);Fa(e,f,u);break;case 3:case 4:var m=l.stateNode.containerInfo,_=Ff(e);Aa(e,_,m);break;default:throw Error(r(161))}}catch(b){it(e,e.return,b)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function Sg(e,n,i){oe=e,Bf(e)}function Bf(e,n,i){for(var l=(e.mode&1)!==0;oe!==null;){var u=oe,f=u.child;if(u.tag===22&&l){var m=u.memoizedState!==null||xo;if(!m){var _=u.alternate,b=_!==null&&_.memoizedState!==null||It;_=xo;var I=It;if(xo=m,(It=b)&&!I)for(oe=u;oe!==null;)m=oe,b=m.child,m.tag===22&&m.memoizedState!==null?Vf(u):b!==null?(b.return=m,oe=b):Vf(u);for(;f!==null;)oe=f,Bf(f),f=f.sibling;oe=u,xo=_,It=I}Wf(e)}else(u.subtreeFlags&8772)!==0&&f!==null?(f.return=u,oe=f):Wf(e)}}function Wf(e){for(;oe!==null;){var n=oe;if((n.flags&8772)!==0){var i=n.alternate;try{if((n.flags&8772)!==0)switch(n.tag){case 0:case 11:case 15:It||vo(5,n);break;case 1:var l=n.stateNode;if(n.flags&4&&!It)if(i===null)l.componentDidMount();else{var u=n.elementType===n.type?i.memoizedProps:sn(n.type,i.memoizedProps);l.componentDidUpdate(u,i.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var f=n.updateQueue;f!==null&&zd(n,f,l);break;case 3:var m=n.updateQueue;if(m!==null){if(i=null,n.child!==null)switch(n.child.tag){case 5:i=n.child.stateNode;break;case 1:i=n.child.stateNode}zd(n,m,i)}break;case 5:var _=n.stateNode;if(i===null&&n.flags&4){i=_;var b=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":b.autoFocus&&i.focus();break;case"img":b.src&&(i.src=b.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var I=n.alternate;if(I!==null){var B=I.memoizedState;if(B!==null){var W=B.dehydrated;W!==null&&ks(W)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}It||n.flags&512&&Oa(n)}catch(z){it(n,n.return,z)}}if(n===e){oe=null;break}if(i=n.sibling,i!==null){i.return=n.return,oe=i;break}oe=n.return}}function Hf(e){for(;oe!==null;){var n=oe;if(n===e){oe=null;break}var i=n.sibling;if(i!==null){i.return=n.return,oe=i;break}oe=n.return}}function Vf(e){for(;oe!==null;){var n=oe;try{switch(n.tag){case 0:case 11:case 15:var i=n.return;try{vo(4,n)}catch(b){it(n,i,b)}break;case 1:var l=n.stateNode;if(typeof l.componentDidMount=="function"){var u=n.return;try{l.componentDidMount()}catch(b){it(n,u,b)}}var f=n.return;try{Oa(n)}catch(b){it(n,f,b)}break;case 5:var m=n.return;try{Oa(n)}catch(b){it(n,m,b)}}}catch(b){it(n,n.return,b)}if(n===e){oe=null;break}var _=n.sibling;if(_!==null){_.return=n.return,oe=_;break}oe=n.return}}var Eg=Math.ceil,yo=ue.ReactCurrentDispatcher,za=ue.ReactCurrentOwner,Zt=ue.ReactCurrentBatchConfig,$e=0,gt=null,ut=null,Nt=0,Gt=0,Kr=Un(0),ht=0,Qs=null,gr=0,_o=0,$a=0,Gs=null,Ot=null,Ua=0,Jr=1/0,En=null,wo=!1,Ba=null,Qn=null,bo=!1,Gn=null,No=0,Xs=0,Wa=null,ko=-1,Co=0;function Pt(){return($e&6)!==0?at():ko!==-1?ko:ko=at()}function Xn(e){return(e.mode&1)===0?1:($e&2)!==0&&Nt!==0?Nt&-Nt:ug.transition!==null?(Co===0&&(Co=Ou()),Co):(e=Ve,e!==0||(e=window.event,e=e===void 0?16:Vu(e.type)),e)}function an(e,n,i,l){if(50<Xs)throw Xs=0,Wa=null,Error(r(185));ys(e,i,l),(($e&2)===0||e!==gt)&&(e===gt&&(($e&2)===0&&(_o|=i),ht===4&&qn(e,Nt)),At(e,l),i===1&&$e===0&&(n.mode&1)===0&&(Jr=at()+500,Ji&&Wn()))}function At(e,n){var i=e.callbackNode;u0(e,n);var l=Li(e,e===gt?Nt:0);if(l===0)i!==null&&Lu(i),e.callbackNode=null,e.callbackPriority=0;else if(n=l&-l,e.callbackPriority!==n){if(i!=null&&Lu(i),n===1)e.tag===0?cg(Qf.bind(null,e)):Td(Qf.bind(null,e)),ig(function(){($e&6)===0&&Wn()}),i=null;else{switch(Au(l)){case 1:i=bl;break;case 4:i=Mu;break;case 16:i=Ii;break;case 536870912:i=Du;break;default:i=Ii}i=th(i,Yf.bind(null,e))}e.callbackPriority=n,e.callbackNode=i}}function Yf(e,n){if(ko=-1,Co=0,($e&6)!==0)throw Error(r(327));var i=e.callbackNode;if(Zr()&&e.callbackNode!==i)return null;var l=Li(e,e===gt?Nt:0);if(l===0)return null;if((l&30)!==0||(l&e.expiredLanes)!==0||n)n=So(e,l);else{n=l;var u=$e;$e|=2;var f=Xf();(gt!==e||Nt!==n)&&(En=null,Jr=at()+500,vr(e,n));do try{Tg();break}catch(_){Gf(e,_)}while(!0);la(),yo.current=f,$e=u,ut!==null?n=0:(gt=null,Nt=0,n=ht)}if(n!==0){if(n===2&&(u=Nl(e),u!==0&&(l=u,n=Ha(e,u))),n===1)throw i=Qs,vr(e,0),qn(e,l),At(e,at()),i;if(n===6)qn(e,l);else{if(u=e.current.alternate,(l&30)===0&&!jg(u)&&(n=So(e,l),n===2&&(f=Nl(e),f!==0&&(l=f,n=Ha(e,f))),n===1))throw i=Qs,vr(e,0),qn(e,l),At(e,at()),i;switch(e.finishedWork=u,e.finishedLanes=l,n){case 0:case 1:throw Error(r(345));case 2:yr(e,Ot,En);break;case 3:if(qn(e,l),(l&130023424)===l&&(n=Ua+500-at(),10<n)){if(Li(e,0)!==0)break;if(u=e.suspendedLanes,(u&l)!==l){Pt(),e.pingedLanes|=e.suspendedLanes&u;break}e.timeoutHandle=ql(yr.bind(null,e,Ot,En),n);break}yr(e,Ot,En);break;case 4:if(qn(e,l),(l&4194240)===l)break;for(n=e.eventTimes,u=-1;0<l;){var m=31-tn(l);f=1<<m,m=n[m],m>u&&(u=m),l&=~f}if(l=u,l=at()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*Eg(l/1960))-l,10<l){e.timeoutHandle=ql(yr.bind(null,e,Ot,En),l);break}yr(e,Ot,En);break;case 5:yr(e,Ot,En);break;default:throw Error(r(329))}}}return At(e,at()),e.callbackNode===i?Yf.bind(null,e):null}function Ha(e,n){var i=Gs;return e.current.memoizedState.isDehydrated&&(vr(e,n).flags|=256),e=So(e,n),e!==2&&(n=Ot,Ot=i,n!==null&&Va(n)),e}function Va(e){Ot===null?Ot=e:Ot.push.apply(Ot,e)}function jg(e){for(var n=e;;){if(n.flags&16384){var i=n.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var l=0;l<i.length;l++){var u=i[l],f=u.getSnapshot;u=u.value;try{if(!nn(f(),u))return!1}catch{return!1}}}if(i=n.child,n.subtreeFlags&16384&&i!==null)i.return=n,n=i;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function qn(e,n){for(n&=~$a,n&=~_o,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var i=31-tn(n),l=1<<i;e[i]=-1,n&=~l}}function Qf(e){if(($e&6)!==0)throw Error(r(327));Zr();var n=Li(e,0);if((n&1)===0)return At(e,at()),null;var i=So(e,n);if(e.tag!==0&&i===2){var l=Nl(e);l!==0&&(n=l,i=Ha(e,l))}if(i===1)throw i=Qs,vr(e,0),qn(e,n),At(e,at()),i;if(i===6)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,yr(e,Ot,En),At(e,at()),null}function Ya(e,n){var i=$e;$e|=1;try{return e(n)}finally{$e=i,$e===0&&(Jr=at()+500,Ji&&Wn())}}function xr(e){Gn!==null&&Gn.tag===0&&($e&6)===0&&Zr();var n=$e;$e|=1;var i=Zt.transition,l=Ve;try{if(Zt.transition=null,Ve=1,e)return e()}finally{Ve=l,Zt.transition=i,$e=n,($e&6)===0&&Wn()}}function Qa(){Gt=Kr.current,Ze(Kr)}function vr(e,n){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,sg(i)),ut!==null)for(i=ut.return;i!==null;){var l=i;switch(na(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&qi();break;case 3:Gr(),Ze(Lt),Ze(St),xa();break;case 5:ma(l);break;case 4:Gr();break;case 13:Ze(rt);break;case 19:Ze(rt);break;case 10:aa(l.type._context);break;case 22:case 23:Qa()}i=i.return}if(gt=e,ut=e=Kn(e.current,null),Nt=Gt=n,ht=0,Qs=null,$a=_o=gr=0,Ot=Gs=null,hr!==null){for(n=0;n<hr.length;n++)if(i=hr[n],l=i.interleaved,l!==null){i.interleaved=null;var u=l.next,f=i.pending;if(f!==null){var m=f.next;f.next=u,l.next=m}i.pending=l}hr=null}return e}function Gf(e,n){do{var i=ut;try{if(la(),co.current=po,uo){for(var l=st.memoizedState;l!==null;){var u=l.queue;u!==null&&(u.pending=null),l=l.next}uo=!1}if(mr=0,mt=ft=st=null,Us=!1,Bs=0,za.current=null,i===null||i.return===null){ht=1,Qs=n,ut=null;break}e:{var f=e,m=i.return,_=i,b=n;if(n=Nt,_.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){var I=b,B=_,W=B.tag;if((B.mode&1)===0&&(W===0||W===11||W===15)){var z=B.alternate;z?(B.updateQueue=z.updateQueue,B.memoizedState=z.memoizedState,B.lanes=z.lanes):(B.updateQueue=null,B.memoizedState=null)}var ne=yf(m);if(ne!==null){ne.flags&=-257,_f(ne,m,_,f,n),ne.mode&1&&vf(f,I,n),n=ne,b=I;var ce=n.updateQueue;if(ce===null){var fe=new Set;fe.add(b),n.updateQueue=fe}else ce.add(b);break e}else{if((n&1)===0){vf(f,I,n),Ga();break e}b=Error(r(426))}}else if(tt&&_.mode&1){var ct=yf(m);if(ct!==null){(ct.flags&65536)===0&&(ct.flags|=256),_f(ct,m,_,f,n),ia(Xr(b,_));break e}}f=b=Xr(b,_),ht!==4&&(ht=2),Gs===null?Gs=[f]:Gs.push(f),f=m;do{switch(f.tag){case 3:f.flags|=65536,n&=-n,f.lanes|=n;var C=gf(f,b,n);Fd(f,C);break e;case 1:_=b;var N=f.type,E=f.stateNode;if((f.flags&128)===0&&(typeof N.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Qn===null||!Qn.has(E)))){f.flags|=65536,n&=-n,f.lanes|=n;var Y=xf(f,_,n);Fd(f,Y);break e}}f=f.return}while(f!==null)}Kf(i)}catch(pe){n=pe,ut===i&&i!==null&&(ut=i=i.return);continue}break}while(!0)}function Xf(){var e=yo.current;return yo.current=po,e===null?po:e}function Ga(){(ht===0||ht===3||ht===2)&&(ht=4),gt===null||(gr&268435455)===0&&(_o&268435455)===0||qn(gt,Nt)}function So(e,n){var i=$e;$e|=2;var l=Xf();(gt!==e||Nt!==n)&&(En=null,vr(e,n));do try{Ig();break}catch(u){Gf(e,u)}while(!0);if(la(),$e=i,yo.current=l,ut!==null)throw Error(r(261));return gt=null,Nt=0,ht}function Ig(){for(;ut!==null;)qf(ut)}function Tg(){for(;ut!==null&&!t0();)qf(ut)}function qf(e){var n=eh(e.alternate,e,Gt);e.memoizedProps=e.pendingProps,n===null?Kf(e):ut=n,za.current=null}function Kf(e){var n=e;do{var i=n.alternate;if(e=n.return,(n.flags&32768)===0){if(i=bg(i,n,Gt),i!==null){ut=i;return}}else{if(i=Ng(i,n),i!==null){i.flags&=32767,ut=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ht=6,ut=null;return}}if(n=n.sibling,n!==null){ut=n;return}ut=n=e}while(n!==null);ht===0&&(ht=5)}function yr(e,n,i){var l=Ve,u=Zt.transition;try{Zt.transition=null,Ve=1,Rg(e,n,i,l)}finally{Zt.transition=u,Ve=l}return null}function Rg(e,n,i,l){do Zr();while(Gn!==null);if(($e&6)!==0)throw Error(r(327));i=e.finishedWork;var u=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var f=i.lanes|i.childLanes;if(d0(e,f),e===gt&&(ut=gt=null,Nt=0),(i.subtreeFlags&2064)===0&&(i.flags&2064)===0||bo||(bo=!0,th(Ii,function(){return Zr(),null})),f=(i.flags&15990)!==0,(i.subtreeFlags&15990)!==0||f){f=Zt.transition,Zt.transition=null;var m=Ve;Ve=1;var _=$e;$e|=4,za.current=null,Cg(e,i),Uf(i,e),K0(Gl),Oi=!!Ql,Gl=Ql=null,e.current=i,Sg(i),n0(),$e=_,Ve=m,Zt.transition=f}else e.current=i;if(bo&&(bo=!1,Gn=e,No=u),f=e.pendingLanes,f===0&&(Qn=null),i0(i.stateNode),At(e,at()),n!==null)for(l=e.onRecoverableError,i=0;i<n.length;i++)u=n[i],l(u.value,{componentStack:u.stack,digest:u.digest});if(wo)throw wo=!1,e=Ba,Ba=null,e;return(No&1)!==0&&e.tag!==0&&Zr(),f=e.pendingLanes,(f&1)!==0?e===Wa?Xs++:(Xs=0,Wa=e):Xs=0,Wn(),null}function Zr(){if(Gn!==null){var e=Au(No),n=Zt.transition,i=Ve;try{if(Zt.transition=null,Ve=16>e?16:e,Gn===null)var l=!1;else{if(e=Gn,Gn=null,No=0,($e&6)!==0)throw Error(r(331));var u=$e;for($e|=4,oe=e.current;oe!==null;){var f=oe,m=f.child;if((oe.flags&16)!==0){var _=f.deletions;if(_!==null){for(var b=0;b<_.length;b++){var I=_[b];for(oe=I;oe!==null;){var B=oe;switch(B.tag){case 0:case 11:case 15:Ys(8,B,f)}var W=B.child;if(W!==null)W.return=B,oe=W;else for(;oe!==null;){B=oe;var z=B.sibling,ne=B.return;if(Of(B),B===I){oe=null;break}if(z!==null){z.return=ne,oe=z;break}oe=ne}}}var ce=f.alternate;if(ce!==null){var fe=ce.child;if(fe!==null){ce.child=null;do{var ct=fe.sibling;fe.sibling=null,fe=ct}while(fe!==null)}}oe=f}}if((f.subtreeFlags&2064)!==0&&m!==null)m.return=f,oe=m;else e:for(;oe!==null;){if(f=oe,(f.flags&2048)!==0)switch(f.tag){case 0:case 11:case 15:Ys(9,f,f.return)}var C=f.sibling;if(C!==null){C.return=f.return,oe=C;break e}oe=f.return}}var N=e.current;for(oe=N;oe!==null;){m=oe;var E=m.child;if((m.subtreeFlags&2064)!==0&&E!==null)E.return=m,oe=E;else e:for(m=N;oe!==null;){if(_=oe,(_.flags&2048)!==0)try{switch(_.tag){case 0:case 11:case 15:vo(9,_)}}catch(pe){it(_,_.return,pe)}if(_===m){oe=null;break e}var Y=_.sibling;if(Y!==null){Y.return=_.return,oe=Y;break e}oe=_.return}}if($e=u,Wn(),pn&&typeof pn.onPostCommitFiberRoot=="function")try{pn.onPostCommitFiberRoot(Ti,e)}catch{}l=!0}return l}finally{Ve=i,Zt.transition=n}}return!1}function Jf(e,n,i){n=Xr(i,n),n=gf(e,n,1),e=Vn(e,n,1),n=Pt(),e!==null&&(ys(e,1,n),At(e,n))}function it(e,n,i){if(e.tag===3)Jf(e,e,i);else for(;n!==null;){if(n.tag===3){Jf(n,e,i);break}else if(n.tag===1){var l=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Qn===null||!Qn.has(l))){e=Xr(i,e),e=xf(n,e,1),n=Vn(n,e,1),e=Pt(),n!==null&&(ys(n,1,e),At(n,e));break}}n=n.return}}function Pg(e,n,i){var l=e.pingCache;l!==null&&l.delete(n),n=Pt(),e.pingedLanes|=e.suspendedLanes&i,gt===e&&(Nt&i)===i&&(ht===4||ht===3&&(Nt&130023424)===Nt&&500>at()-Ua?vr(e,0):$a|=i),At(e,n)}function Zf(e,n){n===0&&((e.mode&1)===0?n=1:(n=Pi,Pi<<=1,(Pi&130023424)===0&&(Pi=4194304)));var i=Pt();e=kn(e,n),e!==null&&(ys(e,n,i),At(e,i))}function Lg(e){var n=e.memoizedState,i=0;n!==null&&(i=n.retryLane),Zf(e,i)}function Mg(e,n){var i=0;switch(e.tag){case 13:var l=e.stateNode,u=e.memoizedState;u!==null&&(i=u.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(r(314))}l!==null&&l.delete(n),Zf(e,i)}var eh;eh=function(e,n,i){if(e!==null)if(e.memoizedProps!==n.pendingProps||Lt.current)Dt=!0;else{if((e.lanes&i)===0&&(n.flags&128)===0)return Dt=!1,wg(e,n,i);Dt=(e.flags&131072)!==0}else Dt=!1,tt&&(n.flags&1048576)!==0&&Rd(n,eo,n.index);switch(n.lanes=0,n.tag){case 2:var l=n.type;go(e,n),e=n.pendingProps;var u=Ur(n,St.current);Yr(n,i),u=_a(null,n,l,e,u,i);var f=wa();return n.flags|=1,typeof u=="object"&&u!==null&&typeof u.render=="function"&&u.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,Mt(l)?(f=!0,Ki(n)):f=!1,n.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,da(n),u.updater=oo,n.stateNode=u,u._reactInternals=n,ha(n,l,e,i),n=Ia(null,n,l,!0,f,i)):(n.tag=0,tt&&f&&ta(n),Rt(null,n,u,i),n=n.child),n;case 16:l=n.elementType;e:{switch(go(e,n),e=n.pendingProps,u=l._init,l=u(l._payload),n.type=l,u=n.tag=Og(l),e=sn(l,e),u){case 0:n=ja(null,n,l,e,i);break e;case 1:n=Sf(null,n,l,e,i);break e;case 11:n=wf(null,n,l,e,i);break e;case 14:n=bf(null,n,l,sn(l.type,e),i);break e}throw Error(r(306,l,""))}return n;case 0:return l=n.type,u=n.pendingProps,u=n.elementType===l?u:sn(l,u),ja(e,n,l,u,i);case 1:return l=n.type,u=n.pendingProps,u=n.elementType===l?u:sn(l,u),Sf(e,n,l,u,i);case 3:e:{if(Ef(n),e===null)throw Error(r(387));l=n.pendingProps,f=n.memoizedState,u=f.element,Ad(e,n),io(n,l,null,i);var m=n.memoizedState;if(l=m.element,f.isDehydrated)if(f={element:l,isDehydrated:!1,cache:m.cache,pendingSuspenseBoundaries:m.pendingSuspenseBoundaries,transitions:m.transitions},n.updateQueue.baseState=f,n.memoizedState=f,n.flags&256){u=Xr(Error(r(423)),n),n=jf(e,n,l,i,u);break e}else if(l!==u){u=Xr(Error(r(424)),n),n=jf(e,n,l,i,u);break e}else for(Qt=$n(n.stateNode.containerInfo.firstChild),Yt=n,tt=!0,rn=null,i=Yd(n,null,l,i),n.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Hr(),l===u){n=Sn(e,n,i);break e}Rt(e,n,l,i)}n=n.child}return n;case 5:return Qd(n),e===null&&sa(n),l=n.type,u=n.pendingProps,f=e!==null?e.memoizedProps:null,m=u.children,Xl(l,u)?m=null:f!==null&&Xl(l,f)&&(n.flags|=32),Cf(e,n),Rt(e,n,m,i),n.child;case 6:return e===null&&sa(n),null;case 13:return If(e,n,i);case 4:return pa(n,n.stateNode.containerInfo),l=n.pendingProps,e===null?n.child=Qr(n,null,l,i):Rt(e,n,l,i),n.child;case 11:return l=n.type,u=n.pendingProps,u=n.elementType===l?u:sn(l,u),wf(e,n,l,u,i);case 7:return Rt(e,n,n.pendingProps,i),n.child;case 8:return Rt(e,n,n.pendingProps.children,i),n.child;case 12:return Rt(e,n,n.pendingProps.children,i),n.child;case 10:e:{if(l=n.type._context,u=n.pendingProps,f=n.memoizedProps,m=u.value,Xe(no,l._currentValue),l._currentValue=m,f!==null)if(nn(f.value,m)){if(f.children===u.children&&!Lt.current){n=Sn(e,n,i);break e}}else for(f=n.child,f!==null&&(f.return=n);f!==null;){var _=f.dependencies;if(_!==null){m=f.child;for(var b=_.firstContext;b!==null;){if(b.context===l){if(f.tag===1){b=Cn(-1,i&-i),b.tag=2;var I=f.updateQueue;if(I!==null){I=I.shared;var B=I.pending;B===null?b.next=b:(b.next=B.next,B.next=b),I.pending=b}}f.lanes|=i,b=f.alternate,b!==null&&(b.lanes|=i),ca(f.return,i,n),_.lanes|=i;break}b=b.next}}else if(f.tag===10)m=f.type===n.type?null:f.child;else if(f.tag===18){if(m=f.return,m===null)throw Error(r(341));m.lanes|=i,_=m.alternate,_!==null&&(_.lanes|=i),ca(m,i,n),m=f.sibling}else m=f.child;if(m!==null)m.return=f;else for(m=f;m!==null;){if(m===n){m=null;break}if(f=m.sibling,f!==null){f.return=m.return,m=f;break}m=m.return}f=m}Rt(e,n,u.children,i),n=n.child}return n;case 9:return u=n.type,l=n.pendingProps.children,Yr(n,i),u=Kt(u),l=l(u),n.flags|=1,Rt(e,n,l,i),n.child;case 14:return l=n.type,u=sn(l,n.pendingProps),u=sn(l.type,u),bf(e,n,l,u,i);case 15:return Nf(e,n,n.type,n.pendingProps,i);case 17:return l=n.type,u=n.pendingProps,u=n.elementType===l?u:sn(l,u),go(e,n),n.tag=1,Mt(l)?(e=!0,Ki(n)):e=!1,Yr(n,i),Bd(n,l,u),ha(n,l,u,i),Ia(null,n,l,!0,e,i);case 19:return Rf(e,n,i);case 22:return kf(e,n,i)}throw Error(r(156,n.tag))};function th(e,n){return Pu(e,n)}function Dg(e,n,i,l){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function en(e,n,i,l){return new Dg(e,n,i,l)}function Xa(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Og(e){if(typeof e=="function")return Xa(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ie)return 11;if(e===lt)return 14}return 2}function Kn(e,n){var i=e.alternate;return i===null?(i=en(e.tag,n,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=n,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,n=e.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function Eo(e,n,i,l,u,f){var m=2;if(l=e,typeof e=="function")Xa(e)&&(m=1);else if(typeof e=="string")m=5;else e:switch(e){case M:return _r(i.children,u,f,n);case R:m=8,u|=8;break;case ye:return e=en(12,i,n,u|2),e.elementType=ye,e.lanes=f,e;case Ie:return e=en(13,i,n,u),e.elementType=Ie,e.lanes=f,e;case We:return e=en(19,i,n,u),e.elementType=We,e.lanes=f,e;case ze:return jo(i,u,f,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case P:m=10;break e;case ee:m=9;break e;case ie:m=11;break e;case lt:m=14;break e;case Qe:m=16,l=null;break e}throw Error(r(130,e==null?e:typeof e,""))}return n=en(m,i,n,u),n.elementType=e,n.type=l,n.lanes=f,n}function _r(e,n,i,l){return e=en(7,e,l,n),e.lanes=i,e}function jo(e,n,i,l){return e=en(22,e,l,n),e.elementType=ze,e.lanes=i,e.stateNode={isHidden:!1},e}function qa(e,n,i){return e=en(6,e,null,n),e.lanes=i,e}function Ka(e,n,i){return n=en(4,e.children!==null?e.children:[],e.key,n),n.lanes=i,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function Ag(e,n,i,l,u){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kl(0),this.expirationTimes=kl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kl(0),this.identifierPrefix=l,this.onRecoverableError=u,this.mutableSourceEagerHydrationData=null}function Ja(e,n,i,l,u,f,m,_,b){return e=new Ag(e,n,i,_,b),n===1?(n=1,f===!0&&(n|=8)):n=0,f=en(3,null,null,n),e.current=f,f.stateNode=e,f.memoizedState={element:l,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},da(f),e}function Fg(e,n,i){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:l==null?null:""+l,children:e,containerInfo:n,implementation:i}}function nh(e){if(!e)return Bn;e=e._reactInternals;e:{if(ar(e)!==e||e.tag!==1)throw Error(r(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(Mt(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(r(171))}if(e.tag===1){var i=e.type;if(Mt(i))return jd(e,i,n)}return n}function rh(e,n,i,l,u,f,m,_,b){return e=Ja(i,l,!0,e,u,f,m,_,b),e.context=nh(null),i=e.current,l=Pt(),u=Xn(i),f=Cn(l,u),f.callback=n??null,Vn(i,f,u),e.current.lanes=u,ys(e,u,l),At(e,l),e}function Io(e,n,i,l){var u=n.current,f=Pt(),m=Xn(u);return i=nh(i),n.context===null?n.context=i:n.pendingContext=i,n=Cn(f,m),n.payload={element:e},l=l===void 0?null:l,l!==null&&(n.callback=l),e=Vn(u,n,m),e!==null&&(an(e,u,m,f),so(e,u,m)),m}function To(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function sh(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<n?i:n}}function Za(e,n){sh(e,n),(e=e.alternate)&&sh(e,n)}function zg(){return null}var ih=typeof reportError=="function"?reportError:function(e){console.error(e)};function ec(e){this._internalRoot=e}Ro.prototype.render=ec.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(r(409));Io(e,n,null,null)},Ro.prototype.unmount=ec.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;xr(function(){Io(null,e,null,null)}),n[_n]=null}};function Ro(e){this._internalRoot=e}Ro.prototype.unstable_scheduleHydration=function(e){if(e){var n=$u();e={blockedOn:null,target:e,priority:n};for(var i=0;i<An.length&&n!==0&&n<An[i].priority;i++);An.splice(i,0,e),i===0&&Wu(e)}};function tc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Po(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function oh(){}function $g(e,n,i,l,u){if(u){if(typeof l=="function"){var f=l;l=function(){var I=To(m);f.call(I)}}var m=rh(n,l,e,0,null,!1,!1,"",oh);return e._reactRootContainer=m,e[_n]=m.current,Ls(e.nodeType===8?e.parentNode:e),xr(),m}for(;u=e.lastChild;)e.removeChild(u);if(typeof l=="function"){var _=l;l=function(){var I=To(b);_.call(I)}}var b=Ja(e,0,!1,null,null,!1,!1,"",oh);return e._reactRootContainer=b,e[_n]=b.current,Ls(e.nodeType===8?e.parentNode:e),xr(function(){Io(n,b,i,l)}),b}function Lo(e,n,i,l,u){var f=i._reactRootContainer;if(f){var m=f;if(typeof u=="function"){var _=u;u=function(){var b=To(m);_.call(b)}}Io(n,m,e,u)}else m=$g(i,n,e,u,l);return To(m)}Fu=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var i=vs(n.pendingLanes);i!==0&&(Cl(n,i|1),At(n,at()),($e&6)===0&&(Jr=at()+500,Wn()))}break;case 13:xr(function(){var l=kn(e,1);if(l!==null){var u=Pt();an(l,e,1,u)}}),Za(e,1)}},Sl=function(e){if(e.tag===13){var n=kn(e,134217728);if(n!==null){var i=Pt();an(n,e,134217728,i)}Za(e,134217728)}},zu=function(e){if(e.tag===13){var n=Xn(e),i=kn(e,n);if(i!==null){var l=Pt();an(i,e,n,l)}Za(e,n)}},$u=function(){return Ve},Uu=function(e,n){var i=Ve;try{return Ve=e,n()}finally{Ve=i}},vl=function(e,n,i){switch(n){case"input":if(Ee(e,i),n=i.name,i.type==="radio"&&n!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<i.length;n++){var l=i[n];if(l!==e&&l.form===e.form){var u=Xi(l);if(!u)throw Error(r(90));Ct(l),Ee(l,u)}}}break;case"textarea":re(e,i);break;case"select":n=i.value,n!=null&&He(e,!!i.multiple,n,!1)}},Cu=Ya,Su=xr;var Ug={usingClientEntryPoint:!1,Events:[Os,zr,Xi,Nu,ku,Ya]},qs={findFiberByHostInstance:cr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Bg={bundleType:qs.bundleType,version:qs.version,rendererPackageName:qs.rendererPackageName,rendererConfig:qs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ue.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Tu(e),e===null?null:e.stateNode},findFiberByHostInstance:qs.findFiberByHostInstance||zg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mo.isDisabled&&Mo.supportsFiber)try{Ti=Mo.inject(Bg),pn=Mo}catch{}}return Ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ug,Ft.createPortal=function(e,n){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tc(n))throw Error(r(200));return Fg(e,n,null,i)},Ft.createRoot=function(e,n){if(!tc(e))throw Error(r(299));var i=!1,l="",u=ih;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(u=n.onRecoverableError)),n=Ja(e,1,!1,null,null,i,!1,l,u),e[_n]=n.current,Ls(e.nodeType===8?e.parentNode:e),new ec(n)},Ft.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(r(188)):(e=Object.keys(e).join(","),Error(r(268,e)));return e=Tu(n),e=e===null?null:e.stateNode,e},Ft.flushSync=function(e){return xr(e)},Ft.hydrate=function(e,n,i){if(!Po(n))throw Error(r(200));return Lo(null,e,n,!0,i)},Ft.hydrateRoot=function(e,n,i){if(!tc(e))throw Error(r(405));var l=i!=null&&i.hydratedSources||null,u=!1,f="",m=ih;if(i!=null&&(i.unstable_strictMode===!0&&(u=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onRecoverableError!==void 0&&(m=i.onRecoverableError)),n=rh(n,null,e,1,i??null,u,!1,f,m),e[_n]=n.current,Ls(e),l)for(e=0;e<l.length;e++)i=l[e],u=i._getVersion,u=u(i._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[i,u]:n.mutableSourceEagerHydrationData.push(i,u);return new Ro(n)},Ft.render=function(e,n,i){if(!Po(n))throw Error(r(200));return Lo(null,e,n,!1,i)},Ft.unmountComponentAtNode=function(e){if(!Po(e))throw Error(r(40));return e._reactRootContainer?(xr(function(){Lo(null,null,e,!1,function(){e._reactRootContainer=null,e[_n]=null})}),!0):!1},Ft.unstable_batchedUpdates=Ya,Ft.unstable_renderSubtreeIntoContainer=function(e,n,i,l){if(!Po(i))throw Error(r(200));if(e==null||e._reactInternals===void 0)throw Error(r(38));return Lo(e,n,i,!1,l)},Ft.version="18.2.0-next-9e3b772b8-20220608",Ft}var ph;function qg(){if(ph)return sc.exports;ph=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),sc.exports=Xg(),sc.exports}var mh;function Kg(){if(mh)return Do;mh=1;var s=qg();return Do.createRoot=s.createRoot,Do.hydrateRoot=s.hydrateRoot,Do}var Jg=Kg();const Zg=vp(Jg),ex=({children:s,activeTab:t,setActiveTab:r,isAdmin:o,onToggleAdmin:a,onDownloadDB:d,onUploadDB:h,onOpenSync:p,isSyncActive:g})=>{const x=$.useRef(null),k=[{id:"characters",label:"",icon:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})},{id:"connections",label:"",icon:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})},{id:"worlds",label:"",icon:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})},{id:"notes",label:"",icon:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})},{id:"admin",label:"",adminOnly:!0,icon:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"})}],y=S=>{var Z;const O=(Z=S.target.files)==null?void 0:Z[0];if(!O)return;const H=new FileReader;H.onload=le=>{var we;const se=(we=le.target)==null?void 0:we.result;typeof se=="string"&&h(se)},H.readAsText(O),x.current&&(x.current.value="")},v=()=>t==="notes"?"max-w-[1920px] w-full px-4 md:px-8":"max-w-6xl w-full px-4 py-8 md:px-12 md:py-12";return c.jsxs("div",{className:"min-h-screen flex flex-col md:flex-row bg-[#050505] text-stone-300",children:[c.jsxs("div",{className:"md:hidden flex items-center justify-between px-6 py-5 border-b border-stone-900 bg-[#050505]/95 backdrop-blur sticky top-0 z-40",children:[c.jsx("h1",{className:"text-lg font-serif font-bold tracking-[0.2em] text-stone-400 uppercase",children:""}),c.jsx("button",{onClick:a,className:`p-2 rounded-lg transition-all border ${o?"bg-emerald-950/20 border-emerald-900/50 text-emerald-500":"bg-stone-900/50 border-stone-800 text-stone-500"}`,children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})]}),c.jsxs("aside",{className:"hidden md:flex w-64 border-r border-stone-900 flex-col fixed h-screen bg-[#050505] z-50",children:[c.jsx("div",{className:"p-8",children:c.jsx("h1",{className:"text-xl font-serif font-bold tracking-[0.2em] text-stone-400 uppercase",children:""})}),c.jsx("nav",{className:"flex-grow px-4 space-y-2",children:k.filter(S=>!S.adminOnly||o).map(S=>c.jsxs("button",{onClick:()=>r(S.id),className:`w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all flex items-center gap-3 ${t===S.id?"bg-stone-900 text-stone-100 border-l-2 border-emerald-500 rounded-l-none":"hover:bg-stone-900/50 text-stone-500 hover:text-stone-300"} ${S.adminOnly?"text-emerald-500/70":""}`,children:[c.jsx("svg",{className:"w-5 h-5 opacity-70",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:S.icon}),S.label]},S.id))}),c.jsxs("div",{className:"p-6 space-y-4",children:[c.jsxs("button",{onClick:p,className:`w-full py-2 px-3 rounded-lg border text-[9px] uppercase tracking-widest font-bold flex items-center justify-center gap-2 transition-all ${g?"bg-emerald-900/10 border-emerald-500/30 text-emerald-500 hover:bg-emerald-900/20":"bg-stone-900/30 border-stone-800 text-stone-600 hover:bg-stone-900/60 hover:text-stone-400"}`,children:[c.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${g?"bg-emerald-500 animate-pulse":"bg-stone-600"}`}),g?"":""]}),c.jsx("button",{onClick:a,className:`w-full py-3 text-[10px] uppercase tracking-widest font-bold rounded-md transition-all border ${o?"bg-emerald-950/20 border-emerald-900/50 text-emerald-500 shadow-lg shadow-emerald-900/10":"bg-stone-900/50 hover:bg-stone-900 border-stone-800 text-stone-400"}`,children:o?" ()":"  "})]})]}),c.jsx("nav",{className:"md:hidden fixed bottom-0 w-full bg-[#050505]/95 backdrop-blur-xl border-t border-stone-900 z-50 px-2 pb-safe-area",children:c.jsxs("div",{className:"flex justify-around items-center",children:[k.filter(S=>!S.adminOnly||o).map(S=>c.jsxs("button",{onClick:()=>r(S.id),className:`flex flex-col items-center justify-center py-3 px-2 w-full transition-all ${t===S.id?"text-emerald-500":"text-stone-600"}`,children:[c.jsx("svg",{className:"w-6 h-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:S.icon}),c.jsx("span",{className:"text-[9px] uppercase font-bold tracking-wider",children:S.label})]},S.id)),c.jsxs("button",{onClick:p,className:`flex flex-col items-center justify-center py-3 px-2 w-full transition-all ${g?"text-emerald-500":"text-stone-700"}`,children:[c.jsx("svg",{className:"w-6 h-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),c.jsx("span",{className:"text-[9px] uppercase font-bold tracking-wider",children:""})]})]})}),c.jsxs("main",{className:"flex-grow md:ml-64 min-h-screen relative pb-24 md:pb-0",children:[c.jsx("div",{className:`${v()} mx-auto transition-all duration-300 py-8 md:py-12`,children:s}),c.jsxs("div",{className:"fixed bottom-24 md:bottom-8 right-4 md:right-8 flex gap-3 z-40 scale-90 md:scale-100 origin-bottom-right",children:[c.jsx("input",{type:"file",ref:x,onChange:y,accept:".json",className:"hidden"}),c.jsx("button",{onClick:()=>{var S;return(S=x.current)==null?void 0:S.click()},className:"px-4 py-2 md:px-5 md:py-2.5 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 rounded-full text-[9px] md:text-[10px] uppercase tracking-widest font-bold text-emerald-500 transition-all backdrop-blur-sm shadow-lg shadow-emerald-900/10",children:" "}),c.jsx("button",{onClick:d,className:"px-4 py-2 md:px-5 md:py-2.5 bg-stone-900/80 hover:bg-stone-800 border border-stone-700 rounded-full text-[9px] md:text-[10px] uppercase tracking-widest font-bold text-stone-300 transition-all backdrop-blur-sm",children:" "})]})]})]})},tx=({character:s,isVisible:t=!0,staggerIndex:r=0,onClick:o})=>{const a=$.useRef(null),[d,h]=$.useState({x:0,y:0}),[p,g]=$.useState({x:50,y:50,opacity:0}),[x,k]=$.useState(!1),[y,v]=$.useState(!1),S=$.useMemo(()=>Array.from({length:8}).map((M,R)=>({id:R,left:`${Math.random()*100}%`,delay:`${Math.random()*.6}s`,duration:`${1+Math.random()}s`,size:`${1.5+Math.random()*2}px`})),[]),O=M=>{if(!a.current||!t)return;const R=a.current.getBoundingClientRect(),ye=R.left+R.width/2,P=R.top+R.height/2,ee=-(M.clientY-P)/(R.height/2)*12,ie=(M.clientX-ye)/(R.width/2)*12,Ie=(M.clientX-R.left)/R.width*100,We=(M.clientY-R.top)/R.height*100;h({x:ee,y:ie}),g({x:Ie,y:We,opacity:.5})},H=()=>t&&k(!0),Z=()=>{h({x:0,y:0}),g(M=>({...M,opacity:0})),k(!1),v(!1)},le={objectFit:"cover",objectPosition:`${s.miniImageX??50}% ${s.miniImageY??50}%`,transformOrigin:`${s.miniImageX??50}% ${s.miniImageY??50}%`,transform:`scale(${s.miniImageScale??1})`},se=s.name.length,we=se>20?"text-sm":se>15?"text-base":"text-xl",ue=x?`${-d.y*2.5}px ${d.x*2.5}px 50px -10px rgba(16, 185, 129, 0.3)`:"0 10px 15px -3px rgba(0, 0, 0, 0.1)",Ae=t?`${Math.min(r*45,900)}ms`:"0ms",G=y?.96:x?1.04:1;return c.jsx("div",{className:`relative mb-10 px-5 w-full sm:w-1/2 lg:w-1/4 perspective-2000 preserve-3d transition-opacity duration-500 ${t?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,style:{animation:t?"reveal-3d-fire 1.1s cubic-bezier(0.22, 1, 0.36, 1) both":"disappear-3d-fire 0.6s cubic-bezier(0.22, 1, 0.36, 1) both",animationDelay:t?Ae:"0ms"},children:c.jsxs("div",{className:"h-full relative preserve-3d pointer-events-none",children:[t&&S.map(M=>c.jsx("div",{className:"absolute bottom-4 bg-emerald-400 rounded-full blur-[0.5px] z-0 pointer-events-none",style:{left:M.left,width:M.size,height:M.size,animation:`ember-float ${M.duration} ease-out both`,animationDelay:`calc(${Ae} + ${M.delay})`,boxShadow:"0 0 6px #10b981"}},M.id)),c.jsx("div",{className:"absolute inset-0 bg-emerald-500/20 blur-[60px] rounded-full transition-opacity duration-700 pointer-events-none -z-10",style:{opacity:x?.45:0,transform:`translate3d(${-d.y*4}px, ${d.x*4}px, -50px) scale(${x?1.1:1})`}}),c.jsxs("div",{ref:a,onMouseMove:O,onMouseEnter:H,onMouseLeave:Z,onMouseDown:()=>t&&v(!0),onMouseUp:()=>v(!1),onClick:()=>t&&o(s.id),style:{transform:`rotateX(${d.x}deg) rotateY(${d.y}deg) scale(${G})`,boxShadow:ue,transition:x&&!y?"transform 0.1s ease-out, box-shadow 0.1s ease-out":"transform 0.7s cubic-bezier(0.23, 1, 0.32, 1), box-shadow 0.7s ease"},className:"relative bg-[#0f0f0f]/80 border border-stone-900 rounded-2xl p-6 flex flex-col items-center group cursor-pointer h-full min-h-[320px] preserve-3d overflow-hidden backdrop-blur-sm pointer-events-auto z-10",children:[c.jsx("div",{className:"absolute inset-0 pointer-events-none z-20 transition-opacity duration-300",style:{background:`radial-gradient(circle at ${p.x}% ${p.y}%, rgba(255,255,255,0.12) 0%, transparent 60%)`,opacity:p.opacity}}),c.jsx("div",{className:`absolute inset-0 border border-emerald-500/20 rounded-2xl transition-opacity duration-500 pointer-events-none ${x?"opacity-100":"opacity-0"}`}),c.jsx("div",{className:"relative mt-2 shrink-0 translate-z-30 pointer-events-none",children:c.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden border-2 border-stone-800 group-hover:border-emerald-500/50 transition-all duration-500 bg-black shadow-2xl",children:c.jsx("img",{src:s.imageUrl,alt:s.name,style:le,className:"w-full h-full opacity-80 group-hover:opacity-100 transition-all duration-700 group-hover:scale-110"})})}),c.jsxs("div",{className:"mt-6 flex flex-col items-center justify-center w-full px-2 shrink-0 translate-z-20 pointer-events-none",children:[c.jsx("h3",{className:`font-serif font-medium text-stone-100 group-hover:text-emerald-100 transition-colors text-center leading-tight line-clamp-1 ${we}`,children:s.name}),c.jsxs("div",{className:"flex items-center gap-1.5 mt-3",children:[s.age&&c.jsxs("div",{className:"bg-stone-900/60 border border-stone-800 px-2.5 py-1 rounded-lg flex items-baseline gap-1 shadow-inner",children:[c.jsx("span",{className:"text-[11px] font-bold text-stone-300 tracking-tight",children:s.age.toString().replace(/[^0-9]/g,"")||s.age}),c.jsx("span",{className:"text-[7px] font-black uppercase tracking-widest text-emerald-600/80",children:""})]}),s.height&&c.jsxs("div",{className:"bg-stone-900/60 border border-stone-800 px-2.5 py-1 rounded-lg flex items-baseline gap-1 shadow-inner",children:[c.jsx("span",{className:"text-[11px] font-bold text-stone-300 tracking-tight",children:s.height.toString().replace(/[^0-9]/g,"")||s.height}),c.jsx("span",{className:"text-[7px] font-black uppercase tracking-widest text-emerald-600/80",children:""})]})]})]}),c.jsx("div",{className:"mt-5 flex flex-wrap gap-1.5 justify-center content-start min-h-[28px] w-full px-1 translate-z-10 pointer-events-none",children:s.tags&&s.tags.length>0?c.jsx(c.Fragment,{children:s.tags.slice(0,3).map(M=>c.jsx("span",{className:"px-2 py-0.5 bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 text-[8px] uppercase tracking-wider font-black rounded-md whitespace-nowrap",children:M},M))}):c.jsx("div",{className:"h-4"})}),c.jsx("div",{className:"mt-auto pt-6 border-t border-stone-900/50 w-full flex justify-center shrink-0 translate-z-10 pointer-events-none",children:c.jsx("span",{className:"text-[8px] uppercase tracking-[0.3em] font-black text-stone-700 group-hover:text-emerald-500 transition-colors",children:" "})})]})]})})},nx=yp.memo(tx,(s,t)=>s.character.id===t.character.id&&JSON.stringify(s.character)===JSON.stringify(t.character)&&s.isVisible===t.isVisible&&s.staggerIndex===t.staggerIndex),gh=({imageUrl:s,scale:t,x:r,y:o,isCircular:a=!1,onUpdate:d})=>{const h=$.useRef(null),[p,g]=$.useState(!1),[x,k]=$.useState({x:0,y:0}),y=v=>{g(!0),k({x:v.clientX,y:v.clientY})};return $.useEffect(()=>{const v=O=>{if(!p||!h.current)return;const H=O.clientX-x.x,Z=O.clientY-x.y,le=.2,se=r-H*le/t,we=o-Z*le/t;d({x:se,y:we}),k({x:O.clientX,y:O.clientY})},S=()=>g(!1);return p&&(window.addEventListener("mousemove",v),window.addEventListener("mouseup",S)),()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",S)}},[p,x,r,o,t,d]),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{ref:h,className:`relative overflow-hidden bg-black border border-stone-800 cursor-move group select-none shadow-2xl transition-all duration-500 hover:border-emerald-500/40 ${a?"w-48 h-48 rounded-full mx-auto":"aspect-[4/5] rounded-3xl w-full"}`,onMouseDown:y,children:[c.jsx("img",{src:s,alt:"",draggable:!1,style:{width:"100%",height:"100%",objectFit:"cover",objectPosition:`${r}% ${o}%`,transformOrigin:`${r}% ${o}%`,transform:`scale(${t})`},className:"pointer-events-none transition-opacity duration-300 opacity-90 group-hover:opacity-100"}),c.jsx("div",{className:"absolute inset-0 ring-1 ring-inset ring-white/5 pointer-events-none"}),c.jsx("div",{className:"absolute inset-0 bg-emerald-500/5 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity flex items-center justify-center",children:c.jsx("div",{className:"bg-black/60 backdrop-blur-md px-4 py-2 rounded-full border border-emerald-500/20",children:c.jsx("span",{className:"text-[9px] font-black text-emerald-400 uppercase tracking-[0.25em]",children:" "})})})]}),c.jsxs("div",{className:"bg-stone-900/60 p-4 rounded-2xl border border-stone-800/50 space-y-3 shadow-inner",children:[c.jsxs("div",{className:"flex justify-between items-center px-1",children:[c.jsx("span",{className:"text-[10px] font-black text-stone-500 uppercase tracking-widest",children:""}),c.jsxs("span",{className:"text-[10px] font-mono text-emerald-500 bg-emerald-500/10 px-2 py-0.5 rounded",children:[t.toFixed(2),"x"]})]}),c.jsx("input",{type:"range",min:"1",max:"5",step:"0.01",value:t,onChange:v=>d({scale:parseFloat(v.target.value)}),className:"w-full h-1.5 bg-stone-800 rounded-full appearance-none cursor-pointer accent-emerald-500"}),c.jsx("p",{className:"text-[8px] text-stone-700 text-center uppercase tracking-tighter",children:"      "})]})]})},zo=(s,t=800,r=.6)=>new Promise((o,a)=>{const d=new FileReader;d.readAsDataURL(s),d.onload=h=>{var g;const p=new Image;p.src=(g=h.target)==null?void 0:g.result,p.onload=()=>{const x=document.createElement("canvas");let k=p.width,y=p.height;k>t&&(y=y*t/k,k=t),x.width=k,x.height=y;const v=x.getContext("2d");if(v){v.drawImage(p,0,0,k,y);const S=x.toDataURL("image/jpeg",r);o(S)}else a(new Error("Canvas context not available"))},p.onerror=x=>a(x)},d.onerror=h=>a(h)}),rx=({character:s,isAdmin:t,allCharacters:r,availableTags:o,availableHiddenTags:a,worlds:d,notes:h=[],onBack:p,onSave:g,onSelectCharacter:x,onDeleteNote:k})=>{var me,Ce;const[y,v]=$.useState(s),[S,O]=$.useState(!1),[H,Z]=$.useState(!1),[le,se]=$.useState(!1),[we,ue]=$.useState(!1),[Ae,G]=$.useState(""),[M,R]=$.useState([]);$.useEffect(()=>{v(s)},[s]);const ye=$.useMemo(()=>{var T,X;if(!d)return null;for(const de of d){if((T=de.characterIds)!=null&&T.includes(s.id))return de.name;if(de.subLocations){for(const be of de.subLocations)if((X=be.characterIds)!=null&&X.includes(s.id))return`${de.name} / ${be.name}`}}return null},[d,s.id]),P=$.useMemo(()=>Array.isArray(h)?h.filter(T=>T&&(T.targetId===s.id||T.authorId===s.id)):[],[h,s.id]),ee=(T,X)=>{v(de=>({...de,[T]:X}))},ie=T=>{v(X=>({...X,imageScale:T.scale??X.imageScale,imageX:T.x??X.imageX,imageY:T.y??X.imageY}))},Ie=T=>{v(X=>({...X,miniImageScale:T.scale??X.miniImageScale,miniImageX:T.x??X.miniImageX,miniImageY:T.y??X.miniImageY}))},We=async T=>{var de;const X=(de=T.target.files)==null?void 0:de[0];if(X){ue(!0);try{const be=await zo(X);ee("imageUrl",be)}catch(be){console.error("Error processing image",be),alert("   ")}finally{ue(!1)}}},lt=(T,X=!1)=>{if(X){const de=y.hiddenTags||[],be=de.includes(T)?de.filter(Ct=>Ct!==T):[...de,T];ee("hiddenTags",be)}else{const de=y.tags||[],be=de.includes(T)?de.filter(Ct=>Ct!==T):[...de,T];ee("tags",be)}},Qe=()=>{g(y)},ze=()=>{v(s)},V=()=>{t&&g(y),p()},J=()=>{se(!le),G(""),R([])},w=T=>{const X={id:T.id,name:T.name,role:"",color:"#ef4444"},de=y.connections||[];de.some(be=>be.id===T.id)||ee("connections",[...de,X]),se(!1)},A=T=>{const X=y.connections||[];ee("connections",X.filter(de=>de.id!==T))},te=(T,X)=>{const de=y.connections||[];ee("connections",de.map(be=>be.id===T?{...be,role:X}:be))},D=(T,X)=>{const de=y.connections||[];ee("connections",de.map(be=>be.id===T?{...be,color:X}:be))},L=T=>{R(X=>X.includes(T)?X.filter(de=>de!==T):[...X,T])},Q=r.filter(T=>{var X;if(!T||T.id===y.id||(X=y.connections)!=null&&X.some(de=>de.id===T.id)||Ae&&!T.name.toLowerCase().includes(Ae.toLowerCase()))return!1;if(M.length>0){const de=[...T.tags||[],...T.hiddenTags||[]];return M.every(be=>de.includes(be))}return!0});return c.jsxs("div",{className:"animate-reveal-details space-y-6 md:space-y-8 pb-20",children:[c.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4 animate-stagger-1",children:[c.jsxs("button",{onClick:V,className:"flex items-center text-stone-500 hover:text-emerald-500 transition-colors group text-sm md:text-base order-1",children:[c.jsx("svg",{className:"w-5 h-5 mr-2 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})," ()"]}),t&&c.jsxs("div",{className:"flex items-center gap-3 order-2 w-full md:w-auto justify-end",children:[c.jsx("button",{onClick:ze,className:"px-4 py-2 rounded-lg border border-stone-800 text-stone-500 hover:text-white hover:bg-stone-800 text-[10px] uppercase font-bold tracking-wider transition-all",children:""}),c.jsxs("button",{onClick:Qe,className:"px-5 py-2 rounded-lg bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 hover:bg-emerald-900/40 text-[10px] uppercase font-bold tracking-wider transition-all flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),""]})]})]}),c.jsxs("div",{className:"block clearfix",children:[c.jsxs("div",{className:"w-full lg:w-[35%] lg:float-left lg:mr-12 mb-8 space-y-8 animate-stagger-2",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsx("h4",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 px-1",children:" "}),t?c.jsxs("div",{className:"space-y-4",children:[c.jsx(gh,{imageUrl:y.imageUrl,scale:y.imageScale??1,x:y.imageX??50,y:y.imageY??50,onUpdate:ie}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{className:"w-full bg-[#050505] border border-stone-800 rounded-lg px-3 py-2 text-[10px] text-stone-400 outline-none focus:border-emerald-500",placeholder:y.imageUrl.startsWith("data:")?"   ":"URL ...",value:y.imageUrl.startsWith("data:")?"":y.imageUrl,onChange:T=>ee("imageUrl",T.target.value)}),c.jsxs("label",{className:`cursor-pointer bg-stone-900 border border-stone-800 hover:bg-stone-800 rounded-lg px-3 flex items-center justify-center transition-colors ${we?"opacity-50":""}`,children:[c.jsx("input",{type:"file",onChange:We,accept:"image/*",className:"hidden",disabled:we}),c.jsx("svg",{className:"w-4 h-4 text-emerald-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})]})]})]}):c.jsx("div",{className:"aspect-[4/5] rounded-2xl overflow-hidden border border-stone-800 shadow-2xl bg-black transition-transform duration-700 hover:scale-[1.02]",children:c.jsx("img",{src:y.imageUrl,alt:y.name,style:{objectFit:"cover",objectPosition:`${y.imageX??50}% ${y.imageY??50}%`,transformOrigin:`${y.imageX??50}% ${y.imageY??50}%`,transform:`scale(${y.imageScale??1})`},className:"w-full h-full"})})]}),t&&c.jsxs("div",{className:"space-y-4 pt-4 border-t border-stone-900/50",children:[c.jsx("h4",{className:"text-[10px] uppercase tracking-widest font-bold text-emerald-500/60 px-1",children:"- ()"}),c.jsx(gh,{imageUrl:y.imageUrl,scale:y.miniImageScale??1,x:y.miniImageX??50,y:y.miniImageY??50,isCircular:!0,onUpdate:Ie})]}),c.jsxs("div",{className:"space-y-5 p-5 md:p-7 bg-[#0f0f0f]/40 border border-stone-900 rounded-[2rem] md:rounded-[2.5rem] shadow-inner transition-all hover:bg-[#0f0f0f]/50",children:[c.jsx("h4",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-emerald-500/60 px-1 text-center",children:""}),c.jsx("div",{className:"flex flex-wrap gap-2 justify-center min-h-[40px]",children:t?c.jsxs(c.Fragment,{children:[o.map(T=>{var X;return c.jsx("button",{onClick:()=>lt(T,!1),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border ${(X=y.tags)!=null&&X.includes(T)?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400":"bg-stone-950 border-stone-800/50 text-stone-700 hover:text-stone-400"}`,children:T},T)}),o.length>0&&a.length>0&&c.jsx("div",{className:"w-full h-px bg-stone-900/50 my-1"}),a.map(T=>{var X;return c.jsx("button",{onClick:()=>lt(T,!0),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border ${(X=y.hiddenTags)!=null&&X.includes(T)?"bg-amber-500/10 border-amber-500/40 text-amber-400":"bg-stone-950 border-stone-800/50 text-stone-700 hover:text-stone-400"}`,children:T},T)})]}):(me=y.tags)==null?void 0:me.map(T=>c.jsx("span",{className:"px-3 py-1.5 md:px-4 md:py-2 bg-emerald-500/5 border border-emerald-500/10 text-emerald-500/70 text-[9px] md:text-[10px] uppercase tracking-widest font-black rounded-xl",children:T},T))})]})]}),c.jsx("div",{className:"animate-stagger-3",children:c.jsxs("div",{className:"mb-6 md:mb-8",children:[t?c.jsx("div",{className:"space-y-4 mb-4",children:c.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[c.jsxs("div",{className:"flex-grow",children:[c.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-1",children:""}),c.jsx("input",{className:"w-full bg-transparent border-b border-stone-800 text-3xl md:text-4xl font-serif font-bold text-stone-100 outline-none focus:border-emerald-800 transition-colors py-1",value:y.name,onChange:T=>ee("name",T.target.value)})]}),c.jsxs("div",{className:"w-full md:w-32",children:[c.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-1",children:""}),c.jsx("input",{className:"w-full bg-transparent border-b border-stone-800 text-xl font-light text-stone-500 outline-none focus:border-emerald-800 transition-colors py-2",value:y.age,onChange:T=>ee("age",T.target.value)})]}),c.jsxs("div",{className:"w-full md:w-32",children:[c.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-1",children:""}),c.jsx("input",{className:"w-full bg-transparent border-b border-stone-800 text-xl font-light text-stone-500 outline-none focus:border-emerald-800 transition-colors py-2",value:y.height||"",placeholder:". 180 ",onChange:T=>ee("height",T.target.value)})]})]})}):c.jsxs("div",{className:"space-y-4 mb-6",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 md:gap-6",children:[c.jsx("h1",{className:"text-3xl md:text-5xl font-serif font-bold text-stone-100 leading-tight",children:y.name}),c.jsxs("div",{className:"flex items-center gap-2",children:[y.age&&c.jsxs("div",{className:"bg-stone-900 border border-stone-800 px-3 py-1 rounded-xl flex items-baseline gap-1.5 shadow-lg",children:[c.jsx("span",{className:"text-stone-100 font-bold text-lg",children:y.age.toString().replace(/[^0-9]/g,"")||y.age}),c.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-emerald-500/70",children:""})]}),y.height&&c.jsxs("div",{className:"bg-stone-900 border border-stone-800 px-3 py-1 rounded-xl flex items-baseline gap-1.5 shadow-lg",children:[c.jsx("span",{className:"text-stone-100 font-bold text-lg",children:y.height.toString().replace(/[^0-9]/g,"")||y.height}),c.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-emerald-500/70",children:""})]})]})]}),ye&&c.jsxs("div",{className:"inline-flex items-center gap-2 bg-emerald-900/10 border border-emerald-900/30 px-3 py-1.5 rounded-full mt-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"}),c.jsx("span",{className:"text-[10px] uppercase tracking-widest font-bold text-emerald-500",children:ye})]})]}),c.jsx("div",{className:"h-px bg-stone-900 w-full mb-6 md:mb-8"}),c.jsxs("section",{className:"space-y-4 mb-8",children:[c.jsx("h4",{className:"text-emerald-500 text-sm font-semibold uppercase tracking-wider",children:""}),t?c.jsx("textarea",{className:"w-full bg-stone-900/20 border border-stone-800 rounded-xl p-4 text-stone-200 text-base md:text-lg leading-relaxed font-light outline-none focus:border-emerald-900 transition-colors resize-none break-words",rows:12,value:y.additionalInfo,onChange:T=>ee("additionalInfo",T.target.value)}):c.jsx("p",{className:"text-stone-300 text-base md:text-lg leading-relaxed font-light whitespace-pre-wrap break-words",children:y.additionalInfo})]}),P.length>0&&c.jsxs("div",{className:"space-y-3 mb-6",children:[c.jsxs("button",{onClick:()=>Z(!H),className:"w-full flex items-center justify-between bg-[#0f0f0f]/30 border border-stone-900 p-4 md:p-5 rounded-xl transition-all group hover:border-amber-900/30 shadow-md",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"text-amber-600 font-bold tracking-widest text-xs uppercase",children:"  "}),c.jsxs("span",{className:"text-stone-600 text-sm",children:["(",P.length,")"]})]}),c.jsx("svg",{className:`w-4 h-4 text-stone-600 transition-transform duration-300 ${H?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]}),H&&c.jsx("div",{className:"space-y-4 animate-reveal-details",children:P.map(T=>c.jsxs("div",{className:"bg-stone-900/20 border border-stone-900/50 rounded-xl p-4 md:p-5",children:[c.jsx("h5",{className:"text-stone-200 font-serif italic text-xl mb-3 break-words",children:T.title}),c.jsx("p",{className:"text-stone-300 text-base md:text-lg leading-relaxed whitespace-pre-wrap font-light break-words",children:T.content}),c.jsx("div",{className:"mt-4 pt-3 border-t border-stone-900/50 flex justify-between",children:c.jsx("span",{className:"text-[10px] uppercase font-bold text-stone-600",children:T.date})})]},T.id))})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex flex-col gap-4",children:[t&&c.jsxs("button",{onClick:J,className:`w-full py-4 rounded-xl border transition-all text-[10px] uppercase font-bold tracking-[0.2em] flex items-center justify-center gap-3 ${le?"bg-emerald-500 border-emerald-400 text-black shadow-[0_0_20px_rgba(16,185,129,0.2)]":"bg-emerald-900/20 border-emerald-900/50 text-emerald-400 hover:bg-emerald-900/30"}`,children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:le?"M6 18L18 6M6 6l12 12":"M12 4v16m8-8H4"})}),le?"":" "]}),c.jsxs("button",{onClick:()=>O(!S),className:"w-full flex items-center justify-between bg-[#0f0f0f]/30 border border-stone-900 p-4 md:p-5 rounded-xl transition-all group hover:border-emerald-900/30 shadow-md",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"text-emerald-500 font-bold tracking-widest text-xs uppercase",children:""}),c.jsxs("span",{className:"text-stone-600 text-sm",children:["(",((Ce=y.connections)==null?void 0:Ce.length)||0,")"]})]}),c.jsx("svg",{className:`w-4 h-4 text-stone-600 transition-transform duration-300 ${S?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]})]}),t&&le&&c.jsxs("div",{className:"animate-reveal-details bg-[#0a0a0a] border border-emerald-900/30 rounded-2xl p-4 md:p-6 space-y-4 shadow-2xl overflow-hidden relative",children:[c.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:c.jsx("input",{autoFocus:!0,type:"text",placeholder:"   ...",className:"flex-grow bg-stone-950 border border-stone-800 rounded-xl px-4 py-3 text-sm text-stone-200 outline-none focus:border-emerald-500/50 transition-colors",value:Ae,onChange:T=>G(T.target.value)})}),c.jsx("div",{className:"flex flex-wrap gap-1.5 max-h-24 overflow-y-auto custom-scrollbar",children:o.map(T=>c.jsx("button",{onClick:()=>L(T),className:`px-2 py-1 rounded-lg text-[9px] uppercase font-bold tracking-wider transition-all border ${M.includes(T)?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:T},T))}),c.jsx("div",{className:"flex flex-col gap-2 max-h-60 overflow-y-auto custom-scrollbar pr-2",children:Q.length>0?Q.map(T=>c.jsxs("button",{onClick:()=>w(T),className:"flex items-center gap-4 p-3 bg-stone-900/50 border border-stone-800 rounded-xl hover:bg-emerald-900/20 hover:border-emerald-900/40 transition-all text-left group",children:[c.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:c.jsx("img",{src:T.imageUrl,style:{objectFit:"cover",objectPosition:`${T.miniImageX??50}% ${T.miniImageY??50}%`,transformOrigin:`${T.miniImageX??50}% ${T.miniImageY??50}%`,transform:`scale(${T.miniImageScale??1})`},className:"w-full h-full",alt:""})}),c.jsxs("div",{className:"min-w-0 flex-grow",children:[c.jsx("span",{className:"text-stone-200 font-bold text-sm block truncate group-hover:text-emerald-400",children:T.name}),c.jsx("span",{className:"text-[10px] text-stone-600 uppercase tracking-widest block truncate",children:"  "})]}),c.jsx("svg",{className:"w-4 h-4 text-emerald-500 opacity-0 group-hover:opacity-100 transition-all",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})]},T.id)):c.jsx("p",{className:"text-stone-700 italic text-xs py-4 text-center",children:"  "})})]}),S&&c.jsx("div",{className:"space-y-3 animate-reveal-details",children:c.jsx("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-xl overflow-hidden divide-y divide-stone-900/50",children:y.connections&&y.connections.length>0?y.connections.map(T=>{const X=r.find(de=>de&&de.id===T.id);return c.jsxs("div",{className:"p-4 flex flex-row items-center gap-4 group hover:bg-stone-900/20 transition-colors",children:[c.jsxs("div",{className:"flex items-center gap-4 flex-grow min-w-0",children:[c.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 rounded-full overflow-hidden border border-stone-800 shrink-0 bg-black",children:c.jsx("img",{src:(X==null?void 0:X.imageUrl)||"",style:{objectFit:"cover",objectPosition:`${(X==null?void 0:X.miniImageX)??50}% ${(X==null?void 0:X.miniImageY)??50}%`,transformOrigin:`${(X==null?void 0:X.miniImageX)??50}% ${(X==null?void 0:X.miniImageY)??50}%`,transform:`scale(${(X==null?void 0:X.miniImageScale)??1})`},className:"w-full h-full",alt:""})}),c.jsxs("div",{className:"flex-grow min-w-0",children:[c.jsx("p",{className:"text-stone-200 font-bold text-sm truncate",children:T.name}),t?c.jsx("input",{className:"bg-transparent border-b border-stone-800 text-xs text-stone-500 outline-none focus:border-emerald-500 py-1 w-full max-w-[150px]",value:T.role,onChange:de=>te(T.id,de.target.value)}):c.jsx("p",{className:"text-stone-600 text-xs mt-1 font-medium truncate",children:T.role})]})]}),c.jsxs("div",{className:"flex items-center justify-end gap-5 shrink-0",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[t?c.jsx("input",{type:"color",className:"w-6 h-6 rounded-sm bg-transparent border-none cursor-pointer p-0 appearance-none shadow-lg",value:T.color||"#ef4444",onChange:de=>D(T.id,de.target.value)}):c.jsx("div",{className:"w-4 h-4 rounded-sm shadow-sm",style:{backgroundColor:T.color||"#ef4444"}}),c.jsx("button",{onClick:()=>x(T.id),className:"text-stone-700 hover:text-stone-100 transition-colors text-[9px] md:text-[10px] uppercase font-bold tracking-[0.2em]",children:""})]}),t&&c.jsx("button",{onClick:()=>A(T.id),className:"text-stone-800 hover:text-red-500 transition-colors p-1",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})]},T.id)}):c.jsx("div",{className:"p-10 text-center text-stone-700 italic text-sm",children:"  "})})})]})]})})]})]})},sx=({initialData:s,availableTags:t,availableHiddenTags:r,onSave:o,onClose:a})=>{const[d,h]=$.useState({name:"",age:"",height:"",imageUrl:"",additionalInfo:"",imageScale:1,imageX:50,imageY:50,tags:[],hiddenTags:[]}),[p,g]=$.useState(!1);$.useEffect(()=>{var v;s&&h({name:s.name,age:s.age.toString(),height:((v=s.height)==null?void 0:v.toString())||"",imageUrl:s.imageUrl,additionalInfo:s.additionalInfo,imageScale:s.imageScale??1,imageX:s.imageX??50,imageY:s.imageY??50,tags:s.tags||[],hiddenTags:s.hiddenTags||[]})},[s]);const x=(v,S)=>{h(S?O=>({...O,hiddenTags:O.hiddenTags.includes(v)?O.hiddenTags.filter(H=>H!==v):[...O.hiddenTags,v]}):O=>({...O,tags:O.tags.includes(v)?O.tags.filter(H=>H!==v):[...O.tags,v]}))},k=async v=>{var O;const S=(O=v.target.files)==null?void 0:O[0];if(S){g(!0);try{const H=await zo(S);h(Z=>({...Z,imageUrl:H}))}catch(H){console.error("Error processing image",H),alert("   .")}finally{g(!1)}}},y=v=>{v.preventDefault();const S={id:(s==null?void 0:s.id)||Date.now().toString(),name:d.name,age:d.age,height:d.height,imageUrl:d.imageUrl||`https://picsum.photos/seed/${Date.now()}/400/500`,additionalInfo:d.additionalInfo,tags:d.tags,hiddenTags:d.hiddenTags,connections:(s==null?void 0:s.connections)||[],imageScale:d.imageScale,imageX:d.imageX,imageY:d.imageY};o(S)};return c.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center p-4 bg-black/95 backdrop-blur-2xl animate-in fade-in duration-300",children:c.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-2xl rounded-[2rem] md:rounded-[3rem] overflow-hidden shadow-[0_0_120px_rgba(0,0,0,1)] border-white/5 flex flex-col max-h-[90vh]",children:[c.jsxs("div",{className:"p-6 md:p-10 border-b border-stone-900 flex justify-between items-center bg-gradient-to-b from-stone-900/30 to-transparent shrink-0",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl md:text-3xl font-serif text-stone-100 italic",children:s?" ":" "}),c.jsx("p",{className:"text-stone-600 text-[10px] uppercase tracking-widest mt-1",children:"  "})]}),c.jsx("button",{onClick:a,className:"text-stone-700 hover:text-white transition-all p-2 md:p-3 hover:bg-white/5 rounded-full",children:c.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("form",{onSubmit:y,className:"p-6 md:p-10 space-y-8 md:space-y-10 overflow-y-auto custom-scrollbar flex-grow",children:[c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"space-y-3",children:[c.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:"  "}),c.jsx("input",{required:!0,className:"w-full bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-4 text-stone-100 outline-none focus:border-emerald-500/30 transition-all font-serif italic text-lg shadow-inner",value:d.name,onChange:v=>h({...d,name:v.target.value})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8",children:[c.jsxs("div",{className:"space-y-3",children:[c.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:""}),c.jsx("input",{required:!0,className:"w-full bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-4 text-stone-100 outline-none focus:border-emerald-500/30 transition-all shadow-inner",value:d.age,onChange:v=>h({...d,age:v.target.value})})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:""}),c.jsx("input",{className:"w-full bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-4 text-stone-100 outline-none focus:border-emerald-500/30 transition-all shadow-inner",value:d.height,placeholder:". 185 ",onChange:v=>h({...d,height:v.target.value})})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-between items-end px-1",children:[c.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600",children:"  ()"}),c.jsxs("span",{className:"text-[9px] text-stone-800 font-black uppercase tracking-widest",children:[": ",d.tags.length]})]}),c.jsx("div",{className:"flex flex-wrap gap-2 p-6 bg-black/30 border border-stone-900 rounded-[2rem] min-h-[80px] shadow-inner",children:t.length===0?c.jsx("p",{className:"text-stone-800 italic text-xs w-full text-center py-4",children:"     -"}):t.map(v=>{const S=d.tags.includes(v);return c.jsx("button",{type:"button",onClick:()=>x(v,!1),className:`px-4 py-2 rounded-xl text-[10px] uppercase tracking-wider font-black transition-all border ${S?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":"bg-stone-900/20 border-stone-800/40 text-stone-600 hover:border-stone-700 hover:text-stone-400"}`,children:v},v)})})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-between items-end px-1",children:[c.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-amber-600",children:"  ()"}),c.jsxs("span",{className:"text-[9px] text-amber-900/60 font-black uppercase tracking-widest",children:[": ",d.hiddenTags.length]})]}),c.jsx("div",{className:"flex flex-wrap gap-2 p-6 bg-black/30 border border-amber-900/20 rounded-[2rem] min-h-[80px] shadow-inner",children:r.length===0?c.jsx("p",{className:"text-stone-800 italic text-xs w-full text-center py-4",children:"    "}):r.map(v=>{const S=d.hiddenTags.includes(v);return c.jsx("button",{type:"button",onClick:()=>x(v,!0),className:`px-4 py-2 rounded-xl text-[10px] uppercase tracking-wider font-black transition-all border ${S?"bg-amber-500/10 border-amber-500/40 text-amber-400 shadow-[0_0_15px_rgba(245,158,11,0.1)]":"bg-stone-900/20 border-stone-800/40 text-stone-600 hover:border-amber-900/30 hover:text-amber-500/50"}`,children:v},v)})})]})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:" (  )"}),c.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[c.jsx("input",{className:"flex-grow bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-3 text-xs text-stone-500 outline-none focus:border-emerald-500/30 transition-all",placeholder:"    ...",value:d.imageUrl.startsWith("data:")?"":d.imageUrl,onChange:v=>h({...d,imageUrl:v.target.value})}),c.jsxs("label",{className:`cursor-pointer bg-stone-900/50 hover:bg-stone-800 px-5 py-3 rounded-2xl transition-all flex items-center justify-center border border-stone-800 gap-2 ${p?"opacity-50 cursor-wait":""}`,children:[c.jsx("input",{type:"file",accept:"image/*",onChange:k,className:"hidden",disabled:p}),c.jsx("svg",{className:"w-5 h-5 text-stone-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),d.imageUrl.startsWith("data:")&&c.jsx("span",{className:"text-[9px] font-bold text-emerald-500 uppercase tracking-wider",children:""})]})]}),d.imageUrl.startsWith("data:")&&c.jsx("p",{className:"text-[9px] text-emerald-500/70 px-2",children:"    ."})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:" "}),c.jsx("textarea",{required:!0,rows:8,className:"w-full bg-stone-900/30 border border-stone-800 rounded-[2rem] px-8 py-6 text-stone-300 text-base leading-relaxed outline-none focus:border-emerald-900/30 transition-all resize-none shadow-inner custom-scrollbar",value:d.additionalInfo,onChange:v=>h({...d,additionalInfo:v.target.value})})]})]}),c.jsxs("div",{className:"p-6 md:p-10 border-t border-stone-900 bg-stone-900/10 flex gap-4 md:gap-6 shrink-0",children:[c.jsx("button",{type:"button",onClick:a,className:"flex-1 py-4 md:py-5 text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 hover:text-stone-300 transition-all",children:""}),c.jsx("button",{onClick:y,disabled:p,className:"flex-[2] py-4 md:py-5 bg-white hover:bg-emerald-50 text-black rounded-2xl text-[10px] uppercase tracking-[0.3em] font-black transition-all shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",children:p?"...":""})]})]})})},ix=({characters:s,availableTags:t,availableHiddenTags:r,onDelete:o,onEdit:a,onAdd:d,onUpdateTags:h,onUpdateHiddenTags:p,onDownloadDB:g,onUploadDB:x})=>{const[k,y]=$.useState(""),[v,S]=$.useState(""),O=$.useRef(null),H=M=>{M.preventDefault();const R=k.trim().toLowerCase();R&&!t.includes(R)&&(h([...t,R]),y(""))},Z=M=>{M.preventDefault();const R=v.trim().toLowerCase();R&&!r.includes(R)&&(p([...r,R]),S(""))},le=M=>{h(t.filter(R=>R!==M))},se=M=>{p(r.filter(R=>R!==M))},we=(M,R,ye=!1)=>{const P=ye?[...r]:[...t],ee=ye?p:h;R==="left"&&M>0?[P[M-1],P[M]]=[P[M],P[M-1]]:R==="right"&&M<P.length-1&&([P[M+1],P[M]]=[P[M],P[M+1]]),ee(P)},ue=(M=!1)=>{window.confirm(` ,      ${M?"":""} ?`)&&(M?p([]):h([]))},Ae=M=>{var P;const R=(P=M.target.files)==null?void 0:P[0];if(!R)return;const ye=new FileReader;ye.onload=ee=>{var Ie;const ie=(Ie=ee.target)==null?void 0:Ie.result;typeof ie=="string"&&x(ie)},ye.readAsText(R),O.current&&(O.current.value="")},G=(M,R)=>c.jsx("div",{className:"flex flex-wrap gap-2 max-h-[300px] overflow-y-auto custom-scrollbar pr-2",children:M.length===0?c.jsx("p",{className:"text-stone-800 italic text-[10px] w-full text-center py-8",children:" ."}):M.map((ye,P)=>c.jsxs("div",{className:`group flex items-center border rounded-xl pr-2 pl-1 py-1 transition-all hover:bg-stone-900 ${R?"bg-amber-900/10 border-amber-900/30 hover:border-amber-700":"bg-stone-900/50 border-stone-800/50 hover:border-stone-600"}`,children:[c.jsx("button",{onClick:()=>we(P,"left",R),disabled:P===0,className:`p-1 text-stone-600 hover:text-emerald-500 transition-all ${P===0?"opacity-0 pointer-events-none":"opacity-0 group-hover:opacity-100"}`,children:c.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M15 19l-7-7 7-7"})})}),c.jsx("span",{className:`text-[10px] uppercase tracking-wider font-bold px-1 select-none ${R?"text-amber-500":"text-stone-500"}`,children:ye}),c.jsx("button",{onClick:()=>we(P,"right",R),disabled:P===M.length-1,className:`p-1 text-stone-600 hover:text-emerald-500 transition-all ${P===M.length-1?"opacity-0 pointer-events-none":"opacity-0 group-hover:opacity-100"}`,children:c.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M9 5l7 7-7 7"})})}),c.jsx("div",{className:`w-px h-3 mx-1 ${R?"bg-amber-900/30":"bg-stone-800"}`}),c.jsx("button",{onClick:()=>R?se(ye):le(ye),className:"text-stone-700 hover:text-red-500 transition-colors ml-1",children:c.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:c.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]},ye))});return c.jsxs("div",{className:"space-y-12 animate-in fade-in duration-700 pb-32",children:[c.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-b border-stone-900/50 pb-8",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100",children:""}),c.jsx("p",{className:"text-stone-500 uppercase tracking-widest text-[10px]",children:"   "})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("input",{type:"file",ref:O,onChange:Ae,accept:".json",className:"hidden"}),c.jsxs("button",{onClick:()=>{var M;return(M=O.current)==null?void 0:M.click()},className:"px-5 py-2.5 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 rounded-lg text-[10px] uppercase tracking-widest font-bold text-emerald-500 transition-all flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})," "]}),c.jsxs("button",{onClick:g,className:"px-5 py-2.5 bg-stone-900/80 hover:bg-stone-800 border border-stone-700 rounded-lg text-[10px] uppercase tracking-widest font-bold text-stone-300 transition-all flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})," "]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[c.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("h2",{className:"text-2xl font-serif text-stone-100 italic",children:" "}),c.jsx("span",{className:"text-[10px] bg-emerald-500/10 text-emerald-500 px-2 py-0.5 rounded-full font-black",children:s.length})]}),c.jsx("button",{onClick:d,className:"bg-white hover:bg-emerald-50 text-black px-6 py-2 rounded-full text-[10px] uppercase tracking-widest font-black transition-all",children:""})]}),c.jsx("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl overflow-hidden shadow-xl",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-left min-w-[600px]",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"border-b border-stone-900 bg-stone-900/20",children:[c.jsx("th",{className:"px-6 py-5 text-[10px] uppercase tracking-widest font-black text-stone-600",children:""}),c.jsx("th",{className:"px-6 py-5 text-[10px] uppercase tracking-widest font-black text-stone-600",children:""}),c.jsx("th",{className:"px-6 py-5 text-[10px] uppercase tracking-widest font-black text-stone-600 text-right",children:""})]})}),c.jsx("tbody",{className:"divide-y divide-stone-900/50",children:s.map(M=>{var R,ye,P,ee;return c.jsxs("tr",{className:"hover:bg-stone-900/10 transition-colors",children:[c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:c.jsx("img",{src:M.imageUrl,style:{objectFit:"cover",objectPosition:`${M.miniImageX??50}% ${M.miniImageY??50}%`,transformOrigin:`${M.miniImageX??50}% ${M.miniImageY??50}%`,transform:`scale(${M.miniImageScale??1})`},className:"w-full h-full",alt:""})}),c.jsx("span",{className:"font-bold text-stone-200 text-sm tracking-wide",children:M.name})]})}),c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsxs("div",{className:"flex flex-wrap gap-1",children:[(R=M.tags)==null?void 0:R.slice(0,3).map(ie=>c.jsx("span",{className:"text-[8px] uppercase bg-stone-900 px-1.5 py-0.5 rounded text-stone-500",children:ie},ie)),(((ye=M.tags)==null?void 0:ye.length)||0)>3&&c.jsxs("span",{className:"text-[8px] text-stone-700",children:["+",M.tags.length-3]})]}),c.jsxs("div",{className:"flex flex-wrap gap-1",children:[(P=M.hiddenTags)==null?void 0:P.slice(0,3).map(ie=>c.jsx("span",{className:"text-[8px] uppercase bg-amber-900/20 border border-amber-900/30 px-1.5 py-0.5 rounded text-amber-600",children:ie},ie)),(((ee=M.hiddenTags)==null?void 0:ee.length)||0)>3&&c.jsxs("span",{className:"text-[8px] text-amber-700",children:["+",M.hiddenTags.length-3]})]})]})}),c.jsxs("td",{className:"px-6 py-4 text-right space-x-3",children:[c.jsx("button",{onClick:()=>a(M),className:"text-emerald-500/70 hover:text-emerald-500 text-[10px] font-black uppercase tracking-widest transition-colors",children:""}),c.jsx("button",{onClick:()=>o(M.id),className:"text-stone-800 hover:text-red-500 text-[10px] font-black uppercase tracking-widest transition-colors",children:""})]})]},M.id)})})]})})})]}),c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl p-6 space-y-6 shadow-xl",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h2",{className:"text-xl font-serif text-stone-100 italic",children:" "}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-[10px] bg-stone-800 text-stone-400 px-2 py-0.5 rounded-full font-black",children:t.length}),t.length>0&&c.jsx("button",{onClick:()=>ue(!1),className:"text-[8px] text-red-900 hover:text-red-500 uppercase font-black",children:""})]})]}),c.jsxs("form",{onSubmit:H,className:"flex gap-2",children:[c.jsx("input",{type:"text",value:k,onChange:M=>y(M.target.value),placeholder:" ...",className:"flex-grow bg-black/50 border border-stone-800 rounded-xl px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-all"}),c.jsx("button",{className:"bg-stone-800 hover:bg-stone-700 text-white p-2 rounded-xl transition-all",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{d:"M12 4v16m8-8H4",strokeWidth:2.5})})})]}),G(t,!1)]}),c.jsxs("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl p-6 space-y-6 shadow-xl relative overflow-hidden",children:[c.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-amber-500/5 rounded-full blur-2xl -translate-y-10 translate-x-10 pointer-events-none"}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h2",{className:"text-xl font-serif text-amber-500 italic",children:" "}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-[10px] bg-amber-900/20 text-amber-500 px-2 py-0.5 rounded-full font-black",children:r.length}),r.length>0&&c.jsx("button",{onClick:()=>ue(!0),className:"text-[8px] text-red-900 hover:text-red-500 uppercase font-black",children:""})]})]}),c.jsxs("form",{onSubmit:Z,className:"flex gap-2",children:[c.jsx("input",{type:"text",value:v,onChange:M=>S(M.target.value),placeholder:"  ...",className:"flex-grow bg-black/50 border border-amber-900/30 rounded-xl px-3 py-2 text-xs text-stone-200 outline-none focus:border-amber-500/50 transition-all placeholder-amber-900/50"}),c.jsx("button",{className:"bg-amber-900/20 hover:bg-amber-900/40 text-amber-500 border border-amber-900/30 p-2 rounded-xl transition-all",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{d:"M12 4v16m8-8H4",strokeWidth:2.5})})})]}),G(r,!0)]})]})]})]})},ox="modulepreload",lx=function(s){return"/raz/"+s},xh={},vh=function(t,r,o){let a=Promise.resolve();if(r&&r.length>0){let h=function(x){return Promise.all(x.map(k=>Promise.resolve(k).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),g=(p==null?void 0:p.nonce)||(p==null?void 0:p.getAttribute("nonce"));a=h(r.map(x=>{if(x=lx(x),x in xh)return;xh[x]=!0;const k=x.endsWith(".css"),y=k?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${y}`))return;const v=document.createElement("link");if(v.rel=k?"stylesheet":ox,k||(v.as="script"),v.crossOrigin="",v.href=x,g&&v.setAttribute("nonce",g),document.head.appendChild(v),k)return new Promise((S,O)=>{v.addEventListener("load",S),v.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${x}`)))})}))}function d(h){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=h,window.dispatchEvent(p),!p.defaultPrevented)throw h}return a.then(h=>{for(const p of h||[])p.status==="rejected"&&d(p.reason);return t().catch(d)})},ax=({characters:s,availableTags:t,availableHiddenTags:r,filterStates:o,onToggleTag:a,onClearFilters:d,onSelectCharacter:h})=>{var hn;const[p,g]=$.useState("graph"),[x,k]=$.useState(""),[y,v]=$.useState(!1),[S,O]=$.useState(""),[H,Z]=$.useState([]),le=$.useRef(null),[se,we]=$.useState(!1),[ue,Ae]=$.useState(null),[G,M]=$.useState(null),[R,ye]=$.useState(0),[P,ee]=$.useState(!0),[ie,Ie]=$.useState(!1),We=$.useRef(null),lt=$.useRef(null),Qe=$.useRef(null),ze=$.useRef(null),V=$.useRef(new Map),[J,w]=$.useState({x:0,y:0,k:1}),A=Object.keys(o).length;$.useEffect(()=>{if(p==="graph"){Ie(!0);const j=setTimeout(()=>Ie(!1),2200);return()=>clearTimeout(j)}},[ue,se,A,p]),$.useEffect(()=>{const j=ae=>{le.current&&!le.current.contains(ae.target)&&v(!1)};return y&&document.addEventListener("mousedown",j),()=>{document.removeEventListener("mousedown",j)}},[y]);const{nodes:te,links:D,uniqueColors:L}=$.useMemo(()=>{if(p!=="graph")return{nodes:[],links:[],uniqueColors:[]};const j=s.filter(q=>ue&&q.id===ue?!0:Object.entries(o).every(([U,he])=>{var yn,Ht;const Te=(yn=q.tags)==null?void 0:yn.includes(U),Oe=(Ht=q.hiddenTags)==null?void 0:Ht.includes(U),Ye=Te||Oe;return he==="include"?Ye:he==="exclude"?!Ye:!0})),ae=new Set(j.map(q=>q.id)),ge=new Set;ue&&(ge.add(ue),j.forEach(q=>{var U,he;q.id===ue&&((U=q.connections)==null||U.forEach(Te=>{ae.has(Te.id)&&ge.add(Te.id)})),(he=q.connections)!=null&&he.some(Te=>Te.id===ue)&&ge.add(q.id)}));const Ee=new Map,Se=[...t],Fe=380,je=260;Se.forEach((q,U)=>{const he=U/Se.length*2*Math.PI;Ee.set(q,{x:500+Math.cos(he)*Fe,y:350+Math.sin(he)*je})});const He=j.map(q=>{const U=V.current.get(q.id);let he=!1;if(ue)he=!ge.has(q.id);else if(se){const Ye=q.connections||[],yn=j.filter(Ht=>{var or;return Ht.id!==q.id&&((or=Ht.connections)==null?void 0:or.some(lr=>lr.id===q.id))});he=Ye.length+yn.length===0}let Te=500,Oe=350;if(!U)if(q.tags&&q.tags.length>0){let Ye=0,yn=0,Ht=0;q.tags.forEach(or=>{const lr=Ee.get(or);lr&&(Ye+=lr.x,yn+=lr.y,Ht++)}),Ht>0?(Te=Ye/Ht,Oe=yn/Ht,Te+=(Math.random()-.5)*80,Oe+=(Math.random()-.5)*80):(Te+=(Math.random()-.5)*150,Oe+=(Math.random()-.5)*150)}else Te+=(Math.random()-.5)*120,Oe+=(Math.random()-.5)*120;return{id:q.id,name:q.name,imageUrl:q.imageUrl,miniImageScale:q.miniImageScale,miniImageX:q.miniImageX,miniImageY:q.miniImageY,x:(U==null?void 0:U.x)??Te,y:(U==null?void 0:U.y)??Oe,vx:U==null?void 0:U.vx,vy:U==null?void 0:U.vy,isDimmed:he,tags:q.tags,hiddenTags:q.hiddenTags}}),nt=new Map;He.forEach(q=>nt.set(q.id,q)),V.current=nt;const F=[],re=new Set,_e=new Map;return j.forEach(q=>{var U;(U=q.connections)==null||U.forEach(he=>{if(ae.has(he.id)){const Te=he.color||"#10b981";re.add(Te);let Oe=!1;ue&&(Oe=q.id!==ue&&he.id!==ue),F.push({source:q.id,target:he.id,role:he.role,color:Te,isDouble:!1,isHidden:Oe}),_e.set(`${q.id}-${he.id}`,!0)}})}),F.forEach(q=>{const U=typeof q.source=="string"?q.source:q.source.id,he=typeof q.target=="string"?q.target:q.target.id;_e.has(`${he}-${U}`)&&(q.isDouble=!0)}),{nodes:He,links:F,uniqueColors:Array.from(re)}},[s,se,ue,o,t,p]),Q=j=>{if(!We.current||!ze.current)return;const ae=te.find(ge=>ge.id===j);!ae||ae.x===void 0||ae.y===void 0||vh(()=>import("https://esm.sh/d3@7"),[]).then(ge=>{const Ee=ge.select(We.current),Se=1e3,Fe=700,je=.8,He=Se/2-ae.x*je,nt=Fe/2-ae.y*je;Ee.transition().duration(1200).ease(ge.easePolyInOut.exponent(3)).call(ze.current.transform,ge.zoomIdentity.translate(He,nt).scale(je))})};$.useEffect(()=>{if(ue&&p==="graph"){const j=setTimeout(()=>Q(ue),100);return()=>clearTimeout(j)}},[ue,p]),$.useEffect(()=>{!We.current||p!=="graph"||(ee(!0),vh(()=>import("https://esm.sh/d3@7"),[]).then(j=>{const ae=j.select(We.current),ge=j.select(lt.current),Ee=j.zoom().scaleExtent([.1,4]).on("zoom",je=>{ge.attr("transform",je.transform),w({x:je.transform.x,y:je.transform.y,k:je.transform.k}),M(null)});ze.current=Ee,ae.call(Ee);const Se=j.forceSimulation(te).velocityDecay(.4).force("link",j.forceLink(D.filter(je=>!je.isHidden)).id(je=>je.id).distance(je=>{const He=je.source.tags||[],nt=je.target.tags||[],F=He.some(re=>nt.includes(re));return He.length===0||nt.length===0?250:F?150:450}).strength(ue?.05:.03)).force("charge",j.forceManyBody().strength(ue?-2e3:-1e3)).force("x",j.forceX(500).strength(.05)).force("y",j.forceY(350).strength(.05)).force("collision",j.forceCollide().radius(75)).alphaDecay(.05);Se.on("tick",()=>{ye(je=>je+1),Se.alpha()<.2&&ee(!1)}),Qe.current=Se;const Fe=je=>{function He(re,_e){re.active||je.alphaTarget(.3).restart(),_e.fx=_e.x,_e.fy=_e.y,M(null)}function nt(re,_e){_e.fx=re.x,_e.fy=re.y}function F(re,_e){re.active||je.alphaTarget(0),_e.fx=null,_e.fy=null}return j.drag().on("start",He).on("drag",nt).on("end",F)};return ge.selectAll(".node-group").data(te).call(Fe(Se)),()=>Se.stop()}))},[te,D,p]);const me=j=>{const ae=typeof j.source=="string"?te.find(Te=>Te.id===j.source):j.source,ge=typeof j.target=="string"?te.find(Te=>Te.id===j.target):j.target;if(!(ae!=null&&ae.x)||!(ae!=null&&ae.y)||!(ge!=null&&ge.x)||!(ge!=null&&ge.y))return null;const Ee=52,Se=ge.x-ae.x,Fe=ge.y-ae.y,je=Math.sqrt(Se*Se+Fe*Fe);if(je<Ee*2.2)return null;const He=Se/je,nt=Fe/je,F=ae.x+Ee*He,re=ae.y+Ee*nt,_e=ge.x-Ee*He,q=ge.y-Ee*nt;let U="",he={x:0,y:0};if(j.isDouble){const Oe=(ae.x+ge.x)/2+-nt*50,Ye=(ae.y+ge.y)/2+He*50;U=`M${F},${re} Q${Oe},${Ye} ${_e},${q}`,he.x=.25*F+.5*Oe+.25*_e,he.y=.25*re+.5*Ye+.25*q}else U=`M${F},${re} L${_e},${q}`,he.x=(F+_e)/2,he.y=(re+q)/2;return{path:U,textPos:he}},Ce=j=>j.replace("#",""),T=j=>{Z(ae=>ae.includes(j)?ae.filter(ge=>ge!==j):[...ae,j])},X=$.useMemo(()=>s.filter(j=>{const ae=j.name.toLowerCase().includes(S.toLowerCase()),ge=H.length===0||H.every(Ee=>{var Se,Fe;return((Se=j.tags)==null?void 0:Se.includes(Ee))||((Fe=j.hiddenTags)==null?void 0:Fe.includes(Ee))});return ae&&ge}).sort((j,ae)=>j.name.localeCompare(ae.name)),[s,S,H]),{outgoingConnections:de,incomingConnections:be,currentTableChar:Ct}=$.useMemo(()=>{if(p!=="table"||!x)return{outgoingConnections:[],incomingConnections:[],currentTableChar:null};const j=s.find(Ee=>Ee.id===x),ae=((j==null?void 0:j.connections)||[]).map(Ee=>{const Se=s.find(Fe=>Fe.id===Ee.id);return{...Ee,targetChar:Se}}),ge=s.filter(Ee=>{var Se;return(Se=Ee.connections)==null?void 0:Se.some(Fe=>Fe.id===x)}).map(Ee=>{var Fe;const Se=(Fe=Ee.connections)==null?void 0:Fe.find(je=>je.id===x);return{sourceChar:Ee,role:Se==null?void 0:Se.role,color:Se==null?void 0:Se.color}});return{outgoingConnections:ae,incomingConnections:ge,currentTableChar:j}},[s,x,p]);return c.jsxs("div",{className:`flex flex-col h-full space-y-4 md:space-y-4 select-none relative ${ie?"is-mounting":""}`,onClick:()=>M(null),children:[c.jsxs("div",{className:"bg-[#0f0f0f]/50 border border-stone-900 rounded-2xl p-4 flex flex-col gap-4 backdrop-blur-sm shadow-lg relative z-20",children:[c.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[c.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[c.jsxs("div",{className:"bg-stone-950 p-1 rounded-lg border border-stone-800 flex items-center",children:[c.jsx("button",{onClick:()=>g("graph"),className:`px-4 py-1.5 rounded-md text-[10px] uppercase font-bold tracking-wider transition-all ${p==="graph"?"bg-stone-800 text-stone-100 shadow-sm":"text-stone-500 hover:text-stone-300"}`,children:""}),c.jsx("button",{onClick:()=>g("table"),className:`px-4 py-1.5 rounded-md text-[10px] uppercase font-bold tracking-wider transition-all ${p==="table"?"bg-stone-800 text-stone-100 shadow-sm":"text-stone-500 hover:text-stone-300"}`,children:""})]}),p==="graph"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"h-6 w-px bg-stone-800 hidden md:block"}),c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[c.jsx("input",{type:"checkbox",checked:se,disabled:!!ue,onChange:j=>we(j.target.checked),className:"sr-only"}),c.jsx("div",{className:`w-4 h-4 border border-stone-700 rounded transition-colors ${se?"bg-emerald-600 border-emerald-500":"bg-transparent"}`,children:se&&c.jsx("svg",{className:"w-3.5 h-3.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),c.jsx("span",{className:`text-[11px] uppercase tracking-wider font-bold text-stone-500 group-hover:text-stone-300 transition-colors ${ue?"opacity-30":""}`,children:" "})]})]})]}),p==="graph"?ue&&c.jsx("button",{onClick:()=>{Ae(null),ee(!0)},className:"w-full md:w-auto bg-emerald-950/30 border border-emerald-900/50 text-emerald-500 px-4 py-2 rounded-full text-[10px] uppercase tracking-[0.2em] font-black hover:bg-emerald-900/40 transition-all",children:" "}):c.jsxs("div",{className:"w-full md:w-80 relative z-50",ref:le,children:[c.jsxs("button",{onClick:()=>v(!y),className:"w-full bg-stone-950 border border-stone-800 text-stone-300 text-xs py-2.5 pl-4 pr-10 rounded-xl text-left focus:border-emerald-900 transition-colors flex items-center justify-between",children:[c.jsx("span",{className:x?"":"text-stone-500 italic",children:x?(hn=s.find(j=>j.id===x))==null?void 0:hn.name:"--   --"}),c.jsx("svg",{className:`w-4 h-4 text-stone-600 transition-transform ${y?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),y&&c.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-[#0a0a0a] border border-stone-800 rounded-xl shadow-2xl overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200 flex flex-col max-h-[400px]",children:[c.jsxs("div",{className:"p-3 bg-stone-900/50 border-b border-stone-900 space-y-3 shrink-0 backdrop-blur-md",children:[c.jsx("input",{type:"text",placeholder:"...",value:S,onChange:j=>O(j.target.value),className:"w-full bg-stone-950 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-colors",autoFocus:!0}),(t.length>0||r.length>0)&&c.jsxs("div",{className:"flex flex-wrap gap-1.5 max-h-20 overflow-y-auto custom-scrollbar",children:[t.map(j=>{const ae=H.includes(j);return c.jsx("button",{onClick:()=>T(j),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${ae?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:j},j)}),r.map(j=>{const ae=H.includes(j);return c.jsx("button",{onClick:()=>T(j),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${ae?"bg-amber-500/20 border-amber-500/40 text-amber-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-amber-500"}`,children:j},j)})]})]}),c.jsx("div",{className:"overflow-y-auto p-1 custom-scrollbar",children:X.length>0?X.map(j=>c.jsxs("button",{onClick:()=>{k(j.id),v(!1),O(""),Z([])},className:`w-full flex items-center gap-3 p-2 hover:bg-stone-900 rounded-lg text-left transition-colors group ${x===j.id?"bg-stone-900/80":""}`,children:[c.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:c.jsx("img",{src:j.imageUrl,style:{objectPosition:`${j.miniImageX??50}% ${j.miniImageY??50}%`,transform:`scale(${j.miniImageScale??1})`,transformOrigin:`${j.miniImageX??50}% ${j.miniImageY??50}%`},className:"w-full h-full object-cover",alt:""})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("span",{className:`text-xs font-bold block truncate ${x===j.id?"text-emerald-400":"text-stone-300"}`,children:j.name}),j.tags&&j.tags.length>0&&c.jsxs("span",{className:"text-[8px] text-stone-600 truncate block mt-0.5",children:[j.tags.slice(0,3).join(", "),j.tags.length>3?"...":""]})]}),x===j.id&&c.jsx("div",{className:"ml-auto text-emerald-500",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]},j.id)):c.jsx("div",{className:"text-center py-4 text-[10px] text-stone-600 italic",children:"  "})})]})]})]}),p==="graph"&&(t.length>0||r.length>0)&&c.jsxs("div",{className:"flex flex-wrap items-center gap-2 pt-3 border-t border-stone-800/50 animate-in fade-in slide-in-from-top-1 duration-500",children:[c.jsx("span",{className:"text-[9px] uppercase tracking-[0.2em] font-black text-stone-600 mr-2",children:":"}),t.map(j=>{const ae=o[j]||"none";return c.jsxs("button",{onClick:()=>a(j),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${ae==="include"?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":ae==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-stone-400 hover:border-stone-700"}`,children:[ae==="include"&&c.jsx("span",{className:"text-emerald-500",children:"+"}),ae==="exclude"&&c.jsx("span",{className:"text-red-500",children:""}),j]},j)}),r.map(j=>{const ae=o[j]||"none";return c.jsxs("button",{onClick:()=>a(j),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${ae==="include"?"bg-amber-500/10 border-amber-500/40 text-amber-400 shadow-[0_0_15px_rgba(245,158,11,0.1)]":ae==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-amber-500 hover:border-amber-900/30"}`,children:[ae==="include"&&c.jsx("span",{className:"text-amber-500",children:"+"}),ae==="exclude"&&c.jsx("span",{className:"text-red-500",children:""}),j]},j)}),A>0&&c.jsx("button",{onClick:d,className:"ml-2 text-[9px] uppercase tracking-[0.2em] font-black text-stone-700 hover:text-red-500 transition-colors",children:""})]})]}),c.jsxs("div",{className:"relative z-0 w-full h-full min-h-[500px] bg-[#030303] border border-stone-900 rounded-2xl overflow-hidden shadow-2xl graph-container-reveal",children:[p==="graph"&&c.jsxs(c.Fragment,{children:[c.jsxs("svg",{ref:We,viewBox:"0 0 1000 700",className:"w-full h-full touch-none cursor-grab active:cursor-grabbing",children:[c.jsx("defs",{children:L.map(j=>c.jsx("marker",{id:`arrow-${Ce(j)}`,markerWidth:"8",markerHeight:"6",refX:"7.5",refY:"3",orient:"auto",children:c.jsx("path",{d:"M0,0 L8,3 L0,6",fill:j})},`arrow-${Ce(j)}`))}),c.jsxs("g",{ref:lt,children:[D.map((j,ae)=>{const ge=me(j);if(!ge)return null;const Ee=j.color||"#10b981",Se=j.isHidden;return c.jsxs("g",{className:`transition-opacity duration-700 ${Se?"opacity-0":"opacity-100"}`,children:[c.jsx("path",{d:ge.path,fill:"none",stroke:Ee,strokeWidth:ue?"3":"1.5",strokeOpacity:ue?"0.8":"0.3",markerEnd:`url(#arrow-${Ce(Ee)})`,className:"link-path",style:ie?{animationDelay:`${ae*.015}s`}:{}}),ue&&j.role&&!Se&&c.jsxs("g",{transform:`translate(${ge.textPos.x}, ${ge.textPos.y})`,children:[c.jsx("text",{dy:"-14",textAnchor:"middle",className:"fill-[#030303] text-[10px] font-bold uppercase tracking-[0.2em]",style:{paintOrder:"stroke",stroke:"#030303",strokeWidth:"5px"},children:j.role}),c.jsx("text",{dy:"-14",textAnchor:"middle",fill:Ee,className:"text-[10px] font-bold uppercase tracking-[0.2em] opacity-90",children:j.role})]})]},`link-${ae}-${R}`)}),te.map((j,ae)=>{const ge=ue===j.id;return c.jsx("g",{transform:`translate(${j.x||500}, ${j.y||350})`,className:`node-group cursor-pointer group ${j.isDimmed?"opacity-0 pointer-events-none":"opacity-100"}`,onClick:Ee=>{if(Ee.stopPropagation(),j.x&&j.y){const Se=j.x*J.k+J.x,Fe=j.y*J.k+J.y;M({id:j.id,x:Se,y:Fe})}},children:c.jsxs("g",{className:"node-animator",style:ie?{animationDelay:`${ae*.06}s`}:{},children:[c.jsxs("g",{className:"node-content",children:[c.jsx("circle",{r:"48",fill:"#1c1917"}),c.jsx("circle",{r:"46",fill:"#050505",stroke:ge?"#10b981":"#292524",strokeWidth:ge?"4":"1.5"}),c.jsx("clipPath",{id:`clip-${j.id}`,children:c.jsx("circle",{r:"45"})}),c.jsx("foreignObject",{x:"-45",y:"-45",width:"90",height:"90",clipPath:`url(#clip-${j.id})`,children:c.jsx("div",{className:"w-full h-full bg-black flex items-center justify-center overflow-hidden",children:c.jsx("img",{src:j.imageUrl,alt:"",style:{width:"100%",height:"100%",objectFit:"cover",objectPosition:`${j.miniImageX??50}% ${j.miniImageY??50}%`,transformOrigin:`${j.miniImageX??50}% ${j.miniImageY??50}%`,transform:`scale(${j.miniImageScale??1})`},className:"opacity-90 group-hover:opacity-100 group-hover:scale-110 transition-all duration-500"})})})]}),c.jsx("text",{y:"70",textAnchor:"middle",className:"fill-stone-500 text-[12px] font-bold uppercase tracking-[0.15em] group-hover:fill-stone-100 transition-colors drop-shadow-[0_2px_2px_rgba(0,0,0,0.8)] font-serif",children:j.name})]})},j.id)})]})]}),P&&c.jsx("div",{className:"absolute inset-0 bg-[#030303]/40 flex items-center justify-center backdrop-blur-[1px] pointer-events-none",children:c.jsx("div",{className:"text-[10px] uppercase tracking-[0.4em] font-black text-emerald-500/50 animate-pulse",children:" ..."})})]}),p==="table"&&c.jsx("div",{className:"w-full h-full overflow-y-auto custom-scrollbar p-6 md:p-10",children:x?c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16",children:[c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center gap-3 border-b border-stone-800 pb-4",children:[c.jsx("span",{className:"text-emerald-500 bg-emerald-900/10 px-2 py-1 rounded text-xs font-bold",children:"OUT"}),c.jsxs("h3",{className:"text-lg font-serif text-stone-200 italic",children:["  ",Ct==null?void 0:Ct.name,"?"]}),c.jsx("span",{className:"ml-auto text-stone-600 text-xs font-bold",children:de.length})]}),c.jsx("div",{className:"space-y-3",children:de.length===0?c.jsx("p",{className:"text-stone-700 text-xs italic py-4",children:"       ..."}):de.map((j,ae)=>{var ge,Ee,Se,Fe,je,He;return c.jsxs("div",{className:"flex items-start gap-4 p-4 bg-stone-900/30 border border-stone-900/50 rounded-xl hover:bg-stone-900/50 hover:border-emerald-900/30 transition-all group",children:[c.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:c.jsx("img",{src:(ge=j.targetChar)==null?void 0:ge.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${((Ee=j.targetChar)==null?void 0:Ee.miniImageX)??50}% ${((Se=j.targetChar)==null?void 0:Se.miniImageY)??50}%`,transform:`scale(${((Fe=j.targetChar)==null?void 0:Fe.miniImageScale)??1})`,transformOrigin:`${((je=j.targetChar)==null?void 0:je.miniImageX)??50}% ${((He=j.targetChar)==null?void 0:He.miniImageY)??50}%`},alt:""})}),c.jsxs("div",{className:"flex-grow min-w-0",children:[c.jsxs("div",{className:"flex justify-between items-baseline",children:[c.jsx("h4",{className:"text-stone-300 font-bold text-sm truncate",children:j.name}),c.jsx("button",{onClick:()=>h(j.id),className:"text-[9px] uppercase font-bold text-stone-700 hover:text-emerald-500 transition-colors opacity-0 group-hover:opacity-100",children:""})]}),c.jsx("p",{className:"text-stone-500 text-xs mt-1 font-medium",children:j.role})]}),c.jsx("div",{className:"w-1.5 h-8 rounded-full self-center",style:{backgroundColor:j.color||"#10b981"}})]},ae)})})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center gap-3 border-b border-stone-800 pb-4",children:[c.jsx("span",{className:"text-blue-500 bg-blue-900/10 px-2 py-1 rounded text-xs font-bold",children:"IN"}),c.jsxs("h3",{className:"text-lg font-serif text-stone-200 italic",children:["  ",Ct==null?void 0:Ct.name,"?"]}),c.jsx("span",{className:"ml-auto text-stone-600 text-xs font-bold",children:be.length})]}),c.jsx("div",{className:"space-y-3",children:be.length===0?c.jsx("p",{className:"text-stone-700 text-xs italic py-4",children:"    ..."}):be.map((j,ae)=>{var ge,Ee,Se,Fe,je,He,nt;return c.jsxs("div",{className:"flex items-start gap-4 p-4 bg-stone-900/30 border border-stone-900/50 rounded-xl hover:bg-stone-900/50 hover:border-blue-900/30 transition-all group",children:[c.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:c.jsx("img",{src:(ge=j.sourceChar)==null?void 0:ge.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${((Ee=j.sourceChar)==null?void 0:Ee.miniImageX)??50}% ${((Se=j.sourceChar)==null?void 0:Se.miniImageY)??50}%`,transform:`scale(${((Fe=j.sourceChar)==null?void 0:Fe.miniImageScale)??1})`,transformOrigin:`${((je=j.sourceChar)==null?void 0:je.miniImageX)??50}% ${((He=j.sourceChar)==null?void 0:He.miniImageY)??50}%`},alt:""})}),c.jsxs("div",{className:"flex-grow min-w-0",children:[c.jsxs("div",{className:"flex justify-between items-baseline",children:[c.jsx("h4",{className:"text-stone-300 font-bold text-sm truncate",children:(nt=j.sourceChar)==null?void 0:nt.name}),c.jsx("button",{onClick:()=>h(j.sourceChar.id),className:"text-[9px] uppercase font-bold text-stone-700 hover:text-blue-500 transition-colors opacity-0 group-hover:opacity-100",children:""})]}),c.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[c.jsx("span",{className:"text-stone-600 text-[10px] uppercase tracking-wider",children:"  :"}),c.jsx("p",{className:"text-stone-400 text-xs font-medium",children:j.role})]})]}),c.jsx("div",{className:"w-1.5 h-8 rounded-full self-center",style:{backgroundColor:j.color||"#10b981"}})]},ae)})})]})]}):c.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-stone-600 space-y-4",children:[c.jsx("svg",{className:"w-16 h-16 opacity-30",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),c.jsx("p",{className:"text-sm italic font-serif opacity-70",children:"    ,    "})]})}),G&&p==="graph"&&c.jsx("div",{className:"absolute z-[100] animate-in zoom-in-95 fade-in duration-300",style:{left:G.x+40,top:G.y-40},onClick:j=>j.stopPropagation(),children:c.jsxs("div",{className:"bg-[#0f0f0f]/95 border border-stone-800 rounded-xl overflow-hidden shadow-2xl min-w-[200px] backdrop-blur-md",children:[c.jsx("button",{onClick:()=>h(G.id),className:"w-full text-left px-5 py-3 text-[11px] uppercase tracking-wider font-bold text-stone-200 hover:bg-emerald-900/40 border-b border-stone-900",children:" "}),c.jsx("button",{onClick:()=>{Ae(G.id),M(null),ee(!0)},className:"w-full text-left px-5 py-3 text-[11px] uppercase tracking-wider font-bold text-emerald-400 hover:bg-emerald-900/40",children:" "})]})})]})]})},cx=({realms:s,worlds:t,characters:r,availableTags:o,availableHiddenTags:a,onUpdateRealms:d,onUpdateWorlds:h,isAdmin:p})=>{var ae,ge,Ee,Se,Fe,je,He,nt;const[g,x]=$.useState(null),[k,y]=$.useState(null);$.useEffect(()=>{window.scrollTo(0,0)},[g,k]);const[v,S]=$.useState(!1),[O,H]=$.useState(!1),[Z,le]=$.useState(!1),[se,we]=$.useState(null),[ue,Ae]=$.useState(!1),[G,M]=$.useState(""),[R,ye]=$.useState(!1),[P,ee]=$.useState({}),[ie,Ie]=$.useState({type:""}),[We,lt]=$.useState(""),[Qe,ze]=$.useState([]),V=s.find(F=>F.id===g),J=t.find(F=>F.id===k),w=t.filter(F=>F.realmId===g),A=F=>{var re,_e;for(const q of t){if((re=q.characterIds)!=null&&re.includes(F))return q.name;if(q.subLocations){for(const U of q.subLocations)if((_e=U.characterIds)!=null&&_e.includes(F))return`${q.name} / ${U.name}`}}return null},te=F=>{ee(F||{}),S(!0)},D=()=>{if(!P.name)return;let F;if(P.id)F=s.map(re=>re.id===P.id?{...re,...P}:re);else{const re={id:Date.now().toString(),name:P.name,imageUrl:P.imageUrl||"https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=1080&auto=format&fit=crop"};F=[...s,re]}d(F),S(!1),ee({})},L=F=>{window.confirm("  ?  ,   .")&&(d(s.filter(re=>re.id!==F)),g===F&&x(null))},Q=F=>{Ie(F||{type:"",realmId:g}),H(!0)},me=()=>{if(!ie.name||!g)return;let F;if(ie.id)F=t.map(re=>re.id===ie.id?{...re,...ie}:re);else{const re={id:Date.now().toString(),realmId:g,name:ie.name,type:ie.type||"",description:ie.description||"",imageUrl:ie.imageUrl||"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?q=80&w=800&auto=format&fit=crop",characterIds:[],subLocations:[]};F=[...t,re]}h(F),H(!1),Ie({type:""})},Ce=F=>{window.confirm("  ?")&&(h(t.filter(re=>re.id!==F)),k===F&&y(null))},T=()=>{if(!J||!G.trim())return;const F={id:Date.now().toString(),name:G.trim(),characterIds:[]},re=t.map(_e=>_e.id===J.id?{..._e,subLocations:[..._e.subLocations||[],F]}:_e);h(re),M(""),Ae(!1)},X=F=>{if(!J||!window.confirm("  ?        ."))return;const re=t.map(_e=>_e.id===J.id?{..._e,subLocations:(_e.subLocations||[]).filter(q=>q.id!==F)}:_e);h(re)},de=F=>{if(!J)return;let re={...J};if(se){const q=re.subLocations?[...re.subLocations]:[],U=q.findIndex(he=>he.id===se);if(U>-1){const he=q[U].characterIds||[],Te=he.includes(F)?he.filter(Oe=>Oe!==F):[...he,F];q[U]={...q[U],characterIds:Te},re.subLocations=q}}else{const q=re.characterIds||[],U=q.includes(F)?q.filter(he=>he!==F):[...q,F];re.characterIds=U}const _e=t.map(q=>q.id===J.id?re:q);h(_e)},be=F=>{ze(re=>re.includes(F)?re.filter(_e=>_e!==F):[...re,F])},Ct=(F=null)=>{we(F),lt(""),ze([]),le(!0)},hn=async F=>{var _e;const re=(_e=F.target.files)==null?void 0:_e[0];if(re){ye(!0);try{const q=await zo(re);ee(U=>({...U,imageUrl:q}))}finally{ye(!1)}}},j=async F=>{var _e;const re=(_e=F.target.files)==null?void 0:_e[0];if(re){ye(!0);try{const q=await zo(re);Ie(U=>({...U,imageUrl:q}))}finally{ye(!1)}}};if(k&&J){const F=se?((ge=(ae=J.subLocations)==null?void 0:ae.find(U=>U.id===se))==null?void 0:ge.characterIds)||[]:J.characterIds||[],re=r.filter(U=>!F.includes(U.id)),_e=re.filter(U=>{const he=U.name.toLowerCase().includes(We.toLowerCase());if(Qe.length===0)return he;const Te=[...U.tags||[],...U.hiddenTags||[]];return he&&Qe.every(Oe=>Te.includes(Oe))}),q=(U,he)=>{const Te=U||[],Oe=r.filter(Ye=>Te.includes(Ye.id));return Oe.length===0?c.jsx("p",{className:"text-stone-600 italic text-sm",children:"  ..."}):c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:Oe.map(Ye=>c.jsxs("div",{className:"bg-stone-900/30 border border-stone-800 rounded-xl p-3 flex items-center gap-3 group relative",children:[c.jsx("div",{className:"w-10 h-10 rounded-full bg-black border border-stone-700 overflow-hidden shrink-0",children:c.jsx("img",{src:Ye.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${Ye.miniImageX??50}% ${Ye.miniImageY??50}%`,transform:`scale(${Ye.miniImageScale??1})`,transformOrigin:`${Ye.miniImageX??50}% ${Ye.miniImageY??50}%`}})}),c.jsx("span",{className:"text-stone-300 font-bold text-sm truncate",children:Ye.name}),p&&c.jsx("button",{onClick:()=>{we(he),setTimeout(()=>de(Ye.id),0)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-stone-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all p-2",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},Ye.id))})};return c.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-500 pb-20",children:[c.jsxs("div",{className:"flex flex-col gap-6",children:[c.jsxs("button",{onClick:()=>y(null),className:"self-start flex items-center gap-2 text-stone-500 hover:text-emerald-500 transition-colors group",children:[c.jsx("svg",{className:"w-5 h-5 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),c.jsxs("span",{className:"text-xs font-bold uppercase tracking-widest",children:["  ",V==null?void 0:V.name]})]}),c.jsxs("div",{className:"relative h-[300px] md:h-[400px] rounded-3xl overflow-hidden border border-stone-900 group shadow-2xl",children:[c.jsx("img",{src:J.imageUrl,className:"w-full h-full object-cover",alt:J.name}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#050505] via-transparent to-transparent opacity-90"}),c.jsx("div",{className:"absolute bottom-0 left-0 p-8 md:p-12 w-full",children:c.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4",children:[c.jsxs("div",{children:[c.jsx("div",{className:"inline-block px-3 py-1 bg-emerald-900/40 border border-emerald-500/30 rounded-lg text-emerald-400 text-[10px] font-bold uppercase tracking-widest mb-3 backdrop-blur-md",children:J.type}),c.jsx("h1",{className:"text-4xl md:text-6xl font-serif font-medium text-stone-100 drop-shadow-xl",children:J.name})]}),p&&c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:()=>Q(J),className:"bg-white/10 hover:bg-white/20 backdrop-blur-md text-stone-200 px-5 py-2 rounded-full text-[10px] uppercase font-bold tracking-widest transition-all border border-white/10",children:""}),c.jsx("button",{onClick:()=>Ce(J.id),className:"bg-red-900/20 hover:bg-red-900/40 backdrop-blur-md text-red-400 px-5 py-2 rounded-full text-[10px] uppercase font-bold tracking-widest transition-all border border-red-900/30",children:""})]})]})})]}),c.jsx("div",{className:"max-w-4xl",children:c.jsx("p",{className:"text-lg md:text-xl font-serif text-stone-300 leading-relaxed whitespace-pre-wrap",children:J.description})}),c.jsx("div",{className:"h-px bg-stone-900 w-full my-4"}),c.jsxs("div",{className:"space-y-10",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-between items-center border-b border-stone-800/50 pb-2",children:[c.jsx("h3",{className:"text-xl font-serif text-stone-200 italic",children:" "}),p&&c.jsx("button",{onClick:()=>Ct(null),className:"text-emerald-500 hover:text-emerald-400 text-[10px] uppercase font-bold tracking-widest transition-colors flex items-center gap-2",children:"+ "})]}),q(J.characterIds||[],null)]}),(Ee=J.subLocations)==null?void 0:Ee.map(U=>c.jsxs("div",{className:"space-y-4 pt-4 animate-in fade-in",children:[c.jsxs("div",{className:"flex justify-between items-center border-b border-stone-800/50 pb-2",children:[c.jsxs("div",{className:"flex items-baseline gap-3",children:[c.jsx("h3",{className:"text-xl font-serif text-stone-300 italic",children:U.name}),p&&c.jsx("button",{onClick:()=>X(U.id),className:"text-stone-700 hover:text-red-500 transition-colors",children:c.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),p&&c.jsx("button",{onClick:()=>Ct(U.id),className:"text-emerald-500 hover:text-emerald-400 text-[10px] uppercase font-bold tracking-widest transition-colors flex items-center gap-2",children:"+ "})]}),q(U.characterIds||[],U.id)]},U.id)),p&&c.jsx("div",{className:"pt-4",children:ue?c.jsxs("div",{className:"flex items-center gap-3 animate-in slide-in-from-left-2",children:[c.jsx("input",{autoFocus:!0,placeholder:" ...",className:"bg-stone-900 border border-stone-800 rounded-lg px-3 py-2 text-sm text-stone-200 outline-none focus:border-emerald-900 w-64",value:G,onChange:U=>M(U.target.value),onKeyDown:U=>U.key==="Enter"&&T()}),c.jsx("button",{onClick:T,className:"text-emerald-500 hover:text-emerald-400 font-bold p-2 bg-stone-900 rounded-lg",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),c.jsx("button",{onClick:()=>Ae(!1),className:"text-stone-600 hover:text-stone-400 font-bold p-2",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):c.jsxs("button",{onClick:()=>Ae(!0),className:"flex items-center gap-2 text-stone-600 hover:text-emerald-500 transition-colors group",children:[c.jsx("div",{className:"w-8 h-8 rounded-full border border-stone-800 group-hover:border-emerald-500/50 flex items-center justify-center transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),c.jsx("span",{className:"text-[10px] uppercase font-bold tracking-widest",children:" "})]})})]})]}),Z&&c.jsx("div",{className:"fixed inset-0 z-[120] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",onClick:()=>le(!1),children:c.jsxs("div",{className:"bg-[#0f0f0f] border border-stone-800 w-full max-w-lg rounded-2xl shadow-2xl flex flex-col max-h-[85vh]",onClick:U=>U.stopPropagation(),children:[c.jsxs("div",{className:"p-6 border-b border-stone-900 shrink-0 space-y-4 bg-[#0f0f0f] rounded-t-2xl z-10",children:[c.jsxs("h3",{className:"text-xl font-serif text-stone-100 shrink-0",children:[" : ",se?(Fe=(Se=J.subLocations)==null?void 0:Se.find(U=>U.id===se))==null?void 0:Fe.name:" "]}),c.jsx("input",{type:"text",placeholder:"  ...",value:We,onChange:U=>lt(U.target.value),className:"w-full bg-stone-900 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-colors",autoFocus:!0}),(o.length>0||a.length>0)&&c.jsxs("div",{className:"flex flex-wrap gap-1.5 max-h-24 overflow-y-auto custom-scrollbar",children:[o.map(U=>{const he=Qe.includes(U);return c.jsx("button",{onClick:()=>be(U),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${he?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:U},U)}),a.map(U=>{const he=Qe.includes(U);return c.jsx("button",{onClick:()=>be(U),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${he?"bg-amber-500/20 border-amber-500/40 text-amber-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-amber-500"}`,children:U},U)})]})]}),c.jsx("div",{className:"overflow-y-auto custom-scrollbar flex-grow p-4 space-y-1",children:_e.length===0?c.jsx("div",{className:"text-center py-8 text-stone-600 italic text-sm",children:re.length===0?"      .":"  ."}):_e.map(U=>{const he=A(U.id),Te=!!he;return c.jsxs("button",{onClick:()=>!Te&&de(U.id),disabled:Te,className:`w-full flex items-center gap-3 p-2 rounded-lg transition-colors group text-left ${Te?"opacity-50 cursor-not-allowed bg-stone-900/20":"hover:bg-stone-900"}`,children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-black border border-stone-800 overflow-hidden shrink-0",children:c.jsx("img",{src:U.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${U.miniImageX??50}% ${U.miniImageY??50}%`,transform:`scale(${U.miniImageScale??1})`,transformOrigin:`${U.miniImageX??50}% ${U.miniImageY??50}%`}})}),c.jsxs("div",{className:"min-w-0 flex-grow",children:[c.jsx("span",{className:`text-stone-300 text-sm font-bold block truncate ${!Te&&"group-hover:text-emerald-400"}`,children:U.name}),Te?c.jsxs("span",{className:"text-[10px] text-red-500/70 font-bold uppercase tracking-wider block truncate",children:[": ",he]}):c.jsx(c.Fragment,{children:Qe.length>0&&c.jsx("span",{className:"text-[8px] text-stone-600 block truncate",children:Qe.filter(Oe=>(U.tags||[]).includes(Oe)||(U.hiddenTags||[]).includes(Oe)).join(", ")})})]}),!Te&&c.jsx("span",{className:"ml-auto text-emerald-500 opacity-0 group-hover:opacity-100",children:"+"})]},U.id)})}),c.jsx("div",{className:"p-4 border-t border-stone-900 shrink-0",children:c.jsx("button",{onClick:()=>le(!1),className:"w-full py-3 bg-stone-900 hover:bg-stone-800 text-stone-400 rounded-xl text-[10px] uppercase font-bold tracking-widest",children:""})})]})})]})}return g?c.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-500",children:[c.jsxs("div",{className:"flex flex-col gap-6",children:[c.jsxs("button",{onClick:()=>x(null),className:"self-start flex items-center gap-2 text-stone-500 hover:text-emerald-500 transition-colors group",children:[c.jsx("svg",{className:"w-5 h-5 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),c.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"  "})]}),c.jsxs("div",{className:"flex justify-between items-end border-b border-stone-800 pb-8",children:[c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-2xl overflow-hidden border border-stone-800 bg-black shadow-lg",children:c.jsx("img",{src:V==null?void 0:V.imageUrl,className:"w-full h-full object-cover",alt:""})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl md:text-5xl font-serif font-medium text-stone-100",children:V==null?void 0:V.name}),c.jsxs("p",{className:"text-stone-500 uppercase tracking-widest text-[10px] mt-2",children:[": ",w.length]})]})]}),p&&c.jsxs("div",{className:"flex gap-2 flex-col md:flex-row",children:[c.jsx("button",{onClick:()=>te(V),className:"bg-stone-900/50 border border-stone-800 text-stone-400 px-6 py-3 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-stone-900 transition-all mb-1",children:". "}),c.jsx("button",{onClick:()=>Q(),className:"bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 px-6 py-3 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-emerald-900/30 transition-all mb-1",children:"+ "})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[w.length===0&&c.jsx("div",{className:"col-span-full py-20 text-center text-stone-700 italic",children:"     .   ."}),w.map(F=>{var re,_e,q,U;return c.jsxs("div",{onClick:()=>y(F.id),className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-2xl overflow-hidden group hover:border-emerald-900/30 transition-all flex flex-col cursor-pointer active:scale-95 shadow-lg",children:[c.jsxs("div",{className:"aspect-video relative overflow-hidden",children:[c.jsx("img",{src:F.imageUrl,className:"w-full h-full object-cover opacity-60 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700",alt:""}),c.jsx("div",{className:"absolute top-4 left-4 bg-black/80 px-3 py-1 rounded text-[9px] uppercase tracking-widest font-bold text-emerald-500 border border-emerald-900/50 backdrop-blur-sm",children:F.type}),(((re=F.characterIds)==null?void 0:re.length)||0)+(((_e=F.subLocations)==null?void 0:_e.reduce((he,Te)=>{var Oe;return he+(((Oe=Te.characterIds)==null?void 0:Oe.length)||0)},0))||0)>0&&c.jsx("div",{className:"absolute bottom-4 right-4 bg-black/60 backdrop-blur-md px-2 py-1 rounded flex items-center gap-2",children:c.jsxs("span",{className:"text-[9px] text-stone-300 font-bold uppercase tracking-widest",children:[(((q=F.characterIds)==null?void 0:q.length)||0)+(((U=F.subLocations)==null?void 0:U.reduce((he,Te)=>{var Oe;return he+(((Oe=Te.characterIds)==null?void 0:Oe.length)||0)},0))||0)," ."]})})]}),c.jsxs("div",{className:"p-6 space-y-3 flex-grow flex flex-col",children:[c.jsx("h3",{className:"text-xl font-serif text-stone-100 group-hover:text-emerald-200 transition-colors",children:F.name}),c.jsx("p",{className:"text-stone-500 text-sm leading-relaxed line-clamp-3 mb-2",children:F.description}),p&&c.jsxs("div",{className:"mt-auto pt-4 border-t border-stone-900/50 flex justify-between",children:[c.jsx("button",{onClick:he=>{he.stopPropagation(),Q(F)},className:"text-[9px] font-bold uppercase tracking-widest text-stone-600 hover:text-white",children:"."}),c.jsx("button",{onClick:he=>{he.stopPropagation(),Ce(F.id)},className:"text-[9px] font-bold uppercase tracking-widest text-stone-600 hover:text-red-500",children:""})]})]})]},F.id)})]}),O&&c.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-md flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-lg rounded-2xl p-6 md:p-8 space-y-6 max-h-[90vh] flex flex-col overflow-hidden shadow-2xl animate-in zoom-in-95 duration-200",children:[c.jsx("h2",{className:"text-2xl font-serif text-stone-100 shrink-0",children:ie.id?"":" "}),c.jsxs("div",{className:"space-y-4 overflow-y-auto custom-scrollbar pr-2 flex-grow",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600",children:""}),c.jsx("input",{className:"w-full bg-stone-900 border border-stone-800 p-3 rounded-lg text-stone-200 outline-none focus:border-emerald-900",value:ie.name||"",onChange:F=>Ie({...ie,name:F.target.value}),placeholder:" ..."})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600",children:""}),c.jsxs("select",{className:"w-full bg-stone-900 border border-stone-800 p-3 rounded-lg text-stone-200 outline-none focus:border-emerald-900",value:ie.type,onChange:F=>Ie({...ie,type:F.target.value}),children:[c.jsx("option",{children:""}),c.jsx("option",{children:""}),c.jsx("option",{children:""}),c.jsx("option",{children:""})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600",children:""}),c.jsx("textarea",{placeholder:"  ...",className:"w-full bg-stone-900 border border-stone-800 p-3 rounded-lg text-stone-200 h-32 outline-none resize-none focus:border-emerald-900",value:ie.description||"",onChange:F=>Ie({...ie,description:F.target.value})})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600",children:""}),c.jsxs("div",{className:"flex gap-4 items-center",children:[c.jsxs("label",{className:`flex-1 cursor-pointer bg-stone-900 hover:bg-stone-800 p-3 rounded-lg border border-stone-800 flex items-center justify-center gap-2 transition-colors ${R?"opacity-50":""}`,children:[c.jsx("input",{type:"file",onChange:j,className:"hidden",disabled:R,accept:"image/*"}),c.jsx("span",{className:"text-[10px] text-stone-400 font-bold uppercase",children:R?"...":""})]}),c.jsx("input",{className:"flex-[1.5] bg-stone-900 border border-stone-800 p-3 rounded-lg text-xs text-stone-400 outline-none",placeholder:"...",value:(je=ie.imageUrl)!=null&&je.startsWith("data:")?"":ie.imageUrl||"",onChange:F=>Ie({...ie,imageUrl:F.target.value})})]}),ie.imageUrl&&c.jsx("img",{src:ie.imageUrl,className:"h-20 w-full object-cover rounded mt-2 opacity-50"})]})]}),c.jsxs("div",{className:"flex gap-4 shrink-0 pt-2 border-t border-stone-900 mt-2",children:[c.jsx("button",{onClick:()=>H(!1),className:"flex-1 py-3 text-[10px] font-bold uppercase text-stone-500 hover:text-stone-300",children:""}),c.jsx("button",{onClick:me,disabled:R||!ie.name,className:"flex-1 py-3 bg-emerald-900/30 text-emerald-500 border border-emerald-900/50 rounded-lg font-bold text-[10px] uppercase disabled:opacity-50 hover:bg-emerald-900/50 transition-colors",children:""})]})]})}),v&&c.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-md flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-lg rounded-3xl p-8 space-y-6 shadow-2xl animate-in zoom-in-95 duration-300",children:[c.jsx("h2",{className:"text-2xl font-serif text-stone-100",children:" "}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-2",children:""}),c.jsx("input",{className:"w-full bg-stone-900 border border-stone-800 p-4 rounded-xl text-stone-200 outline-none focus:border-emerald-900",value:P.name||"",onChange:F=>ee({...P,name:F.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-2",children:""}),c.jsxs("div",{className:"flex gap-4 items-center",children:[c.jsxs("label",{className:`flex-1 cursor-pointer bg-stone-900 hover:bg-stone-800 p-4 rounded-xl border border-stone-800 flex items-center justify-center gap-2 ${R?"opacity-50":""}`,children:[c.jsx("input",{type:"file",onChange:hn,className:"hidden",disabled:R,accept:"image/*"}),c.jsx("span",{className:"text-xs text-stone-400 font-bold uppercase",children:R?"...":""})]}),c.jsx("input",{className:"flex-[2] bg-stone-900 border border-stone-800 p-4 rounded-xl text-xs text-stone-400 outline-none",placeholder:"...",value:(He=P.imageUrl)!=null&&He.startsWith("data:")?"":P.imageUrl||"",onChange:F=>ee({...P,imageUrl:F.target.value})})]})]})]}),c.jsxs("div",{className:"flex gap-4 pt-4",children:[c.jsx("button",{onClick:()=>S(!1),className:"flex-1 py-4 text-[10px] uppercase font-bold text-stone-500 hover:text-stone-300",children:""}),c.jsx("button",{onClick:D,disabled:!P.name||R,className:"flex-1 py-4 bg-emerald-900/30 text-emerald-500 border border-emerald-900/50 rounded-xl font-bold text-[10px] uppercase hover:bg-emerald-900/50 transition-all disabled:opacity-50",children:""})]})]})})]}):c.jsxs("div",{className:"space-y-12 animate-in fade-in duration-700 pb-20",children:[c.jsxs("div",{className:"flex justify-between items-baseline",children:[c.jsx("div",{className:"space-y-2",children:c.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100",children:""})}),p&&c.jsx("button",{onClick:()=>te(),className:"bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 px-6 py-3 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-emerald-900/30 transition-all",children:"  "})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[s.length===0&&c.jsx("div",{className:"col-span-full py-20 text-center",children:c.jsx("p",{className:"text-stone-700 italic font-serif text-xl",children:" .   ."})}),s.map(F=>c.jsxs("div",{onClick:()=>x(F.id),className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl overflow-hidden group cursor-pointer relative shadow-lg hover:shadow-emerald-900/10 hover:border-emerald-900/40 transition-all active:scale-95",children:[c.jsxs("div",{className:"aspect-[16/9] relative",children:[c.jsx("img",{src:F.imageUrl,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700",alt:F.name}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-80"}),c.jsx("h3",{className:"absolute bottom-6 left-6 text-3xl font-serif text-stone-100 z-10 font-bold group-hover:text-emerald-100 transition-colors drop-shadow-md",children:F.name})]}),p&&c.jsxs("div",{className:"absolute top-4 right-4 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[c.jsx("button",{onClick:re=>{re.stopPropagation(),te(F)},className:"bg-black/50 hover:bg-white text-white hover:text-black p-2 rounded-full backdrop-blur-sm transition-all",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),c.jsx("button",{onClick:re=>{re.stopPropagation(),L(F.id)},className:"bg-black/50 hover:bg-red-900/80 text-white p-2 rounded-full backdrop-blur-sm transition-all",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]},F.id))]}),v&&c.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-md flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-lg rounded-3xl p-8 space-y-6 shadow-2xl animate-in zoom-in-95 duration-300",children:[c.jsx("h2",{className:"text-2xl font-serif text-stone-100",children:P.id?" ":" "}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-2",children:""}),c.jsx("input",{autoFocus:!0,className:"w-full bg-stone-900 border border-stone-800 p-4 rounded-xl text-stone-200 outline-none focus:border-emerald-900 transition-colors",value:P.name||"",onChange:F=>ee({...P,name:F.target.value}),placeholder:":  "})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-2",children:""}),c.jsxs("div",{className:"flex gap-4 items-center",children:[c.jsxs("label",{className:`flex-1 cursor-pointer bg-stone-900 hover:bg-stone-800 p-4 rounded-xl border border-stone-800 flex items-center justify-center gap-2 transition-colors ${R?"opacity-50":""}`,children:[c.jsx("input",{type:"file",onChange:hn,className:"hidden",disabled:R,accept:"image/*"}),c.jsx("span",{className:"text-xs text-stone-400 font-bold uppercase",children:R?"...":""})]}),c.jsx("input",{className:"flex-[2] bg-stone-900 border border-stone-800 p-4 rounded-xl text-xs text-stone-400 outline-none",placeholder:"...",value:(nt=P.imageUrl)!=null&&nt.startsWith("data:")?"":P.imageUrl||"",onChange:F=>ee({...P,imageUrl:F.target.value})})]})]})]}),c.jsxs("div",{className:"flex gap-4 pt-4",children:[c.jsx("button",{onClick:()=>S(!1),className:"flex-1 py-4 text-[10px] uppercase font-bold text-stone-500 hover:text-stone-300",children:""}),c.jsx("button",{onClick:D,disabled:!P.name||R,className:"flex-1 py-4 bg-emerald-900/30 text-emerald-500 border border-emerald-900/50 rounded-xl font-bold text-[10px] uppercase hover:bg-emerald-900/50 transition-all disabled:opacity-50",children:""})]})]})})]})},ux=({notes:s,characters:t,onUpdate:r,isAdmin:o})=>{var R,ye;const[a,d]=$.useState(!1),[h,p]=$.useState(null),[g,x]=$.useState("form"),[k,y]=$.useState(new Set),[v,S]=$.useState({}),[O,H]=$.useState(""),Z=$.useRef(null);$.useEffect(()=>{Z.current&&g==="form"&&(Z.current.style.height="auto",Z.current.style.height=`${Z.current.scrollHeight}px`)},[v.content,g,a]);const le=P=>{y(ee=>{const ie=new Set(ee);return ie.has(P)?ie.delete(P):ie.add(P),ie})},se=P=>{P?(p(P.id),S({...P})):(p(null),S({title:"",content:""})),x("form"),H(""),d(!0)},we=()=>{d(!1),p(null),S({})},ue=()=>{if(!(!v.title||!v.content)){if(h){const P=s.map(ee=>ee.id===h?{...ee,...v}:ee);r(P)}else{const P={id:Date.now().toString(),title:v.title||"",content:v.content||"",date:new Date().toLocaleDateString("ru-RU"),authorId:v.authorId,targetId:v.targetId};r([P,...s])}we()}},Ae=()=>{if(h&&window.confirm("     ?")){const P=s.filter(ee=>ee.id!==h);r(P),we()}},G=P=>t.find(ee=>ee&&ee.id===P),M=$.useMemo(()=>t.filter(P=>P.name.toLowerCase().includes(O.toLowerCase())).sort((P,ee)=>P.name.localeCompare(ee.name)),[t,O]);return c.jsxs("div",{className:"space-y-12 animate-in fade-in duration-700 w-full mx-auto pb-20",children:[c.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-b border-stone-900/50 pb-8",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100 italic",children:""}),c.jsx("p",{className:"text-stone-500 uppercase tracking-[0.3em] text-[9px] font-black",children:"   "})]}),o&&c.jsxs("button",{onClick:()=>se(),className:"group relative bg-white hover:bg-emerald-50 text-black px-8 py-4 rounded-2xl text-[10px] uppercase tracking-[0.2em] font-black transition-all shadow-xl hover:shadow-emerald-500/10 flex items-center gap-3 overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})," "]})]}),c.jsx("div",{className:"space-y-6",children:s.length===0?c.jsxs("div",{className:"py-32 text-center",children:[c.jsx("div",{className:"w-16 h-16 bg-stone-900/20 rounded-full flex items-center justify-center mx-auto mb-6 border border-stone-800/50",children:c.jsx("svg",{className:"w-8 h-8 text-stone-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),c.jsx("p",{className:"text-stone-700 italic font-serif text-lg",children:" ,   .    ."})]}):s.map(P=>{const ee=G(P.authorId),ie=G(P.targetId),Ie=k.has(P.id);return c.jsxs("article",{onClick:()=>le(P.id),className:`relative group bg-[#0a0a0a] border rounded-3xl p-6 md:p-8 transition-all shadow-2xl cursor-pointer overflow-hidden ${Ie?"border-emerald-900/40 bg-stone-950/80":"border-stone-900/60 hover:border-emerald-900/30"}`,children:[c.jsx("div",{className:`absolute top-0 right-0 w-64 h-64 bg-emerald-500/5 rounded-full blur-[100px] -translate-y-32 translate-x-32 pointer-events-none transition-opacity duration-700 ${Ie?"opacity-100":"opacity-0 group-hover:opacity-50"}`}),c.jsxs("div",{className:"relative z-10",children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6",children:[c.jsx("div",{className:"flex items-center gap-3",children:ee?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-10 h-10 rounded-full border border-stone-800 overflow-hidden bg-black shrink-0",children:c.jsx("img",{src:ee.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${ee.miniImageX??50}% ${ee.miniImageY??50}%`,transformOrigin:`${ee.miniImageX??50}% ${ee.miniImageY??50}%`,transform:`scale(${ee.miniImageScale??1})`}})}),c.jsx("span",{className:"text-[10px] uppercase tracking-widest font-black text-stone-200",children:ee.name})]}):c.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-stone-700 bg-stone-900/50 px-3 py-1.5 rounded-lg",children:" "})}),c.jsx("div",{className:"h-px w-6 bg-stone-900"}),c.jsx("div",{className:"flex items-center gap-3",children:ie?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-emerald-500/60",children:":"}),c.jsx("div",{className:"w-10 h-10 rounded-full border border-emerald-900/20 overflow-hidden bg-black shrink-0",children:c.jsx("img",{src:ie.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${ie.miniImageX??50}% ${ie.miniImageY??50}%`,transformOrigin:`${ie.miniImageX??50}% ${ie.miniImageY??50}%`,transform:`scale(${ie.miniImageScale??1})`}})}),c.jsx("span",{className:"text-[10px] uppercase tracking-widest font-black text-emerald-400",children:ie.name})]}):c.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-stone-700",children:""})}),c.jsx("div",{className:"ml-auto text-[9px] font-black text-stone-800 uppercase tracking-[0.2em]",children:P.date})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("h3",{className:`font-serif font-bold transition-colors drop-shadow-md italic break-words ${Ie?"text-2xl md:text-3xl text-emerald-100 mb-6":"text-xl text-stone-300 group-hover:text-emerald-200"}`,children:P.title}),!Ie&&c.jsx("p",{className:"text-[10px] uppercase tracking-[0.2em] font-black text-stone-700 group-hover:text-stone-500 transition-colors pt-2",children:",  "})]}),Ie&&c.jsxs("div",{className:"animate-in fade-in slide-in-from-top-2 duration-500",children:[c.jsx("div",{className:"w-full h-px bg-gradient-to-r from-emerald-900/50 to-transparent my-6"}),c.jsx("p",{className:"text-stone-300 leading-relaxed font-serif text-base md:text-lg whitespace-pre-wrap break-words",children:P.content}),c.jsxs("div",{className:"mt-10 pt-6 border-t border-stone-900/50 flex justify-between items-center",children:[c.jsx("span",{className:"text-[9px] uppercase tracking-[0.2em] font-black text-emerald-900 hover:text-emerald-600 transition-colors",onClick:We=>{We.stopPropagation(),le(P.id)},children:""}),o&&c.jsxs("button",{onClick:We=>{We.stopPropagation(),se(P)},className:"flex items-center gap-2 bg-stone-900/50 hover:bg-stone-800 text-stone-400 px-4 py-2 rounded-lg text-[9px] uppercase font-black tracking-widest transition-all",children:[c.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),""]})]})]})]})]},P.id)})}),a&&c.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center p-2 md:p-4 animate-in fade-in duration-300",children:[c.jsx("div",{className:"absolute inset-0 bg-black/95 backdrop-blur-[20px]",onClick:we}),c.jsxs("div",{className:"relative bg-[#070707] border border-stone-800/80 w-full max-w-5xl rounded-[2rem] overflow-hidden shadow-[0_0_100px_rgba(16,185,129,0.1)] flex flex-col h-auto max-h-[90vh] animate-in zoom-in-95 duration-500",children:[c.jsxs("div",{className:"p-6 md:p-8 border-b border-stone-900/50 flex justify-between items-center bg-stone-900/20 shrink-0",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-3xl font-serif text-stone-100 font-bold italic",children:g==="form"?h?" ":" ":g==="select-author"?" ":" "}),c.jsx("p",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-emerald-500/60 mt-2",children:g==="form"?"   ":"   "})]}),c.jsx("button",{onClick:g==="form"?we:()=>x("form"),className:"text-stone-700 hover:text-white transition-all p-3 hover:bg-white/5 rounded-full",children:c.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"flex-grow overflow-y-auto custom-scrollbar flex flex-col",children:g==="form"?c.jsxs("div",{className:"p-6 md:p-8 space-y-6 flex-grow flex flex-col",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 shrink-0",children:[c.jsxs("button",{onClick:()=>x("select-author"),className:`group relative p-4 rounded-3xl border transition-all text-left flex items-center gap-5 ${v.authorId?"bg-emerald-950/10 border-emerald-900/30":"bg-stone-900/20 border-stone-800/50 hover:border-emerald-900/30"}`,children:[c.jsx("div",{className:`w-14 h-14 rounded-full border-2 overflow-hidden bg-black shrink-0 transition-transform group-hover:scale-105 ${v.authorId?"border-emerald-500 shadow-[0_0_15px_rgba(16,185,129,0.3)]":"border-stone-800"}`,children:v.authorId?(()=>{const P=G(v.authorId);return P?c.jsx("img",{src:P.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${P.miniImageX??50}% ${P.miniImageY??50}%`,transformOrigin:`${P.miniImageX??50}% ${P.miniImageY??50}%`,transform:`scale(${P.miniImageScale??1})`}}):null})():c.jsx("div",{className:"w-full h-full flex items-center justify-center text-stone-800",children:c.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-[9px] uppercase tracking-widest font-black text-stone-600 mb-1",children:":"}),c.jsx("p",{className:`text-sm font-bold truncate ${v.authorId?"text-stone-100":"text-stone-700 italic"}`,children:v.authorId?(R=G(v.authorId))==null?void 0:R.name:" "})]}),v.authorId&&c.jsx("div",{onClick:P=>{P.stopPropagation(),S({...v,authorId:void 0})},className:"absolute -top-2 -right-2 bg-stone-900 p-1.5 rounded-full border border-stone-800 text-stone-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:c.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{d:"M6 18L18 6M6 6l12 12",strokeWidth:2})})})]}),c.jsxs("button",{onClick:()=>x("select-target"),className:`group relative p-4 rounded-3xl border transition-all text-left flex items-center gap-5 ${v.targetId?"bg-amber-950/10 border-amber-900/30":"bg-stone-900/20 border-stone-800/50 hover:border-amber-900/30"}`,children:[c.jsx("div",{className:`w-14 h-14 rounded-full border-2 overflow-hidden bg-black shrink-0 transition-transform group-hover:scale-105 ${v.targetId?"border-amber-500 shadow-[0_0_15px_rgba(245,158,11,0.3)]":"border-stone-800"}`,children:v.targetId?(()=>{const P=G(v.targetId);return P?c.jsx("img",{src:P.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${P.miniImageX??50}% ${P.miniImageY??50}%`,transformOrigin:`${P.miniImageX??50}% ${P.miniImageY??50}%`,transform:`scale(${P.miniImageScale??1})`}}):null})():c.jsx("div",{className:"w-full h-full flex items-center justify-center text-stone-800",children:c.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-[9px] uppercase tracking-widest font-black text-stone-600 mb-1",children:":"}),c.jsx("p",{className:`text-sm font-bold truncate ${v.targetId?"text-stone-100":"text-stone-700 italic"}`,children:v.targetId?(ye=G(v.targetId))==null?void 0:ye.name:""})]}),v.targetId&&c.jsx("div",{onClick:P=>{P.stopPropagation(),S({...v,targetId:void 0})},className:"absolute -top-2 -right-2 bg-stone-900 p-1.5 rounded-full border border-stone-800 text-stone-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:c.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{d:"M6 18L18 6M6 6l12 12",strokeWidth:2})})})]})]}),c.jsxs("div",{className:"space-y-2 shrink-0",children:[c.jsx("label",{className:"text-[10px] uppercase tracking-[0.4em] font-black text-stone-600 ml-1",children:""}),c.jsx("input",{placeholder:"  ...",className:"w-full bg-[#030303] border border-stone-900 rounded-2xl px-6 py-5 text-stone-100 outline-none focus:border-emerald-500/40 transition-all font-serif italic text-xl shadow-inner focus:shadow-emerald-500/5",value:v.title||"",onChange:P=>S({...v,title:P.target.value})})]}),c.jsxs("div",{className:"space-y-2 flex-grow flex flex-col w-full",children:[c.jsx("label",{className:"text-[10px] uppercase tracking-[0.4em] font-black text-stone-600 ml-1",children:" "}),c.jsx("textarea",{ref:Z,placeholder:"  ...",className:"w-full bg-[#030303] border border-stone-900 rounded-2xl px-6 py-6 text-stone-300 outline-none focus:border-emerald-500/40 transition-all resize-none leading-relaxed shadow-inner custom-scrollbar text-lg font-serif min-h-[300px] overflow-hidden",value:v.content||"",onChange:P=>S({...v,content:P.target.value})})]})]}):c.jsxs("div",{className:"p-8 md:p-12 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[c.jsx("div",{className:"mb-8",children:c.jsx("input",{type:"text",placeholder:"    ...",value:O,onChange:P=>H(P.target.value),className:"w-full bg-stone-900/50 border border-stone-800 rounded-2xl px-6 py-4 text-sm text-stone-200 outline-none focus:border-emerald-500/50 transition-colors shadow-inner",autoFocus:!0})}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:M.map(P=>c.jsxs("button",{onClick:()=>{S({...v,[g==="select-author"?"authorId":"targetId"]:P.id}),x("form")},className:"flex items-center gap-4 p-4 rounded-2xl hover:bg-emerald-950/10 border border-stone-900 hover:border-emerald-900/30 transition-all group text-left",children:[c.jsx("div",{className:"w-12 h-12 rounded-full border border-stone-800 group-hover:border-emerald-500/50 bg-black overflow-hidden shrink-0 transition-colors",children:c.jsx("img",{src:P.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${P.miniImageX??50}% ${P.miniImageY??50}%`,transformOrigin:`${P.miniImageX??50}% ${P.miniImageY??50}%`,transform:`scale(${P.miniImageScale??1})`}})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("span",{className:"text-stone-300 font-bold text-sm block truncate group-hover:text-emerald-300 transition-colors",children:P.name}),c.jsx("span",{className:"text-[9px] uppercase tracking-widest text-stone-600 block truncate",children:""})]})]},P.id))}),M.length===0&&c.jsx("p",{className:"text-center py-20 text-stone-700 italic",children:"  ..."})]})}),g==="form"&&c.jsxs("div",{className:"p-6 md:p-8 border-t border-stone-900/50 bg-stone-900/20 flex flex-wrap gap-4 justify-between items-center shrink-0",children:[h?c.jsx("button",{onClick:Ae,className:"px-8 py-5 bg-red-950/10 hover:bg-red-900/20 border border-red-900/30 text-red-500/70 hover:text-red-500 rounded-2xl text-[10px] uppercase tracking-widest font-black transition-all",children:" "}):c.jsx("div",{className:"hidden md:block"}),c.jsxs("div",{className:"flex gap-4 md:gap-6 w-full md:w-auto",children:[c.jsx("button",{onClick:we,className:"flex-1 md:flex-none px-8 py-5 text-[10px] uppercase tracking-widest font-black text-stone-500 hover:text-stone-300 transition-colors",children:""}),c.jsx("button",{onClick:ue,disabled:!v.title||!v.content,className:"flex-1 md:flex-none px-10 py-5 bg-white hover:bg-emerald-50 text-black rounded-2xl text-[10px] uppercase tracking-widest font-black transition-all shadow-xl disabled:opacity-30 disabled:cursor-not-allowed",children:h?"":""})]})]})]})]})]})},dx=({sessions:s,characters:t,onUpdate:r,isAdmin:o})=>{const[a,d]=$.useState(null),[h,p]=$.useState(null),[g,x]=$.useState("");$.useEffect(()=>{window.scrollTo(0,0)},[a]);const[k,y]=$.useState(!1),[v,S]=$.useState(""),[O,H]=$.useState(""),Z=$.useRef(null),le=s.find(G=>G.id===a);$.useEffect(()=>{Z.current&&Z.current.scrollIntoView({behavior:"smooth"})},[le==null?void 0:le.posts.length,a]);const se=()=>{if(!v.trim())return;const G={id:Date.now().toString(),name:v,description:O,posts:[]};r([...s,G]),y(!1),S(""),H("")},we=G=>{window.confirm("     ?")&&(r(s.filter(M=>M.id!==G)),a===G&&d(null))},ue=G=>{if(!g.trim()||!h||!a)return;const M={id:Date.now().toString(),characterId:h,content:g,timestamp:Date.now(),type:"speech"},R=s.map(ye=>ye.id===a?{...ye,posts:[...ye.posts,M]}:ye);r(R),x("")},Ae=G=>new Date(G).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return a?c.jsxs("div",{className:"h-[calc(100vh-8rem)] flex flex-col animate-in fade-in duration-300",children:[c.jsx("div",{className:"flex items-center justify-between pb-4 border-b border-stone-900 shrink-0",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>d(null),className:"p-2 hover:bg-stone-900 rounded-full text-stone-500 transition-colors",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-serif text-stone-100 italic",children:le==null?void 0:le.name}),c.jsx("p",{className:"text-[10px] uppercase tracking-widest text-stone-500",children:le==null?void 0:le.description})]})]})}),c.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar py-6 space-y-8 pr-2",children:[(le==null?void 0:le.posts.length)===0?c.jsx("div",{className:"text-center text-stone-700 italic text-sm mt-10",children:"...   ,   ."}):le==null?void 0:le.posts.map(G=>{const M=t.find(R=>R.id===G.characterId);return M?c.jsxs("div",{className:"flex gap-4 md:gap-6 group animate-in slide-in-from-bottom-2 duration-500",children:[c.jsx("div",{className:"shrink-0 flex flex-col items-center gap-2 mt-1",children:c.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 rounded-full border border-stone-800 overflow-hidden bg-black shadow-lg",children:c.jsx("img",{src:M.imageUrl,alt:M.name,style:{objectFit:"cover",objectPosition:`${M.miniImageX??50}% ${M.miniImageY??50}%`,transformOrigin:`${M.miniImageX??50}% ${M.miniImageY??50}%`,transform:`scale(${M.miniImageScale??1})`},className:"w-full h-full"})})}),c.jsxs("div",{className:"flex-grow max-w-4xl",children:[c.jsxs("div",{className:"flex items-baseline gap-3 mb-1",children:[c.jsx("span",{className:"text-stone-300 font-bold text-sm tracking-wide",children:M.name}),c.jsx("span",{className:"text-[9px] text-stone-700 font-mono",children:Ae(G.timestamp)})]}),c.jsx("div",{className:"text-stone-400 leading-relaxed font-serif whitespace-pre-wrap text-[15px] md:text-[16px]",children:G.content})]})]},G.id):null}),c.jsx("div",{ref:Z})]}),c.jsx("div",{className:"mt-4 pt-4 border-t border-stone-900 shrink-0 bg-[#050505] z-10",children:c.jsxs("div",{className:"flex flex-col gap-3",children:[c.jsx("div",{className:"flex gap-2 overflow-x-auto custom-scrollbar pb-3",children:t.map(G=>{const M=h===G.id;return c.jsxs("button",{onClick:()=>p(G.id),className:`flex items-center gap-3 px-4 py-2.5 rounded-xl transition-all shrink-0 border relative ${M?"bg-stone-900/80 border-stone-800 text-stone-100":"bg-transparent border-transparent text-stone-500 hover:text-stone-400"}`,children:[c.jsx("div",{className:"w-7 h-7 rounded-full overflow-hidden bg-black shrink-0",children:c.jsx("img",{src:G.imageUrl,style:{objectFit:"cover",objectPosition:`${G.miniImageX??50}% ${G.miniImageY??50}%`,transformOrigin:`${G.miniImageX??50}% ${G.miniImageY??50}%`,transform:`scale(${G.miniImageScale??1})`},className:"w-full h-full",alt:""})}),c.jsx("span",{className:"text-[11px] font-bold uppercase tracking-wider",children:G.name}),M&&c.jsx("div",{className:"ml-1 w-2.5 h-2.5 rounded-sm bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)] animate-in zoom-in-50 duration-300"})]},G.id)})}),c.jsxs("div",{className:"relative",children:[c.jsx("textarea",{value:g,onChange:G=>x(G.target.value),onKeyDown:G=>{G.key==="Enter"&&!G.shiftKey&&(G.preventDefault(),ue())},placeholder:h?" -...":"  ...",disabled:!h,className:"w-full bg-[#0f0f0f] border border-stone-800 rounded-xl p-4 pr-14 text-stone-300 outline-none focus:border-emerald-900/50 transition-colors resize-none h-24 custom-scrollbar font-serif"}),c.jsx("button",{onClick:()=>ue(),disabled:!g.trim()||!h,className:"absolute right-3 bottom-3 p-2 bg-stone-800 text-stone-400 rounded-lg hover:bg-emerald-600 hover:text-white disabled:opacity-30 disabled:hover:bg-stone-800 disabled:hover:text-stone-400 transition-all",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})]})})]}):c.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[c.jsxs("div",{className:"flex justify-between items-baseline",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100",children:""}),c.jsx("p",{className:"text-stone-500 uppercase tracking-widest text-[10px]",children:"   "})]}),c.jsx("button",{onClick:()=>y(!0),className:"bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 px-6 py-2 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-emerald-900/30 transition-all",children:"+  "})]}),k&&c.jsxs("div",{className:"bg-[#0f0f0f]/50 border border-stone-800 p-6 rounded-2xl space-y-4 animate-in slide-in-from-top-4",children:[c.jsx("input",{autoFocus:!0,placeholder:"   ...",className:"w-full bg-stone-900/50 border border-stone-800 p-3 rounded-lg text-stone-200 outline-none focus:border-emerald-900",value:v,onChange:G=>S(G.target.value)}),c.jsx("input",{placeholder:" ...",className:"w-full bg-stone-900/50 border border-stone-800 p-3 rounded-lg text-stone-400 outline-none focus:border-emerald-900 text-sm",value:O,onChange:G=>H(G.target.value)}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:()=>y(!1),className:"px-4 py-2 text-[10px] uppercase font-bold text-stone-500",children:""}),c.jsx("button",{onClick:se,className:"px-6 py-2 bg-emerald-700 hover:bg-emerald-600 text-white rounded-lg text-[10px] uppercase font-bold transition-colors",children:""})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[s.length===0&&!k&&c.jsx("div",{className:"col-span-full text-center py-20 opacity-50 italic font-serif",children:"   .   ."}),s.map(G=>c.jsxs("div",{onClick:()=>d(G.id),className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-2xl p-6 cursor-pointer hover:border-emerald-900/50 hover:bg-stone-900/30 transition-all group flex flex-col h-[200px]",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsx("h3",{className:"text-xl font-serif text-stone-200 group-hover:text-emerald-400 transition-colors",children:G.name}),c.jsxs("span",{className:"text-[10px] bg-stone-900 text-stone-500 px-2 py-1 rounded-md font-mono",children:[G.posts.length," "]})]}),c.jsx("p",{className:"text-sm text-stone-500 mt-2 line-clamp-2",children:G.description}),c.jsxs("div",{className:"mt-auto pt-4 border-t border-stone-900/50 flex justify-between items-center",children:[c.jsx("span",{className:"text-[9px] uppercase tracking-widest text-stone-600 font-bold group-hover:text-stone-400",children:"  "}),o&&c.jsx("button",{onClick:M=>{M.stopPropagation(),we(G.id)},className:"text-stone-800 hover:text-red-500 p-1 transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},G.id))]})]})},fx=({onConnect:s,onDisconnect:t,onClose:r,isConnected:o})=>c.jsx("div",{className:"fixed inset-0 z-[120] bg-black/95 backdrop-blur-md flex items-center justify-center p-6",onClick:r,children:c.jsxs("div",{className:"bg-[#0a0a0a] border border-emerald-900/50 w-full max-w-lg rounded-3xl p-8 space-y-8 shadow-[0_0_80px_rgba(16,185,129,0.05)]",onClick:a=>a.stopPropagation(),children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-3xl font-serif text-emerald-500 italic",children:" "}),c.jsx("p",{className:"text-stone-500 text-[10px] uppercase tracking-widest mt-2",children:"  "})]}),c.jsx("button",{onClick:r,className:"text-stone-600 hover:text-stone-300 transition-colors",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o?c.jsxs("div",{className:"space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[c.jsxs("div",{className:"p-6 rounded-2xl border bg-emerald-950/20 border-emerald-500/30",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:"w-3 h-3 rounded-full animate-pulse bg-emerald-500"}),c.jsx("span",{className:"text-sm font-bold uppercase tracking-widest text-emerald-400",children:" "})]}),c.jsx("div",{className:"space-y-2",children:c.jsx("p",{className:"text-[10px] text-stone-600 mt-2 leading-relaxed",children:"     .  ,     ,    ."})})]}),c.jsx("button",{onClick:t,className:"w-full py-4 rounded-xl border border-red-900/30 text-red-500/70 hover:bg-red-950/20 hover:text-red-500 hover:border-red-900/60 transition-all text-[10px] uppercase font-bold tracking-[0.2em]",children:" "})]}):c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{className:"bg-stone-900/30 border border-stone-800 rounded-2xl p-6 text-center space-y-4",children:[c.jsx("div",{className:"w-16 h-16 bg-stone-900 rounded-full flex items-center justify-center mx-auto text-stone-600",children:c.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),c.jsx("p",{className:"text-stone-400 text-sm leading-relaxed",children:"  ,           ."})]}),c.jsx("button",{onClick:s,className:"w-full py-5 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 hover:border-emerald-500/50 text-emerald-500 rounded-xl text-[11px] uppercase font-bold tracking-[0.25em] transition-all shadow-lg shadow-emerald-900/10",children:""}),c.jsx("p",{className:"text-[9px] text-stone-600 text-center border-t border-stone-900 pt-4",children:":          ."})]})]})}),yh=["","","","","","",""],_h=["","NPC","","",""],lc=[{id:"1",name:" ",age:34,height:"182 ",imageUrl:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?q=80&w=800&auto=format&fit=crop",tags:["","",""],hiddenTags:[""],connections:[{id:"2",name:"  ",role:""}],additionalInfo:"      ,     . ,         ,         .     ,    ."},{id:"2",name:"  ",age:21,height:"168 ",imageUrl:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?q=80&w=800&auto=format&fit=crop",tags:["",""],hiddenTags:["",""],connections:[{id:"1",name:" ",role:"  "}],additionalInfo:"   ,          .         .    ,        ."},{id:"3",name:"",age:"124 ",height:"195 ",imageUrl:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?q=80&w=800&auto=format&fit=crop",tags:["",""],hiddenTags:["NPC"],connections:[{id:"1",name:" ",role:" "}],additionalInfo:"  ,       .         .      ."}],hx=()=>{};var wh={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _p={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K=function(s,t){if(!s)throw us(t)},us=function(s){return new Error("Firebase Database ("+_p.SDK_VERSION+") INTERNAL ASSERT FAILED: "+s)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wp=function(s){const t=[];let r=0;for(let o=0;o<s.length;o++){let a=s.charCodeAt(o);a<128?t[r++]=a:a<2048?(t[r++]=a>>6|192,t[r++]=a&63|128):(a&64512)===55296&&o+1<s.length&&(s.charCodeAt(o+1)&64512)===56320?(a=65536+((a&1023)<<10)+(s.charCodeAt(++o)&1023),t[r++]=a>>18|240,t[r++]=a>>12&63|128,t[r++]=a>>6&63|128,t[r++]=a&63|128):(t[r++]=a>>12|224,t[r++]=a>>6&63|128,t[r++]=a&63|128)}return t},px=function(s){const t=[];let r=0,o=0;for(;r<s.length;){const a=s[r++];if(a<128)t[o++]=String.fromCharCode(a);else if(a>191&&a<224){const d=s[r++];t[o++]=String.fromCharCode((a&31)<<6|d&63)}else if(a>239&&a<365){const d=s[r++],h=s[r++],p=s[r++],g=((a&7)<<18|(d&63)<<12|(h&63)<<6|p&63)-65536;t[o++]=String.fromCharCode(55296+(g>>10)),t[o++]=String.fromCharCode(56320+(g&1023))}else{const d=s[r++],h=s[r++];t[o++]=String.fromCharCode((a&15)<<12|(d&63)<<6|h&63)}}return t.join("")},zc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,t){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let a=0;a<s.length;a+=3){const d=s[a],h=a+1<s.length,p=h?s[a+1]:0,g=a+2<s.length,x=g?s[a+2]:0,k=d>>2,y=(d&3)<<4|p>>4;let v=(p&15)<<2|x>>6,S=x&63;g||(S=64,h||(v=64)),o.push(r[k],r[y],r[v],r[S])}return o.join("")},encodeString(s,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(s):this.encodeByteArray(wp(s),t)},decodeString(s,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(s):px(this.decodeStringToByteArray(s,t))},decodeStringToByteArray(s,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let a=0;a<s.length;){const d=r[s.charAt(a++)],p=a<s.length?r[s.charAt(a)]:0;++a;const x=a<s.length?r[s.charAt(a)]:64;++a;const y=a<s.length?r[s.charAt(a)]:64;if(++a,d==null||p==null||x==null||y==null)throw new mx;const v=d<<2|p>>4;if(o.push(v),x!==64){const S=p<<4&240|x>>2;if(o.push(S),y!==64){const O=x<<6&192|y;o.push(O)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class mx extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const bp=function(s){const t=wp(s);return zc.encodeByteArray(t,!0)},$o=function(s){return bp(s).replace(/\./g,"")},yc=function(s){try{return zc.decodeString(s,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gx(s){return Np(void 0,s)}function Np(s,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const r=t;return new Date(r.getTime());case Object:s===void 0&&(s={});break;case Array:s=[];break;default:return t}for(const r in t)!t.hasOwnProperty(r)||!xx(r)||(s[r]=Np(s[r],t[r]));return s}function xx(s){return s!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yx=()=>vx().__FIREBASE_DEFAULTS__,_x=()=>{if(typeof process>"u"||typeof wh>"u")return;const s=wh.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},wx=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=s&&yc(s[1]);return t&&JSON.parse(t)},kp=()=>{try{return hx()||yx()||_x()||wx()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},bx=s=>{var t,r;return(r=(t=kp())==null?void 0:t.emulatorHosts)==null?void 0:r[s]},Nx=s=>{const t=bx(s);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const o=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),o]:[t.substring(0,r),o]},Cp=()=>{var s;return(s=kp())==null?void 0:s.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,o)=>{r?this.reject(r):this.resolve(o),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,o))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $c(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function kx(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cx(s,t){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},o=t||"demo-project",a=s.iat||0,d=s.sub||s.user_id;if(!d)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const h={iss:`https://securetoken.google.com/${o}`,aud:o,iat:a,exp:a+3600,auth_time:a,sub:d,user_id:d,firebase:{sign_in_provider:"custom",identities:{}},...s};return[$o(JSON.stringify(r)),$o(JSON.stringify(h)),""].join(".")}const ri={};function Sx(){const s={prod:[],emulator:[]};for(const t of Object.keys(ri))ri[t]?s.emulator.push(t):s.prod.push(t);return s}function Ex(s){let t=document.getElementById(s),r=!1;return t||(t=document.createElement("div"),t.setAttribute("id",s),r=!0),{created:r,element:t}}let bh=!1;function jx(s,t){if(typeof window>"u"||typeof document>"u"||!$c(window.location.host)||ri[s]===t||ri[s]||bh)return;ri[s]=t;function r(v){return`__firebase__banner__${v}`}const o="__firebase__banner",d=Sx().prod.length>0;function h(){const v=document.getElementById(o);v&&v.remove()}function p(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function g(v,S){v.setAttribute("width","24"),v.setAttribute("id",S),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function x(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{bh=!0,h()},v}function k(v,S){v.setAttribute("id",S),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function y(){const v=Ex(o),S=r("text"),O=document.getElementById(S)||document.createElement("span"),H=r("learnmore"),Z=document.getElementById(H)||document.createElement("a"),le=r("preprendIcon"),se=document.getElementById(le)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const we=v.element;p(we),k(Z,H);const ue=x();g(se,le),we.append(se,O,Z,ue),document.body.appendChild(we)}d?(O.innerText="Preview backend disconnected.",se.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(se.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,O.innerText="Preview backend running in this workspace."),O.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ix(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Sp(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ix())}function Tx(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Rx(){return _p.NODE_ADMIN===!0}function Px(){try{return typeof indexedDB=="object"}catch{return!1}}function Lx(){return new Promise((s,t)=>{try{let r=!0;const o="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(o);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(o),s(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var d;t(((d=a.error)==null?void 0:d.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mx="FirebaseError";class vi extends Error{constructor(t,r,o){super(r),this.code=t,this.customData=o,this.name=Mx,Object.setPrototypeOf(this,vi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ep.prototype.create)}}class Ep{constructor(t,r,o){this.service=t,this.serviceName=r,this.errors=o}create(t,...r){const o=r[0]||{},a=`${this.service}/${t}`,d=this.errors[t],h=d?Dx(d,o):"Error",p=`${this.serviceName}: ${h} (${a}).`;return new vi(a,p,o)}}function Dx(s,t){return s.replace(Ox,(r,o)=>{const a=t[o];return a!=null?String(a):`<${o}?>`})}const Ox=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ci(s){return JSON.parse(s)}function _t(s){return JSON.stringify(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jp=function(s){let t={},r={},o={},a="";try{const d=s.split(".");t=ci(yc(d[0])||""),r=ci(yc(d[1])||""),a=d[2],o=r.d||{},delete r.d}catch{}return{header:t,claims:r,data:o,signature:a}},Ax=function(s){const t=jp(s),r=t.claims;return!!r&&typeof r=="object"&&r.hasOwnProperty("iat")},Fx=function(s){const t=jp(s).claims;return typeof t=="object"&&t.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ln(s,t){return Object.prototype.hasOwnProperty.call(s,t)}function os(s,t){if(Object.prototype.hasOwnProperty.call(s,t))return s[t]}function Nh(s){for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t))return!1;return!0}function Uo(s,t,r){const o={};for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&(o[a]=t.call(r,s[a],a,s));return o}function Bo(s,t){if(s===t)return!0;const r=Object.keys(s),o=Object.keys(t);for(const a of r){if(!o.includes(a))return!1;const d=s[a],h=t[a];if(kh(d)&&kh(h)){if(!Bo(d,h))return!1}else if(d!==h)return!1}for(const a of o)if(!r.includes(a))return!1;return!0}function kh(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zx(s){const t=[];for(const[r,o]of Object.entries(s))Array.isArray(o)?o.forEach(a=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(o));return t.length?"&"+t.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $x{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,r){r||(r=0);const o=this.W_;if(typeof t=="string")for(let y=0;y<16;y++)o[y]=t.charCodeAt(r)<<24|t.charCodeAt(r+1)<<16|t.charCodeAt(r+2)<<8|t.charCodeAt(r+3),r+=4;else for(let y=0;y<16;y++)o[y]=t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3],r+=4;for(let y=16;y<80;y++){const v=o[y-3]^o[y-8]^o[y-14]^o[y-16];o[y]=(v<<1|v>>>31)&4294967295}let a=this.chain_[0],d=this.chain_[1],h=this.chain_[2],p=this.chain_[3],g=this.chain_[4],x,k;for(let y=0;y<80;y++){y<40?y<20?(x=p^d&(h^p),k=1518500249):(x=d^h^p,k=1859775393):y<60?(x=d&h|p&(d|h),k=2400959708):(x=d^h^p,k=3395469782);const v=(a<<5|a>>>27)+x+g+k+o[y]&4294967295;g=p,p=h,h=(d<<30|d>>>2)&4294967295,d=a,a=v}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+d&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+p&4294967295,this.chain_[4]=this.chain_[4]+g&4294967295}update(t,r){if(t==null)return;r===void 0&&(r=t.length);const o=r-this.blockSize;let a=0;const d=this.buf_;let h=this.inbuf_;for(;a<r;){if(h===0)for(;a<=o;)this.compress_(t,a),a+=this.blockSize;if(typeof t=="string"){for(;a<r;)if(d[h]=t.charCodeAt(a),++h,++a,h===this.blockSize){this.compress_(d),h=0;break}}else for(;a<r;)if(d[h]=t[a],++h,++a,h===this.blockSize){this.compress_(d),h=0;break}}this.inbuf_=h,this.total_+=r}digest(){const t=[];let r=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let a=this.blockSize-1;a>=56;a--)this.buf_[a]=r&255,r/=256;this.compress_(this.buf_);let o=0;for(let a=0;a<5;a++)for(let d=24;d>=0;d-=8)t[o]=this.chain_[a]>>d&255,++o;return t}}function Uc(s,t){return`${s} failed: ${t} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux=function(s){const t=[];let r=0;for(let o=0;o<s.length;o++){let a=s.charCodeAt(o);if(a>=55296&&a<=56319){const d=a-55296;o++,K(o<s.length,"Surrogate pair missing trail surrogate.");const h=s.charCodeAt(o)-56320;a=65536+(d<<10)+h}a<128?t[r++]=a:a<2048?(t[r++]=a>>6|192,t[r++]=a&63|128):a<65536?(t[r++]=a>>12|224,t[r++]=a>>6&63|128,t[r++]=a&63|128):(t[r++]=a>>18|240,t[r++]=a>>12&63|128,t[r++]=a>>6&63|128,t[r++]=a&63|128)}return t},il=function(s){let t=0;for(let r=0;r<s.length;r++){const o=s.charCodeAt(r);o<128?t++:o<2048?t+=2:o>=55296&&o<=56319?(t+=4,r++):t+=3}return t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yi(s){return s&&s._delegate?s._delegate:s}class ui{constructor(t,r,o){this.name=t,this.instanceFactory=r,this.type=o,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const o=new sl;if(this.instancesDeferred.set(r,o),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&o.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),o=(t==null?void 0:t.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(o)return null;throw a}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Hx(t))try{this.getOrInitializeService({instanceIdentifier:wr})}catch{}for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const d=this.getOrInitializeService({instanceIdentifier:a});o.resolve(d)}catch{}}}}clearInstance(t=wr){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=wr){return this.instances.has(t)}getOptions(t=wr){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(`${this.name}(${o}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:o,options:r});for(const[d,h]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(d);o===p&&h.resolve(a)}return a}onInit(t,r){const o=this.normalizeInstanceIdentifier(r),a=this.onInitCallbacks.get(o)??new Set;a.add(t),this.onInitCallbacks.set(o,a);const d=this.instances.get(o);return d&&t(d,o),()=>{a.delete(t)}}invokeOnInitCallbacks(t,r){const o=this.onInitCallbacks.get(r);if(o)for(const a of o)try{a(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let o=this.instances.get(t);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:Wx(t),options:r}),this.instances.set(t,o),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(o,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,o)}catch{}return o||null}normalizeInstanceIdentifier(t=wr){return this.component?this.component.multipleInstances?t:wr:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Wx(s){return s===wr?void 0:s}function Hx(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vx{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new Bx(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qe;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(qe||(qe={}));const Yx={debug:qe.DEBUG,verbose:qe.VERBOSE,info:qe.INFO,warn:qe.WARN,error:qe.ERROR,silent:qe.SILENT},Qx=qe.INFO,Gx={[qe.DEBUG]:"log",[qe.VERBOSE]:"log",[qe.INFO]:"info",[qe.WARN]:"warn",[qe.ERROR]:"error"},Xx=(s,t,...r)=>{if(t<s.logLevel)return;const o=new Date().toISOString(),a=Gx[t];if(a)console[a](`[${o}]  ${s.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Ip{constructor(t){this.name=t,this._logLevel=Qx,this._logHandler=Xx,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in qe))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Yx[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,qe.DEBUG,...t),this._logHandler(this,qe.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,qe.VERBOSE,...t),this._logHandler(this,qe.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,qe.INFO,...t),this._logHandler(this,qe.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,qe.WARN,...t),this._logHandler(this,qe.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,qe.ERROR,...t),this._logHandler(this,qe.ERROR,...t)}}const qx=(s,t)=>t.some(r=>s instanceof r);let Ch,Sh;function Kx(){return Ch||(Ch=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Jx(){return Sh||(Sh=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Tp=new WeakMap,_c=new WeakMap,Rp=new WeakMap,ac=new WeakMap,Bc=new WeakMap;function Zx(s){const t=new Promise((r,o)=>{const a=()=>{s.removeEventListener("success",d),s.removeEventListener("error",h)},d=()=>{r(Zn(s.result)),a()},h=()=>{o(s.error),a()};s.addEventListener("success",d),s.addEventListener("error",h)});return t.then(r=>{r instanceof IDBCursor&&Tp.set(r,s)}).catch(()=>{}),Bc.set(t,s),t}function ev(s){if(_c.has(s))return;const t=new Promise((r,o)=>{const a=()=>{s.removeEventListener("complete",d),s.removeEventListener("error",h),s.removeEventListener("abort",h)},d=()=>{r(),a()},h=()=>{o(s.error||new DOMException("AbortError","AbortError")),a()};s.addEventListener("complete",d),s.addEventListener("error",h),s.addEventListener("abort",h)});_c.set(s,t)}let wc={get(s,t,r){if(s instanceof IDBTransaction){if(t==="done")return _c.get(s);if(t==="objectStoreNames")return s.objectStoreNames||Rp.get(s);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Zn(s[t])},set(s,t,r){return s[t]=r,!0},has(s,t){return s instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in s}};function tv(s){wc=s(wc)}function nv(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const o=s.call(cc(this),t,...r);return Rp.set(o,t.sort?t.sort():[t]),Zn(o)}:Jx().includes(s)?function(...t){return s.apply(cc(this),t),Zn(Tp.get(this))}:function(...t){return Zn(s.apply(cc(this),t))}}function rv(s){return typeof s=="function"?nv(s):(s instanceof IDBTransaction&&ev(s),qx(s,Kx())?new Proxy(s,wc):s)}function Zn(s){if(s instanceof IDBRequest)return Zx(s);if(ac.has(s))return ac.get(s);const t=rv(s);return t!==s&&(ac.set(s,t),Bc.set(t,s)),t}const cc=s=>Bc.get(s);function sv(s,t,{blocked:r,upgrade:o,blocking:a,terminated:d}={}){const h=indexedDB.open(s,t),p=Zn(h);return o&&h.addEventListener("upgradeneeded",g=>{o(Zn(h.result),g.oldVersion,g.newVersion,Zn(h.transaction),g)}),r&&h.addEventListener("blocked",g=>r(g.oldVersion,g.newVersion,g)),p.then(g=>{d&&g.addEventListener("close",()=>d()),a&&g.addEventListener("versionchange",x=>a(x.oldVersion,x.newVersion,x))}).catch(()=>{}),p}const iv=["get","getKey","getAll","getAllKeys","count"],ov=["put","add","delete","clear"],uc=new Map;function Eh(s,t){if(!(s instanceof IDBDatabase&&!(t in s)&&typeof t=="string"))return;if(uc.get(t))return uc.get(t);const r=t.replace(/FromIndex$/,""),o=t!==r,a=ov.includes(r);if(!(r in(o?IDBIndex:IDBObjectStore).prototype)||!(a||iv.includes(r)))return;const d=async function(h,...p){const g=this.transaction(h,a?"readwrite":"readonly");let x=g.store;return o&&(x=x.index(p.shift())),(await Promise.all([x[r](...p),a&&g.done]))[0]};return uc.set(t,d),d}tv(s=>({...s,get:(t,r,o)=>Eh(t,r)||s.get(t,r,o),has:(t,r)=>!!Eh(t,r)||s.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(av(r)){const o=r.getImmediate();return`${o.library}/${o.version}`}else return null}).filter(r=>r).join(" ")}}function av(s){const t=s.getComponent();return(t==null?void 0:t.type)==="VERSION"}const bc="@firebase/app",jh="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tn=new Ip("@firebase/app"),cv="@firebase/app-compat",uv="@firebase/analytics-compat",dv="@firebase/analytics",fv="@firebase/app-check-compat",hv="@firebase/app-check",pv="@firebase/auth",mv="@firebase/auth-compat",gv="@firebase/database",xv="@firebase/data-connect",vv="@firebase/database-compat",yv="@firebase/functions",_v="@firebase/functions-compat",wv="@firebase/installations",bv="@firebase/installations-compat",Nv="@firebase/messaging",kv="@firebase/messaging-compat",Cv="@firebase/performance",Sv="@firebase/performance-compat",Ev="@firebase/remote-config",jv="@firebase/remote-config-compat",Iv="@firebase/storage",Tv="@firebase/storage-compat",Rv="@firebase/firestore",Pv="@firebase/ai",Lv="@firebase/firestore-compat",Mv="firebase",Dv="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nc="[DEFAULT]",Ov={[bc]:"fire-core",[cv]:"fire-core-compat",[dv]:"fire-analytics",[uv]:"fire-analytics-compat",[hv]:"fire-app-check",[fv]:"fire-app-check-compat",[pv]:"fire-auth",[mv]:"fire-auth-compat",[gv]:"fire-rtdb",[xv]:"fire-data-connect",[vv]:"fire-rtdb-compat",[yv]:"fire-fn",[_v]:"fire-fn-compat",[wv]:"fire-iid",[bv]:"fire-iid-compat",[Nv]:"fire-fcm",[kv]:"fire-fcm-compat",[Cv]:"fire-perf",[Sv]:"fire-perf-compat",[Ev]:"fire-rc",[jv]:"fire-rc-compat",[Iv]:"fire-gcs",[Tv]:"fire-gcs-compat",[Rv]:"fire-fst",[Lv]:"fire-fst-compat",[Pv]:"fire-vertex","fire-js":"fire-js",[Mv]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wo=new Map,Av=new Map,kc=new Map;function Ih(s,t){try{s.container.addComponent(t)}catch(r){Tn.debug(`Component ${t.name} failed to register with FirebaseApp ${s.name}`,r)}}function Ho(s){const t=s.name;if(kc.has(t))return Tn.debug(`There were multiple attempts to register component ${t}.`),!1;kc.set(t,s);for(const r of Wo.values())Ih(r,s);for(const r of Av.values())Ih(r,s);return!0}function Fv(s,t){const r=s.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),s.container.getProvider(t)}function zv(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $v={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},er=new Ep("app","Firebase",$v);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(t,r,o){this._isDeleted=!1,this._options={...t},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=o,this.container.addComponent(new ui("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw er.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bv=Dv;function Pp(s,t={}){let r=s;typeof t!="object"&&(t={name:t});const o={name:Nc,automaticDataCollectionEnabled:!0,...t},a=o.name;if(typeof a!="string"||!a)throw er.create("bad-app-name",{appName:String(a)});if(r||(r=Cp()),!r)throw er.create("no-options");const d=Wo.get(a);if(d){if(Bo(r,d.options)&&Bo(o,d.config))return d;throw er.create("duplicate-app",{appName:a})}const h=new Vx(a);for(const g of kc.values())h.addComponent(g);const p=new Uv(r,o,h);return Wo.set(a,p),p}function Wv(s=Nc){const t=Wo.get(s);if(!t&&s===Nc&&Cp())return Pp();if(!t)throw er.create("no-app",{appName:s});return t}function ns(s,t,r){let o=Ov[s]??s;r&&(o+=`-${r}`);const a=o.match(/\s|\//),d=t.match(/\s|\//);if(a||d){const h=[`Unable to register library "${o}" with version "${t}":`];a&&h.push(`library name "${o}" contains illegal characters (whitespace or "/")`),a&&d&&h.push("and"),d&&h.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Tn.warn(h.join(" "));return}Ho(new ui(`${o}-version`,()=>({library:o,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hv="firebase-heartbeat-database",Vv=1,di="firebase-heartbeat-store";let dc=null;function Lp(){return dc||(dc=sv(Hv,Vv,{upgrade:(s,t)=>{switch(t){case 0:try{s.createObjectStore(di)}catch(r){console.warn(r)}}}}).catch(s=>{throw er.create("idb-open",{originalErrorMessage:s.message})})),dc}async function Yv(s){try{const r=(await Lp()).transaction(di),o=await r.objectStore(di).get(Mp(s));return await r.done,o}catch(t){if(t instanceof vi)Tn.warn(t.message);else{const r=er.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Tn.warn(r.message)}}}async function Th(s,t){try{const o=(await Lp()).transaction(di,"readwrite");await o.objectStore(di).put(t,Mp(s)),await o.done}catch(r){if(r instanceof vi)Tn.warn(r.message);else{const o=er.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Tn.warn(o.message)}}}function Mp(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qv=1024,Gv=30;class Xv{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Kv(r),this._heartbeatsCachePromise=this._storage.read().then(o=>(this._heartbeatsCache=o,o))}async triggerHeartbeat(){var t,r;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),d=Rh();if(((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===d||this._heartbeatsCache.heartbeats.some(h=>h.date===d))return;if(this._heartbeatsCache.heartbeats.push({date:d,agent:a}),this._heartbeatsCache.heartbeats.length>Gv){const h=Jv(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(h,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(o){Tn.warn(o)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Rh(),{heartbeatsToSend:o,unsentEntries:a}=qv(this._heartbeatsCache.heartbeats),d=$o(JSON.stringify({version:2,heartbeats:o}));return this._heartbeatsCache.lastSentHeartbeatDate=r,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),d}catch(r){return Tn.warn(r),""}}}function Rh(){return new Date().toISOString().substring(0,10)}function qv(s,t=Qv){const r=[];let o=s.slice();for(const a of s){const d=r.find(h=>h.agent===a.agent);if(d){if(d.dates.push(a.date),Ph(r)>t){d.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),Ph(r)>t){r.pop();break}o=o.slice(1)}return{heartbeatsToSend:r,unsentEntries:o}}class Kv{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Px()?Lx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Yv(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const o=await this.read();return Th(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??o.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const o=await this.read();return Th(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...t.heartbeats]})}else return}}function Ph(s){return $o(JSON.stringify({version:2,heartbeats:s})).length}function Jv(s){if(s.length===0)return-1;let t=0,r=s[0].date;for(let o=1;o<s.length;o++)s[o].date<r&&(r=s[o].date,t=o);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zv(s){Ho(new ui("platform-logger",t=>new lv(t),"PRIVATE")),Ho(new ui("heartbeat",t=>new Xv(t),"PRIVATE")),ns(bc,jh,s),ns(bc,jh,"esm2020"),ns("fire-js","")}Zv("");var ey="firebase",ty="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ns(ey,ty,"app");var Lh={};const Mh="@firebase/database",Dh="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dp="";function ny(s){Dp=s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,r){r==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),_t(r))}get(t){const r=this.domStorage_.getItem(this.prefixedName_(t));return r==null?null:ci(r)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,r){r==null?delete this.cache_[t]:this.cache_[t]=r}get(t){return Ln(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Op=function(s){try{if(typeof window<"u"&&typeof window[s]<"u"){const t=window[s];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new ry(t)}}catch{}return new sy},Nr=Op("localStorage"),iy=Op("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs=new Ip("@firebase/database"),oy=(function(){let s=1;return function(){return s++}})(),Ap=function(s){const t=Ux(s),r=new $x;r.update(t);const o=r.digest();return zc.encodeByteArray(o)},_i=function(...s){let t="";for(let r=0;r<s.length;r++){const o=s[r];Array.isArray(o)||o&&typeof o=="object"&&typeof o.length=="number"?t+=_i.apply(null,o):typeof o=="object"?t+=_t(o):t+=o,t+=" "}return t};let si=null,Oh=!0;const ly=function(s,t){K(!0,"Can't turn on custom loggers persistently."),rs.logLevel=qe.VERBOSE,si=rs.log.bind(rs)},Tt=function(...s){if(Oh===!0&&(Oh=!1,si===null&&iy.get("logging_enabled")===!0&&ly()),si){const t=_i.apply(null,s);si(t)}},wi=function(s){return function(...t){Tt(s,...t)}},Cc=function(...s){const t="FIREBASE INTERNAL ERROR: "+_i(...s);rs.error(t)},Rn=function(...s){const t=`FIREBASE FATAL ERROR: ${_i(...s)}`;throw rs.error(t),new Error(t)},Bt=function(...s){const t="FIREBASE WARNING: "+_i(...s);rs.warn(t)},ay=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Bt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Fp=function(s){return typeof s=="number"&&(s!==s||s===Number.POSITIVE_INFINITY||s===Number.NEGATIVE_INFINITY)},cy=function(s){if(document.readyState==="complete")s();else{let t=!1;const r=function(){if(!document.body){setTimeout(r,Math.floor(10));return}t||(t=!0,s())};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&r()}),window.attachEvent("onload",r))}},ls="[MIN_NAME]",Cr="[MAX_NAME]",ds=function(s,t){if(s===t)return 0;if(s===ls||t===Cr)return-1;if(t===ls||s===Cr)return 1;{const r=Ah(s),o=Ah(t);return r!==null?o!==null?r-o===0?s.length-t.length:r-o:-1:o!==null?1:s<t?-1:1}},uy=function(s,t){return s===t?0:s<t?-1:1},Js=function(s,t){if(t&&s in t)return t[s];throw new Error("Missing required key ("+s+") in object: "+_t(t))},Wc=function(s){if(typeof s!="object"||s===null)return _t(s);const t=[];for(const o in s)t.push(o);t.sort();let r="{";for(let o=0;o<t.length;o++)o!==0&&(r+=","),r+=_t(t[o]),r+=":",r+=Wc(s[t[o]]);return r+="}",r},zp=function(s,t){const r=s.length;if(r<=t)return[s];const o=[];for(let a=0;a<r;a+=t)a+t>r?o.push(s.substring(a,r)):o.push(s.substring(a,a+t));return o};function Wt(s,t){for(const r in s)s.hasOwnProperty(r)&&t(r,s[r])}const $p=function(s){K(!Fp(s),"Invalid JSON number");const t=11,r=52,o=(1<<t-1)-1;let a,d,h,p,g;s===0?(d=0,h=0,a=1/s===-1/0?1:0):(a=s<0,s=Math.abs(s),s>=Math.pow(2,1-o)?(p=Math.min(Math.floor(Math.log(s)/Math.LN2),o),d=p+o,h=Math.round(s*Math.pow(2,r-p)-Math.pow(2,r))):(d=0,h=Math.round(s/Math.pow(2,1-o-r))));const x=[];for(g=r;g;g-=1)x.push(h%2?1:0),h=Math.floor(h/2);for(g=t;g;g-=1)x.push(d%2?1:0),d=Math.floor(d/2);x.push(a?1:0),x.reverse();const k=x.join("");let y="";for(g=0;g<64;g+=8){let v=parseInt(k.substr(g,8),2).toString(16);v.length===1&&(v="0"+v),y=y+v}return y.toLowerCase()},dy=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},fy=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function hy(s,t){let r="Unknown Error";s==="too_big"?r="The data requested exceeds the maximum size that can be accessed with a single request.":s==="permission_denied"?r="Client doesn't have permission to access the desired data.":s==="unavailable"&&(r="The service is unavailable");const o=new Error(s+" at "+t._path.toString()+": "+r);return o.code=s.toUpperCase(),o}const py=new RegExp("^-?(0*)\\d{1,10}$"),my=-2147483648,gy=2147483647,Ah=function(s){if(py.test(s)){const t=Number(s);if(t>=my&&t<=gy)return t}return null},fs=function(s){try{s()}catch(t){setTimeout(()=>{const r=t.stack||"";throw Bt("Exception was thrown by user callback.",r),t},Math.floor(0))}},xy=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ii=function(s,t){const r=setTimeout(s,t);return typeof r=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(r):typeof r=="object"&&r.unref&&r.unref(),r};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{constructor(t,r){this.appCheckProvider=r,this.appName=t.name,zv(t)&&t.settings.appCheckToken&&(this.serverAppAppCheckToken=t.settings.appCheckToken),this.appCheck=r==null?void 0:r.getImmediate({optional:!0}),this.appCheck||r==null||r.get().then(o=>this.appCheck=o)}getToken(t){if(this.serverAppAppCheckToken){if(t)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(t):new Promise((r,o)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(r,o):r(null)},0)})}addTokenChangeListener(t){var r;(r=this.appCheckProvider)==null||r.get().then(o=>o.addTokenListener(t))}notifyForInvalidToken(){Bt(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(t,r,o){this.appName_=t,this.firebaseOptions_=r,this.authProvider_=o,this.auth_=null,this.auth_=o.getImmediate({optional:!0}),this.auth_||o.onInit(a=>this.auth_=a)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(r=>r&&r.code==="auth/token-not-initialized"?(Tt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(r)):new Promise((r,o)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(r,o):r(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(r=>r.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(r=>r.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Bt(t)}}class Fo{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}Fo.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hc="5",Up="v",Bp="s",Wp="r",Hp="f",Vp=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Yp="ls",Qp="p",Sc="ac",Gp="websocket",Xp="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(t,r,o,a,d=!1,h="",p=!1,g=!1,x=null){this.secure=r,this.namespace=o,this.webSocketOnly=a,this.nodeAdmin=d,this.persistenceKey=h,this.includeNamespaceInQueryParams=p,this.isUsingEmulator=g,this.emulatorOptions=x,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Nr.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&Nr.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",r=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${r}`}}function _y(s){return s.host!==s.internalHost||s.isCustomHost()||s.includeNamespaceInQueryParams}function Kp(s,t,r){K(typeof t=="string","typeof type must == string"),K(typeof r=="object","typeof params must == object");let o;if(t===Gp)o=(s.secure?"wss://":"ws://")+s.internalHost+"/.ws?";else if(t===Xp)o=(s.secure?"https://":"http://")+s.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);_y(s)&&(r.ns=s.namespace);const a=[];return Wt(r,(d,h)=>{a.push(d+"="+h)}),o+a.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(){this.counters_={}}incrementCounter(t,r=1){Ln(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=r}get(){return gx(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fc={},hc={};function Vc(s){const t=s.toString();return fc[t]||(fc[t]=new wy),fc[t]}function by(s,t){const r=s.toString();return hc[r]||(hc[r]=t()),hc[r]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,r){this.closeAfterResponse=t,this.onClose=r,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,r){for(this.pendingResponses[t]=r;this.pendingResponses[this.currentResponseNum];){const o=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let a=0;a<o.length;++a)o[a]&&fs(()=>{this.onMessage_(o[a])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fh="start",ky="close",Cy="pLPCommand",Sy="pRTLPCB",Jp="id",Zp="pw",em="ser",Ey="cb",jy="seg",Iy="ts",Ty="d",Ry="dframe",tm=1870,nm=30,Py=tm-nm,Ly=25e3,My=3e4;class ts{constructor(t,r,o,a,d,h,p){this.connId=t,this.repoInfo=r,this.applicationId=o,this.appCheckToken=a,this.authToken=d,this.transportSessionId=h,this.lastSessionId=p,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=wi(t),this.stats_=Vc(r),this.urlFn=g=>(this.appCheckToken&&(g[Sc]=this.appCheckToken),Kp(r,Xp,g))}open(t,r){this.curSegmentNum=0,this.onDisconnect_=r,this.myPacketOrderer=new Ny(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(My)),cy(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Yc((...d)=>{const[h,p,g,x,k]=d;if(this.incrementIncomingBytes_(d),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,h===Fh)this.id=p,this.password=g;else if(h===ky)p?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(p,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+h)},(...d)=>{const[h,p]=d;this.incrementIncomingBytes_(d),this.myPacketOrderer.handleResponse(h,p)},()=>{this.onClosed_()},this.urlFn);const o={};o[Fh]="t",o[em]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(o[Ey]=this.scriptTagHolder.uniqueCallbackIdentifier),o[Up]=Hc,this.transportSessionId&&(o[Bp]=this.transportSessionId),this.lastSessionId&&(o[Yp]=this.lastSessionId),this.applicationId&&(o[Qp]=this.applicationId),this.appCheckToken&&(o[Sc]=this.appCheckToken),typeof location<"u"&&location.hostname&&Vp.test(location.hostname)&&(o[Wp]=Hp);const a=this.urlFn(o);this.log_("Connecting via long-poll to "+a),this.scriptTagHolder.addTag(a,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ts.forceAllow_=!0}static forceDisallow(){ts.forceDisallow_=!0}static isAvailable(){return ts.forceAllow_?!0:!ts.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!dy()&&!fy()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const r=_t(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const o=bp(r),a=zp(o,Py);for(let d=0;d<a.length;d++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,a.length,a[d]),this.curSegmentNum++}addDisconnectPingFrame(t,r){this.myDisconnFrame=document.createElement("iframe");const o={};o[Ry]="t",o[Jp]=t,o[Zp]=r,this.myDisconnFrame.src=this.urlFn(o),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const r=_t(t).length;this.bytesReceived+=r,this.stats_.incrementCounter("bytes_received",r)}}class Yc{constructor(t,r,o,a){this.onDisconnect=o,this.urlFn=a,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=oy(),window[Cy+this.uniqueCallbackIdentifier]=t,window[Sy+this.uniqueCallbackIdentifier]=r,this.myIFrame=Yc.createIFrame_();let d="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(d='<script>document.domain="'+document.domain+'";<\/script>');const h="<html><body>"+d+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(h),this.myIFrame.doc.close()}catch(p){Tt("frame writing exception"),p.stack&&Tt(p.stack),Tt(p)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||Tt("No IE domain setting required")}catch{const o=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+o+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,r){for(this.myID=t,this.myPW=r,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t[Jp]=this.myID,t[Zp]=this.myPW,t[em]=this.currentSerial;let r=this.urlFn(t),o="",a=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+nm+o.length<=tm;){const h=this.pendingSegs.shift();o=o+"&"+jy+a+"="+h.seg+"&"+Iy+a+"="+h.ts+"&"+Ty+a+"="+h.d,a++}return r=r+o,this.addLongPollTag_(r,this.currentSerial),!0}else return!1}enqueueSegment(t,r,o){this.pendingSegs.push({seg:t,ts:r,d:o}),this.alive&&this.newRequest_()}addLongPollTag_(t,r){this.outstandingRequests.add(r);const o=()=>{this.outstandingRequests.delete(r),this.newRequest_()},a=setTimeout(o,Math.floor(Ly)),d=()=>{clearTimeout(a),o()};this.addTag(t,d)}addTag(t,r){setTimeout(()=>{try{if(!this.sendNewPolls)return;const o=this.myIFrame.doc.createElement("script");o.type="text/javascript",o.async=!0,o.src=t,o.onload=o.onreadystatechange=function(){const a=o.readyState;(!a||a==="loaded"||a==="complete")&&(o.onload=o.onreadystatechange=null,o.parentNode&&o.parentNode.removeChild(o),r())},o.onerror=()=>{Tt("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(o)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dy=16384,Oy=45e3;let Vo=null;typeof MozWebSocket<"u"?Vo=MozWebSocket:typeof WebSocket<"u"&&(Vo=WebSocket);class cn{constructor(t,r,o,a,d,h,p){this.connId=t,this.applicationId=o,this.appCheckToken=a,this.authToken=d,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=wi(this.connId),this.stats_=Vc(r),this.connURL=cn.connectionURL_(r,h,p,a,o),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,o,a,d){const h={};return h[Up]=Hc,typeof location<"u"&&location.hostname&&Vp.test(location.hostname)&&(h[Wp]=Hp),r&&(h[Bp]=r),o&&(h[Yp]=o),a&&(h[Sc]=a),d&&(h[Qp]=d),Kp(t,Gp,h)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Nr.set("previous_websocket_failure",!0);try{let o;Rx(),this.mySock=new Vo(this.connURL,[],o)}catch(o){this.log_("Error instantiating WebSocket.");const a=o.message||o.data;a&&this.log_(a),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=o=>{this.handleIncomingFrame(o)},this.mySock.onerror=o=>{this.log_("WebSocket error.  Closing connection.");const a=o.message||o.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){cn.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=/Android ([0-9]{0,}\.[0-9]{0,})/,o=navigator.userAgent.match(r);o&&o.length>1&&parseFloat(o[1])<4.4&&(t=!0)}return!t&&Vo!==null&&!cn.forceDisallow_}static previouslyFailed(){return Nr.isInMemoryStorage||Nr.get("previous_websocket_failure")===!0}markConnectionHealthy(){Nr.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const o=ci(r);this.onMessage(o)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(K(this.frames===null,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{const o=this.extractFrameCount_(r);o!==null&&this.appendFrame_(o)}}send(t){this.resetKeepAlive();const r=_t(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const o=zp(r,Dy);o.length>1&&this.sendString_(String(o.length));for(let a=0;a<o.length;a++)this.sendString_(o[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Oy))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}cn.responsesRequiredToBeHealthy=2;cn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{static get ALL_TRANSPORTS(){return[ts,cn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){const r=cn&&cn.isAvailable();let o=r&&!cn.previouslyFailed();if(t.webSocketOnly&&(r||Bt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[cn];else{const a=this.transports_=[];for(const d of fi.ALL_TRANSPORTS)d&&d.isAvailable()&&a.push(d);fi.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}fi.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay=6e4,Fy=5e3,zy=10*1024,$y=100*1024,pc="t",zh="d",Uy="s",$h="r",By="e",Uh="o",Bh="a",Wh="n",Hh="p",Wy="h";class Hy{constructor(t,r,o,a,d,h,p,g,x,k){this.id=t,this.repoInfo_=r,this.applicationId_=o,this.appCheckToken_=a,this.authToken_=d,this.onMessage_=h,this.onReady_=p,this.onDisconnect_=g,this.onKill_=x,this.lastSessionId=k,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=wi("c:"+this.id+":"),this.transportManager_=new fi(r),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.conn_),o=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(r,o)},Math.floor(0));const a=t.healthyTimeout||0;a>0&&(this.healthyTimeout_=ii(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>$y?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>zy?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(a)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return r=>{t===this.conn_?this.onConnectionLost_(r):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return r=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(r):t===this.secondaryConn_?this.onSecondaryMessageReceived_(r):this.log_("message on old connection"))}}sendRequest(t){const r={t:"d",d:t};this.sendData_(r)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(pc in t){const r=t[pc];r===Bh?this.upgradeIfSecondaryHealthy_():r===$h?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):r===Uh&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const r=Js("t",t),o=Js("d",t);if(r==="c")this.onSecondaryControl_(o);else if(r==="d")this.pendingDataMessages.push(o);else throw new Error("Unknown protocol layer: "+r)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Hh,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Bh,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Wh,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const r=Js("t",t),o=Js("d",t);r==="c"?this.onControl_(o):r==="d"&&this.onDataMessage_(o)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const r=Js(pc,t);if(zh in t){const o=t[zh];if(r===Wy){const a={...o};this.repoInfo_.isUsingEmulator&&(a.h=this.repoInfo_.host),this.onHandshake_(a)}else if(r===Wh){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let a=0;a<this.pendingDataMessages.length;++a)this.onDataMessage_(this.pendingDataMessages[a]);this.pendingDataMessages=[],this.tryCleanupConnection()}else r===Uy?this.onConnectionShutdown_(o):r===$h?this.onReset_(o):r===By?Cc("Server Error: "+o):r===Uh?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Cc("Unknown control packet command: "+r)}}onHandshake_(t){const r=t.ts,o=t.v,a=t.h;this.sessionId=t.s,this.repoInfo_.host=a,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,r),Hc!==o&&Bt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.secondaryConn_),o=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,o),ii(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Ay))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,r){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(r,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ii(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Fy))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Hh,d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Nr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rm{put(t,r,o,a){}merge(t,r,o,a){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,r,o){}onDisconnectMerge(t,r,o){}onDisconnectCancel(t,r){}reportStats(t){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sm{constructor(t){this.allowedEvents_=t,this.listeners_={},K(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...r){if(Array.isArray(this.listeners_[t])){const o=[...this.listeners_[t]];for(let a=0;a<o.length;a++)o[a].callback.apply(o[a].context,r)}}on(t,r,o){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:r,context:o});const a=this.getInitialEvent(t);a&&r.apply(o,a)}off(t,r,o){this.validateEventType_(t);const a=this.listeners_[t]||[];for(let d=0;d<a.length;d++)if(a[d].callback===r&&(!o||o===a[d].context)){a.splice(d,1);return}}validateEventType_(t){K(this.allowedEvents_.find(r=>r===t),"Unknown event: "+t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo extends sm{static getInstance(){return new Yo}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Sp()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(t){return K(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vh=32,Yh=768;class Ge{constructor(t,r){if(r===void 0){this.pieces_=t.split("/");let o=0;for(let a=0;a<this.pieces_.length;a++)this.pieces_[a].length>0&&(this.pieces_[o]=this.pieces_[a],o++);this.pieces_.length=o,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=r}toString(){let t="";for(let r=this.pieceNum_;r<this.pieces_.length;r++)this.pieces_[r]!==""&&(t+="/"+this.pieces_[r]);return t||"/"}}function Be(){return new Ge("")}function Re(s){return s.pieceNum_>=s.pieces_.length?null:s.pieces_[s.pieceNum_]}function nr(s){return s.pieces_.length-s.pieceNum_}function Ke(s){let t=s.pieceNum_;return t<s.pieces_.length&&t++,new Ge(s.pieces_,t)}function im(s){return s.pieceNum_<s.pieces_.length?s.pieces_[s.pieces_.length-1]:null}function Vy(s){let t="";for(let r=s.pieceNum_;r<s.pieces_.length;r++)s.pieces_[r]!==""&&(t+="/"+encodeURIComponent(String(s.pieces_[r])));return t||"/"}function om(s,t=0){return s.pieces_.slice(s.pieceNum_+t)}function lm(s){if(s.pieceNum_>=s.pieces_.length)return null;const t=[];for(let r=s.pieceNum_;r<s.pieces_.length-1;r++)t.push(s.pieces_[r]);return new Ge(t,0)}function pt(s,t){const r=[];for(let o=s.pieceNum_;o<s.pieces_.length;o++)r.push(s.pieces_[o]);if(t instanceof Ge)for(let o=t.pieceNum_;o<t.pieces_.length;o++)r.push(t.pieces_[o]);else{const o=t.split("/");for(let a=0;a<o.length;a++)o[a].length>0&&r.push(o[a])}return new Ge(r,0)}function Me(s){return s.pieceNum_>=s.pieces_.length}function $t(s,t){const r=Re(s),o=Re(t);if(r===null)return t;if(r===o)return $t(Ke(s),Ke(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+s+")")}function Qc(s,t){if(nr(s)!==nr(t))return!1;for(let r=s.pieceNum_,o=t.pieceNum_;r<=s.pieces_.length;r++,o++)if(s.pieces_[r]!==t.pieces_[o])return!1;return!0}function un(s,t){let r=s.pieceNum_,o=t.pieceNum_;if(nr(s)>nr(t))return!1;for(;r<s.pieces_.length;){if(s.pieces_[r]!==t.pieces_[o])return!1;++r,++o}return!0}class Yy{constructor(t,r){this.errorPrefix_=r,this.parts_=om(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let o=0;o<this.parts_.length;o++)this.byteLength_+=il(this.parts_[o]);am(this)}}function Qy(s,t){s.parts_.length>0&&(s.byteLength_+=1),s.parts_.push(t),s.byteLength_+=il(t),am(s)}function Gy(s){const t=s.parts_.pop();s.byteLength_-=il(t),s.parts_.length>0&&(s.byteLength_-=1)}function am(s){if(s.byteLength_>Yh)throw new Error(s.errorPrefix_+"has a key path longer than "+Yh+" bytes ("+s.byteLength_+").");if(s.parts_.length>Vh)throw new Error(s.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Vh+") or object contains a cycle "+br(s))}function br(s){return s.parts_.length===0?"":"in property '"+s.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc extends sm{static getInstance(){return new Gc}constructor(){super(["visible"]);let t,r;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(r="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(r="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(r="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(r="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,r&&document.addEventListener(r,()=>{const o=!document[t];o!==this.visible_&&(this.visible_=o,this.trigger("visible",o))},!1)}getInitialEvent(t){return K(t==="visible","Unknown event type: "+t),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zs=1e3,Xy=300*1e3,Qh=30*1e3,qy=1.3,Ky=3e4,Jy="server_kill",Gh=3;class In extends rm{constructor(t,r,o,a,d,h,p,g){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=o,this.onConnectStatus_=a,this.onServerInfoUpdate_=d,this.authTokenProvider_=h,this.appCheckTokenProvider_=p,this.authOverride_=g,this.id=In.nextPersistentConnectionId_++,this.log_=wi("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Zs,this.maxReconnectDelay_=Xy,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,g)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Gc.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Yo.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,o){const a=++this.requestNumber_,d={r:a,a:t,b:r};this.log_(_t(d)),K(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(d),o&&(this.requestCBHash_[a]=o)}get(t){this.initConnection_();const r=new sl,a={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:h=>{const p=h.d;h.s==="ok"?r.resolve(p):r.reject(p)}};this.outstandingGets_.push(a),this.outstandingGetCount_++;const d=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(d),r.promise}listen(t,r,o,a){this.initConnection_();const d=t._queryIdentifier,h=t._path.toString();this.log_("Listen called for "+h+" "+d),this.listens.has(h)||this.listens.set(h,new Map),K(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),K(!this.listens.get(h).has(d),"listen() called twice for same path/queryId.");const p={onComplete:a,hashFn:r,query:t,tag:o};this.listens.get(h).set(d,p),this.connected_&&this.sendListen_(p)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,o=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(o)})}sendListen_(t){const r=t.query,o=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+o+" for "+a);const d={p:o},h="q";t.tag&&(d.q=r._queryObject,d.t=t.tag),d.h=t.hashFn(),this.sendRequest(h,d,p=>{const g=p.d,x=p.s;In.warnOnListenWarnings_(g,r),(this.listens.get(o)&&this.listens.get(o).get(a))===t&&(this.log_("listen response",p),x!=="ok"&&this.removeListen_(o,a),t.onComplete&&t.onComplete(x,g))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&Ln(t,"w")){const o=os(t,"w");if(Array.isArray(o)&&~o.indexOf("no_index")){const a='".indexOn": "'+r._queryParams.getIndex().toString()+'"',d=r._path.toString();Bt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${d} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||Fx(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Qh)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=Ax(t)?"auth":"gauth",o={cred:t};this.authOverride_===null?o.noauth=!0:typeof this.authOverride_=="object"&&(o.authvar=this.authOverride_),this.sendRequest(r,o,a=>{const d=a.s,h=a.d||"error";this.authToken_===t&&(d==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(d,h))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,o=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,o)})}unlisten(t,r){const o=t._path.toString(),a=t._queryIdentifier;this.log_("Unlisten called for "+o+" "+a),K(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(o,a)&&this.connected_&&this.sendUnlisten_(o,a,t._queryObject,r)}sendUnlisten_(t,r,o,a){this.log_("Unlisten on "+t+" for "+r);const d={p:t},h="n";a&&(d.q=o,d.t=a),this.sendRequest(h,d)}onDisconnectPut(t,r,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,o):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:o})}onDisconnectMerge(t,r,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,o):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:o})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,o,a){const d={p:r,d:o};this.log_("onDisconnect "+t,d),this.sendRequest(t,d,h=>{a&&setTimeout(()=>{a(h.s,h.d)},Math.floor(0))})}put(t,r,o,a){this.putInternal("p",t,r,o,a)}merge(t,r,o,a){this.putInternal("m",t,r,o,a)}putInternal(t,r,o,a,d){this.initConnection_();const h={p:r,d:o};d!==void 0&&(h.h=d),this.outstandingPuts_.push({action:t,request:h,onComplete:a}),this.outstandingPutCount_++;const p=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(p):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,o=this.outstandingPuts_[t].request,a=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,o,d=>{this.log_(r+" response",d),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),a&&a(d.s,d.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,o=>{if(o.s!=="ok"){const d=o.d;this.log_("reportStats","Error sending stats: "+d)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+_t(t));const r=t.r,o=this.requestCBHash_[r];o&&(delete this.requestCBHash_[r],o(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):Cc("Unrecognized action received from server: "+_t(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){K(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Zs,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Zs,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Ky&&(this.reconnectDelay_=Zs),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*qy)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),o=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+In.nextConnectionId_++,d=this.lastSessionId;let h=!1,p=null;const g=function(){p?p.close():(h=!0,o())},x=function(y){K(p,"sendRequest call when we're not connected not allowed."),p.sendRequest(y)};this.realtime_={close:g,sendRequest:x};const k=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[y,v]=await Promise.all([this.authTokenProvider_.getToken(k),this.appCheckTokenProvider_.getToken(k)]);h?Tt("getToken() completed but was canceled"):(Tt("getToken() completed. Creating connection."),this.authToken_=y&&y.accessToken,this.appCheckToken_=v&&v.token,p=new Hy(a,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,o,S=>{Bt(S+" ("+this.repoInfo_.toString()+")"),this.interrupt(Jy)},d))}catch(y){this.log_("Failed to get token: "+y),h||(this.repoInfo_.nodeAdmin&&Bt(y),g())}}}interrupt(t){Tt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Tt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Nh(this.interruptReasons_)&&(this.reconnectDelay_=Zs,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let o;r?o=r.map(d=>Wc(d)).join("$"):o="default";const a=this.removeListen_(t,o);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(t,r){const o=new Ge(t).toString();let a;if(this.listens.has(o)){const d=this.listens.get(o);a=d.get(r),d.delete(r),d.size===0&&this.listens.delete(o)}else a=void 0;return a}onAuthRevoked_(t,r){Tt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Gh&&(this.reconnectDelay_=Qh,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Tt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Gh&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";t["sdk."+r+"."+Dp.replace(/\./g,"-")]=1,Sp()?t["framework.cordova"]=1:Tx()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Yo.getInstance().currentlyOnline();return Nh(this.interruptReasons_)&&t}}In.nextPersistentConnectionId_=0;In.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(t,r){this.name=t,this.node=r}static Wrap(t,r){return new Pe(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,r){const o=new Pe(ls,t),a=new Pe(ls,r);return this.compare(o,a)!==0}minPost(){return Pe.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oo;class cm extends ol{static get __EMPTY_NODE(){return Oo}static set __EMPTY_NODE(t){Oo=t}compare(t,r){return ds(t.name,r.name)}isDefinedOn(t){throw us("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,r){return!1}minPost(){return Pe.MIN}maxPost(){return new Pe(Cr,Oo)}makePost(t,r){return K(typeof t=="string","KeyIndex indexValue must always be a string."),new Pe(t,Oo)}toString(){return".key"}}const ss=new cm;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(t,r,o,a,d=null){this.isReverse_=a,this.resultGenerator_=d,this.nodeStack_=[];let h=1;for(;!t.isEmpty();)if(t=t,h=r?o(t.key,r):1,a&&(h*=-1),h<0)this.isReverse_?t=t.left:t=t.right;else if(h===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),r;if(this.resultGenerator_?r=this.resultGenerator_(t.key,t.value):r={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return r}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class yt{constructor(t,r,o,a,d){this.key=t,this.value=r,this.color=o??yt.RED,this.left=a??Ut.EMPTY_NODE,this.right=d??Ut.EMPTY_NODE}copy(t,r,o,a,d){return new yt(t??this.key,r??this.value,o??this.color,a??this.left,d??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,o){let a=this;const d=o(t,a.key);return d<0?a=a.copy(null,null,null,a.left.insert(t,r,o),null):d===0?a=a.copy(null,r,null,null,null):a=a.copy(null,null,null,null,a.right.insert(t,r,o)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ut.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let o,a;if(o=this,r(t,o.key)<0)!o.left.isEmpty()&&!o.left.isRed_()&&!o.left.left.isRed_()&&(o=o.moveRedLeft_()),o=o.copy(null,null,null,o.left.remove(t,r),null);else{if(o.left.isRed_()&&(o=o.rotateRight_()),!o.right.isEmpty()&&!o.right.isRed_()&&!o.right.left.isRed_()&&(o=o.moveRedRight_()),r(t,o.key)===0){if(o.right.isEmpty())return Ut.EMPTY_NODE;a=o.right.min_(),o=o.copy(a.key,a.value,null,null,o.right.removeMin_())}o=o.copy(null,null,null,null,o.right.remove(t,r))}return o.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,yt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,yt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}yt.RED=!0;yt.BLACK=!1;class Zy{copy(t,r,o,a,d){return this}insert(t,r,o){return new yt(t,r,null)}remove(t,r){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Ut{constructor(t,r=Ut.EMPTY_NODE){this.comparator_=t,this.root_=r}insert(t,r){return new Ut(this.comparator_,this.root_.insert(t,r,this.comparator_).copy(null,null,yt.BLACK,null,null))}remove(t){return new Ut(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,yt.BLACK,null,null))}get(t){let r,o=this.root_;for(;!o.isEmpty();){if(r=this.comparator_(t,o.key),r===0)return o.value;r<0?o=o.left:r>0&&(o=o.right)}return null}getPredecessorKey(t){let r,o=this.root_,a=null;for(;!o.isEmpty();)if(r=this.comparator_(t,o.key),r===0){if(o.left.isEmpty())return a?a.key:null;for(o=o.left;!o.right.isEmpty();)o=o.right;return o.key}else r<0?o=o.left:r>0&&(a=o,o=o.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new Ao(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,r){return new Ao(this.root_,t,this.comparator_,!1,r)}getReverseIteratorFrom(t,r){return new Ao(this.root_,t,this.comparator_,!0,r)}getReverseIterator(t){return new Ao(this.root_,null,this.comparator_,!0,t)}}Ut.EMPTY_NODE=new Zy;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e_(s,t){return ds(s.name,t.name)}function Xc(s,t){return ds(s,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ec;function t_(s){Ec=s}const um=function(s){return typeof s=="number"?"number:"+$p(s):"string:"+s},dm=function(s){if(s.isLeafNode()){const t=s.val();K(typeof t=="string"||typeof t=="number"||typeof t=="object"&&Ln(t,".sv"),"Priority must be a string or number.")}else K(s===Ec||s.isEmpty(),"priority of unexpected type.");K(s===Ec||s.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xh;class vt{static set __childrenNodeConstructor(t){Xh=t}static get __childrenNodeConstructor(){return Xh}constructor(t,r=vt.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,K(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),dm(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new vt(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:vt.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Me(t)?this:Re(t)===".priority"?this.priorityNode_:vt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:vt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const o=Re(t);return o===null?r:r.isEmpty()&&o!==".priority"?this:(K(o!==".priority"||nr(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(o,vt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ke(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+um(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",r==="number"?t+=$p(this.value_):t+=this.value_,this.lazyHash_=Ap(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===vt.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof vt.__childrenNodeConstructor?-1:(K(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,o=typeof this.value_,a=vt.VALUE_TYPE_ORDER.indexOf(r),d=vt.VALUE_TYPE_ORDER.indexOf(o);return K(a>=0,"Unknown leaf type: "+r),K(d>=0,"Unknown leaf type: "+o),a===d?o==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:d-a}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}vt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fm,hm;function n_(s){fm=s}function r_(s){hm=s}class s_ extends ol{compare(t,r){const o=t.node.getPriority(),a=r.node.getPriority(),d=o.compareTo(a);return d===0?ds(t.name,r.name):d}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,r){return!t.getPriority().equals(r.getPriority())}minPost(){return Pe.MIN}maxPost(){return new Pe(Cr,new vt("[PRIORITY-POST]",hm))}makePost(t,r){const o=fm(t);return new Pe(r,new vt("[PRIORITY-POST]",o))}toString(){return".priority"}}const ot=new s_;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i_=Math.log(2);class o_{constructor(t){const r=d=>parseInt(Math.log(d)/i_,10),o=d=>parseInt(Array(d+1).join("1"),2);this.count=r(t+1),this.current_=this.count-1;const a=o(this.count);this.bits_=t+1&a}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const Qo=function(s,t,r,o){s.sort(t);const a=function(g,x){const k=x-g;let y,v;if(k===0)return null;if(k===1)return y=s[g],v=r?r(y):y,new yt(v,y.node,yt.BLACK,null,null);{const S=parseInt(k/2,10)+g,O=a(g,S),H=a(S+1,x);return y=s[S],v=r?r(y):y,new yt(v,y.node,yt.BLACK,O,H)}},d=function(g){let x=null,k=null,y=s.length;const v=function(O,H){const Z=y-O,le=y;y-=O;const se=a(Z+1,le),we=s[Z],ue=r?r(we):we;S(new yt(ue,we.node,H,null,se))},S=function(O){x?(x.left=O,x=O):(k=O,x=O)};for(let O=0;O<g.count;++O){const H=g.nextBitIsOne(),Z=Math.pow(2,g.count-(O+1));H?v(Z,yt.BLACK):(v(Z,yt.BLACK),v(Z,yt.RED))}return k},h=new o_(s.length),p=d(h);return new Ut(o||t,p)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mc;const es={};class jn{static get Default(){return K(es&&ot,"ChildrenNode.ts has not been loaded"),mc=mc||new jn({".priority":es},{".priority":ot}),mc}constructor(t,r){this.indexes_=t,this.indexSet_=r}get(t){const r=os(this.indexes_,t);if(!r)throw new Error("No index defined for "+t);return r instanceof Ut?r:null}hasIndex(t){return Ln(this.indexSet_,t.toString())}addIndex(t,r){K(t!==ss,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const o=[];let a=!1;const d=r.getIterator(Pe.Wrap);let h=d.getNext();for(;h;)a=a||t.isDefinedOn(h.node),o.push(h),h=d.getNext();let p;a?p=Qo(o,t.getCompare()):p=es;const g=t.toString(),x={...this.indexSet_};x[g]=t;const k={...this.indexes_};return k[g]=p,new jn(k,x)}addToIndexes(t,r){const o=Uo(this.indexes_,(a,d)=>{const h=os(this.indexSet_,d);if(K(h,"Missing index implementation for "+d),a===es)if(h.isDefinedOn(t.node)){const p=[],g=r.getIterator(Pe.Wrap);let x=g.getNext();for(;x;)x.name!==t.name&&p.push(x),x=g.getNext();return p.push(t),Qo(p,h.getCompare())}else return es;else{const p=r.get(t.name);let g=a;return p&&(g=g.remove(new Pe(t.name,p))),g.insert(t,t.node)}});return new jn(o,this.indexSet_)}removeFromIndexes(t,r){const o=Uo(this.indexes_,a=>{if(a===es)return a;{const d=r.get(t.name);return d?a.remove(new Pe(t.name,d)):a}});return new jn(o,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ei;class Ne{static get EMPTY_NODE(){return ei||(ei=new Ne(new Ut(Xc),null,jn.Default))}constructor(t,r,o){this.children_=t,this.priorityNode_=r,this.indexMap_=o,this.lazyHash_=null,this.priorityNode_&&dm(this.priorityNode_),this.children_.isEmpty()&&K(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ei}updatePriority(t){return this.children_.isEmpty()?this:new Ne(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{const r=this.children_.get(t);return r===null?ei:r}}getChild(t){const r=Re(t);return r===null?this:this.getImmediateChild(r).getChild(Ke(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(K(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{const o=new Pe(t,r);let a,d;r.isEmpty()?(a=this.children_.remove(t),d=this.indexMap_.removeFromIndexes(o,this.children_)):(a=this.children_.insert(t,r),d=this.indexMap_.addToIndexes(o,this.children_));const h=a.isEmpty()?ei:this.priorityNode_;return new Ne(a,h,d)}}updateChild(t,r){const o=Re(t);if(o===null)return r;{K(Re(t)!==".priority"||nr(t)===1,".priority must be the last token in a path");const a=this.getImmediateChild(o).updateChild(Ke(t),r);return this.updateImmediateChild(o,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let o=0,a=0,d=!0;if(this.forEachChild(ot,(h,p)=>{r[h]=p.val(t),o++,d&&Ne.INTEGER_REGEXP_.test(h)?a=Math.max(a,Number(h)):d=!1}),!t&&d&&a<2*o){const h=[];for(const p in r)h[p]=r[p];return h}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+um(this.getPriority().val())+":"),this.forEachChild(ot,(r,o)=>{const a=o.hash();a!==""&&(t+=":"+r+":"+a)}),this.lazyHash_=t===""?"":Ap(t)}return this.lazyHash_}getPredecessorChildName(t,r,o){const a=this.resolveIndex_(o);if(a){const d=a.getPredecessorKey(new Pe(t,r));return d?d.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const o=r.minKey();return o&&o.name}else return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new Pe(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const o=r.maxKey();return o&&o.name}else return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new Pe(r,this.children_.get(r)):null}forEachChild(t,r){const o=this.resolveIndex_(t);return o?o.inorderTraversal(a=>r(a.name,a.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const o=this.resolveIndex_(r);if(o)return o.getIteratorFrom(t,a=>a);{const a=this.children_.getIteratorFrom(t.name,Pe.Wrap);let d=a.peek();for(;d!=null&&r.compare(d,t)<0;)a.getNext(),d=a.peek();return a}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const o=this.resolveIndex_(r);if(o)return o.getReverseIteratorFrom(t,a=>a);{const a=this.children_.getReverseIteratorFrom(t.name,Pe.Wrap);let d=a.peek();for(;d!=null&&r.compare(d,t)>0;)a.getNext(),d=a.peek();return a}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===bi?-1:0}withIndex(t){if(t===ss||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new Ne(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===ss||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){const o=this.getIterator(ot),a=r.getIterator(ot);let d=o.getNext(),h=a.getNext();for(;d&&h;){if(d.name!==h.name||!d.node.equals(h.node))return!1;d=o.getNext(),h=a.getNext()}return d===null&&h===null}else return!1;else return!1}}resolveIndex_(t){return t===ss?null:this.indexMap_.get(t.toString())}}Ne.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class l_ extends Ne{constructor(){super(new Ut(Xc),Ne.EMPTY_NODE,jn.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return Ne.EMPTY_NODE}isEmpty(){return!1}}const bi=new l_;Object.defineProperties(Pe,{MIN:{value:new Pe(ls,Ne.EMPTY_NODE)},MAX:{value:new Pe(Cr,bi)}});cm.__EMPTY_NODE=Ne.EMPTY_NODE;vt.__childrenNodeConstructor=Ne;t_(bi);r_(bi);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a_=!0;function kt(s,t=null){if(s===null)return Ne.EMPTY_NODE;if(typeof s=="object"&&".priority"in s&&(t=s[".priority"]),K(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof s=="object"&&".value"in s&&s[".value"]!==null&&(s=s[".value"]),typeof s!="object"||".sv"in s){const r=s;return new vt(r,kt(t))}if(!(s instanceof Array)&&a_){const r=[];let o=!1;if(Wt(s,(h,p)=>{if(h.substring(0,1)!=="."){const g=kt(p);g.isEmpty()||(o=o||!g.getPriority().isEmpty(),r.push(new Pe(h,g)))}}),r.length===0)return Ne.EMPTY_NODE;const d=Qo(r,e_,h=>h.name,Xc);if(o){const h=Qo(r,ot.getCompare());return new Ne(d,kt(t),new jn({".priority":h},{".priority":ot}))}else return new Ne(d,kt(t),jn.Default)}else{let r=Ne.EMPTY_NODE;return Wt(s,(o,a)=>{if(Ln(s,o)&&o.substring(0,1)!=="."){const d=kt(a);(d.isLeafNode()||!d.isEmpty())&&(r=r.updateImmediateChild(o,d))}}),r.updatePriority(kt(t))}}n_(kt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_ extends ol{constructor(t){super(),this.indexPath_=t,K(!Me(t)&&Re(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,r){const o=this.extractChild(t.node),a=this.extractChild(r.node),d=o.compareTo(a);return d===0?ds(t.name,r.name):d}makePost(t,r){const o=kt(t),a=Ne.EMPTY_NODE.updateChild(this.indexPath_,o);return new Pe(r,a)}maxPost(){const t=Ne.EMPTY_NODE.updateChild(this.indexPath_,bi);return new Pe(Cr,t)}toString(){return om(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_ extends ol{compare(t,r){const o=t.node.compareTo(r.node);return o===0?ds(t.name,r.name):o}isDefinedOn(t){return!0}indexedValueChanged(t,r){return!t.equals(r)}minPost(){return Pe.MIN}maxPost(){return Pe.MAX}makePost(t,r){const o=kt(t);return new Pe(r,o)}toString(){return".value"}}const d_=new u_;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pm(s){return{type:"value",snapshotNode:s}}function as(s,t){return{type:"child_added",snapshotNode:t,childName:s}}function hi(s,t){return{type:"child_removed",snapshotNode:t,childName:s}}function pi(s,t,r){return{type:"child_changed",snapshotNode:t,childName:s,oldSnap:r}}function f_(s,t){return{type:"child_moved",snapshotNode:t,childName:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(t){this.index_=t}updateChild(t,r,o,a,d,h){K(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const p=t.getImmediateChild(r);return p.getChild(a).equals(o.getChild(a))&&p.isEmpty()===o.isEmpty()||(h!=null&&(o.isEmpty()?t.hasChild(r)?h.trackChildChange(hi(r,p)):K(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):p.isEmpty()?h.trackChildChange(as(r,o)):h.trackChildChange(pi(r,o,p))),t.isLeafNode()&&o.isEmpty())?t:t.updateImmediateChild(r,o).withIndex(this.index_)}updateFullNode(t,r,o){return o!=null&&(t.isLeafNode()||t.forEachChild(ot,(a,d)=>{r.hasChild(a)||o.trackChildChange(hi(a,d))}),r.isLeafNode()||r.forEachChild(ot,(a,d)=>{if(t.hasChild(a)){const h=t.getImmediateChild(a);h.equals(d)||o.trackChildChange(pi(a,d,h))}else o.trackChildChange(as(a,d))})),r.withIndex(this.index_)}updatePriority(t,r){return t.isEmpty()?Ne.EMPTY_NODE:t.updatePriority(r)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(t){this.indexedFilter_=new qc(t.getIndex()),this.index_=t.getIndex(),this.startPost_=mi.getStartPost_(t),this.endPost_=mi.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const r=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,o=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return r&&o}updateChild(t,r,o,a,d,h){return this.matches(new Pe(r,o))||(o=Ne.EMPTY_NODE),this.indexedFilter_.updateChild(t,r,o,a,d,h)}updateFullNode(t,r,o){r.isLeafNode()&&(r=Ne.EMPTY_NODE);let a=r.withIndex(this.index_);a=a.updatePriority(Ne.EMPTY_NODE);const d=this;return r.forEachChild(ot,(h,p)=>{d.matches(new Pe(h,p))||(a=a.updateImmediateChild(h,Ne.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,a,o)}updatePriority(t,r){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const r=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),r)}else return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const r=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),r)}else return t.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(t){this.withinDirectionalStart=r=>this.reverse_?this.withinEndPost(r):this.withinStartPost(r),this.withinDirectionalEnd=r=>this.reverse_?this.withinStartPost(r):this.withinEndPost(r),this.withinStartPost=r=>{const o=this.index_.compare(this.rangedFilter_.getStartPost(),r);return this.startIsInclusive_?o<=0:o<0},this.withinEndPost=r=>{const o=this.index_.compare(r,this.rangedFilter_.getEndPost());return this.endIsInclusive_?o<=0:o<0},this.rangedFilter_=new mi(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,r,o,a,d,h){return this.rangedFilter_.matches(new Pe(r,o))||(o=Ne.EMPTY_NODE),t.getImmediateChild(r).equals(o)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,r,o,a,d,h):this.fullLimitUpdateChild_(t,r,o,d,h)}updateFullNode(t,r,o){let a;if(r.isLeafNode()||r.isEmpty())a=Ne.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<r.numChildren()&&r.isIndexed(this.index_)){a=Ne.EMPTY_NODE.withIndex(this.index_);let d;this.reverse_?d=r.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):d=r.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let h=0;for(;d.hasNext()&&h<this.limit_;){const p=d.getNext();if(this.withinDirectionalStart(p))if(this.withinDirectionalEnd(p))a=a.updateImmediateChild(p.name,p.node),h++;else break;else continue}}else{a=r.withIndex(this.index_),a=a.updatePriority(Ne.EMPTY_NODE);let d;this.reverse_?d=a.getReverseIterator(this.index_):d=a.getIterator(this.index_);let h=0;for(;d.hasNext();){const p=d.getNext();h<this.limit_&&this.withinDirectionalStart(p)&&this.withinDirectionalEnd(p)?h++:a=a.updateImmediateChild(p.name,Ne.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,a,o)}updatePriority(t,r){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,r,o,a,d){let h;if(this.reverse_){const y=this.index_.getCompare();h=(v,S)=>y(S,v)}else h=this.index_.getCompare();const p=t;K(p.numChildren()===this.limit_,"");const g=new Pe(r,o),x=this.reverse_?p.getFirstChild(this.index_):p.getLastChild(this.index_),k=this.rangedFilter_.matches(g);if(p.hasChild(r)){const y=p.getImmediateChild(r);let v=a.getChildAfterChild(this.index_,x,this.reverse_);for(;v!=null&&(v.name===r||p.hasChild(v.name));)v=a.getChildAfterChild(this.index_,v,this.reverse_);const S=v==null?1:h(v,g);if(k&&!o.isEmpty()&&S>=0)return d!=null&&d.trackChildChange(pi(r,o,y)),p.updateImmediateChild(r,o);{d!=null&&d.trackChildChange(hi(r,y));const H=p.updateImmediateChild(r,Ne.EMPTY_NODE);return v!=null&&this.rangedFilter_.matches(v)?(d!=null&&d.trackChildChange(as(v.name,v.node)),H.updateImmediateChild(v.name,v.node)):H}}else return o.isEmpty()?t:k&&h(x,g)>=0?(d!=null&&(d.trackChildChange(hi(x.name,x.node)),d.trackChildChange(as(r,o))),p.updateImmediateChild(r,o).updateImmediateChild(x.name,Ne.EMPTY_NODE)):t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ot}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return K(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return K(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ls}hasEnd(){return this.endSet_}getIndexEndValue(){return K(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return K(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Cr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return K(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ot}copy(){const t=new Kc;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function p_(s){return s.loadsAllData()?new qc(s.getIndex()):s.hasLimit()?new h_(s):new mi(s)}function qh(s){const t={};if(s.isDefault())return t;let r;if(s.index_===ot?r="$priority":s.index_===d_?r="$value":s.index_===ss?r="$key":(K(s.index_ instanceof c_,"Unrecognized index type!"),r=s.index_.toString()),t.orderBy=_t(r),s.startSet_){const o=s.startAfterSet_?"startAfter":"startAt";t[o]=_t(s.indexStartValue_),s.startNameSet_&&(t[o]+=","+_t(s.indexStartName_))}if(s.endSet_){const o=s.endBeforeSet_?"endBefore":"endAt";t[o]=_t(s.indexEndValue_),s.endNameSet_&&(t[o]+=","+_t(s.indexEndName_))}return s.limitSet_&&(s.isViewFromLeft()?t.limitToFirst=s.limit_:t.limitToLast=s.limit_),t}function Kh(s){const t={};if(s.startSet_&&(t.sp=s.indexStartValue_,s.startNameSet_&&(t.sn=s.indexStartName_),t.sin=!s.startAfterSet_),s.endSet_&&(t.ep=s.indexEndValue_,s.endNameSet_&&(t.en=s.indexEndName_),t.ein=!s.endBeforeSet_),s.limitSet_){t.l=s.limit_;let r=s.viewFrom_;r===""&&(s.isViewFromLeft()?r="l":r="r"),t.vf=r}return s.index_!==ot&&(t.i=s.index_.toString()),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go extends rm{reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,r){return r!==void 0?"tag$"+r:(K(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}constructor(t,r,o,a){super(),this.repoInfo_=t,this.onDataUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.log_=wi("p:rest:"),this.listens_={}}listen(t,r,o,a){const d=t._path.toString();this.log_("Listen called for "+d+" "+t._queryIdentifier);const h=Go.getListenId_(t,o),p={};this.listens_[h]=p;const g=qh(t._queryParams);this.restRequest_(d+".json",g,(x,k)=>{let y=k;if(x===404&&(y=null,x=null),x===null&&this.onDataUpdate_(d,y,!1,o),os(this.listens_,h)===p){let v;x?x===401?v="permission_denied":v="rest_error:"+x:v="ok",a(v,null)}})}unlisten(t,r){const o=Go.getListenId_(t,r);delete this.listens_[o]}get(t){const r=qh(t._queryParams),o=t._path.toString(),a=new sl;return this.restRequest_(o+".json",r,(d,h)=>{let p=h;d===404&&(p=null,d=null),d===null?(this.onDataUpdate_(o,p,!1,null),a.resolve(p)):a.reject(new Error(p))}),a.promise}refreshAuthToken(t){}restRequest_(t,r={},o){return r.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([a,d])=>{a&&a.accessToken&&(r.auth=a.accessToken),d&&d.token&&(r.ac=d.token);const h=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+zx(r);this.log_("Sending REST request for "+h);const p=new XMLHttpRequest;p.onreadystatechange=()=>{if(o&&p.readyState===4){this.log_("REST Response for "+h+" received. status:",p.status,"response:",p.responseText);let g=null;if(p.status>=200&&p.status<300){try{g=ci(p.responseText)}catch{Bt("Failed to parse JSON response for "+h+": "+p.responseText)}o(null,g)}else p.status!==401&&p.status!==404&&Bt("Got unsuccessful REST response for "+h+" Status: "+p.status),o(p.status);o=null}},p.open("GET",h,!0),p.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(){this.rootNode_=Ne.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,r){this.rootNode_=this.rootNode_.updateChild(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xo(){return{value:null,children:new Map}}function mm(s,t,r){if(Me(t))s.value=r,s.children.clear();else if(s.value!==null)s.value=s.value.updateChild(t,r);else{const o=Re(t);s.children.has(o)||s.children.set(o,Xo());const a=s.children.get(o);t=Ke(t),mm(a,t,r)}}function jc(s,t,r){s.value!==null?r(t,s.value):g_(s,(o,a)=>{const d=new Ge(t.toString()+"/"+o);jc(a,d,r)})}function g_(s,t){s.children.forEach((r,o)=>{t(o,r)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),r={...t};return this.last_&&Wt(this.last_,(o,a)=>{r[o]=r[o]-a}),this.last_=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jh=10*1e3,v_=30*1e3,y_=300*1e3;class __{constructor(t,r){this.server_=r,this.statsToReport_={},this.statsListener_=new x_(t);const o=Jh+(v_-Jh)*Math.random();ii(this.reportStats_.bind(this),Math.floor(o))}reportStats_(){const t=this.statsListener_.get(),r={};let o=!1;Wt(t,(a,d)=>{d>0&&Ln(this.statsToReport_,a)&&(r[a]=d,o=!0)}),o&&this.server_.reportStats(r),ii(this.reportStats_.bind(this),Math.floor(Math.random()*2*y_))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dn;(function(s){s[s.OVERWRITE=0]="OVERWRITE",s[s.MERGE=1]="MERGE",s[s.ACK_USER_WRITE=2]="ACK_USER_WRITE",s[s.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(dn||(dn={}));function gm(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Jc(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Zc(s){return{fromUser:!1,fromServer:!0,queryId:s,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(t,r,o){this.path=t,this.affectedTree=r,this.revert=o,this.type=dn.ACK_USER_WRITE,this.source=gm()}operationForChild(t){if(Me(this.path)){if(this.affectedTree.value!=null)return K(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const r=this.affectedTree.subtree(new Ge(t));return new qo(Be(),r,this.revert)}}else return K(Re(this.path)===t,"operationForChild called for unrelated child."),new qo(Ke(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(t,r){this.source=t,this.path=r,this.type=dn.LISTEN_COMPLETE}operationForChild(t){return Me(this.path)?new gi(this.source,Be()):new gi(this.source,Ke(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(t,r,o){this.source=t,this.path=r,this.snap=o,this.type=dn.OVERWRITE}operationForChild(t){return Me(this.path)?new Sr(this.source,Be(),this.snap.getImmediateChild(t)):new Sr(this.source,Ke(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(t,r,o){this.source=t,this.path=r,this.children=o,this.type=dn.MERGE}operationForChild(t){if(Me(this.path)){const r=this.children.subtree(new Ge(t));return r.isEmpty()?null:r.value?new Sr(this.source,Be(),r.value):new xi(this.source,Be(),r)}else return K(Re(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new xi(this.source,Ke(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(t,r,o){this.node_=t,this.fullyInitialized_=r,this.filtered_=o}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(Me(t))return this.isFullyInitialized()&&!this.filtered_;const r=Re(t);return this.isCompleteForChild(r)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function b_(s,t,r,o){const a=[],d=[];return t.forEach(h=>{h.type==="child_changed"&&s.index_.indexedValueChanged(h.oldSnap,h.snapshotNode)&&d.push(f_(h.childName,h.snapshotNode))}),ti(s,a,"child_removed",t,o,r),ti(s,a,"child_added",t,o,r),ti(s,a,"child_moved",d,o,r),ti(s,a,"child_changed",t,o,r),ti(s,a,"value",t,o,r),a}function ti(s,t,r,o,a,d){const h=o.filter(p=>p.type===r);h.sort((p,g)=>k_(s,p,g)),h.forEach(p=>{const g=N_(s,p,d);a.forEach(x=>{x.respondsTo(p.type)&&t.push(x.createEvent(g,s.query_))})})}function N_(s,t,r){return t.type==="value"||t.type==="child_removed"||(t.prevName=r.getPredecessorChildName(t.childName,t.snapshotNode,s.index_)),t}function k_(s,t,r){if(t.childName==null||r.childName==null)throw us("Should only compare child_ events.");const o=new Pe(t.childName,t.snapshotNode),a=new Pe(r.childName,r.snapshotNode);return s.index_.compare(o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ll(s,t){return{eventCache:s,serverCache:t}}function oi(s,t,r,o){return ll(new Er(t,r,o),s.serverCache)}function xm(s,t,r,o){return ll(s.eventCache,new Er(t,r,o))}function Ic(s){return s.eventCache.isFullyInitialized()?s.eventCache.getNode():null}function jr(s){return s.serverCache.isFullyInitialized()?s.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gc;const C_=()=>(gc||(gc=new Ut(uy)),gc);class et{static fromObject(t){let r=new et(null);return Wt(t,(o,a)=>{r=r.set(new Ge(o),a)}),r}constructor(t,r=C_()){this.value=t,this.children=r}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,r){if(this.value!=null&&r(this.value))return{path:Be(),value:this.value};if(Me(t))return null;{const o=Re(t),a=this.children.get(o);if(a!==null){const d=a.findRootMostMatchingPathAndValue(Ke(t),r);return d!=null?{path:pt(new Ge(o),d.path),value:d.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(Me(t))return this;{const r=Re(t),o=this.children.get(r);return o!==null?o.subtree(Ke(t)):new et(null)}}set(t,r){if(Me(t))return new et(r,this.children);{const o=Re(t),d=(this.children.get(o)||new et(null)).set(Ke(t),r),h=this.children.insert(o,d);return new et(this.value,h)}}remove(t){if(Me(t))return this.children.isEmpty()?new et(null):new et(null,this.children);{const r=Re(t),o=this.children.get(r);if(o){const a=o.remove(Ke(t));let d;return a.isEmpty()?d=this.children.remove(r):d=this.children.insert(r,a),this.value===null&&d.isEmpty()?new et(null):new et(this.value,d)}else return this}}get(t){if(Me(t))return this.value;{const r=Re(t),o=this.children.get(r);return o?o.get(Ke(t)):null}}setTree(t,r){if(Me(t))return r;{const o=Re(t),d=(this.children.get(o)||new et(null)).setTree(Ke(t),r);let h;return d.isEmpty()?h=this.children.remove(o):h=this.children.insert(o,d),new et(this.value,h)}}fold(t){return this.fold_(Be(),t)}fold_(t,r){const o={};return this.children.inorderTraversal((a,d)=>{o[a]=d.fold_(pt(t,a),r)}),r(t,this.value,o)}findOnPath(t,r){return this.findOnPath_(t,Be(),r)}findOnPath_(t,r,o){const a=this.value?o(r,this.value):!1;if(a)return a;if(Me(t))return null;{const d=Re(t),h=this.children.get(d);return h?h.findOnPath_(Ke(t),pt(r,d),o):null}}foreachOnPath(t,r){return this.foreachOnPath_(t,Be(),r)}foreachOnPath_(t,r,o){if(Me(t))return this;{this.value&&o(r,this.value);const a=Re(t),d=this.children.get(a);return d?d.foreachOnPath_(Ke(t),pt(r,a),o):new et(null)}}foreach(t){this.foreach_(Be(),t)}foreach_(t,r){this.children.inorderTraversal((o,a)=>{a.foreach_(pt(t,o),r)}),this.value&&r(t,this.value)}foreachChild(t){this.children.inorderTraversal((r,o)=>{o.value&&t(r,o.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(t){this.writeTree_=t}static empty(){return new fn(new et(null))}}function li(s,t,r){if(Me(t))return new fn(new et(r));{const o=s.writeTree_.findRootMostValueAndPath(t);if(o!=null){const a=o.path;let d=o.value;const h=$t(a,t);return d=d.updateChild(h,r),new fn(s.writeTree_.set(a,d))}else{const a=new et(r),d=s.writeTree_.setTree(t,a);return new fn(d)}}}function Zh(s,t,r){let o=s;return Wt(r,(a,d)=>{o=li(o,pt(t,a),d)}),o}function ep(s,t){if(Me(t))return fn.empty();{const r=s.writeTree_.setTree(t,new et(null));return new fn(r)}}function Tc(s,t){return Ir(s,t)!=null}function Ir(s,t){const r=s.writeTree_.findRootMostValueAndPath(t);return r!=null?s.writeTree_.get(r.path).getChild($t(r.path,t)):null}function tp(s){const t=[],r=s.writeTree_.value;return r!=null?r.isLeafNode()||r.forEachChild(ot,(o,a)=>{t.push(new Pe(o,a))}):s.writeTree_.children.inorderTraversal((o,a)=>{a.value!=null&&t.push(new Pe(o,a.value))}),t}function tr(s,t){if(Me(t))return s;{const r=Ir(s,t);return r!=null?new fn(new et(r)):new fn(s.writeTree_.subtree(t))}}function Rc(s){return s.writeTree_.isEmpty()}function cs(s,t){return vm(Be(),s.writeTree_,t)}function vm(s,t,r){if(t.value!=null)return r.updateChild(s,t.value);{let o=null;return t.children.inorderTraversal((a,d)=>{a===".priority"?(K(d.value!==null,"Priority writes must always be leaf nodes"),o=d.value):r=vm(pt(s,a),d,r)}),!r.getChild(s).isEmpty()&&o!==null&&(r=r.updateChild(pt(s,".priority"),o)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eu(s,t){return bm(t,s)}function S_(s,t,r,o,a){K(o>s.lastWriteId,"Stacking an older write on top of newer ones"),a===void 0&&(a=!0),s.allWrites.push({path:t,snap:r,writeId:o,visible:a}),a&&(s.visibleWrites=li(s.visibleWrites,t,r)),s.lastWriteId=o}function E_(s,t){for(let r=0;r<s.allWrites.length;r++){const o=s.allWrites[r];if(o.writeId===t)return o}return null}function j_(s,t){const r=s.allWrites.findIndex(p=>p.writeId===t);K(r>=0,"removeWrite called with nonexistent writeId.");const o=s.allWrites[r];s.allWrites.splice(r,1);let a=o.visible,d=!1,h=s.allWrites.length-1;for(;a&&h>=0;){const p=s.allWrites[h];p.visible&&(h>=r&&I_(p,o.path)?a=!1:un(o.path,p.path)&&(d=!0)),h--}if(a){if(d)return T_(s),!0;if(o.snap)s.visibleWrites=ep(s.visibleWrites,o.path);else{const p=o.children;Wt(p,g=>{s.visibleWrites=ep(s.visibleWrites,pt(o.path,g))})}return!0}else return!1}function I_(s,t){if(s.snap)return un(s.path,t);for(const r in s.children)if(s.children.hasOwnProperty(r)&&un(pt(s.path,r),t))return!0;return!1}function T_(s){s.visibleWrites=ym(s.allWrites,R_,Be()),s.allWrites.length>0?s.lastWriteId=s.allWrites[s.allWrites.length-1].writeId:s.lastWriteId=-1}function R_(s){return s.visible}function ym(s,t,r){let o=fn.empty();for(let a=0;a<s.length;++a){const d=s[a];if(t(d)){const h=d.path;let p;if(d.snap)un(r,h)?(p=$t(r,h),o=li(o,p,d.snap)):un(h,r)&&(p=$t(h,r),o=li(o,Be(),d.snap.getChild(p)));else if(d.children){if(un(r,h))p=$t(r,h),o=Zh(o,p,d.children);else if(un(h,r))if(p=$t(h,r),Me(p))o=Zh(o,Be(),d.children);else{const g=os(d.children,Re(p));if(g){const x=g.getChild(Ke(p));o=li(o,Be(),x)}}}else throw us("WriteRecord should have .snap or .children")}}return o}function _m(s,t,r,o,a){if(!o&&!a){const d=Ir(s.visibleWrites,t);if(d!=null)return d;{const h=tr(s.visibleWrites,t);if(Rc(h))return r;if(r==null&&!Tc(h,Be()))return null;{const p=r||Ne.EMPTY_NODE;return cs(h,p)}}}else{const d=tr(s.visibleWrites,t);if(!a&&Rc(d))return r;if(!a&&r==null&&!Tc(d,Be()))return null;{const h=function(x){return(x.visible||a)&&(!o||!~o.indexOf(x.writeId))&&(un(x.path,t)||un(t,x.path))},p=ym(s.allWrites,h,t),g=r||Ne.EMPTY_NODE;return cs(p,g)}}}function P_(s,t,r){let o=Ne.EMPTY_NODE;const a=Ir(s.visibleWrites,t);if(a)return a.isLeafNode()||a.forEachChild(ot,(d,h)=>{o=o.updateImmediateChild(d,h)}),o;if(r){const d=tr(s.visibleWrites,t);return r.forEachChild(ot,(h,p)=>{const g=cs(tr(d,new Ge(h)),p);o=o.updateImmediateChild(h,g)}),tp(d).forEach(h=>{o=o.updateImmediateChild(h.name,h.node)}),o}else{const d=tr(s.visibleWrites,t);return tp(d).forEach(h=>{o=o.updateImmediateChild(h.name,h.node)}),o}}function L_(s,t,r,o,a){K(o||a,"Either existingEventSnap or existingServerSnap must exist");const d=pt(t,r);if(Tc(s.visibleWrites,d))return null;{const h=tr(s.visibleWrites,d);return Rc(h)?a.getChild(r):cs(h,a.getChild(r))}}function M_(s,t,r,o){const a=pt(t,r),d=Ir(s.visibleWrites,a);if(d!=null)return d;if(o.isCompleteForChild(r)){const h=tr(s.visibleWrites,a);return cs(h,o.getNode().getImmediateChild(r))}else return null}function D_(s,t){return Ir(s.visibleWrites,t)}function O_(s,t,r,o,a,d,h){let p;const g=tr(s.visibleWrites,t),x=Ir(g,Be());if(x!=null)p=x;else if(r!=null)p=cs(g,r);else return[];if(p=p.withIndex(h),!p.isEmpty()&&!p.isLeafNode()){const k=[],y=h.getCompare(),v=d?p.getReverseIteratorFrom(o,h):p.getIteratorFrom(o,h);let S=v.getNext();for(;S&&k.length<a;)y(S,o)!==0&&k.push(S),S=v.getNext();return k}else return[]}function A_(){return{visibleWrites:fn.empty(),allWrites:[],lastWriteId:-1}}function Ko(s,t,r,o){return _m(s.writeTree,s.treePath,t,r,o)}function tu(s,t){return P_(s.writeTree,s.treePath,t)}function np(s,t,r,o){return L_(s.writeTree,s.treePath,t,r,o)}function Jo(s,t){return D_(s.writeTree,pt(s.treePath,t))}function F_(s,t,r,o,a,d){return O_(s.writeTree,s.treePath,t,r,o,a,d)}function nu(s,t,r){return M_(s.writeTree,s.treePath,t,r)}function wm(s,t){return bm(pt(s.treePath,t),s.writeTree)}function bm(s,t){return{treePath:s,writeTree:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_{constructor(){this.changeMap=new Map}trackChildChange(t){const r=t.type,o=t.childName;K(r==="child_added"||r==="child_changed"||r==="child_removed","Only child changes supported for tracking"),K(o!==".priority","Only non-priority child changes can be tracked.");const a=this.changeMap.get(o);if(a){const d=a.type;if(r==="child_added"&&d==="child_removed")this.changeMap.set(o,pi(o,t.snapshotNode,a.snapshotNode));else if(r==="child_removed"&&d==="child_added")this.changeMap.delete(o);else if(r==="child_removed"&&d==="child_changed")this.changeMap.set(o,hi(o,a.oldSnap));else if(r==="child_changed"&&d==="child_added")this.changeMap.set(o,as(o,t.snapshotNode));else if(r==="child_changed"&&d==="child_changed")this.changeMap.set(o,pi(o,t.snapshotNode,a.oldSnap));else throw us("Illegal combination of changes: "+t+" occurred after "+a)}else this.changeMap.set(o,t)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{getCompleteChild(t){return null}getChildAfterChild(t,r,o){return null}}const Nm=new $_;class ru{constructor(t,r,o=null){this.writes_=t,this.viewCache_=r,this.optCompleteServerCache_=o}getCompleteChild(t){const r=this.viewCache_.eventCache;if(r.isCompleteForChild(t))return r.getNode().getImmediateChild(t);{const o=this.optCompleteServerCache_!=null?new Er(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return nu(this.writes_,t,o)}}getChildAfterChild(t,r,o){const a=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:jr(this.viewCache_),d=F_(this.writes_,a,r,1,o,t);return d.length===0?null:d[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U_(s){return{filter:s}}function B_(s,t){K(t.eventCache.getNode().isIndexed(s.filter.getIndex()),"Event snap not indexed"),K(t.serverCache.getNode().isIndexed(s.filter.getIndex()),"Server snap not indexed")}function W_(s,t,r,o,a){const d=new z_;let h,p;if(r.type===dn.OVERWRITE){const x=r;x.source.fromUser?h=Pc(s,t,x.path,x.snap,o,a,d):(K(x.source.fromServer,"Unknown source."),p=x.source.tagged||t.serverCache.isFiltered()&&!Me(x.path),h=Zo(s,t,x.path,x.snap,o,a,p,d))}else if(r.type===dn.MERGE){const x=r;x.source.fromUser?h=V_(s,t,x.path,x.children,o,a,d):(K(x.source.fromServer,"Unknown source."),p=x.source.tagged||t.serverCache.isFiltered(),h=Lc(s,t,x.path,x.children,o,a,p,d))}else if(r.type===dn.ACK_USER_WRITE){const x=r;x.revert?h=G_(s,t,x.path,o,a,d):h=Y_(s,t,x.path,x.affectedTree,o,a,d)}else if(r.type===dn.LISTEN_COMPLETE)h=Q_(s,t,r.path,o,d);else throw us("Unknown operation type: "+r.type);const g=d.getChanges();return H_(t,h,g),{viewCache:h,changes:g}}function H_(s,t,r){const o=t.eventCache;if(o.isFullyInitialized()){const a=o.getNode().isLeafNode()||o.getNode().isEmpty(),d=Ic(s);(r.length>0||!s.eventCache.isFullyInitialized()||a&&!o.getNode().equals(d)||!o.getNode().getPriority().equals(d.getPriority()))&&r.push(pm(Ic(t)))}}function km(s,t,r,o,a,d){const h=t.eventCache;if(Jo(o,r)!=null)return t;{let p,g;if(Me(r))if(K(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const x=jr(t),k=x instanceof Ne?x:Ne.EMPTY_NODE,y=tu(o,k);p=s.filter.updateFullNode(t.eventCache.getNode(),y,d)}else{const x=Ko(o,jr(t));p=s.filter.updateFullNode(t.eventCache.getNode(),x,d)}else{const x=Re(r);if(x===".priority"){K(nr(r)===1,"Can't have a priority with additional path components");const k=h.getNode();g=t.serverCache.getNode();const y=np(o,r,k,g);y!=null?p=s.filter.updatePriority(k,y):p=h.getNode()}else{const k=Ke(r);let y;if(h.isCompleteForChild(x)){g=t.serverCache.getNode();const v=np(o,r,h.getNode(),g);v!=null?y=h.getNode().getImmediateChild(x).updateChild(k,v):y=h.getNode().getImmediateChild(x)}else y=nu(o,x,t.serverCache);y!=null?p=s.filter.updateChild(h.getNode(),x,y,k,a,d):p=h.getNode()}}return oi(t,p,h.isFullyInitialized()||Me(r),s.filter.filtersNodes())}}function Zo(s,t,r,o,a,d,h,p){const g=t.serverCache;let x;const k=h?s.filter:s.filter.getIndexedFilter();if(Me(r))x=k.updateFullNode(g.getNode(),o,null);else if(k.filtersNodes()&&!g.isFiltered()){const S=g.getNode().updateChild(r,o);x=k.updateFullNode(g.getNode(),S,null)}else{const S=Re(r);if(!g.isCompleteForPath(r)&&nr(r)>1)return t;const O=Ke(r),Z=g.getNode().getImmediateChild(S).updateChild(O,o);S===".priority"?x=k.updatePriority(g.getNode(),Z):x=k.updateChild(g.getNode(),S,Z,O,Nm,null)}const y=xm(t,x,g.isFullyInitialized()||Me(r),k.filtersNodes()),v=new ru(a,y,d);return km(s,y,r,a,v,p)}function Pc(s,t,r,o,a,d,h){const p=t.eventCache;let g,x;const k=new ru(a,t,d);if(Me(r))x=s.filter.updateFullNode(t.eventCache.getNode(),o,h),g=oi(t,x,!0,s.filter.filtersNodes());else{const y=Re(r);if(y===".priority")x=s.filter.updatePriority(t.eventCache.getNode(),o),g=oi(t,x,p.isFullyInitialized(),p.isFiltered());else{const v=Ke(r),S=p.getNode().getImmediateChild(y);let O;if(Me(v))O=o;else{const H=k.getCompleteChild(y);H!=null?im(v)===".priority"&&H.getChild(lm(v)).isEmpty()?O=H:O=H.updateChild(v,o):O=Ne.EMPTY_NODE}if(S.equals(O))g=t;else{const H=s.filter.updateChild(p.getNode(),y,O,v,k,h);g=oi(t,H,p.isFullyInitialized(),s.filter.filtersNodes())}}}return g}function rp(s,t){return s.eventCache.isCompleteForChild(t)}function V_(s,t,r,o,a,d,h){let p=t;return o.foreach((g,x)=>{const k=pt(r,g);rp(t,Re(k))&&(p=Pc(s,p,k,x,a,d,h))}),o.foreach((g,x)=>{const k=pt(r,g);rp(t,Re(k))||(p=Pc(s,p,k,x,a,d,h))}),p}function sp(s,t,r){return r.foreach((o,a)=>{t=t.updateChild(o,a)}),t}function Lc(s,t,r,o,a,d,h,p){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let g=t,x;Me(r)?x=o:x=new et(null).setTree(r,o);const k=t.serverCache.getNode();return x.children.inorderTraversal((y,v)=>{if(k.hasChild(y)){const S=t.serverCache.getNode().getImmediateChild(y),O=sp(s,S,v);g=Zo(s,g,new Ge(y),O,a,d,h,p)}}),x.children.inorderTraversal((y,v)=>{const S=!t.serverCache.isCompleteForChild(y)&&v.value===null;if(!k.hasChild(y)&&!S){const O=t.serverCache.getNode().getImmediateChild(y),H=sp(s,O,v);g=Zo(s,g,new Ge(y),H,a,d,h,p)}}),g}function Y_(s,t,r,o,a,d,h){if(Jo(a,r)!=null)return t;const p=t.serverCache.isFiltered(),g=t.serverCache;if(o.value!=null){if(Me(r)&&g.isFullyInitialized()||g.isCompleteForPath(r))return Zo(s,t,r,g.getNode().getChild(r),a,d,p,h);if(Me(r)){let x=new et(null);return g.getNode().forEachChild(ss,(k,y)=>{x=x.set(new Ge(k),y)}),Lc(s,t,r,x,a,d,p,h)}else return t}else{let x=new et(null);return o.foreach((k,y)=>{const v=pt(r,k);g.isCompleteForPath(v)&&(x=x.set(k,g.getNode().getChild(v)))}),Lc(s,t,r,x,a,d,p,h)}}function Q_(s,t,r,o,a){const d=t.serverCache,h=xm(t,d.getNode(),d.isFullyInitialized()||Me(r),d.isFiltered());return km(s,h,r,o,Nm,a)}function G_(s,t,r,o,a,d){let h;if(Jo(o,r)!=null)return t;{const p=new ru(o,t,a),g=t.eventCache.getNode();let x;if(Me(r)||Re(r)===".priority"){let k;if(t.serverCache.isFullyInitialized())k=Ko(o,jr(t));else{const y=t.serverCache.getNode();K(y instanceof Ne,"serverChildren would be complete if leaf node"),k=tu(o,y)}k=k,x=s.filter.updateFullNode(g,k,d)}else{const k=Re(r);let y=nu(o,k,t.serverCache);y==null&&t.serverCache.isCompleteForChild(k)&&(y=g.getImmediateChild(k)),y!=null?x=s.filter.updateChild(g,k,y,Ke(r),p,d):t.eventCache.getNode().hasChild(k)?x=s.filter.updateChild(g,k,Ne.EMPTY_NODE,Ke(r),p,d):x=g,x.isEmpty()&&t.serverCache.isFullyInitialized()&&(h=Ko(o,jr(t)),h.isLeafNode()&&(x=s.filter.updateFullNode(x,h,d)))}return h=t.serverCache.isFullyInitialized()||Jo(o,Be())!=null,oi(t,x,h,s.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(t,r){this.query_=t,this.eventRegistrations_=[];const o=this.query_._queryParams,a=new qc(o.getIndex()),d=p_(o);this.processor_=U_(d);const h=r.serverCache,p=r.eventCache,g=a.updateFullNode(Ne.EMPTY_NODE,h.getNode(),null),x=d.updateFullNode(Ne.EMPTY_NODE,p.getNode(),null),k=new Er(g,h.isFullyInitialized(),a.filtersNodes()),y=new Er(x,p.isFullyInitialized(),d.filtersNodes());this.viewCache_=ll(y,k),this.eventGenerator_=new w_(this.query_)}get query(){return this.query_}}function q_(s){return s.viewCache_.serverCache.getNode()}function K_(s,t){const r=jr(s.viewCache_);return r&&(s.query._queryParams.loadsAllData()||!Me(t)&&!r.getImmediateChild(Re(t)).isEmpty())?r.getChild(t):null}function ip(s){return s.eventRegistrations_.length===0}function J_(s,t){s.eventRegistrations_.push(t)}function op(s,t,r){const o=[];if(r){K(t==null,"A cancel should cancel all event registrations.");const a=s.query._path;s.eventRegistrations_.forEach(d=>{const h=d.createCancelEvent(r,a);h&&o.push(h)})}if(t){let a=[];for(let d=0;d<s.eventRegistrations_.length;++d){const h=s.eventRegistrations_[d];if(!h.matches(t))a.push(h);else if(t.hasAnyCallback()){a=a.concat(s.eventRegistrations_.slice(d+1));break}}s.eventRegistrations_=a}else s.eventRegistrations_=[];return o}function lp(s,t,r,o){t.type===dn.MERGE&&t.source.queryId!==null&&(K(jr(s.viewCache_),"We should always have a full cache before handling merges"),K(Ic(s.viewCache_),"Missing event cache, even though we have a server cache"));const a=s.viewCache_,d=W_(s.processor_,a,t,r,o);return B_(s.processor_,d.viewCache),K(d.viewCache.serverCache.isFullyInitialized()||!a.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),s.viewCache_=d.viewCache,Cm(s,d.changes,d.viewCache.eventCache.getNode(),null)}function Z_(s,t){const r=s.viewCache_.eventCache,o=[];return r.getNode().isLeafNode()||r.getNode().forEachChild(ot,(d,h)=>{o.push(as(d,h))}),r.isFullyInitialized()&&o.push(pm(r.getNode())),Cm(s,o,r.getNode(),t)}function Cm(s,t,r,o){const a=o?[o]:s.eventRegistrations_;return b_(s.eventGenerator_,t,r,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let el;class e1{constructor(){this.views=new Map}}function t1(s){K(!el,"__referenceConstructor has already been defined"),el=s}function n1(){return K(el,"Reference.ts has not been loaded"),el}function r1(s){return s.views.size===0}function su(s,t,r,o){const a=t.source.queryId;if(a!==null){const d=s.views.get(a);return K(d!=null,"SyncTree gave us an op for an invalid query."),lp(d,t,r,o)}else{let d=[];for(const h of s.views.values())d=d.concat(lp(h,t,r,o));return d}}function s1(s,t,r,o,a){const d=t._queryIdentifier,h=s.views.get(d);if(!h){let p=Ko(r,a?o:null),g=!1;p?g=!0:o instanceof Ne?(p=tu(r,o),g=!1):(p=Ne.EMPTY_NODE,g=!1);const x=ll(new Er(p,g,!1),new Er(o,a,!1));return new X_(t,x)}return h}function i1(s,t,r,o,a,d){const h=s1(s,t,o,a,d);return s.views.has(t._queryIdentifier)||s.views.set(t._queryIdentifier,h),J_(h,r),Z_(h,r)}function o1(s,t,r,o){const a=t._queryIdentifier,d=[];let h=[];const p=rr(s);if(a==="default")for(const[g,x]of s.views.entries())h=h.concat(op(x,r,o)),ip(x)&&(s.views.delete(g),x.query._queryParams.loadsAllData()||d.push(x.query));else{const g=s.views.get(a);g&&(h=h.concat(op(g,r,o)),ip(g)&&(s.views.delete(a),g.query._queryParams.loadsAllData()||d.push(g.query)))}return p&&!rr(s)&&d.push(new(n1())(t._repo,t._path)),{removed:d,events:h}}function Sm(s){const t=[];for(const r of s.views.values())r.query._queryParams.loadsAllData()||t.push(r);return t}function is(s,t){let r=null;for(const o of s.views.values())r=r||K_(o,t);return r}function Em(s,t){if(t._queryParams.loadsAllData())return al(s);{const o=t._queryIdentifier;return s.views.get(o)}}function jm(s,t){return Em(s,t)!=null}function rr(s){return al(s)!=null}function al(s){for(const t of s.views.values())if(t.query._queryParams.loadsAllData())return t;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tl;function l1(s){K(!tl,"__referenceConstructor has already been defined"),tl=s}function a1(){return K(tl,"Reference.ts has not been loaded"),tl}let c1=1;class ap{constructor(t){this.listenProvider_=t,this.syncPointTree_=new et(null),this.pendingWriteTree_=A_(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Im(s,t,r,o,a){return S_(s.pendingWriteTree_,t,r,o,a),a?Ni(s,new Sr(gm(),t,r)):[]}function kr(s,t,r=!1){const o=E_(s.pendingWriteTree_,t);if(j_(s.pendingWriteTree_,t)){let d=new et(null);return o.snap!=null?d=d.set(Be(),!0):Wt(o.children,h=>{d=d.set(new Ge(h),!0)}),Ni(s,new qo(o.path,d,r))}else return[]}function cl(s,t,r){return Ni(s,new Sr(Jc(),t,r))}function u1(s,t,r){const o=et.fromObject(r);return Ni(s,new xi(Jc(),t,o))}function d1(s,t){return Ni(s,new gi(Jc(),t))}function f1(s,t,r){const o=ou(s,r);if(o){const a=lu(o),d=a.path,h=a.queryId,p=$t(d,t),g=new gi(Zc(h),p);return au(s,d,g)}else return[]}function Mc(s,t,r,o,a=!1){const d=t._path,h=s.syncPointTree_.get(d);let p=[];if(h&&(t._queryIdentifier==="default"||jm(h,t))){const g=o1(h,t,r,o);r1(h)&&(s.syncPointTree_=s.syncPointTree_.remove(d));const x=g.removed;if(p=g.events,!a){const k=x.findIndex(v=>v._queryParams.loadsAllData())!==-1,y=s.syncPointTree_.findOnPath(d,(v,S)=>rr(S));if(k&&!y){const v=s.syncPointTree_.subtree(d);if(!v.isEmpty()){const S=m1(v);for(let O=0;O<S.length;++O){const H=S[O],Z=H.query,le=Pm(s,H);s.listenProvider_.startListening(ai(Z),nl(s,Z),le.hashFn,le.onComplete)}}}!y&&x.length>0&&!o&&(k?s.listenProvider_.stopListening(ai(t),null):x.forEach(v=>{const S=s.queryToTagMap.get(ul(v));s.listenProvider_.stopListening(ai(v),S)}))}g1(s,x)}return p}function h1(s,t,r,o){const a=ou(s,o);if(a!=null){const d=lu(a),h=d.path,p=d.queryId,g=$t(h,t),x=new Sr(Zc(p),g,r);return au(s,h,x)}else return[]}function p1(s,t,r,o){const a=ou(s,o);if(a){const d=lu(a),h=d.path,p=d.queryId,g=$t(h,t),x=et.fromObject(r),k=new xi(Zc(p),g,x);return au(s,h,k)}else return[]}function cp(s,t,r,o=!1){const a=t._path;let d=null,h=!1;s.syncPointTree_.foreachOnPath(a,(v,S)=>{const O=$t(v,a);d=d||is(S,O),h=h||rr(S)});let p=s.syncPointTree_.get(a);p?(h=h||rr(p),d=d||is(p,Be())):(p=new e1,s.syncPointTree_=s.syncPointTree_.set(a,p));let g;d!=null?g=!0:(g=!1,d=Ne.EMPTY_NODE,s.syncPointTree_.subtree(a).foreachChild((S,O)=>{const H=is(O,Be());H&&(d=d.updateImmediateChild(S,H))}));const x=jm(p,t);if(!x&&!t._queryParams.loadsAllData()){const v=ul(t);K(!s.queryToTagMap.has(v),"View does not exist, but we have a tag");const S=x1();s.queryToTagMap.set(v,S),s.tagToQueryMap.set(S,v)}const k=eu(s.pendingWriteTree_,a);let y=i1(p,t,r,k,d,g);if(!x&&!h&&!o){const v=Em(p,t);y=y.concat(v1(s,t,v))}return y}function iu(s,t,r){const a=s.pendingWriteTree_,d=s.syncPointTree_.findOnPath(t,(h,p)=>{const g=$t(h,t),x=is(p,g);if(x)return x});return _m(a,t,d,r,!0)}function Ni(s,t){return Tm(t,s.syncPointTree_,null,eu(s.pendingWriteTree_,Be()))}function Tm(s,t,r,o){if(Me(s.path))return Rm(s,t,r,o);{const a=t.get(Be());r==null&&a!=null&&(r=is(a,Be()));let d=[];const h=Re(s.path),p=s.operationForChild(h),g=t.children.get(h);if(g&&p){const x=r?r.getImmediateChild(h):null,k=wm(o,h);d=d.concat(Tm(p,g,x,k))}return a&&(d=d.concat(su(a,s,o,r))),d}}function Rm(s,t,r,o){const a=t.get(Be());r==null&&a!=null&&(r=is(a,Be()));let d=[];return t.children.inorderTraversal((h,p)=>{const g=r?r.getImmediateChild(h):null,x=wm(o,h),k=s.operationForChild(h);k&&(d=d.concat(Rm(k,p,g,x)))}),a&&(d=d.concat(su(a,s,o,r))),d}function Pm(s,t){const r=t.query,o=nl(s,r);return{hashFn:()=>(q_(t)||Ne.EMPTY_NODE).hash(),onComplete:a=>{if(a==="ok")return o?f1(s,r._path,o):d1(s,r._path);{const d=hy(a,r);return Mc(s,r,null,d)}}}}function nl(s,t){const r=ul(t);return s.queryToTagMap.get(r)}function ul(s){return s._path.toString()+"$"+s._queryIdentifier}function ou(s,t){return s.tagToQueryMap.get(t)}function lu(s){const t=s.indexOf("$");return K(t!==-1&&t<s.length-1,"Bad queryKey."),{queryId:s.substr(t+1),path:new Ge(s.substr(0,t))}}function au(s,t,r){const o=s.syncPointTree_.get(t);K(o,"Missing sync point for query tag that we're tracking");const a=eu(s.pendingWriteTree_,t);return su(o,r,a,null)}function m1(s){return s.fold((t,r,o)=>{if(r&&rr(r))return[al(r)];{let a=[];return r&&(a=Sm(r)),Wt(o,(d,h)=>{a=a.concat(h)}),a}})}function ai(s){return s._queryParams.loadsAllData()&&!s._queryParams.isDefault()?new(a1())(s._repo,s._path):s}function g1(s,t){for(let r=0;r<t.length;++r){const o=t[r];if(!o._queryParams.loadsAllData()){const a=ul(o),d=s.queryToTagMap.get(a);s.queryToTagMap.delete(a),s.tagToQueryMap.delete(d)}}}function x1(){return c1++}function v1(s,t,r){const o=t._path,a=nl(s,t),d=Pm(s,r),h=s.listenProvider_.startListening(ai(t),a,d.hashFn,d.onComplete),p=s.syncPointTree_.subtree(o);if(a)K(!rr(p.value),"If we're adding a query, it shouldn't be shadowed");else{const g=p.fold((x,k,y)=>{if(!Me(x)&&k&&rr(k))return[al(k).query];{let v=[];return k&&(v=v.concat(Sm(k).map(S=>S.query))),Wt(y,(S,O)=>{v=v.concat(O)}),v}});for(let x=0;x<g.length;++x){const k=g[x];s.listenProvider_.stopListening(ai(k),nl(s,k))}}return h}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(t){this.node_=t}getImmediateChild(t){const r=this.node_.getImmediateChild(t);return new cu(r)}node(){return this.node_}}class uu{constructor(t,r){this.syncTree_=t,this.path_=r}getImmediateChild(t){const r=pt(this.path_,t);return new uu(this.syncTree_,r)}node(){return iu(this.syncTree_,this.path_)}}const y1=function(s){return s=s||{},s.timestamp=s.timestamp||new Date().getTime(),s},up=function(s,t,r){if(!s||typeof s!="object")return s;if(K(".sv"in s,"Unexpected leaf node or priority contents"),typeof s[".sv"]=="string")return _1(s[".sv"],t,r);if(typeof s[".sv"]=="object")return w1(s[".sv"],t);K(!1,"Unexpected server value: "+JSON.stringify(s,null,2))},_1=function(s,t,r){switch(s){case"timestamp":return r.timestamp;default:K(!1,"Unexpected server value: "+s)}},w1=function(s,t,r){s.hasOwnProperty("increment")||K(!1,"Unexpected server value: "+JSON.stringify(s,null,2));const o=s.increment;typeof o!="number"&&K(!1,"Unexpected increment value: "+o);const a=t.node();if(K(a!==null&&typeof a<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!a.isLeafNode())return o;const h=a.getValue();return typeof h!="number"?o:h+o},b1=function(s,t,r,o){return du(t,new uu(r,s),o)},Lm=function(s,t,r){return du(s,new cu(t),r)};function du(s,t,r){const o=s.getPriority().val(),a=up(o,t.getImmediateChild(".priority"),r);let d;if(s.isLeafNode()){const h=s,p=up(h.getValue(),t,r);return p!==h.getValue()||a!==h.getPriority().val()?new vt(p,kt(a)):s}else{const h=s;return d=h,a!==h.getPriority().val()&&(d=d.updatePriority(new vt(a))),h.forEachChild(ot,(p,g)=>{const x=du(g,t.getImmediateChild(p),r);x!==g&&(d=d.updateImmediateChild(p,x))}),d}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(t="",r=null,o={children:{},childCount:0}){this.name=t,this.parent=r,this.node=o}}function hu(s,t){let r=t instanceof Ge?t:new Ge(t),o=s,a=Re(r);for(;a!==null;){const d=os(o.node.children,a)||{children:{},childCount:0};o=new fu(a,o,d),r=Ke(r),a=Re(r)}return o}function hs(s){return s.node.value}function Mm(s,t){s.node.value=t,Dc(s)}function Dm(s){return s.node.childCount>0}function N1(s){return hs(s)===void 0&&!Dm(s)}function dl(s,t){Wt(s.node.children,(r,o)=>{t(new fu(r,s,o))})}function Om(s,t,r,o){r&&t(s),dl(s,a=>{Om(a,t,!0)})}function k1(s,t,r){let o=s.parent;for(;o!==null;){if(t(o))return!0;o=o.parent}return!1}function ki(s){return new Ge(s.parent===null?s.name:ki(s.parent)+"/"+s.name)}function Dc(s){s.parent!==null&&C1(s.parent,s.name,s)}function C1(s,t,r){const o=N1(r),a=Ln(s.node.children,t);o&&a?(delete s.node.children[t],s.node.childCount--,Dc(s)):!o&&!a&&(s.node.children[t]=r.node,s.node.childCount++,Dc(s))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S1=/[\[\].#$\/\u0000-\u001F\u007F]/,E1=/[\[\].#$\u0000-\u001F\u007F]/,xc=10*1024*1024,Am=function(s){return typeof s=="string"&&s.length!==0&&!S1.test(s)},Fm=function(s){return typeof s=="string"&&s.length!==0&&!E1.test(s)},j1=function(s){return s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),Fm(s)},I1=function(s,t,r,o){pu(Uc(s,"value"),t,r)},pu=function(s,t,r){const o=r instanceof Ge?new Yy(r,s):r;if(t===void 0)throw new Error(s+"contains undefined "+br(o));if(typeof t=="function")throw new Error(s+"contains a function "+br(o)+" with contents = "+t.toString());if(Fp(t))throw new Error(s+"contains "+t.toString()+" "+br(o));if(typeof t=="string"&&t.length>xc/3&&il(t)>xc)throw new Error(s+"contains a string greater than "+xc+" utf8 bytes "+br(o)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let a=!1,d=!1;if(Wt(t,(h,p)=>{if(h===".value")a=!0;else if(h!==".priority"&&h!==".sv"&&(d=!0,!Am(h)))throw new Error(s+" contains an invalid key ("+h+") "+br(o)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Qy(o,h),pu(s,p,o),Gy(o)}),a&&d)throw new Error(s+' contains ".value" child '+br(o)+" in addition to actual children.")}},zm=function(s,t,r,o){if(!Fm(r))throw new Error(Uc(s,t)+'was an invalid path = "'+r+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},T1=function(s,t,r,o){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),zm(s,t,r)},$m=function(s,t){if(Re(t)===".info")throw new Error(s+" failed = Can't modify data under /.info/")},R1=function(s,t){const r=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!Am(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||r.length!==0&&!j1(r))throw new Error(Uc(s,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function mu(s,t){let r=null;for(let o=0;o<t.length;o++){const a=t[o],d=a.getPath();r!==null&&!Qc(d,r.path)&&(s.eventLists_.push(r),r=null),r===null&&(r={events:[],path:d}),r.events.push(a)}r&&s.eventLists_.push(r)}function Um(s,t,r){mu(s,r),Bm(s,o=>Qc(o,t))}function Pn(s,t,r){mu(s,r),Bm(s,o=>un(o,t)||un(t,o))}function Bm(s,t){s.recursionDepth_++;let r=!0;for(let o=0;o<s.eventLists_.length;o++){const a=s.eventLists_[o];if(a){const d=a.path;t(d)?(L1(s.eventLists_[o]),s.eventLists_[o]=null):r=!1}}r&&(s.eventLists_=[]),s.recursionDepth_--}function L1(s){for(let t=0;t<s.events.length;t++){const r=s.events[t];if(r!==null){s.events[t]=null;const o=r.getEventRunner();si&&Tt("event: "+r.toString()),fs(o)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1="repo_interrupt",D1=25;class O1{constructor(t,r,o,a){this.repoInfo_=t,this.forceRestClient_=r,this.authTokenProvider_=o,this.appCheckProvider_=a,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new P1,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Xo(),this.transactionQueueTree_=new fu,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function A1(s,t,r){if(s.stats_=Vc(s.repoInfo_),s.forceRestClient_||xy())s.server_=new Go(s.repoInfo_,(o,a,d,h)=>{dp(s,o,a,d,h)},s.authTokenProvider_,s.appCheckProvider_),setTimeout(()=>fp(s,!0),0);else{if(typeof r<"u"&&r!==null){if(typeof r!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{_t(r)}catch(o){throw new Error("Invalid authOverride provided: "+o)}}s.persistentConnection_=new In(s.repoInfo_,t,(o,a,d,h)=>{dp(s,o,a,d,h)},o=>{fp(s,o)},o=>{z1(s,o)},s.authTokenProvider_,s.appCheckProvider_,r),s.server_=s.persistentConnection_}s.authTokenProvider_.addTokenChangeListener(o=>{s.server_.refreshAuthToken(o)}),s.appCheckProvider_.addTokenChangeListener(o=>{s.server_.refreshAppCheckToken(o.token)}),s.statsReporter_=by(s.repoInfo_,()=>new __(s.stats_,s.server_)),s.infoData_=new m_,s.infoSyncTree_=new ap({startListening:(o,a,d,h)=>{let p=[];const g=s.infoData_.getNode(o._path);return g.isEmpty()||(p=cl(s.infoSyncTree_,o._path,g),setTimeout(()=>{h("ok")},0)),p},stopListening:()=>{}}),xu(s,"connected",!1),s.serverSyncTree_=new ap({startListening:(o,a,d,h)=>(s.server_.listen(o,d,a,(p,g)=>{const x=h(p,g);Pn(s.eventQueue_,o._path,x)}),[]),stopListening:(o,a)=>{s.server_.unlisten(o,a)}})}function F1(s){const r=s.infoData_.getNode(new Ge(".info/serverTimeOffset")).val()||0;return new Date().getTime()+r}function gu(s){return y1({timestamp:F1(s)})}function dp(s,t,r,o,a){s.dataUpdateCount++;const d=new Ge(t);r=s.interceptServerDataCallback_?s.interceptServerDataCallback_(t,r):r;let h=[];if(a)if(o){const g=Uo(r,x=>kt(x));h=p1(s.serverSyncTree_,d,g,a)}else{const g=kt(r);h=h1(s.serverSyncTree_,d,g,a)}else if(o){const g=Uo(r,x=>kt(x));h=u1(s.serverSyncTree_,d,g)}else{const g=kt(r);h=cl(s.serverSyncTree_,d,g)}let p=d;h.length>0&&(p=fl(s,d)),Pn(s.eventQueue_,p,h)}function fp(s,t){xu(s,"connected",t),t===!1&&U1(s)}function z1(s,t){Wt(t,(r,o)=>{xu(s,r,o)})}function xu(s,t,r){const o=new Ge("/.info/"+t),a=kt(r);s.infoData_.updateSnapshot(o,a);const d=cl(s.infoSyncTree_,o,a);Pn(s.eventQueue_,o,d)}function Wm(s){return s.nextWriteId_++}function $1(s,t,r,o,a){vu(s,"set",{path:t.toString(),value:r,priority:o});const d=gu(s),h=kt(r,o),p=iu(s.serverSyncTree_,t),g=Lm(h,p,d),x=Wm(s),k=Im(s.serverSyncTree_,t,g,x,!0);mu(s.eventQueue_,k),s.server_.put(t.toString(),h.val(!0),(v,S)=>{const O=v==="ok";O||Bt("set at "+t+" failed: "+v);const H=kr(s.serverSyncTree_,x,!O);Pn(s.eventQueue_,t,H),V1(s,a,v,S)});const y=Gm(s,t);fl(s,y),Pn(s.eventQueue_,y,[])}function U1(s){vu(s,"onDisconnectEvents");const t=gu(s),r=Xo();jc(s.onDisconnect_,Be(),(a,d)=>{const h=b1(a,d,s.serverSyncTree_,t);mm(r,a,h)});let o=[];jc(r,Be(),(a,d)=>{o=o.concat(cl(s.serverSyncTree_,a,d));const h=Gm(s,a);fl(s,h)}),s.onDisconnect_=Xo(),Pn(s.eventQueue_,Be(),o)}function B1(s,t,r){let o;Re(t._path)===".info"?o=cp(s.infoSyncTree_,t,r):o=cp(s.serverSyncTree_,t,r),Um(s.eventQueue_,t._path,o)}function W1(s,t,r){let o;Re(t._path)===".info"?o=Mc(s.infoSyncTree_,t,r):o=Mc(s.serverSyncTree_,t,r),Um(s.eventQueue_,t._path,o)}function H1(s){s.persistentConnection_&&s.persistentConnection_.interrupt(M1)}function vu(s,...t){let r="";s.persistentConnection_&&(r=s.persistentConnection_.id+":"),Tt(r,...t)}function V1(s,t,r,o){t&&fs(()=>{if(r==="ok")t(null);else{const a=(r||"error").toUpperCase();let d=a;o&&(d+=": "+o);const h=new Error(d);h.code=a,t(h)}})}function Hm(s,t,r){return iu(s.serverSyncTree_,t,r)||Ne.EMPTY_NODE}function yu(s,t=s.transactionQueueTree_){if(t||hl(s,t),hs(t)){const r=Ym(s,t);K(r.length>0,"Sending zero length transaction queue"),r.every(a=>a.status===0)&&Y1(s,ki(t),r)}else Dm(t)&&dl(t,r=>{yu(s,r)})}function Y1(s,t,r){const o=r.map(x=>x.currentWriteId),a=Hm(s,t,o);let d=a;const h=a.hash();for(let x=0;x<r.length;x++){const k=r[x];K(k.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),k.status=1,k.retryCount++;const y=$t(t,k.path);d=d.updateChild(y,k.currentOutputSnapshotRaw)}const p=d.val(!0),g=t;s.server_.put(g.toString(),p,x=>{vu(s,"transaction put response",{path:g.toString(),status:x});let k=[];if(x==="ok"){const y=[];for(let v=0;v<r.length;v++)r[v].status=2,k=k.concat(kr(s.serverSyncTree_,r[v].currentWriteId)),r[v].onComplete&&y.push(()=>r[v].onComplete(null,!0,r[v].currentOutputSnapshotResolved)),r[v].unwatcher();hl(s,hu(s.transactionQueueTree_,t)),yu(s,s.transactionQueueTree_),Pn(s.eventQueue_,t,k);for(let v=0;v<y.length;v++)fs(y[v])}else{if(x==="datastale")for(let y=0;y<r.length;y++)r[y].status===3?r[y].status=4:r[y].status=0;else{Bt("transaction at "+g.toString()+" failed: "+x);for(let y=0;y<r.length;y++)r[y].status=4,r[y].abortReason=x}fl(s,t)}},h)}function fl(s,t){const r=Vm(s,t),o=ki(r),a=Ym(s,r);return Q1(s,a,o),o}function Q1(s,t,r){if(t.length===0)return;const o=[];let a=[];const h=t.filter(p=>p.status===0).map(p=>p.currentWriteId);for(let p=0;p<t.length;p++){const g=t[p],x=$t(r,g.path);let k=!1,y;if(K(x!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),g.status===4)k=!0,y=g.abortReason,a=a.concat(kr(s.serverSyncTree_,g.currentWriteId,!0));else if(g.status===0)if(g.retryCount>=D1)k=!0,y="maxretry",a=a.concat(kr(s.serverSyncTree_,g.currentWriteId,!0));else{const v=Hm(s,g.path,h);g.currentInputSnapshot=v;const S=t[p].update(v.val());if(S!==void 0){pu("transaction failed: Data returned ",S,g.path);let O=kt(S);typeof S=="object"&&S!=null&&Ln(S,".priority")||(O=O.updatePriority(v.getPriority()));const Z=g.currentWriteId,le=gu(s),se=Lm(O,v,le);g.currentOutputSnapshotRaw=O,g.currentOutputSnapshotResolved=se,g.currentWriteId=Wm(s),h.splice(h.indexOf(Z),1),a=a.concat(Im(s.serverSyncTree_,g.path,se,g.currentWriteId,g.applyLocally)),a=a.concat(kr(s.serverSyncTree_,Z,!0))}else k=!0,y="nodata",a=a.concat(kr(s.serverSyncTree_,g.currentWriteId,!0))}Pn(s.eventQueue_,r,a),a=[],k&&(t[p].status=2,(function(v){setTimeout(v,Math.floor(0))})(t[p].unwatcher),t[p].onComplete&&(y==="nodata"?o.push(()=>t[p].onComplete(null,!1,t[p].currentInputSnapshot)):o.push(()=>t[p].onComplete(new Error(y),!1,null))))}hl(s,s.transactionQueueTree_);for(let p=0;p<o.length;p++)fs(o[p]);yu(s,s.transactionQueueTree_)}function Vm(s,t){let r,o=s.transactionQueueTree_;for(r=Re(t);r!==null&&hs(o)===void 0;)o=hu(o,r),t=Ke(t),r=Re(t);return o}function Ym(s,t){const r=[];return Qm(s,t,r),r.sort((o,a)=>o.order-a.order),r}function Qm(s,t,r){const o=hs(t);if(o)for(let a=0;a<o.length;a++)r.push(o[a]);dl(t,a=>{Qm(s,a,r)})}function hl(s,t){const r=hs(t);if(r){let o=0;for(let a=0;a<r.length;a++)r[a].status!==2&&(r[o]=r[a],o++);r.length=o,Mm(t,r.length>0?r:void 0)}dl(t,o=>{hl(s,o)})}function Gm(s,t){const r=ki(Vm(s,t)),o=hu(s.transactionQueueTree_,t);return k1(o,a=>{vc(s,a)}),vc(s,o),Om(o,a=>{vc(s,a)}),r}function vc(s,t){const r=hs(t);if(r){const o=[];let a=[],d=-1;for(let h=0;h<r.length;h++)r[h].status===3||(r[h].status===1?(K(d===h-1,"All SENT items should be at beginning of queue."),d=h,r[h].status=3,r[h].abortReason="set"):(K(r[h].status===0,"Unexpected transaction status in abort"),r[h].unwatcher(),a=a.concat(kr(s.serverSyncTree_,r[h].currentWriteId,!0)),r[h].onComplete&&o.push(r[h].onComplete.bind(null,new Error("set"),!1,null))));d===-1?Mm(t,void 0):r.length=d+1,Pn(s.eventQueue_,ki(t),a);for(let h=0;h<o.length;h++)fs(o[h])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G1(s){let t="";const r=s.split("/");for(let o=0;o<r.length;o++)if(r[o].length>0){let a=r[o];try{a=decodeURIComponent(a.replace(/\+/g," "))}catch{}t+="/"+a}return t}function X1(s){const t={};s.charAt(0)==="?"&&(s=s.substring(1));for(const r of s.split("&")){if(r.length===0)continue;const o=r.split("=");o.length===2?t[decodeURIComponent(o[0])]=decodeURIComponent(o[1]):Bt(`Invalid query segment '${r}' in query '${s}'`)}return t}const hp=function(s,t){const r=q1(s),o=r.namespace;r.domain==="firebase.com"&&Rn(r.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!o||o==="undefined")&&r.domain!=="localhost"&&Rn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r.secure||ay();const a=r.scheme==="ws"||r.scheme==="wss";return{repoInfo:new qp(r.host,r.secure,o,a,t,"",o!==r.subdomain),path:new Ge(r.pathString)}},q1=function(s){let t="",r="",o="",a="",d="",h=!0,p="https",g=443;if(typeof s=="string"){let x=s.indexOf("//");x>=0&&(p=s.substring(0,x-1),s=s.substring(x+2));let k=s.indexOf("/");k===-1&&(k=s.length);let y=s.indexOf("?");y===-1&&(y=s.length),t=s.substring(0,Math.min(k,y)),k<y&&(a=G1(s.substring(k,y)));const v=X1(s.substring(Math.min(s.length,y)));x=t.indexOf(":"),x>=0?(h=p==="https"||p==="wss",g=parseInt(t.substring(x+1),10)):x=t.length;const S=t.slice(0,x);if(S.toLowerCase()==="localhost")r="localhost";else if(S.split(".").length<=2)r=S;else{const O=t.indexOf(".");o=t.substring(0,O).toLowerCase(),r=t.substring(O+1),d=o}"ns"in v&&(d=v.ns)}return{host:t,port:g,domain:r,subdomain:o,secure:h,scheme:p,pathString:a,namespace:d}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(t,r,o,a){this.eventType=t,this.eventRegistration=r,this.snapshot=o,this.prevName=a}getPath(){const t=this.snapshot.ref;return this.eventType==="value"?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+_t(this.snapshot.exportVal())}}class J1{constructor(t,r,o){this.eventRegistration=t,this.error=r,this.path=o}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1{constructor(t,r){this.snapshotCallback=t,this.cancelCallback=r}onValue(t,r){this.snapshotCallback.call(null,t,r)}onCancel(t){return K(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(t,r,o,a){this._repo=t,this._path=r,this._queryParams=o,this._orderByCalled=a}get key(){return Me(this._path)?null:im(this._path)}get ref(){return new sr(this._repo,this._path)}get _queryIdentifier(){const t=Kh(this._queryParams),r=Wc(t);return r==="{}"?"default":r}get _queryObject(){return Kh(this._queryParams)}isEqual(t){if(t=yi(t),!(t instanceof _u))return!1;const r=this._repo===t._repo,o=Qc(this._path,t._path),a=this._queryIdentifier===t._queryIdentifier;return r&&o&&a}toJSON(){return this.toString()}toString(){return this._repo.toString()+Vy(this._path)}}class sr extends _u{constructor(t,r){super(t,r,new Kc,!1)}get parent(){const t=lm(this._path);return t===null?null:new sr(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}}class rl{constructor(t,r,o){this._node=t,this.ref=r,this._index=o}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const r=new Ge(t),o=Oc(this.ref,t);return new rl(this._node.getChild(r),o,ot)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(o,a)=>t(new rl(a,Oc(this.ref,o),ot)))}hasChild(t){const r=new Ge(t);return!this._node.getChild(r).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function wt(s,t){return s=yi(s),s._checkNotDeleted("ref"),t!==void 0?Oc(s._root,t):s._root}function Oc(s,t){return s=yi(s),Re(s._path)===null?T1("child","path",t):zm("child","path",t),new sr(s._repo,pt(s._path,t))}function Ci(s){return $m("remove",s._path),ir(s,null)}function ir(s,t){s=yi(s),$m("set",s._path),I1("set",t,s._path);const r=new sl;return $1(s._repo,s._path,t,null,r.wrapCallback(()=>{})),r.promise}class wu{constructor(t){this.callbackContext=t}respondsTo(t){return t==="value"}createEvent(t,r){const o=r._queryParams.getIndex();return new K1("value",this,new rl(t.snapshotNode,new sr(r._repo,r._path),o))}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,r){return this.callbackContext.hasCancelCallback?new J1(this,t,r):null}matches(t){return t instanceof wu?!t.callbackContext||!this.callbackContext?!0:t.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function ew(s,t,r,o,a){const d=new Z1(r,void 0),h=new wu(d);return B1(s._repo,s,h),()=>W1(s._repo,s,h)}function ps(s,t,r,o){return ew(s,"value",t)}t1(sr);l1(sr);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw="FIREBASE_DATABASE_EMULATOR_HOST",Ac={};let nw=!1;function rw(s,t,r,o){const a=t.lastIndexOf(":"),d=t.substring(0,a),h=$c(d);s.repoInfo_=new qp(t,h,s.repoInfo_.namespace,s.repoInfo_.webSocketOnly,s.repoInfo_.nodeAdmin,s.repoInfo_.persistenceKey,s.repoInfo_.includeNamespaceInQueryParams,!0,r),o&&(s.authTokenProvider_=o)}function sw(s,t,r,o,a){let d=o||s.options.databaseURL;d===void 0&&(s.options.projectId||Rn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Tt("Using default host for project ",s.options.projectId),d=`${s.options.projectId}-default-rtdb.firebaseio.com`);let h=hp(d,a),p=h.repoInfo,g;typeof process<"u"&&Lh&&(g=Lh[tw]),g?(d=`http://${g}?ns=${p.namespace}`,h=hp(d,a),p=h.repoInfo):h.repoInfo.secure;const x=new yy(s.name,s.options,t);R1("Invalid Firebase Database URL",h),Me(h.path)||Rn("Database URL must point to the root of a Firebase Database (not including a child path).");const k=ow(p,s,x,new vy(s,r));return new lw(k,s)}function iw(s,t){const r=Ac[t];(!r||r[s.key]!==s)&&Rn(`Database ${t}(${s.repoInfo_}) has already been deleted.`),H1(s),delete r[s.key]}function ow(s,t,r,o){let a=Ac[t.name];a||(a={},Ac[t.name]=a);let d=a[s.toURLString()];return d&&Rn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),d=new O1(s,nw,r,o),a[s.toURLString()]=d,d}class lw{constructor(t,r){this._repoInternal=t,this.app=r,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(A1(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new sr(this._repo,Be())),this._rootInternal}_delete(){return this._rootInternal!==null&&(iw(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&Rn("Cannot call "+t+" on a deleted database.")}}function aw(s=Wv(),t){const r=Fv(s,"database").getImmediate({identifier:t});if(!r._instanceStarted){const o=Nx("database");o&&cw(r,...o)}return r}function cw(s,t,r,o={}){s=yi(s),s._checkNotDeleted("useEmulator");const a=`${t}:${r}`,d=s._repoInternal;if(s._instanceStarted){if(a===s._repoInternal.repoInfo_.host&&Bo(o,d.repoInfo_.emulatorOptions))return;Rn("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let h;if(d.repoInfo_.nodeAdmin)o.mockUserToken&&Rn('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),h=new Fo(Fo.OWNER);else if(o.mockUserToken){const p=typeof o.mockUserToken=="string"?o.mockUserToken:Cx(o.mockUserToken,s.app.options.projectId);h=new Fo(p)}$c(t)&&(kx(t),jx("Database",!0)),rw(d,a,o,h)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uw(s){ny(Bv),Ho(new ui("database",(t,{instanceIdentifier:r})=>{const o=t.getProvider("app").getImmediate(),a=t.getProvider("auth-internal"),d=t.getProvider("app-check-internal");return sw(o,a,d,r)},"PUBLIC").setMultipleInstances(!0)),ns(Mh,Dh,s),ns(Mh,Dh,"esm2020")}In.prototype.simpleListen=function(s,t){this.sendRequest("q",{p:s},t)};In.prototype.echo=function(s,t){this.sendRequest("echo",{d:s},t)};uw();const dw={apiKey:"AIzaSyCIA80U-Nb235O5SG_2d1TzdylvYQrzNUc",authDomain:"razlom-db061.firebaseapp.com",projectId:"razlom-db061",storageBucket:"razlom-db061.firebasestorage.app",messagingSenderId:"343432819418",appId:"1:343432819418:web:73f0fedc8a5e5a32912be3",measurementId:"G-EPLQFH5LMJ",databaseURL:"https://razlom-db061-default-rtdb.firebaseio.com"};let pp,De;try{pp=Pp(dw),De=aw(pp),console.log("Firebase initialized successfully (RTDB only)")}catch(s){console.error("Firebase init error:",s)}const Si=s=>{if(!s)return[];const t=Array.isArray(s)?s:Object.values(s),r=new Map;return t.forEach(o=>{o&&typeof o=="object"&&o.id&&r.set(o.id,o)}),Array.from(r.values())},ni=s=>(s||[]).reduce((t,r)=>(r&&r.id&&(t[r.id]=r),t),{}),fw=(s,t)=>{if(!De)return()=>{};const r=wt(De,`rooms/${s}/characters`);return ps(r,o=>{t(Si(o.val()))})},hw=(s,t)=>{if(!De)return()=>{};const r=wt(De,`rooms/${s}/realms`);return ps(r,o=>{t(Si(o.val()))})},pw=(s,t)=>{if(!De)return()=>{};const r=wt(De,`rooms/${s}/worlds`);return ps(r,o=>{t(Si(o.val()))})},mw=(s,t)=>{if(!De)return()=>{};const r=wt(De,`rooms/${s}/notes`);return ps(r,o=>{t(Si(o.val()))})},gw=(s,t)=>{if(!De)return()=>{};const r=wt(De,`rooms/${s}/rpSessions`);return ps(r,o=>{t(Si(o.val()))})},mp=(s,t,r=!1)=>{if(!De)return()=>{};const a=wt(De,`rooms/${s}/${r?"availableHiddenTags":"availableTags"}`);return ps(a,d=>{const h=d.val();t(Array.isArray(h)?h:[])})},xw=async(s,t)=>{if(!De)return;const r=wt(De,`rooms/${s}`),o={...t,characters:ni(t.characters),realms:ni(t.realms),worlds:ni(t.worlds),notes:ni(t.notes),rpSessions:ni(t.rpSessions)};try{await ir(r,o)}catch(a){console.error("Firebase write error:",a)}},vw=async(s,t)=>{if(!De||!t.id)return;const r=wt(De,`rooms/${s}/characters/${t.id}`);try{await ir(r,t)}catch(o){console.error("Error saving character:",o)}},yw=async(s,t)=>{if(!De)return;const r=wt(De,`rooms/${s}/characters/${t}`);try{await Ci(r)}catch(o){console.error("Error deleting character:",o)}},_w=async(s,t)=>{if(!De||!t.id)return;const r=wt(De,`rooms/${s}/realms/${t.id}`);try{await ir(r,t)}catch(o){console.error(o)}},ww=async(s,t)=>{if(!De)return;const r=wt(De,`rooms/${s}/realms/${t}`);try{await Ci(r)}catch(o){console.error(o)}},bw=async(s,t)=>{if(!De||!t.id)return;const r=wt(De,`rooms/${s}/worlds/${t.id}`);try{await ir(r,t)}catch(o){console.error(o)}},Nw=async(s,t)=>{if(!De)return;const r=wt(De,`rooms/${s}/worlds/${t}`);try{await Ci(r)}catch(o){console.error(o)}},kw=async(s,t)=>{if(!De||!t.id)return;const r=wt(De,`rooms/${s}/notes/${t.id}`);try{await ir(r,t)}catch(o){console.error(o)}},Cw=async(s,t)=>{if(!De)return;const r=wt(De,`rooms/${s}/notes/${t}`);try{await Ci(r)}catch(o){console.error(o)}},Sw=async(s,t)=>{if(!De||!t.id)return;const r=wt(De,`rooms/${s}/rpSessions/${t.id}`);try{await ir(r,t)}catch(o){console.error(o)}},Ew=async(s,t)=>{if(!De)return;const r=wt(De,`rooms/${s}/rpSessions/${t}`);try{await Ci(r)}catch(o){console.error(o)}},gp=async(s,t,r=!1)=>{if(!De)return;const a=wt(De,`rooms/${s}/${r?"availableHiddenTags":"availableTags"}`);try{await ir(a,t)}catch(d){console.error("Error saving tags:",d)}},xp="rp_haven_master_data_v3",dt="global_chronicles_main",zt=(s,t=[])=>Array.isArray(s)?s:t,jw=()=>{const[s,t]=$.useState("characters"),[r,o]=$.useState(null),[a,d]=$.useState(""),[h,p]=$.useState({}),[g,x]=$.useState(!1),[k,y]=$.useState(!1),[v,S]=$.useState(null),[O,H]=$.useState(!1),[Z,le]=$.useState(!1),[se,we]=$.useState(!0);$.useEffect(()=>{window.scrollTo(0,0)},[s,r]);const[ue,Ae]=$.useState(!1),[G,M]=$.useState(lc),[R,ye]=$.useState(()=>{const D=localStorage.getItem(xp);if(D)try{const L=JSON.parse(D);return{characters:zt(L.characters,lc),realms:zt(L.realms),worlds:zt(L.worlds),notes:zt(L.notes),availableTags:zt(L.availableTags,yh),availableHiddenTags:zt(L.availableHiddenTags,_h),rpSessions:zt(L.rpSessions)}}catch(L){console.error("Failed to parse storage",L)}return{characters:lc,realms:[],worlds:[],notes:[],availableTags:yh,availableHiddenTags:_h,rpSessions:[]}});$.useEffect(()=>{M(R.characters)},[R.characters]),$.useEffect(()=>{if(se){const D=fw(dt,de=>ye(be=>({...be,characters:de}))),L=hw(dt,de=>ye(be=>({...be,realms:de}))),Q=pw(dt,de=>ye(be=>({...be,worlds:de}))),me=mw(dt,de=>ye(be=>({...be,notes:de}))),Ce=gw(dt,de=>ye(be=>({...be,rpSessions:de}))),T=mp(dt,de=>ye(be=>({...be,availableTags:de})),!1),X=mp(dt,de=>ye(be=>({...be,availableHiddenTags:de})),!0);return()=>{D(),L(),Q(),me(),Ce(),T(),X()}}},[se]);const P=()=>{const D=R.characters.filter(L=>{const Q=L.name.toLowerCase().includes(a.toLowerCase()),me=Object.entries(h).every(([Ce,T])=>{const X=(L.tags||[]).includes(Ce)||(L.hiddenTags||[]).includes(Ce);return T==="include"?X:T==="exclude"?!X:!0});return Q&&me});Ae(!0),setTimeout(()=>{M(D),requestAnimationFrame(()=>{Ae(!1)})},600)};$.useEffect(()=>{P()},[a,h,R.characters]);const ee=D=>{ye(D),H(!0),setTimeout(()=>H(!1),2e3);try{const L=JSON.parse(JSON.stringify(D));L.characters.forEach(Q=>{Q.imageUrl&&Q.imageUrl.startsWith("data:")&&(Q.imageUrl="")}),L.worlds.forEach(Q=>{Q.imageUrl&&Q.imageUrl.startsWith("data:")&&(Q.imageUrl="")}),L.realms.forEach(Q=>{Q.imageUrl&&Q.imageUrl.startsWith("data:")&&(Q.imageUrl="")}),localStorage.setItem(xp,JSON.stringify(L))}catch(L){console.warn("Local storage quota exceeded.",L)}},ie=D=>{const L=R.characters.some(Q=>Q.id===D.id)?R.characters.map(Q=>Q.id===D.id?D:Q):[...R.characters,D];ee({...R,characters:L}),y(!1),S(null),se&&vw(dt,D)},Ie=D=>{if(window.confirm("    ?")){const L=R.characters.filter(Q=>Q.id!==D);ee({...R,characters:L}),r===D&&o(null),se&&yw(dt,D)}},We=D=>{se&&(D.forEach(L=>{const Q=R.notes.find(me=>me.id===L.id);(!Q||JSON.stringify(Q)!==JSON.stringify(L))&&kw(dt,L)}),R.notes.forEach(L=>{D.find(Q=>Q.id===L.id)||Cw(dt,L.id)})),ee({...R,notes:D})},lt=D=>{se&&(D.forEach(L=>{const Q=R.realms.find(me=>me.id===L.id);(!Q||JSON.stringify(Q)!==JSON.stringify(L))&&_w(dt,L)}),R.realms.forEach(L=>{D.find(Q=>Q.id===L.id)||ww(dt,L.id)})),ee({...R,realms:D})},Qe=D=>{se&&(D.forEach(L=>{const Q=R.worlds.find(me=>me.id===L.id);(!Q||JSON.stringify(Q)!==JSON.stringify(L))&&bw(dt,L)}),R.worlds.forEach(L=>{D.find(Q=>Q.id===L.id)||Nw(dt,L.id)})),ee({...R,worlds:D})},ze=D=>{se&&(D.forEach(L=>{const Q=R.rpSessions.find(me=>me.id===L.id);(!Q||JSON.stringify(Q)!==JSON.stringify(L))&&Sw(dt,L)}),R.rpSessions.forEach(L=>{D.find(Q=>Q.id===L.id)||Ew(dt,L.id)})),ee({...R,rpSessions:D})},V=D=>{ee({...R,availableTags:D}),se&&gp(dt,D,!1)},J=D=>{ee({...R,availableHiddenTags:D}),se&&gp(dt,D,!0)},w=D=>{p(L=>{const Q=L[D]||"none";let me="none";Q==="none"?me="include":Q==="include"?me="exclude":me="none";const Ce={...L};return me==="none"?delete Ce[D]:Ce[D]=me,Ce})},A=()=>{d(""),p({})},te=Object.keys(h).length;return c.jsxs(ex,{activeTab:s,setActiveTab:D=>{t(D),o(null),p({})},isAdmin:g,onToggleAdmin:()=>x(!g),onOpenSync:()=>le(!0),isSyncActive:se,onDownloadDB:()=>{const D=new Blob([JSON.stringify(R,null,2)],{type:"application/json"}),L=URL.createObjectURL(D),Q=document.createElement("a");Q.href=L,Q.download=`rp-vault-${new Date().toISOString().slice(0,10)}.json`,Q.click()},onUploadDB:D=>{const L=JSON.parse(D);if(window.confirm("  ?")){const Q={characters:zt(L.characters),realms:zt(L.realms),worlds:zt(L.worlds),notes:zt(L.notes),availableTags:zt(L.availableTags),availableHiddenTags:zt(L.availableHiddenTags),rpSessions:zt(L.rpSessions)};ee(Q),se&&xw(dt,Q)}},children:[c.jsx("div",{className:`fixed top-20 md:top-6 right-6 z-[90] transition-all duration-500 pointer-events-none ${O?"opacity-100 translate-y-0":"opacity-0 -translate-y-4"}`,children:c.jsx("div",{className:"bg-emerald-950/80 border border-emerald-500/30 backdrop-blur-2xl px-5 py-2.5 rounded-2xl flex items-center gap-3 shadow-2xl",children:c.jsx("span",{className:"text-[10px] uppercase tracking-[0.2em] font-black text-emerald-400",children:""})})}),Z&&c.jsx(fx,{isConnected:se,onConnect:()=>we(!0),onDisconnect:()=>we(!1),onClose:()=>le(!1)}),c.jsxs("div",{className:"animate-tab-switch",children:[s==="characters"&&c.jsx("div",{className:"space-y-8",children:r?c.jsx(rx,{character:R.characters.find(D=>D.id===r),isAdmin:g,allCharacters:R.characters,availableTags:R.availableTags,availableHiddenTags:R.availableHiddenTags,worlds:R.worlds,notes:R.notes,onBack:()=>o(null),onSave:ie,onSelectCharacter:o}):c.jsxs("div",{className:"animate-reveal-list space-y-8",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-6",children:[c.jsx("input",{type:"text",placeholder:"  ...",value:a,onChange:D=>d(D.target.value),className:"w-full bg-transparent border-b border-stone-900 text-3xl outline-none font-serif italic py-4"}),g&&c.jsx("button",{onClick:()=>{S(null),y(!0)},className:"bg-white text-black px-8 py-3.5 rounded-full text-[10px] uppercase font-black transition-all shadow-xl",children:" "})]}),(R.availableTags.length>0||R.availableHiddenTags.length>0)&&c.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-4 bg-[#0f0f0f]/30 border border-stone-900/50 rounded-2xl",children:[c.jsx("span",{className:"text-[9px] uppercase tracking-[0.2em] font-black text-stone-600 mr-2",children:":"}),R.availableTags.map(D=>{const L=h[D]||"none";return c.jsxs("button",{onClick:()=>w(D),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${L==="include"?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":L==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-stone-400 hover:border-stone-700"}`,children:[L==="include"&&c.jsx("span",{className:"text-emerald-500 font-black",children:"+"}),L==="exclude"&&c.jsx("span",{className:"text-red-500 font-black",children:""}),D]},D)}),R.availableHiddenTags.map(D=>{const L=h[D]||"none";return c.jsxs("button",{onClick:()=>w(D),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${L==="include"?"bg-amber-500/10 border-amber-500/40 text-amber-400 shadow-[0_0_15px_rgba(245,158,11,0.1)]":L==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-amber-500 hover:border-amber-900/30"}`,children:[L==="include"&&c.jsx("span",{className:"text-amber-500 font-black",children:"+"}),L==="exclude"&&c.jsx("span",{className:"text-red-500 font-black",children:""}),D]},D)}),(te>0||a)&&c.jsx("button",{onClick:A,className:"ml-auto text-[9px] uppercase tracking-[0.2em] font-black text-stone-700 hover:text-red-500 transition-colors",children:" "})]}),c.jsxs("div",{className:"flex flex-wrap -mx-5 relative min-h-[400px]",children:[G.map((D,L)=>c.jsx(nx,{character:D,isVisible:!ue,staggerIndex:L,onClick:o},D.id)),G.length===0&&!ue&&c.jsx("div",{className:"w-full py-20 text-center text-stone-700 italic font-serif animate-in fade-in duration-700",children:"       ..."})]})]})}),s==="connections"&&c.jsx(ax,{characters:R.characters,availableTags:R.availableTags,availableHiddenTags:R.availableHiddenTags,filterStates:h,onToggleTag:w,onClearFilters:()=>p({}),onSelectCharacter:D=>{o(D),t("characters")}}),s==="roleplay"&&c.jsx(dx,{sessions:R.rpSessions,characters:R.characters,onUpdate:ze,isAdmin:g}),s==="worlds"&&c.jsx(cx,{realms:R.realms,worlds:R.worlds,characters:R.characters,availableTags:R.availableTags,availableHiddenTags:R.availableHiddenTags,onUpdateRealms:lt,onUpdateWorlds:Qe,isAdmin:g}),s==="notes"&&c.jsx(ux,{notes:R.notes,characters:R.characters,availableTags:R.availableTags,availableHiddenTags:R.availableHiddenTags,onUpdate:We,isAdmin:g}),s==="admin"&&g&&c.jsx(ix,{characters:R.characters,availableTags:R.availableTags,availableHiddenTags:R.availableHiddenTags,onDelete:Ie,onEdit:D=>{S(D),y(!0)},onAdd:()=>{S(null),y(!0)},onUpdateTags:V,onUpdateHiddenTags:J,onDownloadDB:()=>{},onUploadDB:()=>{}})]}),k&&c.jsx(sx,{initialData:v,availableTags:R.availableTags,availableHiddenTags:R.availableHiddenTags,onSave:ie,onClose:()=>y(!1)})]})},Xm=document.getElementById("root");if(!Xm)throw new Error("Could not find root element to mount to");const Iw=Zg.createRoot(Xm);Iw.render(c.jsx(yp.StrictMode,{children:c.jsx(jw,{})}));
