(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))i(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function r(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function i(c){if(c.ep)return;c.ep=!0;const d=r(c);fetch(c.href,d)}})();function _0(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var oc={exports:{}},ro={},ic={exports:{}},He={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var df;function Gg(){if(df)return He;df=1;var s=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),f=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),_=Symbol.iterator;function v(N){return N===null||typeof N!="object"?null:(N=_&&N[_]||N["@@iterator"],typeof N=="function"?N:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$=Object.assign,R={};function q(N,I,ee){this.props=N,this.context=I,this.refs=R,this.updater=ee||j}q.prototype.isReactComponent={},q.prototype.setState=function(N,I){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,I,"setState")},q.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function de(){}de.prototype=q.prototype;function fe(N,I,ee){this.props=N,this.context=I,this.refs=R,this.updater=ee||j}var Se=fe.prototype=new de;Se.constructor=fe,$(Se,q.prototype),Se.isPureReactComponent=!0;var J=Array.isArray,Me=Object.prototype.hasOwnProperty,Z={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function X(N,I,ee){var he,Le={},Ae=null,De=null;if(I!=null)for(he in I.ref!==void 0&&(De=I.ref),I.key!==void 0&&(Ae=""+I.key),I)Me.call(I,he)&&!A.hasOwnProperty(he)&&(Le[he]=I[he]);var xe=arguments.length-2;if(xe===1)Le.children=ee;else if(1<xe){for(var F=Array(xe),W=0;W<xe;W++)F[W]=arguments[W+2];Le.children=F}if(N&&N.defaultProps)for(he in xe=N.defaultProps,xe)Le[he]===void 0&&(Le[he]=xe[he]);return{$$typeof:s,type:N,key:Ae,ref:De,props:Le,_owner:Z.current}}function Ce(N,I){return{$$typeof:s,type:N.type,key:I,ref:N.ref,props:N.props,_owner:N._owner}}function P(N){return typeof N=="object"&&N!==null&&N.$$typeof===s}function Ee(N){var I={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(ee){return I[ee]})}var ye=/\/+/g;function ke(N,I){return typeof N=="object"&&N!==null&&N.key!=null?Ee(""+N.key):I.toString(36)}function ue(N,I,ee,he,Le){var Ae=typeof N;(Ae==="undefined"||Ae==="boolean")&&(N=null);var De=!1;if(N===null)De=!0;else switch(Ae){case"string":case"number":De=!0;break;case"object":switch(N.$$typeof){case s:case t:De=!0}}if(De)return De=N,Le=Le(De),N=he===""?"."+ke(De,0):he,J(Le)?(ee="",N!=null&&(ee=N.replace(ye,"$&/")+"/"),ue(Le,I,ee,"",function(W){return W})):Le!=null&&(P(Le)&&(Le=Ce(Le,ee+(!Le.key||De&&De.key===Le.key?"":(""+Le.key).replace(ye,"$&/")+"/")+N)),I.push(Le)),1;if(De=0,he=he===""?".":he+":",J(N))for(var xe=0;xe<N.length;xe++){Ae=N[xe];var F=he+ke(Ae,xe);De+=ue(Ae,I,ee,F,Le)}else if(F=v(N),typeof F=="function")for(N=F.call(N),xe=0;!(Ae=N.next()).done;)Ae=Ae.value,F=he+ke(Ae,xe++),De+=ue(Ae,I,ee,F,Le);else if(Ae==="object")throw I=String(N),Error("Objects are not valid as a React child (found: "+(I==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.");return De}function Ye(N,I,ee){if(N==null)return N;var he=[],Le=0;return ue(N,he,"","",function(Ae){return I.call(ee,Ae,Le++)}),he}function ae(N){if(N._status===-1){var I=N._result;I=I(),I.then(function(ee){(N._status===0||N._status===-1)&&(N._status=1,N._result=ee)},function(ee){(N._status===0||N._status===-1)&&(N._status=2,N._result=ee)}),N._status===-1&&(N._status=0,N._result=I)}if(N._status===1)return N._result.default;throw N._result}var ze={current:null},H={transition:null},U={ReactCurrentDispatcher:ze,ReactCurrentBatchConfig:H,ReactCurrentOwner:Z};return He.Children={map:Ye,forEach:function(N,I,ee){Ye(N,function(){I.apply(this,arguments)},ee)},count:function(N){var I=0;return Ye(N,function(){I++}),I},toArray:function(N){return Ye(N,function(I){return I})||[]},only:function(N){if(!P(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},He.Component=q,He.Fragment=r,He.Profiler=c,He.PureComponent=fe,He.StrictMode=i,He.Suspense=m,He.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U,He.cloneElement=function(N,I,ee){if(N==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+N+".");var he=$({},N.props),Le=N.key,Ae=N.ref,De=N._owner;if(I!=null){if(I.ref!==void 0&&(Ae=I.ref,De=Z.current),I.key!==void 0&&(Le=""+I.key),N.type&&N.type.defaultProps)var xe=N.type.defaultProps;for(F in I)Me.call(I,F)&&!A.hasOwnProperty(F)&&(he[F]=I[F]===void 0&&xe!==void 0?xe[F]:I[F])}var F=arguments.length-2;if(F===1)he.children=ee;else if(1<F){xe=Array(F);for(var W=0;W<F;W++)xe[W]=arguments[W+2];he.children=xe}return{$$typeof:s,type:N.type,key:Le,ref:Ae,props:he,_owner:De}},He.createContext=function(N){return N={$$typeof:f,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},N.Provider={$$typeof:d,_context:N},N.Consumer=N},He.createElement=X,He.createFactory=function(N){var I=X.bind(null,N);return I.type=N,I},He.createRef=function(){return{current:null}},He.forwardRef=function(N){return{$$typeof:p,render:N}},He.isValidElement=P,He.lazy=function(N){return{$$typeof:w,_payload:{_status:-1,_result:N},_init:ae}},He.memo=function(N,I){return{$$typeof:x,type:N,compare:I===void 0?null:I}},He.startTransition=function(N){var I=H.transition;H.transition={};try{N()}finally{H.transition=I}},He.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},He.useCallback=function(N,I){return ze.current.useCallback(N,I)},He.useContext=function(N){return ze.current.useContext(N)},He.useDebugValue=function(){},He.useDeferredValue=function(N){return ze.current.useDeferredValue(N)},He.useEffect=function(N,I){return ze.current.useEffect(N,I)},He.useId=function(){return ze.current.useId()},He.useImperativeHandle=function(N,I,ee){return ze.current.useImperativeHandle(N,I,ee)},He.useInsertionEffect=function(N,I){return ze.current.useInsertionEffect(N,I)},He.useLayoutEffect=function(N,I){return ze.current.useLayoutEffect(N,I)},He.useMemo=function(N,I){return ze.current.useMemo(N,I)},He.useReducer=function(N,I,ee){return ze.current.useReducer(N,I,ee)},He.useRef=function(N){return ze.current.useRef(N)},He.useState=function(N){return ze.current.useState(N)},He.useSyncExternalStore=function(N,I,ee){return ze.current.useSyncExternalStore(N,I,ee)},He.useTransition=function(){return ze.current.useTransition()},He.version="18.2.0",He}var hf;function Bc(){return hf||(hf=1,ic.exports=Gg()),ic.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ff;function qg(){if(ff)return ro;ff=1;var s=Bc(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,c=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function f(p,m,x){var w,_={},v=null,j=null;x!==void 0&&(v=""+x),m.key!==void 0&&(v=""+m.key),m.ref!==void 0&&(j=m.ref);for(w in m)i.call(m,w)&&!d.hasOwnProperty(w)&&(_[w]=m[w]);if(p&&p.defaultProps)for(w in m=p.defaultProps,m)_[w]===void 0&&(_[w]=m[w]);return{$$typeof:t,type:p,key:v,ref:j,props:_,_owner:c.current}}return ro.Fragment=r,ro.jsx=f,ro.jsxs=f,ro}var pf;function Xg(){return pf||(pf=1,oc.exports=qg()),oc.exports}var l=Xg(),O=Bc();const N0=_0(O);var $i={},lc={exports:{}},Ht={},ac={exports:{}},cc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mf;function Kg(){return mf||(mf=1,(function(s){function t(H,U){var N=H.length;H.push(U);e:for(;0<N;){var I=N-1>>>1,ee=H[I];if(0<c(ee,U))H[I]=U,H[N]=ee,N=I;else break e}}function r(H){return H.length===0?null:H[0]}function i(H){if(H.length===0)return null;var U=H[0],N=H.pop();if(N!==U){H[0]=N;e:for(var I=0,ee=H.length,he=ee>>>1;I<he;){var Le=2*(I+1)-1,Ae=H[Le],De=Le+1,xe=H[De];if(0>c(Ae,N))De<ee&&0>c(xe,Ae)?(H[I]=xe,H[De]=N,I=De):(H[I]=Ae,H[Le]=N,I=Le);else if(De<ee&&0>c(xe,N))H[I]=xe,H[De]=N,I=De;else break e}}return U}function c(H,U){var N=H.sortIndex-U.sortIndex;return N!==0?N:H.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;s.unstable_now=function(){return d.now()}}else{var f=Date,p=f.now();s.unstable_now=function(){return f.now()-p}}var m=[],x=[],w=1,_=null,v=3,j=!1,$=!1,R=!1,q=typeof setTimeout=="function"?setTimeout:null,de=typeof clearTimeout=="function"?clearTimeout:null,fe=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Se(H){for(var U=r(x);U!==null;){if(U.callback===null)i(x);else if(U.startTime<=H)i(x),U.sortIndex=U.expirationTime,t(m,U);else break;U=r(x)}}function J(H){if(R=!1,Se(H),!$)if(r(m)!==null)$=!0,ae(Me);else{var U=r(x);U!==null&&ze(J,U.startTime-H)}}function Me(H,U){$=!1,R&&(R=!1,de(X),X=-1),j=!0;var N=v;try{for(Se(U),_=r(m);_!==null&&(!(_.expirationTime>U)||H&&!Ee());){var I=_.callback;if(typeof I=="function"){_.callback=null,v=_.priorityLevel;var ee=I(_.expirationTime<=U);U=s.unstable_now(),typeof ee=="function"?_.callback=ee:_===r(m)&&i(m),Se(U)}else i(m);_=r(m)}if(_!==null)var he=!0;else{var Le=r(x);Le!==null&&ze(J,Le.startTime-U),he=!1}return he}finally{_=null,v=N,j=!1}}var Z=!1,A=null,X=-1,Ce=5,P=-1;function Ee(){return!(s.unstable_now()-P<Ce)}function ye(){if(A!==null){var H=s.unstable_now();P=H;var U=!0;try{U=A(!0,H)}finally{U?ke():(Z=!1,A=null)}}else Z=!1}var ke;if(typeof fe=="function")ke=function(){fe(ye)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,Ye=ue.port2;ue.port1.onmessage=ye,ke=function(){Ye.postMessage(null)}}else ke=function(){q(ye,0)};function ae(H){A=H,Z||(Z=!0,ke())}function ze(H,U){X=q(function(){H(s.unstable_now())},U)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(H){H.callback=null},s.unstable_continueExecution=function(){$||j||($=!0,ae(Me))},s.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ce=0<H?Math.floor(1e3/H):5},s.unstable_getCurrentPriorityLevel=function(){return v},s.unstable_getFirstCallbackNode=function(){return r(m)},s.unstable_next=function(H){switch(v){case 1:case 2:case 3:var U=3;break;default:U=v}var N=v;v=U;try{return H()}finally{v=N}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(H,U){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var N=v;v=H;try{return U()}finally{v=N}},s.unstable_scheduleCallback=function(H,U,N){var I=s.unstable_now();switch(typeof N=="object"&&N!==null?(N=N.delay,N=typeof N=="number"&&0<N?I+N:I):N=I,H){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=N+ee,H={id:w++,callback:U,priorityLevel:H,startTime:N,expirationTime:ee,sortIndex:-1},N>I?(H.sortIndex=N,t(x,H),r(m)===null&&H===r(x)&&(R?(de(X),X=-1):R=!0,ze(J,N-I))):(H.sortIndex=ee,t(m,H),$||j||($=!0,ae(Me))),H},s.unstable_shouldYield=Ee,s.unstable_wrapCallback=function(H){var U=v;return function(){var N=v;v=U;try{return H.apply(this,arguments)}finally{v=N}}}})(cc)),cc}var gf;function Jg(){return gf||(gf=1,ac.exports=Kg()),ac.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xf;function Zg(){if(xf)return Ht;xf=1;var s=Bc(),t=Jg();function r(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)n+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,c={};function d(e,n){f(e,n),f(e+"Capture",n)}function f(e,n){for(c[e]=n,e=0;e<n.length;e++)i.add(n[e])}var p=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,x=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,w={},_={};function v(e){return m.call(_,e)?!0:m.call(w,e)?!1:x.test(e)?_[e]=!0:(w[e]=!0,!1)}function j(e,n,o,a){if(o!==null&&o.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return a?!1:o!==null?!o.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function $(e,n,o,a){if(n===null||typeof n>"u"||j(e,n,o,a))return!0;if(a)return!1;if(o!==null)switch(o.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function R(e,n,o,a,u,h,g){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=a,this.attributeNamespace=u,this.mustUseProperty=o,this.propertyName=e,this.type=n,this.sanitizeURL=h,this.removeEmptyString=g}var q={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){q[e]=new R(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];q[n]=new R(n,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){q[e]=new R(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){q[e]=new R(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){q[e]=new R(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){q[e]=new R(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){q[e]=new R(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){q[e]=new R(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){q[e]=new R(e,5,!1,e.toLowerCase(),null,!1,!1)});var de=/[\-:]([a-z])/g;function fe(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(de,fe);q[n]=new R(n,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(de,fe);q[n]=new R(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(de,fe);q[n]=new R(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){q[e]=new R(e,1,!1,e.toLowerCase(),null,!1,!1)}),q.xlinkHref=new R("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){q[e]=new R(e,1,!1,e.toLowerCase(),null,!0,!0)});function Se(e,n,o,a){var u=q.hasOwnProperty(n)?q[n]:null;(u!==null?u.type!==0:a||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&($(n,o,u,a)&&(o=null),a||u===null?v(n)&&(o===null?e.removeAttribute(n):e.setAttribute(n,""+o)):u.mustUseProperty?e[u.propertyName]=o===null?u.type===3?!1:"":o:(n=u.attributeName,a=u.attributeNamespace,o===null?e.removeAttribute(n):(u=u.type,o=u===3||u===4&&o===!0?"":""+o,a?e.setAttributeNS(a,n,o):e.setAttribute(n,o))))}var J=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Me=Symbol.for("react.element"),Z=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),X=Symbol.for("react.strict_mode"),Ce=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),Ee=Symbol.for("react.context"),ye=Symbol.for("react.forward_ref"),ke=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),Ye=Symbol.for("react.memo"),ae=Symbol.for("react.lazy"),ze=Symbol.for("react.offscreen"),H=Symbol.iterator;function U(e){return e===null||typeof e!="object"?null:(e=H&&e[H]||e["@@iterator"],typeof e=="function"?e:null)}var N=Object.assign,I;function ee(e){if(I===void 0)try{throw Error()}catch(o){var n=o.stack.trim().match(/\n( *(at )?)/);I=n&&n[1]||""}return`
`+I+e}var he=!1;function Le(e,n){if(!e||he)return"";he=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(M){var a=M}Reflect.construct(e,[],n)}else{try{n.call()}catch(M){a=M}e.call(n.prototype)}else{try{throw Error()}catch(M){a=M}e()}}catch(M){if(M&&a&&typeof M.stack=="string"){for(var u=M.stack.split(`
`),h=a.stack.split(`
`),g=u.length-1,b=h.length-1;1<=g&&0<=b&&u[g]!==h[b];)b--;for(;1<=g&&0<=b;g--,b--)if(u[g]!==h[b]){if(g!==1||b!==1)do if(g--,b--,0>b||u[g]!==h[b]){var C=`
`+u[g].replace(" at new "," at ");return e.displayName&&C.includes("<anonymous>")&&(C=C.replace("<anonymous>",e.displayName)),C}while(1<=g&&0<=b);break}}}finally{he=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?ee(e):""}function Ae(e){switch(e.tag){case 5:return ee(e.type);case 16:return ee("Lazy");case 13:return ee("Suspense");case 19:return ee("SuspenseList");case 0:case 2:case 15:return e=Le(e.type,!1),e;case 11:return e=Le(e.type.render,!1),e;case 1:return e=Le(e.type,!0),e;default:return""}}function De(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case A:return"Fragment";case Z:return"Portal";case Ce:return"Profiler";case X:return"StrictMode";case ke:return"Suspense";case ue:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ee:return(e.displayName||"Context")+".Consumer";case P:return(e._context.displayName||"Context")+".Provider";case ye:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ye:return n=e.displayName||null,n!==null?n:De(e.type)||"Memo";case ae:n=e._payload,e=e._init;try{return De(e(n))}catch{}}return null}function xe(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return De(n);case 8:return n===X?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function F(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function W(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function re(e){var n=W(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),a=""+e[n];if(!e.hasOwnProperty(n)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var u=o.get,h=o.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return u.call(this)},set:function(g){a=""+g,h.call(this,g)}}),Object.defineProperty(e,n,{enumerable:o.enumerable}),{getValue:function(){return a},setValue:function(g){a=""+g},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function We(e){e._valueTracker||(e._valueTracker=re(e))}function D(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var o=n.getValue(),a="";return e&&(a=W(e)?e.checked?"true":"false":e.value),e=a,e!==o?(n.setValue(e),!0):!1}function se(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function k(e,n){var o=n.checked;return N({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??e._wrapperState.initialChecked})}function Q(e,n){var o=n.defaultValue==null?"":n.defaultValue,a=n.checked!=null?n.checked:n.defaultChecked;o=F(n.value!=null?n.value:o),e._wrapperState={initialChecked:a,initialValue:o,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function ie(e,n){n=n.checked,n!=null&&Se(e,"checked",n,!1)}function me(e,n){ie(e,n);var o=F(n.value),a=n.type;if(o!=null)a==="number"?(o===0&&e.value===""||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?ne(e,n.type,o):n.hasOwnProperty("defaultValue")&&ne(e,n.type,F(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function S(e,n,o){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var a=n.type;if(!(a!=="submit"&&a!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,o||n===e.value||(e.value=n),e.defaultValue=n}o=e.name,o!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,o!==""&&(e.name=o)}function ne(e,n,o){(n!=="number"||se(e.ownerDocument)!==e)&&(o==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var _e=Array.isArray;function $e(e,n,o,a){if(e=e.options,n){n={};for(var u=0;u<o.length;u++)n["$"+o[u]]=!0;for(o=0;o<e.length;o++)u=n.hasOwnProperty("$"+e[o].value),e[o].selected!==u&&(e[o].selected=u),u&&a&&(e[o].defaultSelected=!0)}else{for(o=""+F(o),n=null,u=0;u<e.length;u++){if(e[u].value===o){e[u].selected=!0,a&&(e[u].defaultSelected=!0);return}n!==null||e[u].disabled||(n=e[u])}n!==null&&(n.selected=!0)}}function Ge(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(r(91));return N({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function B(e,n){var o=n.value;if(o==null){if(o=n.children,n=n.defaultValue,o!=null){if(n!=null)throw Error(r(92));if(_e(o)){if(1<o.length)throw Error(r(93));o=o[0]}n=o}n==null&&(n=""),o=n}e._wrapperState={initialValue:F(o)}}function ce(e,n){var o=F(n.value),a=F(n.defaultValue);o!=null&&(o=""+o,o!==e.value&&(e.value=o),n.defaultValue==null&&e.defaultValue!==o&&(e.defaultValue=o)),a!=null&&(e.defaultValue=""+a)}function we(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function K(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function y(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?K(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var z,le=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,o,a,u){MSApp.execUnsafeLocalFunction(function(){return e(n,o,a,u)})}:e})(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(z=z||document.createElement("div"),z.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=z.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function je(e,n){if(n){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=n;return}}e.textContent=n}var Re={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dt=["Webkit","ms","Moz","O"];Object.keys(Re).forEach(function(e){dt.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),Re[n]=Re[e]})});function ht(e,n,o){return n==null||typeof n=="boolean"||n===""?"":o||typeof n!="number"||n===0||Re.hasOwnProperty(e)&&Re[e]?(""+n).trim():n+"px"}function Dt(e,n){e=e.style;for(var o in n)if(n.hasOwnProperty(o)){var a=o.indexOf("--")===0,u=ht(o,n[o],a);o==="float"&&(o="cssFloat"),a?e.setProperty(o,u):e[o]=u}}var qt=N({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $t(e,n){if(n){if(qt[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(r(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(r(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(r(61))}if(n.style!=null&&typeof n.style!="object")throw Error(r(62))}}function vl(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yl=null;function wl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var bl=null,Pr=null,Dr=null;function ju(e){if(e=Bs(e)){if(typeof bl!="function")throw Error(r(280));var n=e.stateNode;n&&(n=Zo(n),bl(e.stateNode,e.type,n))}}function Su(e){Pr?Dr?Dr.push(e):Dr=[e]:Pr=e}function Eu(){if(Pr){var e=Pr,n=Dr;if(Dr=Pr=null,ju(e),n)for(e=0;e<n.length;e++)ju(n[e])}}function Iu(e,n){return e(n)}function Tu(){}var _l=!1;function Lu(e,n,o){if(_l)return e(n,o);_l=!0;try{return Iu(e,n,o)}finally{_l=!1,(Pr!==null||Dr!==null)&&(Tu(),Eu())}}function bs(e,n){var o=e.stateNode;if(o===null)return null;var a=Zo(o);if(a===null)return null;o=a[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(r(231,n,typeof o));return o}var Nl=!1;if(p)try{var _s={};Object.defineProperty(_s,"passive",{get:function(){Nl=!0}}),window.addEventListener("test",_s,_s),window.removeEventListener("test",_s,_s)}catch{Nl=!1}function em(e,n,o,a,u,h,g,b,C){var M=Array.prototype.slice.call(arguments,3);try{n.apply(o,M)}catch(Y){this.onError(Y)}}var Ns=!1,Lo=null,Mo=!1,kl=null,tm={onError:function(e){Ns=!0,Lo=e}};function nm(e,n,o,a,u,h,g,b,C){Ns=!1,Lo=null,em.apply(tm,arguments)}function rm(e,n,o,a,u,h,g,b,C){if(nm.apply(this,arguments),Ns){if(Ns){var M=Lo;Ns=!1,Lo=null}else throw Error(r(198));Mo||(Mo=!0,kl=M)}}function dr(e){var n=e,o=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(o=n.return),e=n.return;while(e)}return n.tag===3?o:null}function Mu(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function Ru(e){if(dr(e)!==e)throw Error(r(188))}function sm(e){var n=e.alternate;if(!n){if(n=dr(e),n===null)throw Error(r(188));return n!==e?null:e}for(var o=e,a=n;;){var u=o.return;if(u===null)break;var h=u.alternate;if(h===null){if(a=u.return,a!==null){o=a;continue}break}if(u.child===h.child){for(h=u.child;h;){if(h===o)return Ru(u),e;if(h===a)return Ru(u),n;h=h.sibling}throw Error(r(188))}if(o.return!==a.return)o=u,a=h;else{for(var g=!1,b=u.child;b;){if(b===o){g=!0,o=u,a=h;break}if(b===a){g=!0,a=u,o=h;break}b=b.sibling}if(!g){for(b=h.child;b;){if(b===o){g=!0,o=h,a=u;break}if(b===a){g=!0,a=h,o=u;break}b=b.sibling}if(!g)throw Error(r(189))}}if(o.alternate!==a)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?e:n}function Pu(e){return e=sm(e),e!==null?Du(e):null}function Du(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=Du(e);if(n!==null)return n;e=e.sibling}return null}var Ou=t.unstable_scheduleCallback,Au=t.unstable_cancelCallback,om=t.unstable_shouldYield,im=t.unstable_requestPaint,ft=t.unstable_now,lm=t.unstable_getCurrentPriorityLevel,Cl=t.unstable_ImmediatePriority,$u=t.unstable_UserBlockingPriority,Ro=t.unstable_NormalPriority,am=t.unstable_LowPriority,Fu=t.unstable_IdlePriority,Po=null,wn=null;function cm(e){if(wn&&typeof wn.onCommitFiberRoot=="function")try{wn.onCommitFiberRoot(Po,e,void 0,(e.current.flags&128)===128)}catch{}}var cn=Math.clz32?Math.clz32:hm,um=Math.log,dm=Math.LN2;function hm(e){return e>>>=0,e===0?32:31-(um(e)/dm|0)|0}var Do=64,Oo=4194304;function ks(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ao(e,n){var o=e.pendingLanes;if(o===0)return 0;var a=0,u=e.suspendedLanes,h=e.pingedLanes,g=o&268435455;if(g!==0){var b=g&~u;b!==0?a=ks(b):(h&=g,h!==0&&(a=ks(h)))}else g=o&~u,g!==0?a=ks(g):h!==0&&(a=ks(h));if(a===0)return 0;if(n!==0&&n!==a&&(n&u)===0&&(u=a&-a,h=n&-n,u>=h||u===16&&(h&4194240)!==0))return n;if((a&4)!==0&&(a|=o&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=a;0<n;)o=31-cn(n),u=1<<o,a|=e[o],n&=~u;return a}function fm(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pm(e,n){for(var o=e.suspendedLanes,a=e.pingedLanes,u=e.expirationTimes,h=e.pendingLanes;0<h;){var g=31-cn(h),b=1<<g,C=u[g];C===-1?((b&o)===0||(b&a)!==0)&&(u[g]=fm(b,n)):C<=n&&(e.expiredLanes|=b),h&=~b}}function jl(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function zu(){var e=Do;return Do<<=1,(Do&4194240)===0&&(Do=64),e}function Sl(e){for(var n=[],o=0;31>o;o++)n.push(e);return n}function Cs(e,n,o){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-cn(n),e[n]=o}function mm(e,n){var o=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<o;){var u=31-cn(o),h=1<<u;n[u]=0,a[u]=-1,e[u]=-1,o&=~h}}function El(e,n){var o=e.entangledLanes|=n;for(e=e.entanglements;o;){var a=31-cn(o),u=1<<a;u&n|e[a]&n&&(e[a]|=n),o&=~u}}var Ke=0;function Wu(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var Bu,Il,Uu,Hu,Vu,Tl=!1,$o=[],zn=null,Wn=null,Bn=null,js=new Map,Ss=new Map,Un=[],gm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yu(e,n){switch(e){case"focusin":case"focusout":zn=null;break;case"dragenter":case"dragleave":Wn=null;break;case"mouseover":case"mouseout":Bn=null;break;case"pointerover":case"pointerout":js.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ss.delete(n.pointerId)}}function Es(e,n,o,a,u,h){return e===null||e.nativeEvent!==h?(e={blockedOn:n,domEventName:o,eventSystemFlags:a,nativeEvent:h,targetContainers:[u]},n!==null&&(n=Bs(n),n!==null&&Il(n)),e):(e.eventSystemFlags|=a,n=e.targetContainers,u!==null&&n.indexOf(u)===-1&&n.push(u),e)}function xm(e,n,o,a,u){switch(n){case"focusin":return zn=Es(zn,e,n,o,a,u),!0;case"dragenter":return Wn=Es(Wn,e,n,o,a,u),!0;case"mouseover":return Bn=Es(Bn,e,n,o,a,u),!0;case"pointerover":var h=u.pointerId;return js.set(h,Es(js.get(h)||null,e,n,o,a,u)),!0;case"gotpointercapture":return h=u.pointerId,Ss.set(h,Es(Ss.get(h)||null,e,n,o,a,u)),!0}return!1}function Qu(e){var n=hr(e.target);if(n!==null){var o=dr(n);if(o!==null){if(n=o.tag,n===13){if(n=Mu(o),n!==null){e.blockedOn=n,Vu(e.priority,function(){Uu(o)});return}}else if(n===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Fo(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var o=Ml(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(o===null){o=e.nativeEvent;var a=new o.constructor(o.type,o);yl=a,o.target.dispatchEvent(a),yl=null}else return n=Bs(o),n!==null&&Il(n),e.blockedOn=o,!1;n.shift()}return!0}function Gu(e,n,o){Fo(e)&&o.delete(n)}function vm(){Tl=!1,zn!==null&&Fo(zn)&&(zn=null),Wn!==null&&Fo(Wn)&&(Wn=null),Bn!==null&&Fo(Bn)&&(Bn=null),js.forEach(Gu),Ss.forEach(Gu)}function Is(e,n){e.blockedOn===n&&(e.blockedOn=null,Tl||(Tl=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,vm)))}function Ts(e){function n(u){return Is(u,e)}if(0<$o.length){Is($o[0],e);for(var o=1;o<$o.length;o++){var a=$o[o];a.blockedOn===e&&(a.blockedOn=null)}}for(zn!==null&&Is(zn,e),Wn!==null&&Is(Wn,e),Bn!==null&&Is(Bn,e),js.forEach(n),Ss.forEach(n),o=0;o<Un.length;o++)a=Un[o],a.blockedOn===e&&(a.blockedOn=null);for(;0<Un.length&&(o=Un[0],o.blockedOn===null);)Qu(o),o.blockedOn===null&&Un.shift()}var Or=J.ReactCurrentBatchConfig,zo=!0;function ym(e,n,o,a){var u=Ke,h=Or.transition;Or.transition=null;try{Ke=1,Ll(e,n,o,a)}finally{Ke=u,Or.transition=h}}function wm(e,n,o,a){var u=Ke,h=Or.transition;Or.transition=null;try{Ke=4,Ll(e,n,o,a)}finally{Ke=u,Or.transition=h}}function Ll(e,n,o,a){if(zo){var u=Ml(e,n,o,a);if(u===null)ql(e,n,a,Wo,o),Yu(e,a);else if(xm(u,e,n,o,a))a.stopPropagation();else if(Yu(e,a),n&4&&-1<gm.indexOf(e)){for(;u!==null;){var h=Bs(u);if(h!==null&&Bu(h),h=Ml(e,n,o,a),h===null&&ql(e,n,a,Wo,o),h===u)break;u=h}u!==null&&a.stopPropagation()}else ql(e,n,a,null,o)}}var Wo=null;function Ml(e,n,o,a){if(Wo=null,e=wl(a),e=hr(e),e!==null)if(n=dr(e),n===null)e=null;else if(o=n.tag,o===13){if(e=Mu(n),e!==null)return e;e=null}else if(o===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Wo=e,null}function qu(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lm()){case Cl:return 1;case $u:return 4;case Ro:case am:return 16;case Fu:return 536870912;default:return 16}default:return 16}}var Hn=null,Rl=null,Bo=null;function Xu(){if(Bo)return Bo;var e,n=Rl,o=n.length,a,u="value"in Hn?Hn.value:Hn.textContent,h=u.length;for(e=0;e<o&&n[e]===u[e];e++);var g=o-e;for(a=1;a<=g&&n[o-a]===u[h-a];a++);return Bo=u.slice(e,1<a?1-a:void 0)}function Uo(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Ho(){return!0}function Ku(){return!1}function Xt(e){function n(o,a,u,h,g){this._reactName=o,this._targetInst=u,this.type=a,this.nativeEvent=h,this.target=g,this.currentTarget=null;for(var b in e)e.hasOwnProperty(b)&&(o=e[b],this[b]=o?o(h):h[b]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?Ho:Ku,this.isPropagationStopped=Ku,this}return N(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Ho)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Ho)},persist:function(){},isPersistent:Ho}),n}var Ar={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pl=Xt(Ar),Ls=N({},Ar,{view:0,detail:0}),bm=Xt(Ls),Dl,Ol,Ms,Vo=N({},Ls,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$l,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ms&&(Ms&&e.type==="mousemove"?(Dl=e.screenX-Ms.screenX,Ol=e.screenY-Ms.screenY):Ol=Dl=0,Ms=e),Dl)},movementY:function(e){return"movementY"in e?e.movementY:Ol}}),Ju=Xt(Vo),_m=N({},Vo,{dataTransfer:0}),Nm=Xt(_m),km=N({},Ls,{relatedTarget:0}),Al=Xt(km),Cm=N({},Ar,{animationName:0,elapsedTime:0,pseudoElement:0}),jm=Xt(Cm),Sm=N({},Ar,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Em=Xt(Sm),Im=N({},Ar,{data:0}),Zu=Xt(Im),Tm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Mm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rm(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=Mm[e])?!!n[e]:!1}function $l(){return Rm}var Pm=N({},Ls,{key:function(e){if(e.key){var n=Tm[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Uo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Lm[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$l,charCode:function(e){return e.type==="keypress"?Uo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Uo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Dm=Xt(Pm),Om=N({},Vo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ed=Xt(Om),Am=N({},Ls,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$l}),$m=Xt(Am),Fm=N({},Ar,{propertyName:0,elapsedTime:0,pseudoElement:0}),zm=Xt(Fm),Wm=N({},Vo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Bm=Xt(Wm),Um=[9,13,27,32],Fl=p&&"CompositionEvent"in window,Rs=null;p&&"documentMode"in document&&(Rs=document.documentMode);var Hm=p&&"TextEvent"in window&&!Rs,td=p&&(!Fl||Rs&&8<Rs&&11>=Rs),nd=" ",rd=!1;function sd(e,n){switch(e){case"keyup":return Um.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function od(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var $r=!1;function Vm(e,n){switch(e){case"compositionend":return od(n);case"keypress":return n.which!==32?null:(rd=!0,nd);case"textInput":return e=n.data,e===nd&&rd?null:e;default:return null}}function Ym(e,n){if($r)return e==="compositionend"||!Fl&&sd(e,n)?(e=Xu(),Bo=Rl=Hn=null,$r=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return td&&n.locale!=="ko"?null:n.data;default:return null}}var Qm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function id(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!Qm[e.type]:n==="textarea"}function ld(e,n,o,a){Su(a),n=Xo(n,"onChange"),0<n.length&&(o=new Pl("onChange","change",null,o,a),e.push({event:o,listeners:n}))}var Ps=null,Ds=null;function Gm(e){Cd(e,0)}function Yo(e){var n=Ur(e);if(D(n))return e}function qm(e,n){if(e==="change")return n}var ad=!1;if(p){var zl;if(p){var Wl="oninput"in document;if(!Wl){var cd=document.createElement("div");cd.setAttribute("oninput","return;"),Wl=typeof cd.oninput=="function"}zl=Wl}else zl=!1;ad=zl&&(!document.documentMode||9<document.documentMode)}function ud(){Ps&&(Ps.detachEvent("onpropertychange",dd),Ds=Ps=null)}function dd(e){if(e.propertyName==="value"&&Yo(Ds)){var n=[];ld(n,Ds,e,wl(e)),Lu(Gm,n)}}function Xm(e,n,o){e==="focusin"?(ud(),Ps=n,Ds=o,Ps.attachEvent("onpropertychange",dd)):e==="focusout"&&ud()}function Km(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Yo(Ds)}function Jm(e,n){if(e==="click")return Yo(n)}function Zm(e,n){if(e==="input"||e==="change")return Yo(n)}function eg(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var un=typeof Object.is=="function"?Object.is:eg;function Os(e,n){if(un(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var o=Object.keys(e),a=Object.keys(n);if(o.length!==a.length)return!1;for(a=0;a<o.length;a++){var u=o[a];if(!m.call(n,u)||!un(e[u],n[u]))return!1}return!0}function hd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function fd(e,n){var o=hd(e);e=0;for(var a;o;){if(o.nodeType===3){if(a=e+o.textContent.length,e<=n&&a>=n)return{node:o,offset:n-e};e=a}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=hd(o)}}function pd(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?pd(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function md(){for(var e=window,n=se();n instanceof e.HTMLIFrameElement;){try{var o=typeof n.contentWindow.location.href=="string"}catch{o=!1}if(o)e=n.contentWindow;else break;n=se(e.document)}return n}function Bl(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function tg(e){var n=md(),o=e.focusedElem,a=e.selectionRange;if(n!==o&&o&&o.ownerDocument&&pd(o.ownerDocument.documentElement,o)){if(a!==null&&Bl(o)){if(n=a.start,e=a.end,e===void 0&&(e=n),"selectionStart"in o)o.selectionStart=n,o.selectionEnd=Math.min(e,o.value.length);else if(e=(n=o.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var u=o.textContent.length,h=Math.min(a.start,u);a=a.end===void 0?h:Math.min(a.end,u),!e.extend&&h>a&&(u=a,a=h,h=u),u=fd(o,h);var g=fd(o,a);u&&g&&(e.rangeCount!==1||e.anchorNode!==u.node||e.anchorOffset!==u.offset||e.focusNode!==g.node||e.focusOffset!==g.offset)&&(n=n.createRange(),n.setStart(u.node,u.offset),e.removeAllRanges(),h>a?(e.addRange(n),e.extend(g.node,g.offset)):(n.setEnd(g.node,g.offset),e.addRange(n)))}}for(n=[],e=o;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<n.length;o++)e=n[o],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ng=p&&"documentMode"in document&&11>=document.documentMode,Fr=null,Ul=null,As=null,Hl=!1;function gd(e,n,o){var a=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Hl||Fr==null||Fr!==se(a)||(a=Fr,"selectionStart"in a&&Bl(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),As&&Os(As,a)||(As=a,a=Xo(Ul,"onSelect"),0<a.length&&(n=new Pl("onSelect","select",null,n,o),e.push({event:n,listeners:a}),n.target=Fr)))}function Qo(e,n){var o={};return o[e.toLowerCase()]=n.toLowerCase(),o["Webkit"+e]="webkit"+n,o["Moz"+e]="moz"+n,o}var zr={animationend:Qo("Animation","AnimationEnd"),animationiteration:Qo("Animation","AnimationIteration"),animationstart:Qo("Animation","AnimationStart"),transitionend:Qo("Transition","TransitionEnd")},Vl={},xd={};p&&(xd=document.createElement("div").style,"AnimationEvent"in window||(delete zr.animationend.animation,delete zr.animationiteration.animation,delete zr.animationstart.animation),"TransitionEvent"in window||delete zr.transitionend.transition);function Go(e){if(Vl[e])return Vl[e];if(!zr[e])return e;var n=zr[e],o;for(o in n)if(n.hasOwnProperty(o)&&o in xd)return Vl[e]=n[o];return e}var vd=Go("animationend"),yd=Go("animationiteration"),wd=Go("animationstart"),bd=Go("transitionend"),_d=new Map,Nd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vn(e,n){_d.set(e,n),d(n,[e])}for(var Yl=0;Yl<Nd.length;Yl++){var Ql=Nd[Yl],rg=Ql.toLowerCase(),sg=Ql[0].toUpperCase()+Ql.slice(1);Vn(rg,"on"+sg)}Vn(vd,"onAnimationEnd"),Vn(yd,"onAnimationIteration"),Vn(wd,"onAnimationStart"),Vn("dblclick","onDoubleClick"),Vn("focusin","onFocus"),Vn("focusout","onBlur"),Vn(bd,"onTransitionEnd"),f("onMouseEnter",["mouseout","mouseover"]),f("onMouseLeave",["mouseout","mouseover"]),f("onPointerEnter",["pointerout","pointerover"]),f("onPointerLeave",["pointerout","pointerover"]),d("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),d("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),d("onBeforeInput",["compositionend","keypress","textInput","paste"]),d("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $s="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),og=new Set("cancel close invalid load scroll toggle".split(" ").concat($s));function kd(e,n,o){var a=e.type||"unknown-event";e.currentTarget=o,rm(a,n,void 0,e),e.currentTarget=null}function Cd(e,n){n=(n&4)!==0;for(var o=0;o<e.length;o++){var a=e[o],u=a.event;a=a.listeners;e:{var h=void 0;if(n)for(var g=a.length-1;0<=g;g--){var b=a[g],C=b.instance,M=b.currentTarget;if(b=b.listener,C!==h&&u.isPropagationStopped())break e;kd(u,b,M),h=C}else for(g=0;g<a.length;g++){if(b=a[g],C=b.instance,M=b.currentTarget,b=b.listener,C!==h&&u.isPropagationStopped())break e;kd(u,b,M),h=C}}}if(Mo)throw e=kl,Mo=!1,kl=null,e}function nt(e,n){var o=n[ta];o===void 0&&(o=n[ta]=new Set);var a=e+"__bubble";o.has(a)||(jd(n,e,2,!1),o.add(a))}function Gl(e,n,o){var a=0;n&&(a|=4),jd(o,e,a,n)}var qo="_reactListening"+Math.random().toString(36).slice(2);function Fs(e){if(!e[qo]){e[qo]=!0,i.forEach(function(o){o!=="selectionchange"&&(og.has(o)||Gl(o,!1,e),Gl(o,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[qo]||(n[qo]=!0,Gl("selectionchange",!1,n))}}function jd(e,n,o,a){switch(qu(n)){case 1:var u=ym;break;case 4:u=wm;break;default:u=Ll}o=u.bind(null,n,o,e),u=void 0,!Nl||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(u=!0),a?u!==void 0?e.addEventListener(n,o,{capture:!0,passive:u}):e.addEventListener(n,o,!0):u!==void 0?e.addEventListener(n,o,{passive:u}):e.addEventListener(n,o,!1)}function ql(e,n,o,a,u){var h=a;if((n&1)===0&&(n&2)===0&&a!==null)e:for(;;){if(a===null)return;var g=a.tag;if(g===3||g===4){var b=a.stateNode.containerInfo;if(b===u||b.nodeType===8&&b.parentNode===u)break;if(g===4)for(g=a.return;g!==null;){var C=g.tag;if((C===3||C===4)&&(C=g.stateNode.containerInfo,C===u||C.nodeType===8&&C.parentNode===u))return;g=g.return}for(;b!==null;){if(g=hr(b),g===null)return;if(C=g.tag,C===5||C===6){a=h=g;continue e}b=b.parentNode}}a=a.return}Lu(function(){var M=h,Y=wl(o),G=[];e:{var V=_d.get(e);if(V!==void 0){var pe=Pl,ve=e;switch(e){case"keypress":if(Uo(o)===0)break e;case"keydown":case"keyup":pe=Dm;break;case"focusin":ve="focus",pe=Al;break;case"focusout":ve="blur",pe=Al;break;case"beforeblur":case"afterblur":pe=Al;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pe=Ju;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pe=Nm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pe=$m;break;case vd:case yd:case wd:pe=jm;break;case bd:pe=zm;break;case"scroll":pe=bm;break;case"wheel":pe=Bm;break;case"copy":case"cut":case"paste":pe=Em;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pe=ed}var be=(n&4)!==0,pt=!be&&e==="scroll",T=be?V!==null?V+"Capture":null:V;be=[];for(var E=M,L;E!==null;){L=E;var te=L.stateNode;if(L.tag===5&&te!==null&&(L=te,T!==null&&(te=bs(E,T),te!=null&&be.push(zs(E,te,L)))),pt)break;E=E.return}0<be.length&&(V=new pe(V,ve,null,o,Y),G.push({event:V,listeners:be}))}}if((n&7)===0){e:{if(V=e==="mouseover"||e==="pointerover",pe=e==="mouseout"||e==="pointerout",V&&o!==yl&&(ve=o.relatedTarget||o.fromElement)&&(hr(ve)||ve[Cn]))break e;if((pe||V)&&(V=Y.window===Y?Y:(V=Y.ownerDocument)?V.defaultView||V.parentWindow:window,pe?(ve=o.relatedTarget||o.toElement,pe=M,ve=ve?hr(ve):null,ve!==null&&(pt=dr(ve),ve!==pt||ve.tag!==5&&ve.tag!==6)&&(ve=null)):(pe=null,ve=M),pe!==ve)){if(be=Ju,te="onMouseLeave",T="onMouseEnter",E="mouse",(e==="pointerout"||e==="pointerover")&&(be=ed,te="onPointerLeave",T="onPointerEnter",E="pointer"),pt=pe==null?V:Ur(pe),L=ve==null?V:Ur(ve),V=new be(te,E+"leave",pe,o,Y),V.target=pt,V.relatedTarget=L,te=null,hr(Y)===M&&(be=new be(T,E+"enter",ve,o,Y),be.target=L,be.relatedTarget=pt,te=be),pt=te,pe&&ve)t:{for(be=pe,T=ve,E=0,L=be;L;L=Wr(L))E++;for(L=0,te=T;te;te=Wr(te))L++;for(;0<E-L;)be=Wr(be),E--;for(;0<L-E;)T=Wr(T),L--;for(;E--;){if(be===T||T!==null&&be===T.alternate)break t;be=Wr(be),T=Wr(T)}be=null}else be=null;pe!==null&&Sd(G,V,pe,be,!1),ve!==null&&pt!==null&&Sd(G,pt,ve,be,!0)}}e:{if(V=M?Ur(M):window,pe=V.nodeName&&V.nodeName.toLowerCase(),pe==="select"||pe==="input"&&V.type==="file")var Ne=qm;else if(id(V))if(ad)Ne=Zm;else{Ne=Km;var Ie=Xm}else(pe=V.nodeName)&&pe.toLowerCase()==="input"&&(V.type==="checkbox"||V.type==="radio")&&(Ne=Jm);if(Ne&&(Ne=Ne(e,M))){ld(G,Ne,o,Y);break e}Ie&&Ie(e,V,M),e==="focusout"&&(Ie=V._wrapperState)&&Ie.controlled&&V.type==="number"&&ne(V,"number",V.value)}switch(Ie=M?Ur(M):window,e){case"focusin":(id(Ie)||Ie.contentEditable==="true")&&(Fr=Ie,Ul=M,As=null);break;case"focusout":As=Ul=Fr=null;break;case"mousedown":Hl=!0;break;case"contextmenu":case"mouseup":case"dragend":Hl=!1,gd(G,o,Y);break;case"selectionchange":if(ng)break;case"keydown":case"keyup":gd(G,o,Y)}var Te;if(Fl)e:{switch(e){case"compositionstart":var Oe="onCompositionStart";break e;case"compositionend":Oe="onCompositionEnd";break e;case"compositionupdate":Oe="onCompositionUpdate";break e}Oe=void 0}else $r?sd(e,o)&&(Oe="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(Oe="onCompositionStart");Oe&&(td&&o.locale!=="ko"&&($r||Oe!=="onCompositionStart"?Oe==="onCompositionEnd"&&$r&&(Te=Xu()):(Hn=Y,Rl="value"in Hn?Hn.value:Hn.textContent,$r=!0)),Ie=Xo(M,Oe),0<Ie.length&&(Oe=new Zu(Oe,e,null,o,Y),G.push({event:Oe,listeners:Ie}),Te?Oe.data=Te:(Te=od(o),Te!==null&&(Oe.data=Te)))),(Te=Hm?Vm(e,o):Ym(e,o))&&(M=Xo(M,"onBeforeInput"),0<M.length&&(Y=new Zu("onBeforeInput","beforeinput",null,o,Y),G.push({event:Y,listeners:M}),Y.data=Te))}Cd(G,n)})}function zs(e,n,o){return{instance:e,listener:n,currentTarget:o}}function Xo(e,n){for(var o=n+"Capture",a=[];e!==null;){var u=e,h=u.stateNode;u.tag===5&&h!==null&&(u=h,h=bs(e,o),h!=null&&a.unshift(zs(e,h,u)),h=bs(e,n),h!=null&&a.push(zs(e,h,u))),e=e.return}return a}function Wr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Sd(e,n,o,a,u){for(var h=n._reactName,g=[];o!==null&&o!==a;){var b=o,C=b.alternate,M=b.stateNode;if(C!==null&&C===a)break;b.tag===5&&M!==null&&(b=M,u?(C=bs(o,h),C!=null&&g.unshift(zs(o,C,b))):u||(C=bs(o,h),C!=null&&g.push(zs(o,C,b)))),o=o.return}g.length!==0&&e.push({event:n,listeners:g})}var ig=/\r\n?/g,lg=/\u0000|\uFFFD/g;function Ed(e){return(typeof e=="string"?e:""+e).replace(ig,`
`).replace(lg,"")}function Ko(e,n,o){if(n=Ed(n),Ed(e)!==n&&o)throw Error(r(425))}function Jo(){}var Xl=null,Kl=null;function Jl(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Zl=typeof setTimeout=="function"?setTimeout:void 0,ag=typeof clearTimeout=="function"?clearTimeout:void 0,Id=typeof Promise=="function"?Promise:void 0,cg=typeof queueMicrotask=="function"?queueMicrotask:typeof Id<"u"?function(e){return Id.resolve(null).then(e).catch(ug)}:Zl;function ug(e){setTimeout(function(){throw e})}function ea(e,n){var o=n,a=0;do{var u=o.nextSibling;if(e.removeChild(o),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(a===0){e.removeChild(u),Ts(n);return}a--}else o!=="$"&&o!=="$?"&&o!=="$!"||a++;o=u}while(o);Ts(n)}function Yn(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function Td(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(n===0)return e;n--}else o==="/$"&&n++}e=e.previousSibling}return null}var Br=Math.random().toString(36).slice(2),bn="__reactFiber$"+Br,Ws="__reactProps$"+Br,Cn="__reactContainer$"+Br,ta="__reactEvents$"+Br,dg="__reactListeners$"+Br,hg="__reactHandles$"+Br;function hr(e){var n=e[bn];if(n)return n;for(var o=e.parentNode;o;){if(n=o[Cn]||o[bn]){if(o=n.alternate,n.child!==null||o!==null&&o.child!==null)for(e=Td(e);e!==null;){if(o=e[bn])return o;e=Td(e)}return n}e=o,o=e.parentNode}return null}function Bs(e){return e=e[bn]||e[Cn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ur(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(r(33))}function Zo(e){return e[Ws]||null}var na=[],Hr=-1;function Qn(e){return{current:e}}function rt(e){0>Hr||(e.current=na[Hr],na[Hr]=null,Hr--)}function Ze(e,n){Hr++,na[Hr]=e.current,e.current=n}var Gn={},It=Qn(Gn),Ft=Qn(!1),fr=Gn;function Vr(e,n){var o=e.type.contextTypes;if(!o)return Gn;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===n)return a.__reactInternalMemoizedMaskedChildContext;var u={},h;for(h in o)u[h]=n[h];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=u),u}function zt(e){return e=e.childContextTypes,e!=null}function ei(){rt(Ft),rt(It)}function Ld(e,n,o){if(It.current!==Gn)throw Error(r(168));Ze(It,n),Ze(Ft,o)}function Md(e,n,o){var a=e.stateNode;if(n=n.childContextTypes,typeof a.getChildContext!="function")return o;a=a.getChildContext();for(var u in a)if(!(u in n))throw Error(r(108,xe(e)||"Unknown",u));return N({},o,a)}function ti(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Gn,fr=It.current,Ze(It,e),Ze(Ft,Ft.current),!0}function Rd(e,n,o){var a=e.stateNode;if(!a)throw Error(r(169));o?(e=Md(e,n,fr),a.__reactInternalMemoizedMergedChildContext=e,rt(Ft),rt(It),Ze(It,e)):rt(Ft),Ze(Ft,o)}var jn=null,ni=!1,ra=!1;function Pd(e){jn===null?jn=[e]:jn.push(e)}function fg(e){ni=!0,Pd(e)}function qn(){if(!ra&&jn!==null){ra=!0;var e=0,n=Ke;try{var o=jn;for(Ke=1;e<o.length;e++){var a=o[e];do a=a(!0);while(a!==null)}jn=null,ni=!1}catch(u){throw jn!==null&&(jn=jn.slice(e+1)),Ou(Cl,qn),u}finally{Ke=n,ra=!1}}return null}var Yr=[],Qr=0,ri=null,si=0,tn=[],nn=0,pr=null,Sn=1,En="";function mr(e,n){Yr[Qr++]=si,Yr[Qr++]=ri,ri=e,si=n}function Dd(e,n,o){tn[nn++]=Sn,tn[nn++]=En,tn[nn++]=pr,pr=e;var a=Sn;e=En;var u=32-cn(a)-1;a&=~(1<<u),o+=1;var h=32-cn(n)+u;if(30<h){var g=u-u%5;h=(a&(1<<g)-1).toString(32),a>>=g,u-=g,Sn=1<<32-cn(n)+u|o<<u|a,En=h+e}else Sn=1<<h|o<<u|a,En=e}function sa(e){e.return!==null&&(mr(e,1),Dd(e,1,0))}function oa(e){for(;e===ri;)ri=Yr[--Qr],Yr[Qr]=null,si=Yr[--Qr],Yr[Qr]=null;for(;e===pr;)pr=tn[--nn],tn[nn]=null,En=tn[--nn],tn[nn]=null,Sn=tn[--nn],tn[nn]=null}var Kt=null,Jt=null,ot=!1,dn=null;function Od(e,n){var o=ln(5,null,null,0);o.elementType="DELETED",o.stateNode=n,o.return=e,n=e.deletions,n===null?(e.deletions=[o],e.flags|=16):n.push(o)}function Ad(e,n){switch(e.tag){case 5:var o=e.type;return n=n.nodeType!==1||o.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,Kt=e,Jt=Yn(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,Kt=e,Jt=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(o=pr!==null?{id:Sn,overflow:En}:null,e.memoizedState={dehydrated:n,treeContext:o,retryLane:1073741824},o=ln(18,null,null,0),o.stateNode=n,o.return=e,e.child=o,Kt=e,Jt=null,!0):!1;default:return!1}}function ia(e){return(e.mode&1)!==0&&(e.flags&128)===0}function la(e){if(ot){var n=Jt;if(n){var o=n;if(!Ad(e,n)){if(ia(e))throw Error(r(418));n=Yn(o.nextSibling);var a=Kt;n&&Ad(e,n)?Od(a,o):(e.flags=e.flags&-4097|2,ot=!1,Kt=e)}}else{if(ia(e))throw Error(r(418));e.flags=e.flags&-4097|2,ot=!1,Kt=e}}}function $d(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Kt=e}function oi(e){if(e!==Kt)return!1;if(!ot)return $d(e),ot=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!Jl(e.type,e.memoizedProps)),n&&(n=Jt)){if(ia(e))throw Fd(),Error(r(418));for(;n;)Od(e,n),n=Yn(n.nextSibling)}if($d(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(r(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"){if(n===0){Jt=Yn(e.nextSibling);break e}n--}else o!=="$"&&o!=="$!"&&o!=="$?"||n++}e=e.nextSibling}Jt=null}}else Jt=Kt?Yn(e.stateNode.nextSibling):null;return!0}function Fd(){for(var e=Jt;e;)e=Yn(e.nextSibling)}function Gr(){Jt=Kt=null,ot=!1}function aa(e){dn===null?dn=[e]:dn.push(e)}var pg=J.ReactCurrentBatchConfig;function hn(e,n){if(e&&e.defaultProps){n=N({},n),e=e.defaultProps;for(var o in e)n[o]===void 0&&(n[o]=e[o]);return n}return n}var ii=Qn(null),li=null,qr=null,ca=null;function ua(){ca=qr=li=null}function da(e){var n=ii.current;rt(ii),e._currentValue=n}function ha(e,n,o){for(;e!==null;){var a=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,a!==null&&(a.childLanes|=n)):a!==null&&(a.childLanes&n)!==n&&(a.childLanes|=n),e===o)break;e=e.return}}function Xr(e,n){li=e,ca=qr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&n)!==0&&(Wt=!0),e.firstContext=null)}function rn(e){var n=e._currentValue;if(ca!==e)if(e={context:e,memoizedValue:n,next:null},qr===null){if(li===null)throw Error(r(308));qr=e,li.dependencies={lanes:0,firstContext:e}}else qr=qr.next=e;return n}var gr=null;function fa(e){gr===null?gr=[e]:gr.push(e)}function zd(e,n,o,a){var u=n.interleaved;return u===null?(o.next=o,fa(n)):(o.next=u.next,u.next=o),n.interleaved=o,In(e,a)}function In(e,n){e.lanes|=n;var o=e.alternate;for(o!==null&&(o.lanes|=n),o=e,e=e.return;e!==null;)e.childLanes|=n,o=e.alternate,o!==null&&(o.childLanes|=n),o=e,e=e.return;return o.tag===3?o.stateNode:null}var Xn=!1;function pa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Wd(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Tn(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function Kn(e,n,o){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,(Qe&2)!==0){var u=a.pending;return u===null?n.next=n:(n.next=u.next,u.next=n),a.pending=n,In(e,o)}return u=a.interleaved,u===null?(n.next=n,fa(a)):(n.next=u.next,u.next=n),a.interleaved=n,In(e,o)}function ai(e,n,o){if(n=n.updateQueue,n!==null&&(n=n.shared,(o&4194240)!==0)){var a=n.lanes;a&=e.pendingLanes,o|=a,n.lanes=o,El(e,o)}}function Bd(e,n){var o=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,o===a)){var u=null,h=null;if(o=o.firstBaseUpdate,o!==null){do{var g={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};h===null?u=h=g:h=h.next=g,o=o.next}while(o!==null);h===null?u=h=n:h=h.next=n}else u=h=n;o={baseState:a.baseState,firstBaseUpdate:u,lastBaseUpdate:h,shared:a.shared,effects:a.effects},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=n:e.next=n,o.lastBaseUpdate=n}function ci(e,n,o,a){var u=e.updateQueue;Xn=!1;var h=u.firstBaseUpdate,g=u.lastBaseUpdate,b=u.shared.pending;if(b!==null){u.shared.pending=null;var C=b,M=C.next;C.next=null,g===null?h=M:g.next=M,g=C;var Y=e.alternate;Y!==null&&(Y=Y.updateQueue,b=Y.lastBaseUpdate,b!==g&&(b===null?Y.firstBaseUpdate=M:b.next=M,Y.lastBaseUpdate=C))}if(h!==null){var G=u.baseState;g=0,Y=M=C=null,b=h;do{var V=b.lane,pe=b.eventTime;if((a&V)===V){Y!==null&&(Y=Y.next={eventTime:pe,lane:0,tag:b.tag,payload:b.payload,callback:b.callback,next:null});e:{var ve=e,be=b;switch(V=n,pe=o,be.tag){case 1:if(ve=be.payload,typeof ve=="function"){G=ve.call(pe,G,V);break e}G=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=be.payload,V=typeof ve=="function"?ve.call(pe,G,V):ve,V==null)break e;G=N({},G,V);break e;case 2:Xn=!0}}b.callback!==null&&b.lane!==0&&(e.flags|=64,V=u.effects,V===null?u.effects=[b]:V.push(b))}else pe={eventTime:pe,lane:V,tag:b.tag,payload:b.payload,callback:b.callback,next:null},Y===null?(M=Y=pe,C=G):Y=Y.next=pe,g|=V;if(b=b.next,b===null){if(b=u.shared.pending,b===null)break;V=b,b=V.next,V.next=null,u.lastBaseUpdate=V,u.shared.pending=null}}while(!0);if(Y===null&&(C=G),u.baseState=C,u.firstBaseUpdate=M,u.lastBaseUpdate=Y,n=u.shared.interleaved,n!==null){u=n;do g|=u.lane,u=u.next;while(u!==n)}else h===null&&(u.shared.lanes=0);yr|=g,e.lanes=g,e.memoizedState=G}}function Ud(e,n,o){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var a=e[n],u=a.callback;if(u!==null){if(a.callback=null,a=o,typeof u!="function")throw Error(r(191,u));u.call(a)}}}var Hd=new s.Component().refs;function ma(e,n,o,a){n=e.memoizedState,o=o(a,n),o=o==null?n:N({},n,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var ui={isMounted:function(e){return(e=e._reactInternals)?dr(e)===e:!1},enqueueSetState:function(e,n,o){e=e._reactInternals;var a=At(),u=tr(e),h=Tn(a,u);h.payload=n,o!=null&&(h.callback=o),n=Kn(e,h,u),n!==null&&(mn(n,e,u,a),ai(n,e,u))},enqueueReplaceState:function(e,n,o){e=e._reactInternals;var a=At(),u=tr(e),h=Tn(a,u);h.tag=1,h.payload=n,o!=null&&(h.callback=o),n=Kn(e,h,u),n!==null&&(mn(n,e,u,a),ai(n,e,u))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var o=At(),a=tr(e),u=Tn(o,a);u.tag=2,n!=null&&(u.callback=n),n=Kn(e,u,a),n!==null&&(mn(n,e,a,o),ai(n,e,a))}};function Vd(e,n,o,a,u,h,g){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,h,g):n.prototype&&n.prototype.isPureReactComponent?!Os(o,a)||!Os(u,h):!0}function Yd(e,n,o){var a=!1,u=Gn,h=n.contextType;return typeof h=="object"&&h!==null?h=rn(h):(u=zt(n)?fr:It.current,a=n.contextTypes,h=(a=a!=null)?Vr(e,u):Gn),n=new n(o,h),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=ui,e.stateNode=n,n._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=u,e.__reactInternalMemoizedMaskedChildContext=h),n}function Qd(e,n,o,a){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(o,a),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(o,a),n.state!==e&&ui.enqueueReplaceState(n,n.state,null)}function ga(e,n,o,a){var u=e.stateNode;u.props=o,u.state=e.memoizedState,u.refs=Hd,pa(e);var h=n.contextType;typeof h=="object"&&h!==null?u.context=rn(h):(h=zt(n)?fr:It.current,u.context=Vr(e,h)),u.state=e.memoizedState,h=n.getDerivedStateFromProps,typeof h=="function"&&(ma(e,n,h,o),u.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(n=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),n!==u.state&&ui.enqueueReplaceState(u,u.state,null),ci(e,o,u,a),u.state=e.memoizedState),typeof u.componentDidMount=="function"&&(e.flags|=4194308)}function Us(e,n,o){if(e=o.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(r(309));var a=o.stateNode}if(!a)throw Error(r(147,e));var u=a,h=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===h?n.ref:(n=function(g){var b=u.refs;b===Hd&&(b=u.refs={}),g===null?delete b[h]:b[h]=g},n._stringRef=h,n)}if(typeof e!="string")throw Error(r(284));if(!o._owner)throw Error(r(290,e))}return e}function di(e,n){throw e=Object.prototype.toString.call(n),Error(r(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function Gd(e){var n=e._init;return n(e._payload)}function qd(e){function n(T,E){if(e){var L=T.deletions;L===null?(T.deletions=[E],T.flags|=16):L.push(E)}}function o(T,E){if(!e)return null;for(;E!==null;)n(T,E),E=E.sibling;return null}function a(T,E){for(T=new Map;E!==null;)E.key!==null?T.set(E.key,E):T.set(E.index,E),E=E.sibling;return T}function u(T,E){return T=rr(T,E),T.index=0,T.sibling=null,T}function h(T,E,L){return T.index=L,e?(L=T.alternate,L!==null?(L=L.index,L<E?(T.flags|=2,E):L):(T.flags|=2,E)):(T.flags|=1048576,E)}function g(T){return e&&T.alternate===null&&(T.flags|=2),T}function b(T,E,L,te){return E===null||E.tag!==6?(E=Za(L,T.mode,te),E.return=T,E):(E=u(E,L),E.return=T,E)}function C(T,E,L,te){var Ne=L.type;return Ne===A?Y(T,E,L.props.children,te,L.key):E!==null&&(E.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===ae&&Gd(Ne)===E.type)?(te=u(E,L.props),te.ref=Us(T,E,L),te.return=T,te):(te=Ti(L.type,L.key,L.props,null,T.mode,te),te.ref=Us(T,E,L),te.return=T,te)}function M(T,E,L,te){return E===null||E.tag!==4||E.stateNode.containerInfo!==L.containerInfo||E.stateNode.implementation!==L.implementation?(E=ec(L,T.mode,te),E.return=T,E):(E=u(E,L.children||[]),E.return=T,E)}function Y(T,E,L,te,Ne){return E===null||E.tag!==7?(E=Nr(L,T.mode,te,Ne),E.return=T,E):(E=u(E,L),E.return=T,E)}function G(T,E,L){if(typeof E=="string"&&E!==""||typeof E=="number")return E=Za(""+E,T.mode,L),E.return=T,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Me:return L=Ti(E.type,E.key,E.props,null,T.mode,L),L.ref=Us(T,null,E),L.return=T,L;case Z:return E=ec(E,T.mode,L),E.return=T,E;case ae:var te=E._init;return G(T,te(E._payload),L)}if(_e(E)||U(E))return E=Nr(E,T.mode,L,null),E.return=T,E;di(T,E)}return null}function V(T,E,L,te){var Ne=E!==null?E.key:null;if(typeof L=="string"&&L!==""||typeof L=="number")return Ne!==null?null:b(T,E,""+L,te);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case Me:return L.key===Ne?C(T,E,L,te):null;case Z:return L.key===Ne?M(T,E,L,te):null;case ae:return Ne=L._init,V(T,E,Ne(L._payload),te)}if(_e(L)||U(L))return Ne!==null?null:Y(T,E,L,te,null);di(T,L)}return null}function pe(T,E,L,te,Ne){if(typeof te=="string"&&te!==""||typeof te=="number")return T=T.get(L)||null,b(E,T,""+te,Ne);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case Me:return T=T.get(te.key===null?L:te.key)||null,C(E,T,te,Ne);case Z:return T=T.get(te.key===null?L:te.key)||null,M(E,T,te,Ne);case ae:var Ie=te._init;return pe(T,E,L,Ie(te._payload),Ne)}if(_e(te)||U(te))return T=T.get(L)||null,Y(E,T,te,Ne,null);di(E,te)}return null}function ve(T,E,L,te){for(var Ne=null,Ie=null,Te=E,Oe=E=0,_t=null;Te!==null&&Oe<L.length;Oe++){Te.index>Oe?(_t=Te,Te=null):_t=Te.sibling;var qe=V(T,Te,L[Oe],te);if(qe===null){Te===null&&(Te=_t);break}e&&Te&&qe.alternate===null&&n(T,Te),E=h(qe,E,Oe),Ie===null?Ne=qe:Ie.sibling=qe,Ie=qe,Te=_t}if(Oe===L.length)return o(T,Te),ot&&mr(T,Oe),Ne;if(Te===null){for(;Oe<L.length;Oe++)Te=G(T,L[Oe],te),Te!==null&&(E=h(Te,E,Oe),Ie===null?Ne=Te:Ie.sibling=Te,Ie=Te);return ot&&mr(T,Oe),Ne}for(Te=a(T,Te);Oe<L.length;Oe++)_t=pe(Te,T,Oe,L[Oe],te),_t!==null&&(e&&_t.alternate!==null&&Te.delete(_t.key===null?Oe:_t.key),E=h(_t,E,Oe),Ie===null?Ne=_t:Ie.sibling=_t,Ie=_t);return e&&Te.forEach(function(sr){return n(T,sr)}),ot&&mr(T,Oe),Ne}function be(T,E,L,te){var Ne=U(L);if(typeof Ne!="function")throw Error(r(150));if(L=Ne.call(L),L==null)throw Error(r(151));for(var Ie=Ne=null,Te=E,Oe=E=0,_t=null,qe=L.next();Te!==null&&!qe.done;Oe++,qe=L.next()){Te.index>Oe?(_t=Te,Te=null):_t=Te.sibling;var sr=V(T,Te,qe.value,te);if(sr===null){Te===null&&(Te=_t);break}e&&Te&&sr.alternate===null&&n(T,Te),E=h(sr,E,Oe),Ie===null?Ne=sr:Ie.sibling=sr,Ie=sr,Te=_t}if(qe.done)return o(T,Te),ot&&mr(T,Oe),Ne;if(Te===null){for(;!qe.done;Oe++,qe=L.next())qe=G(T,qe.value,te),qe!==null&&(E=h(qe,E,Oe),Ie===null?Ne=qe:Ie.sibling=qe,Ie=qe);return ot&&mr(T,Oe),Ne}for(Te=a(T,Te);!qe.done;Oe++,qe=L.next())qe=pe(Te,T,Oe,qe.value,te),qe!==null&&(e&&qe.alternate!==null&&Te.delete(qe.key===null?Oe:qe.key),E=h(qe,E,Oe),Ie===null?Ne=qe:Ie.sibling=qe,Ie=qe);return e&&Te.forEach(function(Qg){return n(T,Qg)}),ot&&mr(T,Oe),Ne}function pt(T,E,L,te){if(typeof L=="object"&&L!==null&&L.type===A&&L.key===null&&(L=L.props.children),typeof L=="object"&&L!==null){switch(L.$$typeof){case Me:e:{for(var Ne=L.key,Ie=E;Ie!==null;){if(Ie.key===Ne){if(Ne=L.type,Ne===A){if(Ie.tag===7){o(T,Ie.sibling),E=u(Ie,L.props.children),E.return=T,T=E;break e}}else if(Ie.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===ae&&Gd(Ne)===Ie.type){o(T,Ie.sibling),E=u(Ie,L.props),E.ref=Us(T,Ie,L),E.return=T,T=E;break e}o(T,Ie);break}else n(T,Ie);Ie=Ie.sibling}L.type===A?(E=Nr(L.props.children,T.mode,te,L.key),E.return=T,T=E):(te=Ti(L.type,L.key,L.props,null,T.mode,te),te.ref=Us(T,E,L),te.return=T,T=te)}return g(T);case Z:e:{for(Ie=L.key;E!==null;){if(E.key===Ie)if(E.tag===4&&E.stateNode.containerInfo===L.containerInfo&&E.stateNode.implementation===L.implementation){o(T,E.sibling),E=u(E,L.children||[]),E.return=T,T=E;break e}else{o(T,E);break}else n(T,E);E=E.sibling}E=ec(L,T.mode,te),E.return=T,T=E}return g(T);case ae:return Ie=L._init,pt(T,E,Ie(L._payload),te)}if(_e(L))return ve(T,E,L,te);if(U(L))return be(T,E,L,te);di(T,L)}return typeof L=="string"&&L!==""||typeof L=="number"?(L=""+L,E!==null&&E.tag===6?(o(T,E.sibling),E=u(E,L),E.return=T,T=E):(o(T,E),E=Za(L,T.mode,te),E.return=T,T=E),g(T)):o(T,E)}return pt}var Kr=qd(!0),Xd=qd(!1),Hs={},_n=Qn(Hs),Vs=Qn(Hs),Ys=Qn(Hs);function xr(e){if(e===Hs)throw Error(r(174));return e}function xa(e,n){switch(Ze(Ys,n),Ze(Vs,e),Ze(_n,Hs),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:y(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=y(n,e)}rt(_n),Ze(_n,n)}function Jr(){rt(_n),rt(Vs),rt(Ys)}function Kd(e){xr(Ys.current);var n=xr(_n.current),o=y(n,e.type);n!==o&&(Ze(Vs,e),Ze(_n,o))}function va(e){Vs.current===e&&(rt(_n),rt(Vs))}var it=Qn(0);function hi(e){for(var n=e;n!==null;){if(n.tag===13){var o=n.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var ya=[];function wa(){for(var e=0;e<ya.length;e++)ya[e]._workInProgressVersionPrimary=null;ya.length=0}var fi=J.ReactCurrentDispatcher,ba=J.ReactCurrentBatchConfig,vr=0,lt=null,xt=null,wt=null,pi=!1,Qs=!1,Gs=0,mg=0;function Tt(){throw Error(r(321))}function _a(e,n){if(n===null)return!1;for(var o=0;o<n.length&&o<e.length;o++)if(!un(e[o],n[o]))return!1;return!0}function Na(e,n,o,a,u,h){if(vr=h,lt=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,fi.current=e===null||e.memoizedState===null?yg:wg,e=o(a,u),Qs){h=0;do{if(Qs=!1,Gs=0,25<=h)throw Error(r(301));h+=1,wt=xt=null,n.updateQueue=null,fi.current=bg,e=o(a,u)}while(Qs)}if(fi.current=xi,n=xt!==null&&xt.next!==null,vr=0,wt=xt=lt=null,pi=!1,n)throw Error(r(300));return e}function ka(){var e=Gs!==0;return Gs=0,e}function Nn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wt===null?lt.memoizedState=wt=e:wt=wt.next=e,wt}function sn(){if(xt===null){var e=lt.alternate;e=e!==null?e.memoizedState:null}else e=xt.next;var n=wt===null?lt.memoizedState:wt.next;if(n!==null)wt=n,xt=e;else{if(e===null)throw Error(r(310));xt=e,e={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},wt===null?lt.memoizedState=wt=e:wt=wt.next=e}return wt}function qs(e,n){return typeof n=="function"?n(e):n}function Ca(e){var n=sn(),o=n.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=e;var a=xt,u=a.baseQueue,h=o.pending;if(h!==null){if(u!==null){var g=u.next;u.next=h.next,h.next=g}a.baseQueue=u=h,o.pending=null}if(u!==null){h=u.next,a=a.baseState;var b=g=null,C=null,M=h;do{var Y=M.lane;if((vr&Y)===Y)C!==null&&(C=C.next={lane:0,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null}),a=M.hasEagerState?M.eagerState:e(a,M.action);else{var G={lane:Y,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null};C===null?(b=C=G,g=a):C=C.next=G,lt.lanes|=Y,yr|=Y}M=M.next}while(M!==null&&M!==h);C===null?g=a:C.next=b,un(a,n.memoizedState)||(Wt=!0),n.memoizedState=a,n.baseState=g,n.baseQueue=C,o.lastRenderedState=a}if(e=o.interleaved,e!==null){u=e;do h=u.lane,lt.lanes|=h,yr|=h,u=u.next;while(u!==e)}else u===null&&(o.lanes=0);return[n.memoizedState,o.dispatch]}function ja(e){var n=sn(),o=n.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=e;var a=o.dispatch,u=o.pending,h=n.memoizedState;if(u!==null){o.pending=null;var g=u=u.next;do h=e(h,g.action),g=g.next;while(g!==u);un(h,n.memoizedState)||(Wt=!0),n.memoizedState=h,n.baseQueue===null&&(n.baseState=h),o.lastRenderedState=h}return[h,a]}function Jd(){}function Zd(e,n){var o=lt,a=sn(),u=n(),h=!un(a.memoizedState,u);if(h&&(a.memoizedState=u,Wt=!0),a=a.queue,Sa(nh.bind(null,o,a,e),[e]),a.getSnapshot!==n||h||wt!==null&&wt.memoizedState.tag&1){if(o.flags|=2048,Xs(9,th.bind(null,o,a,u,n),void 0,null),bt===null)throw Error(r(349));(vr&30)!==0||eh(o,n,u)}return u}function eh(e,n,o){e.flags|=16384,e={getSnapshot:n,value:o},n=lt.updateQueue,n===null?(n={lastEffect:null,stores:null},lt.updateQueue=n,n.stores=[e]):(o=n.stores,o===null?n.stores=[e]:o.push(e))}function th(e,n,o,a){n.value=o,n.getSnapshot=a,rh(n)&&sh(e)}function nh(e,n,o){return o(function(){rh(n)&&sh(e)})}function rh(e){var n=e.getSnapshot;e=e.value;try{var o=n();return!un(e,o)}catch{return!0}}function sh(e){var n=In(e,1);n!==null&&mn(n,e,1,-1)}function oh(e){var n=Nn();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qs,lastRenderedState:e},n.queue=e,e=e.dispatch=vg.bind(null,lt,e),[n.memoizedState,e]}function Xs(e,n,o,a){return e={tag:e,create:n,destroy:o,deps:a,next:null},n=lt.updateQueue,n===null?(n={lastEffect:null,stores:null},lt.updateQueue=n,n.lastEffect=e.next=e):(o=n.lastEffect,o===null?n.lastEffect=e.next=e:(a=o.next,o.next=e,e.next=a,n.lastEffect=e)),e}function ih(){return sn().memoizedState}function mi(e,n,o,a){var u=Nn();lt.flags|=e,u.memoizedState=Xs(1|n,o,void 0,a===void 0?null:a)}function gi(e,n,o,a){var u=sn();a=a===void 0?null:a;var h=void 0;if(xt!==null){var g=xt.memoizedState;if(h=g.destroy,a!==null&&_a(a,g.deps)){u.memoizedState=Xs(n,o,h,a);return}}lt.flags|=e,u.memoizedState=Xs(1|n,o,h,a)}function lh(e,n){return mi(8390656,8,e,n)}function Sa(e,n){return gi(2048,8,e,n)}function ah(e,n){return gi(4,2,e,n)}function ch(e,n){return gi(4,4,e,n)}function uh(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function dh(e,n,o){return o=o!=null?o.concat([e]):null,gi(4,4,uh.bind(null,n,e),o)}function Ea(){}function hh(e,n){var o=sn();n=n===void 0?null:n;var a=o.memoizedState;return a!==null&&n!==null&&_a(n,a[1])?a[0]:(o.memoizedState=[e,n],e)}function fh(e,n){var o=sn();n=n===void 0?null:n;var a=o.memoizedState;return a!==null&&n!==null&&_a(n,a[1])?a[0]:(e=e(),o.memoizedState=[e,n],e)}function ph(e,n,o){return(vr&21)===0?(e.baseState&&(e.baseState=!1,Wt=!0),e.memoizedState=o):(un(o,n)||(o=zu(),lt.lanes|=o,yr|=o,e.baseState=!0),n)}function gg(e,n){var o=Ke;Ke=o!==0&&4>o?o:4,e(!0);var a=ba.transition;ba.transition={};try{e(!1),n()}finally{Ke=o,ba.transition=a}}function mh(){return sn().memoizedState}function xg(e,n,o){var a=tr(e);if(o={lane:a,action:o,hasEagerState:!1,eagerState:null,next:null},gh(e))xh(n,o);else if(o=zd(e,n,o,a),o!==null){var u=At();mn(o,e,a,u),vh(o,n,a)}}function vg(e,n,o){var a=tr(e),u={lane:a,action:o,hasEagerState:!1,eagerState:null,next:null};if(gh(e))xh(n,u);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=n.lastRenderedReducer,h!==null))try{var g=n.lastRenderedState,b=h(g,o);if(u.hasEagerState=!0,u.eagerState=b,un(b,g)){var C=n.interleaved;C===null?(u.next=u,fa(n)):(u.next=C.next,C.next=u),n.interleaved=u;return}}catch{}finally{}o=zd(e,n,u,a),o!==null&&(u=At(),mn(o,e,a,u),vh(o,n,a))}}function gh(e){var n=e.alternate;return e===lt||n!==null&&n===lt}function xh(e,n){Qs=pi=!0;var o=e.pending;o===null?n.next=n:(n.next=o.next,o.next=n),e.pending=n}function vh(e,n,o){if((o&4194240)!==0){var a=n.lanes;a&=e.pendingLanes,o|=a,n.lanes=o,El(e,o)}}var xi={readContext:rn,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useInsertionEffect:Tt,useLayoutEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useMutableSource:Tt,useSyncExternalStore:Tt,useId:Tt,unstable_isNewReconciler:!1},yg={readContext:rn,useCallback:function(e,n){return Nn().memoizedState=[e,n===void 0?null:n],e},useContext:rn,useEffect:lh,useImperativeHandle:function(e,n,o){return o=o!=null?o.concat([e]):null,mi(4194308,4,uh.bind(null,n,e),o)},useLayoutEffect:function(e,n){return mi(4194308,4,e,n)},useInsertionEffect:function(e,n){return mi(4,2,e,n)},useMemo:function(e,n){var o=Nn();return n=n===void 0?null:n,e=e(),o.memoizedState=[e,n],e},useReducer:function(e,n,o){var a=Nn();return n=o!==void 0?o(n):n,a.memoizedState=a.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},a.queue=e,e=e.dispatch=xg.bind(null,lt,e),[a.memoizedState,e]},useRef:function(e){var n=Nn();return e={current:e},n.memoizedState=e},useState:oh,useDebugValue:Ea,useDeferredValue:function(e){return Nn().memoizedState=e},useTransition:function(){var e=oh(!1),n=e[0];return e=gg.bind(null,e[1]),Nn().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,o){var a=lt,u=Nn();if(ot){if(o===void 0)throw Error(r(407));o=o()}else{if(o=n(),bt===null)throw Error(r(349));(vr&30)!==0||eh(a,n,o)}u.memoizedState=o;var h={value:o,getSnapshot:n};return u.queue=h,lh(nh.bind(null,a,h,e),[e]),a.flags|=2048,Xs(9,th.bind(null,a,h,o,n),void 0,null),o},useId:function(){var e=Nn(),n=bt.identifierPrefix;if(ot){var o=En,a=Sn;o=(a&~(1<<32-cn(a)-1)).toString(32)+o,n=":"+n+"R"+o,o=Gs++,0<o&&(n+="H"+o.toString(32)),n+=":"}else o=mg++,n=":"+n+"r"+o.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},wg={readContext:rn,useCallback:hh,useContext:rn,useEffect:Sa,useImperativeHandle:dh,useInsertionEffect:ah,useLayoutEffect:ch,useMemo:fh,useReducer:Ca,useRef:ih,useState:function(){return Ca(qs)},useDebugValue:Ea,useDeferredValue:function(e){var n=sn();return ph(n,xt.memoizedState,e)},useTransition:function(){var e=Ca(qs)[0],n=sn().memoizedState;return[e,n]},useMutableSource:Jd,useSyncExternalStore:Zd,useId:mh,unstable_isNewReconciler:!1},bg={readContext:rn,useCallback:hh,useContext:rn,useEffect:Sa,useImperativeHandle:dh,useInsertionEffect:ah,useLayoutEffect:ch,useMemo:fh,useReducer:ja,useRef:ih,useState:function(){return ja(qs)},useDebugValue:Ea,useDeferredValue:function(e){var n=sn();return xt===null?n.memoizedState=e:ph(n,xt.memoizedState,e)},useTransition:function(){var e=ja(qs)[0],n=sn().memoizedState;return[e,n]},useMutableSource:Jd,useSyncExternalStore:Zd,useId:mh,unstable_isNewReconciler:!1};function Zr(e,n){try{var o="",a=n;do o+=Ae(a),a=a.return;while(a);var u=o}catch(h){u=`
Error generating stack: `+h.message+`
`+h.stack}return{value:e,source:n,stack:u,digest:null}}function Ia(e,n,o){return{value:e,source:null,stack:o??null,digest:n??null}}function Ta(e,n){try{console.error(n.value)}catch(o){setTimeout(function(){throw o})}}var _g=typeof WeakMap=="function"?WeakMap:Map;function yh(e,n,o){o=Tn(-1,o),o.tag=3,o.payload={element:null};var a=n.value;return o.callback=function(){ki||(ki=!0,Va=a),Ta(e,n)},o}function wh(e,n,o){o=Tn(-1,o),o.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var u=n.value;o.payload=function(){return a(u)},o.callback=function(){Ta(e,n)}}var h=e.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(o.callback=function(){Ta(e,n),typeof a!="function"&&(Zn===null?Zn=new Set([this]):Zn.add(this));var g=n.stack;this.componentDidCatch(n.value,{componentStack:g!==null?g:""})}),o}function bh(e,n,o){var a=e.pingCache;if(a===null){a=e.pingCache=new _g;var u=new Set;a.set(n,u)}else u=a.get(n),u===void 0&&(u=new Set,a.set(n,u));u.has(o)||(u.add(o),e=Og.bind(null,e,n,o),n.then(e,e))}function _h(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function Nh(e,n,o,a,u){return(e.mode&1)===0?(e===n?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(n=Tn(-1,1),n.tag=2,Kn(o,n,1))),o.lanes|=1),e):(e.flags|=65536,e.lanes=u,e)}var Ng=J.ReactCurrentOwner,Wt=!1;function Ot(e,n,o,a){n.child=e===null?Xd(n,null,o,a):Kr(n,e.child,o,a)}function kh(e,n,o,a,u){o=o.render;var h=n.ref;return Xr(n,u),a=Na(e,n,o,a,h,u),o=ka(),e!==null&&!Wt?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~u,Ln(e,n,u)):(ot&&o&&sa(n),n.flags|=1,Ot(e,n,a,u),n.child)}function Ch(e,n,o,a,u){if(e===null){var h=o.type;return typeof h=="function"&&!Ja(h)&&h.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(n.tag=15,n.type=h,jh(e,n,h,a,u)):(e=Ti(o.type,null,a,n,n.mode,u),e.ref=n.ref,e.return=n,n.child=e)}if(h=e.child,(e.lanes&u)===0){var g=h.memoizedProps;if(o=o.compare,o=o!==null?o:Os,o(g,a)&&e.ref===n.ref)return Ln(e,n,u)}return n.flags|=1,e=rr(h,a),e.ref=n.ref,e.return=n,n.child=e}function jh(e,n,o,a,u){if(e!==null){var h=e.memoizedProps;if(Os(h,a)&&e.ref===n.ref)if(Wt=!1,n.pendingProps=a=h,(e.lanes&u)!==0)(e.flags&131072)!==0&&(Wt=!0);else return n.lanes=e.lanes,Ln(e,n,u)}return La(e,n,o,a,u)}function Sh(e,n,o){var a=n.pendingProps,u=a.children,h=e!==null?e.memoizedState:null;if(a.mode==="hidden")if((n.mode&1)===0)n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ze(ts,Zt),Zt|=o;else{if((o&1073741824)===0)return e=h!==null?h.baseLanes|o:o,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,Ze(ts,Zt),Zt|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=h!==null?h.baseLanes:o,Ze(ts,Zt),Zt|=a}else h!==null?(a=h.baseLanes|o,n.memoizedState=null):a=o,Ze(ts,Zt),Zt|=a;return Ot(e,n,u,o),n.child}function Eh(e,n){var o=n.ref;(e===null&&o!==null||e!==null&&e.ref!==o)&&(n.flags|=512,n.flags|=2097152)}function La(e,n,o,a,u){var h=zt(o)?fr:It.current;return h=Vr(n,h),Xr(n,u),o=Na(e,n,o,a,h,u),a=ka(),e!==null&&!Wt?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~u,Ln(e,n,u)):(ot&&a&&sa(n),n.flags|=1,Ot(e,n,o,u),n.child)}function Ih(e,n,o,a,u){if(zt(o)){var h=!0;ti(n)}else h=!1;if(Xr(n,u),n.stateNode===null)yi(e,n),Yd(n,o,a),ga(n,o,a,u),a=!0;else if(e===null){var g=n.stateNode,b=n.memoizedProps;g.props=b;var C=g.context,M=o.contextType;typeof M=="object"&&M!==null?M=rn(M):(M=zt(o)?fr:It.current,M=Vr(n,M));var Y=o.getDerivedStateFromProps,G=typeof Y=="function"||typeof g.getSnapshotBeforeUpdate=="function";G||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(b!==a||C!==M)&&Qd(n,g,a,M),Xn=!1;var V=n.memoizedState;g.state=V,ci(n,a,g,u),C=n.memoizedState,b!==a||V!==C||Ft.current||Xn?(typeof Y=="function"&&(ma(n,o,Y,a),C=n.memoizedState),(b=Xn||Vd(n,o,b,a,V,C,M))?(G||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(n.flags|=4194308)):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=a,n.memoizedState=C),g.props=a,g.state=C,g.context=M,a=b):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),a=!1)}else{g=n.stateNode,Wd(e,n),b=n.memoizedProps,M=n.type===n.elementType?b:hn(n.type,b),g.props=M,G=n.pendingProps,V=g.context,C=o.contextType,typeof C=="object"&&C!==null?C=rn(C):(C=zt(o)?fr:It.current,C=Vr(n,C));var pe=o.getDerivedStateFromProps;(Y=typeof pe=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(b!==G||V!==C)&&Qd(n,g,a,C),Xn=!1,V=n.memoizedState,g.state=V,ci(n,a,g,u);var ve=n.memoizedState;b!==G||V!==ve||Ft.current||Xn?(typeof pe=="function"&&(ma(n,o,pe,a),ve=n.memoizedState),(M=Xn||Vd(n,o,M,a,V,ve,C)||!1)?(Y||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(a,ve,C),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(a,ve,C)),typeof g.componentDidUpdate=="function"&&(n.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof g.componentDidUpdate!="function"||b===e.memoizedProps&&V===e.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||b===e.memoizedProps&&V===e.memoizedState||(n.flags|=1024),n.memoizedProps=a,n.memoizedState=ve),g.props=a,g.state=ve,g.context=C,a=M):(typeof g.componentDidUpdate!="function"||b===e.memoizedProps&&V===e.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||b===e.memoizedProps&&V===e.memoizedState||(n.flags|=1024),a=!1)}return Ma(e,n,o,a,h,u)}function Ma(e,n,o,a,u,h){Eh(e,n);var g=(n.flags&128)!==0;if(!a&&!g)return u&&Rd(n,o,!1),Ln(e,n,h);a=n.stateNode,Ng.current=n;var b=g&&typeof o.getDerivedStateFromError!="function"?null:a.render();return n.flags|=1,e!==null&&g?(n.child=Kr(n,e.child,null,h),n.child=Kr(n,null,b,h)):Ot(e,n,b,h),n.memoizedState=a.state,u&&Rd(n,o,!0),n.child}function Th(e){var n=e.stateNode;n.pendingContext?Ld(e,n.pendingContext,n.pendingContext!==n.context):n.context&&Ld(e,n.context,!1),xa(e,n.containerInfo)}function Lh(e,n,o,a,u){return Gr(),aa(u),n.flags|=256,Ot(e,n,o,a),n.child}var Ra={dehydrated:null,treeContext:null,retryLane:0};function Pa(e){return{baseLanes:e,cachePool:null,transitions:null}}function Mh(e,n,o){var a=n.pendingProps,u=it.current,h=!1,g=(n.flags&128)!==0,b;if((b=g)||(b=e!==null&&e.memoizedState===null?!1:(u&2)!==0),b?(h=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(u|=1),Ze(it,u&1),e===null)return la(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((n.mode&1)===0?n.lanes=1:e.data==="$!"?n.lanes=8:n.lanes=1073741824,null):(g=a.children,e=a.fallback,h?(a=n.mode,h=n.child,g={mode:"hidden",children:g},(a&1)===0&&h!==null?(h.childLanes=0,h.pendingProps=g):h=Li(g,a,0,null),e=Nr(e,a,o,null),h.return=n,e.return=n,h.sibling=e,n.child=h,n.child.memoizedState=Pa(o),n.memoizedState=Ra,e):Da(n,g));if(u=e.memoizedState,u!==null&&(b=u.dehydrated,b!==null))return kg(e,n,g,a,b,u,o);if(h){h=a.fallback,g=n.mode,u=e.child,b=u.sibling;var C={mode:"hidden",children:a.children};return(g&1)===0&&n.child!==u?(a=n.child,a.childLanes=0,a.pendingProps=C,n.deletions=null):(a=rr(u,C),a.subtreeFlags=u.subtreeFlags&14680064),b!==null?h=rr(b,h):(h=Nr(h,g,o,null),h.flags|=2),h.return=n,a.return=n,a.sibling=h,n.child=a,a=h,h=n.child,g=e.child.memoizedState,g=g===null?Pa(o):{baseLanes:g.baseLanes|o,cachePool:null,transitions:g.transitions},h.memoizedState=g,h.childLanes=e.childLanes&~o,n.memoizedState=Ra,a}return h=e.child,e=h.sibling,a=rr(h,{mode:"visible",children:a.children}),(n.mode&1)===0&&(a.lanes=o),a.return=n,a.sibling=null,e!==null&&(o=n.deletions,o===null?(n.deletions=[e],n.flags|=16):o.push(e)),n.child=a,n.memoizedState=null,a}function Da(e,n){return n=Li({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function vi(e,n,o,a){return a!==null&&aa(a),Kr(n,e.child,null,o),e=Da(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function kg(e,n,o,a,u,h,g){if(o)return n.flags&256?(n.flags&=-257,a=Ia(Error(r(422))),vi(e,n,g,a)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(h=a.fallback,u=n.mode,a=Li({mode:"visible",children:a.children},u,0,null),h=Nr(h,u,g,null),h.flags|=2,a.return=n,h.return=n,a.sibling=h,n.child=a,(n.mode&1)!==0&&Kr(n,e.child,null,g),n.child.memoizedState=Pa(g),n.memoizedState=Ra,h);if((n.mode&1)===0)return vi(e,n,g,null);if(u.data==="$!"){if(a=u.nextSibling&&u.nextSibling.dataset,a)var b=a.dgst;return a=b,h=Error(r(419)),a=Ia(h,a,void 0),vi(e,n,g,a)}if(b=(g&e.childLanes)!==0,Wt||b){if(a=bt,a!==null){switch(g&-g){case 4:u=2;break;case 16:u=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:u=32;break;case 536870912:u=268435456;break;default:u=0}u=(u&(a.suspendedLanes|g))!==0?0:u,u!==0&&u!==h.retryLane&&(h.retryLane=u,In(e,u),mn(a,e,u,-1))}return Ka(),a=Ia(Error(r(421))),vi(e,n,g,a)}return u.data==="$?"?(n.flags|=128,n.child=e.child,n=Ag.bind(null,e),u._reactRetry=n,null):(e=h.treeContext,Jt=Yn(u.nextSibling),Kt=n,ot=!0,dn=null,e!==null&&(tn[nn++]=Sn,tn[nn++]=En,tn[nn++]=pr,Sn=e.id,En=e.overflow,pr=n),n=Da(n,a.children),n.flags|=4096,n)}function Rh(e,n,o){e.lanes|=n;var a=e.alternate;a!==null&&(a.lanes|=n),ha(e.return,n,o)}function Oa(e,n,o,a,u){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:a,tail:o,tailMode:u}:(h.isBackwards=n,h.rendering=null,h.renderingStartTime=0,h.last=a,h.tail=o,h.tailMode=u)}function Ph(e,n,o){var a=n.pendingProps,u=a.revealOrder,h=a.tail;if(Ot(e,n,a.children,o),a=it.current,(a&2)!==0)a=a&1|2,n.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Rh(e,o,n);else if(e.tag===19)Rh(e,o,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(Ze(it,a),(n.mode&1)===0)n.memoizedState=null;else switch(u){case"forwards":for(o=n.child,u=null;o!==null;)e=o.alternate,e!==null&&hi(e)===null&&(u=o),o=o.sibling;o=u,o===null?(u=n.child,n.child=null):(u=o.sibling,o.sibling=null),Oa(n,!1,u,o,h);break;case"backwards":for(o=null,u=n.child,n.child=null;u!==null;){if(e=u.alternate,e!==null&&hi(e)===null){n.child=u;break}e=u.sibling,u.sibling=o,o=u,u=e}Oa(n,!0,o,null,h);break;case"together":Oa(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function yi(e,n){(n.mode&1)===0&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function Ln(e,n,o){if(e!==null&&(n.dependencies=e.dependencies),yr|=n.lanes,(o&n.childLanes)===0)return null;if(e!==null&&n.child!==e.child)throw Error(r(153));if(n.child!==null){for(e=n.child,o=rr(e,e.pendingProps),n.child=o,o.return=n;e.sibling!==null;)e=e.sibling,o=o.sibling=rr(e,e.pendingProps),o.return=n;o.sibling=null}return n.child}function Cg(e,n,o){switch(n.tag){case 3:Th(n),Gr();break;case 5:Kd(n);break;case 1:zt(n.type)&&ti(n);break;case 4:xa(n,n.stateNode.containerInfo);break;case 10:var a=n.type._context,u=n.memoizedProps.value;Ze(ii,a._currentValue),a._currentValue=u;break;case 13:if(a=n.memoizedState,a!==null)return a.dehydrated!==null?(Ze(it,it.current&1),n.flags|=128,null):(o&n.child.childLanes)!==0?Mh(e,n,o):(Ze(it,it.current&1),e=Ln(e,n,o),e!==null?e.sibling:null);Ze(it,it.current&1);break;case 19:if(a=(o&n.childLanes)!==0,(e.flags&128)!==0){if(a)return Ph(e,n,o);n.flags|=128}if(u=n.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),Ze(it,it.current),a)break;return null;case 22:case 23:return n.lanes=0,Sh(e,n,o)}return Ln(e,n,o)}var Dh,Aa,Oh,Ah;Dh=function(e,n){for(var o=n.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},Aa=function(){},Oh=function(e,n,o,a){var u=e.memoizedProps;if(u!==a){e=n.stateNode,xr(_n.current);var h=null;switch(o){case"input":u=k(e,u),a=k(e,a),h=[];break;case"select":u=N({},u,{value:void 0}),a=N({},a,{value:void 0}),h=[];break;case"textarea":u=Ge(e,u),a=Ge(e,a),h=[];break;default:typeof u.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=Jo)}$t(o,a);var g;o=null;for(M in u)if(!a.hasOwnProperty(M)&&u.hasOwnProperty(M)&&u[M]!=null)if(M==="style"){var b=u[M];for(g in b)b.hasOwnProperty(g)&&(o||(o={}),o[g]="")}else M!=="dangerouslySetInnerHTML"&&M!=="children"&&M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&M!=="autoFocus"&&(c.hasOwnProperty(M)?h||(h=[]):(h=h||[]).push(M,null));for(M in a){var C=a[M];if(b=u!=null?u[M]:void 0,a.hasOwnProperty(M)&&C!==b&&(C!=null||b!=null))if(M==="style")if(b){for(g in b)!b.hasOwnProperty(g)||C&&C.hasOwnProperty(g)||(o||(o={}),o[g]="");for(g in C)C.hasOwnProperty(g)&&b[g]!==C[g]&&(o||(o={}),o[g]=C[g])}else o||(h||(h=[]),h.push(M,o)),o=C;else M==="dangerouslySetInnerHTML"?(C=C?C.__html:void 0,b=b?b.__html:void 0,C!=null&&b!==C&&(h=h||[]).push(M,C)):M==="children"?typeof C!="string"&&typeof C!="number"||(h=h||[]).push(M,""+C):M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&(c.hasOwnProperty(M)?(C!=null&&M==="onScroll"&&nt("scroll",e),h||b===C||(h=[])):(h=h||[]).push(M,C))}o&&(h=h||[]).push("style",o);var M=h;(n.updateQueue=M)&&(n.flags|=4)}},Ah=function(e,n,o,a){o!==a&&(n.flags|=4)};function Ks(e,n){if(!ot)switch(e.tailMode){case"hidden":n=e.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var a=null;o!==null;)o.alternate!==null&&(a=o),o=o.sibling;a===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Lt(e){var n=e.alternate!==null&&e.alternate.child===e.child,o=0,a=0;if(n)for(var u=e.child;u!==null;)o|=u.lanes|u.childLanes,a|=u.subtreeFlags&14680064,a|=u.flags&14680064,u.return=e,u=u.sibling;else for(u=e.child;u!==null;)o|=u.lanes|u.childLanes,a|=u.subtreeFlags,a|=u.flags,u.return=e,u=u.sibling;return e.subtreeFlags|=a,e.childLanes=o,n}function jg(e,n,o){var a=n.pendingProps;switch(oa(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Lt(n),null;case 1:return zt(n.type)&&ei(),Lt(n),null;case 3:return a=n.stateNode,Jr(),rt(Ft),rt(It),wa(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(oi(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,dn!==null&&(Ga(dn),dn=null))),Aa(e,n),Lt(n),null;case 5:va(n);var u=xr(Ys.current);if(o=n.type,e!==null&&n.stateNode!=null)Oh(e,n,o,a,u),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!a){if(n.stateNode===null)throw Error(r(166));return Lt(n),null}if(e=xr(_n.current),oi(n)){a=n.stateNode,o=n.type;var h=n.memoizedProps;switch(a[bn]=n,a[Ws]=h,e=(n.mode&1)!==0,o){case"dialog":nt("cancel",a),nt("close",a);break;case"iframe":case"object":case"embed":nt("load",a);break;case"video":case"audio":for(u=0;u<$s.length;u++)nt($s[u],a);break;case"source":nt("error",a);break;case"img":case"image":case"link":nt("error",a),nt("load",a);break;case"details":nt("toggle",a);break;case"input":Q(a,h),nt("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!h.multiple},nt("invalid",a);break;case"textarea":B(a,h),nt("invalid",a)}$t(o,h),u=null;for(var g in h)if(h.hasOwnProperty(g)){var b=h[g];g==="children"?typeof b=="string"?a.textContent!==b&&(h.suppressHydrationWarning!==!0&&Ko(a.textContent,b,e),u=["children",b]):typeof b=="number"&&a.textContent!==""+b&&(h.suppressHydrationWarning!==!0&&Ko(a.textContent,b,e),u=["children",""+b]):c.hasOwnProperty(g)&&b!=null&&g==="onScroll"&&nt("scroll",a)}switch(o){case"input":We(a),S(a,h,!0);break;case"textarea":We(a),we(a);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(a.onclick=Jo)}a=u,n.updateQueue=a,a!==null&&(n.flags|=4)}else{g=u.nodeType===9?u:u.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=K(o)),e==="http://www.w3.org/1999/xhtml"?o==="script"?(e=g.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=g.createElement(o,{is:a.is}):(e=g.createElement(o),o==="select"&&(g=e,a.multiple?g.multiple=!0:a.size&&(g.size=a.size))):e=g.createElementNS(e,o),e[bn]=n,e[Ws]=a,Dh(e,n,!1,!1),n.stateNode=e;e:{switch(g=vl(o,a),o){case"dialog":nt("cancel",e),nt("close",e),u=a;break;case"iframe":case"object":case"embed":nt("load",e),u=a;break;case"video":case"audio":for(u=0;u<$s.length;u++)nt($s[u],e);u=a;break;case"source":nt("error",e),u=a;break;case"img":case"image":case"link":nt("error",e),nt("load",e),u=a;break;case"details":nt("toggle",e),u=a;break;case"input":Q(e,a),u=k(e,a),nt("invalid",e);break;case"option":u=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},u=N({},a,{value:void 0}),nt("invalid",e);break;case"textarea":B(e,a),u=Ge(e,a),nt("invalid",e);break;default:u=a}$t(o,u),b=u;for(h in b)if(b.hasOwnProperty(h)){var C=b[h];h==="style"?Dt(e,C):h==="dangerouslySetInnerHTML"?(C=C?C.__html:void 0,C!=null&&le(e,C)):h==="children"?typeof C=="string"?(o!=="textarea"||C!=="")&&je(e,C):typeof C=="number"&&je(e,""+C):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(c.hasOwnProperty(h)?C!=null&&h==="onScroll"&&nt("scroll",e):C!=null&&Se(e,h,C,g))}switch(o){case"input":We(e),S(e,a,!1);break;case"textarea":We(e),we(e);break;case"option":a.value!=null&&e.setAttribute("value",""+F(a.value));break;case"select":e.multiple=!!a.multiple,h=a.value,h!=null?$e(e,!!a.multiple,h,!1):a.defaultValue!=null&&$e(e,!!a.multiple,a.defaultValue,!0);break;default:typeof u.onClick=="function"&&(e.onclick=Jo)}switch(o){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return Lt(n),null;case 6:if(e&&n.stateNode!=null)Ah(e,n,e.memoizedProps,a);else{if(typeof a!="string"&&n.stateNode===null)throw Error(r(166));if(o=xr(Ys.current),xr(_n.current),oi(n)){if(a=n.stateNode,o=n.memoizedProps,a[bn]=n,(h=a.nodeValue!==o)&&(e=Kt,e!==null))switch(e.tag){case 3:Ko(a.nodeValue,o,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ko(a.nodeValue,o,(e.mode&1)!==0)}h&&(n.flags|=4)}else a=(o.nodeType===9?o:o.ownerDocument).createTextNode(a),a[bn]=n,n.stateNode=a}return Lt(n),null;case 13:if(rt(it),a=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ot&&Jt!==null&&(n.mode&1)!==0&&(n.flags&128)===0)Fd(),Gr(),n.flags|=98560,h=!1;else if(h=oi(n),a!==null&&a.dehydrated!==null){if(e===null){if(!h)throw Error(r(318));if(h=n.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(r(317));h[bn]=n}else Gr(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Lt(n),h=!1}else dn!==null&&(Ga(dn),dn=null),h=!0;if(!h)return n.flags&65536?n:null}return(n.flags&128)!==0?(n.lanes=o,n):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(n.child.flags|=8192,(n.mode&1)!==0&&(e===null||(it.current&1)!==0?vt===0&&(vt=3):Ka())),n.updateQueue!==null&&(n.flags|=4),Lt(n),null);case 4:return Jr(),Aa(e,n),e===null&&Fs(n.stateNode.containerInfo),Lt(n),null;case 10:return da(n.type._context),Lt(n),null;case 17:return zt(n.type)&&ei(),Lt(n),null;case 19:if(rt(it),h=n.memoizedState,h===null)return Lt(n),null;if(a=(n.flags&128)!==0,g=h.rendering,g===null)if(a)Ks(h,!1);else{if(vt!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(g=hi(e),g!==null){for(n.flags|=128,Ks(h,!1),a=g.updateQueue,a!==null&&(n.updateQueue=a,n.flags|=4),n.subtreeFlags=0,a=o,o=n.child;o!==null;)h=o,e=a,h.flags&=14680066,g=h.alternate,g===null?(h.childLanes=0,h.lanes=e,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=g.childLanes,h.lanes=g.lanes,h.child=g.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=g.memoizedProps,h.memoizedState=g.memoizedState,h.updateQueue=g.updateQueue,h.type=g.type,e=g.dependencies,h.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return Ze(it,it.current&1|2),n.child}e=e.sibling}h.tail!==null&&ft()>ns&&(n.flags|=128,a=!0,Ks(h,!1),n.lanes=4194304)}else{if(!a)if(e=hi(g),e!==null){if(n.flags|=128,a=!0,o=e.updateQueue,o!==null&&(n.updateQueue=o,n.flags|=4),Ks(h,!0),h.tail===null&&h.tailMode==="hidden"&&!g.alternate&&!ot)return Lt(n),null}else 2*ft()-h.renderingStartTime>ns&&o!==1073741824&&(n.flags|=128,a=!0,Ks(h,!1),n.lanes=4194304);h.isBackwards?(g.sibling=n.child,n.child=g):(o=h.last,o!==null?o.sibling=g:n.child=g,h.last=g)}return h.tail!==null?(n=h.tail,h.rendering=n,h.tail=n.sibling,h.renderingStartTime=ft(),n.sibling=null,o=it.current,Ze(it,a?o&1|2:o&1),n):(Lt(n),null);case 22:case 23:return Xa(),a=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(n.flags|=8192),a&&(n.mode&1)!==0?(Zt&1073741824)!==0&&(Lt(n),n.subtreeFlags&6&&(n.flags|=8192)):Lt(n),null;case 24:return null;case 25:return null}throw Error(r(156,n.tag))}function Sg(e,n){switch(oa(n),n.tag){case 1:return zt(n.type)&&ei(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Jr(),rt(Ft),rt(It),wa(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 5:return va(n),null;case 13:if(rt(it),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(r(340));Gr()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return rt(it),null;case 4:return Jr(),null;case 10:return da(n.type._context),null;case 22:case 23:return Xa(),null;case 24:return null;default:return null}}var wi=!1,Mt=!1,Eg=typeof WeakSet=="function"?WeakSet:Set,ge=null;function es(e,n){var o=e.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(a){ct(e,n,a)}else o.current=null}function $a(e,n,o){try{o()}catch(a){ct(e,n,a)}}var $h=!1;function Ig(e,n){if(Xl=zo,e=md(),Bl(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var a=o.getSelection&&o.getSelection();if(a&&a.rangeCount!==0){o=a.anchorNode;var u=a.anchorOffset,h=a.focusNode;a=a.focusOffset;try{o.nodeType,h.nodeType}catch{o=null;break e}var g=0,b=-1,C=-1,M=0,Y=0,G=e,V=null;t:for(;;){for(var pe;G!==o||u!==0&&G.nodeType!==3||(b=g+u),G!==h||a!==0&&G.nodeType!==3||(C=g+a),G.nodeType===3&&(g+=G.nodeValue.length),(pe=G.firstChild)!==null;)V=G,G=pe;for(;;){if(G===e)break t;if(V===o&&++M===u&&(b=g),V===h&&++Y===a&&(C=g),(pe=G.nextSibling)!==null)break;G=V,V=G.parentNode}G=pe}o=b===-1||C===-1?null:{start:b,end:C}}else o=null}o=o||{start:0,end:0}}else o=null;for(Kl={focusedElem:e,selectionRange:o},zo=!1,ge=n;ge!==null;)if(n=ge,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,ge=e;else for(;ge!==null;){n=ge;try{var ve=n.alternate;if((n.flags&1024)!==0)switch(n.tag){case 0:case 11:case 15:break;case 1:if(ve!==null){var be=ve.memoizedProps,pt=ve.memoizedState,T=n.stateNode,E=T.getSnapshotBeforeUpdate(n.elementType===n.type?be:hn(n.type,be),pt);T.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var L=n.stateNode.containerInfo;L.nodeType===1?L.textContent="":L.nodeType===9&&L.documentElement&&L.removeChild(L.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(te){ct(n,n.return,te)}if(e=n.sibling,e!==null){e.return=n.return,ge=e;break}ge=n.return}return ve=$h,$h=!1,ve}function Js(e,n,o){var a=n.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var u=a=a.next;do{if((u.tag&e)===e){var h=u.destroy;u.destroy=void 0,h!==void 0&&$a(n,o,h)}u=u.next}while(u!==a)}}function bi(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var o=n=n.next;do{if((o.tag&e)===e){var a=o.create;o.destroy=a()}o=o.next}while(o!==n)}}function Fa(e){var n=e.ref;if(n!==null){var o=e.stateNode;switch(e.tag){case 5:e=o;break;default:e=o}typeof n=="function"?n(e):n.current=e}}function Fh(e){var n=e.alternate;n!==null&&(e.alternate=null,Fh(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[bn],delete n[Ws],delete n[ta],delete n[dg],delete n[hg])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function zh(e){return e.tag===5||e.tag===3||e.tag===4}function Wh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||zh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function za(e,n,o){var a=e.tag;if(a===5||a===6)e=e.stateNode,n?o.nodeType===8?o.parentNode.insertBefore(e,n):o.insertBefore(e,n):(o.nodeType===8?(n=o.parentNode,n.insertBefore(e,o)):(n=o,n.appendChild(e)),o=o._reactRootContainer,o!=null||n.onclick!==null||(n.onclick=Jo));else if(a!==4&&(e=e.child,e!==null))for(za(e,n,o),e=e.sibling;e!==null;)za(e,n,o),e=e.sibling}function Wa(e,n,o){var a=e.tag;if(a===5||a===6)e=e.stateNode,n?o.insertBefore(e,n):o.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(Wa(e,n,o),e=e.sibling;e!==null;)Wa(e,n,o),e=e.sibling}var jt=null,fn=!1;function Jn(e,n,o){for(o=o.child;o!==null;)Bh(e,n,o),o=o.sibling}function Bh(e,n,o){if(wn&&typeof wn.onCommitFiberUnmount=="function")try{wn.onCommitFiberUnmount(Po,o)}catch{}switch(o.tag){case 5:Mt||es(o,n);case 6:var a=jt,u=fn;jt=null,Jn(e,n,o),jt=a,fn=u,jt!==null&&(fn?(e=jt,o=o.stateNode,e.nodeType===8?e.parentNode.removeChild(o):e.removeChild(o)):jt.removeChild(o.stateNode));break;case 18:jt!==null&&(fn?(e=jt,o=o.stateNode,e.nodeType===8?ea(e.parentNode,o):e.nodeType===1&&ea(e,o),Ts(e)):ea(jt,o.stateNode));break;case 4:a=jt,u=fn,jt=o.stateNode.containerInfo,fn=!0,Jn(e,n,o),jt=a,fn=u;break;case 0:case 11:case 14:case 15:if(!Mt&&(a=o.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){u=a=a.next;do{var h=u,g=h.destroy;h=h.tag,g!==void 0&&((h&2)!==0||(h&4)!==0)&&$a(o,n,g),u=u.next}while(u!==a)}Jn(e,n,o);break;case 1:if(!Mt&&(es(o,n),a=o.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=o.memoizedProps,a.state=o.memoizedState,a.componentWillUnmount()}catch(b){ct(o,n,b)}Jn(e,n,o);break;case 21:Jn(e,n,o);break;case 22:o.mode&1?(Mt=(a=Mt)||o.memoizedState!==null,Jn(e,n,o),Mt=a):Jn(e,n,o);break;default:Jn(e,n,o)}}function Uh(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var o=e.stateNode;o===null&&(o=e.stateNode=new Eg),n.forEach(function(a){var u=$g.bind(null,e,a);o.has(a)||(o.add(a),a.then(u,u))})}}function pn(e,n){var o=n.deletions;if(o!==null)for(var a=0;a<o.length;a++){var u=o[a];try{var h=e,g=n,b=g;e:for(;b!==null;){switch(b.tag){case 5:jt=b.stateNode,fn=!1;break e;case 3:jt=b.stateNode.containerInfo,fn=!0;break e;case 4:jt=b.stateNode.containerInfo,fn=!0;break e}b=b.return}if(jt===null)throw Error(r(160));Bh(h,g,u),jt=null,fn=!1;var C=u.alternate;C!==null&&(C.return=null),u.return=null}catch(M){ct(u,n,M)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)Hh(n,e),n=n.sibling}function Hh(e,n){var o=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pn(n,e),kn(e),a&4){try{Js(3,e,e.return),bi(3,e)}catch(be){ct(e,e.return,be)}try{Js(5,e,e.return)}catch(be){ct(e,e.return,be)}}break;case 1:pn(n,e),kn(e),a&512&&o!==null&&es(o,o.return);break;case 5:if(pn(n,e),kn(e),a&512&&o!==null&&es(o,o.return),e.flags&32){var u=e.stateNode;try{je(u,"")}catch(be){ct(e,e.return,be)}}if(a&4&&(u=e.stateNode,u!=null)){var h=e.memoizedProps,g=o!==null?o.memoizedProps:h,b=e.type,C=e.updateQueue;if(e.updateQueue=null,C!==null)try{b==="input"&&h.type==="radio"&&h.name!=null&&ie(u,h),vl(b,g);var M=vl(b,h);for(g=0;g<C.length;g+=2){var Y=C[g],G=C[g+1];Y==="style"?Dt(u,G):Y==="dangerouslySetInnerHTML"?le(u,G):Y==="children"?je(u,G):Se(u,Y,G,M)}switch(b){case"input":me(u,h);break;case"textarea":ce(u,h);break;case"select":var V=u._wrapperState.wasMultiple;u._wrapperState.wasMultiple=!!h.multiple;var pe=h.value;pe!=null?$e(u,!!h.multiple,pe,!1):V!==!!h.multiple&&(h.defaultValue!=null?$e(u,!!h.multiple,h.defaultValue,!0):$e(u,!!h.multiple,h.multiple?[]:"",!1))}u[Ws]=h}catch(be){ct(e,e.return,be)}}break;case 6:if(pn(n,e),kn(e),a&4){if(e.stateNode===null)throw Error(r(162));u=e.stateNode,h=e.memoizedProps;try{u.nodeValue=h}catch(be){ct(e,e.return,be)}}break;case 3:if(pn(n,e),kn(e),a&4&&o!==null&&o.memoizedState.isDehydrated)try{Ts(n.containerInfo)}catch(be){ct(e,e.return,be)}break;case 4:pn(n,e),kn(e);break;case 13:pn(n,e),kn(e),u=e.child,u.flags&8192&&(h=u.memoizedState!==null,u.stateNode.isHidden=h,!h||u.alternate!==null&&u.alternate.memoizedState!==null||(Ha=ft())),a&4&&Uh(e);break;case 22:if(Y=o!==null&&o.memoizedState!==null,e.mode&1?(Mt=(M=Mt)||Y,pn(n,e),Mt=M):pn(n,e),kn(e),a&8192){if(M=e.memoizedState!==null,(e.stateNode.isHidden=M)&&!Y&&(e.mode&1)!==0)for(ge=e,Y=e.child;Y!==null;){for(G=ge=Y;ge!==null;){switch(V=ge,pe=V.child,V.tag){case 0:case 11:case 14:case 15:Js(4,V,V.return);break;case 1:es(V,V.return);var ve=V.stateNode;if(typeof ve.componentWillUnmount=="function"){a=V,o=V.return;try{n=a,ve.props=n.memoizedProps,ve.state=n.memoizedState,ve.componentWillUnmount()}catch(be){ct(a,o,be)}}break;case 5:es(V,V.return);break;case 22:if(V.memoizedState!==null){Qh(G);continue}}pe!==null?(pe.return=V,ge=pe):Qh(G)}Y=Y.sibling}e:for(Y=null,G=e;;){if(G.tag===5){if(Y===null){Y=G;try{u=G.stateNode,M?(h=u.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(b=G.stateNode,C=G.memoizedProps.style,g=C!=null&&C.hasOwnProperty("display")?C.display:null,b.style.display=ht("display",g))}catch(be){ct(e,e.return,be)}}}else if(G.tag===6){if(Y===null)try{G.stateNode.nodeValue=M?"":G.memoizedProps}catch(be){ct(e,e.return,be)}}else if((G.tag!==22&&G.tag!==23||G.memoizedState===null||G===e)&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===e)break e;for(;G.sibling===null;){if(G.return===null||G.return===e)break e;Y===G&&(Y=null),G=G.return}Y===G&&(Y=null),G.sibling.return=G.return,G=G.sibling}}break;case 19:pn(n,e),kn(e),a&4&&Uh(e);break;case 21:break;default:pn(n,e),kn(e)}}function kn(e){var n=e.flags;if(n&2){try{e:{for(var o=e.return;o!==null;){if(zh(o)){var a=o;break e}o=o.return}throw Error(r(160))}switch(a.tag){case 5:var u=a.stateNode;a.flags&32&&(je(u,""),a.flags&=-33);var h=Wh(e);Wa(e,h,u);break;case 3:case 4:var g=a.stateNode.containerInfo,b=Wh(e);za(e,b,g);break;default:throw Error(r(161))}}catch(C){ct(e,e.return,C)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function Tg(e,n,o){ge=e,Vh(e)}function Vh(e,n,o){for(var a=(e.mode&1)!==0;ge!==null;){var u=ge,h=u.child;if(u.tag===22&&a){var g=u.memoizedState!==null||wi;if(!g){var b=u.alternate,C=b!==null&&b.memoizedState!==null||Mt;b=wi;var M=Mt;if(wi=g,(Mt=C)&&!M)for(ge=u;ge!==null;)g=ge,C=g.child,g.tag===22&&g.memoizedState!==null?Gh(u):C!==null?(C.return=g,ge=C):Gh(u);for(;h!==null;)ge=h,Vh(h),h=h.sibling;ge=u,wi=b,Mt=M}Yh(e)}else(u.subtreeFlags&8772)!==0&&h!==null?(h.return=u,ge=h):Yh(e)}}function Yh(e){for(;ge!==null;){var n=ge;if((n.flags&8772)!==0){var o=n.alternate;try{if((n.flags&8772)!==0)switch(n.tag){case 0:case 11:case 15:Mt||bi(5,n);break;case 1:var a=n.stateNode;if(n.flags&4&&!Mt)if(o===null)a.componentDidMount();else{var u=n.elementType===n.type?o.memoizedProps:hn(n.type,o.memoizedProps);a.componentDidUpdate(u,o.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var h=n.updateQueue;h!==null&&Ud(n,h,a);break;case 3:var g=n.updateQueue;if(g!==null){if(o=null,n.child!==null)switch(n.child.tag){case 5:o=n.child.stateNode;break;case 1:o=n.child.stateNode}Ud(n,g,o)}break;case 5:var b=n.stateNode;if(o===null&&n.flags&4){o=b;var C=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":C.autoFocus&&o.focus();break;case"img":C.src&&(o.src=C.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var M=n.alternate;if(M!==null){var Y=M.memoizedState;if(Y!==null){var G=Y.dehydrated;G!==null&&Ts(G)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Mt||n.flags&512&&Fa(n)}catch(V){ct(n,n.return,V)}}if(n===e){ge=null;break}if(o=n.sibling,o!==null){o.return=n.return,ge=o;break}ge=n.return}}function Qh(e){for(;ge!==null;){var n=ge;if(n===e){ge=null;break}var o=n.sibling;if(o!==null){o.return=n.return,ge=o;break}ge=n.return}}function Gh(e){for(;ge!==null;){var n=ge;try{switch(n.tag){case 0:case 11:case 15:var o=n.return;try{bi(4,n)}catch(C){ct(n,o,C)}break;case 1:var a=n.stateNode;if(typeof a.componentDidMount=="function"){var u=n.return;try{a.componentDidMount()}catch(C){ct(n,u,C)}}var h=n.return;try{Fa(n)}catch(C){ct(n,h,C)}break;case 5:var g=n.return;try{Fa(n)}catch(C){ct(n,g,C)}}}catch(C){ct(n,n.return,C)}if(n===e){ge=null;break}var b=n.sibling;if(b!==null){b.return=n.return,ge=b;break}ge=n.return}}var Lg=Math.ceil,_i=J.ReactCurrentDispatcher,Ba=J.ReactCurrentOwner,on=J.ReactCurrentBatchConfig,Qe=0,bt=null,gt=null,St=0,Zt=0,ts=Qn(0),vt=0,Zs=null,yr=0,Ni=0,Ua=0,eo=null,Bt=null,Ha=0,ns=1/0,Mn=null,ki=!1,Va=null,Zn=null,Ci=!1,er=null,ji=0,to=0,Ya=null,Si=-1,Ei=0;function At(){return(Qe&6)!==0?ft():Si!==-1?Si:Si=ft()}function tr(e){return(e.mode&1)===0?1:(Qe&2)!==0&&St!==0?St&-St:pg.transition!==null?(Ei===0&&(Ei=zu()),Ei):(e=Ke,e!==0||(e=window.event,e=e===void 0?16:qu(e.type)),e)}function mn(e,n,o,a){if(50<to)throw to=0,Ya=null,Error(r(185));Cs(e,o,a),((Qe&2)===0||e!==bt)&&(e===bt&&((Qe&2)===0&&(Ni|=o),vt===4&&nr(e,St)),Ut(e,a),o===1&&Qe===0&&(n.mode&1)===0&&(ns=ft()+500,ni&&qn()))}function Ut(e,n){var o=e.callbackNode;pm(e,n);var a=Ao(e,e===bt?St:0);if(a===0)o!==null&&Au(o),e.callbackNode=null,e.callbackPriority=0;else if(n=a&-a,e.callbackPriority!==n){if(o!=null&&Au(o),n===1)e.tag===0?fg(Xh.bind(null,e)):Pd(Xh.bind(null,e)),cg(function(){(Qe&6)===0&&qn()}),o=null;else{switch(Wu(a)){case 1:o=Cl;break;case 4:o=$u;break;case 16:o=Ro;break;case 536870912:o=Fu;break;default:o=Ro}o=sf(o,qh.bind(null,e))}e.callbackPriority=n,e.callbackNode=o}}function qh(e,n){if(Si=-1,Ei=0,(Qe&6)!==0)throw Error(r(327));var o=e.callbackNode;if(rs()&&e.callbackNode!==o)return null;var a=Ao(e,e===bt?St:0);if(a===0)return null;if((a&30)!==0||(a&e.expiredLanes)!==0||n)n=Ii(e,a);else{n=a;var u=Qe;Qe|=2;var h=Jh();(bt!==e||St!==n)&&(Mn=null,ns=ft()+500,br(e,n));do try{Pg();break}catch(b){Kh(e,b)}while(!0);ua(),_i.current=h,Qe=u,gt!==null?n=0:(bt=null,St=0,n=vt)}if(n!==0){if(n===2&&(u=jl(e),u!==0&&(a=u,n=Qa(e,u))),n===1)throw o=Zs,br(e,0),nr(e,a),Ut(e,ft()),o;if(n===6)nr(e,a);else{if(u=e.current.alternate,(a&30)===0&&!Mg(u)&&(n=Ii(e,a),n===2&&(h=jl(e),h!==0&&(a=h,n=Qa(e,h))),n===1))throw o=Zs,br(e,0),nr(e,a),Ut(e,ft()),o;switch(e.finishedWork=u,e.finishedLanes=a,n){case 0:case 1:throw Error(r(345));case 2:_r(e,Bt,Mn);break;case 3:if(nr(e,a),(a&130023424)===a&&(n=Ha+500-ft(),10<n)){if(Ao(e,0)!==0)break;if(u=e.suspendedLanes,(u&a)!==a){At(),e.pingedLanes|=e.suspendedLanes&u;break}e.timeoutHandle=Zl(_r.bind(null,e,Bt,Mn),n);break}_r(e,Bt,Mn);break;case 4:if(nr(e,a),(a&4194240)===a)break;for(n=e.eventTimes,u=-1;0<a;){var g=31-cn(a);h=1<<g,g=n[g],g>u&&(u=g),a&=~h}if(a=u,a=ft()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*Lg(a/1960))-a,10<a){e.timeoutHandle=Zl(_r.bind(null,e,Bt,Mn),a);break}_r(e,Bt,Mn);break;case 5:_r(e,Bt,Mn);break;default:throw Error(r(329))}}}return Ut(e,ft()),e.callbackNode===o?qh.bind(null,e):null}function Qa(e,n){var o=eo;return e.current.memoizedState.isDehydrated&&(br(e,n).flags|=256),e=Ii(e,n),e!==2&&(n=Bt,Bt=o,n!==null&&Ga(n)),e}function Ga(e){Bt===null?Bt=e:Bt.push.apply(Bt,e)}function Mg(e){for(var n=e;;){if(n.flags&16384){var o=n.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var a=0;a<o.length;a++){var u=o[a],h=u.getSnapshot;u=u.value;try{if(!un(h(),u))return!1}catch{return!1}}}if(o=n.child,n.subtreeFlags&16384&&o!==null)o.return=n,n=o;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function nr(e,n){for(n&=~Ua,n&=~Ni,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var o=31-cn(n),a=1<<o;e[o]=-1,n&=~a}}function Xh(e){if((Qe&6)!==0)throw Error(r(327));rs();var n=Ao(e,0);if((n&1)===0)return Ut(e,ft()),null;var o=Ii(e,n);if(e.tag!==0&&o===2){var a=jl(e);a!==0&&(n=a,o=Qa(e,a))}if(o===1)throw o=Zs,br(e,0),nr(e,n),Ut(e,ft()),o;if(o===6)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,_r(e,Bt,Mn),Ut(e,ft()),null}function qa(e,n){var o=Qe;Qe|=1;try{return e(n)}finally{Qe=o,Qe===0&&(ns=ft()+500,ni&&qn())}}function wr(e){er!==null&&er.tag===0&&(Qe&6)===0&&rs();var n=Qe;Qe|=1;var o=on.transition,a=Ke;try{if(on.transition=null,Ke=1,e)return e()}finally{Ke=a,on.transition=o,Qe=n,(Qe&6)===0&&qn()}}function Xa(){Zt=ts.current,rt(ts)}function br(e,n){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(o!==-1&&(e.timeoutHandle=-1,ag(o)),gt!==null)for(o=gt.return;o!==null;){var a=o;switch(oa(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&ei();break;case 3:Jr(),rt(Ft),rt(It),wa();break;case 5:va(a);break;case 4:Jr();break;case 13:rt(it);break;case 19:rt(it);break;case 10:da(a.type._context);break;case 22:case 23:Xa()}o=o.return}if(bt=e,gt=e=rr(e.current,null),St=Zt=n,vt=0,Zs=null,Ua=Ni=yr=0,Bt=eo=null,gr!==null){for(n=0;n<gr.length;n++)if(o=gr[n],a=o.interleaved,a!==null){o.interleaved=null;var u=a.next,h=o.pending;if(h!==null){var g=h.next;h.next=u,a.next=g}o.pending=a}gr=null}return e}function Kh(e,n){do{var o=gt;try{if(ua(),fi.current=xi,pi){for(var a=lt.memoizedState;a!==null;){var u=a.queue;u!==null&&(u.pending=null),a=a.next}pi=!1}if(vr=0,wt=xt=lt=null,Qs=!1,Gs=0,Ba.current=null,o===null||o.return===null){vt=1,Zs=n,gt=null;break}e:{var h=e,g=o.return,b=o,C=n;if(n=St,b.flags|=32768,C!==null&&typeof C=="object"&&typeof C.then=="function"){var M=C,Y=b,G=Y.tag;if((Y.mode&1)===0&&(G===0||G===11||G===15)){var V=Y.alternate;V?(Y.updateQueue=V.updateQueue,Y.memoizedState=V.memoizedState,Y.lanes=V.lanes):(Y.updateQueue=null,Y.memoizedState=null)}var pe=_h(g);if(pe!==null){pe.flags&=-257,Nh(pe,g,b,h,n),pe.mode&1&&bh(h,M,n),n=pe,C=M;var ve=n.updateQueue;if(ve===null){var be=new Set;be.add(C),n.updateQueue=be}else ve.add(C);break e}else{if((n&1)===0){bh(h,M,n),Ka();break e}C=Error(r(426))}}else if(ot&&b.mode&1){var pt=_h(g);if(pt!==null){(pt.flags&65536)===0&&(pt.flags|=256),Nh(pt,g,b,h,n),aa(Zr(C,b));break e}}h=C=Zr(C,b),vt!==4&&(vt=2),eo===null?eo=[h]:eo.push(h),h=g;do{switch(h.tag){case 3:h.flags|=65536,n&=-n,h.lanes|=n;var T=yh(h,C,n);Bd(h,T);break e;case 1:b=C;var E=h.type,L=h.stateNode;if((h.flags&128)===0&&(typeof E.getDerivedStateFromError=="function"||L!==null&&typeof L.componentDidCatch=="function"&&(Zn===null||!Zn.has(L)))){h.flags|=65536,n&=-n,h.lanes|=n;var te=wh(h,b,n);Bd(h,te);break e}}h=h.return}while(h!==null)}ef(o)}catch(Ne){n=Ne,gt===o&&o!==null&&(gt=o=o.return);continue}break}while(!0)}function Jh(){var e=_i.current;return _i.current=xi,e===null?xi:e}function Ka(){(vt===0||vt===3||vt===2)&&(vt=4),bt===null||(yr&268435455)===0&&(Ni&268435455)===0||nr(bt,St)}function Ii(e,n){var o=Qe;Qe|=2;var a=Jh();(bt!==e||St!==n)&&(Mn=null,br(e,n));do try{Rg();break}catch(u){Kh(e,u)}while(!0);if(ua(),Qe=o,_i.current=a,gt!==null)throw Error(r(261));return bt=null,St=0,vt}function Rg(){for(;gt!==null;)Zh(gt)}function Pg(){for(;gt!==null&&!om();)Zh(gt)}function Zh(e){var n=rf(e.alternate,e,Zt);e.memoizedProps=e.pendingProps,n===null?ef(e):gt=n,Ba.current=null}function ef(e){var n=e;do{var o=n.alternate;if(e=n.return,(n.flags&32768)===0){if(o=jg(o,n,Zt),o!==null){gt=o;return}}else{if(o=Sg(o,n),o!==null){o.flags&=32767,gt=o;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{vt=6,gt=null;return}}if(n=n.sibling,n!==null){gt=n;return}gt=n=e}while(n!==null);vt===0&&(vt=5)}function _r(e,n,o){var a=Ke,u=on.transition;try{on.transition=null,Ke=1,Dg(e,n,o,a)}finally{on.transition=u,Ke=a}return null}function Dg(e,n,o,a){do rs();while(er!==null);if((Qe&6)!==0)throw Error(r(327));o=e.finishedWork;var u=e.finishedLanes;if(o===null)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var h=o.lanes|o.childLanes;if(mm(e,h),e===bt&&(gt=bt=null,St=0),(o.subtreeFlags&2064)===0&&(o.flags&2064)===0||Ci||(Ci=!0,sf(Ro,function(){return rs(),null})),h=(o.flags&15990)!==0,(o.subtreeFlags&15990)!==0||h){h=on.transition,on.transition=null;var g=Ke;Ke=1;var b=Qe;Qe|=4,Ba.current=null,Ig(e,o),Hh(o,e),tg(Kl),zo=!!Xl,Kl=Xl=null,e.current=o,Tg(o),im(),Qe=b,Ke=g,on.transition=h}else e.current=o;if(Ci&&(Ci=!1,er=e,ji=u),h=e.pendingLanes,h===0&&(Zn=null),cm(o.stateNode),Ut(e,ft()),n!==null)for(a=e.onRecoverableError,o=0;o<n.length;o++)u=n[o],a(u.value,{componentStack:u.stack,digest:u.digest});if(ki)throw ki=!1,e=Va,Va=null,e;return(ji&1)!==0&&e.tag!==0&&rs(),h=e.pendingLanes,(h&1)!==0?e===Ya?to++:(to=0,Ya=e):to=0,qn(),null}function rs(){if(er!==null){var e=Wu(ji),n=on.transition,o=Ke;try{if(on.transition=null,Ke=16>e?16:e,er===null)var a=!1;else{if(e=er,er=null,ji=0,(Qe&6)!==0)throw Error(r(331));var u=Qe;for(Qe|=4,ge=e.current;ge!==null;){var h=ge,g=h.child;if((ge.flags&16)!==0){var b=h.deletions;if(b!==null){for(var C=0;C<b.length;C++){var M=b[C];for(ge=M;ge!==null;){var Y=ge;switch(Y.tag){case 0:case 11:case 15:Js(8,Y,h)}var G=Y.child;if(G!==null)G.return=Y,ge=G;else for(;ge!==null;){Y=ge;var V=Y.sibling,pe=Y.return;if(Fh(Y),Y===M){ge=null;break}if(V!==null){V.return=pe,ge=V;break}ge=pe}}}var ve=h.alternate;if(ve!==null){var be=ve.child;if(be!==null){ve.child=null;do{var pt=be.sibling;be.sibling=null,be=pt}while(be!==null)}}ge=h}}if((h.subtreeFlags&2064)!==0&&g!==null)g.return=h,ge=g;else e:for(;ge!==null;){if(h=ge,(h.flags&2048)!==0)switch(h.tag){case 0:case 11:case 15:Js(9,h,h.return)}var T=h.sibling;if(T!==null){T.return=h.return,ge=T;break e}ge=h.return}}var E=e.current;for(ge=E;ge!==null;){g=ge;var L=g.child;if((g.subtreeFlags&2064)!==0&&L!==null)L.return=g,ge=L;else e:for(g=E;ge!==null;){if(b=ge,(b.flags&2048)!==0)try{switch(b.tag){case 0:case 11:case 15:bi(9,b)}}catch(Ne){ct(b,b.return,Ne)}if(b===g){ge=null;break e}var te=b.sibling;if(te!==null){te.return=b.return,ge=te;break e}ge=b.return}}if(Qe=u,qn(),wn&&typeof wn.onPostCommitFiberRoot=="function")try{wn.onPostCommitFiberRoot(Po,e)}catch{}a=!0}return a}finally{Ke=o,on.transition=n}}return!1}function tf(e,n,o){n=Zr(o,n),n=yh(e,n,1),e=Kn(e,n,1),n=At(),e!==null&&(Cs(e,1,n),Ut(e,n))}function ct(e,n,o){if(e.tag===3)tf(e,e,o);else for(;n!==null;){if(n.tag===3){tf(n,e,o);break}else if(n.tag===1){var a=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Zn===null||!Zn.has(a))){e=Zr(o,e),e=wh(n,e,1),n=Kn(n,e,1),e=At(),n!==null&&(Cs(n,1,e),Ut(n,e));break}}n=n.return}}function Og(e,n,o){var a=e.pingCache;a!==null&&a.delete(n),n=At(),e.pingedLanes|=e.suspendedLanes&o,bt===e&&(St&o)===o&&(vt===4||vt===3&&(St&130023424)===St&&500>ft()-Ha?br(e,0):Ua|=o),Ut(e,n)}function nf(e,n){n===0&&((e.mode&1)===0?n=1:(n=Oo,Oo<<=1,(Oo&130023424)===0&&(Oo=4194304)));var o=At();e=In(e,n),e!==null&&(Cs(e,n,o),Ut(e,o))}function Ag(e){var n=e.memoizedState,o=0;n!==null&&(o=n.retryLane),nf(e,o)}function $g(e,n){var o=0;switch(e.tag){case 13:var a=e.stateNode,u=e.memoizedState;u!==null&&(o=u.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(r(314))}a!==null&&a.delete(n),nf(e,o)}var rf;rf=function(e,n,o){if(e!==null)if(e.memoizedProps!==n.pendingProps||Ft.current)Wt=!0;else{if((e.lanes&o)===0&&(n.flags&128)===0)return Wt=!1,Cg(e,n,o);Wt=(e.flags&131072)!==0}else Wt=!1,ot&&(n.flags&1048576)!==0&&Dd(n,si,n.index);switch(n.lanes=0,n.tag){case 2:var a=n.type;yi(e,n),e=n.pendingProps;var u=Vr(n,It.current);Xr(n,o),u=Na(null,n,a,e,u,o);var h=ka();return n.flags|=1,typeof u=="object"&&u!==null&&typeof u.render=="function"&&u.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,zt(a)?(h=!0,ti(n)):h=!1,n.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,pa(n),u.updater=ui,n.stateNode=u,u._reactInternals=n,ga(n,a,e,o),n=Ma(null,n,a,!0,h,o)):(n.tag=0,ot&&h&&sa(n),Ot(null,n,u,o),n=n.child),n;case 16:a=n.elementType;e:{switch(yi(e,n),e=n.pendingProps,u=a._init,a=u(a._payload),n.type=a,u=n.tag=zg(a),e=hn(a,e),u){case 0:n=La(null,n,a,e,o);break e;case 1:n=Ih(null,n,a,e,o);break e;case 11:n=kh(null,n,a,e,o);break e;case 14:n=Ch(null,n,a,hn(a.type,e),o);break e}throw Error(r(306,a,""))}return n;case 0:return a=n.type,u=n.pendingProps,u=n.elementType===a?u:hn(a,u),La(e,n,a,u,o);case 1:return a=n.type,u=n.pendingProps,u=n.elementType===a?u:hn(a,u),Ih(e,n,a,u,o);case 3:e:{if(Th(n),e===null)throw Error(r(387));a=n.pendingProps,h=n.memoizedState,u=h.element,Wd(e,n),ci(n,a,null,o);var g=n.memoizedState;if(a=g.element,h.isDehydrated)if(h={element:a,isDehydrated:!1,cache:g.cache,pendingSuspenseBoundaries:g.pendingSuspenseBoundaries,transitions:g.transitions},n.updateQueue.baseState=h,n.memoizedState=h,n.flags&256){u=Zr(Error(r(423)),n),n=Lh(e,n,a,o,u);break e}else if(a!==u){u=Zr(Error(r(424)),n),n=Lh(e,n,a,o,u);break e}else for(Jt=Yn(n.stateNode.containerInfo.firstChild),Kt=n,ot=!0,dn=null,o=Xd(n,null,a,o),n.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Gr(),a===u){n=Ln(e,n,o);break e}Ot(e,n,a,o)}n=n.child}return n;case 5:return Kd(n),e===null&&la(n),a=n.type,u=n.pendingProps,h=e!==null?e.memoizedProps:null,g=u.children,Jl(a,u)?g=null:h!==null&&Jl(a,h)&&(n.flags|=32),Eh(e,n),Ot(e,n,g,o),n.child;case 6:return e===null&&la(n),null;case 13:return Mh(e,n,o);case 4:return xa(n,n.stateNode.containerInfo),a=n.pendingProps,e===null?n.child=Kr(n,null,a,o):Ot(e,n,a,o),n.child;case 11:return a=n.type,u=n.pendingProps,u=n.elementType===a?u:hn(a,u),kh(e,n,a,u,o);case 7:return Ot(e,n,n.pendingProps,o),n.child;case 8:return Ot(e,n,n.pendingProps.children,o),n.child;case 12:return Ot(e,n,n.pendingProps.children,o),n.child;case 10:e:{if(a=n.type._context,u=n.pendingProps,h=n.memoizedProps,g=u.value,Ze(ii,a._currentValue),a._currentValue=g,h!==null)if(un(h.value,g)){if(h.children===u.children&&!Ft.current){n=Ln(e,n,o);break e}}else for(h=n.child,h!==null&&(h.return=n);h!==null;){var b=h.dependencies;if(b!==null){g=h.child;for(var C=b.firstContext;C!==null;){if(C.context===a){if(h.tag===1){C=Tn(-1,o&-o),C.tag=2;var M=h.updateQueue;if(M!==null){M=M.shared;var Y=M.pending;Y===null?C.next=C:(C.next=Y.next,Y.next=C),M.pending=C}}h.lanes|=o,C=h.alternate,C!==null&&(C.lanes|=o),ha(h.return,o,n),b.lanes|=o;break}C=C.next}}else if(h.tag===10)g=h.type===n.type?null:h.child;else if(h.tag===18){if(g=h.return,g===null)throw Error(r(341));g.lanes|=o,b=g.alternate,b!==null&&(b.lanes|=o),ha(g,o,n),g=h.sibling}else g=h.child;if(g!==null)g.return=h;else for(g=h;g!==null;){if(g===n){g=null;break}if(h=g.sibling,h!==null){h.return=g.return,g=h;break}g=g.return}h=g}Ot(e,n,u.children,o),n=n.child}return n;case 9:return u=n.type,a=n.pendingProps.children,Xr(n,o),u=rn(u),a=a(u),n.flags|=1,Ot(e,n,a,o),n.child;case 14:return a=n.type,u=hn(a,n.pendingProps),u=hn(a.type,u),Ch(e,n,a,u,o);case 15:return jh(e,n,n.type,n.pendingProps,o);case 17:return a=n.type,u=n.pendingProps,u=n.elementType===a?u:hn(a,u),yi(e,n),n.tag=1,zt(a)?(e=!0,ti(n)):e=!1,Xr(n,o),Yd(n,a,u),ga(n,a,u,o),Ma(null,n,a,!0,e,o);case 19:return Ph(e,n,o);case 22:return Sh(e,n,o)}throw Error(r(156,n.tag))};function sf(e,n){return Ou(e,n)}function Fg(e,n,o,a){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ln(e,n,o,a){return new Fg(e,n,o,a)}function Ja(e){return e=e.prototype,!(!e||!e.isReactComponent)}function zg(e){if(typeof e=="function")return Ja(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ye)return 11;if(e===Ye)return 14}return 2}function rr(e,n){var o=e.alternate;return o===null?(o=ln(e.tag,n,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=n,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&14680064,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,n=e.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function Ti(e,n,o,a,u,h){var g=2;if(a=e,typeof e=="function")Ja(e)&&(g=1);else if(typeof e=="string")g=5;else e:switch(e){case A:return Nr(o.children,u,h,n);case X:g=8,u|=8;break;case Ce:return e=ln(12,o,n,u|2),e.elementType=Ce,e.lanes=h,e;case ke:return e=ln(13,o,n,u),e.elementType=ke,e.lanes=h,e;case ue:return e=ln(19,o,n,u),e.elementType=ue,e.lanes=h,e;case ze:return Li(o,u,h,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case P:g=10;break e;case Ee:g=9;break e;case ye:g=11;break e;case Ye:g=14;break e;case ae:g=16,a=null;break e}throw Error(r(130,e==null?e:typeof e,""))}return n=ln(g,o,n,u),n.elementType=e,n.type=a,n.lanes=h,n}function Nr(e,n,o,a){return e=ln(7,e,a,n),e.lanes=o,e}function Li(e,n,o,a){return e=ln(22,e,a,n),e.elementType=ze,e.lanes=o,e.stateNode={isHidden:!1},e}function Za(e,n,o){return e=ln(6,e,null,n),e.lanes=o,e}function ec(e,n,o){return n=ln(4,e.children!==null?e.children:[],e.key,n),n.lanes=o,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function Wg(e,n,o,a,u){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sl(0),this.expirationTimes=Sl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sl(0),this.identifierPrefix=a,this.onRecoverableError=u,this.mutableSourceEagerHydrationData=null}function tc(e,n,o,a,u,h,g,b,C){return e=new Wg(e,n,o,b,C),n===1?(n=1,h===!0&&(n|=8)):n=0,h=ln(3,null,null,n),e.current=h,h.stateNode=e,h.memoizedState={element:a,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},pa(h),e}function Bg(e,n,o){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Z,key:a==null?null:""+a,children:e,containerInfo:n,implementation:o}}function of(e){if(!e)return Gn;e=e._reactInternals;e:{if(dr(e)!==e||e.tag!==1)throw Error(r(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(zt(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(r(171))}if(e.tag===1){var o=e.type;if(zt(o))return Md(e,o,n)}return n}function lf(e,n,o,a,u,h,g,b,C){return e=tc(o,a,!0,e,u,h,g,b,C),e.context=of(null),o=e.current,a=At(),u=tr(o),h=Tn(a,u),h.callback=n??null,Kn(o,h,u),e.current.lanes=u,Cs(e,u,a),Ut(e,a),e}function Mi(e,n,o,a){var u=n.current,h=At(),g=tr(u);return o=of(o),n.context===null?n.context=o:n.pendingContext=o,n=Tn(h,g),n.payload={element:e},a=a===void 0?null:a,a!==null&&(n.callback=a),e=Kn(u,n,g),e!==null&&(mn(e,u,g,h),ai(e,u,g)),g}function Ri(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function af(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<n?o:n}}function nc(e,n){af(e,n),(e=e.alternate)&&af(e,n)}function Ug(){return null}var cf=typeof reportError=="function"?reportError:function(e){console.error(e)};function rc(e){this._internalRoot=e}Pi.prototype.render=rc.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(r(409));Mi(e,n,null,null)},Pi.prototype.unmount=rc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;wr(function(){Mi(null,e,null,null)}),n[Cn]=null}};function Pi(e){this._internalRoot=e}Pi.prototype.unstable_scheduleHydration=function(e){if(e){var n=Hu();e={blockedOn:null,target:e,priority:n};for(var o=0;o<Un.length&&n!==0&&n<Un[o].priority;o++);Un.splice(o,0,e),o===0&&Qu(e)}};function sc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Di(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function uf(){}function Hg(e,n,o,a,u){if(u){if(typeof a=="function"){var h=a;a=function(){var M=Ri(g);h.call(M)}}var g=lf(n,a,e,0,null,!1,!1,"",uf);return e._reactRootContainer=g,e[Cn]=g.current,Fs(e.nodeType===8?e.parentNode:e),wr(),g}for(;u=e.lastChild;)e.removeChild(u);if(typeof a=="function"){var b=a;a=function(){var M=Ri(C);b.call(M)}}var C=tc(e,0,!1,null,null,!1,!1,"",uf);return e._reactRootContainer=C,e[Cn]=C.current,Fs(e.nodeType===8?e.parentNode:e),wr(function(){Mi(n,C,o,a)}),C}function Oi(e,n,o,a,u){var h=o._reactRootContainer;if(h){var g=h;if(typeof u=="function"){var b=u;u=function(){var C=Ri(g);b.call(C)}}Mi(n,g,e,u)}else g=Hg(o,n,e,u,a);return Ri(g)}Bu=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var o=ks(n.pendingLanes);o!==0&&(El(n,o|1),Ut(n,ft()),(Qe&6)===0&&(ns=ft()+500,qn()))}break;case 13:wr(function(){var a=In(e,1);if(a!==null){var u=At();mn(a,e,1,u)}}),nc(e,1)}},Il=function(e){if(e.tag===13){var n=In(e,134217728);if(n!==null){var o=At();mn(n,e,134217728,o)}nc(e,134217728)}},Uu=function(e){if(e.tag===13){var n=tr(e),o=In(e,n);if(o!==null){var a=At();mn(o,e,n,a)}nc(e,n)}},Hu=function(){return Ke},Vu=function(e,n){var o=Ke;try{return Ke=e,n()}finally{Ke=o}},bl=function(e,n,o){switch(n){case"input":if(me(e,o),n=o.name,o.type==="radio"&&n!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<o.length;n++){var a=o[n];if(a!==e&&a.form===e.form){var u=Zo(a);if(!u)throw Error(r(90));D(a),me(a,u)}}}break;case"textarea":ce(e,o);break;case"select":n=o.value,n!=null&&$e(e,!!o.multiple,n,!1)}},Iu=qa,Tu=wr;var Vg={usingClientEntryPoint:!1,Events:[Bs,Ur,Zo,Su,Eu,qa]},no={findFiberByHostInstance:hr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Yg={bundleType:no.bundleType,version:no.version,rendererPackageName:no.rendererPackageName,rendererConfig:no.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:J.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Pu(e),e===null?null:e.stateNode},findFiberByHostInstance:no.findFiberByHostInstance||Ug,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ai=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ai.isDisabled&&Ai.supportsFiber)try{Po=Ai.inject(Yg),wn=Ai}catch{}}return Ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Vg,Ht.createPortal=function(e,n){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sc(n))throw Error(r(200));return Bg(e,n,null,o)},Ht.createRoot=function(e,n){if(!sc(e))throw Error(r(299));var o=!1,a="",u=cf;return n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(u=n.onRecoverableError)),n=tc(e,1,!1,null,null,o,!1,a,u),e[Cn]=n.current,Fs(e.nodeType===8?e.parentNode:e),new rc(n)},Ht.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(r(188)):(e=Object.keys(e).join(","),Error(r(268,e)));return e=Pu(n),e=e===null?null:e.stateNode,e},Ht.flushSync=function(e){return wr(e)},Ht.hydrate=function(e,n,o){if(!Di(n))throw Error(r(200));return Oi(null,e,n,!0,o)},Ht.hydrateRoot=function(e,n,o){if(!sc(e))throw Error(r(405));var a=o!=null&&o.hydratedSources||null,u=!1,h="",g=cf;if(o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onRecoverableError!==void 0&&(g=o.onRecoverableError)),n=lf(n,null,e,1,o??null,u,!1,h,g),e[Cn]=n.current,Fs(e),a)for(e=0;e<a.length;e++)o=a[e],u=o._getVersion,u=u(o._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[o,u]:n.mutableSourceEagerHydrationData.push(o,u);return new Pi(n)},Ht.render=function(e,n,o){if(!Di(n))throw Error(r(200));return Oi(null,e,n,!1,o)},Ht.unmountComponentAtNode=function(e){if(!Di(e))throw Error(r(40));return e._reactRootContainer?(wr(function(){Oi(null,null,e,!1,function(){e._reactRootContainer=null,e[Cn]=null})}),!0):!1},Ht.unstable_batchedUpdates=qa,Ht.unstable_renderSubtreeIntoContainer=function(e,n,o,a){if(!Di(o))throw Error(r(200));if(e==null||e._reactInternals===void 0)throw Error(r(38));return Oi(e,n,o,!1,a)},Ht.version="18.2.0-next-9e3b772b8-20220608",Ht}var vf;function ex(){if(vf)return lc.exports;vf=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),lc.exports=Zg(),lc.exports}var yf;function tx(){if(yf)return $i;yf=1;var s=ex();return $i.createRoot=s.createRoot,$i.hydrateRoot=s.hydrateRoot,$i}var nx=tx();const rx=_0(nx),sx=({children:s,activeTab:t,setActiveTab:r,isAdmin:i,onToggleAdmin:c,onDownloadDB:d,onUploadDB:f,onOpenSync:p,isSyncActive:m})=>{const x=O.useRef(null),w=[{id:"characters",label:"",icon:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})},{id:"connections",label:"",icon:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})},{id:"worlds",label:"",icon:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})},{id:"notes",label:"",icon:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})},{id:"admin",label:"",adminOnly:!0,icon:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"})}],_=j=>{var q;const $=(q=j.target.files)==null?void 0:q[0];if(!$)return;const R=new FileReader;R.onload=de=>{var Se;const fe=(Se=de.target)==null?void 0:Se.result;typeof fe=="string"&&f(fe)},R.readAsText($),x.current&&(x.current.value="")},v=()=>t==="notes"||t==="wiki"?"max-w-[1920px] w-full px-4 md:px-8":"max-w-6xl w-full px-4 py-8 md:px-12 md:py-12";return l.jsxs("div",{className:"min-h-screen flex flex-col md:flex-row bg-[#050505] text-stone-300",children:[l.jsxs("div",{className:"md:hidden flex items-center justify-between px-6 py-5 border-b border-stone-900 bg-[#050505]/95 backdrop-blur sticky top-0 z-40",children:[l.jsx("h1",{className:"text-lg font-serif font-bold tracking-[0.2em] text-stone-400 uppercase",children:""}),l.jsx("button",{onClick:c,className:`p-2 rounded-lg transition-all border ${i?"bg-emerald-950/20 border-emerald-900/50 text-emerald-500":"bg-stone-900/50 border-stone-800 text-stone-500"}`,children:l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})]}),l.jsxs("aside",{className:"hidden md:flex w-64 border-r border-stone-900 flex-col fixed h-screen bg-[#050505] z-50",children:[l.jsx("div",{className:"p-8",children:l.jsx("h1",{className:"text-xl font-serif font-bold tracking-[0.2em] text-stone-400 uppercase",children:""})}),l.jsx("nav",{className:"flex-grow px-4 space-y-2",children:w.filter(j=>!j.adminOnly||i).map(j=>l.jsxs("button",{onClick:()=>r(j.id),className:`w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all flex items-center gap-3 ${t===j.id?"bg-stone-900 text-stone-100 border-l-2 border-emerald-500 rounded-l-none":"hover:bg-stone-900/50 text-stone-500 hover:text-stone-300"} ${j.adminOnly?"text-emerald-500/70":""}`,children:[l.jsx("svg",{className:"w-5 h-5 opacity-70",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:j.icon}),j.label]},j.id))}),l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsxs("button",{onClick:p,className:`w-full py-2 px-3 rounded-lg border text-[9px] uppercase tracking-widest font-bold flex items-center justify-center gap-2 transition-all ${m?"bg-emerald-900/10 border-emerald-500/30 text-emerald-500 hover:bg-emerald-900/20":"bg-stone-900/30 border-stone-800 text-stone-600 hover:bg-stone-900/60 hover:text-stone-400"}`,children:[l.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${m?"bg-emerald-500 animate-pulse":"bg-stone-600"}`}),m?"":""]}),l.jsx("button",{onClick:c,className:`w-full py-3 text-[10px] uppercase tracking-widest font-bold rounded-md transition-all border ${i?"bg-emerald-950/20 border-emerald-900/50 text-emerald-500 shadow-lg shadow-emerald-900/10":"bg-stone-900/50 hover:bg-stone-900 border-stone-800 text-stone-400"}`,children:i?" ()":"  "})]})]}),l.jsx("nav",{className:"md:hidden fixed bottom-0 w-full bg-[#050505]/95 backdrop-blur-xl border-t border-stone-900 z-50 px-2 pb-safe-area",children:l.jsxs("div",{className:"flex justify-around items-center",children:[w.filter(j=>!j.adminOnly||i).map(j=>l.jsxs("button",{onClick:()=>r(j.id),className:`flex flex-col items-center justify-center py-3 px-2 w-full transition-all ${t===j.id?"text-emerald-500":"text-stone-600"}`,children:[l.jsx("svg",{className:"w-6 h-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:j.icon}),l.jsx("span",{className:"text-[9px] uppercase font-bold tracking-wider",children:j.label})]},j.id)),l.jsxs("button",{onClick:p,className:`flex flex-col items-center justify-center py-3 px-2 w-full transition-all ${m?"text-emerald-500":"text-stone-700"}`,children:[l.jsx("svg",{className:"w-6 h-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),l.jsx("span",{className:"text-[9px] uppercase font-bold tracking-wider",children:""})]})]})}),l.jsxs("main",{className:"flex-grow md:ml-64 min-h-screen relative pb-24 md:pb-0",children:[l.jsx("div",{className:`${v()} mx-auto transition-all duration-300 py-8 md:py-12`,children:s}),l.jsxs("div",{className:"fixed bottom-24 md:bottom-8 right-4 md:right-8 flex gap-3 z-40 scale-90 md:scale-100 origin-bottom-right",children:[l.jsx("input",{type:"file",ref:x,onChange:_,accept:".json",className:"hidden"}),l.jsx("button",{onClick:()=>{var j;return(j=x.current)==null?void 0:j.click()},className:"px-4 py-2 md:px-5 md:py-2.5 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 rounded-full text-[9px] md:text-[10px] uppercase tracking-widest font-bold text-emerald-500 transition-all backdrop-blur-sm shadow-lg shadow-emerald-900/10",children:" "}),l.jsx("button",{onClick:d,className:"px-4 py-2 md:px-5 md:py-2.5 bg-stone-900/80 hover:bg-stone-800 border border-stone-700 rounded-full text-[9px] md:text-[10px] uppercase tracking-widest font-bold text-stone-300 transition-all backdrop-blur-sm",children:" "})]})]})]})},ox=({character:s,isVisible:t=!0,staggerIndex:r=0,onClick:i})=>{const c=O.useRef(null),[d,f]=O.useState({x:0,y:0}),[p,m]=O.useState({x:50,y:50,opacity:0}),[x,w]=O.useState(!1),[_,v]=O.useState(!1),j=O.useMemo(()=>Array.from({length:8}).map((A,X)=>({id:X,left:`${Math.random()*100}%`,delay:`${Math.random()*.6}s`,duration:`${1+Math.random()}s`,size:`${1.5+Math.random()*2}px`})),[]),$=A=>{if(!c.current||!t)return;const X=c.current.getBoundingClientRect(),Ce=X.left+X.width/2,P=X.top+X.height/2,Ee=-(A.clientY-P)/(X.height/2)*12,ye=(A.clientX-Ce)/(X.width/2)*12,ke=(A.clientX-X.left)/X.width*100,ue=(A.clientY-X.top)/X.height*100;f({x:Ee,y:ye}),m({x:ke,y:ue,opacity:.5})},R=()=>t&&w(!0),q=()=>{f({x:0,y:0}),m(A=>({...A,opacity:0})),w(!1),v(!1)},de={objectFit:"cover",objectPosition:`${s.miniImageX??50}% ${s.miniImageY??50}%`,transformOrigin:`${s.miniImageX??50}% ${s.miniImageY??50}%`,transform:`scale(${s.miniImageScale??1})`},fe=s.name.length,Se=fe>20?"text-sm":fe>15?"text-base":"text-xl",J=x?`${-d.y*2.5}px ${d.x*2.5}px 50px -10px rgba(16, 185, 129, 0.3)`:"0 10px 15px -3px rgba(0, 0, 0, 0.1)",Me=t?`${Math.min(r*45,900)}ms`:"0ms",Z=_?.96:x?1.04:1;return l.jsx("div",{className:`relative mb-10 px-5 w-full sm:w-1/2 lg:w-1/4 perspective-2000 preserve-3d transition-opacity duration-500 ${t?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,style:{animation:t?"reveal-3d-fire 1.1s cubic-bezier(0.22, 1, 0.36, 1) both":"disappear-3d-fire 0.6s cubic-bezier(0.22, 1, 0.36, 1) both",animationDelay:t?Me:"0ms"},children:l.jsxs("div",{className:"h-full relative preserve-3d pointer-events-none",children:[t&&j.map(A=>l.jsx("div",{className:"absolute bottom-4 bg-emerald-400 rounded-full blur-[0.5px] z-0 pointer-events-none",style:{left:A.left,width:A.size,height:A.size,animation:`ember-float ${A.duration} ease-out both`,animationDelay:`calc(${Me} + ${A.delay})`,boxShadow:"0 0 6px #10b981"}},A.id)),l.jsx("div",{className:"absolute inset-0 bg-emerald-500/20 blur-[60px] rounded-full transition-opacity duration-700 pointer-events-none -z-10",style:{opacity:x?.45:0,transform:`translate3d(${-d.y*4}px, ${d.x*4}px, -50px) scale(${x?1.1:1})`}}),l.jsxs("div",{ref:c,onMouseMove:$,onMouseEnter:R,onMouseLeave:q,onMouseDown:()=>t&&v(!0),onMouseUp:()=>v(!1),onClick:()=>t&&i(s.id),style:{transform:`rotateX(${d.x}deg) rotateY(${d.y}deg) scale(${Z})`,boxShadow:J,transition:x&&!_?"transform 0.1s ease-out, box-shadow 0.1s ease-out":"transform 0.7s cubic-bezier(0.23, 1, 0.32, 1), box-shadow 0.7s ease"},className:"relative bg-[#0f0f0f]/80 border border-stone-900 rounded-2xl p-6 flex flex-col items-center group cursor-pointer h-full min-h-[320px] preserve-3d overflow-hidden backdrop-blur-sm pointer-events-auto z-10",children:[l.jsx("div",{className:"absolute inset-0 pointer-events-none z-20 transition-opacity duration-300",style:{background:`radial-gradient(circle at ${p.x}% ${p.y}%, rgba(255,255,255,0.12) 0%, transparent 60%)`,opacity:p.opacity}}),l.jsx("div",{className:`absolute inset-0 border border-emerald-500/20 rounded-2xl transition-opacity duration-500 pointer-events-none ${x?"opacity-100":"opacity-0"}`}),l.jsx("div",{className:"relative mt-2 shrink-0 translate-z-30 pointer-events-none",children:l.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden border-2 border-stone-800 group-hover:border-emerald-500/50 transition-all duration-500 bg-black shadow-2xl",children:l.jsx("img",{src:s.imageUrl,alt:s.name,style:de,className:"w-full h-full opacity-80 group-hover:opacity-100 transition-all duration-700 group-hover:scale-110"})})}),l.jsxs("div",{className:"mt-6 flex flex-col items-center justify-center w-full px-2 shrink-0 translate-z-20 pointer-events-none",children:[l.jsx("h3",{className:`font-serif font-medium text-stone-100 group-hover:text-emerald-100 transition-colors text-center leading-tight line-clamp-1 ${Se}`,children:s.name}),l.jsxs("div",{className:"flex items-center gap-1.5 mt-3",children:[s.age&&l.jsxs("div",{className:"bg-stone-900/60 border border-stone-800 px-2.5 py-1 rounded-lg flex items-baseline gap-1 shadow-inner",children:[l.jsx("span",{className:"text-[11px] font-bold text-stone-300 tracking-tight",children:s.age.toString().replace(/[^0-9]/g,"")||s.age}),l.jsx("span",{className:"text-[7px] font-black uppercase tracking-widest text-emerald-600/80",children:""})]}),s.height&&l.jsxs("div",{className:"bg-stone-900/60 border border-stone-800 px-2.5 py-1 rounded-lg flex items-baseline gap-1 shadow-inner",children:[l.jsx("span",{className:"text-[11px] font-bold text-stone-300 tracking-tight",children:s.height.toString().replace(/[^0-9]/g,"")||s.height}),l.jsx("span",{className:"text-[7px] font-black uppercase tracking-widest text-emerald-600/80",children:""})]})]})]}),l.jsx("div",{className:"mt-5 flex flex-wrap gap-1.5 justify-center content-start min-h-[28px] w-full px-1 translate-z-10 pointer-events-none",children:s.tags&&s.tags.length>0?l.jsx(l.Fragment,{children:s.tags.slice(0,3).map(A=>l.jsx("span",{className:"px-2 py-0.5 bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 text-[8px] uppercase tracking-wider font-black rounded-md whitespace-nowrap",children:A},A))}):l.jsx("div",{className:"h-4"})}),l.jsx("div",{className:"mt-auto pt-6 border-t border-stone-900/50 w-full flex justify-center shrink-0 translate-z-10 pointer-events-none",children:l.jsx("span",{className:"text-[8px] uppercase tracking-[0.3em] font-black text-stone-700 group-hover:text-emerald-500 transition-colors",children:" "})})]})]})})},ix=N0.memo(ox,(s,t)=>s.character.id===t.character.id&&JSON.stringify(s.character)===JSON.stringify(t.character)&&s.isVisible===t.isVisible&&s.staggerIndex===t.staggerIndex),Bi=({imageUrl:s,scale:t,x:r,y:i,isCircular:c=!1,aspectRatio:d,onUpdate:f})=>{const p=O.useRef(null),[m,x]=O.useState(!1),[w,_]=O.useState({x:0,y:0}),v=j=>{x(!0),_({x:j.clientX,y:j.clientY})};return O.useEffect(()=>{const j=R=>{if(!m||!p.current)return;const q=R.clientX-w.x,de=R.clientY-w.y,fe=.2,Se=Math.max(t,.1),J=r-q*fe/Se,Me=i-de*fe/Se;f({x:J,y:Me}),_({x:R.clientX,y:R.clientY})},$=()=>x(!1);return m&&(window.addEventListener("mousemove",j),window.addEventListener("mouseup",$)),()=>{window.removeEventListener("mousemove",j),window.removeEventListener("mouseup",$)}},[m,w,r,i,t,f]),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{ref:p,className:`relative overflow-hidden bg-black border border-stone-800 cursor-move group select-none shadow-2xl transition-all duration-500 hover:border-emerald-500/40 ${c?"w-48 h-48 rounded-full mx-auto":"rounded-3xl w-full"} ${!c&&!d?"aspect-[4/5]":""}`,style:!c&&d?{aspectRatio:d}:{},onMouseDown:v,children:[l.jsx("img",{src:s,alt:"",draggable:!1,style:{width:"100%",height:"100%",objectFit:"cover",objectPosition:`${r}% ${i}%`,transformOrigin:`${r}% ${i}%`,transform:`scale(${t})`},className:"pointer-events-none transition-opacity duration-300 opacity-90 group-hover:opacity-100"}),l.jsx("div",{className:"absolute inset-0 ring-1 ring-inset ring-white/5 pointer-events-none"}),l.jsx("div",{className:"absolute inset-0 bg-emerald-500/5 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity flex items-center justify-center",children:l.jsx("div",{className:"bg-black/60 backdrop-blur-md px-4 py-2 rounded-full border border-emerald-500/20",children:l.jsx("span",{className:"text-[9px] font-black text-emerald-400 uppercase tracking-[0.25em]",children:" "})})})]}),l.jsxs("div",{className:"bg-stone-900/60 p-4 rounded-2xl border border-stone-800/50 space-y-3 shadow-inner",children:[l.jsxs("div",{className:"flex justify-between items-center px-1",children:[l.jsx("span",{className:"text-[10px] font-black text-stone-500 uppercase tracking-widest",children:""}),l.jsxs("span",{className:"text-[10px] font-mono text-emerald-500 bg-emerald-500/10 px-2 py-0.5 rounded",children:[t.toFixed(2),"x"]})]}),l.jsx("div",{onMouseDown:j=>j.stopPropagation(),children:l.jsx("input",{type:"range",min:"0.1",max:"3",step:"0.05",value:t,onChange:j=>f({scale:parseFloat(j.target.value)}),className:"w-full h-1.5 bg-stone-800 rounded-full appearance-none cursor-pointer accent-emerald-500"})}),l.jsx("p",{className:"text-[8px] text-stone-700 text-center uppercase tracking-tighter",children:"      "})]})]})},Ui=(s,t=800,r=.6)=>new Promise((i,c)=>{const d=new FileReader;d.readAsDataURL(s),d.onload=f=>{var m;const p=new Image;p.src=(m=f.target)==null?void 0:m.result,p.onload=()=>{const x=document.createElement("canvas");let w=p.width,_=p.height;w>t&&(_=_*t/w,w=t),x.width=w,x.height=_;const v=x.getContext("2d");if(v){v.drawImage(p,0,0,w,_);const j=x.toDataURL("image/jpeg",r);i(j)}else c(new Error("Canvas context not available"))},p.onerror=x=>c(x)},d.onerror=f=>c(f)}),lx=[{label:"16:9",value:16/9,str:"16/9",icon:"M4 6h16M4 18h16M4 6v12M20 6v12"},{label:"4:3",value:4/3,str:"4/3",icon:"M5 6h14M5 18h14M5 6v12M19 6v12"},{label:"1:1",value:1,str:"1/1",icon:"M5 5h14v14H5z"},{label:"3:4",value:3/4,str:"3/4",icon:"M6 5h12M6 19h12M6 5v14M18 5v14"},{label:"9:16",value:9/16,str:"9/16",icon:"M6 4h12M6 20h12M6 4v16M18 4v16"}],en=(s,t,r,i,c,d)=>{if(!s)return null;const f=/(\*\*.*?\*\*|__.*?__|~~.*?~~|\|\|.*?\|\||\[c=#[0-9a-fA-F]{3,6}\].*?\[\/c\]|\[link=.*?\].*?\[\/link\]|\[tip=.*?\].*?\[\/tip\]|\[quote=.*?\].*?\[\/quote\]|\[char=.*?\].*?\[\/char\]|\[wiki=.*?\].*?\[\/wiki\]|\[img .*?\])/g;return s.split(f).map((m,x)=>{if(m.startsWith("**")&&m.endsWith("**")&&m.length>4)return l.jsx("strong",{className:"text-stone-100 font-bold",children:en(m.slice(2,-2),t,r,i,c,d)},x);if(m.startsWith("__")&&m.endsWith("__")&&m.length>4)return l.jsx("em",{className:"text-stone-300 italic font-light",children:en(m.slice(2,-2),t,r,i,c,d)},x);if(m.startsWith("~~")&&m.endsWith("~~")&&m.length>4)return l.jsx("span",{className:"line-through opacity-60 decoration-stone-500",children:en(m.slice(2,-2),t,r,i,c,d)},x);if(m.startsWith("||")&&m.endsWith("||")&&m.length>4)return l.jsxs("span",{className:"group/spoiler relative cursor-help rounded bg-stone-800 px-1 py-0.5 mx-0.5 align-middle select-none transition-all hover:bg-stone-700",children:[l.jsx("span",{className:"opacity-0 group-hover/spoiler:opacity-100 transition-opacity duration-300 text-stone-200",children:en(m.slice(2,-2),t,r,i,c,d)}),l.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-[9px] uppercase font-black tracking-widest text-stone-500 group-hover/spoiler:opacity-0 pointer-events-none transition-opacity",children:""})]},x);if(m.startsWith("[c=")&&m.endsWith("[/c]")){const w=m.match(/\[c=(#[0-9a-fA-F]{3,6})\](.*?)\[\/c\]/);if(w)return l.jsx("span",{style:{color:w[1]},className:"font-medium drop-shadow-sm",children:en(w[2],t,r,i,c,d)},x)}if(m.startsWith("[link=")&&m.endsWith("[/link]")){const w=m.match(/\[link=(.*?)\](.*?)\[\/link\]/);if(w)return l.jsx("a",{href:w[1],target:"_blank",rel:"noopener noreferrer",className:"text-emerald-400 hover:text-emerald-300 hover:underline decoration-emerald-500/50 underline-offset-2 transition-colors cursor-pointer",onClick:_=>_.stopPropagation(),children:en(w[2],t,r,i,c,d)},x)}if(m.startsWith("[wiki=")&&m.endsWith("[/wiki]")){const w=m.match(/\[wiki=(.*?)\](.*?)\[\/wiki\]/);if(w){const _=w[1],v=w[2];return l.jsxs("span",{onClick:j=>{j.stopPropagation(),i&&i(_)},className:"inline-flex items-center gap-1 text-cyan-400 hover:text-cyan-200 cursor-pointer transition-colors border-b border-cyan-500/30 hover:border-cyan-400 px-0.5 rounded hover:bg-cyan-900/20 group/wiki",title:" ",children:[l.jsx("svg",{className:"w-3 h-3 opacity-50 group-hover/wiki:opacity-100 transition-opacity",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),en(v,t,r,i,c,d)]},x)}}if(m.startsWith("[char=")&&m.endsWith("[/char]")){const w=m.match(/\[char=(.*?)\](.*?)\[\/char\]/);if(w){const _=w[1],v=w[2];return l.jsxs("span",{onClick:j=>{j.stopPropagation(),r&&r(_)},className:"inline-flex items-center gap-1 text-amber-400 hover:text-amber-200 cursor-pointer transition-colors border-b border-amber-500/30 hover:border-amber-400 px-0.5 rounded hover:bg-amber-900/20 group/char",title:"  ",children:[l.jsx("svg",{className:"w-3 h-3 opacity-50 group-hover/char:opacity-100 transition-opacity",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),en(v,t,r,i,c,d)]},x)}}if(m.startsWith("[tip=")&&m.endsWith("[/tip]")){const w=m.match(/\[tip=(.*?)\](.*?)\[\/tip\]/);if(w)return l.jsxs("span",{className:"relative group/tooltip cursor-help border-b border-dotted border-stone-500 hover:border-emerald-500 transition-colors inline-block leading-tight",children:[en(w[2],t,r,i,c,d),l.jsxs("span",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-max max-w-[200px] p-2 bg-[#1a1a1a] border border-stone-700 rounded-lg text-xs text-stone-300 opacity-0 group-hover/tooltip:opacity-100 transition-opacity duration-200 pointer-events-none z-50 shadow-xl text-center whitespace-normal leading-tight",children:[w[1],l.jsx("span",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-stone-700"})]})]},x)}if(m.startsWith("[quote=")&&m.endsWith("[/quote]")){const w=m.match(/\[quote=(.*?)\](.*?)\[\/quote\]/);if(w){const _=w[1],v=w[2],j=t==null?void 0:t.find($=>$.id===_);return l.jsxs("div",{className:"my-4 border-l-2 border-emerald-500/40 bg-stone-900/20 pl-4 py-3 rounded-r-lg group/quote transition-colors hover:border-emerald-500/60",children:[l.jsx("div",{className:`text-[10px] uppercase font-black text-emerald-500 mb-2 tracking-widest opacity-80 group-hover/quote:opacity-100 transition-opacity flex items-center gap-2 ${j?"cursor-pointer hover:text-emerald-300":""}`,onClick:$=>{j&&r&&($.stopPropagation(),r(j.id))},children:j?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-5 h-5 rounded-full overflow-hidden border border-emerald-500/30 bg-black shrink-0",children:l.jsx("img",{src:j.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${j.miniImageX??50}% ${j.miniImageY??50}%`,transform:`scale(${j.miniImageScale??1})`,transformOrigin:`${j.miniImageX??50}% ${j.miniImageY??50}%`}})}),l.jsx("span",{children:j.name})]}):l.jsxs(l.Fragment,{children:[l.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M14.017 21L14.017 18C14.017 16.896 14.321 16.067 14.929 15.513C15.537 14.959 16.485 14.682 17.773 14.682V14.128C17.773 13.068 17.411 12.152 16.687 11.38C15.963 10.608 14.887 10.222 13.459 10.222V4.99998C15.827 4.99998 17.754 5.75398 19.24 7.26198C20.726 8.76998 21.469 10.871 21.469 13.565V21H14.017ZM2.53699 21L2.53699 18C2.53699 16.896 2.84099 16.067 3.44899 15.513C4.05699 14.959 5.00499 14.682 6.29299 14.682V14.128C6.29299 13.068 5.93099 12.152 5.20699 11.38C4.48299 10.608 3.40699 10.222 1.97899 10.222V4.99998C4.34699 4.99998 6.27399 5.75398 7.75999 7.26198C9.24599 8.76998 9.98899 10.871 9.98899 13.565V21H2.53699Z"})}),l.jsx("span",{children:_})]})}),l.jsx("div",{className:"italic text-stone-300 font-serif text-lg leading-relaxed",children:en(v,t,r,i,c,d)})]},x)}}if(m.startsWith("[img ")&&m.endsWith("]")){const w=m.slice(5,-1),_=w.match(/src=(.*?)(\s|$)/),v=w.match(/w=(\d+)/),j=w.match(/a=(left|center|right)/),$=w.match(/x=(\d+(\.\d+)?)/),R=w.match(/y=(\d+(\.\d+)?)/),q=w.match(/s=(\d+(\.\d+)?)/),de=w.match(/ar=(\d+\/\d+)/),fe=_?_[1]:"",Se=v?parseInt(v[1]):100,J=j?j[1]:"center",Me=$?parseFloat($[1]):50,Z=R?parseFloat(R[1]):50,A=q?parseFloat(q[1]):1,X=de?de[1]:"16/9",[Ce,P]=X.split("/").map(Number),Ee=P&&Ce?P/Ce*100:56.25;if(fe){const ye=!!c;return l.jsx("span",{className:`block w-full my-4 flex ${J==="center"?"justify-center":J==="right"?"justify-end":"justify-start"}`,children:l.jsxs("div",{className:`relative rounded-lg shadow-lg border border-stone-800/50 overflow-hidden group/img transition-all ${ye?"hover:scale-[1.01] hover:border-emerald-500/30":"cursor-zoom-in hover:shadow-emerald-900/20"}`,style:{width:`${Se}%`},onClick:ke=>{ke.stopPropagation(),c?c({url:fe,width:Se,align:J,x:Me,y:Z,scale:A,aspectRatioStr:X,originalTag:m}):d&&d(fe)},children:[l.jsx("div",{style:{paddingTop:`${Ee}%`,position:"relative"},children:l.jsx("img",{src:fe,alt:"User content",className:"absolute inset-0 w-full h-full object-cover",style:{objectPosition:`${Me}% ${Z}%`,transformOrigin:`${Me}% ${Z}%`,transform:`scale(${A})`}})}),c&&l.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover/img:opacity-100 flex items-center justify-center transition-opacity cursor-pointer z-10",children:l.jsxs("span",{className:"bg-black/60 backdrop-blur px-3 py-1.5 rounded-full text-[10px] uppercase font-bold text-emerald-400 border border-emerald-500/30 flex items-center gap-2",children:[l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),""]})})]})},x)}}return m})},_c=(s,t,r,i,c,d)=>s?s.split(`
`).map((p,m)=>{const x=p.trim();return x?x==="---"?l.jsx("div",{className:"h-px w-full bg-gradient-to-r from-stone-400 to-transparent my-8 opacity-80 shadow-[0_0_10px_rgba(168,162,158,0.2)]"},m):x.startsWith("# ")?l.jsx("h3",{className:"text-xl md:text-2xl font-serif text-emerald-100 border-b border-stone-800/60 pb-2 mb-3 mt-6 first:mt-0 italic",children:en(x.slice(2),d,t,r,i,c)},m):x.startsWith("> ")?l.jsx("blockquote",{className:"border-l-2 border-emerald-500/40 bg-stone-900/20 pl-4 py-2 my-2 rounded-r-lg italic text-stone-400",children:en(x.slice(2),d,t,r,i,c)},m):l.jsx("div",{className:"min-h-[1.5em] text-stone-300 leading-relaxed font-serif text-base md:text-lg break-words",children:en(p,d,t,r,i,c)},m):l.jsx("div",{className:"h-4"},m)}):null,ax=({notes:s,characters:t,wikiEntries:r=[],availableTags:i,availableHiddenTags:c,onUpdate:d,isAdmin:f,onSelectCharacter:p,onSelectWikiEntry:m})=>{var we,K;const[x,w]=O.useState("list"),[_,v]=O.useState(null),[j,$]=O.useState(new Set),[R,q]=O.useState({}),[de,fe]=O.useState(""),[Se,J]=O.useState(!1),[Me,Z]=O.useState("#10b981"),[A,X]=O.useState(!1),[Ce,P]=O.useState(!1),[Ee,ye]=O.useState(!1),[ke,ue]=O.useState(""),[Ye,ae]=O.useState([]),[ze,H]=O.useState(!1),[U,N]=O.useState({url:"",width:100,align:"center",x:50,y:50,scale:1,aspectRatioStr:"16/9"}),[I,ee]=O.useState(!1),[he,Le]=O.useState(!1),[Ae,De]=O.useState(null),xe=O.useRef(null);O.useEffect(()=>{x!=="list"&&window.scrollTo({top:0,behavior:"smooth"})},[x]);const F=y=>{x==="editor"&&(N(y),H(!0))},W=()=>{const y=`[img src=${U.url} w=${U.width} a=${U.align} x=${U.x.toFixed(0)} y=${U.y.toFixed(0)} s=${U.scale.toFixed(2)} ar=${U.aspectRatioStr}]`;if(U.originalTag){const z=(R.content||"").replace(U.originalTag,y);q({...R,content:z})}else re(y,"");H(!1),N({url:"",width:100,align:"center",x:50,y:50,scale:1,aspectRatioStr:"16/9"})},re=(y,z)=>{if(!xe.current&&!U.originalTag)return;if(!xe.current){const $t=R.content||"";q({...R,content:$t+y+z});return}const le=xe.current.selectionStart,je=xe.current.selectionEnd,Re=R.content||"",dt=Re.substring(0,le),ht=Re.substring(le,je),Dt=Re.substring(je),qt=dt+y+ht+z+Dt;q({...R,content:qt}),setTimeout(()=>{if(xe.current){I||xe.current.focus({preventScroll:!0});const $t=ht.length>0?le+y.length+ht.length+z.length:le+y.length;xe.current.setSelectionRange($t,$t)}},0)},We=y=>{if(!xe.current)return;const z=xe.current.selectionStart,le=xe.current.selectionEnd,je=R.content||"",Re=je.substring(0,z),dt=je.substring(z,le),ht=je.substring(le),Dt=dt.length>0?dt:y.name,qt=`${Re}[char=${y.id}]${Dt}[/char]${ht}`;q({...R,content:qt}),X(!1),ue(""),ae([]),setTimeout(()=>{if(xe.current){I||xe.current.focus({preventScroll:!0});const $t=z+`[char=${y.id}]${Dt}[/char]`.length;xe.current.setSelectionRange($t,$t)}},0)},D=y=>{if(!xe.current)return;const z=xe.current.selectionStart,le=xe.current.selectionEnd,je=R.content||"",Re=je.substring(0,z),dt=je.substring(z,le),ht=je.substring(le),Dt=dt.length>0?dt:y.title,qt=`${Re}[wiki=${y.id}]${Dt}[/wiki]${ht}`;q({...R,content:qt}),ye(!1),ue(""),setTimeout(()=>{if(xe.current){I||xe.current.focus({preventScroll:!0});const $t=z+`[wiki=${y.id}]${Dt}[/wiki]`.length;xe.current.setSelectionRange($t,$t)}},0)},se=y=>{re(`[quote=${y.id}]`,"[/quote]"),P(!1),ue(""),ae([])};O.useEffect(()=>{if(xe.current&&x==="editor"&&!I&&!he){const y=window.scrollY;xe.current.style.height="auto",xe.current.style.height=`${xe.current.scrollHeight}px`,window.scrollY!==y&&window.scrollTo({top:y,behavior:"instant"})}},[R.content,x,I,he]);const k=y=>{$(z=>{const le=new Set(z);return le.has(y)?le.delete(y):le.add(y),le})},Q=y=>{y?(v(y.id),q({...y})):(v(null),q({title:"",content:""})),w("editor"),fe(""),J(!1),X(!1),P(!1),H(!1),ye(!1),N({url:"",width:100,align:"center",x:50,y:50,scale:1,aspectRatioStr:"16/9"}),ee(!1),Le(!1)},ie=()=>{w("list"),v(null),q({})},me=()=>{if(!(!R.title||!R.content)){if(_){const y=s.map(z=>z.id===_?{...z,...R}:z);d(y)}else{const y={id:Date.now().toString(),title:R.title||"",content:R.content||"",date:new Date().toLocaleDateString("ru-RU"),authorId:R.authorId,targetId:R.targetId};d([y,...s])}ie()}},S=()=>{if(_&&window.confirm("     ?")){const y=s.filter(z=>z.id!==_);d(y),ie()}},ne=y=>t.find(z=>z&&z.id===y),_e=O.useMemo(()=>t.filter(y=>y.name.toLowerCase().includes(de.toLowerCase())).sort((y,z)=>y.name.localeCompare(z.name)),[t,de]),$e=O.useMemo(()=>t.filter(y=>{const z=y.name.toLowerCase().includes(ke.toLowerCase()),le=Ye.length===0||Ye.every(je=>(y.tags||[]).includes(je)||(y.hiddenTags||[]).includes(je));return z&&le}).sort((y,z)=>y.name.localeCompare(z.name)),[t,ke,Ye]),Ge=O.useMemo(()=>r.filter(y=>y.title.toLowerCase().includes(ke.toLowerCase())).sort((y,z)=>y.title.localeCompare(z.title)),[r,ke]),B=y=>{ae(z=>z.includes(y)?z.filter(le=>le!==y):[...z,y])},ce=y=>{const[z,le]=y.split("/").map(Number);return z&&le?z/le:16/9};return x==="list"?l.jsxs("div",{className:"space-y-12 animate-in fade-in duration-500 w-full mx-auto pb-20",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-b border-stone-900/50 pb-8",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-baseline gap-3",children:[l.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100 italic",children:""}),l.jsx("button",{onClick:()=>m&&m(""),className:"text-stone-800 hover:text-stone-500 transition-colors p-1",title:" ",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})})]}),l.jsx("p",{className:"text-stone-500 uppercase tracking-[0.3em] text-[9px] font-black",children:"   "})]}),f&&l.jsxs("button",{onClick:()=>Q(),className:"group relative bg-white hover:bg-emerald-50 text-black px-8 py-4 rounded-2xl text-[10px] uppercase tracking-[0.2em] font-black transition-all shadow-xl hover:shadow-emerald-500/10 flex items-center gap-3 overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})," "]})]}),l.jsx("div",{className:"space-y-6",children:s.length===0?l.jsxs("div",{className:"py-32 text-center animate-slide-up-fade",style:{animationDelay:"100ms"},children:[l.jsx("div",{className:"w-16 h-16 bg-stone-900/20 rounded-full flex items-center justify-center mx-auto mb-6 border border-stone-800/50",children:l.jsx("svg",{className:"w-8 h-8 text-stone-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),l.jsx("p",{className:"text-stone-700 italic font-serif text-lg",children:" ,   .    ."})]}):s.map((y,z)=>{const le=ne(y.authorId),je=ne(y.targetId),Re=j.has(y.id);return l.jsxs("article",{style:{animationDelay:`${z*100}ms`},className:`relative group bg-[#0a0a0a] border rounded-3xl p-6 md:p-8 transition-all duration-500 shadow-2xl overflow-hidden animate-slide-up-fade ${Re?"border-emerald-900/40 bg-stone-950/80":"border-stone-900/60 hover:border-emerald-900/30"}`,children:[l.jsx("div",{className:`absolute top-0 right-0 w-64 h-64 bg-emerald-500/5 rounded-full blur-[100px] -translate-y-32 translate-x-32 pointer-events-none transition-opacity duration-700 ${Re?"opacity-100":"opacity-0 group-hover:opacity-50"}`}),l.jsxs("div",{className:"relative z-10",children:[l.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6",children:[l.jsx("div",{className:"flex items-center gap-3",children:le?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-10 h-10 rounded-full border border-stone-800 overflow-hidden bg-black shrink-0",children:l.jsx("img",{src:le.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${le.miniImageX??50}% ${le.miniImageY??50}%`,transformOrigin:`${le.miniImageX??50}% ${le.miniImageY??50}%`,transform:`scale(${le.miniImageScale??1})`}})}),l.jsx("span",{className:"text-[10px] uppercase tracking-widest font-black text-stone-200",children:le.name})]}):l.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-stone-700 bg-stone-900/50 px-3 py-1.5 rounded-lg",children:" "})}),l.jsx("div",{className:"h-px w-6 bg-stone-900"}),l.jsx("div",{className:"flex items-center gap-3",children:je?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-emerald-500/60",children:":"}),l.jsx("div",{className:"w-10 h-10 rounded-full border border-emerald-900/20 overflow-hidden bg-black shrink-0",children:l.jsx("img",{src:je.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${je.miniImageX??50}% ${je.miniImageY??50}%`,transformOrigin:`${je.miniImageX??50}% ${je.miniImageY??50}%`,transform:`scale(${je.miniImageScale??1})`}})}),l.jsx("span",{className:"text-[10px] uppercase tracking-widest font-black text-emerald-400",children:je.name})]}):l.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-stone-700",children:""})}),l.jsx("div",{className:"ml-auto text-[9px] font-black text-stone-800 uppercase tracking-[0.2em]",children:y.date})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("h3",{className:`font-serif font-bold transition-all duration-500 drop-shadow-md italic break-words ${Re?"text-2xl md:text-3xl text-emerald-100 mb-6":"text-xl text-stone-300 group-hover:text-emerald-200"}`,children:y.title}),!Re&&l.jsxs("button",{onClick:()=>k(y.id),className:"text-[10px] uppercase tracking-[0.2em] font-black text-stone-600 hover:text-emerald-500 transition-colors pt-4 flex items-center gap-2 outline-none group/btn animate-in fade-in duration-500",children:[l.jsx("span",{children:""}),l.jsx("svg",{className:"w-3 h-3 transition-transform group-hover/btn:translate-y-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),l.jsx("div",{className:`grid transition-[grid-template-rows,opacity] duration-500 ease-[cubic-bezier(0.4,0,0.2,1)] ${Re?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"}`,children:l.jsxs("div",{className:"overflow-hidden min-h-0",children:[l.jsx("div",{className:"w-full h-px bg-gradient-to-r from-emerald-900/50 to-transparent my-6"}),l.jsx("div",{className:"space-y-2",children:_c(y.content,p,m,void 0,dt=>De(dt),t)}),l.jsxs("div",{className:"mt-10 pt-6 border-t border-stone-900/50 flex justify-between items-center",children:[l.jsxs("button",{className:"text-[9px] uppercase tracking-[0.2em] font-black text-emerald-900 hover:text-emerald-600 transition-colors flex items-center gap-2",onClick:()=>k(y.id),children:[l.jsx("svg",{className:"w-3 h-3 rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),""]}),f&&l.jsxs("button",{onClick:()=>Q(y),className:"flex items-center gap-2 bg-stone-900/50 hover:bg-stone-800 text-stone-400 px-4 py-2 rounded-lg text-[9px] uppercase font-black tracking-widest transition-all",children:[l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),""]})]})]})})]})]},y.id)})}),Ae&&l.jsx("div",{className:"fixed inset-0 z-[120] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 animate-in fade-in duration-200 cursor-zoom-out",onClick:()=>De(null),children:l.jsxs("div",{className:"relative max-w-full max-h-full",children:[l.jsx("img",{src:Ae,className:"max-w-[95vw] max-h-[95vh] object-contain rounded-lg shadow-2xl animate-in zoom-in-95 duration-300",alt:"Zoomed"}),l.jsx("button",{className:"absolute -top-12 right-0 text-stone-400 hover:text-white transition-colors",onClick:()=>De(null),children:l.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]})})]}):x==="select-author"||x==="select-target"?l.jsxs("div",{className:"min-h-screen animate-in fade-in slide-in-from-bottom-4 duration-500 pb-20",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-b border-stone-900/50 pb-8 mb-8",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-serif text-stone-100 italic",children:x==="select-author"?" ":" "}),l.jsx("p",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-emerald-500/60 mt-2",children:"   "})]}),l.jsxs("button",{onClick:()=>w("editor"),className:"flex items-center gap-2 text-stone-500 hover:text-white transition-all text-[10px] uppercase font-bold tracking-widest",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"  "]})]}),l.jsx("div",{className:"mb-8",children:l.jsx("input",{type:"text",placeholder:"    ...",value:de,onChange:y=>fe(y.target.value),className:"w-full bg-stone-900/50 border border-stone-800 rounded-2xl px-6 py-4 text-sm text-stone-200 outline-none focus:border-emerald-500/50 transition-colors shadow-inner font-serif",autoFocus:!0})}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[l.jsxs("button",{onClick:()=>{q({...R,[x==="select-author"?"authorId":"targetId"]:void 0}),w("editor")},className:"flex items-center gap-4 p-4 rounded-2xl border border-stone-800 hover:border-red-900/50 hover:bg-red-950/10 transition-all group text-left",children:[l.jsx("div",{className:"w-12 h-12 rounded-full border border-stone-800 group-hover:border-red-500/30 bg-stone-900 flex items-center justify-center shrink-0 transition-colors",children:l.jsx("svg",{className:"w-5 h-5 text-stone-600 group-hover:text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("span",{className:"text-stone-400 font-bold text-sm block truncate group-hover:text-red-400 transition-colors",children:" "}),l.jsx("span",{className:"text-[9px] uppercase tracking-widest text-stone-600 block truncate",children:" "})]})]}),_e.map(y=>l.jsxs("button",{onClick:()=>{q({...R,[x==="select-author"?"authorId":"targetId"]:y.id}),w("editor")},className:"flex items-center gap-4 p-4 rounded-2xl bg-[#0a0a0a] hover:bg-emerald-950/10 border border-stone-900 hover:border-emerald-900/30 transition-all group text-left",children:[l.jsx("div",{className:"w-12 h-12 rounded-full border border-stone-800 group-hover:border-emerald-500/50 bg-black overflow-hidden shrink-0 transition-colors",children:l.jsx("img",{src:y.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${y.miniImageX??50}% ${y.miniImageY??50}%`,transformOrigin:`${y.miniImageX??50}% ${y.miniImageY??50}%`,transform:`scale(${y.miniImageScale??1})`}})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("span",{className:"text-stone-300 font-bold text-sm block truncate group-hover:text-emerald-300 transition-colors",children:y.name}),l.jsx("span",{className:"text-[9px] uppercase tracking-widest text-stone-600 block truncate",children:""})]})]},y.id))]})]}):l.jsxs("div",{className:"min-h-screen animate-in fade-in slide-in-from-bottom-4 duration-500 flex flex-col pb-20",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6 border-b border-stone-900/50 pb-6 mb-8 shrink-0",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:ie,className:"group p-3 rounded-full border border-stone-800 hover:bg-stone-900 transition-all text-stone-500 hover:text-white",children:l.jsx("svg",{className:"w-5 h-5 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-serif text-stone-100 font-bold italic",children:_?" ":" "}),l.jsx("p",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-emerald-500/60 mt-1",children:"   "})]})]}),l.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[_&&l.jsx("button",{onClick:S,className:"px-6 py-3 bg-red-950/10 hover:bg-red-900/20 border border-red-900/30 text-red-500/70 hover:text-red-500 rounded-xl text-[10px] uppercase tracking-widest font-black transition-all flex-grow md:flex-grow-0",children:""}),l.jsxs("button",{onClick:me,disabled:!R.title||!R.content,className:"px-8 py-3 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 text-emerald-500 rounded-xl text-[10px] uppercase tracking-widest font-black transition-all shadow-lg hover:shadow-emerald-900/10 disabled:opacity-30 disabled:cursor-not-allowed flex-grow md:flex-grow-0 flex items-center justify-center gap-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),""]})]})]}),l.jsxs("div",{className:"flex-grow flex flex-col space-y-8",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 shrink-0",children:[l.jsxs("button",{onClick:()=>w("select-author"),className:`group relative p-4 rounded-3xl border transition-all text-left flex items-center gap-5 ${R.authorId?"bg-emerald-950/10 border-emerald-900/30":"bg-stone-900/20 border-stone-800/50 hover:border-emerald-900/30"}`,children:[l.jsx("div",{className:`w-14 h-14 rounded-full border-2 overflow-hidden bg-black shrink-0 transition-transform group-hover:scale-105 ${R.authorId?"border-emerald-500 shadow-[0_0_15px_rgba(16,185,129,0.3)]":"border-stone-800"}`,children:R.authorId?(()=>{const y=ne(R.authorId);return y?l.jsx("img",{src:y.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${y.miniImageX??50}% ${y.miniImageY??50}%`,transformOrigin:`${y.miniImageX??50}% ${y.miniImageY??50}%`,transform:`scale(${y.miniImageScale??1})`}}):null})():l.jsx("div",{className:"w-full h-full flex items-center justify-center text-stone-800",children:l.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-[9px] uppercase tracking-widest font-black text-stone-600 mb-1",children:":"}),l.jsx("p",{className:`text-sm font-bold truncate ${R.authorId?"text-stone-100":"text-stone-700 italic"}`,children:R.authorId?(we=ne(R.authorId))==null?void 0:we.name:" "})]})]}),l.jsxs("button",{onClick:()=>w("select-target"),className:`group relative p-4 rounded-3xl border transition-all text-left flex items-center gap-5 ${R.targetId?"bg-amber-950/10 border-amber-900/30":"bg-stone-900/20 border-stone-800/50 hover:border-amber-900/30"}`,children:[l.jsx("div",{className:`w-14 h-14 rounded-full border-2 overflow-hidden bg-black shrink-0 transition-transform group-hover:scale-105 ${R.targetId?"border-amber-500 shadow-[0_0_15px_rgba(245,158,11,0.3)]":"border-stone-800"}`,children:R.targetId?(()=>{const y=ne(R.targetId);return y?l.jsx("img",{src:y.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${y.miniImageX??50}% ${y.miniImageY??50}%`,transformOrigin:`${y.miniImageX??50}% ${y.miniImageY??50}%`,transform:`scale(${y.miniImageScale??1})`}}):null})():l.jsx("div",{className:"w-full h-full flex items-center justify-center text-stone-800",children:l.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-[9px] uppercase tracking-widest font-black text-stone-600 mb-1",children:":"}),l.jsx("p",{className:`text-sm font-bold truncate ${R.targetId?"text-stone-100":"text-stone-700 italic"}`,children:R.targetId?(K=ne(R.targetId))==null?void 0:K.name:""})]})]})]}),l.jsx("div",{className:"space-y-4",children:l.jsx("input",{placeholder:"  ...",className:"w-full bg-transparent border-b-2 border-stone-800 px-2 py-4 text-stone-100 outline-none focus:border-emerald-500/40 transition-all font-serif font-bold italic text-3xl md:text-4xl placeholder-stone-700",value:R.title||"",onChange:y=>q({...R,title:y.target.value})})}),l.jsxs("div",{className:"flex-grow flex flex-col w-full relative group/editor",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4 px-1 sticky top-0 bg-[#050505] z-50 py-2 border-b border-stone-900/50",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.4em] font-black text-stone-600",children:" "}),l.jsxs("div",{className:"flex flex-wrap gap-1 bg-stone-900/50 p-1 rounded-lg border border-stone-800",children:[l.jsx("button",{type:"button",disabled:I,onClick:y=>{y.preventDefault(),re("**","**")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 font-serif font-bold text-lg transition-colors ${I?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:"B"}),l.jsx("button",{type:"button",disabled:I,onClick:y=>{y.preventDefault(),re("__","__")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 font-serif italic text-lg transition-colors ${I?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:"I"}),l.jsx("button",{type:"button",disabled:I,onClick:y=>{y.preventDefault(),re("~~","~~")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 line-through decoration-emerald-500/50 transition-colors ${I?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:"S"}),l.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),l.jsx("button",{type:"button",disabled:I,onClick:y=>{y.preventDefault(),re("# ","")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 font-serif font-bold transition-colors ${I?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:"H"}),l.jsx("button",{type:"button",disabled:I,onClick:y=>{y.preventDefault(),re("> ","")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${I?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:l.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M14.017 21L14.017 18C14.017 16.896 14.321 16.067 14.929 15.513C15.537 14.959 16.485 14.682 17.773 14.682V14.128C17.773 13.068 17.411 12.152 16.687 11.38C15.963 10.608 14.887 10.222 13.459 10.222V4.99998C15.827 4.99998 17.754 5.75398 19.24 7.26198C20.726 8.76998 21.469 10.871 21.469 13.565V21H14.017ZM2.53699 21L2.53699 18C2.53699 16.896 2.84099 16.067 3.44899 15.513C4.05699 14.959 5.00499 14.682 6.29299 14.682V14.128C6.29299 13.068 5.93099 12.152 5.20699 11.38C4.48299 10.608 3.40699 10.222 1.97899 10.222V4.99998C4.34699 4.99998 6.27399 5.75398 7.75999 7.26198C9.24599 8.76998 9.98899 10.871 9.98899 13.565V21H2.53699Z"})})}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{type:"button",disabled:I,onClick:y=>{y.preventDefault(),P(!Ce)},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${I?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"  ",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),Ce&&!I&&l.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-[#1a1a1a] border border-stone-700 rounded-xl shadow-2xl z-50 animate-in fade-in zoom-in-95 duration-200 w-72 md:w-80",children:l.jsxs("div",{className:"space-y-3",children:[l.jsx("input",{autoFocus:!0,type:"text",placeholder:" ...",value:ke,onChange:y=>ue(y.target.value),className:"w-full bg-stone-900 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-colors"}),((i==null?void 0:i.length)||0)>0&&l.jsx("div",{className:"flex flex-wrap gap-1.5 max-h-20 overflow-y-auto custom-scrollbar",children:i==null?void 0:i.map(y=>{const z=Ye.includes(y);return l.jsx("button",{onClick:le=>{le.preventDefault(),B(y)},className:`px-2 py-1 rounded text-[8px] uppercase font-bold tracking-wider transition-all border ${z?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:y},y)})}),l.jsx("div",{className:"max-h-48 overflow-y-auto custom-scrollbar space-y-1",children:$e.length===0?l.jsx("p",{className:"text-center text-[10px] text-stone-600 italic py-2",children:"  "}):$e.map(y=>l.jsxs("button",{onClick:z=>{z.preventDefault(),se(y)},className:"w-full flex items-center gap-3 p-2 hover:bg-stone-900 rounded-lg text-left transition-colors group",children:[l.jsx("div",{className:"w-6 h-6 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:l.jsx("img",{src:y.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${y.miniImageX??50}% ${y.miniImageY??50}%`,transform:`scale(${y.miniImageScale??1})`,transformOrigin:`${y.miniImageX??50}% ${y.miniImageY??50}%`}})}),l.jsx("span",{className:"text-xs font-bold text-stone-300 group-hover:text-emerald-400 truncate",children:y.name})]},y.id))})]})})]}),l.jsx("button",{type:"button",disabled:I,onClick:y=>{y.preventDefault(),re("---","")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${I?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:l.jsx("div",{className:"w-4 h-0.5 bg-current opacity-50"})}),l.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{type:"button",disabled:I,onClick:y=>{y.preventDefault(),X(!A)},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${I?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-amber-400"}`,title:" ",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),A&&!I&&l.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-[#1a1a1a] border border-stone-700 rounded-xl shadow-2xl z-50 animate-in fade-in zoom-in-95 duration-200 w-72 md:w-80",children:l.jsxs("div",{className:"space-y-3",children:[l.jsx("input",{autoFocus:!0,type:"text",placeholder:"...",value:ke,onChange:y=>ue(y.target.value),className:"w-full bg-stone-900 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-amber-500/50 transition-colors"}),((i==null?void 0:i.length)||0)>0&&l.jsx("div",{className:"flex flex-wrap gap-1.5 max-h-20 overflow-y-auto custom-scrollbar",children:i==null?void 0:i.map(y=>{const z=Ye.includes(y);return l.jsx("button",{onClick:le=>{le.preventDefault(),B(y)},className:`px-2 py-1 rounded text-[8px] uppercase font-bold tracking-wider transition-all border ${z?"bg-amber-500/20 border-amber-500/40 text-amber-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:y},y)})}),l.jsx("div",{className:"max-h-48 overflow-y-auto custom-scrollbar space-y-1",children:$e.length===0?l.jsx("p",{className:"text-center text-[10px] text-stone-600 italic py-2",children:"  "}):$e.map(y=>l.jsxs("button",{onClick:z=>{z.preventDefault(),We(y)},className:"w-full flex items-center gap-3 p-2 hover:bg-stone-900 rounded-lg text-left transition-colors group",children:[l.jsx("div",{className:"w-6 h-6 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:l.jsx("img",{src:y.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${y.miniImageX??50}% ${y.miniImageY??50}%`,transform:`scale(${y.miniImageScale??1})`,transformOrigin:`${y.miniImageX??50}% ${y.miniImageY??50}%`}})}),l.jsx("span",{className:"text-xs font-bold text-stone-300 group-hover:text-amber-400 truncate",children:y.name})]},y.id))})]})})]}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{type:"button",disabled:I,onClick:y=>{y.preventDefault(),ye(!Ee)},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${I?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-cyan-400"}`,title:"   ",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),Ee&&!I&&l.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-[#1a1a1a] border border-stone-700 rounded-xl shadow-2xl z-50 animate-in fade-in zoom-in-95 duration-200 w-72 md:w-80",children:l.jsxs("div",{className:"space-y-3",children:[l.jsx("input",{autoFocus:!0,type:"text",placeholder:" ...",value:ke,onChange:y=>ue(y.target.value),className:"w-full bg-stone-900 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-cyan-500/50 transition-colors"}),l.jsx("div",{className:"max-h-48 overflow-y-auto custom-scrollbar space-y-1",children:Ge.length===0?l.jsx("p",{className:"text-center text-[10px] text-stone-600 italic py-2",children:"  "}):Ge.map(y=>l.jsxs("button",{onClick:z=>{z.preventDefault(),D(y)},className:"w-full flex items-center gap-3 p-2 hover:bg-stone-900 rounded-lg text-left transition-colors group",children:[l.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center border border-stone-800 bg-black shrink-0",children:l.jsx("svg",{className:"w-3 h-3 text-stone-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),l.jsx("span",{className:"text-xs font-bold text-stone-300 group-hover:text-cyan-400 truncate",children:y.title})]},y.id))})]})})]}),l.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{type:"button",disabled:I,onClick:y=>{y.preventDefault(),H(!ze)},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${I?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:" ",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),ze&&l.jsx("div",{className:"absolute top-full right-0 origin-top-right mt-2 p-4 bg-[#1a1a1a] border border-stone-700 rounded-xl shadow-2xl z-[60] animate-in fade-in zoom-in-95 duration-200 w-80 max-h-[80vh] overflow-y-auto custom-scrollbar",children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h4",{className:"text-[10px] uppercase font-bold text-stone-400 border-b border-stone-800 pb-2 sticky top-0 bg-[#1a1a1a] z-10",children:U.originalTag?"":" "}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-[9px] uppercase font-bold text-stone-500",children:""}),l.jsx("input",{autoFocus:!0,type:"text",placeholder:"https://...",className:"w-full bg-stone-900 border border-stone-800 rounded-lg px-2 py-1.5 text-xs text-stone-200 outline-none focus:border-emerald-500/50",value:U.url,onChange:y=>N({...U,url:y.target.value})})]}),U.url&&l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-[9px] uppercase font-bold text-stone-500",children:"  "}),l.jsx("div",{className:"w-3/4 mx-auto transition-all",children:l.jsx(Bi,{imageUrl:U.url,scale:U.scale,x:U.x,y:U.y,aspectRatio:ce(U.aspectRatioStr),onUpdate:y=>N(z=>({...z,x:y.x??z.x,y:y.y??z.y,scale:y.scale??z.scale}))})}),l.jsx("div",{className:"grid grid-cols-5 gap-1 mt-2",children:lx.map(y=>l.jsxs("button",{type:"button",onClick:()=>N(z=>({...z,aspectRatioStr:y.str})),className:`flex flex-col items-center justify-center p-1.5 rounded-lg border transition-all ${U.aspectRatioStr===y.str?"bg-stone-800 border-emerald-500/50 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-500 hover:text-stone-300 hover:border-stone-700"}`,title:y.label,children:[l.jsx("svg",{className:"w-4 h-4 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:y.icon})}),l.jsx("span",{className:"text-[8px] font-black",children:y.label})]},y.label))})]}),l.jsx("button",{type:"button",disabled:!U.url,onClick:y=>{y.preventDefault(),W()},className:"w-full py-2 bg-emerald-900/30 border border-emerald-900/50 text-emerald-500 rounded-lg text-[10px] uppercase font-bold hover:bg-emerald-900/50 transition-colors disabled:opacity-50",children:U.originalTag?" ":""}),l.jsxs("div",{className:"space-y-1 pt-2 border-t border-stone-800",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("label",{className:"text-[9px] uppercase font-bold text-stone-500",children:"  "}),l.jsxs("span",{className:"text-[9px] font-mono text-emerald-500",children:[U.width,"%"]})]}),l.jsx("input",{type:"range",min:"10",max:"100",step:"10",className:"w-full h-1.5 bg-stone-800 rounded-lg appearance-none cursor-pointer accent-emerald-500",value:U.width,onChange:y=>N({...U,width:parseInt(y.target.value)})})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-[9px] uppercase font-bold text-stone-500",children:""}),l.jsx("div",{className:"flex bg-stone-900 rounded-lg p-1 border border-stone-800",children:["left","center","right"].map(y=>l.jsxs("button",{type:"button",onClick:()=>N({...U,align:y}),className:`flex-1 py-1 rounded text-stone-400 hover:text-white transition-colors flex justify-center ${U.align===y?"bg-stone-800 text-emerald-400 shadow-sm":""}`,children:[y==="left"&&l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h10M4 18h7"})}),y==="center"&&l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M7 12h10M7 18h10"})}),y==="right"&&l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M10 12h10M13 18h7"})})]},y))})]})]})})]}),l.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),l.jsx("button",{type:"button",disabled:I,onClick:y=>{y.preventDefault(),re("[link=]","[/link]")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${I?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),l.jsx("button",{type:"button",disabled:I,onClick:y=>{y.preventDefault(),re("[tip=]","[/tip]")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${I?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),l.jsx("button",{type:"button",disabled:I,onClick:y=>{y.preventDefault(),re("||","||")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${I?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{type:"button",disabled:I,onClick:y=>{y.preventDefault(),J(!Se)},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${I?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:l.jsx("div",{className:"w-3.5 h-3.5 rounded-full bg-gradient-to-br from-red-500 via-yellow-500 to-blue-500 border border-stone-600"})}),Se&&!I&&l.jsxs("div",{className:"absolute top-full right-0 mt-2 p-3 bg-[#1a1a1a] border border-stone-700 rounded-xl shadow-2xl z-50 flex items-center gap-3 animate-in fade-in zoom-in-95 duration-200 min-w-[140px]",children:[l.jsx("input",{type:"color",className:"w-8 h-8 rounded cursor-pointer bg-transparent border-none p-0",value:Me,onChange:y=>Z(y.target.value)}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-[8px] uppercase font-bold text-stone-500 tracking-wider",children:""}),l.jsx("span",{className:"text-[10px] font-mono text-stone-300",children:Me})]}),l.jsx("button",{type:"button",onClick:y=>{y.preventDefault(),re(`[c=${Me}]`,"[/c]"),J(!1)},className:"ml-auto p-1.5 bg-emerald-500/20 text-emerald-500 hover:bg-emerald-500/30 rounded-lg transition-colors border border-emerald-500/30",title:"",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]})]}),l.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),l.jsx("button",{type:"button",disabled:I,onClick:y=>{y.preventDefault(),Le(!he)},className:`w-8 h-8 flex items-center justify-center rounded-md transition-colors hidden md:flex ${he&&!I?"bg-emerald-900/30 text-emerald-400":"text-stone-400 hover:bg-stone-800 hover:text-white"} ${I?"opacity-30 cursor-not-allowed":""}`,title:he?"  ":"  ",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 00-2 2"})})}),l.jsx("button",{type:"button",onClick:y=>{y.preventDefault(),ee(!I)},className:`w-8 h-8 flex items-center justify-center rounded-md transition-colors ${I?"bg-emerald-900/30 text-emerald-400":"text-stone-400 hover:bg-stone-800 hover:text-white"}`,title:I?"  ":" ",children:I?l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}):l.jsxs("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),l.jsxs("div",{className:`relative flex-grow min-h-[500px] ${he&&!I?"grid grid-cols-1 lg:grid-cols-2 gap-4":""}`,children:[l.jsx("textarea",{ref:xe,placeholder:"  ...",className:`w-full bg-[#030303] border border-stone-900 rounded-2xl px-6 py-6 text-stone-300 outline-none focus:border-emerald-500/40 transition-all resize-none leading-relaxed shadow-inner custom-scrollbar text-lg font-serif h-full overflow-y-auto ${I?"hidden":"block"}`,style:he&&!I?{height:"calc(100vh - 300px)",minHeight:"500px"}:{minHeight:"500px"},value:R.content||"",onChange:y=>q({...R,content:y.target.value})}),l.jsx("div",{className:`w-full bg-[#030303] border border-stone-900 rounded-2xl px-6 py-6 text-stone-300 shadow-inner custom-scrollbar text-lg font-serif overflow-y-auto break-words ${I||he?"block":"hidden"}`,style:he&&!I?{height:"calc(100vh - 300px)",minHeight:"500px"}:{height:"100%",position:I?"absolute":"static",inset:0,zIndex:10},children:(I||he)&&_c(R.content||"",p,m,I?void 0:F,y=>De(y),t)})]}),l.jsxs("div",{className:"flex justify-between items-start mt-2 px-2 pb-10",children:[l.jsx("p",{className:"text-[8px] text-stone-700 italic",children:": # , > , --- "}),l.jsx("p",{className:"text-[8px] text-stone-700 italic",children:"**B**, __I__, ~~S~~, ||Spoiler||, [c=hex]Color[/c], [link=url]Text[/link], [tip=Text]Trig[/tip], [char=ID]Name[/char]"})]})]})]})]})},cx=({character:s,isAdmin:t,allCharacters:r,availableTags:i,availableHiddenTags:c,worlds:d,notes:f=[],onBack:p,onSave:m,onSelectCharacter:x,onSelectWikiEntry:w,onDeleteNote:_})=>{var re,We;const[v,j]=O.useState(s),[$,R]=O.useState(!1),[q,de]=O.useState(!1),[fe,Se]=O.useState(!1),[J,Me]=O.useState(!1),[Z,A]=O.useState(new Set),[X,Ce]=O.useState(""),[P,Ee]=O.useState([]);O.useEffect(()=>{j(s)},[s]);const ye=O.useMemo(()=>{var D,se;if(!d)return null;for(const k of d){if((D=k.characterIds)!=null&&D.includes(s.id))return k.name;if(k.subLocations){for(const Q of k.subLocations)if((se=Q.characterIds)!=null&&se.includes(s.id))return`${k.name} / ${Q.name}`}}return null},[d,s.id]),ke=O.useMemo(()=>Array.isArray(f)?f.filter(D=>D&&(D.targetId===s.id||D.authorId===s.id)):[],[f,s.id]),ue=(D,se)=>{j(k=>({...k,[D]:se}))},Ye=D=>{j(se=>({...se,imageScale:D.scale??se.imageScale,imageX:D.x??se.imageX,imageY:D.y??se.imageY}))},ae=D=>{j(se=>({...se,miniImageScale:D.scale??se.miniImageScale,miniImageX:D.x??se.miniImageX,miniImageY:D.y??se.miniImageY}))},ze=async D=>{var k;const se=(k=D.target.files)==null?void 0:k[0];if(se){Me(!0);try{const Q=await Ui(se);ue("imageUrl",Q)}catch(Q){console.error("Error processing image",Q),alert("   ")}finally{Me(!1)}}},H=(D,se=!1)=>{if(se){const k=v.hiddenTags||[],Q=k.includes(D)?k.filter(ie=>ie!==D):[...k,D];ue("hiddenTags",Q)}else{const k=v.tags||[],Q=k.includes(D)?k.filter(ie=>ie!==D):[...k,D];ue("tags",Q)}},U=()=>{m(v)},N=()=>{j(s)},I=()=>{t&&m(v),p()},ee=()=>{Se(!fe),Ce(""),Ee([])},he=D=>{const se={id:D.id,name:D.name,role:"",color:"#ef4444"},k=v.connections||[];k.some(Q=>Q.id===D.id)||ue("connections",[...k,se]),Se(!1)},Le=D=>{const se=v.connections||[];ue("connections",se.filter(k=>k.id!==D))},Ae=(D,se)=>{const k=v.connections||[];ue("connections",k.map(Q=>Q.id===D?{...Q,role:se}:Q))},De=(D,se)=>{const k=v.connections||[];ue("connections",k.map(Q=>Q.id===D?{...Q,color:se}:Q))},xe=D=>{Ee(se=>se.includes(D)?se.filter(k=>k!==D):[...se,D])},F=D=>{A(se=>{const k=new Set(se);return k.has(D)?k.delete(D):k.add(D),k})},W=r.filter(D=>{var se;if(!D||D.id===v.id||(se=v.connections)!=null&&se.some(k=>k.id===D.id)||X&&!D.name.toLowerCase().includes(X.toLowerCase()))return!1;if(P.length>0){const k=[...D.tags||[],...D.hiddenTags||[]];return P.every(Q=>k.includes(Q))}return!0});return l.jsxs("div",{className:"animate-reveal-details space-y-6 md:space-y-8 pb-20",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4 animate-stagger-1",children:[l.jsxs("button",{onClick:I,className:"flex items-center text-stone-500 hover:text-emerald-500 transition-colors group text-sm md:text-base order-1",children:[l.jsx("svg",{className:"w-5 h-5 mr-2 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})," ()"]}),t&&l.jsxs("div",{className:"flex items-center gap-3 order-2 w-full md:w-auto justify-end",children:[l.jsx("button",{onClick:N,className:"px-4 py-2 rounded-lg border border-stone-800 text-stone-500 hover:text-white hover:bg-stone-800 text-[10px] uppercase font-bold tracking-wider transition-all",children:""}),l.jsxs("button",{onClick:U,className:"px-5 py-2 rounded-lg bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 hover:bg-emerald-900/40 text-[10px] uppercase font-bold tracking-wider transition-all flex items-center gap-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),""]})]})]}),l.jsxs("div",{className:"block clearfix",children:[l.jsxs("div",{className:"w-full lg:w-[35%] lg:float-left lg:mr-12 mb-8 space-y-8 animate-stagger-2",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h4",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 px-1",children:" "}),t?l.jsxs("div",{className:"space-y-4",children:[l.jsx(Bi,{imageUrl:v.imageUrl,scale:v.imageScale??1,x:v.imageX??50,y:v.imageY??50,onUpdate:Ye}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{className:"w-full bg-[#050505] border border-stone-800 rounded-lg px-3 py-2 text-[10px] text-stone-400 outline-none focus:border-emerald-500",placeholder:v.imageUrl.startsWith("data:")?"   ":"URL ...",value:v.imageUrl.startsWith("data:")?"":v.imageUrl,onChange:D=>ue("imageUrl",D.target.value)}),l.jsxs("label",{className:`cursor-pointer bg-stone-900 border border-stone-800 hover:bg-stone-800 rounded-lg px-3 flex items-center justify-center transition-colors ${J?"opacity-50":""}`,children:[l.jsx("input",{type:"file",onChange:ze,accept:"image/*",className:"hidden",disabled:J}),l.jsx("svg",{className:"w-4 h-4 text-emerald-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})]})]})]}):l.jsx("div",{className:"aspect-[4/5] rounded-2xl overflow-hidden border border-stone-800 shadow-2xl bg-black transition-transform duration-700 hover:scale-[1.02]",children:l.jsx("img",{src:v.imageUrl,alt:v.name,style:{objectFit:"cover",objectPosition:`${v.imageX??50}% ${v.imageY??50}%`,transformOrigin:`${v.imageX??50}% ${v.imageY??50}%`,transform:`scale(${v.imageScale??1})`},className:"w-full h-full"})})]}),t&&l.jsxs("div",{className:"space-y-4 pt-4 border-t border-stone-900/50",children:[l.jsx("h4",{className:"text-[10px] uppercase tracking-widest font-bold text-emerald-500/60 px-1",children:"- ()"}),l.jsx(Bi,{imageUrl:v.imageUrl,scale:v.miniImageScale??1,x:v.miniImageX??50,y:v.miniImageY??50,isCircular:!0,onUpdate:ae})]}),l.jsxs("div",{className:"space-y-5 p-5 md:p-7 bg-[#0f0f0f]/40 border border-stone-900 rounded-[2rem] md:rounded-[2.5rem] shadow-inner transition-all hover:bg-[#0f0f0f]/50",children:[l.jsx("h4",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-emerald-500/60 px-1 text-center",children:""}),l.jsx("div",{className:"flex flex-wrap gap-2 justify-center min-h-[40px]",children:t?l.jsxs(l.Fragment,{children:[i.map(D=>{var se;return l.jsx("button",{onClick:()=>H(D,!1),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border ${(se=v.tags)!=null&&se.includes(D)?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400":"bg-stone-950 border-stone-800/50 text-stone-700 hover:text-stone-400"}`,children:D},D)}),i.length>0&&c.length>0&&l.jsx("div",{className:"w-full h-px bg-stone-900/50 my-1"}),c.map(D=>{var se;return l.jsx("button",{onClick:()=>H(D,!0),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border ${(se=v.hiddenTags)!=null&&se.includes(D)?"bg-amber-500/10 border-amber-500/40 text-amber-400":"bg-stone-950 border-stone-800/50 text-stone-700 hover:text-stone-400"}`,children:D},D)})]}):(re=v.tags)==null?void 0:re.map(D=>l.jsx("span",{className:"px-3 py-1.5 md:px-4 md:py-2 bg-emerald-500/5 border border-emerald-500/10 text-emerald-500/70 text-[9px] md:text-[10px] uppercase tracking-widest font-black rounded-xl",children:D},D))})]})]}),l.jsx("div",{className:"animate-stagger-3",children:l.jsxs("div",{className:"mb-6 md:mb-8",children:[t?l.jsx("div",{className:"space-y-4 mb-4",children:l.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[l.jsxs("div",{className:"flex-grow",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-1",children:""}),l.jsx("input",{className:"w-full bg-transparent border-b border-stone-800 text-3xl md:text-4xl font-serif font-bold text-stone-100 outline-none focus:border-emerald-800 transition-colors py-1",value:v.name,onChange:D=>ue("name",D.target.value)})]}),l.jsxs("div",{className:"w-full md:w-32",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-1",children:""}),l.jsx("input",{className:"w-full bg-transparent border-b border-stone-800 text-xl font-light text-stone-500 outline-none focus:border-emerald-800 transition-colors py-2",value:v.age,onChange:D=>ue("age",D.target.value)})]}),l.jsxs("div",{className:"w-full md:w-32",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-1",children:""}),l.jsx("input",{className:"w-full bg-transparent border-b border-stone-800 text-xl font-light text-stone-500 outline-none focus:border-emerald-800 transition-colors py-2",value:v.height||"",placeholder:". 180 ",onChange:D=>ue("height",D.target.value)})]})]})}):l.jsxs("div",{className:"space-y-4 mb-6",children:[l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 md:gap-6",children:[l.jsx("h1",{className:"text-3xl md:text-5xl font-serif font-bold text-stone-100 leading-tight",children:v.name}),l.jsxs("div",{className:"flex items-center gap-2",children:[v.age&&l.jsxs("div",{className:"bg-stone-900 border border-stone-800 px-3 py-1 rounded-xl flex items-baseline gap-1.5 shadow-lg",children:[l.jsx("span",{className:"text-stone-100 font-bold text-lg",children:v.age.toString().replace(/[^0-9]/g,"")||v.age}),l.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-emerald-500/70",children:""})]}),v.height&&l.jsxs("div",{className:"bg-stone-900 border border-stone-800 px-3 py-1 rounded-xl flex items-baseline gap-1.5 shadow-lg",children:[l.jsx("span",{className:"text-stone-100 font-bold text-lg",children:v.height.toString().replace(/[^0-9]/g,"")||v.height}),l.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-emerald-500/70",children:""})]})]})]}),ye&&l.jsxs("div",{className:"inline-flex items-center gap-2 bg-emerald-900/10 border border-emerald-900/30 px-3 py-1.5 rounded-full mt-2",children:[l.jsx("span",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"}),l.jsx("span",{className:"text-[10px] uppercase tracking-widest font-bold text-emerald-500",children:ye})]})]}),l.jsx("div",{className:"h-px bg-stone-900 w-full mb-6 md:mb-8"}),l.jsxs("section",{className:"space-y-4 mb-8",children:[l.jsx("h4",{className:"text-emerald-500 text-sm font-semibold uppercase tracking-wider",children:""}),t?l.jsx("textarea",{className:"w-full bg-stone-900/20 border border-stone-800 rounded-xl p-4 text-stone-200 text-base md:text-lg leading-relaxed font-light outline-none focus:border-emerald-900 transition-colors resize-none break-words",rows:12,value:v.additionalInfo,onChange:D=>ue("additionalInfo",D.target.value)}):l.jsx("p",{className:"text-stone-300 text-base md:text-lg leading-relaxed font-light whitespace-pre-wrap break-words",children:v.additionalInfo})]}),ke.length>0&&l.jsxs("div",{className:"space-y-3 mb-6",children:[l.jsxs("button",{onClick:()=>de(!q),className:"w-full flex items-center justify-between bg-[#0f0f0f]/30 border border-stone-900 p-4 md:p-5 rounded-xl transition-all group hover:border-amber-900/30 shadow-md",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-amber-600 font-bold tracking-widest text-xs uppercase",children:"  "}),l.jsxs("span",{className:"text-stone-600 text-sm",children:["(",ke.length,")"]})]}),l.jsx("svg",{className:`w-4 h-4 text-stone-600 transition-transform duration-300 ${q?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]}),l.jsx("div",{className:`grid transition-[grid-template-rows,opacity] duration-500 ease-[cubic-bezier(0.4,0,0.2,1)] ${q?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"}`,children:l.jsx("div",{className:"overflow-hidden",children:l.jsx("div",{className:"space-y-4 pt-4",children:ke.map(D=>{const se=r.find(me=>me.id===D.authorId),k=r.find(me=>me.id===D.targetId),Q=D.authorId===s.id,ie=Z.has(D.id);return l.jsxs("div",{className:"bg-stone-900/20 border border-stone-900/50 rounded-xl p-4 md:p-5 hover:border-emerald-900/30 transition-colors",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3 border-b border-stone-900/50 pb-2",children:[l.jsx("div",{className:"flex items-center gap-2",children:Q?l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-stone-600",children:":"}),l.jsx("span",{className:"text-[10px] uppercase tracking-widest font-bold text-emerald-500",children:k?k.name:""})]}):l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-stone-600",children:":"}),l.jsx("span",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-300",children:se?se.name:""})]})}),l.jsx("span",{className:"text-[9px] uppercase font-bold text-stone-700",children:D.date})]}),l.jsx("h5",{className:"text-stone-200 font-serif italic text-xl mb-2 break-words",children:D.title}),!ie&&l.jsxs("button",{onClick:()=>F(D.id),className:"text-[9px] uppercase tracking-[0.2em] font-black text-stone-600 hover:text-emerald-500 transition-colors pt-2 flex items-center gap-1 outline-none",children:["",l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),l.jsx("div",{className:`grid transition-[grid-template-rows,opacity] duration-500 ease-[cubic-bezier(0.4,0,0.2,1)] ${ie?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"}`,children:l.jsx("div",{className:"overflow-hidden",children:l.jsxs("div",{className:"pt-2",children:[l.jsx("div",{className:"text-stone-400 text-sm md:text-base leading-relaxed whitespace-pre-wrap font-light break-words",children:_c(D.content,x,w,void 0,void 0,r)}),l.jsxs("button",{onClick:()=>F(D.id),className:"text-[9px] uppercase tracking-[0.2em] font-black text-emerald-900 hover:text-emerald-600 transition-colors flex items-center gap-1 mt-4",children:[l.jsx("svg",{className:"w-3 h-3 rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),""]})]})})})]},D.id)})})})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex flex-col gap-4",children:[t&&l.jsxs("button",{onClick:ee,className:`w-full py-4 rounded-xl border transition-all text-[10px] uppercase font-bold tracking-[0.2em] flex items-center justify-center gap-3 ${fe?"bg-emerald-500 border-emerald-400 text-black shadow-[0_0_20px_rgba(16,185,129,0.2)]":"bg-emerald-900/20 border-emerald-900/50 text-emerald-400 hover:bg-emerald-900/30"}`,children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:fe?"M6 18L18 6M6 6l12 12":"M12 4v16m8-8H4"})}),fe?"":" "]}),l.jsxs("button",{onClick:()=>R(!$),className:"w-full flex items-center justify-between bg-[#0f0f0f]/30 border border-stone-900 p-4 md:p-5 rounded-xl transition-all group hover:border-emerald-900/30 shadow-md",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-emerald-500 font-bold tracking-widest text-xs uppercase",children:""}),l.jsxs("span",{className:"text-stone-600 text-sm",children:["(",((We=v.connections)==null?void 0:We.length)||0,")"]})]}),l.jsx("svg",{className:`w-4 h-4 text-stone-600 transition-transform duration-300 ${$?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]})]}),t&&fe&&l.jsxs("div",{className:"animate-reveal-details bg-[#0a0a0a] border border-emerald-900/30 rounded-2xl p-4 md:p-6 space-y-4 shadow-2xl overflow-hidden relative",children:[l.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:l.jsx("input",{autoFocus:!0,type:"text",placeholder:"   ...",className:"flex-grow bg-stone-950 border border-stone-800 rounded-xl px-4 py-3 text-sm text-stone-200 outline-none focus:border-emerald-500/50 transition-colors",value:X,onChange:D=>Ce(D.target.value)})}),l.jsx("div",{className:"flex flex-wrap gap-1.5 max-h-24 overflow-y-auto custom-scrollbar",children:i.map(D=>l.jsx("button",{onClick:()=>xe(D),className:`px-2 py-1 rounded-lg text-[9px] uppercase font-bold tracking-wider transition-all border ${P.includes(D)?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:D},D))}),l.jsx("div",{className:"flex flex-col gap-2 max-h-60 overflow-y-auto custom-scrollbar pr-2",children:W.length>0?W.map(D=>l.jsxs("button",{onClick:()=>he(D),className:"flex items-center gap-4 p-3 bg-stone-900/50 border border-stone-800 rounded-xl hover:bg-emerald-900/20 hover:border-emerald-900/40 transition-all text-left group",children:[l.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:l.jsx("img",{src:D.imageUrl,style:{objectFit:"cover",objectPosition:`${D.miniImageX??50}% ${D.miniImageY??50}%`,transformOrigin:`${D.miniImageX??50}% ${D.miniImageY??50}%`,transform:`scale(${D.miniImageScale??1})`},className:"w-full h-full",alt:""})}),l.jsxs("div",{className:"min-w-0 flex-grow",children:[l.jsx("span",{className:"text-stone-200 font-bold text-sm block truncate group-hover:text-emerald-400",children:D.name}),l.jsx("span",{className:"text-[10px] text-stone-600 uppercase tracking-widest block truncate",children:"  "})]}),l.jsx("svg",{className:"w-4 h-4 text-emerald-500 opacity-0 group-hover:opacity-100 transition-all",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})]},D.id)):l.jsx("p",{className:"text-stone-700 italic text-xs py-4 text-center",children:"  "})})]}),l.jsx("div",{className:`grid transition-[grid-template-rows,opacity] duration-500 ease-[cubic-bezier(0.4,0,0.2,1)] ${$?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"}`,children:l.jsx("div",{className:"overflow-hidden",children:l.jsx("div",{className:"space-y-3 pt-3",children:l.jsx("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-xl overflow-hidden divide-y divide-stone-900/50",children:v.connections&&v.connections.length>0?v.connections.map(D=>{const se=r.find(k=>k&&k.id===D.id);return l.jsxs("div",{className:"p-4 flex flex-row items-center gap-4 group hover:bg-stone-900/20 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-4 flex-grow min-w-0",children:[l.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 rounded-full overflow-hidden border border-stone-800 shrink-0 bg-black",children:l.jsx("img",{src:(se==null?void 0:se.imageUrl)||"",style:{objectFit:"cover",objectPosition:`${(se==null?void 0:se.miniImageX)??50}% ${(se==null?void 0:se.miniImageY)??50}%`,transformOrigin:`${(se==null?void 0:se.miniImageX)??50}% ${(se==null?void 0:se.miniImageY)??50}%`,transform:`scale(${(se==null?void 0:se.miniImageScale)??1})`},className:"w-full h-full",alt:""})}),l.jsxs("div",{className:"flex-grow min-w-0",children:[l.jsx("p",{className:"text-stone-200 font-bold text-sm truncate",children:D.name}),t?l.jsx("input",{className:"bg-transparent border-b border-stone-800 text-xs text-stone-500 outline-none focus:border-emerald-500 py-1 w-full max-w-[150px]",value:D.role,onChange:k=>Ae(D.id,k.target.value)}):l.jsx("p",{className:"text-stone-600 text-xs mt-1 font-medium truncate",children:D.role})]})]}),l.jsxs("div",{className:"flex items-center justify-end gap-5 shrink-0",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[t?l.jsx("input",{type:"color",className:"w-6 h-6 rounded-sm bg-transparent border-none cursor-pointer p-0 appearance-none shadow-lg",value:D.color||"#ef4444",onChange:k=>De(D.id,k.target.value)}):l.jsx("div",{className:"w-4 h-4 rounded-sm shadow-sm",style:{backgroundColor:D.color||"#ef4444"}}),l.jsx("button",{onClick:()=>x(D.id),className:"text-stone-700 hover:text-stone-100 transition-colors text-[9px] md:text-[10px] uppercase font-bold tracking-[0.2em]",children:""})]}),t&&l.jsx("button",{onClick:()=>Le(D.id),className:"text-stone-800 hover:text-red-500 transition-colors p-1",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})]},D.id)}):l.jsx("div",{className:"p-10 text-center text-stone-700 italic text-sm",children:"  "})})})})})]})]})})]})]})},ux=({initialData:s,availableTags:t,availableHiddenTags:r,onSave:i,onClose:c})=>{const[d,f]=O.useState({name:"",age:"",height:"",imageUrl:"",additionalInfo:"",imageScale:1,imageX:50,imageY:50,tags:[],hiddenTags:[]}),[p,m]=O.useState(!1);O.useEffect(()=>{var v;s&&f({name:s.name,age:s.age.toString(),height:((v=s.height)==null?void 0:v.toString())||"",imageUrl:s.imageUrl,additionalInfo:s.additionalInfo,imageScale:s.imageScale??1,imageX:s.imageX??50,imageY:s.imageY??50,tags:s.tags||[],hiddenTags:s.hiddenTags||[]})},[s]);const x=(v,j)=>{f(j?$=>({...$,hiddenTags:$.hiddenTags.includes(v)?$.hiddenTags.filter(R=>R!==v):[...$.hiddenTags,v]}):$=>({...$,tags:$.tags.includes(v)?$.tags.filter(R=>R!==v):[...$.tags,v]}))},w=async v=>{var $;const j=($=v.target.files)==null?void 0:$[0];if(j){m(!0);try{const R=await Ui(j);f(q=>({...q,imageUrl:R}))}catch(R){console.error("Error processing image",R),alert("   .")}finally{m(!1)}}},_=v=>{v.preventDefault();const j={id:(s==null?void 0:s.id)||Date.now().toString(),name:d.name,age:d.age,height:d.height,imageUrl:d.imageUrl||`https://picsum.photos/seed/${Date.now()}/400/500`,additionalInfo:d.additionalInfo,tags:d.tags,hiddenTags:d.hiddenTags,connections:(s==null?void 0:s.connections)||[],imageScale:d.imageScale,imageX:d.imageX,imageY:d.imageY};i(j)};return l.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center p-4 bg-black/95 backdrop-blur-2xl animate-in fade-in duration-300",children:l.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-2xl rounded-[2rem] md:rounded-[3rem] overflow-hidden shadow-[0_0_120px_rgba(0,0,0,1)] border-white/5 flex flex-col max-h-[90vh]",children:[l.jsxs("div",{className:"p-6 md:p-10 border-b border-stone-900 flex justify-between items-center bg-gradient-to-b from-stone-900/30 to-transparent shrink-0",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl md:text-3xl font-serif text-stone-100 italic",children:s?" ":" "}),l.jsx("p",{className:"text-stone-600 text-[10px] uppercase tracking-widest mt-1",children:"  "})]}),l.jsx("button",{onClick:c,className:"text-stone-700 hover:text-white transition-all p-2 md:p-3 hover:bg-white/5 rounded-full",children:l.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]}),l.jsxs("form",{onSubmit:_,className:"p-6 md:p-10 space-y-8 md:space-y-10 overflow-y-auto custom-scrollbar flex-grow",children:[l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:"  "}),l.jsx("input",{required:!0,className:"w-full bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-4 text-stone-100 outline-none focus:border-emerald-500/30 transition-all font-serif italic text-lg shadow-inner",value:d.name,onChange:v=>f({...d,name:v.target.value})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:""}),l.jsx("input",{required:!0,className:"w-full bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-4 text-stone-100 outline-none focus:border-emerald-500/30 transition-all shadow-inner",value:d.age,onChange:v=>f({...d,age:v.target.value})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:""}),l.jsx("input",{className:"w-full bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-4 text-stone-100 outline-none focus:border-emerald-500/30 transition-all shadow-inner",value:d.height,placeholder:". 185 ",onChange:v=>f({...d,height:v.target.value})})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-end px-1",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600",children:"  ()"}),l.jsxs("span",{className:"text-[9px] text-stone-800 font-black uppercase tracking-widest",children:[": ",d.tags.length]})]}),l.jsx("div",{className:"flex flex-wrap gap-2 p-6 bg-black/30 border border-stone-900 rounded-[2rem] min-h-[80px] shadow-inner",children:t.length===0?l.jsx("p",{className:"text-stone-800 italic text-xs w-full text-center py-4",children:"     -"}):t.map(v=>{const j=d.tags.includes(v);return l.jsx("button",{type:"button",onClick:()=>x(v,!1),className:`px-4 py-2 rounded-xl text-[10px] uppercase tracking-wider font-black transition-all border ${j?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":"bg-stone-900/20 border-stone-800/40 text-stone-600 hover:border-stone-700 hover:text-stone-400"}`,children:v},v)})})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-end px-1",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-amber-600",children:"  ()"}),l.jsxs("span",{className:"text-[9px] text-amber-900/60 font-black uppercase tracking-widest",children:[": ",d.hiddenTags.length]})]}),l.jsx("div",{className:"flex flex-wrap gap-2 p-6 bg-black/30 border border-amber-900/20 rounded-[2rem] min-h-[80px] shadow-inner",children:r.length===0?l.jsx("p",{className:"text-stone-800 italic text-xs w-full text-center py-4",children:"    "}):r.map(v=>{const j=d.hiddenTags.includes(v);return l.jsx("button",{type:"button",onClick:()=>x(v,!0),className:`px-4 py-2 rounded-xl text-[10px] uppercase tracking-wider font-black transition-all border ${j?"bg-amber-500/10 border-amber-500/40 text-amber-400 shadow-[0_0_15px_rgba(245,158,11,0.1)]":"bg-stone-900/20 border-stone-800/40 text-stone-600 hover:border-amber-900/30 hover:text-amber-500/50"}`,children:v},v)})})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:" (  )"}),l.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[l.jsx("input",{className:"flex-grow bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-3 text-xs text-stone-500 outline-none focus:border-emerald-500/30 transition-all",placeholder:"    ...",value:d.imageUrl.startsWith("data:")?"":d.imageUrl,onChange:v=>f({...d,imageUrl:v.target.value})}),l.jsxs("label",{className:`cursor-pointer bg-stone-900/50 hover:bg-stone-800 px-5 py-3 rounded-2xl transition-all flex items-center justify-center border border-stone-800 gap-2 ${p?"opacity-50 cursor-wait":""}`,children:[l.jsx("input",{type:"file",accept:"image/*",onChange:w,className:"hidden",disabled:p}),l.jsx("svg",{className:"w-5 h-5 text-stone-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),d.imageUrl.startsWith("data:")&&l.jsx("span",{className:"text-[9px] font-bold text-emerald-500 uppercase tracking-wider",children:""})]})]}),d.imageUrl.startsWith("data:")&&l.jsx("p",{className:"text-[9px] text-emerald-500/70 px-2",children:"    ."})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:" "}),l.jsx("textarea",{required:!0,rows:8,className:"w-full bg-stone-900/30 border border-stone-800 rounded-[2rem] px-8 py-6 text-stone-300 text-base leading-relaxed outline-none focus:border-emerald-900/30 transition-all resize-none shadow-inner custom-scrollbar",value:d.additionalInfo,onChange:v=>f({...d,additionalInfo:v.target.value})})]})]}),l.jsxs("div",{className:"p-6 md:p-10 border-t border-stone-900 bg-stone-900/10 flex gap-4 md:gap-6 shrink-0",children:[l.jsx("button",{type:"button",onClick:c,className:"flex-1 py-4 md:py-5 text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 hover:text-stone-300 transition-all",children:""}),l.jsx("button",{onClick:_,disabled:p,className:"flex-[2] py-4 md:py-5 bg-white hover:bg-emerald-50 text-black rounded-2xl text-[10px] uppercase tracking-[0.3em] font-black transition-all shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",children:p?"...":""})]})]})})},dx=({characters:s,availableTags:t,availableHiddenTags:r,onDelete:i,onEdit:c,onAdd:d,onUpdateTags:f,onUpdateHiddenTags:p,onDownloadDB:m,onUploadDB:x})=>{const[w,_]=O.useState(""),[v,j]=O.useState(""),$=O.useRef(null),R=A=>{A.preventDefault();const X=w.trim().toLowerCase();X&&!t.includes(X)&&(f([...t,X]),_(""))},q=A=>{A.preventDefault();const X=v.trim().toLowerCase();X&&!r.includes(X)&&(p([...r,X]),j(""))},de=A=>{f(t.filter(X=>X!==A))},fe=A=>{p(r.filter(X=>X!==A))},Se=(A,X,Ce=!1)=>{const P=Ce?[...r]:[...t],Ee=Ce?p:f;X==="left"&&A>0?[P[A-1],P[A]]=[P[A],P[A-1]]:X==="right"&&A<P.length-1&&([P[A+1],P[A]]=[P[A],P[A+1]]),Ee(P)},J=(A=!1)=>{window.confirm(` ,      ${A?"":""} ?`)&&(A?p([]):f([]))},Me=A=>{var P;const X=(P=A.target.files)==null?void 0:P[0];if(!X)return;const Ce=new FileReader;Ce.onload=Ee=>{var ke;const ye=(ke=Ee.target)==null?void 0:ke.result;typeof ye=="string"&&x(ye)},Ce.readAsText(X),$.current&&($.current.value="")},Z=(A,X)=>l.jsx("div",{className:"flex flex-wrap gap-2 max-h-[300px] overflow-y-auto custom-scrollbar pr-2",children:A.length===0?l.jsx("p",{className:"text-stone-800 italic text-[10px] w-full text-center py-8",children:" ."}):A.map((Ce,P)=>l.jsxs("div",{className:`group flex items-center border rounded-xl pr-2 pl-1 py-1 transition-all hover:bg-stone-900 ${X?"bg-amber-900/10 border-amber-900/30 hover:border-amber-700":"bg-stone-900/50 border-stone-800/50 hover:border-stone-600"}`,children:[l.jsx("button",{onClick:()=>Se(P,"left",X),disabled:P===0,className:`p-1 text-stone-600 hover:text-emerald-500 transition-all ${P===0?"opacity-0 pointer-events-none":"opacity-0 group-hover:opacity-100"}`,children:l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M15 19l-7-7 7-7"})})}),l.jsx("span",{className:`text-[10px] uppercase tracking-wider font-bold px-1 select-none ${X?"text-amber-500":"text-stone-500"}`,children:Ce}),l.jsx("button",{onClick:()=>Se(P,"right",X),disabled:P===A.length-1,className:`p-1 text-stone-600 hover:text-emerald-500 transition-all ${P===A.length-1?"opacity-0 pointer-events-none":"opacity-0 group-hover:opacity-100"}`,children:l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M9 5l7 7-7 7"})})}),l.jsx("div",{className:`w-px h-3 mx-1 ${X?"bg-amber-900/30":"bg-stone-800"}`}),l.jsx("button",{onClick:()=>X?fe(Ce):de(Ce),className:"text-stone-700 hover:text-red-500 transition-colors ml-1",children:l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:l.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]},Ce))});return l.jsxs("div",{className:"space-y-12 animate-in fade-in duration-700 pb-32",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-b border-stone-900/50 pb-8",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100",children:""}),l.jsx("p",{className:"text-stone-500 uppercase tracking-widest text-[10px]",children:"   "})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("input",{type:"file",ref:$,onChange:Me,accept:".json",className:"hidden"}),l.jsxs("button",{onClick:()=>{var A;return(A=$.current)==null?void 0:A.click()},className:"px-5 py-2.5 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 rounded-lg text-[10px] uppercase tracking-widest font-bold text-emerald-500 transition-all flex items-center gap-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})," "]}),l.jsxs("button",{onClick:m,className:"px-5 py-2.5 bg-stone-900/80 hover:bg-stone-800 border border-stone-700 rounded-lg text-[10px] uppercase tracking-widest font-bold text-stone-300 transition-all flex items-center gap-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})," "]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[l.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("h2",{className:"text-2xl font-serif text-stone-100 italic",children:" "}),l.jsx("span",{className:"text-[10px] bg-emerald-500/10 text-emerald-500 px-2 py-0.5 rounded-full font-black",children:s.length})]}),l.jsx("button",{onClick:d,className:"bg-white hover:bg-emerald-50 text-black px-6 py-2 rounded-full text-[10px] uppercase tracking-widest font-black transition-all",children:""})]}),l.jsx("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl overflow-hidden shadow-xl",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-left min-w-[600px]",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-stone-900 bg-stone-900/20",children:[l.jsx("th",{className:"px-6 py-5 text-[10px] uppercase tracking-widest font-black text-stone-600",children:""}),l.jsx("th",{className:"px-6 py-5 text-[10px] uppercase tracking-widest font-black text-stone-600",children:""}),l.jsx("th",{className:"px-6 py-5 text-[10px] uppercase tracking-widest font-black text-stone-600 text-right",children:""})]})}),l.jsx("tbody",{className:"divide-y divide-stone-900/50",children:s.map(A=>{var X,Ce,P,Ee;return l.jsxs("tr",{className:"hover:bg-stone-900/10 transition-colors",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:l.jsx("img",{src:A.imageUrl,style:{objectFit:"cover",objectPosition:`${A.miniImageX??50}% ${A.miniImageY??50}%`,transformOrigin:`${A.miniImageX??50}% ${A.miniImageY??50}%`,transform:`scale(${A.miniImageScale??1})`},className:"w-full h-full",alt:""})}),l.jsx("span",{className:"font-bold text-stone-200 text-sm tracking-wide",children:A.name})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsxs("div",{className:"flex flex-wrap gap-1",children:[(X=A.tags)==null?void 0:X.slice(0,3).map(ye=>l.jsx("span",{className:"text-[8px] uppercase bg-stone-900 px-1.5 py-0.5 rounded text-stone-500",children:ye},ye)),(((Ce=A.tags)==null?void 0:Ce.length)||0)>3&&l.jsxs("span",{className:"text-[8px] text-stone-700",children:["+",A.tags.length-3]})]}),l.jsxs("div",{className:"flex flex-wrap gap-1",children:[(P=A.hiddenTags)==null?void 0:P.slice(0,3).map(ye=>l.jsx("span",{className:"text-[8px] uppercase bg-amber-900/20 border border-amber-900/30 px-1.5 py-0.5 rounded text-amber-600",children:ye},ye)),(((Ee=A.hiddenTags)==null?void 0:Ee.length)||0)>3&&l.jsxs("span",{className:"text-[8px] text-amber-700",children:["+",A.hiddenTags.length-3]})]})]})}),l.jsxs("td",{className:"px-6 py-4 text-right space-x-3",children:[l.jsx("button",{onClick:()=>c(A),className:"text-emerald-500/70 hover:text-emerald-500 text-[10px] font-black uppercase tracking-widest transition-colors",children:""}),l.jsx("button",{onClick:()=>i(A.id),className:"text-stone-800 hover:text-red-500 text-[10px] font-black uppercase tracking-widest transition-colors",children:""})]})]},A.id)})})]})})})]}),l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl p-6 space-y-6 shadow-xl",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h2",{className:"text-xl font-serif text-stone-100 italic",children:" "}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-[10px] bg-stone-800 text-stone-400 px-2 py-0.5 rounded-full font-black",children:t.length}),t.length>0&&l.jsx("button",{onClick:()=>J(!1),className:"text-[8px] text-red-900 hover:text-red-500 uppercase font-black",children:""})]})]}),l.jsxs("form",{onSubmit:R,className:"flex gap-2",children:[l.jsx("input",{type:"text",value:w,onChange:A=>_(A.target.value),placeholder:" ...",className:"flex-grow bg-black/50 border border-stone-800 rounded-xl px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-all"}),l.jsx("button",{className:"bg-stone-800 hover:bg-stone-700 text-white p-2 rounded-xl transition-all",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{d:"M12 4v16m8-8H4",strokeWidth:2.5})})})]}),Z(t,!1)]}),l.jsxs("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl p-6 space-y-6 shadow-xl relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-amber-500/5 rounded-full blur-2xl -translate-y-10 translate-x-10 pointer-events-none"}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h2",{className:"text-xl font-serif text-amber-500 italic",children:" "}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-[10px] bg-amber-900/20 text-amber-500 px-2 py-0.5 rounded-full font-black",children:r.length}),r.length>0&&l.jsx("button",{onClick:()=>J(!0),className:"text-[8px] text-red-900 hover:text-red-500 uppercase font-black",children:""})]})]}),l.jsxs("form",{onSubmit:q,className:"flex gap-2",children:[l.jsx("input",{type:"text",value:v,onChange:A=>j(A.target.value),placeholder:"  ...",className:"flex-grow bg-black/50 border border-amber-900/30 rounded-xl px-3 py-2 text-xs text-stone-200 outline-none focus:border-amber-500/50 transition-all placeholder-amber-900/50"}),l.jsx("button",{className:"bg-amber-900/20 hover:bg-amber-900/40 text-amber-500 border border-amber-900/30 p-2 rounded-xl transition-all",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{d:"M12 4v16m8-8H4",strokeWidth:2.5})})})]}),Z(r,!0)]})]})]})]})},hx="modulepreload",fx=function(s){return"/"+s},wf={},bf=function(t,r,i){let c=Promise.resolve();if(r&&r.length>0){let f=function(x){return Promise.all(x.map(w=>Promise.resolve(w).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),m=(p==null?void 0:p.nonce)||(p==null?void 0:p.getAttribute("nonce"));c=f(r.map(x=>{if(x=fx(x),x in wf)return;wf[x]=!0;const w=x.endsWith(".css"),_=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${_}`))return;const v=document.createElement("link");if(v.rel=w?"stylesheet":hx,w||(v.as="script"),v.crossOrigin="",v.href=x,m&&v.setAttribute("nonce",m),document.head.appendChild(v),w)return new Promise((j,$)=>{v.addEventListener("load",j),v.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${x}`)))})}))}function d(f){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=f,window.dispatchEvent(p),!p.defaultPrevented)throw f}return c.then(f=>{for(const p of f||[])p.status==="rejected"&&d(p.reason);return t().catch(d)})},px=({characters:s,availableTags:t,availableHiddenTags:r,filterStates:i,onToggleTag:c,onClearFilters:d,onSelectCharacter:f})=>{var se;const[p,m]=O.useState("graph"),[x,w]=O.useState(""),[_,v]=O.useState(!1),[j,$]=O.useState(""),[R,q]=O.useState([]),de=O.useRef(null),[fe,Se]=O.useState(!1),[J,Me]=O.useState(null),[Z,A]=O.useState(null),[X,Ce]=O.useState(0),[P,Ee]=O.useState(!0),[ye,ke]=O.useState(!1),ue=O.useRef(null),Ye=O.useRef(null),ae=O.useRef(null),ze=O.useRef(null),H=O.useRef(new Map),[U,N]=O.useState({x:0,y:0,k:1}),I=Object.keys(i).length;O.useEffect(()=>{if(p==="graph"){ke(!0);const k=setTimeout(()=>ke(!1),2200);return()=>clearTimeout(k)}},[J,fe,I,p]),O.useEffect(()=>{const k=Q=>{de.current&&!de.current.contains(Q.target)&&v(!1)};return _&&document.addEventListener("mousedown",k),()=>{document.removeEventListener("mousedown",k)}},[_]);const{nodes:ee,links:he,uniqueColors:Le}=O.useMemo(()=>{if(p!=="graph")return{nodes:[],links:[],uniqueColors:[]};const k=s.filter(K=>J&&K.id===J?!0:Object.entries(i).every(([y,z])=>{var dt,ht;const le=(dt=K.tags)==null?void 0:dt.includes(y),je=(ht=K.hiddenTags)==null?void 0:ht.includes(y),Re=le||je;return z==="include"?Re:z==="exclude"?!Re:!0})),Q=new Set(k.map(K=>K.id)),ie=new Set;J&&(ie.add(J),k.forEach(K=>{var y,z;K.id===J&&((y=K.connections)==null||y.forEach(le=>{Q.has(le.id)&&ie.add(le.id)})),(z=K.connections)!=null&&z.some(le=>le.id===J)&&ie.add(K.id)}));const me=new Map,S=[...t],ne=380,_e=260;S.forEach((K,y)=>{const z=y/S.length*2*Math.PI;me.set(K,{x:500+Math.cos(z)*ne,y:350+Math.sin(z)*_e})});const $e=k.map(K=>{const y=H.current.get(K.id);let z=!1;if(J)z=!ie.has(K.id);else if(fe){const Re=K.connections||[],dt=k.filter(ht=>{var Dt;return ht.id!==K.id&&((Dt=ht.connections)==null?void 0:Dt.some(qt=>qt.id===K.id))});z=Re.length+dt.length===0}let le=500,je=350;if(!y)if(K.tags&&K.tags.length>0){let Re=0,dt=0,ht=0;K.tags.forEach(Dt=>{const qt=me.get(Dt);qt&&(Re+=qt.x,dt+=qt.y,ht++)}),ht>0?(le=Re/ht,je=dt/ht,le+=(Math.random()-.5)*80,je+=(Math.random()-.5)*80):(le+=(Math.random()-.5)*150,je+=(Math.random()-.5)*150)}else le+=(Math.random()-.5)*120,je+=(Math.random()-.5)*120;return{id:K.id,name:K.name,imageUrl:K.imageUrl,miniImageScale:K.miniImageScale,miniImageX:K.miniImageX,miniImageY:K.miniImageY,x:(y==null?void 0:y.x)??le,y:(y==null?void 0:y.y)??je,vx:y==null?void 0:y.vx,vy:y==null?void 0:y.vy,isDimmed:z,tags:K.tags,hiddenTags:K.hiddenTags}}),Ge=new Map;$e.forEach(K=>Ge.set(K.id,K)),H.current=Ge;const B=[],ce=new Set,we=new Map;return k.forEach(K=>{var y;(y=K.connections)==null||y.forEach(z=>{if(Q.has(z.id)){const le=z.color||"#10b981";ce.add(le);let je=!1;J&&(je=K.id!==J&&z.id!==J),B.push({source:K.id,target:z.id,role:z.role,color:le,isDouble:!1,isHidden:je}),we.set(`${K.id}-${z.id}`,!0)}})}),B.forEach(K=>{const y=typeof K.source=="string"?K.source:K.source.id,z=typeof K.target=="string"?K.target:K.target.id;we.has(`${z}-${y}`)&&(K.isDouble=!0)}),{nodes:$e,links:B,uniqueColors:Array.from(ce)}},[s,fe,J,i,t,p]),Ae=k=>{if(!ue.current||!ze.current)return;const Q=ee.find(ie=>ie.id===k);!Q||Q.x===void 0||Q.y===void 0||bf(()=>import("https://esm.sh/d3@7"),[]).then(ie=>{const me=ie.select(ue.current),S=1e3,ne=700,_e=.8,$e=S/2-Q.x*_e,Ge=ne/2-Q.y*_e;me.transition().duration(1200).ease(ie.easePolyInOut.exponent(3)).call(ze.current.transform,ie.zoomIdentity.translate($e,Ge).scale(_e))})};O.useEffect(()=>{if(J&&p==="graph"){const k=setTimeout(()=>Ae(J),100);return()=>clearTimeout(k)}},[J,p]),O.useEffect(()=>{!ue.current||p!=="graph"||(Ee(!0),bf(()=>import("https://esm.sh/d3@7"),[]).then(k=>{const Q=k.select(ue.current),ie=k.select(Ye.current),me=k.zoom().scaleExtent([.1,4]).on("zoom",_e=>{ie.attr("transform",_e.transform),N({x:_e.transform.x,y:_e.transform.y,k:_e.transform.k}),A(null)});ze.current=me,Q.call(me);const S=k.forceSimulation(ee).velocityDecay(.4).force("link",k.forceLink(he.filter(_e=>!_e.isHidden)).id(_e=>_e.id).distance(_e=>{const $e=_e.source.tags||[],Ge=_e.target.tags||[],B=$e.some(ce=>Ge.includes(ce));return $e.length===0||Ge.length===0?250:B?150:450}).strength(J?.05:.03)).force("charge",k.forceManyBody().strength(J?-5e3:-3500)).force("x",k.forceX(500).strength(.05)).force("y",k.forceY(350).strength(.05)).force("collision",k.forceCollide().radius(90)).alphaDecay(.05);S.on("tick",()=>{Ce(_e=>_e+1),S.alpha()<.2&&Ee(!1)}),ae.current=S;const ne=_e=>{function $e(ce,we){ce.active||_e.alphaTarget(.3).restart(),we.fx=we.x,we.fy=we.y,A(null)}function Ge(ce,we){we.fx=ce.x,we.fy=ce.y}function B(ce,we){ce.active||_e.alphaTarget(0),we.fx=null,we.fy=null}return k.drag().on("start",$e).on("drag",Ge).on("end",B)};return ie.selectAll(".node-group").data(ee).call(ne(S)),()=>S.stop()}))},[ee,he,p]);const De=k=>{const Q=typeof k.source=="string"?ee.find(le=>le.id===k.source):k.source,ie=typeof k.target=="string"?ee.find(le=>le.id===k.target):k.target;if(!(Q!=null&&Q.x)||!(Q!=null&&Q.y)||!(ie!=null&&ie.x)||!(ie!=null&&ie.y))return null;const me=52,S=ie.x-Q.x,ne=ie.y-Q.y,_e=Math.sqrt(S*S+ne*ne);if(_e<me*2.2)return null;const $e=S/_e,Ge=ne/_e,B=Q.x+me*$e,ce=Q.y+me*Ge,we=ie.x-me*$e,K=ie.y-me*Ge;let y="",z={x:0,y:0};if(k.isDouble){const je=(Q.x+ie.x)/2+-Ge*50,Re=(Q.y+ie.y)/2+$e*50;y=`M${B},${ce} Q${je},${Re} ${we},${K}`,z.x=.25*B+.5*je+.25*we,z.y=.25*ce+.5*Re+.25*K}else y=`M${B},${ce} L${we},${K}`,z.x=(B+we)/2,z.y=(ce+K)/2;return{path:y,textPos:z}},xe=k=>k.replace("#",""),F=k=>{q(Q=>Q.includes(k)?Q.filter(ie=>ie!==k):[...Q,k])},W=O.useMemo(()=>s.filter(k=>{const Q=k.name.toLowerCase().includes(j.toLowerCase()),ie=R.length===0||R.every(me=>{var S,ne;return((S=k.tags)==null?void 0:S.includes(me))||((ne=k.hiddenTags)==null?void 0:ne.includes(me))});return Q&&ie}).sort((k,Q)=>k.name.localeCompare(Q.name)),[s,j,R]),{outgoingConnections:re,incomingConnections:We,currentTableChar:D}=O.useMemo(()=>{if(p!=="table"||!x)return{outgoingConnections:[],incomingConnections:[],currentTableChar:null};const k=s.find(me=>me.id===x),Q=((k==null?void 0:k.connections)||[]).map(me=>{const S=s.find(ne=>ne.id===me.id);return{...me,targetChar:S}}),ie=s.filter(me=>{var S;return(S=me.connections)==null?void 0:S.some(ne=>ne.id===x)}).map(me=>{var ne;const S=(ne=me.connections)==null?void 0:ne.find(_e=>_e.id===x);return{sourceChar:me,role:S==null?void 0:S.role,color:S==null?void 0:S.color}});return{outgoingConnections:Q,incomingConnections:ie,currentTableChar:k}},[s,x,p]);return l.jsxs("div",{className:`flex flex-col h-full space-y-4 md:space-y-4 select-none relative ${ye?"is-mounting":""}`,onClick:()=>A(null),children:[l.jsxs("div",{className:"bg-[#0f0f0f]/50 border border-stone-900 rounded-2xl p-4 flex flex-col gap-4 backdrop-blur-sm shadow-lg relative z-20",children:[l.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[l.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[l.jsxs("div",{className:"bg-stone-950 p-1 rounded-lg border border-stone-800 flex items-center",children:[l.jsx("button",{onClick:()=>m("graph"),className:`px-4 py-1.5 rounded-md text-[10px] uppercase font-bold tracking-wider transition-all ${p==="graph"?"bg-stone-800 text-stone-100 shadow-sm":"text-stone-500 hover:text-stone-300"}`,children:""}),l.jsx("button",{onClick:()=>m("table"),className:`px-4 py-1.5 rounded-md text-[10px] uppercase font-bold tracking-wider transition-all ${p==="table"?"bg-stone-800 text-stone-100 shadow-sm":"text-stone-500 hover:text-stone-300"}`,children:""})]}),p==="graph"&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"h-6 w-px bg-stone-800 hidden md:block"}),l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[l.jsx("input",{type:"checkbox",checked:fe,disabled:!!J,onChange:k=>Se(k.target.checked),className:"sr-only"}),l.jsx("div",{className:`w-4 h-4 border border-stone-700 rounded transition-colors ${fe?"bg-emerald-600 border-emerald-500":"bg-transparent"}`,children:fe&&l.jsx("svg",{className:"w-3.5 h-3.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),l.jsx("span",{className:`text-[11px] uppercase tracking-wider font-bold text-stone-500 group-hover:text-stone-300 transition-colors ${J?"opacity-30":""}`,children:" "})]})]})]}),p==="graph"?J&&l.jsx("button",{onClick:()=>{Me(null),Ee(!0)},className:"w-full md:w-auto bg-emerald-950/30 border border-emerald-900/50 text-emerald-500 px-4 py-2 rounded-full text-[10px] uppercase tracking-[0.2em] font-black hover:bg-emerald-900/40 transition-all",children:" "}):l.jsxs("div",{className:"w-full md:w-80 relative z-50",ref:de,children:[l.jsxs("button",{onClick:()=>v(!_),className:"w-full bg-stone-950 border border-stone-800 text-stone-300 text-xs py-2.5 pl-4 pr-10 rounded-xl text-left focus:border-emerald-900 transition-colors flex items-center justify-between",children:[l.jsx("span",{className:x?"":"text-stone-500 italic",children:x?(se=s.find(k=>k.id===x))==null?void 0:se.name:"--   --"}),l.jsx("svg",{className:`w-4 h-4 text-stone-600 transition-transform ${_?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),_&&l.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-[#0a0a0a] border border-stone-800 rounded-xl shadow-2xl overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200 flex flex-col max-h-[400px]",children:[l.jsxs("div",{className:"p-3 bg-stone-900/50 border-b border-stone-900 space-y-3 shrink-0 backdrop-blur-md",children:[l.jsx("input",{type:"text",placeholder:"...",value:j,onChange:k=>$(k.target.value),className:"w-full bg-stone-950 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-colors",autoFocus:!0}),(t.length>0||r.length>0)&&l.jsxs("div",{className:"flex flex-wrap gap-1.5 max-h-20 overflow-y-auto custom-scrollbar",children:[t.map(k=>{const Q=R.includes(k);return l.jsx("button",{onClick:()=>F(k),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${Q?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:k},k)}),r.map(k=>{const Q=R.includes(k);return l.jsx("button",{onClick:()=>F(k),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${Q?"bg-amber-500/20 border-amber-500/40 text-amber-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-amber-500"}`,children:k},k)})]})]}),l.jsx("div",{className:"overflow-y-auto p-1 custom-scrollbar",children:W.length>0?W.map(k=>l.jsxs("button",{onClick:()=>{w(k.id),v(!1),$(""),q([])},className:`w-full flex items-center gap-3 p-2 hover:bg-stone-900 rounded-lg text-left transition-colors group ${x===k.id?"bg-stone-900/80":""}`,children:[l.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:l.jsx("img",{src:k.imageUrl,style:{objectPosition:`${k.miniImageX??50}% ${k.miniImageY??50}%`,transform:`scale(${k.miniImageScale??1})`,transformOrigin:`${k.miniImageX??50}% ${k.miniImageY??50}%`},className:"w-full h-full object-cover",alt:""})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("span",{className:`text-xs font-bold block truncate ${x===k.id?"text-emerald-400":"text-stone-300"}`,children:k.name}),k.tags&&k.tags.length>0&&l.jsxs("span",{className:"text-[8px] text-stone-600 truncate block mt-0.5",children:[k.tags.slice(0,3).join(", "),k.tags.length>3?"...":""]})]}),x===k.id&&l.jsx("div",{className:"ml-auto text-emerald-500",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]},k.id)):l.jsx("div",{className:"text-center py-4 text-[10px] text-stone-600 italic",children:"  "})})]})]})]}),p==="graph"&&(t.length>0||r.length>0)&&l.jsxs("div",{className:"flex flex-wrap items-center gap-2 pt-3 border-t border-stone-800/50 animate-in fade-in slide-in-from-top-1 duration-500",children:[l.jsx("span",{className:"text-[9px] uppercase tracking-[0.2em] font-black text-stone-600 mr-2",children:":"}),t.map(k=>{const Q=i[k]||"none";return l.jsxs("button",{onClick:()=>c(k),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${Q==="include"?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":Q==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-stone-400 hover:border-stone-700"}`,children:[Q==="include"&&l.jsx("span",{className:"text-emerald-500",children:"+"}),Q==="exclude"&&l.jsx("span",{className:"text-red-500",children:""}),k]},k)}),r.map(k=>{const Q=i[k]||"none";return l.jsxs("button",{onClick:()=>c(k),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${Q==="include"?"bg-amber-500/10 border-amber-500/40 text-amber-400 shadow-[0_0_15px_rgba(245,158,11,0.1)]":Q==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-amber-500 hover:border-amber-900/30"}`,children:[Q==="include"&&l.jsx("span",{className:"text-amber-500",children:"+"}),Q==="exclude"&&l.jsx("span",{className:"text-red-500",children:""}),k]},k)}),I>0&&l.jsx("button",{onClick:d,className:"ml-2 text-[9px] uppercase tracking-[0.2em] font-black text-stone-700 hover:text-red-500 transition-colors",children:""})]})]}),l.jsxs("div",{className:"relative z-0 w-full h-full min-h-[500px] bg-[#030303] border border-stone-900 rounded-2xl overflow-hidden shadow-2xl graph-container-reveal",children:[p==="graph"&&l.jsxs(l.Fragment,{children:[l.jsxs("svg",{ref:ue,viewBox:"0 0 1000 700",className:"w-full h-full touch-none cursor-grab active:cursor-grabbing",children:[l.jsx("defs",{children:Le.map(k=>l.jsx("marker",{id:`arrow-${xe(k)}`,markerWidth:"8",markerHeight:"6",refX:"7.5",refY:"3",orient:"auto",children:l.jsx("path",{d:"M0,0 L8,3 L0,6",fill:k})},`arrow-${xe(k)}`))}),l.jsxs("g",{ref:Ye,children:[he.map((k,Q)=>{const ie=De(k);if(!ie)return null;const me=k.color||"#10b981",S=k.isHidden;return l.jsxs("g",{className:`transition-opacity duration-700 ${S?"opacity-0":"opacity-100"}`,children:[l.jsx("path",{d:ie.path,fill:"none",stroke:me,strokeWidth:J?"3":"1.5",strokeOpacity:J?"0.8":"0.3",markerEnd:`url(#arrow-${xe(me)})`,className:"link-path",style:ye?{animationDelay:`${Q*.015}s`}:{}}),J&&k.role&&!S&&l.jsxs("g",{transform:`translate(${ie.textPos.x}, ${ie.textPos.y})`,children:[l.jsx("text",{dy:"-14",textAnchor:"middle",className:"fill-[#030303] text-[10px] font-bold uppercase tracking-[0.2em]",style:{paintOrder:"stroke",stroke:"#030303",strokeWidth:"5px"},children:k.role}),l.jsx("text",{dy:"-14",textAnchor:"middle",fill:me,className:"text-[10px] font-bold uppercase tracking-[0.2em] opacity-90",children:k.role})]})]},`link-${Q}-${X}`)}),ee.map((k,Q)=>{const ie=J===k.id;return l.jsx("g",{transform:`translate(${k.x||500}, ${k.y||350})`,className:`node-group cursor-pointer group ${k.isDimmed?"opacity-0 pointer-events-none":"opacity-100"}`,onClick:me=>{if(me.stopPropagation(),k.x&&k.y){const S=k.x*U.k+U.x,ne=k.y*U.k+U.y;A({id:k.id,x:S,y:ne})}},children:l.jsxs("g",{className:"node-animator",style:ye?{animationDelay:`${Q*.06}s`}:{},children:[l.jsxs("g",{className:"node-content",children:[l.jsx("circle",{r:"48",fill:"#1c1917"}),l.jsx("circle",{r:"46",fill:"#050505",stroke:ie?"#10b981":"#292524",strokeWidth:ie?"4":"1.5"}),l.jsx("clipPath",{id:`clip-${k.id}`,children:l.jsx("circle",{r:"45"})}),l.jsx("foreignObject",{x:"-45",y:"-45",width:"90",height:"90",clipPath:`url(#clip-${k.id})`,children:l.jsx("div",{className:"w-full h-full bg-black flex items-center justify-center overflow-hidden",children:l.jsx("img",{src:k.imageUrl,alt:"",style:{width:"100%",height:"100%",objectFit:"cover",objectPosition:`${k.miniImageX??50}% ${k.miniImageY??50}%`,transformOrigin:`${k.miniImageX??50}% ${k.miniImageY??50}%`,transform:`scale(${k.miniImageScale??1})`},className:"opacity-90 group-hover:opacity-100 group-hover:scale-110 transition-all duration-500"})})})]}),l.jsx("text",{y:"70",textAnchor:"middle",className:"fill-stone-500 text-[12px] font-bold uppercase tracking-[0.15em] group-hover:fill-stone-100 transition-colors drop-shadow-[0_2px_2px_rgba(0,0,0,0.8)] font-serif",children:k.name})]})},k.id)})]})]}),P&&l.jsx("div",{className:"absolute inset-0 bg-[#030303]/40 flex items-center justify-center backdrop-blur-[1px] pointer-events-none",children:l.jsx("div",{className:"text-[10px] uppercase tracking-[0.4em] font-black text-emerald-500/50 animate-pulse",children:" ..."})})]}),p==="table"&&l.jsx("div",{className:"w-full h-full overflow-y-auto custom-scrollbar p-6 md:p-10",children:x?l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16",children:[l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center gap-3 border-b border-stone-800 pb-4",children:[l.jsx("span",{className:"text-emerald-500 bg-emerald-900/10 px-2 py-1 rounded text-xs font-bold",children:"OUT"}),l.jsxs("h3",{className:"text-lg font-serif text-stone-200 italic",children:["  ",D==null?void 0:D.name,"?"]}),l.jsx("span",{className:"ml-auto text-stone-600 text-xs font-bold",children:re.length})]}),l.jsx("div",{className:"space-y-3",children:re.length===0?l.jsx("p",{className:"text-stone-700 text-xs italic py-4",children:"       ..."}):re.map((k,Q)=>{var ie,me,S,ne,_e,$e;return l.jsxs("div",{className:"flex items-start gap-4 p-4 bg-stone-900/30 border border-stone-900/50 rounded-xl hover:bg-stone-900/50 hover:border-emerald-900/30 transition-all group",children:[l.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:l.jsx("img",{src:(ie=k.targetChar)==null?void 0:ie.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${((me=k.targetChar)==null?void 0:me.miniImageX)??50}% ${((S=k.targetChar)==null?void 0:S.miniImageY)??50}%`,transform:`scale(${((ne=k.targetChar)==null?void 0:ne.miniImageScale)??1})`,transformOrigin:`${((_e=k.targetChar)==null?void 0:_e.miniImageX)??50}% ${(($e=k.targetChar)==null?void 0:$e.miniImageY)??50}%`},alt:""})}),l.jsxs("div",{className:"flex-grow min-w-0",children:[l.jsxs("div",{className:"flex justify-between items-baseline",children:[l.jsx("h4",{className:"text-stone-300 font-bold text-sm truncate",children:k.name}),l.jsx("button",{onClick:()=>f(k.id),className:"text-[9px] uppercase font-bold text-stone-700 hover:text-emerald-500 transition-colors opacity-0 group-hover:opacity-100",children:""})]}),l.jsx("p",{className:"text-stone-500 text-xs mt-1 font-medium",children:k.role})]}),l.jsx("div",{className:"w-1.5 h-8 rounded-full self-center",style:{backgroundColor:k.color||"#10b981"}})]},Q)})})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center gap-3 border-b border-stone-800 pb-4",children:[l.jsx("span",{className:"text-blue-500 bg-blue-900/10 px-2 py-1 rounded text-xs font-bold",children:"IN"}),l.jsxs("h3",{className:"text-lg font-serif text-stone-200 italic",children:["  ",D==null?void 0:D.name,"?"]}),l.jsx("span",{className:"ml-auto text-stone-600 text-xs font-bold",children:We.length})]}),l.jsx("div",{className:"space-y-3",children:We.length===0?l.jsx("p",{className:"text-stone-700 text-xs italic py-4",children:"    ..."}):We.map((k,Q)=>{var ie,me,S,ne,_e,$e,Ge;return l.jsxs("div",{className:"flex items-start gap-4 p-4 bg-stone-900/30 border border-stone-900/50 rounded-xl hover:bg-stone-900/50 hover:border-blue-900/30 transition-all group",children:[l.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:l.jsx("img",{src:(ie=k.sourceChar)==null?void 0:ie.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${((me=k.sourceChar)==null?void 0:me.miniImageX)??50}% ${((S=k.sourceChar)==null?void 0:S.miniImageY)??50}%`,transform:`scale(${((ne=k.sourceChar)==null?void 0:ne.miniImageScale)??1})`,transformOrigin:`${((_e=k.sourceChar)==null?void 0:_e.miniImageX)??50}% ${(($e=k.sourceChar)==null?void 0:$e.miniImageY)??50}%`},alt:""})}),l.jsxs("div",{className:"flex-grow min-w-0",children:[l.jsxs("div",{className:"flex justify-between items-baseline",children:[l.jsx("h4",{className:"text-stone-300 font-bold text-sm truncate",children:(Ge=k.sourceChar)==null?void 0:Ge.name}),l.jsx("button",{onClick:()=>f(k.sourceChar.id),className:"text-[9px] uppercase font-bold text-stone-700 hover:text-blue-500 transition-colors opacity-0 group-hover:opacity-100",children:""})]}),l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx("span",{className:"text-stone-600 text-[10px] uppercase tracking-wider",children:"  :"}),l.jsx("p",{className:"text-stone-400 text-xs font-medium",children:k.role})]})]}),l.jsx("div",{className:"w-1.5 h-8 rounded-full self-center",style:{backgroundColor:k.color||"#10b981"}})]},Q)})})]})]}):l.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-stone-600 space-y-4",children:[l.jsx("svg",{className:"w-16 h-16 opacity-30",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),l.jsx("p",{className:"text-sm italic font-serif opacity-70",children:"    ,    "})]})}),Z&&p==="graph"&&l.jsx("div",{className:"absolute z-[100] animate-in zoom-in-95 fade-in duration-300",style:{left:Z.x+40,top:Z.y-40},onClick:k=>k.stopPropagation(),children:l.jsxs("div",{className:"bg-[#0f0f0f]/95 border border-stone-800 rounded-xl overflow-hidden shadow-2xl min-w-[200px] backdrop-blur-md",children:[l.jsx("button",{onClick:()=>f(Z.id),className:"w-full text-left px-5 py-3 text-[11px] uppercase tracking-wider font-bold text-stone-200 hover:bg-emerald-900/40 border-b border-stone-900",children:" "}),l.jsx("button",{onClick:()=>{Me(Z.id),A(null),Ee(!0)},className:"w-full text-left px-5 py-3 text-[11px] uppercase tracking-wider font-bold text-emerald-400 hover:bg-emerald-900/40",children:" "})]})})]})]})},mx=({realms:s,worlds:t,characters:r,availableTags:i,availableHiddenTags:c,onUpdateRealms:d,onUpdateWorlds:f,isAdmin:p})=>{var Q,ie,me,S,ne,_e,$e,Ge;const[m,x]=O.useState(null),[w,_]=O.useState(null);O.useEffect(()=>{window.scrollTo(0,0)},[m,w]);const[v,j]=O.useState(!1),[$,R]=O.useState(!1),[q,de]=O.useState(!1),[fe,Se]=O.useState(null),[J,Me]=O.useState(!1),[Z,A]=O.useState(""),[X,Ce]=O.useState(!1),[P,Ee]=O.useState({}),[ye,ke]=O.useState({type:""}),[ue,Ye]=O.useState(""),[ae,ze]=O.useState([]),H=s.find(B=>B.id===m),U=t.find(B=>B.id===w),N=t.filter(B=>B.realmId===m),I=B=>{var ce,we;for(const K of t){if((ce=K.characterIds)!=null&&ce.includes(B))return K.name;if(K.subLocations){for(const y of K.subLocations)if((we=y.characterIds)!=null&&we.includes(B))return`${K.name} / ${y.name}`}}return null},ee=B=>{Ee(B||{}),j(!0)},he=()=>{if(!P.name)return;let B;if(P.id)B=s.map(ce=>ce.id===P.id?{...ce,...P}:ce);else{const ce={id:Date.now().toString(),name:P.name,imageUrl:P.imageUrl||"https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=1080&auto=format&fit=crop"};B=[...s,ce]}d(B),j(!1),Ee({})},Le=B=>{window.confirm("  ?  ,   .")&&(d(s.filter(ce=>ce.id!==B)),m===B&&x(null))},Ae=B=>{ke(B||{type:"",realmId:m}),R(!0)},De=()=>{if(!ye.name||!m)return;let B;if(ye.id)B=t.map(ce=>ce.id===ye.id?{...ce,...ye}:ce);else{const ce={id:Date.now().toString(),realmId:m,name:ye.name,type:ye.type||"",description:ye.description||"",imageUrl:ye.imageUrl||"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?q=80&w=800&auto=format&fit=crop",characterIds:[],subLocations:[]};B=[...t,ce]}f(B),R(!1),ke({type:""})},xe=B=>{window.confirm("  ?")&&(f(t.filter(ce=>ce.id!==B)),w===B&&_(null))},F=()=>{if(!U||!Z.trim())return;const B={id:Date.now().toString(),name:Z.trim(),characterIds:[]},ce=t.map(we=>we.id===U.id?{...we,subLocations:[...we.subLocations||[],B]}:we);f(ce),A(""),Me(!1)},W=B=>{if(!U||!window.confirm("  ?        ."))return;const ce=t.map(we=>we.id===U.id?{...we,subLocations:(we.subLocations||[]).filter(K=>K.id!==B)}:we);f(ce)},re=B=>{if(!U)return;let ce={...U};if(fe){const K=ce.subLocations?[...ce.subLocations]:[],y=K.findIndex(z=>z.id===fe);if(y>-1){const z=K[y].characterIds||[],le=z.includes(B)?z.filter(je=>je!==B):[...z,B];K[y]={...K[y],characterIds:le},ce.subLocations=K}}else{const K=ce.characterIds||[],y=K.includes(B)?K.filter(z=>z!==B):[...K,B];ce.characterIds=y}const we=t.map(K=>K.id===U.id?ce:K);f(we)},We=B=>{ze(ce=>ce.includes(B)?ce.filter(we=>we!==B):[...ce,B])},D=(B=null)=>{Se(B),Ye(""),ze([]),de(!0)},se=async B=>{var we;const ce=(we=B.target.files)==null?void 0:we[0];if(ce){Ce(!0);try{const K=await Ui(ce);Ee(y=>({...y,imageUrl:K}))}finally{Ce(!1)}}},k=async B=>{var we;const ce=(we=B.target.files)==null?void 0:we[0];if(ce){Ce(!0);try{const K=await Ui(ce);ke(y=>({...y,imageUrl:K}))}finally{Ce(!1)}}};if(w&&U){const B=fe?((ie=(Q=U.subLocations)==null?void 0:Q.find(y=>y.id===fe))==null?void 0:ie.characterIds)||[]:U.characterIds||[],ce=r.filter(y=>!B.includes(y.id)),we=ce.filter(y=>{const z=y.name.toLowerCase().includes(ue.toLowerCase());if(ae.length===0)return z;const le=[...y.tags||[],...y.hiddenTags||[]];return z&&ae.every(je=>le.includes(je))}),K=(y,z)=>{const le=y||[],je=r.filter(Re=>le.includes(Re.id));return je.length===0?l.jsx("p",{className:"text-stone-600 italic text-sm py-4",children:"  ..."}):l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:je.map((Re,dt)=>l.jsxs("div",{style:{animationDelay:`${dt*50}ms`,animationFillMode:"both"},className:"animate-slide-up-fade bg-stone-900/30 border border-stone-800 rounded-xl p-3 flex items-center gap-3 group relative hover:bg-stone-900/50 hover:border-stone-700 transition-all",children:[l.jsx("div",{className:"w-10 h-10 rounded-full bg-black border border-stone-700 overflow-hidden shrink-0",children:l.jsx("img",{src:Re.imageUrl,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",alt:"",style:{objectPosition:`${Re.miniImageX??50}% ${Re.miniImageY??50}%`,transform:`scale(${Re.miniImageScale??1})`,transformOrigin:`${Re.miniImageX??50}% ${Re.miniImageY??50}%`}})}),l.jsx("span",{className:"text-stone-300 font-bold text-sm truncate group-hover:text-emerald-400 transition-colors",children:Re.name}),p&&l.jsx("button",{onClick:()=>{Se(z),setTimeout(()=>re(Re.id),0)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-stone-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all p-2",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},Re.id))})};return l.jsxs("div",{className:"space-y-8 animate-epic-reveal pb-20",children:[l.jsxs("div",{className:"flex flex-col gap-6",children:[l.jsxs("button",{onClick:()=>_(null),className:"self-start flex items-center gap-2 text-stone-500 hover:text-emerald-500 transition-colors group",children:[l.jsx("svg",{className:"w-5 h-5 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsxs("span",{className:"text-xs font-bold uppercase tracking-widest",children:["  ",H==null?void 0:H.name]})]}),l.jsxs("div",{className:"relative h-[300px] md:h-[400px] rounded-3xl overflow-hidden border border-stone-900 group shadow-2xl animate-slide-up-fade",style:{animationDelay:"0.1s"},children:[l.jsx("img",{src:U.imageUrl,className:"w-full h-full object-cover transition-transform duration-[3s] ease-out group-hover:scale-105",alt:U.name}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#050505] via-transparent to-transparent opacity-90"}),l.jsx("div",{className:"absolute bottom-0 left-0 p-8 md:p-12 w-full",children:l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4",children:[l.jsxs("div",{className:"animate-slide-up-fade",style:{animationDelay:"0.2s"},children:[l.jsx("div",{className:"inline-block px-3 py-1 bg-emerald-900/40 border border-emerald-500/30 rounded-lg text-emerald-400 text-[10px] font-bold uppercase tracking-widest mb-3 backdrop-blur-md",children:U.type}),l.jsx("h1",{className:"text-4xl md:text-6xl font-serif font-medium text-stone-100 drop-shadow-xl",children:U.name})]}),p&&l.jsxs("div",{className:"flex gap-3 animate-slide-up-fade",style:{animationDelay:"0.3s"},children:[l.jsx("button",{onClick:()=>Ae(U),className:"bg-white/10 hover:bg-white/20 backdrop-blur-md text-stone-200 px-5 py-2 rounded-full text-[10px] uppercase font-bold tracking-widest transition-all border border-white/10",children:""}),l.jsx("button",{onClick:()=>xe(U.id),className:"bg-red-900/20 hover:bg-red-900/40 backdrop-blur-md text-red-400 px-5 py-2 rounded-full text-[10px] uppercase font-bold tracking-widest transition-all border border-red-900/30",children:""})]})]})})]}),l.jsx("div",{className:"max-w-4xl animate-slide-up-fade",style:{animationDelay:"0.4s"},children:l.jsx("p",{className:"text-lg md:text-xl font-serif text-stone-300 leading-relaxed whitespace-pre-wrap",children:U.description})}),l.jsx("div",{className:"h-px bg-stone-900 w-full my-4"}),l.jsxs("div",{className:"space-y-10",children:[l.jsxs("div",{className:"space-y-4 animate-slide-up-fade",style:{animationDelay:"0.5s"},children:[l.jsxs("div",{className:"flex justify-between items-center border-b border-stone-800/50 pb-2",children:[l.jsx("h3",{className:"text-xl font-serif text-stone-200 italic",children:" "}),p&&l.jsx("button",{onClick:()=>D(null),className:"text-emerald-500 hover:text-emerald-400 text-[10px] uppercase font-bold tracking-widest transition-colors flex items-center gap-2",children:"+ "})]}),K(U.characterIds||[],null)]}),(me=U.subLocations)==null?void 0:me.map((y,z)=>l.jsxs("div",{className:"space-y-4 pt-4 animate-slide-up-fade",style:{animationDelay:`${(z+6)*100}ms`},children:[l.jsxs("div",{className:"flex justify-between items-center border-b border-stone-800/50 pb-2",children:[l.jsxs("div",{className:"flex items-baseline gap-3",children:[l.jsx("h3",{className:"text-xl font-serif text-stone-300 italic",children:y.name}),p&&l.jsx("button",{onClick:()=>W(y.id),className:"text-stone-700 hover:text-red-500 transition-colors",children:l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),p&&l.jsx("button",{onClick:()=>D(y.id),className:"text-emerald-500 hover:text-emerald-400 text-[10px] uppercase font-bold tracking-widest transition-colors flex items-center gap-2",children:"+ "})]}),K(y.characterIds||[],y.id)]},y.id)),p&&l.jsx("div",{className:"pt-4 animate-slide-up-fade",style:{animationDelay:"0.8s"},children:J?l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("input",{autoFocus:!0,placeholder:" ...",className:"bg-stone-900 border border-stone-800 rounded-lg px-3 py-2 text-sm text-stone-200 outline-none focus:border-emerald-900 w-64",value:Z,onChange:y=>A(y.target.value),onKeyDown:y=>y.key==="Enter"&&F()}),l.jsx("button",{onClick:F,className:"text-emerald-500 hover:text-emerald-400 font-bold p-2 bg-stone-900 rounded-lg",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),l.jsx("button",{onClick:()=>Me(!1),className:"text-stone-600 hover:text-stone-400 font-bold p-2",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):l.jsxs("button",{onClick:()=>Me(!0),className:"flex items-center gap-2 text-stone-600 hover:text-emerald-500 transition-colors group",children:[l.jsx("div",{className:"w-8 h-8 rounded-full border border-stone-800 group-hover:border-emerald-500/50 flex items-center justify-center transition-colors",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),l.jsx("span",{className:"text-[10px] uppercase font-bold tracking-widest",children:" "})]})})]})]}),q&&l.jsx("div",{className:"fixed inset-0 z-[120] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",onClick:()=>de(!1),children:l.jsxs("div",{className:"bg-[#0f0f0f] border border-stone-800 w-full max-w-lg rounded-2xl shadow-2xl flex flex-col max-h-[85vh] animate-in zoom-in-95 duration-300",onClick:y=>y.stopPropagation(),children:[l.jsxs("div",{className:"p-6 border-b border-stone-900 shrink-0 space-y-4 bg-[#0f0f0f] rounded-t-2xl z-10",children:[l.jsxs("h3",{className:"text-xl font-serif text-stone-100 shrink-0",children:[" : ",fe?(ne=(S=U.subLocations)==null?void 0:S.find(y=>y.id===fe))==null?void 0:ne.name:" "]}),l.jsx("input",{type:"text",placeholder:"  ...",value:ue,onChange:y=>Ye(y.target.value),className:"w-full bg-stone-900 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-colors",autoFocus:!0}),(i.length>0||c.length>0)&&l.jsxs("div",{className:"flex flex-wrap gap-1.5 max-h-24 overflow-y-auto custom-scrollbar",children:[i.map(y=>{const z=ae.includes(y);return l.jsx("button",{onClick:()=>We(y),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${z?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:y},y)}),c.map(y=>{const z=ae.includes(y);return l.jsx("button",{onClick:()=>We(y),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${z?"bg-amber-500/20 border-amber-500/40 text-amber-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-amber-500"}`,children:y},y)})]})]}),l.jsx("div",{className:"overflow-y-auto custom-scrollbar flex-grow p-4 space-y-1",children:we.length===0?l.jsx("div",{className:"text-center py-8 text-stone-600 italic text-sm",children:ce.length===0?"      .":"  ."}):we.map(y=>{const z=I(y.id),le=!!z;return l.jsxs("button",{onClick:()=>!le&&re(y.id),disabled:le,className:`w-full flex items-center gap-3 p-2 rounded-lg transition-colors group text-left ${le?"opacity-50 cursor-not-allowed bg-stone-900/20":"hover:bg-stone-900"}`,children:[l.jsx("div",{className:"w-8 h-8 rounded-full bg-black border border-stone-800 overflow-hidden shrink-0",children:l.jsx("img",{src:y.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${y.miniImageX??50}% ${y.miniImageY??50}%`,transform:`scale(${y.miniImageScale??1})`,transformOrigin:`${y.miniImageX??50}% ${y.miniImageY??50}%`}})}),l.jsxs("div",{className:"min-w-0 flex-grow",children:[l.jsx("span",{className:`text-stone-300 text-sm font-bold block truncate ${!le&&"group-hover:text-emerald-400"}`,children:y.name}),le?l.jsxs("span",{className:"text-[10px] text-red-500/70 font-bold uppercase tracking-wider block truncate",children:[": ",z]}):l.jsx(l.Fragment,{children:ae.length>0&&l.jsx("span",{className:"text-[8px] text-stone-600 block truncate",children:ae.filter(je=>(y.tags||[]).includes(je)||(y.hiddenTags||[]).includes(je)).join(", ")})})]}),!le&&l.jsx("span",{className:"ml-auto text-emerald-500 opacity-0 group-hover:opacity-100",children:"+"})]},y.id)})}),l.jsx("div",{className:"p-4 border-t border-stone-900 shrink-0",children:l.jsx("button",{onClick:()=>de(!1),className:"w-full py-3 bg-stone-900 hover:bg-stone-800 text-stone-400 rounded-xl text-[10px] uppercase font-bold tracking-widest",children:""})})]})})]})}return m?l.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-500",children:[l.jsxs("div",{className:"flex flex-col gap-6",children:[l.jsxs("button",{onClick:()=>x(null),className:"self-start flex items-center gap-2 text-stone-500 hover:text-emerald-500 transition-colors group",children:[l.jsx("svg",{className:"w-5 h-5 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"  "})]}),l.jsxs("div",{className:"flex justify-between items-end border-b border-stone-800 pb-8",children:[l.jsxs("div",{className:"flex items-center gap-6 animate-in slide-in-from-bottom-2 duration-700",children:[l.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-2xl overflow-hidden border border-stone-800 bg-black shadow-lg",children:l.jsx("img",{src:H==null?void 0:H.imageUrl,className:"w-full h-full object-cover",alt:""})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl md:text-5xl font-serif font-medium text-stone-100",children:H==null?void 0:H.name}),l.jsxs("p",{className:"text-stone-500 uppercase tracking-widest text-[10px] mt-2",children:[": ",N.length]})]})]}),p&&l.jsxs("div",{className:"flex gap-2 flex-col md:flex-row",children:[l.jsx("button",{onClick:()=>ee(H),className:"bg-stone-900/50 border border-stone-800 text-stone-400 px-6 py-3 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-stone-900 transition-all mb-1",children:". "}),l.jsx("button",{onClick:()=>Ae(),className:"bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 px-6 py-3 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-emerald-900/30 transition-all mb-1",children:"+ "})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[N.length===0&&l.jsx("div",{className:"col-span-full py-20 text-center text-stone-700 italic",children:"     .   ."}),N.map((B,ce)=>{var we,K,y,z;return l.jsxs("div",{onClick:()=>_(B.id),style:{animationDelay:`${ce*100}ms`,animationFillMode:"both"},className:"animate-slide-up-fade bg-[#0f0f0f]/30 border border-stone-900 rounded-2xl overflow-hidden group hover:border-emerald-900/30 transition-all flex flex-col cursor-pointer active:scale-95 shadow-lg",children:[l.jsxs("div",{className:"aspect-video relative overflow-hidden",children:[l.jsx("img",{src:B.imageUrl,className:"w-full h-full object-cover opacity-60 group-hover:opacity-100 transition-all duration-[2s] group-hover:scale-110 ease-out",alt:""}),l.jsx("div",{className:"absolute top-4 left-4 bg-black/80 px-3 py-1 rounded text-[9px] uppercase tracking-widest font-bold text-emerald-500 border border-emerald-900/50 backdrop-blur-sm",children:B.type}),(((we=B.characterIds)==null?void 0:we.length)||0)+(((K=B.subLocations)==null?void 0:K.reduce((le,je)=>{var Re;return le+(((Re=je.characterIds)==null?void 0:Re.length)||0)},0))||0)>0&&l.jsx("div",{className:"absolute bottom-4 right-4 bg-black/60 backdrop-blur-md px-2 py-1 rounded flex items-center gap-2",children:l.jsxs("span",{className:"text-[9px] text-stone-300 font-bold uppercase tracking-widest",children:[(((y=B.characterIds)==null?void 0:y.length)||0)+(((z=B.subLocations)==null?void 0:z.reduce((le,je)=>{var Re;return le+(((Re=je.characterIds)==null?void 0:Re.length)||0)},0))||0)," ."]})})]}),l.jsxs("div",{className:"p-6 space-y-3 flex-grow flex flex-col relative z-10 bg-[#0f0f0f]",children:[l.jsx("h3",{className:"text-xl font-serif text-stone-100 group-hover:text-emerald-200 transition-colors",children:B.name}),l.jsx("p",{className:"text-stone-500 text-sm leading-relaxed line-clamp-3 mb-2",children:B.description}),p&&l.jsxs("div",{className:"mt-auto pt-4 border-t border-stone-900/50 flex justify-between",children:[l.jsx("button",{onClick:le=>{le.stopPropagation(),Ae(B)},className:"text-[9px] font-bold uppercase tracking-widest text-stone-600 hover:text-white",children:"."}),l.jsx("button",{onClick:le=>{le.stopPropagation(),xe(B.id)},className:"text-[9px] font-bold uppercase tracking-widest text-stone-600 hover:text-red-500",children:""})]})]})]},B.id)})]}),$&&l.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-md flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-lg rounded-2xl p-6 md:p-8 space-y-6 max-h-[90vh] flex flex-col overflow-hidden shadow-2xl animate-in zoom-in-95 duration-200",children:[l.jsx("h2",{className:"text-2xl font-serif text-stone-100 shrink-0",children:ye.id?"":" "}),l.jsxs("div",{className:"space-y-4 overflow-y-auto custom-scrollbar pr-2 flex-grow",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600",children:""}),l.jsx("input",{className:"w-full bg-stone-900 border border-stone-800 p-3 rounded-lg text-stone-200 outline-none focus:border-emerald-900",value:ye.name||"",onChange:B=>ke({...ye,name:B.target.value}),placeholder:" ..."})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600",children:""}),l.jsxs("select",{className:"w-full bg-stone-900 border border-stone-800 p-3 rounded-lg text-stone-200 outline-none focus:border-emerald-900",value:ye.type,onChange:B=>ke({...ye,type:B.target.value}),children:[l.jsx("option",{children:""}),l.jsx("option",{children:""}),l.jsx("option",{children:""}),l.jsx("option",{children:""})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600",children:""}),l.jsx("textarea",{placeholder:"  ...",className:"w-full bg-stone-900 border border-stone-800 p-3 rounded-lg text-stone-200 h-32 outline-none resize-none focus:border-emerald-900",value:ye.description||"",onChange:B=>ke({...ye,description:B.target.value})})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600",children:""}),l.jsxs("div",{className:"flex gap-4 items-center",children:[l.jsxs("label",{className:`flex-1 cursor-pointer bg-stone-900 hover:bg-stone-800 p-3 rounded-lg border border-stone-800 flex items-center justify-center gap-2 transition-colors ${X?"opacity-50":""}`,children:[l.jsx("input",{type:"file",onChange:k,className:"hidden",disabled:X,accept:"image/*"}),l.jsx("span",{className:"text-[10px] text-stone-400 font-bold uppercase",children:X?"...":""})]}),l.jsx("input",{className:"flex-[1.5] bg-stone-900 border border-stone-800 p-3 rounded-lg text-xs text-stone-400 outline-none",placeholder:"...",value:(_e=ye.imageUrl)!=null&&_e.startsWith("data:")?"":ye.imageUrl||"",onChange:B=>ke({...ye,imageUrl:B.target.value})})]}),ye.imageUrl&&l.jsx("img",{src:ye.imageUrl,className:"h-20 w-full object-cover rounded mt-2 opacity-50"})]})]}),l.jsxs("div",{className:"flex gap-4 shrink-0 pt-2 border-t border-stone-900 mt-2",children:[l.jsx("button",{onClick:()=>R(!1),className:"flex-1 py-3 text-[10px] font-bold uppercase text-stone-500 hover:text-stone-300",children:""}),l.jsx("button",{onClick:De,disabled:X||!ye.name,className:"flex-1 py-3 bg-emerald-900/30 text-emerald-500 border border-emerald-900/50 rounded-lg font-bold text-[10px] uppercase disabled:opacity-50 hover:bg-emerald-900/50 transition-colors",children:""})]})]})}),v&&l.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-md flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-lg rounded-3xl p-8 space-y-6 shadow-2xl animate-in zoom-in-95 duration-300",children:[l.jsx("h2",{className:"text-2xl font-serif text-stone-100",children:" "}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-2",children:""}),l.jsx("input",{className:"w-full bg-stone-900 border border-stone-800 p-4 rounded-xl text-stone-200 outline-none focus:border-emerald-900",value:P.name||"",onChange:B=>Ee({...P,name:B.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-2",children:""}),l.jsxs("div",{className:"flex gap-4 items-center",children:[l.jsxs("label",{className:`flex-1 cursor-pointer bg-stone-900 hover:bg-stone-800 p-4 rounded-xl border border-stone-800 flex items-center justify-center gap-2 ${X?"opacity-50":""}`,children:[l.jsx("input",{type:"file",onChange:se,className:"hidden",disabled:X,accept:"image/*"}),l.jsx("span",{className:"text-xs text-stone-400 font-bold uppercase",children:X?"...":""})]}),l.jsx("input",{className:"flex-[2] bg-stone-900 border border-stone-800 p-4 rounded-xl text-xs text-stone-400 outline-none",placeholder:"...",value:($e=P.imageUrl)!=null&&$e.startsWith("data:")?"":P.imageUrl||"",onChange:B=>Ee({...P,imageUrl:B.target.value})})]})]})]}),l.jsxs("div",{className:"flex gap-4 pt-4",children:[l.jsx("button",{onClick:()=>j(!1),className:"flex-1 py-4 text-[10px] uppercase font-bold text-stone-500 hover:text-stone-300",children:""}),l.jsx("button",{onClick:he,disabled:!P.name||X,className:"flex-1 py-4 bg-emerald-900/30 text-emerald-500 border border-emerald-900/50 rounded-xl font-bold text-[10px] uppercase hover:bg-emerald-900/50 transition-all disabled:opacity-50",children:""})]})]})})]}):l.jsxs("div",{className:"space-y-12 animate-in fade-in duration-700 pb-20",children:[l.jsxs("div",{className:"flex justify-between items-baseline",children:[l.jsx("div",{className:"space-y-2",children:l.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100",children:""})}),p&&l.jsx("button",{onClick:()=>ee(),className:"bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 px-6 py-3 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-emerald-900/30 transition-all",children:"  "})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[s.length===0&&l.jsx("div",{className:"col-span-full py-20 text-center",children:l.jsx("p",{className:"text-stone-700 italic font-serif text-xl",children:" .   ."})}),s.map((B,ce)=>l.jsxs("div",{onClick:()=>x(B.id),style:{animationDelay:`${ce*150}ms`,animationFillMode:"both"},className:"animate-slide-up-fade bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl overflow-hidden group cursor-pointer relative shadow-lg hover:shadow-emerald-900/10 hover:border-emerald-900/40 transition-all active:scale-95",children:[l.jsxs("div",{className:"aspect-[16/9] relative",children:[l.jsx("img",{src:B.imageUrl,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-all duration-[2s] ease-out group-hover:scale-110",alt:B.name}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-80"}),l.jsx("h3",{className:"absolute bottom-6 left-6 text-3xl font-serif text-stone-100 z-10 font-bold group-hover:text-emerald-100 transition-colors drop-shadow-md",children:B.name})]}),p&&l.jsxs("div",{className:"absolute top-4 right-4 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx("button",{onClick:we=>{we.stopPropagation(),ee(B)},className:"bg-black/50 hover:bg-white text-white hover:text-black p-2 rounded-full backdrop-blur-sm transition-all",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),l.jsx("button",{onClick:we=>{we.stopPropagation(),Le(B.id)},className:"bg-black/50 hover:bg-red-900/80 text-white p-2 rounded-full backdrop-blur-sm transition-all",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]},B.id))]}),v&&l.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-md flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-lg rounded-3xl p-8 space-y-6 shadow-2xl animate-in zoom-in-95 duration-300",children:[l.jsx("h2",{className:"text-2xl font-serif text-stone-100",children:P.id?" ":" "}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-2",children:""}),l.jsx("input",{autoFocus:!0,className:"w-full bg-stone-900 border border-stone-800 p-4 rounded-xl text-stone-200 outline-none focus:border-emerald-900 transition-colors",value:P.name||"",onChange:B=>Ee({...P,name:B.target.value}),placeholder:":  "})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-2",children:""}),l.jsxs("div",{className:"flex gap-4 items-center",children:[l.jsxs("label",{className:`flex-1 cursor-pointer bg-stone-900 hover:bg-stone-800 p-4 rounded-xl border border-stone-800 flex items-center justify-center gap-2 transition-colors ${X?"opacity-50":""}`,children:[l.jsx("input",{type:"file",onChange:se,className:"hidden",disabled:X,accept:"image/*"}),l.jsx("span",{className:"text-xs text-stone-400 font-bold uppercase",children:X?"...":""})]}),l.jsx("input",{className:"flex-[2] bg-stone-900 border border-stone-800 p-4 rounded-xl text-xs text-stone-400 outline-none",placeholder:"...",value:(Ge=P.imageUrl)!=null&&Ge.startsWith("data:")?"":P.imageUrl||"",onChange:B=>Ee({...P,imageUrl:B.target.value})})]})]})]}),l.jsxs("div",{className:"flex gap-4 pt-4",children:[l.jsx("button",{onClick:()=>j(!1),className:"flex-1 py-4 text-[10px] uppercase font-bold text-stone-500 hover:text-stone-300",children:""}),l.jsx("button",{onClick:he,disabled:!P.name||X,className:"flex-1 py-4 bg-emerald-900/30 text-emerald-500 border border-emerald-900/50 rounded-xl font-bold text-[10px] uppercase hover:bg-emerald-900/50 transition-all disabled:opacity-50",children:""})]})]})})]})},gx=[{label:"16:9",value:16/9,str:"16/9",icon:"M4 6h16M4 18h16M4 6v12M20 6v12"},{label:"4:3",value:4/3,str:"4/3",icon:"M5 6h14M5 18h14M5 6v12M19 6v12"},{label:"1:1",value:1,str:"1/1",icon:"M5 5h14v14H5z"},{label:"3:4",value:3/4,str:"3/4",icon:"M6 5h12M6 19h12M6 5v14M18 5v14"},{label:"9:16",value:9/16,str:"9/16",icon:"M6 4h12M6 20h12M6 4v16M18 4v16"}],an=(s,t,r,i,c)=>{if(!s)return null;const d=/(\*\*.*?\*\*|__.*?__|~~.*?~~|\|\|.*?\|\||\[c=[^\]]+?\].*?\[\/c\]|\[link=.*?\].*?\[\/link\]|\[tip=.*?\].*?\[\/tip\]|\[quote=.*?\].*?\[\/quote\]|\[char=.*?\].*?\[\/char\]|\[img .*?\])/g;return s.split(d).map((p,m)=>{if(p.startsWith("**")&&p.endsWith("**")&&p.length>4)return l.jsx("strong",{className:"text-stone-100 font-bold",children:an(p.slice(2,-2),t,r,i,c)},m);if(p.startsWith("__")&&p.endsWith("__")&&p.length>4)return l.jsx("em",{className:"text-stone-300 italic font-light",children:an(p.slice(2,-2),t,r,i,c)},m);if(p.startsWith("~~")&&p.endsWith("~~")&&p.length>4)return l.jsx("span",{className:"line-through opacity-60 decoration-stone-500",children:an(p.slice(2,-2),t,r,i,c)},m);if(p.startsWith("||")&&p.endsWith("||")&&p.length>4)return l.jsxs("span",{className:"group/spoiler relative cursor-help rounded bg-stone-800 px-1 py-0.5 mx-0.5 align-middle select-none transition-all hover:bg-stone-700",children:[l.jsx("span",{className:"opacity-0 group-hover/spoiler:opacity-100 transition-opacity duration-300 text-stone-200",children:an(p.slice(2,-2),t,r,i,c)}),l.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-[9px] uppercase font-black tracking-widest text-stone-500 group-hover/spoiler:opacity-0 pointer-events-none transition-opacity",children:""})]},m);if(p.startsWith("[c=")&&p.endsWith("[/c]")){const x=p.match(/\[c=([^\]]+)\](.*?)\[\/c\]/);if(x)return l.jsx("span",{style:{color:x[1]},className:"font-medium drop-shadow-sm",children:an(x[2],t,r,i,c)},m)}if(p.startsWith("[link=")&&p.endsWith("[/link]")){const x=p.match(/\[link=(.*?)\](.*?)\[\/link\]/);if(x)return l.jsx("a",{href:x[1],target:"_blank",rel:"noopener noreferrer",className:"text-emerald-400 hover:text-emerald-300 hover:underline decoration-emerald-500/50 underline-offset-2 transition-colors cursor-pointer",onClick:w=>w.stopPropagation(),children:an(x[2],t,r,i,c)},m)}if(p.startsWith("[char=")&&p.endsWith("[/char]")){const x=p.match(/\[char=(.*?)\](.*?)\[\/char\]/);if(x){const w=x[1],_=x[2];return l.jsxs("span",{onClick:v=>{v.stopPropagation(),r&&r(w)},className:"inline-flex items-center gap-1 text-amber-400 hover:text-amber-200 cursor-pointer transition-colors border-b border-amber-500/30 hover:border-amber-400 px-0.5 rounded hover:bg-amber-900/20 group/char",title:"  ",children:[l.jsx("svg",{className:"w-3 h-3 opacity-50 group-hover/char:opacity-100 transition-opacity",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),an(_,t,r,i,c)]},m)}}if(p.startsWith("[tip=")&&p.endsWith("[/tip]")){const x=p.match(/\[tip=(.*?)\](.*?)\[\/tip\]/);if(x)return l.jsxs("span",{className:"relative group/tooltip cursor-help border-b border-dotted border-stone-500 hover:border-emerald-500 transition-colors inline-block leading-tight",children:[an(x[2],t,r,i,c),l.jsxs("span",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-max max-w-[200px] p-2 bg-[#1a1a1a] border border-stone-700 rounded-lg text-xs text-stone-300 opacity-0 group-hover/tooltip:opacity-100 transition-opacity duration-200 pointer-events-none z-50 shadow-xl text-center whitespace-normal leading-tight",children:[x[1],l.jsx("span",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-stone-700"})]})]},m)}if(p.startsWith("[quote=")&&p.endsWith("[/quote]")){const x=p.match(/\[quote=(.*?)\](.*?)\[\/quote\]/);if(x){const w=x[1],_=x[2],v=t==null?void 0:t.find(j=>j.id===w);return l.jsxs("div",{className:"my-4 border-l-2 border-emerald-500/40 bg-stone-900/20 pl-4 py-3 rounded-r-lg group/quote transition-colors hover:border-emerald-500/60",children:[l.jsx("div",{className:`text-[10px] uppercase font-black text-emerald-500 mb-2 tracking-widest opacity-80 group-hover/quote:opacity-100 transition-opacity flex items-center gap-2 ${v?"cursor-pointer hover:text-emerald-300":""}`,onClick:j=>{v&&r&&(j.stopPropagation(),r(v.id))},children:v?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-5 h-5 rounded-full overflow-hidden border border-emerald-500/30 bg-black shrink-0",children:l.jsx("img",{src:v.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${v.miniImageX??50}% ${v.miniImageY??50}%`,transform:`scale(${v.miniImageScale??1})`,transformOrigin:`${v.miniImageX??50}% ${v.miniImageY??50}%`}})}),l.jsx("span",{children:v.name})]}):l.jsxs(l.Fragment,{children:[l.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M14.017 21L14.017 18C14.017 16.896 14.321 16.067 14.929 15.513C15.537 14.959 16.485 14.682 17.773 14.682V14.128C17.773 13.068 17.411 12.152 16.687 11.38C15.963 10.608 14.887 10.222 13.459 10.222V4.99998C15.827 4.99998 17.754 5.75398 19.24 7.26198C20.726 8.76998 21.469 10.871 21.469 13.565V21H14.017ZM2.53699 21L2.53699 18C2.53699 16.896 2.84099 16.067 3.44899 15.513C4.05699 14.959 5.00499 14.682 6.29299 14.682V14.128C6.29299 13.068 5.93099 12.152 5.20699 11.38C4.48299 10.608 3.40699 10.222 1.97899 10.222V4.99998C4.34699 4.99998 6.27399 5.75398 7.75999 7.26198C9.24599 8.76998 9.98899 10.871 9.98899 13.565V21H2.53699Z"})}),l.jsx("span",{children:w})]})}),l.jsx("div",{className:"italic text-stone-300 font-serif text-lg leading-relaxed",children:an(_,t,r,i,c)})]},m)}}if(p.startsWith("[img ")&&p.endsWith("]")){const x=p.slice(5,-1),w=x.match(/src=(.*?)(\s|$)/),_=x.match(/w=(\d+)/),v=x.match(/a=(left|center|right)/),j=x.match(/x=(\d+(\.\d+)?)/),$=x.match(/y=(\d+(\.\d+)?)/),R=x.match(/s=(\d+(\.\d+)?)/),q=x.match(/ar=(\d+\/\d+)/),de=w?w[1]:"",fe=_?parseInt(_[1]):100,Se=v?v[1]:"center",J=j?parseFloat(j[1]):50,Me=$?parseFloat($[1]):50,Z=R?parseFloat(R[1]):1,A=q?q[1]:"16/9",[X,Ce]=A.split("/").map(Number),P=Ce&&X?Ce/X*100:56.25;if(de){const Ee=!!i;return l.jsx("span",{className:`block w-full my-4 flex ${Se==="center"?"justify-center":Se==="right"?"justify-end":"justify-start"}`,children:l.jsxs("div",{className:`relative rounded-lg shadow-lg border border-stone-800/50 overflow-hidden group/img transition-all ${Ee?"hover:scale-[1.01] hover:border-emerald-500/30":"cursor-zoom-in hover:shadow-emerald-900/20"}`,style:{width:`${fe}%`},onClick:ye=>{ye.stopPropagation(),i?i({url:de,width:fe,align:Se,x:J,y:Me,scale:Z,aspectRatioStr:A,originalTag:p}):c&&c(de)},children:[l.jsx("div",{style:{paddingTop:`${P}%`,position:"relative"},children:l.jsx("img",{src:de,alt:"User content",className:"absolute inset-0 w-full h-full object-cover",style:{objectPosition:`${J}% ${Me}%`,transformOrigin:`${J}% ${Me}%`,transform:`scale(${Z})`}})}),i&&l.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover/img:opacity-100 flex items-center justify-center transition-opacity cursor-pointer z-10",children:l.jsx("span",{className:"bg-black/60 backdrop-blur px-3 py-1.5 rounded-full text-[10px] uppercase font-bold text-emerald-400 border border-emerald-500/30 flex items-center gap-2",children:""})})]})},m)}}return p})},_f=(s,t,r,i,c)=>s?s.split(`
`).map((f,p)=>{const m=f.trim();return m?m==="---"?l.jsx("div",{className:"h-px w-full bg-gradient-to-r from-stone-400 to-transparent my-8 opacity-80 shadow-[0_0_10px_rgba(168,162,158,0.2)]"},p):m.startsWith("# ")?l.jsx("h3",{className:"text-xl md:text-2xl font-serif text-emerald-100 border-b border-stone-800/60 pb-2 mb-3 mt-6 first:mt-0 italic",children:an(m.slice(2),c,t,r,i)},p):m.startsWith("> ")?l.jsx("blockquote",{className:"border-l-2 border-emerald-500/40 bg-stone-900/20 pl-4 py-2 my-2 rounded-r-lg italic text-stone-400",children:an(m.slice(2),c,t,r,i)},p):l.jsx("div",{className:"min-h-[1.5em] text-stone-300 leading-relaxed font-serif text-base md:text-lg break-words",children:an(f,c,t,r,i)},p):l.jsx("div",{className:"h-4"},p)}):null,xx=({entries:s,characters:t,availableTags:r,availableHiddenTags:i,isAdmin:c,onUpdate:d,onSelectCharacter:f,selectedEntryId:p})=>{const[m,x]=O.useState("list"),[w,_]=O.useState(null),[v,j]=O.useState({}),[$,R]=O.useState(""),[q,de]=O.useState(!1),[fe,Se]=O.useState("#10b981"),[J,Me]=O.useState(!1),[Z,A]=O.useState(!1),[X,Ce]=O.useState(""),[P,Ee]=O.useState([]),[ye,ke]=O.useState(!1),[ue,Ye]=O.useState({url:"",width:100,align:"center",x:50,y:50,scale:1,aspectRatioStr:"16/9"}),[ae,ze]=O.useState(!1),[H,U]=O.useState(!1),[N,I]=O.useState(null),ee=O.useRef(null);O.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[m,w]),O.useEffect(()=>{if(p){const S=s.find(ne=>ne.id===p);S&&(_(S),x("read"))}},[p,s]);const he=(S,ne)=>{if(!ee.current&&!ue.originalTag)return;if(!ee.current){const y=v.content||"";j({...v,content:y+S+ne});return}const _e=ee.current.selectionStart,$e=ee.current.selectionEnd,Ge=v.content||"",B=Ge.substring(0,_e),ce=Ge.substring(_e,$e),we=Ge.substring($e),K=B+S+ce+ne+we;j({...v,content:K}),setTimeout(()=>{if(ee.current){ae||ee.current.focus({preventScroll:!0});const y=ce.length>0?_e+S.length+ce.length+ne.length:_e+S.length;ee.current.setSelectionRange(y,y)}},0)},Le=()=>{const S=`[img src=${ue.url} w=${ue.width} a=${ue.align} x=${ue.x.toFixed(0)} y=${ue.y.toFixed(0)} s=${ue.scale.toFixed(2)} ar=${ue.aspectRatioStr}]`;if(ue.originalTag){const ne=(v.content||"").replace(ue.originalTag,S);j({...v,content:ne})}else he(S,"");ke(!1),Ye({url:"",width:100,align:"center",x:50,y:50,scale:1,aspectRatioStr:"16/9"})},Ae=S=>{m==="editor"&&(Ye(S),ke(!0))},De=S=>{if(!ee.current)return;const ne=ee.current.selectionStart,_e=ee.current.selectionEnd,$e=v.content||"",Ge=$e.substring(0,ne),B=$e.substring(ne,_e),ce=$e.substring(_e),we=B.length>0?B:S.name,K=`${Ge}[char=${S.id}]${we}[/char]${ce}`;j({...v,content:K}),Me(!1),Ce(""),Ee([]),setTimeout(()=>{if(ee.current){ae||ee.current.focus({preventScroll:!0});const y=ne+`[char=${S.id}]${we}[/char]`.length;ee.current.setSelectionRange(y,y)}},0)},xe=S=>{he(`[quote=${S.id}]`,"[/quote]"),A(!1),Ce(""),Ee([])},F=S=>{_(S),x("read")},W=()=>{_(null),j({title:"",content:""}),x("editor"),ze(!1),U(!1)},re=()=>{w&&(j({...w}),x("editor"),ze(!1),U(!1))},We=()=>{x(w?"read":"list"),j({})},D=()=>{if(!(!v.title||!v.content)){if(w){const S=s.map(ne=>ne.id===w.id?{...ne,...v}:ne);d(S),_({...w,...v})}else{const S={id:Date.now().toString(),title:v.title||"",content:v.content||""};d([S,...s]),_(S)}x("read")}},se=()=>{w&&window.confirm("   ?")&&(d(s.filter(S=>S.id!==w.id)),_(null),x("list"))},k=O.useMemo(()=>s.filter(S=>S.title.toLowerCase().includes($.toLowerCase())||S.content.toLowerCase().includes($.toLowerCase())).sort((S,ne)=>S.title.localeCompare(ne.title)),[s,$]),Q=O.useMemo(()=>t.filter(S=>{const ne=S.name.toLowerCase().includes(X.toLowerCase()),_e=P.length===0||P.every($e=>(S.tags||[]).includes($e)||(S.hiddenTags||[]).includes($e));return ne&&_e}).sort((S,ne)=>S.name.localeCompare(ne.name)),[t,X,P]),ie=S=>{Ee(ne=>ne.includes(S)?ne.filter(_e=>_e!==S):[...ne,S])},me=S=>{const[ne,_e]=S.split("/").map(Number);return ne&&_e?ne/_e:16/9};return l.jsxs("div",{className:"min-h-screen animate-in fade-in duration-500 pb-20",children:[m==="list"&&l.jsxs("div",{className:"space-y-12 w-full mx-auto",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-b border-stone-900/50 pb-8",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100 italic",children:""}),l.jsx("p",{className:"text-stone-500 uppercase tracking-[0.3em] text-[9px] font-black",children:"  "})]}),c&&l.jsxs("button",{onClick:W,className:"group relative bg-white hover:bg-emerald-50 text-black px-8 py-4 rounded-2xl text-[10px] uppercase tracking-[0.2em] font-black transition-all shadow-xl hover:shadow-emerald-500/10 flex items-center gap-3 overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})," "]})]}),l.jsx("div",{className:"mb-8",children:l.jsx("input",{type:"text",placeholder:"  ...",value:$,onChange:S=>R(S.target.value),className:"w-full bg-stone-900/50 border border-stone-800 rounded-2xl px-6 py-4 text-sm text-stone-200 outline-none focus:border-emerald-500/50 transition-colors shadow-inner font-serif"})}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:k.length===0?l.jsx("div",{className:"col-span-full py-20 text-center text-stone-700 italic",children:"     ..."}):k.map((S,ne)=>l.jsxs("div",{onClick:()=>F(S),style:{animationDelay:`${ne*50}ms`},className:"bg-[#0a0a0a] border border-stone-900/60 rounded-3xl p-6 md:p-8 hover:border-emerald-900/30 hover:bg-stone-900/20 transition-all duration-300 shadow-lg cursor-pointer group animate-slide-up-fade flex flex-col min-h-[160px]",children:[l.jsx("h2",{className:"text-xl md:text-2xl font-serif font-bold text-stone-200 group-hover:text-emerald-300 transition-colors line-clamp-3 mb-4",children:S.title}),l.jsxs("div",{className:"mt-auto flex justify-between items-center pt-4 border-t border-stone-900/30",children:[l.jsx("span",{className:"text-[9px] uppercase tracking-widest text-stone-600 group-hover:text-stone-400 transition-colors",children:""}),l.jsx("svg",{className:"w-4 h-4 text-stone-700 group-hover:text-emerald-500 transition-all group-hover:translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]},S.id))})]}),m==="read"&&w&&l.jsxs("div",{className:"w-full max-w-7xl mx-auto space-y-8 animate-epic-reveal",children:[l.jsxs("div",{className:"flex justify-between items-start border-b border-stone-900/50 pb-6",children:[l.jsxs("button",{onClick:()=>x("list"),className:"flex items-center gap-2 text-stone-500 hover:text-white transition-colors group text-xs uppercase tracking-widest font-bold",children:[l.jsx("svg",{className:"w-4 h-4 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"  "]}),c&&l.jsxs("div",{className:"flex gap-4",children:[l.jsx("button",{onClick:se,className:"text-red-900 hover:text-red-500 transition-colors text-[10px] uppercase font-bold tracking-widest",children:""}),l.jsx("button",{onClick:re,className:"text-emerald-700 hover:text-emerald-400 transition-colors text-[10px] uppercase font-bold tracking-widest",children:""})]})]}),l.jsxs("article",{className:"space-y-8",children:[l.jsx("h1",{className:"text-4xl md:text-6xl font-serif font-bold text-stone-100 leading-tight",children:w.title}),l.jsx("div",{className:"h-px w-24 bg-emerald-500/50"}),l.jsx("div",{className:"text-stone-300 leading-relaxed font-serif text-lg md:text-xl min-h-[50vh]",children:_f(w.content||"",f,void 0,S=>I(S),t)})]})]}),m==="editor"&&l.jsxs("div",{className:"min-h-screen flex flex-col",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6 border-b border-stone-900/50 pb-6 mb-8 shrink-0",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:We,className:"group p-3 rounded-full border border-stone-800 hover:bg-stone-900 transition-all text-stone-500 hover:text-white",children:l.jsx("svg",{className:"w-5 h-5 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),l.jsx("div",{children:l.jsx("h2",{className:"text-3xl font-serif text-stone-100 font-bold italic",children:w?" ":" "})})]}),l.jsxs("button",{onClick:D,disabled:!v.title||!v.content,className:"px-8 py-3 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 text-emerald-500 rounded-xl text-[10px] uppercase tracking-widest font-black transition-all shadow-lg hover:shadow-emerald-900/10 disabled:opacity-30 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),""]})]}),l.jsxs("div",{className:"flex-grow flex flex-col space-y-6",children:[l.jsx("input",{placeholder:" ...",className:"w-full bg-transparent border-b-2 border-stone-800 px-2 py-4 text-stone-100 outline-none focus:border-emerald-500/40 transition-all font-serif font-bold text-3xl md:text-4xl placeholder-stone-700",value:v.title||"",onChange:S=>j({...v,title:S.target.value})}),l.jsxs("div",{className:"flex-grow flex flex-col w-full relative group/editor",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4 px-1 sticky top-0 bg-[#050505] z-50 py-2 border-b border-stone-900/50",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.4em] font-black text-stone-600",children:""}),l.jsxs("div",{className:"flex flex-wrap gap-1 bg-stone-900/50 p-1 rounded-lg border border-stone-800",children:[l.jsx("button",{type:"button",disabled:ae,onClick:S=>{S.preventDefault(),he("**","**")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 font-serif font-bold text-lg transition-colors ${ae?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,children:"B"}),l.jsx("button",{type:"button",disabled:ae,onClick:S=>{S.preventDefault(),he("__","__")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 font-serif italic text-lg transition-colors ${ae?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,children:"I"}),l.jsx("button",{type:"button",disabled:ae,onClick:S=>{S.preventDefault(),he("~~","~~")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 line-through decoration-emerald-500/50 transition-colors ${ae?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,children:"S"}),l.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),l.jsx("button",{type:"button",disabled:ae,onClick:S=>{S.preventDefault(),he("# ","")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 font-serif font-bold transition-colors ${ae?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,children:"H"}),l.jsx("button",{type:"button",disabled:ae,onClick:S=>{S.preventDefault(),he("> ","")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ae?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,children:l.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M14.017 21L14.017 18C14.017 16.896 14.321 16.067 14.929 15.513C15.537 14.959 16.485 14.682 17.773 14.682V14.128C17.773 13.068 17.411 12.152 16.687 11.38C15.963 10.608 14.887 10.222 13.459 10.222V4.99998C15.827 4.99998 17.754 5.75398 19.24 7.26198C20.726 8.76998 21.469 10.871 21.469 13.565V21H14.017ZM2.53699 21L2.53699 18C2.53699 16.896 2.84099 16.067 3.44899 15.513C4.05699 14.959 5.00499 14.682 6.29299 14.682V14.128C6.29299 13.068 5.93099 12.152 5.20699 11.38C4.48299 10.608 3.40699 10.222 1.97899 10.222V4.99998C4.34699 4.99998 6.27399 5.75398 7.75999 7.26198C9.24599 8.76998 9.98899 10.871 9.98899 13.565V21H2.53699Z"})})}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{type:"button",disabled:ae,onClick:S=>{S.preventDefault(),A(!Z)},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ae?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),Z&&!ae&&l.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-[#1a1a1a] border border-stone-700 rounded-xl shadow-2xl z-50 w-72 md:w-80",children:l.jsxs("div",{className:"space-y-3",children:[l.jsx("input",{autoFocus:!0,type:"text",placeholder:" ...",value:X,onChange:S=>Ce(S.target.value),className:"w-full bg-stone-900 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50"}),((r==null?void 0:r.length)||0)>0&&l.jsx("div",{className:"flex flex-wrap gap-1.5 max-h-20 overflow-y-auto custom-scrollbar",children:r==null?void 0:r.map(S=>l.jsx("button",{onClick:ne=>{ne.preventDefault(),ie(S)},className:`px-2 py-1 rounded text-[8px] uppercase font-bold tracking-wider transition-all border ${P.includes(S)?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:S},S))}),l.jsx("div",{className:"max-h-48 overflow-y-auto custom-scrollbar space-y-1",children:Q.map(S=>l.jsxs("button",{onClick:ne=>{ne.preventDefault(),xe(S)},className:"w-full flex items-center gap-3 p-2 hover:bg-stone-900 rounded-lg text-left transition-colors group",children:[l.jsx("div",{className:"w-6 h-6 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:l.jsx("img",{src:S.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${S.miniImageX??50}% ${S.miniImageY??50}%`,transform:`scale(${S.miniImageScale??1})`,transformOrigin:`${S.miniImageX??50}% ${S.miniImageY??50}%`},alt:""})}),l.jsx("span",{className:"text-xs font-bold text-stone-300 group-hover:text-emerald-400 truncate",children:S.name})]},S.id))})]})})]}),l.jsx("button",{type:"button",disabled:ae,onClick:S=>{S.preventDefault(),he("---","")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ae?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,children:l.jsx("div",{className:"w-4 h-0.5 bg-current opacity-50"})}),l.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{type:"button",disabled:ae,onClick:S=>{S.preventDefault(),Me(!J)},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ae?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-amber-400"}`,children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),J&&!ae&&l.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-[#1a1a1a] border border-stone-700 rounded-xl shadow-2xl z-50 w-72 md:w-80",children:l.jsxs("div",{className:"space-y-3",children:[l.jsx("input",{autoFocus:!0,type:"text",placeholder:"...",value:X,onChange:S=>Ce(S.target.value),className:"w-full bg-stone-900 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-amber-500/50"}),((r==null?void 0:r.length)||0)>0&&l.jsx("div",{className:"flex flex-wrap gap-1.5 max-h-20 overflow-y-auto custom-scrollbar",children:r==null?void 0:r.map(S=>l.jsx("button",{onClick:ne=>{ne.preventDefault(),ie(S)},className:`px-2 py-1 rounded text-[8px] uppercase font-bold tracking-wider transition-all border ${P.includes(S)?"bg-amber-500/20 border-amber-500/40 text-amber-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:S},S))}),l.jsx("div",{className:"max-h-48 overflow-y-auto custom-scrollbar space-y-1",children:Q.map(S=>l.jsxs("button",{onClick:ne=>{ne.preventDefault(),De(S)},className:"w-full flex items-center gap-3 p-2 hover:bg-stone-900 rounded-lg text-left transition-colors group",children:[l.jsx("div",{className:"w-6 h-6 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:l.jsx("img",{src:S.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${S.miniImageX??50}% ${S.miniImageY??50}%`,transform:`scale(${S.miniImageScale??1})`,transformOrigin:`${S.miniImageX??50}% ${S.miniImageY??50}%`},alt:""})}),l.jsx("span",{className:"text-xs font-bold text-stone-300 group-hover:text-amber-400 truncate",children:S.name})]},S.id))})]})})]}),l.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{type:"button",disabled:ae,onClick:S=>{S.preventDefault(),ke(!ye)},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ae?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),ye&&l.jsx("div",{className:"absolute top-full right-0 origin-top-right mt-2 p-4 bg-[#1a1a1a] border border-stone-700 rounded-xl shadow-2xl z-[60] w-80 max-h-[80vh] overflow-y-auto custom-scrollbar",children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h4",{className:"text-[10px] uppercase font-bold text-stone-400 border-b border-stone-800 pb-2 sticky top-0 bg-[#1a1a1a] z-10",children:ue.originalTag?"":" "}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-[9px] uppercase font-bold text-stone-500",children:""}),l.jsx("input",{autoFocus:!0,type:"text",placeholder:"https://...",className:"w-full bg-stone-900 border border-stone-800 rounded-lg px-2 py-1.5 text-xs text-stone-200 outline-none focus:border-emerald-500/50",value:ue.url,onChange:S=>Ye({...ue,url:S.target.value})})]}),ue.url&&l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-[9px] uppercase font-bold text-stone-500",children:"  "}),l.jsx("div",{className:"w-3/4 mx-auto transition-all",children:l.jsx(Bi,{imageUrl:ue.url,scale:ue.scale,x:ue.x,y:ue.y,aspectRatio:me(ue.aspectRatioStr),onUpdate:S=>Ye(ne=>({...ne,x:S.x??ne.x,y:S.y??ne.y,scale:S.scale??ne.scale}))})}),l.jsx("div",{className:"grid grid-cols-5 gap-1 mt-2",children:gx.map(S=>l.jsxs("button",{type:"button",onClick:()=>Ye(ne=>({...ne,aspectRatioStr:S.str})),className:`flex flex-col items-center justify-center p-1.5 rounded-lg border transition-all ${ue.aspectRatioStr===S.str?"bg-stone-800 border-emerald-500/50 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-500 hover:text-stone-300 hover:border-stone-700"}`,children:[l.jsx("svg",{className:"w-4 h-4 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:S.icon})}),l.jsx("span",{className:"text-[8px] font-black",children:S.label})]},S.label))})]}),l.jsx("button",{type:"button",disabled:!ue.url,onClick:S=>{S.preventDefault(),Le()},className:"w-full py-2 bg-emerald-900/30 border border-emerald-900/50 text-emerald-500 rounded-lg text-[10px] uppercase font-bold hover:bg-emerald-900/50 transition-colors disabled:opacity-50",children:ue.originalTag?" ":""}),l.jsxs("div",{className:"space-y-1 pt-2 border-t border-stone-800",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("label",{className:"text-[9px] uppercase font-bold text-stone-500",children:"  "}),l.jsxs("span",{className:"text-[9px] font-mono text-emerald-500",children:[ue.width,"%"]})]}),l.jsx("input",{type:"range",min:"10",max:"100",step:"10",className:"w-full h-1.5 bg-stone-800 rounded-lg appearance-none cursor-pointer accent-emerald-500",value:ue.width,onChange:S=>Ye({...ue,width:parseInt(S.target.value)})})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-[9px] uppercase font-bold text-stone-500",children:""}),l.jsx("div",{className:"flex bg-stone-900 rounded-lg p-1 border border-stone-800",children:["left","center","right"].map(S=>l.jsxs("button",{type:"button",onClick:()=>Ye({...ue,align:S}),className:`flex-1 py-1 rounded text-stone-400 hover:text-white transition-colors flex justify-center ${ue.align===S?"bg-stone-800 text-emerald-400 shadow-sm":""}`,children:[S==="left"&&l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h10M4 18h7"})}),S==="center"&&l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M7 12h10M7 18h10"})}),S==="right"&&l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M10 12h10M13 18h7"})})]},S))})]})]})})]}),l.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),l.jsx("button",{type:"button",disabled:ae,onClick:S=>{S.preventDefault(),he("[link=]","[/link]")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ae?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),l.jsx("button",{type:"button",disabled:ae,onClick:S=>{S.preventDefault(),he("[tip=]","[/tip]")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ae?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),l.jsx("button",{type:"button",disabled:ae,onClick:S=>{S.preventDefault(),he("||","||")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ae?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{type:"button",disabled:ae,onClick:S=>{S.preventDefault(),de(!q)},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ae?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,children:l.jsx("div",{className:"w-3.5 h-3.5 rounded-full bg-gradient-to-br from-red-500 via-yellow-500 to-blue-500 border border-stone-600"})}),q&&!ae&&l.jsxs("div",{className:"absolute top-full right-0 mt-2 p-3 bg-[#1a1a1a] border border-stone-700 rounded-xl shadow-2xl z-50 flex items-center gap-3 animate-in fade-in zoom-in-95 duration-200 min-w-[140px]",children:[l.jsx("input",{type:"color",className:"w-8 h-8 rounded cursor-pointer bg-transparent border-none p-0",value:fe,onChange:S=>Se(S.target.value)}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-[8px] uppercase font-bold text-stone-500 tracking-wider",children:""}),l.jsx("span",{className:"text-[10px] font-mono text-stone-300",children:fe})]}),l.jsx("button",{type:"button",onClick:S=>{S.preventDefault(),he(`[c=${fe}]`,"[/c]"),de(!1)},className:"ml-auto p-1.5 bg-emerald-500/20 text-emerald-500 hover:bg-emerald-500/30 rounded-lg transition-colors border border-emerald-500/30",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]})]}),l.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),l.jsx("button",{type:"button",disabled:ae,onClick:S=>{S.preventDefault(),U(!H)},className:`w-8 h-8 flex items-center justify-center rounded-md transition-colors hidden md:flex ${H&&!ae?"bg-emerald-900/30 text-emerald-400":"text-stone-400 hover:bg-stone-800 hover:text-white"} ${ae?"opacity-30 cursor-not-allowed":""}`,children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 00-2 2"})})}),l.jsx("button",{type:"button",onClick:S=>{S.preventDefault(),ze(!ae)},className:`w-8 h-8 flex items-center justify-center rounded-md transition-colors ${ae?"bg-emerald-900/30 text-emerald-400":"text-stone-400 hover:bg-stone-800 hover:text-white"}`,children:ae?l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}):l.jsxs("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),l.jsxs("div",{className:`relative flex-grow min-h-[500px] ${H&&!ae?"grid grid-cols-1 lg:grid-cols-2 gap-4":""}`,children:[l.jsx("textarea",{ref:ee,placeholder:"   ...",className:`w-full bg-[#030303] border border-stone-900 rounded-2xl px-6 py-6 text-stone-300 outline-none focus:border-emerald-500/40 transition-all resize-none leading-relaxed shadow-inner custom-scrollbar text-lg font-serif h-full overflow-y-auto ${ae?"hidden":"block"}`,style:H&&!ae?{height:"calc(100vh - 300px)",minHeight:"500px"}:{minHeight:"500px"},value:v.content||"",onChange:S=>j({...v,content:S.target.value})}),l.jsx("div",{className:`w-full bg-[#030303] border border-stone-900 rounded-2xl px-6 py-6 text-stone-300 shadow-inner custom-scrollbar text-lg font-serif overflow-y-auto break-words ${ae||H?"block":"hidden"}`,style:H&&!ae?{height:"calc(100vh - 300px)",minHeight:"500px"}:{height:"100%",position:ae?"absolute":"static",inset:0,zIndex:10},children:(ae||H)&&_f(v.content||"",f,ae?void 0:Ae,S=>I(S),t)})]})]})]})]}),N&&l.jsx("div",{className:"fixed inset-0 z-[120] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 animate-in fade-in duration-200 cursor-zoom-out",onClick:()=>I(null),children:l.jsxs("div",{className:"relative max-w-full max-h-full",children:[l.jsx("img",{src:N,className:"max-w-[95vw] max-h-[95vh] object-contain rounded-lg shadow-2xl animate-in zoom-in-95 duration-300",alt:""}),l.jsx("button",{className:"absolute -top-12 right-0 text-stone-400 hover:text-white transition-colors",onClick:()=>I(null),children:l.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]})})]})},vx=({sessions:s,characters:t,onUpdate:r,isAdmin:i})=>{const[c,d]=O.useState(null),[f,p]=O.useState(null),[m,x]=O.useState("");O.useEffect(()=>{window.scrollTo(0,0)},[c]);const[w,_]=O.useState(!1),[v,j]=O.useState(""),[$,R]=O.useState(""),q=O.useRef(null),de=s.find(Z=>Z.id===c);O.useEffect(()=>{q.current&&q.current.scrollIntoView({behavior:"smooth"})},[de==null?void 0:de.posts.length,c]);const fe=()=>{if(!v.trim())return;const Z={id:Date.now().toString(),name:v,description:$,posts:[]};r([...s,Z]),_(!1),j(""),R("")},Se=Z=>{window.confirm("     ?")&&(r(s.filter(A=>A.id!==Z)),c===Z&&d(null))},J=Z=>{if(!m.trim()||!f||!c)return;const A={id:Date.now().toString(),characterId:f,content:m,timestamp:Date.now(),type:"speech"},X=s.map(Ce=>Ce.id===c?{...Ce,posts:[...Ce.posts,A]}:Ce);r(X),x("")},Me=Z=>new Date(Z).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return c?l.jsxs("div",{className:"h-[calc(100vh-8rem)] flex flex-col animate-in fade-in duration-300",children:[l.jsx("div",{className:"flex items-center justify-between pb-4 border-b border-stone-900 shrink-0",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:()=>d(null),className:"p-2 hover:bg-stone-900 rounded-full text-stone-500 transition-colors",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-serif text-stone-100 italic",children:de==null?void 0:de.name}),l.jsx("p",{className:"text-[10px] uppercase tracking-widest text-stone-500",children:de==null?void 0:de.description})]})]})}),l.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar py-6 space-y-8 pr-2",children:[(de==null?void 0:de.posts.length)===0?l.jsx("div",{className:"text-center text-stone-700 italic text-sm mt-10",children:"...   ,   ."}):de==null?void 0:de.posts.map(Z=>{const A=t.find(X=>X.id===Z.characterId);return A?l.jsxs("div",{className:"flex gap-4 md:gap-6 group animate-in slide-in-from-bottom-2 duration-500",children:[l.jsx("div",{className:"shrink-0 flex flex-col items-center gap-2 mt-1",children:l.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 rounded-full border border-stone-800 overflow-hidden bg-black shadow-lg",children:l.jsx("img",{src:A.imageUrl,alt:A.name,style:{objectFit:"cover",objectPosition:`${A.miniImageX??50}% ${A.miniImageY??50}%`,transformOrigin:`${A.miniImageX??50}% ${A.miniImageY??50}%`,transform:`scale(${A.miniImageScale??1})`},className:"w-full h-full"})})}),l.jsxs("div",{className:"flex-grow max-w-4xl",children:[l.jsxs("div",{className:"flex items-baseline gap-3 mb-1",children:[l.jsx("span",{className:"text-stone-300 font-bold text-sm tracking-wide",children:A.name}),l.jsx("span",{className:"text-[9px] text-stone-700 font-mono",children:Me(Z.timestamp)})]}),l.jsx("div",{className:"text-stone-400 leading-relaxed font-serif whitespace-pre-wrap text-[15px] md:text-[16px]",children:Z.content})]})]},Z.id):null}),l.jsx("div",{ref:q})]}),l.jsx("div",{className:"mt-4 pt-4 border-t border-stone-900 shrink-0 bg-[#050505] z-10",children:l.jsxs("div",{className:"flex flex-col gap-3",children:[l.jsx("div",{className:"flex gap-2 overflow-x-auto custom-scrollbar pb-3",children:t.map(Z=>{const A=f===Z.id;return l.jsxs("button",{onClick:()=>p(Z.id),className:`flex items-center gap-3 px-4 py-2.5 rounded-xl transition-all shrink-0 border relative ${A?"bg-stone-900/80 border-stone-800 text-stone-100":"bg-transparent border-transparent text-stone-500 hover:text-stone-400"}`,children:[l.jsx("div",{className:"w-7 h-7 rounded-full overflow-hidden bg-black shrink-0",children:l.jsx("img",{src:Z.imageUrl,style:{objectFit:"cover",objectPosition:`${Z.miniImageX??50}% ${Z.miniImageY??50}%`,transformOrigin:`${Z.miniImageX??50}% ${Z.miniImageY??50}%`,transform:`scale(${Z.miniImageScale??1})`},className:"w-full h-full",alt:""})}),l.jsx("span",{className:"text-[11px] font-bold uppercase tracking-wider",children:Z.name}),A&&l.jsx("div",{className:"ml-1 w-2.5 h-2.5 rounded-sm bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)] animate-in zoom-in-50 duration-300"})]},Z.id)})}),l.jsxs("div",{className:"relative",children:[l.jsx("textarea",{value:m,onChange:Z=>x(Z.target.value),onKeyDown:Z=>{Z.key==="Enter"&&!Z.shiftKey&&(Z.preventDefault(),J())},placeholder:f?" -...":"  ...",disabled:!f,className:"w-full bg-[#0f0f0f] border border-stone-800 rounded-xl p-4 pr-14 text-stone-300 outline-none focus:border-emerald-900/50 transition-colors resize-none h-24 custom-scrollbar font-serif"}),l.jsx("button",{onClick:()=>J(),disabled:!m.trim()||!f,className:"absolute right-3 bottom-3 p-2 bg-stone-800 text-stone-400 rounded-lg hover:bg-emerald-600 hover:text-white disabled:opacity-30 disabled:hover:bg-stone-800 disabled:hover:text-stone-400 transition-all",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})]})})]}):l.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[l.jsxs("div",{className:"flex justify-between items-baseline",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100",children:""}),l.jsx("p",{className:"text-stone-500 uppercase tracking-widest text-[10px]",children:"   "})]}),l.jsx("button",{onClick:()=>_(!0),className:"bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 px-6 py-2 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-emerald-900/30 transition-all",children:"+  "})]}),w&&l.jsxs("div",{className:"bg-[#0f0f0f]/50 border border-stone-800 p-6 rounded-2xl space-y-4 animate-in slide-in-from-top-4",children:[l.jsx("input",{autoFocus:!0,placeholder:"   ...",className:"w-full bg-stone-900/50 border border-stone-800 p-3 rounded-lg text-stone-200 outline-none focus:border-emerald-900",value:v,onChange:Z=>j(Z.target.value)}),l.jsx("input",{placeholder:" ...",className:"w-full bg-stone-900/50 border border-stone-800 p-3 rounded-lg text-stone-400 outline-none focus:border-emerald-900 text-sm",value:$,onChange:Z=>R(Z.target.value)}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 text-[10px] uppercase font-bold text-stone-500",children:""}),l.jsx("button",{onClick:fe,className:"px-6 py-2 bg-emerald-700 hover:bg-emerald-600 text-white rounded-lg text-[10px] uppercase font-bold transition-colors",children:""})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[s.length===0&&!w&&l.jsx("div",{className:"col-span-full text-center py-20 opacity-50 italic font-serif",children:"   .   ."}),s.map(Z=>l.jsxs("div",{onClick:()=>d(Z.id),className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-2xl p-6 cursor-pointer hover:border-emerald-900/50 hover:bg-stone-900/30 transition-all group flex flex-col h-[200px]",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("h3",{className:"text-xl font-serif text-stone-200 group-hover:text-emerald-400 transition-colors",children:Z.name}),l.jsxs("span",{className:"text-[10px] bg-stone-900 text-stone-500 px-2 py-1 rounded-md font-mono",children:[Z.posts.length," "]})]}),l.jsx("p",{className:"text-sm text-stone-500 mt-2 line-clamp-2",children:Z.description}),l.jsxs("div",{className:"mt-auto pt-4 border-t border-stone-900/50 flex justify-between items-center",children:[l.jsx("span",{className:"text-[9px] uppercase tracking-widest text-stone-600 font-bold group-hover:text-stone-400",children:"  "}),i&&l.jsx("button",{onClick:A=>{A.stopPropagation(),Se(Z.id)},className:"text-stone-800 hover:text-red-500 p-1 transition-colors",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},Z.id))]})]})},yx=({onConnect:s,onDisconnect:t,onClose:r,isConnected:i})=>l.jsx("div",{className:"fixed inset-0 z-[120] bg-black/95 backdrop-blur-md flex items-center justify-center p-6",onClick:r,children:l.jsxs("div",{className:"bg-[#0a0a0a] border border-emerald-900/50 w-full max-w-lg rounded-3xl p-8 space-y-8 shadow-[0_0_80px_rgba(16,185,129,0.05)]",onClick:c=>c.stopPropagation(),children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-serif text-emerald-500 italic",children:" "}),l.jsx("p",{className:"text-stone-500 text-[10px] uppercase tracking-widest mt-2",children:"  "})]}),l.jsx("button",{onClick:r,className:"text-stone-600 hover:text-stone-300 transition-colors",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i?l.jsxs("div",{className:"space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[l.jsxs("div",{className:"p-6 rounded-2xl border bg-emerald-950/20 border-emerald-500/30",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"w-3 h-3 rounded-full animate-pulse bg-emerald-500"}),l.jsx("span",{className:"text-sm font-bold uppercase tracking-widest text-emerald-400",children:" "})]}),l.jsx("div",{className:"space-y-2",children:l.jsx("p",{className:"text-[10px] text-stone-600 mt-2 leading-relaxed",children:"     .  ,     ,    ."})})]}),l.jsx("button",{onClick:t,className:"w-full py-4 rounded-xl border border-red-900/30 text-red-500/70 hover:bg-red-950/20 hover:text-red-500 hover:border-red-900/60 transition-all text-[10px] uppercase font-bold tracking-[0.2em]",children:" "})]}):l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{className:"bg-stone-900/30 border border-stone-800 rounded-2xl p-6 text-center space-y-4",children:[l.jsx("div",{className:"w-16 h-16 bg-stone-900 rounded-full flex items-center justify-center mx-auto text-stone-600",children:l.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),l.jsx("p",{className:"text-stone-400 text-sm leading-relaxed",children:"  ,           ."})]}),l.jsx("button",{onClick:s,className:"w-full py-5 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 hover:border-emerald-500/50 text-emerald-500 rounded-xl text-[11px] uppercase font-bold tracking-[0.25em] transition-all shadow-lg shadow-emerald-900/10",children:""}),l.jsx("p",{className:"text-[9px] text-stone-600 text-center border-t border-stone-900 pt-4",children:":          ."})]})]})}),Nf=["","","","","","",""],kf=["","NPC","","",""],uc=[{id:"1",name:" ",age:34,height:"182 ",imageUrl:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?q=80&w=800&auto=format&fit=crop",tags:["","",""],hiddenTags:[""],connections:[{id:"2",name:"  ",role:""}],additionalInfo:"      ,     . ,         ,         .     ,    ."},{id:"2",name:"  ",age:21,height:"168 ",imageUrl:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?q=80&w=800&auto=format&fit=crop",tags:["",""],hiddenTags:["",""],connections:[{id:"1",name:" ",role:"  "}],additionalInfo:"   ,          .         .    ,        ."},{id:"3",name:"",age:"124 ",height:"195 ",imageUrl:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?q=80&w=800&auto=format&fit=crop",tags:["",""],hiddenTags:["NPC"],connections:[{id:"1",name:" ",role:" "}],additionalInfo:"  ,       .         .      ."}],wx=()=>{};var Cf={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oe=function(s,t){if(!s)throw ms(t)},ms=function(s){return new Error("Firebase Database ("+k0.SDK_VERSION+") INTERNAL ASSERT FAILED: "+s)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C0=function(s){const t=[];let r=0;for(let i=0;i<s.length;i++){let c=s.charCodeAt(i);c<128?t[r++]=c:c<2048?(t[r++]=c>>6|192,t[r++]=c&63|128):(c&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(c=65536+((c&1023)<<10)+(s.charCodeAt(++i)&1023),t[r++]=c>>18|240,t[r++]=c>>12&63|128,t[r++]=c>>6&63|128,t[r++]=c&63|128):(t[r++]=c>>12|224,t[r++]=c>>6&63|128,t[r++]=c&63|128)}return t},bx=function(s){const t=[];let r=0,i=0;for(;r<s.length;){const c=s[r++];if(c<128)t[i++]=String.fromCharCode(c);else if(c>191&&c<224){const d=s[r++];t[i++]=String.fromCharCode((c&31)<<6|d&63)}else if(c>239&&c<365){const d=s[r++],f=s[r++],p=s[r++],m=((c&7)<<18|(d&63)<<12|(f&63)<<6|p&63)-65536;t[i++]=String.fromCharCode(55296+(m>>10)),t[i++]=String.fromCharCode(56320+(m&1023))}else{const d=s[r++],f=s[r++];t[i++]=String.fromCharCode((c&15)<<12|(d&63)<<6|f&63)}}return t.join("")},Uc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,t){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let c=0;c<s.length;c+=3){const d=s[c],f=c+1<s.length,p=f?s[c+1]:0,m=c+2<s.length,x=m?s[c+2]:0,w=d>>2,_=(d&3)<<4|p>>4;let v=(p&15)<<2|x>>6,j=x&63;m||(j=64,f||(v=64)),i.push(r[w],r[_],r[v],r[j])}return i.join("")},encodeString(s,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(s):this.encodeByteArray(C0(s),t)},decodeString(s,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(s):bx(this.decodeStringToByteArray(s,t))},decodeStringToByteArray(s,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let c=0;c<s.length;){const d=r[s.charAt(c++)],p=c<s.length?r[s.charAt(c)]:0;++c;const x=c<s.length?r[s.charAt(c)]:64;++c;const _=c<s.length?r[s.charAt(c)]:64;if(++c,d==null||p==null||x==null||_==null)throw new _x;const v=d<<2|p>>4;if(i.push(v),x!==64){const j=p<<4&240|x>>2;if(i.push(j),_!==64){const $=x<<6&192|_;i.push($)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class _x extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const j0=function(s){const t=C0(s);return Uc.encodeByteArray(t,!0)},Hi=function(s){return j0(s).replace(/\./g,"")},Nc=function(s){try{return Uc.decodeString(s,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nx(s){return S0(void 0,s)}function S0(s,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const r=t;return new Date(r.getTime());case Object:s===void 0&&(s={});break;case Array:s=[];break;default:return t}for(const r in t)!t.hasOwnProperty(r)||!kx(r)||(s[r]=S0(s[r],t[r]));return s}function kx(s){return s!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jx=()=>Cx().__FIREBASE_DEFAULTS__,Sx=()=>{if(typeof process>"u"||typeof Cf>"u")return;const s=Cf.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},Ex=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=s&&Nc(s[1]);return t&&JSON.parse(t)},E0=()=>{try{return wx()||jx()||Sx()||Ex()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Ix=s=>{var t,r;return(r=(t=E0())==null?void 0:t.emulatorHosts)==null?void 0:r[s]},Tx=s=>{const t=Ix(s);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),i]:[t.substring(0,r),i]},I0=()=>{var s;return(s=E0())==null?void 0:s.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,i)=>{r?this.reject(r):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hc(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Lx(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mx(s,t){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},i=t||"demo-project",c=s.iat||0,d=s.sub||s.user_id;if(!d)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const f={iss:`https://securetoken.google.com/${i}`,aud:i,iat:c,exp:c+3600,auth_time:c,sub:d,user_id:d,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Hi(JSON.stringify(r)),Hi(JSON.stringify(f)),""].join(".")}const ao={};function Rx(){const s={prod:[],emulator:[]};for(const t of Object.keys(ao))ao[t]?s.emulator.push(t):s.prod.push(t);return s}function Px(s){let t=document.getElementById(s),r=!1;return t||(t=document.createElement("div"),t.setAttribute("id",s),r=!0),{created:r,element:t}}let jf=!1;function Dx(s,t){if(typeof window>"u"||typeof document>"u"||!Hc(window.location.host)||ao[s]===t||ao[s]||jf)return;ao[s]=t;function r(v){return`__firebase__banner__${v}`}const i="__firebase__banner",d=Rx().prod.length>0;function f(){const v=document.getElementById(i);v&&v.remove()}function p(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function m(v,j){v.setAttribute("width","24"),v.setAttribute("id",j),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function x(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{jf=!0,f()},v}function w(v,j){v.setAttribute("id",j),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function _(){const v=Px(i),j=r("text"),$=document.getElementById(j)||document.createElement("span"),R=r("learnmore"),q=document.getElementById(R)||document.createElement("a"),de=r("preprendIcon"),fe=document.getElementById(de)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const Se=v.element;p(Se),w(q,R);const J=x();m(fe,de),Se.append(fe,$,q,J),document.body.appendChild(Se)}d?($.innerText="Preview backend disconnected.",fe.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(fe.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,$.innerText="Preview backend running in this workspace."),$.setAttribute("id",j)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ox(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function T0(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ox())}function Ax(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $x(){return k0.NODE_ADMIN===!0}function Fx(){try{return typeof indexedDB=="object"}catch{return!1}}function zx(){return new Promise((s,t)=>{try{let r=!0;const i="validate-browser-context-for-indexeddb-analytics-module",c=self.indexedDB.open(i);c.onsuccess=()=>{c.result.close(),r||self.indexedDB.deleteDatabase(i),s(!0)},c.onupgradeneeded=()=>{r=!1},c.onerror=()=>{var d;t(((d=c.error)==null?void 0:d.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wx="FirebaseError";class ko extends Error{constructor(t,r,i){super(r),this.code=t,this.customData=i,this.name=Wx,Object.setPrototypeOf(this,ko.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,L0.prototype.create)}}class L0{constructor(t,r,i){this.service=t,this.serviceName=r,this.errors=i}create(t,...r){const i=r[0]||{},c=`${this.service}/${t}`,d=this.errors[t],f=d?Bx(d,i):"Error",p=`${this.serviceName}: ${f} (${c}).`;return new ko(c,p,i)}}function Bx(s,t){return s.replace(Ux,(r,i)=>{const c=t[i];return c!=null?String(c):`<${i}?>`})}const Ux=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mo(s){return JSON.parse(s)}function Ct(s){return JSON.stringify(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M0=function(s){let t={},r={},i={},c="";try{const d=s.split(".");t=mo(Nc(d[0])||""),r=mo(Nc(d[1])||""),c=d[2],i=r.d||{},delete r.d}catch{}return{header:t,claims:r,data:i,signature:c}},Hx=function(s){const t=M0(s),r=t.claims;return!!r&&typeof r=="object"&&r.hasOwnProperty("iat")},Vx=function(s){const t=M0(s).claims;return typeof t=="object"&&t.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $n(s,t){return Object.prototype.hasOwnProperty.call(s,t)}function ds(s,t){if(Object.prototype.hasOwnProperty.call(s,t))return s[t]}function Sf(s){for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t))return!1;return!0}function Vi(s,t,r){const i={};for(const c in s)Object.prototype.hasOwnProperty.call(s,c)&&(i[c]=t.call(r,s[c],c,s));return i}function Yi(s,t){if(s===t)return!0;const r=Object.keys(s),i=Object.keys(t);for(const c of r){if(!i.includes(c))return!1;const d=s[c],f=t[c];if(Ef(d)&&Ef(f)){if(!Yi(d,f))return!1}else if(d!==f)return!1}for(const c of i)if(!r.includes(c))return!1;return!0}function Ef(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(s){const t=[];for(const[r,i]of Object.entries(s))Array.isArray(i)?i.forEach(c=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(c))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,r){r||(r=0);const i=this.W_;if(typeof t=="string")for(let _=0;_<16;_++)i[_]=t.charCodeAt(r)<<24|t.charCodeAt(r+1)<<16|t.charCodeAt(r+2)<<8|t.charCodeAt(r+3),r+=4;else for(let _=0;_<16;_++)i[_]=t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3],r+=4;for(let _=16;_<80;_++){const v=i[_-3]^i[_-8]^i[_-14]^i[_-16];i[_]=(v<<1|v>>>31)&4294967295}let c=this.chain_[0],d=this.chain_[1],f=this.chain_[2],p=this.chain_[3],m=this.chain_[4],x,w;for(let _=0;_<80;_++){_<40?_<20?(x=p^d&(f^p),w=1518500249):(x=d^f^p,w=1859775393):_<60?(x=d&f|p&(d|f),w=2400959708):(x=d^f^p,w=3395469782);const v=(c<<5|c>>>27)+x+m+w+i[_]&4294967295;m=p,p=f,f=(d<<30|d>>>2)&4294967295,d=c,c=v}this.chain_[0]=this.chain_[0]+c&4294967295,this.chain_[1]=this.chain_[1]+d&4294967295,this.chain_[2]=this.chain_[2]+f&4294967295,this.chain_[3]=this.chain_[3]+p&4294967295,this.chain_[4]=this.chain_[4]+m&4294967295}update(t,r){if(t==null)return;r===void 0&&(r=t.length);const i=r-this.blockSize;let c=0;const d=this.buf_;let f=this.inbuf_;for(;c<r;){if(f===0)for(;c<=i;)this.compress_(t,c),c+=this.blockSize;if(typeof t=="string"){for(;c<r;)if(d[f]=t.charCodeAt(c),++f,++c,f===this.blockSize){this.compress_(d),f=0;break}}else for(;c<r;)if(d[f]=t[c],++f,++c,f===this.blockSize){this.compress_(d),f=0;break}}this.inbuf_=f,this.total_+=r}digest(){const t=[];let r=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let c=this.blockSize-1;c>=56;c--)this.buf_[c]=r&255,r/=256;this.compress_(this.buf_);let i=0;for(let c=0;c<5;c++)for(let d=24;d>=0;d-=8)t[i]=this.chain_[c]>>d&255,++i;return t}}function Vc(s,t){return`${s} failed: ${t} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gx=function(s){const t=[];let r=0;for(let i=0;i<s.length;i++){let c=s.charCodeAt(i);if(c>=55296&&c<=56319){const d=c-55296;i++,oe(i<s.length,"Surrogate pair missing trail surrogate.");const f=s.charCodeAt(i)-56320;c=65536+(d<<10)+f}c<128?t[r++]=c:c<2048?(t[r++]=c>>6|192,t[r++]=c&63|128):c<65536?(t[r++]=c>>12|224,t[r++]=c>>6&63|128,t[r++]=c&63|128):(t[r++]=c>>18|240,t[r++]=c>>12&63|128,t[r++]=c>>6&63|128,t[r++]=c&63|128)}return t},cl=function(s){let t=0;for(let r=0;r<s.length;r++){const i=s.charCodeAt(r);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,r++):t+=3}return t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Co(s){return s&&s._delegate?s._delegate:s}class go{constructor(t,r,i){this.name=t,this.instanceFactory=r,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qx{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const i=new al;if(this.instancesDeferred.set(r,i),this.isInitialized(r)||this.shouldAutoInitialize())try{const c=this.getOrInitializeService({instanceIdentifier:r});c&&i.resolve(c)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(t==null?void 0:t.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(c){if(i)return null;throw c}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Kx(t))try{this.getOrInitializeService({instanceIdentifier:kr})}catch{}for(const[r,i]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(r);try{const d=this.getOrInitializeService({instanceIdentifier:c});i.resolve(d)}catch{}}}}clearInstance(t=kr){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=kr){return this.instances.has(t)}getOptions(t=kr){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const c=this.getOrInitializeService({instanceIdentifier:i,options:r});for(const[d,f]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(d);i===p&&f.resolve(c)}return c}onInit(t,r){const i=this.normalizeInstanceIdentifier(r),c=this.onInitCallbacks.get(i)??new Set;c.add(t),this.onInitCallbacks.set(i,c);const d=this.instances.get(i);return d&&t(d,i),()=>{c.delete(t)}}invokeOnInitCallbacks(t,r){const i=this.onInitCallbacks.get(r);if(i)for(const c of i)try{c(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Xx(t),options:r}),this.instances.set(t,i),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=kr){return this.component?this.component.multipleInstances?t:kr:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Xx(s){return s===kr?void 0:s}function Kx(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new qx(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var et;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(et||(et={}));const Zx={debug:et.DEBUG,verbose:et.VERBOSE,info:et.INFO,warn:et.WARN,error:et.ERROR,silent:et.SILENT},ev=et.INFO,tv={[et.DEBUG]:"log",[et.VERBOSE]:"log",[et.INFO]:"info",[et.WARN]:"warn",[et.ERROR]:"error"},nv=(s,t,...r)=>{if(t<s.logLevel)return;const i=new Date().toISOString(),c=tv[t];if(c)console[c](`[${i}]  ${s.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class R0{constructor(t){this.name=t,this._logLevel=ev,this._logHandler=nv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in et))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Zx[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,et.DEBUG,...t),this._logHandler(this,et.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,et.VERBOSE,...t),this._logHandler(this,et.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,et.INFO,...t),this._logHandler(this,et.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,et.WARN,...t),this._logHandler(this,et.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,et.ERROR,...t),this._logHandler(this,et.ERROR,...t)}}const rv=(s,t)=>t.some(r=>s instanceof r);let If,Tf;function sv(){return If||(If=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ov(){return Tf||(Tf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const P0=new WeakMap,kc=new WeakMap,D0=new WeakMap,dc=new WeakMap,Yc=new WeakMap;function iv(s){const t=new Promise((r,i)=>{const c=()=>{s.removeEventListener("success",d),s.removeEventListener("error",f)},d=()=>{r(or(s.result)),c()},f=()=>{i(s.error),c()};s.addEventListener("success",d),s.addEventListener("error",f)});return t.then(r=>{r instanceof IDBCursor&&P0.set(r,s)}).catch(()=>{}),Yc.set(t,s),t}function lv(s){if(kc.has(s))return;const t=new Promise((r,i)=>{const c=()=>{s.removeEventListener("complete",d),s.removeEventListener("error",f),s.removeEventListener("abort",f)},d=()=>{r(),c()},f=()=>{i(s.error||new DOMException("AbortError","AbortError")),c()};s.addEventListener("complete",d),s.addEventListener("error",f),s.addEventListener("abort",f)});kc.set(s,t)}let Cc={get(s,t,r){if(s instanceof IDBTransaction){if(t==="done")return kc.get(s);if(t==="objectStoreNames")return s.objectStoreNames||D0.get(s);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return or(s[t])},set(s,t,r){return s[t]=r,!0},has(s,t){return s instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in s}};function av(s){Cc=s(Cc)}function cv(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const i=s.call(hc(this),t,...r);return D0.set(i,t.sort?t.sort():[t]),or(i)}:ov().includes(s)?function(...t){return s.apply(hc(this),t),or(P0.get(this))}:function(...t){return or(s.apply(hc(this),t))}}function uv(s){return typeof s=="function"?cv(s):(s instanceof IDBTransaction&&lv(s),rv(s,sv())?new Proxy(s,Cc):s)}function or(s){if(s instanceof IDBRequest)return iv(s);if(dc.has(s))return dc.get(s);const t=uv(s);return t!==s&&(dc.set(s,t),Yc.set(t,s)),t}const hc=s=>Yc.get(s);function dv(s,t,{blocked:r,upgrade:i,blocking:c,terminated:d}={}){const f=indexedDB.open(s,t),p=or(f);return i&&f.addEventListener("upgradeneeded",m=>{i(or(f.result),m.oldVersion,m.newVersion,or(f.transaction),m)}),r&&f.addEventListener("blocked",m=>r(m.oldVersion,m.newVersion,m)),p.then(m=>{d&&m.addEventListener("close",()=>d()),c&&m.addEventListener("versionchange",x=>c(x.oldVersion,x.newVersion,x))}).catch(()=>{}),p}const hv=["get","getKey","getAll","getAllKeys","count"],fv=["put","add","delete","clear"],fc=new Map;function Lf(s,t){if(!(s instanceof IDBDatabase&&!(t in s)&&typeof t=="string"))return;if(fc.get(t))return fc.get(t);const r=t.replace(/FromIndex$/,""),i=t!==r,c=fv.includes(r);if(!(r in(i?IDBIndex:IDBObjectStore).prototype)||!(c||hv.includes(r)))return;const d=async function(f,...p){const m=this.transaction(f,c?"readwrite":"readonly");let x=m.store;return i&&(x=x.index(p.shift())),(await Promise.all([x[r](...p),c&&m.done]))[0]};return fc.set(t,d),d}av(s=>({...s,get:(t,r,i)=>Lf(t,r)||s.get(t,r,i),has:(t,r)=>!!Lf(t,r)||s.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(mv(r)){const i=r.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(r=>r).join(" ")}}function mv(s){const t=s.getComponent();return(t==null?void 0:t.type)==="VERSION"}const jc="@firebase/app",Mf="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dn=new R0("@firebase/app"),gv="@firebase/app-compat",xv="@firebase/analytics-compat",vv="@firebase/analytics",yv="@firebase/app-check-compat",wv="@firebase/app-check",bv="@firebase/auth",_v="@firebase/auth-compat",Nv="@firebase/database",kv="@firebase/data-connect",Cv="@firebase/database-compat",jv="@firebase/functions",Sv="@firebase/functions-compat",Ev="@firebase/installations",Iv="@firebase/installations-compat",Tv="@firebase/messaging",Lv="@firebase/messaging-compat",Mv="@firebase/performance",Rv="@firebase/performance-compat",Pv="@firebase/remote-config",Dv="@firebase/remote-config-compat",Ov="@firebase/storage",Av="@firebase/storage-compat",$v="@firebase/firestore",Fv="@firebase/ai",zv="@firebase/firestore-compat",Wv="firebase",Bv="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sc="[DEFAULT]",Uv={[jc]:"fire-core",[gv]:"fire-core-compat",[vv]:"fire-analytics",[xv]:"fire-analytics-compat",[wv]:"fire-app-check",[yv]:"fire-app-check-compat",[bv]:"fire-auth",[_v]:"fire-auth-compat",[Nv]:"fire-rtdb",[kv]:"fire-data-connect",[Cv]:"fire-rtdb-compat",[jv]:"fire-fn",[Sv]:"fire-fn-compat",[Ev]:"fire-iid",[Iv]:"fire-iid-compat",[Tv]:"fire-fcm",[Lv]:"fire-fcm-compat",[Mv]:"fire-perf",[Rv]:"fire-perf-compat",[Pv]:"fire-rc",[Dv]:"fire-rc-compat",[Ov]:"fire-gcs",[Av]:"fire-gcs-compat",[$v]:"fire-fst",[zv]:"fire-fst-compat",[Fv]:"fire-vertex","fire-js":"fire-js",[Wv]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qi=new Map,Hv=new Map,Ec=new Map;function Rf(s,t){try{s.container.addComponent(t)}catch(r){Dn.debug(`Component ${t.name} failed to register with FirebaseApp ${s.name}`,r)}}function Gi(s){const t=s.name;if(Ec.has(t))return Dn.debug(`There were multiple attempts to register component ${t}.`),!1;Ec.set(t,s);for(const r of Qi.values())Rf(r,s);for(const r of Hv.values())Rf(r,s);return!0}function Vv(s,t){const r=s.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),s.container.getProvider(t)}function Yv(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qv={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ir=new L0("app","Firebase",Qv);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv{constructor(t,r,i){this._isDeleted=!1,this._options={...t},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new go("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ir.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qv=Bv;function O0(s,t={}){let r=s;typeof t!="object"&&(t={name:t});const i={name:Sc,automaticDataCollectionEnabled:!0,...t},c=i.name;if(typeof c!="string"||!c)throw ir.create("bad-app-name",{appName:String(c)});if(r||(r=I0()),!r)throw ir.create("no-options");const d=Qi.get(c);if(d){if(Yi(r,d.options)&&Yi(i,d.config))return d;throw ir.create("duplicate-app",{appName:c})}const f=new Jx(c);for(const m of Ec.values())f.addComponent(m);const p=new Gv(r,i,f);return Qi.set(c,p),p}function Xv(s=Sc){const t=Qi.get(s);if(!t&&s===Sc&&I0())return O0();if(!t)throw ir.create("no-app",{appName:s});return t}function ls(s,t,r){let i=Uv[s]??s;r&&(i+=`-${r}`);const c=i.match(/\s|\//),d=t.match(/\s|\//);if(c||d){const f=[`Unable to register library "${i}" with version "${t}":`];c&&f.push(`library name "${i}" contains illegal characters (whitespace or "/")`),c&&d&&f.push("and"),d&&f.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Dn.warn(f.join(" "));return}Gi(new go(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kv="firebase-heartbeat-database",Jv=1,xo="firebase-heartbeat-store";let pc=null;function A0(){return pc||(pc=dv(Kv,Jv,{upgrade:(s,t)=>{switch(t){case 0:try{s.createObjectStore(xo)}catch(r){console.warn(r)}}}}).catch(s=>{throw ir.create("idb-open",{originalErrorMessage:s.message})})),pc}async function Zv(s){try{const r=(await A0()).transaction(xo),i=await r.objectStore(xo).get($0(s));return await r.done,i}catch(t){if(t instanceof ko)Dn.warn(t.message);else{const r=ir.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Dn.warn(r.message)}}}async function Pf(s,t){try{const i=(await A0()).transaction(xo,"readwrite");await i.objectStore(xo).put(t,$0(s)),await i.done}catch(r){if(r instanceof ko)Dn.warn(r.message);else{const i=ir.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Dn.warn(i.message)}}}function $0(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1=1024,t1=30;class n1{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new s1(r),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,r;try{const c=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),d=Df();if(((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===d||this._heartbeatsCache.heartbeats.some(f=>f.date===d))return;if(this._heartbeatsCache.heartbeats.push({date:d,agent:c}),this._heartbeatsCache.heartbeats.length>t1){const f=o1(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(f,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Dn.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Df(),{heartbeatsToSend:i,unsentEntries:c}=r1(this._heartbeatsCache.heartbeats),d=Hi(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=r,c.length>0?(this._heartbeatsCache.heartbeats=c,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),d}catch(r){return Dn.warn(r),""}}}function Df(){return new Date().toISOString().substring(0,10)}function r1(s,t=e1){const r=[];let i=s.slice();for(const c of s){const d=r.find(f=>f.agent===c.agent);if(d){if(d.dates.push(c.date),Of(r)>t){d.dates.pop();break}}else if(r.push({agent:c.agent,dates:[c.date]}),Of(r)>t){r.pop();break}i=i.slice(1)}return{heartbeatsToSend:r,unsentEntries:i}}class s1{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Fx()?zx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Zv(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return Pf(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return Pf(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function Of(s){return Hi(JSON.stringify({version:2,heartbeats:s})).length}function o1(s){if(s.length===0)return-1;let t=0,r=s[0].date;for(let i=1;i<s.length;i++)s[i].date<r&&(r=s[i].date,t=i);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i1(s){Gi(new go("platform-logger",t=>new pv(t),"PRIVATE")),Gi(new go("heartbeat",t=>new n1(t),"PRIVATE")),ls(jc,Mf,s),ls(jc,Mf,"esm2020"),ls("fire-js","")}i1("");var l1="firebase",a1="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ls(l1,a1,"app");var Af={};const $f="@firebase/database",Ff="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let F0="";function c1(s){F0=s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,r){r==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),Ct(r))}get(t){const r=this.domStorage_.getItem(this.prefixedName_(t));return r==null?null:mo(r)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,r){r==null?delete this.cache_[t]:this.cache_[t]=r}get(t){return $n(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z0=function(s){try{if(typeof window<"u"&&typeof window[s]<"u"){const t=window[s];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new u1(t)}}catch{}return new d1},jr=z0("localStorage"),h1=z0("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const as=new R0("@firebase/database"),f1=(function(){let s=1;return function(){return s++}})(),W0=function(s){const t=Gx(s),r=new Qx;r.update(t);const i=r.digest();return Uc.encodeByteArray(i)},jo=function(...s){let t="";for(let r=0;r<s.length;r++){const i=s[r];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?t+=jo.apply(null,i):typeof i=="object"?t+=Ct(i):t+=i,t+=" "}return t};let co=null,zf=!0;const p1=function(s,t){oe(!0,"Can't turn on custom loggers persistently."),as.logLevel=et.VERBOSE,co=as.log.bind(as)},Pt=function(...s){if(zf===!0&&(zf=!1,co===null&&h1.get("logging_enabled")===!0&&p1()),co){const t=jo.apply(null,s);co(t)}},So=function(s){return function(...t){Pt(s,...t)}},Ic=function(...s){const t="FIREBASE INTERNAL ERROR: "+jo(...s);as.error(t)},On=function(...s){const t=`FIREBASE FATAL ERROR: ${jo(...s)}`;throw as.error(t),new Error(t)},Qt=function(...s){const t="FIREBASE WARNING: "+jo(...s);as.warn(t)},m1=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Qt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},B0=function(s){return typeof s=="number"&&(s!==s||s===Number.POSITIVE_INFINITY||s===Number.NEGATIVE_INFINITY)},g1=function(s){if(document.readyState==="complete")s();else{let t=!1;const r=function(){if(!document.body){setTimeout(r,Math.floor(10));return}t||(t=!0,s())};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&r()}),window.attachEvent("onload",r))}},hs="[MIN_NAME]",Er="[MAX_NAME]",gs=function(s,t){if(s===t)return 0;if(s===hs||t===Er)return-1;if(t===hs||s===Er)return 1;{const r=Wf(s),i=Wf(t);return r!==null?i!==null?r-i===0?s.length-t.length:r-i:-1:i!==null?1:s<t?-1:1}},x1=function(s,t){return s===t?0:s<t?-1:1},so=function(s,t){if(t&&s in t)return t[s];throw new Error("Missing required key ("+s+") in object: "+Ct(t))},Qc=function(s){if(typeof s!="object"||s===null)return Ct(s);const t=[];for(const i in s)t.push(i);t.sort();let r="{";for(let i=0;i<t.length;i++)i!==0&&(r+=","),r+=Ct(t[i]),r+=":",r+=Qc(s[t[i]]);return r+="}",r},U0=function(s,t){const r=s.length;if(r<=t)return[s];const i=[];for(let c=0;c<r;c+=t)c+t>r?i.push(s.substring(c,r)):i.push(s.substring(c,c+t));return i};function Gt(s,t){for(const r in s)s.hasOwnProperty(r)&&t(r,s[r])}const H0=function(s){oe(!B0(s),"Invalid JSON number");const t=11,r=52,i=(1<<t-1)-1;let c,d,f,p,m;s===0?(d=0,f=0,c=1/s===-1/0?1:0):(c=s<0,s=Math.abs(s),s>=Math.pow(2,1-i)?(p=Math.min(Math.floor(Math.log(s)/Math.LN2),i),d=p+i,f=Math.round(s*Math.pow(2,r-p)-Math.pow(2,r))):(d=0,f=Math.round(s/Math.pow(2,1-i-r))));const x=[];for(m=r;m;m-=1)x.push(f%2?1:0),f=Math.floor(f/2);for(m=t;m;m-=1)x.push(d%2?1:0),d=Math.floor(d/2);x.push(c?1:0),x.reverse();const w=x.join("");let _="";for(m=0;m<64;m+=8){let v=parseInt(w.substr(m,8),2).toString(16);v.length===1&&(v="0"+v),_=_+v}return _.toLowerCase()},v1=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},y1=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function w1(s,t){let r="Unknown Error";s==="too_big"?r="The data requested exceeds the maximum size that can be accessed with a single request.":s==="permission_denied"?r="Client doesn't have permission to access the desired data.":s==="unavailable"&&(r="The service is unavailable");const i=new Error(s+" at "+t._path.toString()+": "+r);return i.code=s.toUpperCase(),i}const b1=new RegExp("^-?(0*)\\d{1,10}$"),_1=-2147483648,N1=2147483647,Wf=function(s){if(b1.test(s)){const t=Number(s);if(t>=_1&&t<=N1)return t}return null},xs=function(s){try{s()}catch(t){setTimeout(()=>{const r=t.stack||"";throw Qt("Exception was thrown by user callback.",r),t},Math.floor(0))}},k1=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},uo=function(s,t){const r=setTimeout(s,t);return typeof r=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(r):typeof r=="object"&&r.unref&&r.unref(),r};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{constructor(t,r){this.appCheckProvider=r,this.appName=t.name,Yv(t)&&t.settings.appCheckToken&&(this.serverAppAppCheckToken=t.settings.appCheckToken),this.appCheck=r==null?void 0:r.getImmediate({optional:!0}),this.appCheck||r==null||r.get().then(i=>this.appCheck=i)}getToken(t){if(this.serverAppAppCheckToken){if(t)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(t):new Promise((r,i)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(r,i):r(null)},0)})}addTokenChangeListener(t){var r;(r=this.appCheckProvider)==null||r.get().then(i=>i.addTokenListener(t))}notifyForInvalidToken(){Qt(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1{constructor(t,r,i){this.appName_=t,this.firebaseOptions_=r,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(c=>this.auth_=c)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(r=>r&&r.code==="auth/token-not-initialized"?(Pt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(r)):new Promise((r,i)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(r,i):r(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(r=>r.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(r=>r.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Qt(t)}}class Wi{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}Wi.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gc="5",V0="v",Y0="s",Q0="r",G0="f",q0=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,X0="ls",K0="p",Tc="ac",J0="websocket",Z0="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{constructor(t,r,i,c,d=!1,f="",p=!1,m=!1,x=null){this.secure=r,this.namespace=i,this.webSocketOnly=c,this.nodeAdmin=d,this.persistenceKey=f,this.includeNamespaceInQueryParams=p,this.isUsingEmulator=m,this.emulatorOptions=x,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=jr.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&jr.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",r=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${r}`}}function S1(s){return s.host!==s.internalHost||s.isCustomHost()||s.includeNamespaceInQueryParams}function tp(s,t,r){oe(typeof t=="string","typeof type must == string"),oe(typeof r=="object","typeof params must == object");let i;if(t===J0)i=(s.secure?"wss://":"ws://")+s.internalHost+"/.ws?";else if(t===Z0)i=(s.secure?"https://":"http://")+s.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);S1(s)&&(r.ns=s.namespace);const c=[];return Gt(r,(d,f)=>{c.push(d+"="+f)}),i+c.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(){this.counters_={}}incrementCounter(t,r=1){$n(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=r}get(){return Nx(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mc={},gc={};function qc(s){const t=s.toString();return mc[t]||(mc[t]=new E1),mc[t]}function I1(s,t){const r=s.toString();return gc[r]||(gc[r]=t()),gc[r]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,r){this.closeAfterResponse=t,this.onClose=r,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,r){for(this.pendingResponses[t]=r;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let c=0;c<i.length;++c)i[c]&&xs(()=>{this.onMessage_(i[c])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bf="start",L1="close",M1="pLPCommand",R1="pRTLPCB",np="id",rp="pw",sp="ser",P1="cb",D1="seg",O1="ts",A1="d",$1="dframe",op=1870,ip=30,F1=op-ip,z1=25e3,W1=3e4;class is{constructor(t,r,i,c,d,f,p){this.connId=t,this.repoInfo=r,this.applicationId=i,this.appCheckToken=c,this.authToken=d,this.transportSessionId=f,this.lastSessionId=p,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=So(t),this.stats_=qc(r),this.urlFn=m=>(this.appCheckToken&&(m[Tc]=this.appCheckToken),tp(r,Z0,m))}open(t,r){this.curSegmentNum=0,this.onDisconnect_=r,this.myPacketOrderer=new T1(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(W1)),g1(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Xc((...d)=>{const[f,p,m,x,w]=d;if(this.incrementIncomingBytes_(d),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,f===Bf)this.id=p,this.password=m;else if(f===L1)p?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(p,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+f)},(...d)=>{const[f,p]=d;this.incrementIncomingBytes_(d),this.myPacketOrderer.handleResponse(f,p)},()=>{this.onClosed_()},this.urlFn);const i={};i[Bf]="t",i[sp]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[P1]=this.scriptTagHolder.uniqueCallbackIdentifier),i[V0]=Gc,this.transportSessionId&&(i[Y0]=this.transportSessionId),this.lastSessionId&&(i[X0]=this.lastSessionId),this.applicationId&&(i[K0]=this.applicationId),this.appCheckToken&&(i[Tc]=this.appCheckToken),typeof location<"u"&&location.hostname&&q0.test(location.hostname)&&(i[Q0]=G0);const c=this.urlFn(i);this.log_("Connecting via long-poll to "+c),this.scriptTagHolder.addTag(c,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){is.forceAllow_=!0}static forceDisallow(){is.forceDisallow_=!0}static isAvailable(){return is.forceAllow_?!0:!is.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!v1()&&!y1()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const r=Ct(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=j0(r),c=U0(i,F1);for(let d=0;d<c.length;d++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,c.length,c[d]),this.curSegmentNum++}addDisconnectPingFrame(t,r){this.myDisconnFrame=document.createElement("iframe");const i={};i[$1]="t",i[np]=t,i[rp]=r,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const r=Ct(t).length;this.bytesReceived+=r,this.stats_.incrementCounter("bytes_received",r)}}class Xc{constructor(t,r,i,c){this.onDisconnect=i,this.urlFn=c,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=f1(),window[M1+this.uniqueCallbackIdentifier]=t,window[R1+this.uniqueCallbackIdentifier]=r,this.myIFrame=Xc.createIFrame_();let d="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(d='<script>document.domain="'+document.domain+'";<\/script>');const f="<html><body>"+d+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(f),this.myIFrame.doc.close()}catch(p){Pt("frame writing exception"),p.stack&&Pt(p.stack),Pt(p)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||Pt("No IE domain setting required")}catch{const i=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,r){for(this.myID=t,this.myPW=r,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t[np]=this.myID,t[rp]=this.myPW,t[sp]=this.currentSerial;let r=this.urlFn(t),i="",c=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+ip+i.length<=op;){const f=this.pendingSegs.shift();i=i+"&"+D1+c+"="+f.seg+"&"+O1+c+"="+f.ts+"&"+A1+c+"="+f.d,c++}return r=r+i,this.addLongPollTag_(r,this.currentSerial),!0}else return!1}enqueueSegment(t,r,i){this.pendingSegs.push({seg:t,ts:r,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(t,r){this.outstandingRequests.add(r);const i=()=>{this.outstandingRequests.delete(r),this.newRequest_()},c=setTimeout(i,Math.floor(z1)),d=()=>{clearTimeout(c),i()};this.addTag(t,d)}addTag(t,r){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){const c=i.readyState;(!c||c==="loaded"||c==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),r())},i.onerror=()=>{Pt("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B1=16384,U1=45e3;let qi=null;typeof MozWebSocket<"u"?qi=MozWebSocket:typeof WebSocket<"u"&&(qi=WebSocket);class gn{constructor(t,r,i,c,d,f,p){this.connId=t,this.applicationId=i,this.appCheckToken=c,this.authToken=d,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=So(this.connId),this.stats_=qc(r),this.connURL=gn.connectionURL_(r,f,p,c,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,c,d){const f={};return f[V0]=Gc,typeof location<"u"&&location.hostname&&q0.test(location.hostname)&&(f[Q0]=G0),r&&(f[Y0]=r),i&&(f[X0]=i),c&&(f[Tc]=c),d&&(f[K0]=d),tp(t,J0,f)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,jr.set("previous_websocket_failure",!0);try{let i;$x(),this.mySock=new qi(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const c=i.message||i.data;c&&this.log_(c),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const c=i.message||i.data;c&&this.log_(c),this.onClosed_()}}start(){}static forceDisallow(){gn.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&qi!==null&&!gn.forceDisallow_}static previouslyFailed(){return jr.isInMemoryStorage||jr.get("previous_websocket_failure")===!0}markConnectionHealthy(){jr.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=mo(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(oe(this.frames===null,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const r=Ct(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=U0(r,B1);i.length>1&&this.sendString_(String(i.length));for(let c=0;c<i.length;c++)this.sendString_(i[c])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(U1))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}gn.responsesRequiredToBeHealthy=2;gn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{static get ALL_TRANSPORTS(){return[is,gn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){const r=gn&&gn.isAvailable();let i=r&&!gn.previouslyFailed();if(t.webSocketOnly&&(r||Qt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[gn];else{const c=this.transports_=[];for(const d of vo.ALL_TRANSPORTS)d&&d.isAvailable()&&c.push(d);vo.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}vo.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H1=6e4,V1=5e3,Y1=10*1024,Q1=100*1024,xc="t",Uf="d",G1="s",Hf="r",q1="e",Vf="o",Yf="a",Qf="n",Gf="p",X1="h";class K1{constructor(t,r,i,c,d,f,p,m,x,w){this.id=t,this.repoInfo_=r,this.applicationId_=i,this.appCheckToken_=c,this.authToken_=d,this.onMessage_=f,this.onReady_=p,this.onDisconnect_=m,this.onKill_=x,this.lastSessionId=w,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=So("c:"+this.id+":"),this.transportManager_=new vo(r),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(r,i)},Math.floor(0));const c=t.healthyTimeout||0;c>0&&(this.healthyTimeout_=uo(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Q1?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Y1?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(c)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return r=>{t===this.conn_?this.onConnectionLost_(r):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return r=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(r):t===this.secondaryConn_?this.onSecondaryMessageReceived_(r):this.log_("message on old connection"))}}sendRequest(t){const r={t:"d",d:t};this.sendData_(r)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(xc in t){const r=t[xc];r===Yf?this.upgradeIfSecondaryHealthy_():r===Hf?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):r===Vf&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const r=so("t",t),i=so("d",t);if(r==="c")this.onSecondaryControl_(i);else if(r==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+r)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Gf,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Yf,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Qf,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const r=so("t",t),i=so("d",t);r==="c"?this.onControl_(i):r==="d"&&this.onDataMessage_(i)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const r=so(xc,t);if(Uf in t){const i=t[Uf];if(r===X1){const c={...i};this.repoInfo_.isUsingEmulator&&(c.h=this.repoInfo_.host),this.onHandshake_(c)}else if(r===Qf){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let c=0;c<this.pendingDataMessages.length;++c)this.onDataMessage_(this.pendingDataMessages[c]);this.pendingDataMessages=[],this.tryCleanupConnection()}else r===G1?this.onConnectionShutdown_(i):r===Hf?this.onReset_(i):r===q1?Ic("Server Error: "+i):r===Vf?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Ic("Unknown control packet command: "+r)}}onHandshake_(t){const r=t.ts,i=t.v,c=t.h;this.sessionId=t.s,this.repoInfo_.host=c,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,r),Gc!==i&&Qt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,i),uo(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(H1))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,r){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(r,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):uo(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(V1))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Gf,d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(jr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{put(t,r,i,c){}merge(t,r,i,c){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,r,i){}onDisconnectMerge(t,r,i){}onDisconnectCancel(t,r){}reportStats(t){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(t){this.allowedEvents_=t,this.listeners_={},oe(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...r){if(Array.isArray(this.listeners_[t])){const i=[...this.listeners_[t]];for(let c=0;c<i.length;c++)i[c].callback.apply(i[c].context,r)}}on(t,r,i){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:r,context:i});const c=this.getInitialEvent(t);c&&r.apply(i,c)}off(t,r,i){this.validateEventType_(t);const c=this.listeners_[t]||[];for(let d=0;d<c.length;d++)if(c[d].callback===r&&(!i||i===c[d].context)){c.splice(d,1);return}}validateEventType_(t){oe(this.allowedEvents_.find(r=>r===t),"Unknown event: "+t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi extends ap{static getInstance(){return new Xi}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!T0()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(t){return oe(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qf=32,Xf=768;class Je{constructor(t,r){if(r===void 0){this.pieces_=t.split("/");let i=0;for(let c=0;c<this.pieces_.length;c++)this.pieces_[c].length>0&&(this.pieces_[i]=this.pieces_[c],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=r}toString(){let t="";for(let r=this.pieceNum_;r<this.pieces_.length;r++)this.pieces_[r]!==""&&(t+="/"+this.pieces_[r]);return t||"/"}}function Xe(){return new Je("")}function Be(s){return s.pieceNum_>=s.pieces_.length?null:s.pieces_[s.pieceNum_]}function ar(s){return s.pieces_.length-s.pieceNum_}function tt(s){let t=s.pieceNum_;return t<s.pieces_.length&&t++,new Je(s.pieces_,t)}function cp(s){return s.pieceNum_<s.pieces_.length?s.pieces_[s.pieces_.length-1]:null}function J1(s){let t="";for(let r=s.pieceNum_;r<s.pieces_.length;r++)s.pieces_[r]!==""&&(t+="/"+encodeURIComponent(String(s.pieces_[r])));return t||"/"}function up(s,t=0){return s.pieces_.slice(s.pieceNum_+t)}function dp(s){if(s.pieceNum_>=s.pieces_.length)return null;const t=[];for(let r=s.pieceNum_;r<s.pieces_.length-1;r++)t.push(s.pieces_[r]);return new Je(t,0)}function yt(s,t){const r=[];for(let i=s.pieceNum_;i<s.pieces_.length;i++)r.push(s.pieces_[i]);if(t instanceof Je)for(let i=t.pieceNum_;i<t.pieces_.length;i++)r.push(t.pieces_[i]);else{const i=t.split("/");for(let c=0;c<i.length;c++)i[c].length>0&&r.push(i[c])}return new Je(r,0)}function Ve(s){return s.pieceNum_>=s.pieces_.length}function Vt(s,t){const r=Be(s),i=Be(t);if(r===null)return t;if(r===i)return Vt(tt(s),tt(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+s+")")}function Kc(s,t){if(ar(s)!==ar(t))return!1;for(let r=s.pieceNum_,i=t.pieceNum_;r<=s.pieces_.length;r++,i++)if(s.pieces_[r]!==t.pieces_[i])return!1;return!0}function xn(s,t){let r=s.pieceNum_,i=t.pieceNum_;if(ar(s)>ar(t))return!1;for(;r<s.pieces_.length;){if(s.pieces_[r]!==t.pieces_[i])return!1;++r,++i}return!0}class Z1{constructor(t,r){this.errorPrefix_=r,this.parts_=up(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=cl(this.parts_[i]);hp(this)}}function ey(s,t){s.parts_.length>0&&(s.byteLength_+=1),s.parts_.push(t),s.byteLength_+=cl(t),hp(s)}function ty(s){const t=s.parts_.pop();s.byteLength_-=cl(t),s.parts_.length>0&&(s.byteLength_-=1)}function hp(s){if(s.byteLength_>Xf)throw new Error(s.errorPrefix_+"has a key path longer than "+Xf+" bytes ("+s.byteLength_+").");if(s.parts_.length>qf)throw new Error(s.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+qf+") or object contains a cycle "+Cr(s))}function Cr(s){return s.parts_.length===0?"":"in property '"+s.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc extends ap{static getInstance(){return new Jc}constructor(){super(["visible"]);let t,r;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(r="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(r="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(r="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(r="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,r&&document.addEventListener(r,()=>{const i=!document[t];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}getInitialEvent(t){return oe(t==="visible","Unknown event type: "+t),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oo=1e3,ny=300*1e3,Kf=30*1e3,ry=1.3,sy=3e4,oy="server_kill",Jf=3;class Pn extends lp{constructor(t,r,i,c,d,f,p,m){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=c,this.onServerInfoUpdate_=d,this.authTokenProvider_=f,this.appCheckTokenProvider_=p,this.authOverride_=m,this.id=Pn.nextPersistentConnectionId_++,this.log_=So("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=oo,this.maxReconnectDelay_=ny,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,m)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Jc.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Xi.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){const c=++this.requestNumber_,d={r:c,a:t,b:r};this.log_(Ct(d)),oe(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(d),i&&(this.requestCBHash_[c]=i)}get(t){this.initConnection_();const r=new al,c={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:f=>{const p=f.d;f.s==="ok"?r.resolve(p):r.reject(p)}};this.outstandingGets_.push(c),this.outstandingGetCount_++;const d=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(d),r.promise}listen(t,r,i,c){this.initConnection_();const d=t._queryIdentifier,f=t._path.toString();this.log_("Listen called for "+f+" "+d),this.listens.has(f)||this.listens.set(f,new Map),oe(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),oe(!this.listens.get(f).has(d),"listen() called twice for same path/queryId.");const p={onComplete:c,hashFn:r,query:t,tag:i};this.listens.get(f).set(d,p),this.connected_&&this.sendListen_(p)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){const r=t.query,i=r._path.toString(),c=r._queryIdentifier;this.log_("Listen on "+i+" for "+c);const d={p:i},f="q";t.tag&&(d.q=r._queryObject,d.t=t.tag),d.h=t.hashFn(),this.sendRequest(f,d,p=>{const m=p.d,x=p.s;Pn.warnOnListenWarnings_(m,r),(this.listens.get(i)&&this.listens.get(i).get(c))===t&&(this.log_("listen response",p),x!=="ok"&&this.removeListen_(i,c),t.onComplete&&t.onComplete(x,m))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&$n(t,"w")){const i=ds(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const c='".indexOn": "'+r._queryParams.getIndex().toString()+'"',d=r._path.toString();Qt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${c} at ${d} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||Vx(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Kf)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=Hx(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,c=>{const d=c.s,f=c.d||"error";this.authToken_===t&&(d==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(d,f))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){const i=t._path.toString(),c=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+c),oe(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,c)&&this.connected_&&this.sendUnlisten_(i,c,t._queryObject,r)}sendUnlisten_(t,r,i,c){this.log_("Unlisten on "+t+" for "+r);const d={p:t},f="n";c&&(d.q=i,d.t=c),this.sendRequest(f,d)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,c){const d={p:r,d:i};this.log_("onDisconnect "+t,d),this.sendRequest(t,d,f=>{c&&setTimeout(()=>{c(f.s,f.d)},Math.floor(0))})}put(t,r,i,c){this.putInternal("p",t,r,i,c)}merge(t,r,i,c){this.putInternal("m",t,r,i,c)}putInternal(t,r,i,c,d){this.initConnection_();const f={p:r,d:i};d!==void 0&&(f.h=d),this.outstandingPuts_.push({action:t,request:f,onComplete:c}),this.outstandingPutCount_++;const p=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(p):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,c=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,d=>{this.log_(r+" response",d),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),c&&c(d.s,d.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){const d=i.d;this.log_("reportStats","Error sending stats: "+d)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Ct(t));const r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):Ic("Unrecognized action received from server: "+Ct(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){oe(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=oo,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=oo,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>sy&&(this.reconnectDelay_=oo),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*ry)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),c=this.id+":"+Pn.nextConnectionId_++,d=this.lastSessionId;let f=!1,p=null;const m=function(){p?p.close():(f=!0,i())},x=function(_){oe(p,"sendRequest call when we're not connected not allowed."),p.sendRequest(_)};this.realtime_={close:m,sendRequest:x};const w=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[_,v]=await Promise.all([this.authTokenProvider_.getToken(w),this.appCheckTokenProvider_.getToken(w)]);f?Pt("getToken() completed but was canceled"):(Pt("getToken() completed. Creating connection."),this.authToken_=_&&_.accessToken,this.appCheckToken_=v&&v.token,p=new K1(c,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,j=>{Qt(j+" ("+this.repoInfo_.toString()+")"),this.interrupt(oy)},d))}catch(_){this.log_("Failed to get token: "+_),f||(this.repoInfo_.nodeAdmin&&Qt(_),m())}}}interrupt(t){Pt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Pt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Sf(this.interruptReasons_)&&(this.reconnectDelay_=oo,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(d=>Qc(d)).join("$"):i="default";const c=this.removeListen_(t,i);c&&c.onComplete&&c.onComplete("permission_denied")}removeListen_(t,r){const i=new Je(t).toString();let c;if(this.listens.has(i)){const d=this.listens.get(i);c=d.get(r),d.delete(r),d.size===0&&this.listens.delete(i)}else c=void 0;return c}onAuthRevoked_(t,r){Pt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Jf&&(this.reconnectDelay_=Kf,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Pt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Jf&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";t["sdk."+r+"."+F0.replace(/\./g,"-")]=1,T0()?t["framework.cordova"]=1:Ax()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Xi.getInstance().currentlyOnline();return Sf(this.interruptReasons_)&&t}}Pn.nextPersistentConnectionId_=0;Pn.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(t,r){this.name=t,this.node=r}static Wrap(t,r){return new Ue(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,r){const i=new Ue(hs,t),c=new Ue(hs,r);return this.compare(i,c)!==0}minPost(){return Ue.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fi;class fp extends ul{static get __EMPTY_NODE(){return Fi}static set __EMPTY_NODE(t){Fi=t}compare(t,r){return gs(t.name,r.name)}isDefinedOn(t){throw ms("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,r){return!1}minPost(){return Ue.MIN}maxPost(){return new Ue(Er,Fi)}makePost(t,r){return oe(typeof t=="string","KeyIndex indexValue must always be a string."),new Ue(t,Fi)}toString(){return".key"}}const cs=new fp;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(t,r,i,c,d=null){this.isReverse_=c,this.resultGenerator_=d,this.nodeStack_=[];let f=1;for(;!t.isEmpty();)if(t=t,f=r?i(t.key,r):1,c&&(f*=-1),f<0)this.isReverse_?t=t.left:t=t.right;else if(f===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),r;if(this.resultGenerator_?r=this.resultGenerator_(t.key,t.value):r={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return r}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class kt{constructor(t,r,i,c,d){this.key=t,this.value=r,this.color=i??kt.RED,this.left=c??Yt.EMPTY_NODE,this.right=d??Yt.EMPTY_NODE}copy(t,r,i,c,d){return new kt(t??this.key,r??this.value,i??this.color,c??this.left,d??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let c=this;const d=i(t,c.key);return d<0?c=c.copy(null,null,null,c.left.insert(t,r,i),null):d===0?c=c.copy(null,r,null,null,null):c=c.copy(null,null,null,null,c.right.insert(t,r,i)),c.fixUp_()}removeMin_(){if(this.left.isEmpty())return Yt.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,c;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return Yt.EMPTY_NODE;c=i.right.min_(),i=i.copy(c.key,c.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,kt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,kt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}kt.RED=!0;kt.BLACK=!1;class iy{copy(t,r,i,c,d){return this}insert(t,r,i){return new kt(t,r,null)}remove(t,r){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Yt{constructor(t,r=Yt.EMPTY_NODE){this.comparator_=t,this.root_=r}insert(t,r){return new Yt(this.comparator_,this.root_.insert(t,r,this.comparator_).copy(null,null,kt.BLACK,null,null))}remove(t){return new Yt(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,kt.BLACK,null,null))}get(t){let r,i=this.root_;for(;!i.isEmpty();){if(r=this.comparator_(t,i.key),r===0)return i.value;r<0?i=i.left:r>0&&(i=i.right)}return null}getPredecessorKey(t){let r,i=this.root_,c=null;for(;!i.isEmpty();)if(r=this.comparator_(t,i.key),r===0){if(i.left.isEmpty())return c?c.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else r<0?i=i.left:r>0&&(c=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new zi(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,r){return new zi(this.root_,t,this.comparator_,!1,r)}getReverseIteratorFrom(t,r){return new zi(this.root_,t,this.comparator_,!0,r)}getReverseIterator(t){return new zi(this.root_,null,this.comparator_,!0,t)}}Yt.EMPTY_NODE=new iy;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ly(s,t){return gs(s.name,t.name)}function Zc(s,t){return gs(s,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lc;function ay(s){Lc=s}const pp=function(s){return typeof s=="number"?"number:"+H0(s):"string:"+s},mp=function(s){if(s.isLeafNode()){const t=s.val();oe(typeof t=="string"||typeof t=="number"||typeof t=="object"&&$n(t,".sv"),"Priority must be a string or number.")}else oe(s===Lc||s.isEmpty(),"priority of unexpected type.");oe(s===Lc||s.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zf;class Nt{static set __childrenNodeConstructor(t){Zf=t}static get __childrenNodeConstructor(){return Zf}constructor(t,r=Nt.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,oe(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),mp(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new Nt(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:Nt.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Ve(t)?this:Be(t)===".priority"?this.priorityNode_:Nt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:Nt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const i=Be(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(oe(i!==".priority"||ar(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,Nt.__childrenNodeConstructor.EMPTY_NODE.updateChild(tt(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+pp(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",r==="number"?t+=H0(this.value_):t+=this.value_,this.lazyHash_=W0(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===Nt.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof Nt.__childrenNodeConstructor?-1:(oe(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,i=typeof this.value_,c=Nt.VALUE_TYPE_ORDER.indexOf(r),d=Nt.VALUE_TYPE_ORDER.indexOf(i);return oe(c>=0,"Unknown leaf type: "+r),oe(d>=0,"Unknown leaf type: "+i),c===d?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:d-c}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}Nt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gp,xp;function cy(s){gp=s}function uy(s){xp=s}class dy extends ul{compare(t,r){const i=t.node.getPriority(),c=r.node.getPriority(),d=i.compareTo(c);return d===0?gs(t.name,r.name):d}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,r){return!t.getPriority().equals(r.getPriority())}minPost(){return Ue.MIN}maxPost(){return new Ue(Er,new Nt("[PRIORITY-POST]",xp))}makePost(t,r){const i=gp(t);return new Ue(r,new Nt("[PRIORITY-POST]",i))}toString(){return".priority"}}const ut=new dy;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hy=Math.log(2);class fy{constructor(t){const r=d=>parseInt(Math.log(d)/hy,10),i=d=>parseInt(Array(d+1).join("1"),2);this.count=r(t+1),this.current_=this.count-1;const c=i(this.count);this.bits_=t+1&c}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const Ki=function(s,t,r,i){s.sort(t);const c=function(m,x){const w=x-m;let _,v;if(w===0)return null;if(w===1)return _=s[m],v=r?r(_):_,new kt(v,_.node,kt.BLACK,null,null);{const j=parseInt(w/2,10)+m,$=c(m,j),R=c(j+1,x);return _=s[j],v=r?r(_):_,new kt(v,_.node,kt.BLACK,$,R)}},d=function(m){let x=null,w=null,_=s.length;const v=function($,R){const q=_-$,de=_;_-=$;const fe=c(q+1,de),Se=s[q],J=r?r(Se):Se;j(new kt(J,Se.node,R,null,fe))},j=function($){x?(x.left=$,x=$):(w=$,x=$)};for(let $=0;$<m.count;++$){const R=m.nextBitIsOne(),q=Math.pow(2,m.count-($+1));R?v(q,kt.BLACK):(v(q,kt.BLACK),v(q,kt.RED))}return w},f=new fy(s.length),p=d(f);return new Yt(i||t,p)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vc;const ss={};class Rn{static get Default(){return oe(ss&&ut,"ChildrenNode.ts has not been loaded"),vc=vc||new Rn({".priority":ss},{".priority":ut}),vc}constructor(t,r){this.indexes_=t,this.indexSet_=r}get(t){const r=ds(this.indexes_,t);if(!r)throw new Error("No index defined for "+t);return r instanceof Yt?r:null}hasIndex(t){return $n(this.indexSet_,t.toString())}addIndex(t,r){oe(t!==cs,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let c=!1;const d=r.getIterator(Ue.Wrap);let f=d.getNext();for(;f;)c=c||t.isDefinedOn(f.node),i.push(f),f=d.getNext();let p;c?p=Ki(i,t.getCompare()):p=ss;const m=t.toString(),x={...this.indexSet_};x[m]=t;const w={...this.indexes_};return w[m]=p,new Rn(w,x)}addToIndexes(t,r){const i=Vi(this.indexes_,(c,d)=>{const f=ds(this.indexSet_,d);if(oe(f,"Missing index implementation for "+d),c===ss)if(f.isDefinedOn(t.node)){const p=[],m=r.getIterator(Ue.Wrap);let x=m.getNext();for(;x;)x.name!==t.name&&p.push(x),x=m.getNext();return p.push(t),Ki(p,f.getCompare())}else return ss;else{const p=r.get(t.name);let m=c;return p&&(m=m.remove(new Ue(t.name,p))),m.insert(t,t.node)}});return new Rn(i,this.indexSet_)}removeFromIndexes(t,r){const i=Vi(this.indexes_,c=>{if(c===ss)return c;{const d=r.get(t.name);return d?c.remove(new Ue(t.name,d)):c}});return new Rn(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let io;class Pe{static get EMPTY_NODE(){return io||(io=new Pe(new Yt(Zc),null,Rn.Default))}constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&mp(this.priorityNode_),this.children_.isEmpty()&&oe(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||io}updatePriority(t){return this.children_.isEmpty()?this:new Pe(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{const r=this.children_.get(t);return r===null?io:r}}getChild(t){const r=Be(t);return r===null?this:this.getImmediateChild(r).getChild(tt(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(oe(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{const i=new Ue(t,r);let c,d;r.isEmpty()?(c=this.children_.remove(t),d=this.indexMap_.removeFromIndexes(i,this.children_)):(c=this.children_.insert(t,r),d=this.indexMap_.addToIndexes(i,this.children_));const f=c.isEmpty()?io:this.priorityNode_;return new Pe(c,f,d)}}updateChild(t,r){const i=Be(t);if(i===null)return r;{oe(Be(t)!==".priority"||ar(t)===1,".priority must be the last token in a path");const c=this.getImmediateChild(i).updateChild(tt(t),r);return this.updateImmediateChild(i,c)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let i=0,c=0,d=!0;if(this.forEachChild(ut,(f,p)=>{r[f]=p.val(t),i++,d&&Pe.INTEGER_REGEXP_.test(f)?c=Math.max(c,Number(f)):d=!1}),!t&&d&&c<2*i){const f=[];for(const p in r)f[p]=r[p];return f}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+pp(this.getPriority().val())+":"),this.forEachChild(ut,(r,i)=>{const c=i.hash();c!==""&&(t+=":"+r+":"+c)}),this.lazyHash_=t===""?"":W0(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){const c=this.resolveIndex_(i);if(c){const d=c.getPredecessorKey(new Ue(t,r));return d?d.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new Ue(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new Ue(r,this.children_.get(r)):null}forEachChild(t,r){const i=this.resolveIndex_(t);return i?i.inorderTraversal(c=>r(c.name,c.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,c=>c);{const c=this.children_.getIteratorFrom(t.name,Ue.Wrap);let d=c.peek();for(;d!=null&&r.compare(d,t)<0;)c.getNext(),d=c.peek();return c}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,c=>c);{const c=this.children_.getReverseIteratorFrom(t.name,Ue.Wrap);let d=c.peek();for(;d!=null&&r.compare(d,t)>0;)c.getNext(),d=c.peek();return c}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Eo?-1:0}withIndex(t){if(t===cs||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new Pe(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===cs||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){const i=this.getIterator(ut),c=r.getIterator(ut);let d=i.getNext(),f=c.getNext();for(;d&&f;){if(d.name!==f.name||!d.node.equals(f.node))return!1;d=i.getNext(),f=c.getNext()}return d===null&&f===null}else return!1;else return!1}}resolveIndex_(t){return t===cs?null:this.indexMap_.get(t.toString())}}Pe.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class py extends Pe{constructor(){super(new Yt(Zc),Pe.EMPTY_NODE,Rn.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return Pe.EMPTY_NODE}isEmpty(){return!1}}const Eo=new py;Object.defineProperties(Ue,{MIN:{value:new Ue(hs,Pe.EMPTY_NODE)},MAX:{value:new Ue(Er,Eo)}});fp.__EMPTY_NODE=Pe.EMPTY_NODE;Nt.__childrenNodeConstructor=Pe;ay(Eo);uy(Eo);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const my=!0;function Et(s,t=null){if(s===null)return Pe.EMPTY_NODE;if(typeof s=="object"&&".priority"in s&&(t=s[".priority"]),oe(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof s=="object"&&".value"in s&&s[".value"]!==null&&(s=s[".value"]),typeof s!="object"||".sv"in s){const r=s;return new Nt(r,Et(t))}if(!(s instanceof Array)&&my){const r=[];let i=!1;if(Gt(s,(f,p)=>{if(f.substring(0,1)!=="."){const m=Et(p);m.isEmpty()||(i=i||!m.getPriority().isEmpty(),r.push(new Ue(f,m)))}}),r.length===0)return Pe.EMPTY_NODE;const d=Ki(r,ly,f=>f.name,Zc);if(i){const f=Ki(r,ut.getCompare());return new Pe(d,Et(t),new Rn({".priority":f},{".priority":ut}))}else return new Pe(d,Et(t),Rn.Default)}else{let r=Pe.EMPTY_NODE;return Gt(s,(i,c)=>{if($n(s,i)&&i.substring(0,1)!=="."){const d=Et(c);(d.isLeafNode()||!d.isEmpty())&&(r=r.updateImmediateChild(i,d))}}),r.updatePriority(Et(t))}}cy(Et);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy extends ul{constructor(t){super(),this.indexPath_=t,oe(!Ve(t)&&Be(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,r){const i=this.extractChild(t.node),c=this.extractChild(r.node),d=i.compareTo(c);return d===0?gs(t.name,r.name):d}makePost(t,r){const i=Et(t),c=Pe.EMPTY_NODE.updateChild(this.indexPath_,i);return new Ue(r,c)}maxPost(){const t=Pe.EMPTY_NODE.updateChild(this.indexPath_,Eo);return new Ue(Er,t)}toString(){return up(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy extends ul{compare(t,r){const i=t.node.compareTo(r.node);return i===0?gs(t.name,r.name):i}isDefinedOn(t){return!0}indexedValueChanged(t,r){return!t.equals(r)}minPost(){return Ue.MIN}maxPost(){return Ue.MAX}makePost(t,r){const i=Et(t);return new Ue(r,i)}toString(){return".value"}}const vy=new xy;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vp(s){return{type:"value",snapshotNode:s}}function fs(s,t){return{type:"child_added",snapshotNode:t,childName:s}}function yo(s,t){return{type:"child_removed",snapshotNode:t,childName:s}}function wo(s,t,r){return{type:"child_changed",snapshotNode:t,childName:s,oldSnap:r}}function yy(s,t){return{type:"child_moved",snapshotNode:t,childName:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(t){this.index_=t}updateChild(t,r,i,c,d,f){oe(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const p=t.getImmediateChild(r);return p.getChild(c).equals(i.getChild(c))&&p.isEmpty()===i.isEmpty()||(f!=null&&(i.isEmpty()?t.hasChild(r)?f.trackChildChange(yo(r,p)):oe(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):p.isEmpty()?f.trackChildChange(fs(r,i)):f.trackChildChange(wo(r,i,p))),t.isLeafNode()&&i.isEmpty())?t:t.updateImmediateChild(r,i).withIndex(this.index_)}updateFullNode(t,r,i){return i!=null&&(t.isLeafNode()||t.forEachChild(ut,(c,d)=>{r.hasChild(c)||i.trackChildChange(yo(c,d))}),r.isLeafNode()||r.forEachChild(ut,(c,d)=>{if(t.hasChild(c)){const f=t.getImmediateChild(c);f.equals(d)||i.trackChildChange(wo(c,d,f))}else i.trackChildChange(fs(c,d))})),r.withIndex(this.index_)}updatePriority(t,r){return t.isEmpty()?Pe.EMPTY_NODE:t.updatePriority(r)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(t){this.indexedFilter_=new eu(t.getIndex()),this.index_=t.getIndex(),this.startPost_=bo.getStartPost_(t),this.endPost_=bo.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const r=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,i=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return r&&i}updateChild(t,r,i,c,d,f){return this.matches(new Ue(r,i))||(i=Pe.EMPTY_NODE),this.indexedFilter_.updateChild(t,r,i,c,d,f)}updateFullNode(t,r,i){r.isLeafNode()&&(r=Pe.EMPTY_NODE);let c=r.withIndex(this.index_);c=c.updatePriority(Pe.EMPTY_NODE);const d=this;return r.forEachChild(ut,(f,p)=>{d.matches(new Ue(f,p))||(c=c.updateImmediateChild(f,Pe.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,c,i)}updatePriority(t,r){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const r=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),r)}else return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const r=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),r)}else return t.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(t){this.withinDirectionalStart=r=>this.reverse_?this.withinEndPost(r):this.withinStartPost(r),this.withinDirectionalEnd=r=>this.reverse_?this.withinStartPost(r):this.withinEndPost(r),this.withinStartPost=r=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),r);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=r=>{const i=this.index_.compare(r,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new bo(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,r,i,c,d,f){return this.rangedFilter_.matches(new Ue(r,i))||(i=Pe.EMPTY_NODE),t.getImmediateChild(r).equals(i)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,r,i,c,d,f):this.fullLimitUpdateChild_(t,r,i,d,f)}updateFullNode(t,r,i){let c;if(r.isLeafNode()||r.isEmpty())c=Pe.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<r.numChildren()&&r.isIndexed(this.index_)){c=Pe.EMPTY_NODE.withIndex(this.index_);let d;this.reverse_?d=r.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):d=r.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let f=0;for(;d.hasNext()&&f<this.limit_;){const p=d.getNext();if(this.withinDirectionalStart(p))if(this.withinDirectionalEnd(p))c=c.updateImmediateChild(p.name,p.node),f++;else break;else continue}}else{c=r.withIndex(this.index_),c=c.updatePriority(Pe.EMPTY_NODE);let d;this.reverse_?d=c.getReverseIterator(this.index_):d=c.getIterator(this.index_);let f=0;for(;d.hasNext();){const p=d.getNext();f<this.limit_&&this.withinDirectionalStart(p)&&this.withinDirectionalEnd(p)?f++:c=c.updateImmediateChild(p.name,Pe.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,c,i)}updatePriority(t,r){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,r,i,c,d){let f;if(this.reverse_){const _=this.index_.getCompare();f=(v,j)=>_(j,v)}else f=this.index_.getCompare();const p=t;oe(p.numChildren()===this.limit_,"");const m=new Ue(r,i),x=this.reverse_?p.getFirstChild(this.index_):p.getLastChild(this.index_),w=this.rangedFilter_.matches(m);if(p.hasChild(r)){const _=p.getImmediateChild(r);let v=c.getChildAfterChild(this.index_,x,this.reverse_);for(;v!=null&&(v.name===r||p.hasChild(v.name));)v=c.getChildAfterChild(this.index_,v,this.reverse_);const j=v==null?1:f(v,m);if(w&&!i.isEmpty()&&j>=0)return d!=null&&d.trackChildChange(wo(r,i,_)),p.updateImmediateChild(r,i);{d!=null&&d.trackChildChange(yo(r,_));const R=p.updateImmediateChild(r,Pe.EMPTY_NODE);return v!=null&&this.rangedFilter_.matches(v)?(d!=null&&d.trackChildChange(fs(v.name,v.node)),R.updateImmediateChild(v.name,v.node)):R}}else return i.isEmpty()?t:w&&f(x,m)>=0?(d!=null&&(d.trackChildChange(yo(x.name,x.node)),d.trackChildChange(fs(r,i))),p.updateImmediateChild(r,i).updateImmediateChild(x.name,Pe.EMPTY_NODE)):t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ut}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return oe(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return oe(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:hs}hasEnd(){return this.endSet_}getIndexEndValue(){return oe(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return oe(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Er}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return oe(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ut}copy(){const t=new tu;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function by(s){return s.loadsAllData()?new eu(s.getIndex()):s.hasLimit()?new wy(s):new bo(s)}function e0(s){const t={};if(s.isDefault())return t;let r;if(s.index_===ut?r="$priority":s.index_===vy?r="$value":s.index_===cs?r="$key":(oe(s.index_ instanceof gy,"Unrecognized index type!"),r=s.index_.toString()),t.orderBy=Ct(r),s.startSet_){const i=s.startAfterSet_?"startAfter":"startAt";t[i]=Ct(s.indexStartValue_),s.startNameSet_&&(t[i]+=","+Ct(s.indexStartName_))}if(s.endSet_){const i=s.endBeforeSet_?"endBefore":"endAt";t[i]=Ct(s.indexEndValue_),s.endNameSet_&&(t[i]+=","+Ct(s.indexEndName_))}return s.limitSet_&&(s.isViewFromLeft()?t.limitToFirst=s.limit_:t.limitToLast=s.limit_),t}function t0(s){const t={};if(s.startSet_&&(t.sp=s.indexStartValue_,s.startNameSet_&&(t.sn=s.indexStartName_),t.sin=!s.startAfterSet_),s.endSet_&&(t.ep=s.indexEndValue_,s.endNameSet_&&(t.en=s.indexEndName_),t.ein=!s.endBeforeSet_),s.limitSet_){t.l=s.limit_;let r=s.viewFrom_;r===""&&(s.isViewFromLeft()?r="l":r="r"),t.vf=r}return s.index_!==ut&&(t.i=s.index_.toString()),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji extends lp{reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,r){return r!==void 0?"tag$"+r:(oe(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}constructor(t,r,i,c){super(),this.repoInfo_=t,this.onDataUpdate_=r,this.authTokenProvider_=i,this.appCheckTokenProvider_=c,this.log_=So("p:rest:"),this.listens_={}}listen(t,r,i,c){const d=t._path.toString();this.log_("Listen called for "+d+" "+t._queryIdentifier);const f=Ji.getListenId_(t,i),p={};this.listens_[f]=p;const m=e0(t._queryParams);this.restRequest_(d+".json",m,(x,w)=>{let _=w;if(x===404&&(_=null,x=null),x===null&&this.onDataUpdate_(d,_,!1,i),ds(this.listens_,f)===p){let v;x?x===401?v="permission_denied":v="rest_error:"+x:v="ok",c(v,null)}})}unlisten(t,r){const i=Ji.getListenId_(t,r);delete this.listens_[i]}get(t){const r=e0(t._queryParams),i=t._path.toString(),c=new al;return this.restRequest_(i+".json",r,(d,f)=>{let p=f;d===404&&(p=null,d=null),d===null?(this.onDataUpdate_(i,p,!1,null),c.resolve(p)):c.reject(new Error(p))}),c.promise}refreshAuthToken(t){}restRequest_(t,r={},i){return r.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([c,d])=>{c&&c.accessToken&&(r.auth=c.accessToken),d&&d.token&&(r.ac=d.token);const f=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+Yx(r);this.log_("Sending REST request for "+f);const p=new XMLHttpRequest;p.onreadystatechange=()=>{if(i&&p.readyState===4){this.log_("REST Response for "+f+" received. status:",p.status,"response:",p.responseText);let m=null;if(p.status>=200&&p.status<300){try{m=mo(p.responseText)}catch{Qt("Failed to parse JSON response for "+f+": "+p.responseText)}i(null,m)}else p.status!==401&&p.status!==404&&Qt("Got unsuccessful REST response for "+f+" Status: "+p.status),i(p.status);i=null}},p.open("GET",f,!0),p.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(){this.rootNode_=Pe.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,r){this.rootNode_=this.rootNode_.updateChild(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zi(){return{value:null,children:new Map}}function yp(s,t,r){if(Ve(t))s.value=r,s.children.clear();else if(s.value!==null)s.value=s.value.updateChild(t,r);else{const i=Be(t);s.children.has(i)||s.children.set(i,Zi());const c=s.children.get(i);t=tt(t),yp(c,t,r)}}function Mc(s,t,r){s.value!==null?r(t,s.value):Ny(s,(i,c)=>{const d=new Je(t.toString()+"/"+i);Mc(c,d,r)})}function Ny(s,t){s.children.forEach((r,i)=>{t(i,r)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),r={...t};return this.last_&&Gt(this.last_,(i,c)=>{r[i]=r[i]-c}),this.last_=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n0=10*1e3,Cy=30*1e3,jy=300*1e3;class Sy{constructor(t,r){this.server_=r,this.statsToReport_={},this.statsListener_=new ky(t);const i=n0+(Cy-n0)*Math.random();uo(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const t=this.statsListener_.get(),r={};let i=!1;Gt(t,(c,d)=>{d>0&&$n(this.statsToReport_,c)&&(r[c]=d,i=!0)}),i&&this.server_.reportStats(r),uo(this.reportStats_.bind(this),Math.floor(Math.random()*2*jy))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vn;(function(s){s[s.OVERWRITE=0]="OVERWRITE",s[s.MERGE=1]="MERGE",s[s.ACK_USER_WRITE=2]="ACK_USER_WRITE",s[s.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(vn||(vn={}));function wp(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function nu(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function ru(s){return{fromUser:!1,fromServer:!0,queryId:s,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(t,r,i){this.path=t,this.affectedTree=r,this.revert=i,this.type=vn.ACK_USER_WRITE,this.source=wp()}operationForChild(t){if(Ve(this.path)){if(this.affectedTree.value!=null)return oe(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const r=this.affectedTree.subtree(new Je(t));return new el(Xe(),r,this.revert)}}else return oe(Be(this.path)===t,"operationForChild called for unrelated child."),new el(tt(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(t,r){this.source=t,this.path=r,this.type=vn.LISTEN_COMPLETE}operationForChild(t){return Ve(this.path)?new _o(this.source,Xe()):new _o(this.source,tt(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(t,r,i){this.source=t,this.path=r,this.snap=i,this.type=vn.OVERWRITE}operationForChild(t){return Ve(this.path)?new Ir(this.source,Xe(),this.snap.getImmediateChild(t)):new Ir(this.source,tt(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(t,r,i){this.source=t,this.path=r,this.children=i,this.type=vn.MERGE}operationForChild(t){if(Ve(this.path)){const r=this.children.subtree(new Je(t));return r.isEmpty()?null:r.value?new Ir(this.source,Xe(),r.value):new No(this.source,Xe(),r)}else return oe(Be(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new No(this.source,tt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(t,r,i){this.node_=t,this.fullyInitialized_=r,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(Ve(t))return this.isFullyInitialized()&&!this.filtered_;const r=Be(t);return this.isCompleteForChild(r)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function Iy(s,t,r,i){const c=[],d=[];return t.forEach(f=>{f.type==="child_changed"&&s.index_.indexedValueChanged(f.oldSnap,f.snapshotNode)&&d.push(yy(f.childName,f.snapshotNode))}),lo(s,c,"child_removed",t,i,r),lo(s,c,"child_added",t,i,r),lo(s,c,"child_moved",d,i,r),lo(s,c,"child_changed",t,i,r),lo(s,c,"value",t,i,r),c}function lo(s,t,r,i,c,d){const f=i.filter(p=>p.type===r);f.sort((p,m)=>Ly(s,p,m)),f.forEach(p=>{const m=Ty(s,p,d);c.forEach(x=>{x.respondsTo(p.type)&&t.push(x.createEvent(m,s.query_))})})}function Ty(s,t,r){return t.type==="value"||t.type==="child_removed"||(t.prevName=r.getPredecessorChildName(t.childName,t.snapshotNode,s.index_)),t}function Ly(s,t,r){if(t.childName==null||r.childName==null)throw ms("Should only compare child_ events.");const i=new Ue(t.childName,t.snapshotNode),c=new Ue(r.childName,r.snapshotNode);return s.index_.compare(i,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dl(s,t){return{eventCache:s,serverCache:t}}function ho(s,t,r,i){return dl(new Tr(t,r,i),s.serverCache)}function bp(s,t,r,i){return dl(s.eventCache,new Tr(t,r,i))}function Rc(s){return s.eventCache.isFullyInitialized()?s.eventCache.getNode():null}function Lr(s){return s.serverCache.isFullyInitialized()?s.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yc;const My=()=>(yc||(yc=new Yt(x1)),yc);class st{static fromObject(t){let r=new st(null);return Gt(t,(i,c)=>{r=r.set(new Je(i),c)}),r}constructor(t,r=My()){this.value=t,this.children=r}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,r){if(this.value!=null&&r(this.value))return{path:Xe(),value:this.value};if(Ve(t))return null;{const i=Be(t),c=this.children.get(i);if(c!==null){const d=c.findRootMostMatchingPathAndValue(tt(t),r);return d!=null?{path:yt(new Je(i),d.path),value:d.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(Ve(t))return this;{const r=Be(t),i=this.children.get(r);return i!==null?i.subtree(tt(t)):new st(null)}}set(t,r){if(Ve(t))return new st(r,this.children);{const i=Be(t),d=(this.children.get(i)||new st(null)).set(tt(t),r),f=this.children.insert(i,d);return new st(this.value,f)}}remove(t){if(Ve(t))return this.children.isEmpty()?new st(null):new st(null,this.children);{const r=Be(t),i=this.children.get(r);if(i){const c=i.remove(tt(t));let d;return c.isEmpty()?d=this.children.remove(r):d=this.children.insert(r,c),this.value===null&&d.isEmpty()?new st(null):new st(this.value,d)}else return this}}get(t){if(Ve(t))return this.value;{const r=Be(t),i=this.children.get(r);return i?i.get(tt(t)):null}}setTree(t,r){if(Ve(t))return r;{const i=Be(t),d=(this.children.get(i)||new st(null)).setTree(tt(t),r);let f;return d.isEmpty()?f=this.children.remove(i):f=this.children.insert(i,d),new st(this.value,f)}}fold(t){return this.fold_(Xe(),t)}fold_(t,r){const i={};return this.children.inorderTraversal((c,d)=>{i[c]=d.fold_(yt(t,c),r)}),r(t,this.value,i)}findOnPath(t,r){return this.findOnPath_(t,Xe(),r)}findOnPath_(t,r,i){const c=this.value?i(r,this.value):!1;if(c)return c;if(Ve(t))return null;{const d=Be(t),f=this.children.get(d);return f?f.findOnPath_(tt(t),yt(r,d),i):null}}foreachOnPath(t,r){return this.foreachOnPath_(t,Xe(),r)}foreachOnPath_(t,r,i){if(Ve(t))return this;{this.value&&i(r,this.value);const c=Be(t),d=this.children.get(c);return d?d.foreachOnPath_(tt(t),yt(r,c),i):new st(null)}}foreach(t){this.foreach_(Xe(),t)}foreach_(t,r){this.children.inorderTraversal((i,c)=>{c.foreach_(yt(t,i),r)}),this.value&&r(t,this.value)}foreachChild(t){this.children.inorderTraversal((r,i)=>{i.value&&t(r,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(t){this.writeTree_=t}static empty(){return new yn(new st(null))}}function fo(s,t,r){if(Ve(t))return new yn(new st(r));{const i=s.writeTree_.findRootMostValueAndPath(t);if(i!=null){const c=i.path;let d=i.value;const f=Vt(c,t);return d=d.updateChild(f,r),new yn(s.writeTree_.set(c,d))}else{const c=new st(r),d=s.writeTree_.setTree(t,c);return new yn(d)}}}function r0(s,t,r){let i=s;return Gt(r,(c,d)=>{i=fo(i,yt(t,c),d)}),i}function s0(s,t){if(Ve(t))return yn.empty();{const r=s.writeTree_.setTree(t,new st(null));return new yn(r)}}function Pc(s,t){return Mr(s,t)!=null}function Mr(s,t){const r=s.writeTree_.findRootMostValueAndPath(t);return r!=null?s.writeTree_.get(r.path).getChild(Vt(r.path,t)):null}function o0(s){const t=[],r=s.writeTree_.value;return r!=null?r.isLeafNode()||r.forEachChild(ut,(i,c)=>{t.push(new Ue(i,c))}):s.writeTree_.children.inorderTraversal((i,c)=>{c.value!=null&&t.push(new Ue(i,c.value))}),t}function lr(s,t){if(Ve(t))return s;{const r=Mr(s,t);return r!=null?new yn(new st(r)):new yn(s.writeTree_.subtree(t))}}function Dc(s){return s.writeTree_.isEmpty()}function ps(s,t){return _p(Xe(),s.writeTree_,t)}function _p(s,t,r){if(t.value!=null)return r.updateChild(s,t.value);{let i=null;return t.children.inorderTraversal((c,d)=>{c===".priority"?(oe(d.value!==null,"Priority writes must always be leaf nodes"),i=d.value):r=_p(yt(s,c),d,r)}),!r.getChild(s).isEmpty()&&i!==null&&(r=r.updateChild(yt(s,".priority"),i)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function su(s,t){return jp(t,s)}function Ry(s,t,r,i,c){oe(i>s.lastWriteId,"Stacking an older write on top of newer ones"),c===void 0&&(c=!0),s.allWrites.push({path:t,snap:r,writeId:i,visible:c}),c&&(s.visibleWrites=fo(s.visibleWrites,t,r)),s.lastWriteId=i}function Py(s,t){for(let r=0;r<s.allWrites.length;r++){const i=s.allWrites[r];if(i.writeId===t)return i}return null}function Dy(s,t){const r=s.allWrites.findIndex(p=>p.writeId===t);oe(r>=0,"removeWrite called with nonexistent writeId.");const i=s.allWrites[r];s.allWrites.splice(r,1);let c=i.visible,d=!1,f=s.allWrites.length-1;for(;c&&f>=0;){const p=s.allWrites[f];p.visible&&(f>=r&&Oy(p,i.path)?c=!1:xn(i.path,p.path)&&(d=!0)),f--}if(c){if(d)return Ay(s),!0;if(i.snap)s.visibleWrites=s0(s.visibleWrites,i.path);else{const p=i.children;Gt(p,m=>{s.visibleWrites=s0(s.visibleWrites,yt(i.path,m))})}return!0}else return!1}function Oy(s,t){if(s.snap)return xn(s.path,t);for(const r in s.children)if(s.children.hasOwnProperty(r)&&xn(yt(s.path,r),t))return!0;return!1}function Ay(s){s.visibleWrites=Np(s.allWrites,$y,Xe()),s.allWrites.length>0?s.lastWriteId=s.allWrites[s.allWrites.length-1].writeId:s.lastWriteId=-1}function $y(s){return s.visible}function Np(s,t,r){let i=yn.empty();for(let c=0;c<s.length;++c){const d=s[c];if(t(d)){const f=d.path;let p;if(d.snap)xn(r,f)?(p=Vt(r,f),i=fo(i,p,d.snap)):xn(f,r)&&(p=Vt(f,r),i=fo(i,Xe(),d.snap.getChild(p)));else if(d.children){if(xn(r,f))p=Vt(r,f),i=r0(i,p,d.children);else if(xn(f,r))if(p=Vt(f,r),Ve(p))i=r0(i,Xe(),d.children);else{const m=ds(d.children,Be(p));if(m){const x=m.getChild(tt(p));i=fo(i,Xe(),x)}}}else throw ms("WriteRecord should have .snap or .children")}}return i}function kp(s,t,r,i,c){if(!i&&!c){const d=Mr(s.visibleWrites,t);if(d!=null)return d;{const f=lr(s.visibleWrites,t);if(Dc(f))return r;if(r==null&&!Pc(f,Xe()))return null;{const p=r||Pe.EMPTY_NODE;return ps(f,p)}}}else{const d=lr(s.visibleWrites,t);if(!c&&Dc(d))return r;if(!c&&r==null&&!Pc(d,Xe()))return null;{const f=function(x){return(x.visible||c)&&(!i||!~i.indexOf(x.writeId))&&(xn(x.path,t)||xn(t,x.path))},p=Np(s.allWrites,f,t),m=r||Pe.EMPTY_NODE;return ps(p,m)}}}function Fy(s,t,r){let i=Pe.EMPTY_NODE;const c=Mr(s.visibleWrites,t);if(c)return c.isLeafNode()||c.forEachChild(ut,(d,f)=>{i=i.updateImmediateChild(d,f)}),i;if(r){const d=lr(s.visibleWrites,t);return r.forEachChild(ut,(f,p)=>{const m=ps(lr(d,new Je(f)),p);i=i.updateImmediateChild(f,m)}),o0(d).forEach(f=>{i=i.updateImmediateChild(f.name,f.node)}),i}else{const d=lr(s.visibleWrites,t);return o0(d).forEach(f=>{i=i.updateImmediateChild(f.name,f.node)}),i}}function zy(s,t,r,i,c){oe(i||c,"Either existingEventSnap or existingServerSnap must exist");const d=yt(t,r);if(Pc(s.visibleWrites,d))return null;{const f=lr(s.visibleWrites,d);return Dc(f)?c.getChild(r):ps(f,c.getChild(r))}}function Wy(s,t,r,i){const c=yt(t,r),d=Mr(s.visibleWrites,c);if(d!=null)return d;if(i.isCompleteForChild(r)){const f=lr(s.visibleWrites,c);return ps(f,i.getNode().getImmediateChild(r))}else return null}function By(s,t){return Mr(s.visibleWrites,t)}function Uy(s,t,r,i,c,d,f){let p;const m=lr(s.visibleWrites,t),x=Mr(m,Xe());if(x!=null)p=x;else if(r!=null)p=ps(m,r);else return[];if(p=p.withIndex(f),!p.isEmpty()&&!p.isLeafNode()){const w=[],_=f.getCompare(),v=d?p.getReverseIteratorFrom(i,f):p.getIteratorFrom(i,f);let j=v.getNext();for(;j&&w.length<c;)_(j,i)!==0&&w.push(j),j=v.getNext();return w}else return[]}function Hy(){return{visibleWrites:yn.empty(),allWrites:[],lastWriteId:-1}}function tl(s,t,r,i){return kp(s.writeTree,s.treePath,t,r,i)}function ou(s,t){return Fy(s.writeTree,s.treePath,t)}function i0(s,t,r,i){return zy(s.writeTree,s.treePath,t,r,i)}function nl(s,t){return By(s.writeTree,yt(s.treePath,t))}function Vy(s,t,r,i,c,d){return Uy(s.writeTree,s.treePath,t,r,i,c,d)}function iu(s,t,r){return Wy(s.writeTree,s.treePath,t,r)}function Cp(s,t){return jp(yt(s.treePath,t),s.writeTree)}function jp(s,t){return{treePath:s,writeTree:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(){this.changeMap=new Map}trackChildChange(t){const r=t.type,i=t.childName;oe(r==="child_added"||r==="child_changed"||r==="child_removed","Only child changes supported for tracking"),oe(i!==".priority","Only non-priority child changes can be tracked.");const c=this.changeMap.get(i);if(c){const d=c.type;if(r==="child_added"&&d==="child_removed")this.changeMap.set(i,wo(i,t.snapshotNode,c.snapshotNode));else if(r==="child_removed"&&d==="child_added")this.changeMap.delete(i);else if(r==="child_removed"&&d==="child_changed")this.changeMap.set(i,yo(i,c.oldSnap));else if(r==="child_changed"&&d==="child_added")this.changeMap.set(i,fs(i,t.snapshotNode));else if(r==="child_changed"&&d==="child_changed")this.changeMap.set(i,wo(i,t.snapshotNode,c.oldSnap));else throw ms("Illegal combination of changes: "+t+" occurred after "+c)}else this.changeMap.set(i,t)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{getCompleteChild(t){return null}getChildAfterChild(t,r,i){return null}}const Sp=new Qy;class lu{constructor(t,r,i=null){this.writes_=t,this.viewCache_=r,this.optCompleteServerCache_=i}getCompleteChild(t){const r=this.viewCache_.eventCache;if(r.isCompleteForChild(t))return r.getNode().getImmediateChild(t);{const i=this.optCompleteServerCache_!=null?new Tr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return iu(this.writes_,t,i)}}getChildAfterChild(t,r,i){const c=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Lr(this.viewCache_),d=Vy(this.writes_,c,r,1,i,t);return d.length===0?null:d[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gy(s){return{filter:s}}function qy(s,t){oe(t.eventCache.getNode().isIndexed(s.filter.getIndex()),"Event snap not indexed"),oe(t.serverCache.getNode().isIndexed(s.filter.getIndex()),"Server snap not indexed")}function Xy(s,t,r,i,c){const d=new Yy;let f,p;if(r.type===vn.OVERWRITE){const x=r;x.source.fromUser?f=Oc(s,t,x.path,x.snap,i,c,d):(oe(x.source.fromServer,"Unknown source."),p=x.source.tagged||t.serverCache.isFiltered()&&!Ve(x.path),f=rl(s,t,x.path,x.snap,i,c,p,d))}else if(r.type===vn.MERGE){const x=r;x.source.fromUser?f=Jy(s,t,x.path,x.children,i,c,d):(oe(x.source.fromServer,"Unknown source."),p=x.source.tagged||t.serverCache.isFiltered(),f=Ac(s,t,x.path,x.children,i,c,p,d))}else if(r.type===vn.ACK_USER_WRITE){const x=r;x.revert?f=tw(s,t,x.path,i,c,d):f=Zy(s,t,x.path,x.affectedTree,i,c,d)}else if(r.type===vn.LISTEN_COMPLETE)f=ew(s,t,r.path,i,d);else throw ms("Unknown operation type: "+r.type);const m=d.getChanges();return Ky(t,f,m),{viewCache:f,changes:m}}function Ky(s,t,r){const i=t.eventCache;if(i.isFullyInitialized()){const c=i.getNode().isLeafNode()||i.getNode().isEmpty(),d=Rc(s);(r.length>0||!s.eventCache.isFullyInitialized()||c&&!i.getNode().equals(d)||!i.getNode().getPriority().equals(d.getPriority()))&&r.push(vp(Rc(t)))}}function Ep(s,t,r,i,c,d){const f=t.eventCache;if(nl(i,r)!=null)return t;{let p,m;if(Ve(r))if(oe(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const x=Lr(t),w=x instanceof Pe?x:Pe.EMPTY_NODE,_=ou(i,w);p=s.filter.updateFullNode(t.eventCache.getNode(),_,d)}else{const x=tl(i,Lr(t));p=s.filter.updateFullNode(t.eventCache.getNode(),x,d)}else{const x=Be(r);if(x===".priority"){oe(ar(r)===1,"Can't have a priority with additional path components");const w=f.getNode();m=t.serverCache.getNode();const _=i0(i,r,w,m);_!=null?p=s.filter.updatePriority(w,_):p=f.getNode()}else{const w=tt(r);let _;if(f.isCompleteForChild(x)){m=t.serverCache.getNode();const v=i0(i,r,f.getNode(),m);v!=null?_=f.getNode().getImmediateChild(x).updateChild(w,v):_=f.getNode().getImmediateChild(x)}else _=iu(i,x,t.serverCache);_!=null?p=s.filter.updateChild(f.getNode(),x,_,w,c,d):p=f.getNode()}}return ho(t,p,f.isFullyInitialized()||Ve(r),s.filter.filtersNodes())}}function rl(s,t,r,i,c,d,f,p){const m=t.serverCache;let x;const w=f?s.filter:s.filter.getIndexedFilter();if(Ve(r))x=w.updateFullNode(m.getNode(),i,null);else if(w.filtersNodes()&&!m.isFiltered()){const j=m.getNode().updateChild(r,i);x=w.updateFullNode(m.getNode(),j,null)}else{const j=Be(r);if(!m.isCompleteForPath(r)&&ar(r)>1)return t;const $=tt(r),q=m.getNode().getImmediateChild(j).updateChild($,i);j===".priority"?x=w.updatePriority(m.getNode(),q):x=w.updateChild(m.getNode(),j,q,$,Sp,null)}const _=bp(t,x,m.isFullyInitialized()||Ve(r),w.filtersNodes()),v=new lu(c,_,d);return Ep(s,_,r,c,v,p)}function Oc(s,t,r,i,c,d,f){const p=t.eventCache;let m,x;const w=new lu(c,t,d);if(Ve(r))x=s.filter.updateFullNode(t.eventCache.getNode(),i,f),m=ho(t,x,!0,s.filter.filtersNodes());else{const _=Be(r);if(_===".priority")x=s.filter.updatePriority(t.eventCache.getNode(),i),m=ho(t,x,p.isFullyInitialized(),p.isFiltered());else{const v=tt(r),j=p.getNode().getImmediateChild(_);let $;if(Ve(v))$=i;else{const R=w.getCompleteChild(_);R!=null?cp(v)===".priority"&&R.getChild(dp(v)).isEmpty()?$=R:$=R.updateChild(v,i):$=Pe.EMPTY_NODE}if(j.equals($))m=t;else{const R=s.filter.updateChild(p.getNode(),_,$,v,w,f);m=ho(t,R,p.isFullyInitialized(),s.filter.filtersNodes())}}}return m}function l0(s,t){return s.eventCache.isCompleteForChild(t)}function Jy(s,t,r,i,c,d,f){let p=t;return i.foreach((m,x)=>{const w=yt(r,m);l0(t,Be(w))&&(p=Oc(s,p,w,x,c,d,f))}),i.foreach((m,x)=>{const w=yt(r,m);l0(t,Be(w))||(p=Oc(s,p,w,x,c,d,f))}),p}function a0(s,t,r){return r.foreach((i,c)=>{t=t.updateChild(i,c)}),t}function Ac(s,t,r,i,c,d,f,p){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let m=t,x;Ve(r)?x=i:x=new st(null).setTree(r,i);const w=t.serverCache.getNode();return x.children.inorderTraversal((_,v)=>{if(w.hasChild(_)){const j=t.serverCache.getNode().getImmediateChild(_),$=a0(s,j,v);m=rl(s,m,new Je(_),$,c,d,f,p)}}),x.children.inorderTraversal((_,v)=>{const j=!t.serverCache.isCompleteForChild(_)&&v.value===null;if(!w.hasChild(_)&&!j){const $=t.serverCache.getNode().getImmediateChild(_),R=a0(s,$,v);m=rl(s,m,new Je(_),R,c,d,f,p)}}),m}function Zy(s,t,r,i,c,d,f){if(nl(c,r)!=null)return t;const p=t.serverCache.isFiltered(),m=t.serverCache;if(i.value!=null){if(Ve(r)&&m.isFullyInitialized()||m.isCompleteForPath(r))return rl(s,t,r,m.getNode().getChild(r),c,d,p,f);if(Ve(r)){let x=new st(null);return m.getNode().forEachChild(cs,(w,_)=>{x=x.set(new Je(w),_)}),Ac(s,t,r,x,c,d,p,f)}else return t}else{let x=new st(null);return i.foreach((w,_)=>{const v=yt(r,w);m.isCompleteForPath(v)&&(x=x.set(w,m.getNode().getChild(v)))}),Ac(s,t,r,x,c,d,p,f)}}function ew(s,t,r,i,c){const d=t.serverCache,f=bp(t,d.getNode(),d.isFullyInitialized()||Ve(r),d.isFiltered());return Ep(s,f,r,i,Sp,c)}function tw(s,t,r,i,c,d){let f;if(nl(i,r)!=null)return t;{const p=new lu(i,t,c),m=t.eventCache.getNode();let x;if(Ve(r)||Be(r)===".priority"){let w;if(t.serverCache.isFullyInitialized())w=tl(i,Lr(t));else{const _=t.serverCache.getNode();oe(_ instanceof Pe,"serverChildren would be complete if leaf node"),w=ou(i,_)}w=w,x=s.filter.updateFullNode(m,w,d)}else{const w=Be(r);let _=iu(i,w,t.serverCache);_==null&&t.serverCache.isCompleteForChild(w)&&(_=m.getImmediateChild(w)),_!=null?x=s.filter.updateChild(m,w,_,tt(r),p,d):t.eventCache.getNode().hasChild(w)?x=s.filter.updateChild(m,w,Pe.EMPTY_NODE,tt(r),p,d):x=m,x.isEmpty()&&t.serverCache.isFullyInitialized()&&(f=tl(i,Lr(t)),f.isLeafNode()&&(x=s.filter.updateFullNode(x,f,d)))}return f=t.serverCache.isFullyInitialized()||nl(i,Xe())!=null,ho(t,x,f,s.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(t,r){this.query_=t,this.eventRegistrations_=[];const i=this.query_._queryParams,c=new eu(i.getIndex()),d=by(i);this.processor_=Gy(d);const f=r.serverCache,p=r.eventCache,m=c.updateFullNode(Pe.EMPTY_NODE,f.getNode(),null),x=d.updateFullNode(Pe.EMPTY_NODE,p.getNode(),null),w=new Tr(m,f.isFullyInitialized(),c.filtersNodes()),_=new Tr(x,p.isFullyInitialized(),d.filtersNodes());this.viewCache_=dl(_,w),this.eventGenerator_=new Ey(this.query_)}get query(){return this.query_}}function rw(s){return s.viewCache_.serverCache.getNode()}function sw(s,t){const r=Lr(s.viewCache_);return r&&(s.query._queryParams.loadsAllData()||!Ve(t)&&!r.getImmediateChild(Be(t)).isEmpty())?r.getChild(t):null}function c0(s){return s.eventRegistrations_.length===0}function ow(s,t){s.eventRegistrations_.push(t)}function u0(s,t,r){const i=[];if(r){oe(t==null,"A cancel should cancel all event registrations.");const c=s.query._path;s.eventRegistrations_.forEach(d=>{const f=d.createCancelEvent(r,c);f&&i.push(f)})}if(t){let c=[];for(let d=0;d<s.eventRegistrations_.length;++d){const f=s.eventRegistrations_[d];if(!f.matches(t))c.push(f);else if(t.hasAnyCallback()){c=c.concat(s.eventRegistrations_.slice(d+1));break}}s.eventRegistrations_=c}else s.eventRegistrations_=[];return i}function d0(s,t,r,i){t.type===vn.MERGE&&t.source.queryId!==null&&(oe(Lr(s.viewCache_),"We should always have a full cache before handling merges"),oe(Rc(s.viewCache_),"Missing event cache, even though we have a server cache"));const c=s.viewCache_,d=Xy(s.processor_,c,t,r,i);return qy(s.processor_,d.viewCache),oe(d.viewCache.serverCache.isFullyInitialized()||!c.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),s.viewCache_=d.viewCache,Ip(s,d.changes,d.viewCache.eventCache.getNode(),null)}function iw(s,t){const r=s.viewCache_.eventCache,i=[];return r.getNode().isLeafNode()||r.getNode().forEachChild(ut,(d,f)=>{i.push(fs(d,f))}),r.isFullyInitialized()&&i.push(vp(r.getNode())),Ip(s,i,r.getNode(),t)}function Ip(s,t,r,i){const c=i?[i]:s.eventRegistrations_;return Iy(s.eventGenerator_,t,r,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sl;class lw{constructor(){this.views=new Map}}function aw(s){oe(!sl,"__referenceConstructor has already been defined"),sl=s}function cw(){return oe(sl,"Reference.ts has not been loaded"),sl}function uw(s){return s.views.size===0}function au(s,t,r,i){const c=t.source.queryId;if(c!==null){const d=s.views.get(c);return oe(d!=null,"SyncTree gave us an op for an invalid query."),d0(d,t,r,i)}else{let d=[];for(const f of s.views.values())d=d.concat(d0(f,t,r,i));return d}}function dw(s,t,r,i,c){const d=t._queryIdentifier,f=s.views.get(d);if(!f){let p=tl(r,c?i:null),m=!1;p?m=!0:i instanceof Pe?(p=ou(r,i),m=!1):(p=Pe.EMPTY_NODE,m=!1);const x=dl(new Tr(p,m,!1),new Tr(i,c,!1));return new nw(t,x)}return f}function hw(s,t,r,i,c,d){const f=dw(s,t,i,c,d);return s.views.has(t._queryIdentifier)||s.views.set(t._queryIdentifier,f),ow(f,r),iw(f,r)}function fw(s,t,r,i){const c=t._queryIdentifier,d=[];let f=[];const p=cr(s);if(c==="default")for(const[m,x]of s.views.entries())f=f.concat(u0(x,r,i)),c0(x)&&(s.views.delete(m),x.query._queryParams.loadsAllData()||d.push(x.query));else{const m=s.views.get(c);m&&(f=f.concat(u0(m,r,i)),c0(m)&&(s.views.delete(c),m.query._queryParams.loadsAllData()||d.push(m.query)))}return p&&!cr(s)&&d.push(new(cw())(t._repo,t._path)),{removed:d,events:f}}function Tp(s){const t=[];for(const r of s.views.values())r.query._queryParams.loadsAllData()||t.push(r);return t}function us(s,t){let r=null;for(const i of s.views.values())r=r||sw(i,t);return r}function Lp(s,t){if(t._queryParams.loadsAllData())return hl(s);{const i=t._queryIdentifier;return s.views.get(i)}}function Mp(s,t){return Lp(s,t)!=null}function cr(s){return hl(s)!=null}function hl(s){for(const t of s.views.values())if(t.query._queryParams.loadsAllData())return t;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ol;function pw(s){oe(!ol,"__referenceConstructor has already been defined"),ol=s}function mw(){return oe(ol,"Reference.ts has not been loaded"),ol}let gw=1;class h0{constructor(t){this.listenProvider_=t,this.syncPointTree_=new st(null),this.pendingWriteTree_=Hy(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Rp(s,t,r,i,c){return Ry(s.pendingWriteTree_,t,r,i,c),c?Io(s,new Ir(wp(),t,r)):[]}function Sr(s,t,r=!1){const i=Py(s.pendingWriteTree_,t);if(Dy(s.pendingWriteTree_,t)){let d=new st(null);return i.snap!=null?d=d.set(Xe(),!0):Gt(i.children,f=>{d=d.set(new Je(f),!0)}),Io(s,new el(i.path,d,r))}else return[]}function fl(s,t,r){return Io(s,new Ir(nu(),t,r))}function xw(s,t,r){const i=st.fromObject(r);return Io(s,new No(nu(),t,i))}function vw(s,t){return Io(s,new _o(nu(),t))}function yw(s,t,r){const i=uu(s,r);if(i){const c=du(i),d=c.path,f=c.queryId,p=Vt(d,t),m=new _o(ru(f),p);return hu(s,d,m)}else return[]}function $c(s,t,r,i,c=!1){const d=t._path,f=s.syncPointTree_.get(d);let p=[];if(f&&(t._queryIdentifier==="default"||Mp(f,t))){const m=fw(f,t,r,i);uw(f)&&(s.syncPointTree_=s.syncPointTree_.remove(d));const x=m.removed;if(p=m.events,!c){const w=x.findIndex(v=>v._queryParams.loadsAllData())!==-1,_=s.syncPointTree_.findOnPath(d,(v,j)=>cr(j));if(w&&!_){const v=s.syncPointTree_.subtree(d);if(!v.isEmpty()){const j=_w(v);for(let $=0;$<j.length;++$){const R=j[$],q=R.query,de=Op(s,R);s.listenProvider_.startListening(po(q),il(s,q),de.hashFn,de.onComplete)}}}!_&&x.length>0&&!i&&(w?s.listenProvider_.stopListening(po(t),null):x.forEach(v=>{const j=s.queryToTagMap.get(pl(v));s.listenProvider_.stopListening(po(v),j)}))}Nw(s,x)}return p}function ww(s,t,r,i){const c=uu(s,i);if(c!=null){const d=du(c),f=d.path,p=d.queryId,m=Vt(f,t),x=new Ir(ru(p),m,r);return hu(s,f,x)}else return[]}function bw(s,t,r,i){const c=uu(s,i);if(c){const d=du(c),f=d.path,p=d.queryId,m=Vt(f,t),x=st.fromObject(r),w=new No(ru(p),m,x);return hu(s,f,w)}else return[]}function f0(s,t,r,i=!1){const c=t._path;let d=null,f=!1;s.syncPointTree_.foreachOnPath(c,(v,j)=>{const $=Vt(v,c);d=d||us(j,$),f=f||cr(j)});let p=s.syncPointTree_.get(c);p?(f=f||cr(p),d=d||us(p,Xe())):(p=new lw,s.syncPointTree_=s.syncPointTree_.set(c,p));let m;d!=null?m=!0:(m=!1,d=Pe.EMPTY_NODE,s.syncPointTree_.subtree(c).foreachChild((j,$)=>{const R=us($,Xe());R&&(d=d.updateImmediateChild(j,R))}));const x=Mp(p,t);if(!x&&!t._queryParams.loadsAllData()){const v=pl(t);oe(!s.queryToTagMap.has(v),"View does not exist, but we have a tag");const j=kw();s.queryToTagMap.set(v,j),s.tagToQueryMap.set(j,v)}const w=su(s.pendingWriteTree_,c);let _=hw(p,t,r,w,d,m);if(!x&&!f&&!i){const v=Lp(p,t);_=_.concat(Cw(s,t,v))}return _}function cu(s,t,r){const c=s.pendingWriteTree_,d=s.syncPointTree_.findOnPath(t,(f,p)=>{const m=Vt(f,t),x=us(p,m);if(x)return x});return kp(c,t,d,r,!0)}function Io(s,t){return Pp(t,s.syncPointTree_,null,su(s.pendingWriteTree_,Xe()))}function Pp(s,t,r,i){if(Ve(s.path))return Dp(s,t,r,i);{const c=t.get(Xe());r==null&&c!=null&&(r=us(c,Xe()));let d=[];const f=Be(s.path),p=s.operationForChild(f),m=t.children.get(f);if(m&&p){const x=r?r.getImmediateChild(f):null,w=Cp(i,f);d=d.concat(Pp(p,m,x,w))}return c&&(d=d.concat(au(c,s,i,r))),d}}function Dp(s,t,r,i){const c=t.get(Xe());r==null&&c!=null&&(r=us(c,Xe()));let d=[];return t.children.inorderTraversal((f,p)=>{const m=r?r.getImmediateChild(f):null,x=Cp(i,f),w=s.operationForChild(f);w&&(d=d.concat(Dp(w,p,m,x)))}),c&&(d=d.concat(au(c,s,i,r))),d}function Op(s,t){const r=t.query,i=il(s,r);return{hashFn:()=>(rw(t)||Pe.EMPTY_NODE).hash(),onComplete:c=>{if(c==="ok")return i?yw(s,r._path,i):vw(s,r._path);{const d=w1(c,r);return $c(s,r,null,d)}}}}function il(s,t){const r=pl(t);return s.queryToTagMap.get(r)}function pl(s){return s._path.toString()+"$"+s._queryIdentifier}function uu(s,t){return s.tagToQueryMap.get(t)}function du(s){const t=s.indexOf("$");return oe(t!==-1&&t<s.length-1,"Bad queryKey."),{queryId:s.substr(t+1),path:new Je(s.substr(0,t))}}function hu(s,t,r){const i=s.syncPointTree_.get(t);oe(i,"Missing sync point for query tag that we're tracking");const c=su(s.pendingWriteTree_,t);return au(i,r,c,null)}function _w(s){return s.fold((t,r,i)=>{if(r&&cr(r))return[hl(r)];{let c=[];return r&&(c=Tp(r)),Gt(i,(d,f)=>{c=c.concat(f)}),c}})}function po(s){return s._queryParams.loadsAllData()&&!s._queryParams.isDefault()?new(mw())(s._repo,s._path):s}function Nw(s,t){for(let r=0;r<t.length;++r){const i=t[r];if(!i._queryParams.loadsAllData()){const c=pl(i),d=s.queryToTagMap.get(c);s.queryToTagMap.delete(c),s.tagToQueryMap.delete(d)}}}function kw(){return gw++}function Cw(s,t,r){const i=t._path,c=il(s,t),d=Op(s,r),f=s.listenProvider_.startListening(po(t),c,d.hashFn,d.onComplete),p=s.syncPointTree_.subtree(i);if(c)oe(!cr(p.value),"If we're adding a query, it shouldn't be shadowed");else{const m=p.fold((x,w,_)=>{if(!Ve(x)&&w&&cr(w))return[hl(w).query];{let v=[];return w&&(v=v.concat(Tp(w).map(j=>j.query))),Gt(_,(j,$)=>{v=v.concat($)}),v}});for(let x=0;x<m.length;++x){const w=m[x];s.listenProvider_.stopListening(po(w),il(s,w))}}return f}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(t){this.node_=t}getImmediateChild(t){const r=this.node_.getImmediateChild(t);return new fu(r)}node(){return this.node_}}class pu{constructor(t,r){this.syncTree_=t,this.path_=r}getImmediateChild(t){const r=yt(this.path_,t);return new pu(this.syncTree_,r)}node(){return cu(this.syncTree_,this.path_)}}const jw=function(s){return s=s||{},s.timestamp=s.timestamp||new Date().getTime(),s},p0=function(s,t,r){if(!s||typeof s!="object")return s;if(oe(".sv"in s,"Unexpected leaf node or priority contents"),typeof s[".sv"]=="string")return Sw(s[".sv"],t,r);if(typeof s[".sv"]=="object")return Ew(s[".sv"],t);oe(!1,"Unexpected server value: "+JSON.stringify(s,null,2))},Sw=function(s,t,r){switch(s){case"timestamp":return r.timestamp;default:oe(!1,"Unexpected server value: "+s)}},Ew=function(s,t,r){s.hasOwnProperty("increment")||oe(!1,"Unexpected server value: "+JSON.stringify(s,null,2));const i=s.increment;typeof i!="number"&&oe(!1,"Unexpected increment value: "+i);const c=t.node();if(oe(c!==null&&typeof c<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!c.isLeafNode())return i;const f=c.getValue();return typeof f!="number"?i:f+i},Iw=function(s,t,r,i){return mu(t,new pu(r,s),i)},Ap=function(s,t,r){return mu(s,new fu(t),r)};function mu(s,t,r){const i=s.getPriority().val(),c=p0(i,t.getImmediateChild(".priority"),r);let d;if(s.isLeafNode()){const f=s,p=p0(f.getValue(),t,r);return p!==f.getValue()||c!==f.getPriority().val()?new Nt(p,Et(c)):s}else{const f=s;return d=f,c!==f.getPriority().val()&&(d=d.updatePriority(new Nt(c))),f.forEachChild(ut,(p,m)=>{const x=mu(m,t.getImmediateChild(p),r);x!==m&&(d=d.updateImmediateChild(p,x))}),d}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(t="",r=null,i={children:{},childCount:0}){this.name=t,this.parent=r,this.node=i}}function xu(s,t){let r=t instanceof Je?t:new Je(t),i=s,c=Be(r);for(;c!==null;){const d=ds(i.node.children,c)||{children:{},childCount:0};i=new gu(c,i,d),r=tt(r),c=Be(r)}return i}function vs(s){return s.node.value}function $p(s,t){s.node.value=t,Fc(s)}function Fp(s){return s.node.childCount>0}function Tw(s){return vs(s)===void 0&&!Fp(s)}function ml(s,t){Gt(s.node.children,(r,i)=>{t(new gu(r,s,i))})}function zp(s,t,r,i){r&&t(s),ml(s,c=>{zp(c,t,!0)})}function Lw(s,t,r){let i=s.parent;for(;i!==null;){if(t(i))return!0;i=i.parent}return!1}function To(s){return new Je(s.parent===null?s.name:To(s.parent)+"/"+s.name)}function Fc(s){s.parent!==null&&Mw(s.parent,s.name,s)}function Mw(s,t,r){const i=Tw(r),c=$n(s.node.children,t);i&&c?(delete s.node.children[t],s.node.childCount--,Fc(s)):!i&&!c&&(s.node.children[t]=r.node,s.node.childCount++,Fc(s))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw=/[\[\].#$\/\u0000-\u001F\u007F]/,Pw=/[\[\].#$\u0000-\u001F\u007F]/,wc=10*1024*1024,Wp=function(s){return typeof s=="string"&&s.length!==0&&!Rw.test(s)},Bp=function(s){return typeof s=="string"&&s.length!==0&&!Pw.test(s)},Dw=function(s){return s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),Bp(s)},Ow=function(s,t,r,i){vu(Vc(s,"value"),t,r)},vu=function(s,t,r){const i=r instanceof Je?new Z1(r,s):r;if(t===void 0)throw new Error(s+"contains undefined "+Cr(i));if(typeof t=="function")throw new Error(s+"contains a function "+Cr(i)+" with contents = "+t.toString());if(B0(t))throw new Error(s+"contains "+t.toString()+" "+Cr(i));if(typeof t=="string"&&t.length>wc/3&&cl(t)>wc)throw new Error(s+"contains a string greater than "+wc+" utf8 bytes "+Cr(i)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let c=!1,d=!1;if(Gt(t,(f,p)=>{if(f===".value")c=!0;else if(f!==".priority"&&f!==".sv"&&(d=!0,!Wp(f)))throw new Error(s+" contains an invalid key ("+f+") "+Cr(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);ey(i,f),vu(s,p,i),ty(i)}),c&&d)throw new Error(s+' contains ".value" child '+Cr(i)+" in addition to actual children.")}},Up=function(s,t,r,i){if(!Bp(r))throw new Error(Vc(s,t)+'was an invalid path = "'+r+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Aw=function(s,t,r,i){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),Up(s,t,r)},Hp=function(s,t){if(Be(t)===".info")throw new Error(s+" failed = Can't modify data under /.info/")},$w=function(s,t){const r=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!Wp(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||r.length!==0&&!Dw(r))throw new Error(Vc(s,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function yu(s,t){let r=null;for(let i=0;i<t.length;i++){const c=t[i],d=c.getPath();r!==null&&!Kc(d,r.path)&&(s.eventLists_.push(r),r=null),r===null&&(r={events:[],path:d}),r.events.push(c)}r&&s.eventLists_.push(r)}function Vp(s,t,r){yu(s,r),Yp(s,i=>Kc(i,t))}function An(s,t,r){yu(s,r),Yp(s,i=>xn(i,t)||xn(t,i))}function Yp(s,t){s.recursionDepth_++;let r=!0;for(let i=0;i<s.eventLists_.length;i++){const c=s.eventLists_[i];if(c){const d=c.path;t(d)?(zw(s.eventLists_[i]),s.eventLists_[i]=null):r=!1}}r&&(s.eventLists_=[]),s.recursionDepth_--}function zw(s){for(let t=0;t<s.events.length;t++){const r=s.events[t];if(r!==null){s.events[t]=null;const i=r.getEventRunner();co&&Pt("event: "+r.toString()),xs(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ww="repo_interrupt",Bw=25;class Uw{constructor(t,r,i,c){this.repoInfo_=t,this.forceRestClient_=r,this.authTokenProvider_=i,this.appCheckProvider_=c,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Fw,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Zi(),this.transactionQueueTree_=new gu,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Hw(s,t,r){if(s.stats_=qc(s.repoInfo_),s.forceRestClient_||k1())s.server_=new Ji(s.repoInfo_,(i,c,d,f)=>{m0(s,i,c,d,f)},s.authTokenProvider_,s.appCheckProvider_),setTimeout(()=>g0(s,!0),0);else{if(typeof r<"u"&&r!==null){if(typeof r!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ct(r)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}s.persistentConnection_=new Pn(s.repoInfo_,t,(i,c,d,f)=>{m0(s,i,c,d,f)},i=>{g0(s,i)},i=>{Yw(s,i)},s.authTokenProvider_,s.appCheckProvider_,r),s.server_=s.persistentConnection_}s.authTokenProvider_.addTokenChangeListener(i=>{s.server_.refreshAuthToken(i)}),s.appCheckProvider_.addTokenChangeListener(i=>{s.server_.refreshAppCheckToken(i.token)}),s.statsReporter_=I1(s.repoInfo_,()=>new Sy(s.stats_,s.server_)),s.infoData_=new _y,s.infoSyncTree_=new h0({startListening:(i,c,d,f)=>{let p=[];const m=s.infoData_.getNode(i._path);return m.isEmpty()||(p=fl(s.infoSyncTree_,i._path,m),setTimeout(()=>{f("ok")},0)),p},stopListening:()=>{}}),bu(s,"connected",!1),s.serverSyncTree_=new h0({startListening:(i,c,d,f)=>(s.server_.listen(i,d,c,(p,m)=>{const x=f(p,m);An(s.eventQueue_,i._path,x)}),[]),stopListening:(i,c)=>{s.server_.unlisten(i,c)}})}function Vw(s){const r=s.infoData_.getNode(new Je(".info/serverTimeOffset")).val()||0;return new Date().getTime()+r}function wu(s){return jw({timestamp:Vw(s)})}function m0(s,t,r,i,c){s.dataUpdateCount++;const d=new Je(t);r=s.interceptServerDataCallback_?s.interceptServerDataCallback_(t,r):r;let f=[];if(c)if(i){const m=Vi(r,x=>Et(x));f=bw(s.serverSyncTree_,d,m,c)}else{const m=Et(r);f=ww(s.serverSyncTree_,d,m,c)}else if(i){const m=Vi(r,x=>Et(x));f=xw(s.serverSyncTree_,d,m)}else{const m=Et(r);f=fl(s.serverSyncTree_,d,m)}let p=d;f.length>0&&(p=gl(s,d)),An(s.eventQueue_,p,f)}function g0(s,t){bu(s,"connected",t),t===!1&&Gw(s)}function Yw(s,t){Gt(t,(r,i)=>{bu(s,r,i)})}function bu(s,t,r){const i=new Je("/.info/"+t),c=Et(r);s.infoData_.updateSnapshot(i,c);const d=fl(s.infoSyncTree_,i,c);An(s.eventQueue_,i,d)}function Qp(s){return s.nextWriteId_++}function Qw(s,t,r,i,c){_u(s,"set",{path:t.toString(),value:r,priority:i});const d=wu(s),f=Et(r,i),p=cu(s.serverSyncTree_,t),m=Ap(f,p,d),x=Qp(s),w=Rp(s.serverSyncTree_,t,m,x,!0);yu(s.eventQueue_,w),s.server_.put(t.toString(),f.val(!0),(v,j)=>{const $=v==="ok";$||Qt("set at "+t+" failed: "+v);const R=Sr(s.serverSyncTree_,x,!$);An(s.eventQueue_,t,R),Jw(s,c,v,j)});const _=Jp(s,t);gl(s,_),An(s.eventQueue_,_,[])}function Gw(s){_u(s,"onDisconnectEvents");const t=wu(s),r=Zi();Mc(s.onDisconnect_,Xe(),(c,d)=>{const f=Iw(c,d,s.serverSyncTree_,t);yp(r,c,f)});let i=[];Mc(r,Xe(),(c,d)=>{i=i.concat(fl(s.serverSyncTree_,c,d));const f=Jp(s,c);gl(s,f)}),s.onDisconnect_=Zi(),An(s.eventQueue_,Xe(),i)}function qw(s,t,r){let i;Be(t._path)===".info"?i=f0(s.infoSyncTree_,t,r):i=f0(s.serverSyncTree_,t,r),Vp(s.eventQueue_,t._path,i)}function Xw(s,t,r){let i;Be(t._path)===".info"?i=$c(s.infoSyncTree_,t,r):i=$c(s.serverSyncTree_,t,r),Vp(s.eventQueue_,t._path,i)}function Kw(s){s.persistentConnection_&&s.persistentConnection_.interrupt(Ww)}function _u(s,...t){let r="";s.persistentConnection_&&(r=s.persistentConnection_.id+":"),Pt(r,...t)}function Jw(s,t,r,i){t&&xs(()=>{if(r==="ok")t(null);else{const c=(r||"error").toUpperCase();let d=c;i&&(d+=": "+i);const f=new Error(d);f.code=c,t(f)}})}function Gp(s,t,r){return cu(s.serverSyncTree_,t,r)||Pe.EMPTY_NODE}function Nu(s,t=s.transactionQueueTree_){if(t||xl(s,t),vs(t)){const r=Xp(s,t);oe(r.length>0,"Sending zero length transaction queue"),r.every(c=>c.status===0)&&Zw(s,To(t),r)}else Fp(t)&&ml(t,r=>{Nu(s,r)})}function Zw(s,t,r){const i=r.map(x=>x.currentWriteId),c=Gp(s,t,i);let d=c;const f=c.hash();for(let x=0;x<r.length;x++){const w=r[x];oe(w.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),w.status=1,w.retryCount++;const _=Vt(t,w.path);d=d.updateChild(_,w.currentOutputSnapshotRaw)}const p=d.val(!0),m=t;s.server_.put(m.toString(),p,x=>{_u(s,"transaction put response",{path:m.toString(),status:x});let w=[];if(x==="ok"){const _=[];for(let v=0;v<r.length;v++)r[v].status=2,w=w.concat(Sr(s.serverSyncTree_,r[v].currentWriteId)),r[v].onComplete&&_.push(()=>r[v].onComplete(null,!0,r[v].currentOutputSnapshotResolved)),r[v].unwatcher();xl(s,xu(s.transactionQueueTree_,t)),Nu(s,s.transactionQueueTree_),An(s.eventQueue_,t,w);for(let v=0;v<_.length;v++)xs(_[v])}else{if(x==="datastale")for(let _=0;_<r.length;_++)r[_].status===3?r[_].status=4:r[_].status=0;else{Qt("transaction at "+m.toString()+" failed: "+x);for(let _=0;_<r.length;_++)r[_].status=4,r[_].abortReason=x}gl(s,t)}},f)}function gl(s,t){const r=qp(s,t),i=To(r),c=Xp(s,r);return eb(s,c,i),i}function eb(s,t,r){if(t.length===0)return;const i=[];let c=[];const f=t.filter(p=>p.status===0).map(p=>p.currentWriteId);for(let p=0;p<t.length;p++){const m=t[p],x=Vt(r,m.path);let w=!1,_;if(oe(x!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),m.status===4)w=!0,_=m.abortReason,c=c.concat(Sr(s.serverSyncTree_,m.currentWriteId,!0));else if(m.status===0)if(m.retryCount>=Bw)w=!0,_="maxretry",c=c.concat(Sr(s.serverSyncTree_,m.currentWriteId,!0));else{const v=Gp(s,m.path,f);m.currentInputSnapshot=v;const j=t[p].update(v.val());if(j!==void 0){vu("transaction failed: Data returned ",j,m.path);let $=Et(j);typeof j=="object"&&j!=null&&$n(j,".priority")||($=$.updatePriority(v.getPriority()));const q=m.currentWriteId,de=wu(s),fe=Ap($,v,de);m.currentOutputSnapshotRaw=$,m.currentOutputSnapshotResolved=fe,m.currentWriteId=Qp(s),f.splice(f.indexOf(q),1),c=c.concat(Rp(s.serverSyncTree_,m.path,fe,m.currentWriteId,m.applyLocally)),c=c.concat(Sr(s.serverSyncTree_,q,!0))}else w=!0,_="nodata",c=c.concat(Sr(s.serverSyncTree_,m.currentWriteId,!0))}An(s.eventQueue_,r,c),c=[],w&&(t[p].status=2,(function(v){setTimeout(v,Math.floor(0))})(t[p].unwatcher),t[p].onComplete&&(_==="nodata"?i.push(()=>t[p].onComplete(null,!1,t[p].currentInputSnapshot)):i.push(()=>t[p].onComplete(new Error(_),!1,null))))}xl(s,s.transactionQueueTree_);for(let p=0;p<i.length;p++)xs(i[p]);Nu(s,s.transactionQueueTree_)}function qp(s,t){let r,i=s.transactionQueueTree_;for(r=Be(t);r!==null&&vs(i)===void 0;)i=xu(i,r),t=tt(t),r=Be(t);return i}function Xp(s,t){const r=[];return Kp(s,t,r),r.sort((i,c)=>i.order-c.order),r}function Kp(s,t,r){const i=vs(t);if(i)for(let c=0;c<i.length;c++)r.push(i[c]);ml(t,c=>{Kp(s,c,r)})}function xl(s,t){const r=vs(t);if(r){let i=0;for(let c=0;c<r.length;c++)r[c].status!==2&&(r[i]=r[c],i++);r.length=i,$p(t,r.length>0?r:void 0)}ml(t,i=>{xl(s,i)})}function Jp(s,t){const r=To(qp(s,t)),i=xu(s.transactionQueueTree_,t);return Lw(i,c=>{bc(s,c)}),bc(s,i),zp(i,c=>{bc(s,c)}),r}function bc(s,t){const r=vs(t);if(r){const i=[];let c=[],d=-1;for(let f=0;f<r.length;f++)r[f].status===3||(r[f].status===1?(oe(d===f-1,"All SENT items should be at beginning of queue."),d=f,r[f].status=3,r[f].abortReason="set"):(oe(r[f].status===0,"Unexpected transaction status in abort"),r[f].unwatcher(),c=c.concat(Sr(s.serverSyncTree_,r[f].currentWriteId,!0)),r[f].onComplete&&i.push(r[f].onComplete.bind(null,new Error("set"),!1,null))));d===-1?$p(t,void 0):r.length=d+1,An(s.eventQueue_,To(t),c);for(let f=0;f<i.length;f++)xs(i[f])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tb(s){let t="";const r=s.split("/");for(let i=0;i<r.length;i++)if(r[i].length>0){let c=r[i];try{c=decodeURIComponent(c.replace(/\+/g," "))}catch{}t+="/"+c}return t}function nb(s){const t={};s.charAt(0)==="?"&&(s=s.substring(1));for(const r of s.split("&")){if(r.length===0)continue;const i=r.split("=");i.length===2?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Qt(`Invalid query segment '${r}' in query '${s}'`)}return t}const x0=function(s,t){const r=rb(s),i=r.namespace;r.domain==="firebase.com"&&On(r.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&r.domain!=="localhost"&&On("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r.secure||m1();const c=r.scheme==="ws"||r.scheme==="wss";return{repoInfo:new ep(r.host,r.secure,i,c,t,"",i!==r.subdomain),path:new Je(r.pathString)}},rb=function(s){let t="",r="",i="",c="",d="",f=!0,p="https",m=443;if(typeof s=="string"){let x=s.indexOf("//");x>=0&&(p=s.substring(0,x-1),s=s.substring(x+2));let w=s.indexOf("/");w===-1&&(w=s.length);let _=s.indexOf("?");_===-1&&(_=s.length),t=s.substring(0,Math.min(w,_)),w<_&&(c=tb(s.substring(w,_)));const v=nb(s.substring(Math.min(s.length,_)));x=t.indexOf(":"),x>=0?(f=p==="https"||p==="wss",m=parseInt(t.substring(x+1),10)):x=t.length;const j=t.slice(0,x);if(j.toLowerCase()==="localhost")r="localhost";else if(j.split(".").length<=2)r=j;else{const $=t.indexOf(".");i=t.substring(0,$).toLowerCase(),r=t.substring($+1),d=i}"ns"in v&&(d=v.ns)}return{host:t,port:m,domain:r,subdomain:i,secure:f,scheme:p,pathString:c,namespace:d}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(t,r,i,c){this.eventType=t,this.eventRegistration=r,this.snapshot=i,this.prevName=c}getPath(){const t=this.snapshot.ref;return this.eventType==="value"?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ct(this.snapshot.exportVal())}}class ob{constructor(t,r,i){this.eventRegistration=t,this.error=r,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(t,r){this.snapshotCallback=t,this.cancelCallback=r}onValue(t,r){this.snapshotCallback.call(null,t,r)}onCancel(t){return oe(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(t,r,i,c){this._repo=t,this._path=r,this._queryParams=i,this._orderByCalled=c}get key(){return Ve(this._path)?null:cp(this._path)}get ref(){return new ur(this._repo,this._path)}get _queryIdentifier(){const t=t0(this._queryParams),r=Qc(t);return r==="{}"?"default":r}get _queryObject(){return t0(this._queryParams)}isEqual(t){if(t=Co(t),!(t instanceof ku))return!1;const r=this._repo===t._repo,i=Kc(this._path,t._path),c=this._queryIdentifier===t._queryIdentifier;return r&&i&&c}toJSON(){return this.toString()}toString(){return this._repo.toString()+J1(this._path)}}class ur extends ku{constructor(t,r){super(t,r,new tu,!1)}get parent(){const t=dp(this._path);return t===null?null:new ur(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}}class ll{constructor(t,r,i){this._node=t,this.ref=r,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const r=new Je(t),i=zc(this.ref,t);return new ll(this._node.getChild(r),i,ut)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,c)=>t(new ll(c,zc(this.ref,i),ut)))}hasChild(t){const r=new Je(t);return!this._node.getChild(r).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function mt(s,t){return s=Co(s),s._checkNotDeleted("ref"),t!==void 0?zc(s._root,t):s._root}function zc(s,t){return s=Co(s),Be(s._path)===null?Aw("child","path",t):Up("child","path",t),new ur(s._repo,yt(s._path,t))}function ys(s){return Hp("remove",s._path),Fn(s,null)}function Fn(s,t){s=Co(s),Hp("set",s._path),Ow("set",t,s._path);const r=new al;return Qw(s._repo,s._path,t,null,r.wrapCallback(()=>{})),r.promise}class Cu{constructor(t){this.callbackContext=t}respondsTo(t){return t==="value"}createEvent(t,r){const i=r._queryParams.getIndex();return new sb("value",this,new ll(t.snapshotNode,new ur(r._repo,r._path),i))}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,r){return this.callbackContext.hasCancelCallback?new ob(this,t,r):null}matches(t){return t instanceof Cu?!t.callbackContext||!this.callbackContext?!0:t.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function lb(s,t,r,i,c){const d=new ib(r,void 0),f=new Cu(d);return qw(s._repo,s,f),()=>Xw(s._repo,s,f)}function Rr(s,t,r,i){return lb(s,"value",t)}aw(ur);pw(ur);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ab="FIREBASE_DATABASE_EMULATOR_HOST",Wc={};let cb=!1;function ub(s,t,r,i){const c=t.lastIndexOf(":"),d=t.substring(0,c),f=Hc(d);s.repoInfo_=new ep(t,f,s.repoInfo_.namespace,s.repoInfo_.webSocketOnly,s.repoInfo_.nodeAdmin,s.repoInfo_.persistenceKey,s.repoInfo_.includeNamespaceInQueryParams,!0,r),i&&(s.authTokenProvider_=i)}function db(s,t,r,i,c){let d=i||s.options.databaseURL;d===void 0&&(s.options.projectId||On("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Pt("Using default host for project ",s.options.projectId),d=`${s.options.projectId}-default-rtdb.firebaseio.com`);let f=x0(d,c),p=f.repoInfo,m;typeof process<"u"&&Af&&(m=Af[ab]),m?(d=`http://${m}?ns=${p.namespace}`,f=x0(d,c),p=f.repoInfo):f.repoInfo.secure;const x=new j1(s.name,s.options,t);$w("Invalid Firebase Database URL",f),Ve(f.path)||On("Database URL must point to the root of a Firebase Database (not including a child path).");const w=fb(p,s,x,new C1(s,r));return new pb(w,s)}function hb(s,t){const r=Wc[t];(!r||r[s.key]!==s)&&On(`Database ${t}(${s.repoInfo_}) has already been deleted.`),Kw(s),delete r[s.key]}function fb(s,t,r,i){let c=Wc[t.name];c||(c={},Wc[t.name]=c);let d=c[s.toURLString()];return d&&On("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),d=new Uw(s,cb,r,i),c[s.toURLString()]=d,d}class pb{constructor(t,r){this._repoInternal=t,this.app=r,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Hw(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ur(this._repo,Xe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(hb(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&On("Cannot call "+t+" on a deleted database.")}}function mb(s=Xv(),t){const r=Vv(s,"database").getImmediate({identifier:t});if(!r._instanceStarted){const i=Tx("database");i&&gb(r,...i)}return r}function gb(s,t,r,i={}){s=Co(s),s._checkNotDeleted("useEmulator");const c=`${t}:${r}`,d=s._repoInternal;if(s._instanceStarted){if(c===s._repoInternal.repoInfo_.host&&Yi(i,d.repoInfo_.emulatorOptions))return;On("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let f;if(d.repoInfo_.nodeAdmin)i.mockUserToken&&On('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),f=new Wi(Wi.OWNER);else if(i.mockUserToken){const p=typeof i.mockUserToken=="string"?i.mockUserToken:Mx(i.mockUserToken,s.app.options.projectId);f=new Wi(p)}Hc(t)&&(Lx(t),Dx("Database",!0)),ub(d,c,i,f)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xb(s){c1(qv),Gi(new go("database",(t,{instanceIdentifier:r})=>{const i=t.getProvider("app").getImmediate(),c=t.getProvider("auth-internal"),d=t.getProvider("app-check-internal");return db(i,c,d,r)},"PUBLIC").setMultipleInstances(!0)),ls($f,Ff,s),ls($f,Ff,"esm2020")}Pn.prototype.simpleListen=function(s,t){this.sendRequest("q",{p:s},t)};Pn.prototype.echo=function(s,t){this.sendRequest("echo",{d:s},t)};xb();const vb={apiKey:"AIzaSyCIA80U-Nb235O5SG_2d1TzdylvYQrzNUc",authDomain:"razlom-db061.firebaseapp.com",projectId:"razlom-db061",storageBucket:"razlom-db061.firebasestorage.app",messagingSenderId:"343432819418",appId:"1:343432819418:web:73f0fedc8a5e5a32912be3",measurementId:"G-EPLQFH5LMJ",databaseURL:"https://razlom-db061-default-rtdb.firebaseio.com"};let v0,Fe;try{v0=O0(vb),Fe=mb(v0),console.log("Firebase initialized successfully (RTDB only)")}catch(s){console.error("Firebase init error:",s)}const ws=s=>{if(!s)return[];const t=Array.isArray(s)?s:Object.values(s),r=new Map;return t.forEach(i=>{i&&typeof i=="object"&&i.id&&r.set(i.id,i)}),Array.from(r.values())},os=s=>(s||[]).reduce((t,r)=>(r&&r.id&&(t[r.id]=r),t),{}),yb=(s,t)=>{if(!Fe)return()=>{};const r=mt(Fe,`rooms/${s}/characters`);return Rr(r,i=>{t(ws(i.val()))})},wb=(s,t)=>{if(!Fe)return()=>{};const r=mt(Fe,`rooms/${s}/realms`);return Rr(r,i=>{t(ws(i.val()))})},bb=(s,t)=>{if(!Fe)return()=>{};const r=mt(Fe,`rooms/${s}/worlds`);return Rr(r,i=>{t(ws(i.val()))})},_b=(s,t)=>{if(!Fe)return()=>{};const r=mt(Fe,`rooms/${s}/notes`);return Rr(r,i=>{t(ws(i.val()))})},Nb=(s,t)=>{if(!Fe)return()=>{};const r=mt(Fe,`rooms/${s}/wikiEntries`);return Rr(r,i=>{t(ws(i.val()))})},kb=(s,t)=>{if(!Fe)return()=>{};const r=mt(Fe,`rooms/${s}/rpSessions`);return Rr(r,i=>{t(ws(i.val()))})},y0=(s,t,r=!1)=>{if(!Fe)return()=>{};const c=mt(Fe,`rooms/${s}/${r?"availableHiddenTags":"availableTags"}`);return Rr(c,d=>{const f=d.val();t(Array.isArray(f)?f:[])})},Cb=async(s,t)=>{if(!Fe)return;const r=mt(Fe,`rooms/${s}`),i={...t,characters:os(t.characters),realms:os(t.realms),worlds:os(t.worlds),notes:os(t.notes),wikiEntries:os(t.wikiEntries),rpSessions:os(t.rpSessions)};try{await Fn(r,i)}catch(c){console.error("Firebase write error:",c)}},jb=async(s,t)=>{if(!Fe||!t.id)return;const r=mt(Fe,`rooms/${s}/characters/${t.id}`);try{await Fn(r,t)}catch(i){console.error("Error saving character:",i)}},Sb=async(s,t)=>{if(!Fe)return;const r=mt(Fe,`rooms/${s}/characters/${t}`);try{await ys(r)}catch(i){console.error("Error deleting character:",i)}},Eb=async(s,t)=>{if(!Fe||!t.id)return;const r=mt(Fe,`rooms/${s}/realms/${t.id}`);try{await Fn(r,t)}catch(i){console.error(i)}},Ib=async(s,t)=>{if(!Fe)return;const r=mt(Fe,`rooms/${s}/realms/${t}`);try{await ys(r)}catch(i){console.error(i)}},Tb=async(s,t)=>{if(!Fe||!t.id)return;const r=mt(Fe,`rooms/${s}/worlds/${t.id}`);try{await Fn(r,t)}catch(i){console.error(i)}},Lb=async(s,t)=>{if(!Fe)return;const r=mt(Fe,`rooms/${s}/worlds/${t}`);try{await ys(r)}catch(i){console.error(i)}},Mb=async(s,t)=>{if(!Fe||!t.id)return;const r=mt(Fe,`rooms/${s}/notes/${t.id}`);try{await Fn(r,t)}catch(i){console.error(i)}},Rb=async(s,t)=>{if(!Fe)return;const r=mt(Fe,`rooms/${s}/notes/${t}`);try{await ys(r)}catch(i){console.error(i)}},Pb=async(s,t)=>{if(!Fe||!t.id)return;const r=mt(Fe,`rooms/${s}/wikiEntries/${t.id}`);try{await Fn(r,t)}catch(i){console.error(i)}},Db=async(s,t)=>{if(!Fe)return;const r=mt(Fe,`rooms/${s}/wikiEntries/${t}`);try{await ys(r)}catch(i){console.error(i)}},Ob=async(s,t)=>{if(!Fe||!t.id)return;const r=mt(Fe,`rooms/${s}/rpSessions/${t.id}`);try{await Fn(r,t)}catch(i){console.error(i)}},Ab=async(s,t)=>{if(!Fe)return;const r=mt(Fe,`rooms/${s}/rpSessions/${t}`);try{await ys(r)}catch(i){console.error(i)}},w0=async(s,t,r=!1)=>{if(!Fe)return;const c=mt(Fe,`rooms/${s}/${r?"availableHiddenTags":"availableTags"}`);try{await Fn(c,t)}catch(d){console.error("Error saving tags:",d)}},b0="rp_haven_master_data_v3",at="global_chronicles_main",Rt=(s,t=[])=>Array.isArray(s)?s:t,$b=()=>{const[s,t]=O.useState("characters"),[r,i]=O.useState(null),[c,d]=O.useState(null),[f,p]=O.useState(""),[m,x]=O.useState({}),[w,_]=O.useState(!1),[v,j]=O.useState(!1),[$,R]=O.useState(null),[q,de]=O.useState(!1),[fe,Se]=O.useState(!1),[J,Me]=O.useState(!0);O.useEffect(()=>{window.scrollTo(0,0)},[s,r,c]);const[Z,A]=O.useState(!1),[X,Ce]=O.useState(uc),[P,Ee]=O.useState(()=>{const F=localStorage.getItem(b0);if(F)try{const W=JSON.parse(F);return{characters:Rt(W.characters,uc),realms:Rt(W.realms),worlds:Rt(W.worlds),notes:Rt(W.notes),wikiEntries:Rt(W.wikiEntries),availableTags:Rt(W.availableTags,Nf),availableHiddenTags:Rt(W.availableHiddenTags,kf),rpSessions:Rt(W.rpSessions)}}catch(W){console.error("Failed to parse storage",W)}return{characters:uc,realms:[],worlds:[],notes:[],wikiEntries:[],availableTags:Nf,availableHiddenTags:kf,rpSessions:[]}});O.useEffect(()=>{Ce(P.characters)},[P.characters]),O.useEffect(()=>{if(J){const F=yb(at,ie=>Ee(me=>({...me,characters:ie}))),W=wb(at,ie=>Ee(me=>({...me,realms:ie}))),re=bb(at,ie=>Ee(me=>({...me,worlds:ie}))),We=_b(at,ie=>Ee(me=>({...me,notes:ie}))),D=Nb(at,ie=>Ee(me=>({...me,wikiEntries:ie}))),se=kb(at,ie=>Ee(me=>({...me,rpSessions:ie}))),k=y0(at,ie=>Ee(me=>({...me,availableTags:ie})),!1),Q=y0(at,ie=>Ee(me=>({...me,availableHiddenTags:ie})),!0);return()=>{F(),W(),re(),We(),D(),se(),k(),Q()}}},[J]);const ye=()=>{const F=P.characters.filter(W=>{const re=W.name.toLowerCase().includes(f.toLowerCase()),We=Object.entries(m).every(([D,se])=>{const k=(W.tags||[]).includes(D)||(W.hiddenTags||[]).includes(D);return se==="include"?k:se==="exclude"?!k:!0});return re&&We});A(!0),setTimeout(()=>{Ce(F),requestAnimationFrame(()=>{A(!1)})},600)};O.useEffect(()=>{ye()},[f,m,P.characters]);const ke=F=>{Ee(F),de(!0),setTimeout(()=>de(!1),2e3);try{const W=JSON.parse(JSON.stringify(F));W.characters.forEach(re=>{re.imageUrl&&re.imageUrl.startsWith("data:")&&(re.imageUrl="")}),W.worlds.forEach(re=>{re.imageUrl&&re.imageUrl.startsWith("data:")&&(re.imageUrl="")}),W.realms.forEach(re=>{re.imageUrl&&re.imageUrl.startsWith("data:")&&(re.imageUrl="")}),localStorage.setItem(b0,JSON.stringify(W))}catch(W){console.warn("Local storage quota exceeded.",W)}},ue=F=>{const W=P.characters.some(re=>re.id===F.id)?P.characters.map(re=>re.id===F.id?F:re):[...P.characters,F];ke({...P,characters:W}),j(!1),R(null),J&&jb(at,F)},Ye=F=>{if(window.confirm("    ?")){const W=P.characters.filter(re=>re.id!==F);ke({...P,characters:W}),r===F&&i(null),J&&Sb(at,F)}},ae=F=>{J&&(F.forEach(W=>{const re=P.notes.find(We=>We.id===W.id);(!re||JSON.stringify(re)!==JSON.stringify(W))&&Mb(at,W)}),P.notes.forEach(W=>{F.find(re=>re.id===W.id)||Rb(at,W.id)})),ke({...P,notes:F})},ze=F=>{J&&(F.forEach(W=>{const re=P.wikiEntries.find(We=>We.id===W.id);(!re||JSON.stringify(re)!==JSON.stringify(W))&&Pb(at,W)}),P.wikiEntries.forEach(W=>{F.find(re=>re.id===W.id)||Db(at,W.id)})),ke({...P,wikiEntries:F})},H=F=>{J&&(F.forEach(W=>{const re=P.realms.find(We=>We.id===W.id);(!re||JSON.stringify(re)!==JSON.stringify(W))&&Eb(at,W)}),P.realms.forEach(W=>{F.find(re=>re.id===W.id)||Ib(at,W.id)})),ke({...P,realms:F})},U=F=>{J&&(F.forEach(W=>{const re=P.worlds.find(We=>We.id===W.id);(!re||JSON.stringify(re)!==JSON.stringify(W))&&Tb(at,W)}),P.worlds.forEach(W=>{F.find(re=>re.id===W.id)||Lb(at,W.id)})),ke({...P,worlds:F})},N=F=>{J&&(F.forEach(W=>{const re=P.rpSessions.find(We=>We.id===W.id);(!re||JSON.stringify(re)!==JSON.stringify(W))&&Ob(at,W)}),P.rpSessions.forEach(W=>{F.find(re=>re.id===W.id)||Ab(at,W.id)})),ke({...P,rpSessions:F})},I=F=>{ke({...P,availableTags:F}),J&&w0(at,F,!1)},ee=F=>{ke({...P,availableHiddenTags:F}),J&&w0(at,F,!0)},he=F=>{x(W=>{const re=W[F]||"none";let We="none";re==="none"?We="include":re==="include"?We="exclude":We="none";const D={...W};return We==="none"?delete D[F]:D[F]=We,D})},Le=()=>{p(""),x({})},Ae=F=>{i(F),t("characters")},De=F=>{d(F),t("wiki")},xe=Object.keys(m).length;return l.jsxs(sx,{activeTab:s,setActiveTab:F=>{t(F),i(null),d(null),x({})},isAdmin:w,onToggleAdmin:()=>_(!w),onOpenSync:()=>Se(!0),isSyncActive:J,onDownloadDB:()=>{const F=new Blob([JSON.stringify(P,null,2)],{type:"application/json"}),W=URL.createObjectURL(F),re=document.createElement("a");re.href=W,re.download=`rp-vault-${new Date().toISOString().slice(0,10)}.json`,re.click()},onUploadDB:F=>{const W=JSON.parse(F);if(window.confirm("  ?")){const re={characters:Rt(W.characters),realms:Rt(W.realms),worlds:Rt(W.worlds),notes:Rt(W.notes),wikiEntries:Rt(W.wikiEntries),availableTags:Rt(W.availableTags),availableHiddenTags:Rt(W.availableHiddenTags),rpSessions:Rt(W.rpSessions)};ke(re),J&&Cb(at,re)}},children:[l.jsx("div",{className:`fixed top-20 md:top-6 right-6 z-[90] transition-all duration-500 pointer-events-none ${q?"opacity-100 translate-y-0":"opacity-0 -translate-y-4"}`,children:l.jsx("div",{className:"bg-emerald-950/80 border border-emerald-500/30 backdrop-blur-2xl px-5 py-2.5 rounded-2xl flex items-center gap-3 shadow-2xl",children:l.jsx("span",{className:"text-[10px] uppercase tracking-[0.2em] font-black text-emerald-400",children:""})})}),fe&&l.jsx(yx,{isConnected:J,onConnect:()=>Me(!0),onDisconnect:()=>Me(!1),onClose:()=>Se(!1)}),l.jsxs("div",{className:"animate-tab-switch",children:[s==="characters"&&l.jsx("div",{className:"space-y-8",children:r?l.jsx(cx,{character:P.characters.find(F=>F.id===r),isAdmin:w,allCharacters:P.characters,availableTags:P.availableTags,availableHiddenTags:P.availableHiddenTags,worlds:P.worlds,notes:P.notes,onBack:()=>i(null),onSave:ue,onSelectCharacter:Ae,onSelectWikiEntry:De}):l.jsxs("div",{className:"animate-reveal-list space-y-8",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-6",children:[l.jsx("input",{type:"text",placeholder:"  ...",value:f,onChange:F=>p(F.target.value),className:"w-full bg-transparent border-b border-stone-900 text-3xl outline-none font-serif italic py-4"}),w&&l.jsx("button",{onClick:()=>{R(null),j(!0)},className:"bg-white text-black px-8 py-3.5 rounded-full text-[10px] uppercase font-black transition-all shadow-xl",children:" "})]}),(P.availableTags.length>0||P.availableHiddenTags.length>0)&&l.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-4 bg-[#0f0f0f]/30 border border-stone-900/50 rounded-2xl",children:[l.jsx("span",{className:"text-[9px] uppercase tracking-[0.2em] font-black text-stone-600 mr-2",children:":"}),P.availableTags.map(F=>{const W=m[F]||"none";return l.jsxs("button",{onClick:()=>he(F),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${W==="include"?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":W==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-stone-400 hover:border-stone-700"}`,children:[W==="include"&&l.jsx("span",{className:"text-emerald-500 font-black",children:"+"}),W==="exclude"&&l.jsx("span",{className:"text-red-500 font-black",children:""}),F]},F)}),P.availableHiddenTags.map(F=>{const W=m[F]||"none";return l.jsxs("button",{onClick:()=>he(F),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${W==="include"?"bg-amber-500/10 border-amber-500/40 text-amber-400 shadow-[0_0_15px_rgba(245,158,11,0.1)]":W==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-amber-500 hover:border-amber-900/30"}`,children:[W==="include"&&l.jsx("span",{className:"text-amber-500 font-black",children:"+"}),W==="exclude"&&l.jsx("span",{className:"text-red-500 font-black",children:""}),F]},F)}),(xe>0||f)&&l.jsx("button",{onClick:Le,className:"ml-auto text-[9px] uppercase tracking-[0.2em] font-black text-stone-700 hover:text-red-500 transition-colors",children:" "})]}),l.jsxs("div",{className:"flex flex-wrap -mx-5 relative min-h-[400px]",children:[X.map((F,W)=>l.jsx(ix,{character:F,isVisible:!Z,staggerIndex:W,onClick:i},F.id)),X.length===0&&!Z&&l.jsx("div",{className:"w-full py-20 text-center text-stone-700 italic font-serif animate-in fade-in duration-700",children:"       ..."})]})]})}),s==="connections"&&l.jsx(px,{characters:P.characters,availableTags:P.availableTags,availableHiddenTags:P.availableHiddenTags,filterStates:m,onToggleTag:he,onClearFilters:()=>x({}),onSelectCharacter:Ae}),s==="roleplay"&&l.jsx(vx,{sessions:P.rpSessions,characters:P.characters,onUpdate:N,isAdmin:w}),s==="worlds"&&l.jsx(mx,{realms:P.realms,worlds:P.worlds,characters:P.characters,availableTags:P.availableTags,availableHiddenTags:P.availableHiddenTags,onUpdateRealms:H,onUpdateWorlds:U,isAdmin:w}),s==="notes"&&l.jsx(ax,{notes:P.notes,characters:P.characters,wikiEntries:P.wikiEntries,availableTags:P.availableTags,availableHiddenTags:P.availableHiddenTags,onUpdate:ae,isAdmin:w,onSelectCharacter:Ae,onSelectWikiEntry:De}),s==="wiki"&&l.jsx(xx,{entries:P.wikiEntries,characters:P.characters,availableTags:P.availableTags,availableHiddenTags:P.availableHiddenTags,isAdmin:w,onUpdate:ze,onSelectCharacter:Ae,selectedEntryId:c}),s==="admin"&&w&&l.jsx(dx,{characters:P.characters,availableTags:P.availableTags,availableHiddenTags:P.availableHiddenTags,onDelete:Ye,onEdit:F=>{R(F),j(!0)},onAdd:()=>{R(null),j(!0)},onUpdateTags:I,onUpdateHiddenTags:ee,onDownloadDB:()=>{},onUploadDB:()=>{}})]}),v&&l.jsx(ux,{initialData:$,availableTags:P.availableTags,availableHiddenTags:P.availableHiddenTags,onSave:ue,onClose:()=>j(!1)})]})},Zp=document.getElementById("root");if(!Zp)throw new Error("Could not find root element to mount to");const Fb=rx.createRoot(Zp);Fb.render(l.jsx(N0.StrictMode,{children:l.jsx($b,{})}));
