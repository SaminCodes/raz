(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function r(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(c){if(c.ep)return;c.ep=!0;const d=r(c);fetch(c.href,d)}})();function _p(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var rc={exports:{}},Js={},sc={exports:{}},Oe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cf;function Yg(){if(cf)return Oe;cf=1;var s=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),f=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),y=Symbol.iterator;function v(w){return w===null||typeof w!="object"?null:(w=y&&w[y]||w["@@iterator"],typeof w=="function"?w:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,B={};function ne(w,O,ee){this.props=w,this.context=O,this.refs=B,this.updater=ee||C}ne.prototype.isReactComponent={},ne.prototype.setState=function(w,O){if(typeof w!="object"&&typeof w!="function"&&w!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,w,O,"setState")},ne.prototype.forceUpdate=function(w){this.updater.enqueueForceUpdate(this,w,"forceUpdate")};function ue(){}ue.prototype=ne.prototype;function se(w,O,ee){this.props=w,this.context=O,this.refs=B,this.updater=ee||C}var je=se.prototype=new ue;je.constructor=se,M(je,ne.prototype),je.isPureReactComponent=!0;var he=Array.isArray,We=Object.prototype.hasOwnProperty,J={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function P(w,O,ee){var ke,D={},A=null,Q=null;if(O!=null)for(ke in O.ref!==void 0&&(Q=O.ref),O.key!==void 0&&(A=""+O.key),O)We.call(O,ke)&&!L.hasOwnProperty(ke)&&(D[ke]=O[ke]);var j=arguments.length-2;if(j===1)D.children=ee;else if(1<j){for(var K=Array(j),ye=0;ye<j;ye++)K[ye]=arguments[ye+2];D.children=K}if(w&&w.defaultProps)for(ke in j=w.defaultProps,j)D[ke]===void 0&&(D[ke]=j[ke]);return{$$typeof:s,type:w,key:A,ref:Q,props:D,_owner:J.current}}function _e(w,O){return{$$typeof:s,type:w.type,key:O,ref:w.ref,props:w.props,_owner:w._owner}}function ae(w){return typeof w=="object"&&w!==null&&w.$$typeof===s}function ie(w){var O={"=":"=0",":":"=2"};return"$"+w.replace(/[=:]/g,function(ee){return O[ee]})}var ve=/\/+/g;function fe(w,O){return typeof w=="object"&&w!==null&&w.key!=null?ie(""+w.key):O.toString(36)}function Me(w,O,ee,ke,D){var A=typeof w;(A==="undefined"||A==="boolean")&&(w=null);var Q=!1;if(w===null)Q=!0;else switch(A){case"string":case"number":Q=!0;break;case"object":switch(w.$$typeof){case s:case t:Q=!0}}if(Q)return Q=w,D=D(Q),w=ke===""?"."+fe(Q,0):ke,he(D)?(ee="",w!=null&&(ee=w.replace(ve,"$&/")+"/"),Me(D,O,ee,"",function(ye){return ye})):D!=null&&(ae(D)&&(D=_e(D,ee+(!D.key||Q&&Q.key===D.key?"":(""+D.key).replace(ve,"$&/")+"/")+w)),O.push(D)),1;if(Q=0,ke=ke===""?".":ke+":",he(w))for(var j=0;j<w.length;j++){A=w[j];var K=ke+fe(A,j);Q+=Me(A,O,ee,K,D)}else if(K=v(w),typeof K=="function")for(w=K.call(w),j=0;!(A=w.next()).done;)A=A.value,K=ke+fe(A,j++),Q+=Me(A,O,ee,K,D);else if(A==="object")throw O=String(w),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(w).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.");return Q}function lt(w,O,ee){if(w==null)return w;var ke=[],D=0;return Me(w,ke,"","",function(A){return O.call(ee,A,D++)}),ke}function Qe(w){if(w._status===-1){var O=w._result;O=O(),O.then(function(ee){(w._status===0||w._status===-1)&&(w._status=1,w._result=ee)},function(ee){(w._status===0||w._status===-1)&&(w._status=2,w._result=ee)}),w._status===-1&&(w._status=0,w._result=O)}if(w._status===1)return w._result.default;throw w._result}var De={current:null},Y={transition:null},Z={ReactCurrentDispatcher:De,ReactCurrentBatchConfig:Y,ReactCurrentOwner:J};return Oe.Children={map:lt,forEach:function(w,O,ee){lt(w,function(){O.apply(this,arguments)},ee)},count:function(w){var O=0;return lt(w,function(){O++}),O},toArray:function(w){return lt(w,function(O){return O})||[]},only:function(w){if(!ae(w))throw Error("React.Children.only expected to receive a single React element child.");return w}},Oe.Component=ne,Oe.Fragment=r,Oe.Profiler=c,Oe.PureComponent=se,Oe.StrictMode=o,Oe.Suspense=g,Oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z,Oe.cloneElement=function(w,O,ee){if(w==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+w+".");var ke=M({},w.props),D=w.key,A=w.ref,Q=w._owner;if(O!=null){if(O.ref!==void 0&&(A=O.ref,Q=J.current),O.key!==void 0&&(D=""+O.key),w.type&&w.type.defaultProps)var j=w.type.defaultProps;for(K in O)We.call(O,K)&&!L.hasOwnProperty(K)&&(ke[K]=O[K]===void 0&&j!==void 0?j[K]:O[K])}var K=arguments.length-2;if(K===1)ke.children=ee;else if(1<K){j=Array(K);for(var ye=0;ye<K;ye++)j[ye]=arguments[ye+2];ke.children=j}return{$$typeof:s,type:w.type,key:D,ref:A,props:ke,_owner:Q}},Oe.createContext=function(w){return w={$$typeof:f,_currentValue:w,_currentValue2:w,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},w.Provider={$$typeof:d,_context:w},w.Consumer=w},Oe.createElement=P,Oe.createFactory=function(w){var O=P.bind(null,w);return O.type=w,O},Oe.createRef=function(){return{current:null}},Oe.forwardRef=function(w){return{$$typeof:p,render:w}},Oe.isValidElement=ae,Oe.lazy=function(w){return{$$typeof:k,_payload:{_status:-1,_result:w},_init:Qe}},Oe.memo=function(w,O){return{$$typeof:x,type:w,compare:O===void 0?null:O}},Oe.startTransition=function(w){var O=Y.transition;Y.transition={};try{w()}finally{Y.transition=O}},Oe.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},Oe.useCallback=function(w,O){return De.current.useCallback(w,O)},Oe.useContext=function(w){return De.current.useContext(w)},Oe.useDebugValue=function(){},Oe.useDeferredValue=function(w){return De.current.useDeferredValue(w)},Oe.useEffect=function(w,O){return De.current.useEffect(w,O)},Oe.useId=function(){return De.current.useId()},Oe.useImperativeHandle=function(w,O,ee){return De.current.useImperativeHandle(w,O,ee)},Oe.useInsertionEffect=function(w,O){return De.current.useInsertionEffect(w,O)},Oe.useLayoutEffect=function(w,O){return De.current.useLayoutEffect(w,O)},Oe.useMemo=function(w,O){return De.current.useMemo(w,O)},Oe.useReducer=function(w,O,ee){return De.current.useReducer(w,O,ee)},Oe.useRef=function(w){return De.current.useRef(w)},Oe.useState=function(w){return De.current.useState(w)},Oe.useSyncExternalStore=function(w,O,ee){return De.current.useSyncExternalStore(w,O,ee)},Oe.useTransition=function(){return De.current.useTransition()},Oe.version="18.2.0",Oe}var uf;function zc(){return uf||(uf=1,sc.exports=Yg()),sc.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var df;function Qg(){if(df)return Js;df=1;var s=zc(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,c=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function f(p,g,x){var k,y={},v=null,C=null;x!==void 0&&(v=""+x),g.key!==void 0&&(v=""+g.key),g.ref!==void 0&&(C=g.ref);for(k in g)o.call(g,k)&&!d.hasOwnProperty(k)&&(y[k]=g[k]);if(p&&p.defaultProps)for(k in g=p.defaultProps,g)y[k]===void 0&&(y[k]=g[k]);return{$$typeof:t,type:p,key:v,ref:C,props:y,_owner:c.current}}return Js.Fragment=r,Js.jsx=f,Js.jsxs=f,Js}var hf;function Gg(){return hf||(hf=1,rc.exports=Qg()),rc.exports}var a=Gg(),F=zc();const wp=_p(F);var Oo={},ic={exports:{}},$t={},oc={exports:{}},lc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ff;function Xg(){return ff||(ff=1,(function(s){function t(Y,Z){var w=Y.length;Y.push(Z);e:for(;0<w;){var O=w-1>>>1,ee=Y[O];if(0<c(ee,Z))Y[O]=Z,Y[w]=ee,w=O;else break e}}function r(Y){return Y.length===0?null:Y[0]}function o(Y){if(Y.length===0)return null;var Z=Y[0],w=Y.pop();if(w!==Z){Y[0]=w;e:for(var O=0,ee=Y.length,ke=ee>>>1;O<ke;){var D=2*(O+1)-1,A=Y[D],Q=D+1,j=Y[Q];if(0>c(A,w))Q<ee&&0>c(j,A)?(Y[O]=j,Y[Q]=w,O=Q):(Y[O]=A,Y[D]=w,O=D);else if(Q<ee&&0>c(j,w))Y[O]=j,Y[Q]=w,O=Q;else break e}}return Z}function c(Y,Z){var w=Y.sortIndex-Z.sortIndex;return w!==0?w:Y.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;s.unstable_now=function(){return d.now()}}else{var f=Date,p=f.now();s.unstable_now=function(){return f.now()-p}}var g=[],x=[],k=1,y=null,v=3,C=!1,M=!1,B=!1,ne=typeof setTimeout=="function"?setTimeout:null,ue=typeof clearTimeout=="function"?clearTimeout:null,se=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function je(Y){for(var Z=r(x);Z!==null;){if(Z.callback===null)o(x);else if(Z.startTime<=Y)o(x),Z.sortIndex=Z.expirationTime,t(g,Z);else break;Z=r(x)}}function he(Y){if(B=!1,je(Y),!M)if(r(g)!==null)M=!0,Qe(We);else{var Z=r(x);Z!==null&&De(he,Z.startTime-Y)}}function We(Y,Z){M=!1,B&&(B=!1,ue(P),P=-1),C=!0;var w=v;try{for(je(Z),y=r(g);y!==null&&(!(y.expirationTime>Z)||Y&&!ie());){var O=y.callback;if(typeof O=="function"){y.callback=null,v=y.priorityLevel;var ee=O(y.expirationTime<=Z);Z=s.unstable_now(),typeof ee=="function"?y.callback=ee:y===r(g)&&o(g),je(Z)}else o(g);y=r(g)}if(y!==null)var ke=!0;else{var D=r(x);D!==null&&De(he,D.startTime-Z),ke=!1}return ke}finally{y=null,v=w,C=!1}}var J=!1,L=null,P=-1,_e=5,ae=-1;function ie(){return!(s.unstable_now()-ae<_e)}function ve(){if(L!==null){var Y=s.unstable_now();ae=Y;var Z=!0;try{Z=L(!0,Y)}finally{Z?fe():(J=!1,L=null)}}else J=!1}var fe;if(typeof se=="function")fe=function(){se(ve)};else if(typeof MessageChannel<"u"){var Me=new MessageChannel,lt=Me.port2;Me.port1.onmessage=ve,fe=function(){lt.postMessage(null)}}else fe=function(){ne(ve,0)};function Qe(Y){L=Y,J||(J=!0,fe())}function De(Y,Z){P=ne(function(){Y(s.unstable_now())},Z)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Y){Y.callback=null},s.unstable_continueExecution=function(){M||C||(M=!0,Qe(We))},s.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_e=0<Y?Math.floor(1e3/Y):5},s.unstable_getCurrentPriorityLevel=function(){return v},s.unstable_getFirstCallbackNode=function(){return r(g)},s.unstable_next=function(Y){switch(v){case 1:case 2:case 3:var Z=3;break;default:Z=v}var w=v;v=Z;try{return Y()}finally{v=w}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(Y,Z){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var w=v;v=Y;try{return Z()}finally{v=w}},s.unstable_scheduleCallback=function(Y,Z,w){var O=s.unstable_now();switch(typeof w=="object"&&w!==null?(w=w.delay,w=typeof w=="number"&&0<w?O+w:O):w=O,Y){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=w+ee,Y={id:k++,callback:Z,priorityLevel:Y,startTime:w,expirationTime:ee,sortIndex:-1},w>O?(Y.sortIndex=w,t(x,Y),r(g)===null&&Y===r(x)&&(B?(ue(P),P=-1):B=!0,De(he,w-O))):(Y.sortIndex=ee,t(g,Y),M||C||(M=!0,Qe(We))),Y},s.unstable_shouldYield=ie,s.unstable_wrapCallback=function(Y){var Z=v;return function(){var w=v;v=Z;try{return Y.apply(this,arguments)}finally{v=w}}}})(lc)),lc}var pf;function qg(){return pf||(pf=1,oc.exports=Xg()),oc.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mf;function Kg(){if(mf)return $t;mf=1;var s=zc(),t=qg();function r(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)n+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,c={};function d(e,n){f(e,n),f(e+"Capture",n)}function f(e,n){for(c[e]=n,e=0;e<n.length;e++)o.add(n[e])}var p=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),g=Object.prototype.hasOwnProperty,x=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,k={},y={};function v(e){return g.call(y,e)?!0:g.call(k,e)?!1:x.test(e)?y[e]=!0:(k[e]=!0,!1)}function C(e,n,i,l){if(i!==null&&i.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return l?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function M(e,n,i,l){if(n===null||typeof n>"u"||C(e,n,i,l))return!0;if(l)return!1;if(i!==null)switch(i.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function B(e,n,i,l,u,h,m){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=l,this.attributeNamespace=u,this.mustUseProperty=i,this.propertyName=e,this.type=n,this.sanitizeURL=h,this.removeEmptyString=m}var ne={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ne[e]=new B(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];ne[n]=new B(n,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){ne[e]=new B(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ne[e]=new B(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ne[e]=new B(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){ne[e]=new B(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){ne[e]=new B(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){ne[e]=new B(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){ne[e]=new B(e,5,!1,e.toLowerCase(),null,!1,!1)});var ue=/[\-:]([a-z])/g;function se(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(ue,se);ne[n]=new B(n,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(ue,se);ne[n]=new B(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(ue,se);ne[n]=new B(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){ne[e]=new B(e,1,!1,e.toLowerCase(),null,!1,!1)}),ne.xlinkHref=new B("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){ne[e]=new B(e,1,!1,e.toLowerCase(),null,!0,!0)});function je(e,n,i,l){var u=ne.hasOwnProperty(n)?ne[n]:null;(u!==null?u.type!==0:l||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(M(n,i,u,l)&&(i=null),l||u===null?v(n)&&(i===null?e.removeAttribute(n):e.setAttribute(n,""+i)):u.mustUseProperty?e[u.propertyName]=i===null?u.type===3?!1:"":i:(n=u.attributeName,l=u.attributeNamespace,i===null?e.removeAttribute(n):(u=u.type,i=u===3||u===4&&i===!0?"":""+i,l?e.setAttributeNS(l,n,i):e.setAttribute(n,i))))}var he=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,We=Symbol.for("react.element"),J=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),_e=Symbol.for("react.profiler"),ae=Symbol.for("react.provider"),ie=Symbol.for("react.context"),ve=Symbol.for("react.forward_ref"),fe=Symbol.for("react.suspense"),Me=Symbol.for("react.suspense_list"),lt=Symbol.for("react.memo"),Qe=Symbol.for("react.lazy"),De=Symbol.for("react.offscreen"),Y=Symbol.iterator;function Z(e){return e===null||typeof e!="object"?null:(e=Y&&e[Y]||e["@@iterator"],typeof e=="function"?e:null)}var w=Object.assign,O;function ee(e){if(O===void 0)try{throw Error()}catch(i){var n=i.stack.trim().match(/\n( *(at )?)/);O=n&&n[1]||""}return`
`+O+e}var ke=!1;function D(e,n){if(!e||ke)return"";ke=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(R){var l=R}Reflect.construct(e,[],n)}else{try{n.call()}catch(R){l=R}e.call(n.prototype)}else{try{throw Error()}catch(R){l=R}e()}}catch(R){if(R&&l&&typeof R.stack=="string"){for(var u=R.stack.split(`
`),h=l.stack.split(`
`),m=u.length-1,_=h.length-1;1<=m&&0<=_&&u[m]!==h[_];)_--;for(;1<=m&&0<=_;m--,_--)if(u[m]!==h[_]){if(m!==1||_!==1)do if(m--,_--,0>_||u[m]!==h[_]){var b=`
`+u[m].replace(" at new "," at ");return e.displayName&&b.includes("<anonymous>")&&(b=b.replace("<anonymous>",e.displayName)),b}while(1<=m&&0<=_);break}}}finally{ke=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?ee(e):""}function A(e){switch(e.tag){case 5:return ee(e.type);case 16:return ee("Lazy");case 13:return ee("Suspense");case 19:return ee("SuspenseList");case 0:case 2:case 15:return e=D(e.type,!1),e;case 11:return e=D(e.type.render,!1),e;case 1:return e=D(e.type,!0),e;default:return""}}function Q(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case L:return"Fragment";case J:return"Portal";case _e:return"Profiler";case P:return"StrictMode";case fe:return"Suspense";case Me:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ie:return(e.displayName||"Context")+".Consumer";case ae:return(e._context.displayName||"Context")+".Provider";case ve:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case lt:return n=e.displayName||null,n!==null?n:Q(e.type)||"Memo";case Qe:n=e._payload,e=e._init;try{return Q(e(n))}catch{}}return null}function j(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Q(n);case 8:return n===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function K(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ye(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function $e(e){var n=ye(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),l=""+e[n];if(!e.hasOwnProperty(n)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var u=i.get,h=i.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return u.call(this)},set:function(m){l=""+m,h.call(this,m)}}),Object.defineProperty(e,n,{enumerable:i.enumerable}),{getValue:function(){return l},setValue:function(m){l=""+m},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function T(e){e._valueTracker||(e._valueTracker=$e(e))}function H(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var i=n.getValue(),l="";return e&&(l=ye(e)?e.checked?"true":"false":e.value),e=l,e!==i?(n.setValue(e),!0):!1}function ce(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function S(e,n){var i=n.checked;return w({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function te(e,n){var i=n.defaultValue==null?"":n.defaultValue,l=n.checked!=null?n.checked:n.defaultChecked;i=K(n.value!=null?n.value:i),e._wrapperState={initialChecked:l,initialValue:i,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function pe(e,n){n=n.checked,n!=null&&je(e,"checked",n,!1)}function Ie(e,n){pe(e,n);var i=K(n.value),l=n.type;if(i!=null)l==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?ze(e,n.type,i):n.hasOwnProperty("defaultValue")&&ze(e,n.type,K(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function Ee(e,n,i){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var l=n.type;if(!(l!=="submit"&&l!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,i||n===e.value||(e.value=n),e.defaultValue=n}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function ze(e,n,i){(n!=="number"||ce(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var Re=Array.isArray;function Ge(e,n,i,l){if(e=e.options,n){n={};for(var u=0;u<i.length;u++)n["$"+i[u]]=!0;for(i=0;i<e.length;i++)u=n.hasOwnProperty("$"+e[i].value),e[i].selected!==u&&(e[i].selected=u),u&&l&&(e[i].defaultSelected=!0)}else{for(i=""+K(i),n=null,u=0;u<e.length;u++){if(e[u].value===i){e[u].selected=!0,l&&(e[u].defaultSelected=!0);return}n!==null||e[u].disabled||(n=e[u])}n!==null&&(n.selected=!0)}}function st(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(r(91));return w({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function $(e,n){var i=n.value;if(i==null){if(i=n.children,n=n.defaultValue,i!=null){if(n!=null)throw Error(r(92));if(Re(i)){if(1<i.length)throw Error(r(93));i=i[0]}n=i}n==null&&(n=""),i=n}e._wrapperState={initialValue:K(i)}}function oe(e,n){var i=K(n.value),l=K(n.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),n.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),l!=null&&(e.defaultValue=""+l)}function we(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function X(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function U(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?X(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var xe,Te=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,i,l,u){MSApp.execUnsafeLocalFunction(function(){return e(n,i,l,u)})}:e})(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(xe=xe||document.createElement("div"),xe.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=xe.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function Be(e,n){if(n){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=n;return}}e.textContent=n}var Ue={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nn=["Webkit","ms","Moz","O"];Object.keys(Ue).forEach(function(e){nn.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),Ue[n]=Ue[e]})});function Vt(e,n,i){return n==null||typeof n=="boolean"||n===""?"":i||typeof n!="number"||n===0||Ue.hasOwnProperty(e)&&Ue[e]?(""+n).trim():n+"px"}function lr(e,n){e=e.style;for(var i in n)if(n.hasOwnProperty(i)){var l=i.indexOf("--")===0,u=Vt(i,n[i],l);i==="float"&&(i="cssFloat"),l?e.setProperty(i,u):e[i]=u}}var ar=w({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ml(e,n){if(n){if(ar[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(r(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(r(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(r(61))}if(n.style!=null&&typeof n.style!="object")throw Error(r(62))}}function gl(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xl=null;function vl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yl=null,Rr=null,Pr=null;function ku(e){if(e=As(e)){if(typeof yl!="function")throw Error(r(280));var n=e.stateNode;n&&(n=qi(n),yl(e.stateNode,e.type,n))}}function Cu(e){Rr?Pr?Pr.push(e):Pr=[e]:Rr=e}function Su(){if(Rr){var e=Rr,n=Pr;if(Pr=Rr=null,ku(e),n)for(e=0;e<n.length;e++)ku(n[e])}}function ju(e,n){return e(n)}function Eu(){}var _l=!1;function Iu(e,n,i){if(_l)return e(n,i);_l=!0;try{return ju(e,n,i)}finally{_l=!1,(Rr!==null||Pr!==null)&&(Eu(),Su())}}function gs(e,n){var i=e.stateNode;if(i===null)return null;var l=qi(i);if(l===null)return null;i=l[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(r(231,n,typeof i));return i}var wl=!1;if(p)try{var xs={};Object.defineProperty(xs,"passive",{get:function(){wl=!0}}),window.addEventListener("test",xs,xs),window.removeEventListener("test",xs,xs)}catch{wl=!1}function Jm(e,n,i,l,u,h,m,_,b){var R=Array.prototype.slice.call(arguments,3);try{n.apply(i,R)}catch(W){this.onError(W)}}var vs=!1,Ei=null,Ii=!1,bl=null,Zm={onError:function(e){vs=!0,Ei=e}};function e0(e,n,i,l,u,h,m,_,b){vs=!1,Ei=null,Jm.apply(Zm,arguments)}function t0(e,n,i,l,u,h,m,_,b){if(e0.apply(this,arguments),vs){if(vs){var R=Ei;vs=!1,Ei=null}else throw Error(r(198));Ii||(Ii=!0,bl=R)}}function cr(e){var n=e,i=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(i=n.return),e=n.return;while(e)}return n.tag===3?i:null}function Tu(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function Ru(e){if(cr(e)!==e)throw Error(r(188))}function n0(e){var n=e.alternate;if(!n){if(n=cr(e),n===null)throw Error(r(188));return n!==e?null:e}for(var i=e,l=n;;){var u=i.return;if(u===null)break;var h=u.alternate;if(h===null){if(l=u.return,l!==null){i=l;continue}break}if(u.child===h.child){for(h=u.child;h;){if(h===i)return Ru(u),e;if(h===l)return Ru(u),n;h=h.sibling}throw Error(r(188))}if(i.return!==l.return)i=u,l=h;else{for(var m=!1,_=u.child;_;){if(_===i){m=!0,i=u,l=h;break}if(_===l){m=!0,l=u,i=h;break}_=_.sibling}if(!m){for(_=h.child;_;){if(_===i){m=!0,i=h,l=u;break}if(_===l){m=!0,l=h,i=u;break}_=_.sibling}if(!m)throw Error(r(189))}}if(i.alternate!==l)throw Error(r(190))}if(i.tag!==3)throw Error(r(188));return i.stateNode.current===i?e:n}function Pu(e){return e=n0(e),e!==null?Lu(e):null}function Lu(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=Lu(e);if(n!==null)return n;e=e.sibling}return null}var Mu=t.unstable_scheduleCallback,Du=t.unstable_cancelCallback,r0=t.unstable_shouldYield,s0=t.unstable_requestPaint,ut=t.unstable_now,i0=t.unstable_getCurrentPriorityLevel,Nl=t.unstable_ImmediatePriority,Ou=t.unstable_UserBlockingPriority,Ti=t.unstable_NormalPriority,o0=t.unstable_LowPriority,Au=t.unstable_IdlePriority,Ri=null,gn=null;function l0(e){if(gn&&typeof gn.onCommitFiberRoot=="function")try{gn.onCommitFiberRoot(Ri,e,void 0,(e.current.flags&128)===128)}catch{}}var rn=Math.clz32?Math.clz32:u0,a0=Math.log,c0=Math.LN2;function u0(e){return e>>>=0,e===0?32:31-(a0(e)/c0|0)|0}var Pi=64,Li=4194304;function ys(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Mi(e,n){var i=e.pendingLanes;if(i===0)return 0;var l=0,u=e.suspendedLanes,h=e.pingedLanes,m=i&268435455;if(m!==0){var _=m&~u;_!==0?l=ys(_):(h&=m,h!==0&&(l=ys(h)))}else m=i&~u,m!==0?l=ys(m):h!==0&&(l=ys(h));if(l===0)return 0;if(n!==0&&n!==l&&(n&u)===0&&(u=l&-l,h=n&-n,u>=h||u===16&&(h&4194240)!==0))return n;if((l&4)!==0&&(l|=i&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=l;0<n;)i=31-rn(n),u=1<<i,l|=e[i],n&=~u;return l}function d0(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function h0(e,n){for(var i=e.suspendedLanes,l=e.pingedLanes,u=e.expirationTimes,h=e.pendingLanes;0<h;){var m=31-rn(h),_=1<<m,b=u[m];b===-1?((_&i)===0||(_&l)!==0)&&(u[m]=d0(_,n)):b<=n&&(e.expiredLanes|=_),h&=~_}}function kl(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Fu(){var e=Pi;return Pi<<=1,(Pi&4194240)===0&&(Pi=64),e}function Cl(e){for(var n=[],i=0;31>i;i++)n.push(e);return n}function _s(e,n,i){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-rn(n),e[n]=i}function f0(e,n){var i=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<i;){var u=31-rn(i),h=1<<u;n[u]=0,l[u]=-1,e[u]=-1,i&=~h}}function Sl(e,n){var i=e.entangledLanes|=n;for(e=e.entanglements;i;){var l=31-rn(i),u=1<<l;u&n|e[l]&n&&(e[l]|=n),i&=~u}}var Xe=0;function $u(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var zu,jl,Uu,Wu,Bu,El=!1,Di=[],Dn=null,On=null,An=null,ws=new Map,bs=new Map,Fn=[],p0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hu(e,n){switch(e){case"focusin":case"focusout":Dn=null;break;case"dragenter":case"dragleave":On=null;break;case"mouseover":case"mouseout":An=null;break;case"pointerover":case"pointerout":ws.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":bs.delete(n.pointerId)}}function Ns(e,n,i,l,u,h){return e===null||e.nativeEvent!==h?(e={blockedOn:n,domEventName:i,eventSystemFlags:l,nativeEvent:h,targetContainers:[u]},n!==null&&(n=As(n),n!==null&&jl(n)),e):(e.eventSystemFlags|=l,n=e.targetContainers,u!==null&&n.indexOf(u)===-1&&n.push(u),e)}function m0(e,n,i,l,u){switch(n){case"focusin":return Dn=Ns(Dn,e,n,i,l,u),!0;case"dragenter":return On=Ns(On,e,n,i,l,u),!0;case"mouseover":return An=Ns(An,e,n,i,l,u),!0;case"pointerover":var h=u.pointerId;return ws.set(h,Ns(ws.get(h)||null,e,n,i,l,u)),!0;case"gotpointercapture":return h=u.pointerId,bs.set(h,Ns(bs.get(h)||null,e,n,i,l,u)),!0}return!1}function Vu(e){var n=ur(e.target);if(n!==null){var i=cr(n);if(i!==null){if(n=i.tag,n===13){if(n=Tu(i),n!==null){e.blockedOn=n,Bu(e.priority,function(){Uu(i)});return}}else if(n===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Oi(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var i=Tl(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var l=new i.constructor(i.type,i);xl=l,i.target.dispatchEvent(l),xl=null}else return n=As(i),n!==null&&jl(n),e.blockedOn=i,!1;n.shift()}return!0}function Yu(e,n,i){Oi(e)&&i.delete(n)}function g0(){El=!1,Dn!==null&&Oi(Dn)&&(Dn=null),On!==null&&Oi(On)&&(On=null),An!==null&&Oi(An)&&(An=null),ws.forEach(Yu),bs.forEach(Yu)}function ks(e,n){e.blockedOn===n&&(e.blockedOn=null,El||(El=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,g0)))}function Cs(e){function n(u){return ks(u,e)}if(0<Di.length){ks(Di[0],e);for(var i=1;i<Di.length;i++){var l=Di[i];l.blockedOn===e&&(l.blockedOn=null)}}for(Dn!==null&&ks(Dn,e),On!==null&&ks(On,e),An!==null&&ks(An,e),ws.forEach(n),bs.forEach(n),i=0;i<Fn.length;i++)l=Fn[i],l.blockedOn===e&&(l.blockedOn=null);for(;0<Fn.length&&(i=Fn[0],i.blockedOn===null);)Vu(i),i.blockedOn===null&&Fn.shift()}var Lr=he.ReactCurrentBatchConfig,Ai=!0;function x0(e,n,i,l){var u=Xe,h=Lr.transition;Lr.transition=null;try{Xe=1,Il(e,n,i,l)}finally{Xe=u,Lr.transition=h}}function v0(e,n,i,l){var u=Xe,h=Lr.transition;Lr.transition=null;try{Xe=4,Il(e,n,i,l)}finally{Xe=u,Lr.transition=h}}function Il(e,n,i,l){if(Ai){var u=Tl(e,n,i,l);if(u===null)Ql(e,n,l,Fi,i),Hu(e,l);else if(m0(u,e,n,i,l))l.stopPropagation();else if(Hu(e,l),n&4&&-1<p0.indexOf(e)){for(;u!==null;){var h=As(u);if(h!==null&&zu(h),h=Tl(e,n,i,l),h===null&&Ql(e,n,l,Fi,i),h===u)break;u=h}u!==null&&l.stopPropagation()}else Ql(e,n,l,null,i)}}var Fi=null;function Tl(e,n,i,l){if(Fi=null,e=vl(l),e=ur(e),e!==null)if(n=cr(e),n===null)e=null;else if(i=n.tag,i===13){if(e=Tu(n),e!==null)return e;e=null}else if(i===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Fi=e,null}function Qu(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(i0()){case Nl:return 1;case Ou:return 4;case Ti:case o0:return 16;case Au:return 536870912;default:return 16}default:return 16}}var $n=null,Rl=null,$i=null;function Gu(){if($i)return $i;var e,n=Rl,i=n.length,l,u="value"in $n?$n.value:$n.textContent,h=u.length;for(e=0;e<i&&n[e]===u[e];e++);var m=i-e;for(l=1;l<=m&&n[i-l]===u[h-l];l++);return $i=u.slice(e,1<l?1-l:void 0)}function zi(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Ui(){return!0}function Xu(){return!1}function Yt(e){function n(i,l,u,h,m){this._reactName=i,this._targetInst=u,this.type=l,this.nativeEvent=h,this.target=m,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(i=e[_],this[_]=i?i(h):h[_]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?Ui:Xu,this.isPropagationStopped=Xu,this}return w(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=Ui)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=Ui)},persist:function(){},isPersistent:Ui}),n}var Mr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pl=Yt(Mr),Ss=w({},Mr,{view:0,detail:0}),y0=Yt(Ss),Ll,Ml,js,Wi=w({},Ss,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ol,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==js&&(js&&e.type==="mousemove"?(Ll=e.screenX-js.screenX,Ml=e.screenY-js.screenY):Ml=Ll=0,js=e),Ll)},movementY:function(e){return"movementY"in e?e.movementY:Ml}}),qu=Yt(Wi),_0=w({},Wi,{dataTransfer:0}),w0=Yt(_0),b0=w({},Ss,{relatedTarget:0}),Dl=Yt(b0),N0=w({},Mr,{animationName:0,elapsedTime:0,pseudoElement:0}),k0=Yt(N0),C0=w({},Mr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),S0=Yt(C0),j0=w({},Mr,{data:0}),Ku=Yt(j0),E0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},I0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},T0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function R0(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=T0[e])?!!n[e]:!1}function Ol(){return R0}var P0=w({},Ss,{key:function(e){if(e.key){var n=E0[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=zi(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?I0[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ol,charCode:function(e){return e.type==="keypress"?zi(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?zi(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),L0=Yt(P0),M0=w({},Wi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ju=Yt(M0),D0=w({},Ss,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ol}),O0=Yt(D0),A0=w({},Mr,{propertyName:0,elapsedTime:0,pseudoElement:0}),F0=Yt(A0),$0=w({},Wi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),z0=Yt($0),U0=[9,13,27,32],Al=p&&"CompositionEvent"in window,Es=null;p&&"documentMode"in document&&(Es=document.documentMode);var W0=p&&"TextEvent"in window&&!Es,Zu=p&&(!Al||Es&&8<Es&&11>=Es),ed=" ",td=!1;function nd(e,n){switch(e){case"keyup":return U0.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Dr=!1;function B0(e,n){switch(e){case"compositionend":return rd(n);case"keypress":return n.which!==32?null:(td=!0,ed);case"textInput":return e=n.data,e===ed&&td?null:e;default:return null}}function H0(e,n){if(Dr)return e==="compositionend"||!Al&&nd(e,n)?(e=Gu(),$i=Rl=$n=null,Dr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Zu&&n.locale!=="ko"?null:n.data;default:return null}}var V0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sd(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!V0[e.type]:n==="textarea"}function id(e,n,i,l){Cu(l),n=Qi(n,"onChange"),0<n.length&&(i=new Pl("onChange","change",null,i,l),e.push({event:i,listeners:n}))}var Is=null,Ts=null;function Y0(e){Nd(e,0)}function Bi(e){var n=zr(e);if(H(n))return e}function Q0(e,n){if(e==="change")return n}var od=!1;if(p){var Fl;if(p){var $l="oninput"in document;if(!$l){var ld=document.createElement("div");ld.setAttribute("oninput","return;"),$l=typeof ld.oninput=="function"}Fl=$l}else Fl=!1;od=Fl&&(!document.documentMode||9<document.documentMode)}function ad(){Is&&(Is.detachEvent("onpropertychange",cd),Ts=Is=null)}function cd(e){if(e.propertyName==="value"&&Bi(Ts)){var n=[];id(n,Ts,e,vl(e)),Iu(Y0,n)}}function G0(e,n,i){e==="focusin"?(ad(),Is=n,Ts=i,Is.attachEvent("onpropertychange",cd)):e==="focusout"&&ad()}function X0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Bi(Ts)}function q0(e,n){if(e==="click")return Bi(n)}function K0(e,n){if(e==="input"||e==="change")return Bi(n)}function J0(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var sn=typeof Object.is=="function"?Object.is:J0;function Rs(e,n){if(sn(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var i=Object.keys(e),l=Object.keys(n);if(i.length!==l.length)return!1;for(l=0;l<i.length;l++){var u=i[l];if(!g.call(n,u)||!sn(e[u],n[u]))return!1}return!0}function ud(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dd(e,n){var i=ud(e);e=0;for(var l;i;){if(i.nodeType===3){if(l=e+i.textContent.length,e<=n&&l>=n)return{node:i,offset:n-e};e=l}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ud(i)}}function hd(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?hd(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function fd(){for(var e=window,n=ce();n instanceof e.HTMLIFrameElement;){try{var i=typeof n.contentWindow.location.href=="string"}catch{i=!1}if(i)e=n.contentWindow;else break;n=ce(e.document)}return n}function zl(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function Z0(e){var n=fd(),i=e.focusedElem,l=e.selectionRange;if(n!==i&&i&&i.ownerDocument&&hd(i.ownerDocument.documentElement,i)){if(l!==null&&zl(i)){if(n=l.start,e=l.end,e===void 0&&(e=n),"selectionStart"in i)i.selectionStart=n,i.selectionEnd=Math.min(e,i.value.length);else if(e=(n=i.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var u=i.textContent.length,h=Math.min(l.start,u);l=l.end===void 0?h:Math.min(l.end,u),!e.extend&&h>l&&(u=l,l=h,h=u),u=dd(i,h);var m=dd(i,l);u&&m&&(e.rangeCount!==1||e.anchorNode!==u.node||e.anchorOffset!==u.offset||e.focusNode!==m.node||e.focusOffset!==m.offset)&&(n=n.createRange(),n.setStart(u.node,u.offset),e.removeAllRanges(),h>l?(e.addRange(n),e.extend(m.node,m.offset)):(n.setEnd(m.node,m.offset),e.addRange(n)))}}for(n=[],e=i;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<n.length;i++)e=n[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var eg=p&&"documentMode"in document&&11>=document.documentMode,Or=null,Ul=null,Ps=null,Wl=!1;function pd(e,n,i){var l=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Wl||Or==null||Or!==ce(l)||(l=Or,"selectionStart"in l&&zl(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Ps&&Rs(Ps,l)||(Ps=l,l=Qi(Ul,"onSelect"),0<l.length&&(n=new Pl("onSelect","select",null,n,i),e.push({event:n,listeners:l}),n.target=Or)))}function Hi(e,n){var i={};return i[e.toLowerCase()]=n.toLowerCase(),i["Webkit"+e]="webkit"+n,i["Moz"+e]="moz"+n,i}var Ar={animationend:Hi("Animation","AnimationEnd"),animationiteration:Hi("Animation","AnimationIteration"),animationstart:Hi("Animation","AnimationStart"),transitionend:Hi("Transition","TransitionEnd")},Bl={},md={};p&&(md=document.createElement("div").style,"AnimationEvent"in window||(delete Ar.animationend.animation,delete Ar.animationiteration.animation,delete Ar.animationstart.animation),"TransitionEvent"in window||delete Ar.transitionend.transition);function Vi(e){if(Bl[e])return Bl[e];if(!Ar[e])return e;var n=Ar[e],i;for(i in n)if(n.hasOwnProperty(i)&&i in md)return Bl[e]=n[i];return e}var gd=Vi("animationend"),xd=Vi("animationiteration"),vd=Vi("animationstart"),yd=Vi("transitionend"),_d=new Map,wd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zn(e,n){_d.set(e,n),d(n,[e])}for(var Hl=0;Hl<wd.length;Hl++){var Vl=wd[Hl],tg=Vl.toLowerCase(),ng=Vl[0].toUpperCase()+Vl.slice(1);zn(tg,"on"+ng)}zn(gd,"onAnimationEnd"),zn(xd,"onAnimationIteration"),zn(vd,"onAnimationStart"),zn("dblclick","onDoubleClick"),zn("focusin","onFocus"),zn("focusout","onBlur"),zn(yd,"onTransitionEnd"),f("onMouseEnter",["mouseout","mouseover"]),f("onMouseLeave",["mouseout","mouseover"]),f("onPointerEnter",["pointerout","pointerover"]),f("onPointerLeave",["pointerout","pointerover"]),d("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),d("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),d("onBeforeInput",["compositionend","keypress","textInput","paste"]),d("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ls="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rg=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ls));function bd(e,n,i){var l=e.type||"unknown-event";e.currentTarget=i,t0(l,n,void 0,e),e.currentTarget=null}function Nd(e,n){n=(n&4)!==0;for(var i=0;i<e.length;i++){var l=e[i],u=l.event;l=l.listeners;e:{var h=void 0;if(n)for(var m=l.length-1;0<=m;m--){var _=l[m],b=_.instance,R=_.currentTarget;if(_=_.listener,b!==h&&u.isPropagationStopped())break e;bd(u,_,R),h=b}else for(m=0;m<l.length;m++){if(_=l[m],b=_.instance,R=_.currentTarget,_=_.listener,b!==h&&u.isPropagationStopped())break e;bd(u,_,R),h=b}}}if(Ii)throw e=bl,Ii=!1,bl=null,e}function et(e,n){var i=n[Zl];i===void 0&&(i=n[Zl]=new Set);var l=e+"__bubble";i.has(l)||(kd(n,e,2,!1),i.add(l))}function Yl(e,n,i){var l=0;n&&(l|=4),kd(i,e,l,n)}var Yi="_reactListening"+Math.random().toString(36).slice(2);function Ms(e){if(!e[Yi]){e[Yi]=!0,o.forEach(function(i){i!=="selectionchange"&&(rg.has(i)||Yl(i,!1,e),Yl(i,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Yi]||(n[Yi]=!0,Yl("selectionchange",!1,n))}}function kd(e,n,i,l){switch(Qu(n)){case 1:var u=x0;break;case 4:u=v0;break;default:u=Il}i=u.bind(null,n,i,e),u=void 0,!wl||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(u=!0),l?u!==void 0?e.addEventListener(n,i,{capture:!0,passive:u}):e.addEventListener(n,i,!0):u!==void 0?e.addEventListener(n,i,{passive:u}):e.addEventListener(n,i,!1)}function Ql(e,n,i,l,u){var h=l;if((n&1)===0&&(n&2)===0&&l!==null)e:for(;;){if(l===null)return;var m=l.tag;if(m===3||m===4){var _=l.stateNode.containerInfo;if(_===u||_.nodeType===8&&_.parentNode===u)break;if(m===4)for(m=l.return;m!==null;){var b=m.tag;if((b===3||b===4)&&(b=m.stateNode.containerInfo,b===u||b.nodeType===8&&b.parentNode===u))return;m=m.return}for(;_!==null;){if(m=ur(_),m===null)return;if(b=m.tag,b===5||b===6){l=h=m;continue e}_=_.parentNode}}l=l.return}Iu(function(){var R=h,W=vl(i),V=[];e:{var z=_d.get(e);if(z!==void 0){var re=Pl,de=e;switch(e){case"keypress":if(zi(i)===0)break e;case"keydown":case"keyup":re=L0;break;case"focusin":de="focus",re=Dl;break;case"focusout":de="blur",re=Dl;break;case"beforeblur":case"afterblur":re=Dl;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":re=qu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":re=w0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":re=O0;break;case gd:case xd:case vd:re=k0;break;case yd:re=F0;break;case"scroll":re=y0;break;case"wheel":re=z0;break;case"copy":case"cut":case"paste":re=S0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":re=Ju}var me=(n&4)!==0,dt=!me&&e==="scroll",E=me?z!==null?z+"Capture":null:z;me=[];for(var N=R,I;N!==null;){I=N;var G=I.stateNode;if(I.tag===5&&G!==null&&(I=G,E!==null&&(G=gs(N,E),G!=null&&me.push(Ds(N,G,I)))),dt)break;N=N.return}0<me.length&&(z=new re(z,de,null,i,W),V.push({event:z,listeners:me}))}}if((n&7)===0){e:{if(z=e==="mouseover"||e==="pointerover",re=e==="mouseout"||e==="pointerout",z&&i!==xl&&(de=i.relatedTarget||i.fromElement)&&(ur(de)||de[wn]))break e;if((re||z)&&(z=W.window===W?W:(z=W.ownerDocument)?z.defaultView||z.parentWindow:window,re?(de=i.relatedTarget||i.toElement,re=R,de=de?ur(de):null,de!==null&&(dt=cr(de),de!==dt||de.tag!==5&&de.tag!==6)&&(de=null)):(re=null,de=R),re!==de)){if(me=qu,G="onMouseLeave",E="onMouseEnter",N="mouse",(e==="pointerout"||e==="pointerover")&&(me=Ju,G="onPointerLeave",E="onPointerEnter",N="pointer"),dt=re==null?z:zr(re),I=de==null?z:zr(de),z=new me(G,N+"leave",re,i,W),z.target=dt,z.relatedTarget=I,G=null,ur(W)===R&&(me=new me(E,N+"enter",de,i,W),me.target=I,me.relatedTarget=dt,G=me),dt=G,re&&de)t:{for(me=re,E=de,N=0,I=me;I;I=Fr(I))N++;for(I=0,G=E;G;G=Fr(G))I++;for(;0<N-I;)me=Fr(me),N--;for(;0<I-N;)E=Fr(E),I--;for(;N--;){if(me===E||E!==null&&me===E.alternate)break t;me=Fr(me),E=Fr(E)}me=null}else me=null;re!==null&&Cd(V,z,re,me,!1),de!==null&&dt!==null&&Cd(V,dt,de,me,!0)}}e:{if(z=R?zr(R):window,re=z.nodeName&&z.nodeName.toLowerCase(),re==="select"||re==="input"&&z.type==="file")var ge=Q0;else if(sd(z))if(od)ge=K0;else{ge=X0;var be=G0}else(re=z.nodeName)&&re.toLowerCase()==="input"&&(z.type==="checkbox"||z.type==="radio")&&(ge=q0);if(ge&&(ge=ge(e,R))){id(V,ge,i,W);break e}be&&be(e,z,R),e==="focusout"&&(be=z._wrapperState)&&be.controlled&&z.type==="number"&&ze(z,"number",z.value)}switch(be=R?zr(R):window,e){case"focusin":(sd(be)||be.contentEditable==="true")&&(Or=be,Ul=R,Ps=null);break;case"focusout":Ps=Ul=Or=null;break;case"mousedown":Wl=!0;break;case"contextmenu":case"mouseup":case"dragend":Wl=!1,pd(V,i,W);break;case"selectionchange":if(eg)break;case"keydown":case"keyup":pd(V,i,W)}var Ne;if(Al)e:{switch(e){case"compositionstart":var Se="onCompositionStart";break e;case"compositionend":Se="onCompositionEnd";break e;case"compositionupdate":Se="onCompositionUpdate";break e}Se=void 0}else Dr?nd(e,i)&&(Se="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(Se="onCompositionStart");Se&&(Zu&&i.locale!=="ko"&&(Dr||Se!=="onCompositionStart"?Se==="onCompositionEnd"&&Dr&&(Ne=Gu()):($n=W,Rl="value"in $n?$n.value:$n.textContent,Dr=!0)),be=Qi(R,Se),0<be.length&&(Se=new Ku(Se,e,null,i,W),V.push({event:Se,listeners:be}),Ne?Se.data=Ne:(Ne=rd(i),Ne!==null&&(Se.data=Ne)))),(Ne=W0?B0(e,i):H0(e,i))&&(R=Qi(R,"onBeforeInput"),0<R.length&&(W=new Ku("onBeforeInput","beforeinput",null,i,W),V.push({event:W,listeners:R}),W.data=Ne))}Nd(V,n)})}function Ds(e,n,i){return{instance:e,listener:n,currentTarget:i}}function Qi(e,n){for(var i=n+"Capture",l=[];e!==null;){var u=e,h=u.stateNode;u.tag===5&&h!==null&&(u=h,h=gs(e,i),h!=null&&l.unshift(Ds(e,h,u)),h=gs(e,n),h!=null&&l.push(Ds(e,h,u))),e=e.return}return l}function Fr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Cd(e,n,i,l,u){for(var h=n._reactName,m=[];i!==null&&i!==l;){var _=i,b=_.alternate,R=_.stateNode;if(b!==null&&b===l)break;_.tag===5&&R!==null&&(_=R,u?(b=gs(i,h),b!=null&&m.unshift(Ds(i,b,_))):u||(b=gs(i,h),b!=null&&m.push(Ds(i,b,_)))),i=i.return}m.length!==0&&e.push({event:n,listeners:m})}var sg=/\r\n?/g,ig=/\u0000|\uFFFD/g;function Sd(e){return(typeof e=="string"?e:""+e).replace(sg,`
`).replace(ig,"")}function Gi(e,n,i){if(n=Sd(n),Sd(e)!==n&&i)throw Error(r(425))}function Xi(){}var Gl=null,Xl=null;function ql(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Kl=typeof setTimeout=="function"?setTimeout:void 0,og=typeof clearTimeout=="function"?clearTimeout:void 0,jd=typeof Promise=="function"?Promise:void 0,lg=typeof queueMicrotask=="function"?queueMicrotask:typeof jd<"u"?function(e){return jd.resolve(null).then(e).catch(ag)}:Kl;function ag(e){setTimeout(function(){throw e})}function Jl(e,n){var i=n,l=0;do{var u=i.nextSibling;if(e.removeChild(i),u&&u.nodeType===8)if(i=u.data,i==="/$"){if(l===0){e.removeChild(u),Cs(n);return}l--}else i!=="$"&&i!=="$?"&&i!=="$!"||l++;i=u}while(i);Cs(n)}function Un(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function Ed(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(n===0)return e;n--}else i==="/$"&&n++}e=e.previousSibling}return null}var $r=Math.random().toString(36).slice(2),xn="__reactFiber$"+$r,Os="__reactProps$"+$r,wn="__reactContainer$"+$r,Zl="__reactEvents$"+$r,cg="__reactListeners$"+$r,ug="__reactHandles$"+$r;function ur(e){var n=e[xn];if(n)return n;for(var i=e.parentNode;i;){if(n=i[wn]||i[xn]){if(i=n.alternate,n.child!==null||i!==null&&i.child!==null)for(e=Ed(e);e!==null;){if(i=e[xn])return i;e=Ed(e)}return n}e=i,i=e.parentNode}return null}function As(e){return e=e[xn]||e[wn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function zr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(r(33))}function qi(e){return e[Os]||null}var ea=[],Ur=-1;function Wn(e){return{current:e}}function tt(e){0>Ur||(e.current=ea[Ur],ea[Ur]=null,Ur--)}function Ke(e,n){Ur++,ea[Ur]=e.current,e.current=n}var Bn={},jt=Wn(Bn),Mt=Wn(!1),dr=Bn;function Wr(e,n){var i=e.type.contextTypes;if(!i)return Bn;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===n)return l.__reactInternalMemoizedMaskedChildContext;var u={},h;for(h in i)u[h]=n[h];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=u),u}function Dt(e){return e=e.childContextTypes,e!=null}function Ki(){tt(Mt),tt(jt)}function Id(e,n,i){if(jt.current!==Bn)throw Error(r(168));Ke(jt,n),Ke(Mt,i)}function Td(e,n,i){var l=e.stateNode;if(n=n.childContextTypes,typeof l.getChildContext!="function")return i;l=l.getChildContext();for(var u in l)if(!(u in n))throw Error(r(108,j(e)||"Unknown",u));return w({},i,l)}function Ji(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Bn,dr=jt.current,Ke(jt,e),Ke(Mt,Mt.current),!0}function Rd(e,n,i){var l=e.stateNode;if(!l)throw Error(r(169));i?(e=Td(e,n,dr),l.__reactInternalMemoizedMergedChildContext=e,tt(Mt),tt(jt),Ke(jt,e)):tt(Mt),Ke(Mt,i)}var bn=null,Zi=!1,ta=!1;function Pd(e){bn===null?bn=[e]:bn.push(e)}function dg(e){Zi=!0,Pd(e)}function Hn(){if(!ta&&bn!==null){ta=!0;var e=0,n=Xe;try{var i=bn;for(Xe=1;e<i.length;e++){var l=i[e];do l=l(!0);while(l!==null)}bn=null,Zi=!1}catch(u){throw bn!==null&&(bn=bn.slice(e+1)),Mu(Nl,Hn),u}finally{Xe=n,ta=!1}}return null}var Br=[],Hr=0,eo=null,to=0,qt=[],Kt=0,hr=null,Nn=1,kn="";function fr(e,n){Br[Hr++]=to,Br[Hr++]=eo,eo=e,to=n}function Ld(e,n,i){qt[Kt++]=Nn,qt[Kt++]=kn,qt[Kt++]=hr,hr=e;var l=Nn;e=kn;var u=32-rn(l)-1;l&=~(1<<u),i+=1;var h=32-rn(n)+u;if(30<h){var m=u-u%5;h=(l&(1<<m)-1).toString(32),l>>=m,u-=m,Nn=1<<32-rn(n)+u|i<<u|l,kn=h+e}else Nn=1<<h|i<<u|l,kn=e}function na(e){e.return!==null&&(fr(e,1),Ld(e,1,0))}function ra(e){for(;e===eo;)eo=Br[--Hr],Br[Hr]=null,to=Br[--Hr],Br[Hr]=null;for(;e===hr;)hr=qt[--Kt],qt[Kt]=null,kn=qt[--Kt],qt[Kt]=null,Nn=qt[--Kt],qt[Kt]=null}var Qt=null,Gt=null,rt=!1,on=null;function Md(e,n){var i=tn(5,null,null,0);i.elementType="DELETED",i.stateNode=n,i.return=e,n=e.deletions,n===null?(e.deletions=[i],e.flags|=16):n.push(i)}function Dd(e,n){switch(e.tag){case 5:var i=e.type;return n=n.nodeType!==1||i.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,Qt=e,Gt=Un(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,Qt=e,Gt=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(i=hr!==null?{id:Nn,overflow:kn}:null,e.memoizedState={dehydrated:n,treeContext:i,retryLane:1073741824},i=tn(18,null,null,0),i.stateNode=n,i.return=e,e.child=i,Qt=e,Gt=null,!0):!1;default:return!1}}function sa(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ia(e){if(rt){var n=Gt;if(n){var i=n;if(!Dd(e,n)){if(sa(e))throw Error(r(418));n=Un(i.nextSibling);var l=Qt;n&&Dd(e,n)?Md(l,i):(e.flags=e.flags&-4097|2,rt=!1,Qt=e)}}else{if(sa(e))throw Error(r(418));e.flags=e.flags&-4097|2,rt=!1,Qt=e}}}function Od(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Qt=e}function no(e){if(e!==Qt)return!1;if(!rt)return Od(e),rt=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!ql(e.type,e.memoizedProps)),n&&(n=Gt)){if(sa(e))throw Ad(),Error(r(418));for(;n;)Md(e,n),n=Un(n.nextSibling)}if(Od(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(r(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(n===0){Gt=Un(e.nextSibling);break e}n--}else i!=="$"&&i!=="$!"&&i!=="$?"||n++}e=e.nextSibling}Gt=null}}else Gt=Qt?Un(e.stateNode.nextSibling):null;return!0}function Ad(){for(var e=Gt;e;)e=Un(e.nextSibling)}function Vr(){Gt=Qt=null,rt=!1}function oa(e){on===null?on=[e]:on.push(e)}var hg=he.ReactCurrentBatchConfig;function ln(e,n){if(e&&e.defaultProps){n=w({},n),e=e.defaultProps;for(var i in e)n[i]===void 0&&(n[i]=e[i]);return n}return n}var ro=Wn(null),so=null,Yr=null,la=null;function aa(){la=Yr=so=null}function ca(e){var n=ro.current;tt(ro),e._currentValue=n}function ua(e,n,i){for(;e!==null;){var l=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,l!==null&&(l.childLanes|=n)):l!==null&&(l.childLanes&n)!==n&&(l.childLanes|=n),e===i)break;e=e.return}}function Qr(e,n){so=e,la=Yr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&n)!==0&&(Ot=!0),e.firstContext=null)}function Jt(e){var n=e._currentValue;if(la!==e)if(e={context:e,memoizedValue:n,next:null},Yr===null){if(so===null)throw Error(r(308));Yr=e,so.dependencies={lanes:0,firstContext:e}}else Yr=Yr.next=e;return n}var pr=null;function da(e){pr===null?pr=[e]:pr.push(e)}function Fd(e,n,i,l){var u=n.interleaved;return u===null?(i.next=i,da(n)):(i.next=u.next,u.next=i),n.interleaved=i,Cn(e,l)}function Cn(e,n){e.lanes|=n;var i=e.alternate;for(i!==null&&(i.lanes|=n),i=e,e=e.return;e!==null;)e.childLanes|=n,i=e.alternate,i!==null&&(i.childLanes|=n),i=e,e=e.return;return i.tag===3?i.stateNode:null}var Vn=!1;function ha(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $d(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Sn(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function Yn(e,n,i){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(He&2)!==0){var u=l.pending;return u===null?n.next=n:(n.next=u.next,u.next=n),l.pending=n,Cn(e,i)}return u=l.interleaved,u===null?(n.next=n,da(l)):(n.next=u.next,u.next=n),l.interleaved=n,Cn(e,i)}function io(e,n,i){if(n=n.updateQueue,n!==null&&(n=n.shared,(i&4194240)!==0)){var l=n.lanes;l&=e.pendingLanes,i|=l,n.lanes=i,Sl(e,i)}}function zd(e,n){var i=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,i===l)){var u=null,h=null;if(i=i.firstBaseUpdate,i!==null){do{var m={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};h===null?u=h=m:h=h.next=m,i=i.next}while(i!==null);h===null?u=h=n:h=h.next=n}else u=h=n;i={baseState:l.baseState,firstBaseUpdate:u,lastBaseUpdate:h,shared:l.shared,effects:l.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=n:e.next=n,i.lastBaseUpdate=n}function oo(e,n,i,l){var u=e.updateQueue;Vn=!1;var h=u.firstBaseUpdate,m=u.lastBaseUpdate,_=u.shared.pending;if(_!==null){u.shared.pending=null;var b=_,R=b.next;b.next=null,m===null?h=R:m.next=R,m=b;var W=e.alternate;W!==null&&(W=W.updateQueue,_=W.lastBaseUpdate,_!==m&&(_===null?W.firstBaseUpdate=R:_.next=R,W.lastBaseUpdate=b))}if(h!==null){var V=u.baseState;m=0,W=R=b=null,_=h;do{var z=_.lane,re=_.eventTime;if((l&z)===z){W!==null&&(W=W.next={eventTime:re,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});e:{var de=e,me=_;switch(z=n,re=i,me.tag){case 1:if(de=me.payload,typeof de=="function"){V=de.call(re,V,z);break e}V=de;break e;case 3:de.flags=de.flags&-65537|128;case 0:if(de=me.payload,z=typeof de=="function"?de.call(re,V,z):de,z==null)break e;V=w({},V,z);break e;case 2:Vn=!0}}_.callback!==null&&_.lane!==0&&(e.flags|=64,z=u.effects,z===null?u.effects=[_]:z.push(_))}else re={eventTime:re,lane:z,tag:_.tag,payload:_.payload,callback:_.callback,next:null},W===null?(R=W=re,b=V):W=W.next=re,m|=z;if(_=_.next,_===null){if(_=u.shared.pending,_===null)break;z=_,_=z.next,z.next=null,u.lastBaseUpdate=z,u.shared.pending=null}}while(!0);if(W===null&&(b=V),u.baseState=b,u.firstBaseUpdate=R,u.lastBaseUpdate=W,n=u.shared.interleaved,n!==null){u=n;do m|=u.lane,u=u.next;while(u!==n)}else h===null&&(u.shared.lanes=0);xr|=m,e.lanes=m,e.memoizedState=V}}function Ud(e,n,i){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var l=e[n],u=l.callback;if(u!==null){if(l.callback=null,l=i,typeof u!="function")throw Error(r(191,u));u.call(l)}}}var Wd=new s.Component().refs;function fa(e,n,i,l){n=e.memoizedState,i=i(l,n),i=i==null?n:w({},n,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var lo={isMounted:function(e){return(e=e._reactInternals)?cr(e)===e:!1},enqueueSetState:function(e,n,i){e=e._reactInternals;var l=Lt(),u=qn(e),h=Sn(l,u);h.payload=n,i!=null&&(h.callback=i),n=Yn(e,h,u),n!==null&&(un(n,e,u,l),io(n,e,u))},enqueueReplaceState:function(e,n,i){e=e._reactInternals;var l=Lt(),u=qn(e),h=Sn(l,u);h.tag=1,h.payload=n,i!=null&&(h.callback=i),n=Yn(e,h,u),n!==null&&(un(n,e,u,l),io(n,e,u))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var i=Lt(),l=qn(e),u=Sn(i,l);u.tag=2,n!=null&&(u.callback=n),n=Yn(e,u,l),n!==null&&(un(n,e,l,i),io(n,e,l))}};function Bd(e,n,i,l,u,h,m){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,h,m):n.prototype&&n.prototype.isPureReactComponent?!Rs(i,l)||!Rs(u,h):!0}function Hd(e,n,i){var l=!1,u=Bn,h=n.contextType;return typeof h=="object"&&h!==null?h=Jt(h):(u=Dt(n)?dr:jt.current,l=n.contextTypes,h=(l=l!=null)?Wr(e,u):Bn),n=new n(i,h),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=lo,e.stateNode=n,n._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=u,e.__reactInternalMemoizedMaskedChildContext=h),n}function Vd(e,n,i,l){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(i,l),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(i,l),n.state!==e&&lo.enqueueReplaceState(n,n.state,null)}function pa(e,n,i,l){var u=e.stateNode;u.props=i,u.state=e.memoizedState,u.refs=Wd,ha(e);var h=n.contextType;typeof h=="object"&&h!==null?u.context=Jt(h):(h=Dt(n)?dr:jt.current,u.context=Wr(e,h)),u.state=e.memoizedState,h=n.getDerivedStateFromProps,typeof h=="function"&&(fa(e,n,h,i),u.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(n=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),n!==u.state&&lo.enqueueReplaceState(u,u.state,null),oo(e,i,u,l),u.state=e.memoizedState),typeof u.componentDidMount=="function"&&(e.flags|=4194308)}function Fs(e,n,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(r(309));var l=i.stateNode}if(!l)throw Error(r(147,e));var u=l,h=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===h?n.ref:(n=function(m){var _=u.refs;_===Wd&&(_=u.refs={}),m===null?delete _[h]:_[h]=m},n._stringRef=h,n)}if(typeof e!="string")throw Error(r(284));if(!i._owner)throw Error(r(290,e))}return e}function ao(e,n){throw e=Object.prototype.toString.call(n),Error(r(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function Yd(e){var n=e._init;return n(e._payload)}function Qd(e){function n(E,N){if(e){var I=E.deletions;I===null?(E.deletions=[N],E.flags|=16):I.push(N)}}function i(E,N){if(!e)return null;for(;N!==null;)n(E,N),N=N.sibling;return null}function l(E,N){for(E=new Map;N!==null;)N.key!==null?E.set(N.key,N):E.set(N.index,N),N=N.sibling;return E}function u(E,N){return E=Jn(E,N),E.index=0,E.sibling=null,E}function h(E,N,I){return E.index=I,e?(I=E.alternate,I!==null?(I=I.index,I<N?(E.flags|=2,N):I):(E.flags|=2,N)):(E.flags|=1048576,N)}function m(E){return e&&E.alternate===null&&(E.flags|=2),E}function _(E,N,I,G){return N===null||N.tag!==6?(N=Ka(I,E.mode,G),N.return=E,N):(N=u(N,I),N.return=E,N)}function b(E,N,I,G){var ge=I.type;return ge===L?W(E,N,I.props.children,G,I.key):N!==null&&(N.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===Qe&&Yd(ge)===N.type)?(G=u(N,I.props),G.ref=Fs(E,N,I),G.return=E,G):(G=Eo(I.type,I.key,I.props,null,E.mode,G),G.ref=Fs(E,N,I),G.return=E,G)}function R(E,N,I,G){return N===null||N.tag!==4||N.stateNode.containerInfo!==I.containerInfo||N.stateNode.implementation!==I.implementation?(N=Ja(I,E.mode,G),N.return=E,N):(N=u(N,I.children||[]),N.return=E,N)}function W(E,N,I,G,ge){return N===null||N.tag!==7?(N=wr(I,E.mode,G,ge),N.return=E,N):(N=u(N,I),N.return=E,N)}function V(E,N,I){if(typeof N=="string"&&N!==""||typeof N=="number")return N=Ka(""+N,E.mode,I),N.return=E,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case We:return I=Eo(N.type,N.key,N.props,null,E.mode,I),I.ref=Fs(E,null,N),I.return=E,I;case J:return N=Ja(N,E.mode,I),N.return=E,N;case Qe:var G=N._init;return V(E,G(N._payload),I)}if(Re(N)||Z(N))return N=wr(N,E.mode,I,null),N.return=E,N;ao(E,N)}return null}function z(E,N,I,G){var ge=N!==null?N.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return ge!==null?null:_(E,N,""+I,G);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case We:return I.key===ge?b(E,N,I,G):null;case J:return I.key===ge?R(E,N,I,G):null;case Qe:return ge=I._init,z(E,N,ge(I._payload),G)}if(Re(I)||Z(I))return ge!==null?null:W(E,N,I,G,null);ao(E,I)}return null}function re(E,N,I,G,ge){if(typeof G=="string"&&G!==""||typeof G=="number")return E=E.get(I)||null,_(N,E,""+G,ge);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case We:return E=E.get(G.key===null?I:G.key)||null,b(N,E,G,ge);case J:return E=E.get(G.key===null?I:G.key)||null,R(N,E,G,ge);case Qe:var be=G._init;return re(E,N,I,be(G._payload),ge)}if(Re(G)||Z(G))return E=E.get(I)||null,W(N,E,G,ge,null);ao(N,G)}return null}function de(E,N,I,G){for(var ge=null,be=null,Ne=N,Se=N=0,yt=null;Ne!==null&&Se<I.length;Se++){Ne.index>Se?(yt=Ne,Ne=null):yt=Ne.sibling;var Ve=z(E,Ne,I[Se],G);if(Ve===null){Ne===null&&(Ne=yt);break}e&&Ne&&Ve.alternate===null&&n(E,Ne),N=h(Ve,N,Se),be===null?ge=Ve:be.sibling=Ve,be=Ve,Ne=yt}if(Se===I.length)return i(E,Ne),rt&&fr(E,Se),ge;if(Ne===null){for(;Se<I.length;Se++)Ne=V(E,I[Se],G),Ne!==null&&(N=h(Ne,N,Se),be===null?ge=Ne:be.sibling=Ne,be=Ne);return rt&&fr(E,Se),ge}for(Ne=l(E,Ne);Se<I.length;Se++)yt=re(Ne,E,Se,I[Se],G),yt!==null&&(e&&yt.alternate!==null&&Ne.delete(yt.key===null?Se:yt.key),N=h(yt,N,Se),be===null?ge=yt:be.sibling=yt,be=yt);return e&&Ne.forEach(function(Zn){return n(E,Zn)}),rt&&fr(E,Se),ge}function me(E,N,I,G){var ge=Z(I);if(typeof ge!="function")throw Error(r(150));if(I=ge.call(I),I==null)throw Error(r(151));for(var be=ge=null,Ne=N,Se=N=0,yt=null,Ve=I.next();Ne!==null&&!Ve.done;Se++,Ve=I.next()){Ne.index>Se?(yt=Ne,Ne=null):yt=Ne.sibling;var Zn=z(E,Ne,Ve.value,G);if(Zn===null){Ne===null&&(Ne=yt);break}e&&Ne&&Zn.alternate===null&&n(E,Ne),N=h(Zn,N,Se),be===null?ge=Zn:be.sibling=Zn,be=Zn,Ne=yt}if(Ve.done)return i(E,Ne),rt&&fr(E,Se),ge;if(Ne===null){for(;!Ve.done;Se++,Ve=I.next())Ve=V(E,Ve.value,G),Ve!==null&&(N=h(Ve,N,Se),be===null?ge=Ve:be.sibling=Ve,be=Ve);return rt&&fr(E,Se),ge}for(Ne=l(E,Ne);!Ve.done;Se++,Ve=I.next())Ve=re(Ne,E,Se,Ve.value,G),Ve!==null&&(e&&Ve.alternate!==null&&Ne.delete(Ve.key===null?Se:Ve.key),N=h(Ve,N,Se),be===null?ge=Ve:be.sibling=Ve,be=Ve);return e&&Ne.forEach(function(Vg){return n(E,Vg)}),rt&&fr(E,Se),ge}function dt(E,N,I,G){if(typeof I=="object"&&I!==null&&I.type===L&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case We:e:{for(var ge=I.key,be=N;be!==null;){if(be.key===ge){if(ge=I.type,ge===L){if(be.tag===7){i(E,be.sibling),N=u(be,I.props.children),N.return=E,E=N;break e}}else if(be.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===Qe&&Yd(ge)===be.type){i(E,be.sibling),N=u(be,I.props),N.ref=Fs(E,be,I),N.return=E,E=N;break e}i(E,be);break}else n(E,be);be=be.sibling}I.type===L?(N=wr(I.props.children,E.mode,G,I.key),N.return=E,E=N):(G=Eo(I.type,I.key,I.props,null,E.mode,G),G.ref=Fs(E,N,I),G.return=E,E=G)}return m(E);case J:e:{for(be=I.key;N!==null;){if(N.key===be)if(N.tag===4&&N.stateNode.containerInfo===I.containerInfo&&N.stateNode.implementation===I.implementation){i(E,N.sibling),N=u(N,I.children||[]),N.return=E,E=N;break e}else{i(E,N);break}else n(E,N);N=N.sibling}N=Ja(I,E.mode,G),N.return=E,E=N}return m(E);case Qe:return be=I._init,dt(E,N,be(I._payload),G)}if(Re(I))return de(E,N,I,G);if(Z(I))return me(E,N,I,G);ao(E,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,N!==null&&N.tag===6?(i(E,N.sibling),N=u(N,I),N.return=E,E=N):(i(E,N),N=Ka(I,E.mode,G),N.return=E,E=N),m(E)):i(E,N)}return dt}var Gr=Qd(!0),Gd=Qd(!1),$s={},vn=Wn($s),zs=Wn($s),Us=Wn($s);function mr(e){if(e===$s)throw Error(r(174));return e}function ma(e,n){switch(Ke(Us,n),Ke(zs,e),Ke(vn,$s),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:U(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=U(n,e)}tt(vn),Ke(vn,n)}function Xr(){tt(vn),tt(zs),tt(Us)}function Xd(e){mr(Us.current);var n=mr(vn.current),i=U(n,e.type);n!==i&&(Ke(zs,e),Ke(vn,i))}function ga(e){zs.current===e&&(tt(vn),tt(zs))}var it=Wn(0);function co(e){for(var n=e;n!==null;){if(n.tag===13){var i=n.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var xa=[];function va(){for(var e=0;e<xa.length;e++)xa[e]._workInProgressVersionPrimary=null;xa.length=0}var uo=he.ReactCurrentDispatcher,ya=he.ReactCurrentBatchConfig,gr=0,ot=null,pt=null,xt=null,ho=!1,Ws=!1,Bs=0,fg=0;function Et(){throw Error(r(321))}function _a(e,n){if(n===null)return!1;for(var i=0;i<n.length&&i<e.length;i++)if(!sn(e[i],n[i]))return!1;return!0}function wa(e,n,i,l,u,h){if(gr=h,ot=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,uo.current=e===null||e.memoizedState===null?xg:vg,e=i(l,u),Ws){h=0;do{if(Ws=!1,Bs=0,25<=h)throw Error(r(301));h+=1,xt=pt=null,n.updateQueue=null,uo.current=yg,e=i(l,u)}while(Ws)}if(uo.current=mo,n=pt!==null&&pt.next!==null,gr=0,xt=pt=ot=null,ho=!1,n)throw Error(r(300));return e}function ba(){var e=Bs!==0;return Bs=0,e}function yn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xt===null?ot.memoizedState=xt=e:xt=xt.next=e,xt}function Zt(){if(pt===null){var e=ot.alternate;e=e!==null?e.memoizedState:null}else e=pt.next;var n=xt===null?ot.memoizedState:xt.next;if(n!==null)xt=n,pt=e;else{if(e===null)throw Error(r(310));pt=e,e={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},xt===null?ot.memoizedState=xt=e:xt=xt.next=e}return xt}function Hs(e,n){return typeof n=="function"?n(e):n}function Na(e){var n=Zt(),i=n.queue;if(i===null)throw Error(r(311));i.lastRenderedReducer=e;var l=pt,u=l.baseQueue,h=i.pending;if(h!==null){if(u!==null){var m=u.next;u.next=h.next,h.next=m}l.baseQueue=u=h,i.pending=null}if(u!==null){h=u.next,l=l.baseState;var _=m=null,b=null,R=h;do{var W=R.lane;if((gr&W)===W)b!==null&&(b=b.next={lane:0,action:R.action,hasEagerState:R.hasEagerState,eagerState:R.eagerState,next:null}),l=R.hasEagerState?R.eagerState:e(l,R.action);else{var V={lane:W,action:R.action,hasEagerState:R.hasEagerState,eagerState:R.eagerState,next:null};b===null?(_=b=V,m=l):b=b.next=V,ot.lanes|=W,xr|=W}R=R.next}while(R!==null&&R!==h);b===null?m=l:b.next=_,sn(l,n.memoizedState)||(Ot=!0),n.memoizedState=l,n.baseState=m,n.baseQueue=b,i.lastRenderedState=l}if(e=i.interleaved,e!==null){u=e;do h=u.lane,ot.lanes|=h,xr|=h,u=u.next;while(u!==e)}else u===null&&(i.lanes=0);return[n.memoizedState,i.dispatch]}function ka(e){var n=Zt(),i=n.queue;if(i===null)throw Error(r(311));i.lastRenderedReducer=e;var l=i.dispatch,u=i.pending,h=n.memoizedState;if(u!==null){i.pending=null;var m=u=u.next;do h=e(h,m.action),m=m.next;while(m!==u);sn(h,n.memoizedState)||(Ot=!0),n.memoizedState=h,n.baseQueue===null&&(n.baseState=h),i.lastRenderedState=h}return[h,l]}function qd(){}function Kd(e,n){var i=ot,l=Zt(),u=n(),h=!sn(l.memoizedState,u);if(h&&(l.memoizedState=u,Ot=!0),l=l.queue,Ca(eh.bind(null,i,l,e),[e]),l.getSnapshot!==n||h||xt!==null&&xt.memoizedState.tag&1){if(i.flags|=2048,Vs(9,Zd.bind(null,i,l,u,n),void 0,null),vt===null)throw Error(r(349));(gr&30)!==0||Jd(i,n,u)}return u}function Jd(e,n,i){e.flags|=16384,e={getSnapshot:n,value:i},n=ot.updateQueue,n===null?(n={lastEffect:null,stores:null},ot.updateQueue=n,n.stores=[e]):(i=n.stores,i===null?n.stores=[e]:i.push(e))}function Zd(e,n,i,l){n.value=i,n.getSnapshot=l,th(n)&&nh(e)}function eh(e,n,i){return i(function(){th(n)&&nh(e)})}function th(e){var n=e.getSnapshot;e=e.value;try{var i=n();return!sn(e,i)}catch{return!0}}function nh(e){var n=Cn(e,1);n!==null&&un(n,e,1,-1)}function rh(e){var n=yn();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hs,lastRenderedState:e},n.queue=e,e=e.dispatch=gg.bind(null,ot,e),[n.memoizedState,e]}function Vs(e,n,i,l){return e={tag:e,create:n,destroy:i,deps:l,next:null},n=ot.updateQueue,n===null?(n={lastEffect:null,stores:null},ot.updateQueue=n,n.lastEffect=e.next=e):(i=n.lastEffect,i===null?n.lastEffect=e.next=e:(l=i.next,i.next=e,e.next=l,n.lastEffect=e)),e}function sh(){return Zt().memoizedState}function fo(e,n,i,l){var u=yn();ot.flags|=e,u.memoizedState=Vs(1|n,i,void 0,l===void 0?null:l)}function po(e,n,i,l){var u=Zt();l=l===void 0?null:l;var h=void 0;if(pt!==null){var m=pt.memoizedState;if(h=m.destroy,l!==null&&_a(l,m.deps)){u.memoizedState=Vs(n,i,h,l);return}}ot.flags|=e,u.memoizedState=Vs(1|n,i,h,l)}function ih(e,n){return fo(8390656,8,e,n)}function Ca(e,n){return po(2048,8,e,n)}function oh(e,n){return po(4,2,e,n)}function lh(e,n){return po(4,4,e,n)}function ah(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function ch(e,n,i){return i=i!=null?i.concat([e]):null,po(4,4,ah.bind(null,n,e),i)}function Sa(){}function uh(e,n){var i=Zt();n=n===void 0?null:n;var l=i.memoizedState;return l!==null&&n!==null&&_a(n,l[1])?l[0]:(i.memoizedState=[e,n],e)}function dh(e,n){var i=Zt();n=n===void 0?null:n;var l=i.memoizedState;return l!==null&&n!==null&&_a(n,l[1])?l[0]:(e=e(),i.memoizedState=[e,n],e)}function hh(e,n,i){return(gr&21)===0?(e.baseState&&(e.baseState=!1,Ot=!0),e.memoizedState=i):(sn(i,n)||(i=Fu(),ot.lanes|=i,xr|=i,e.baseState=!0),n)}function pg(e,n){var i=Xe;Xe=i!==0&&4>i?i:4,e(!0);var l=ya.transition;ya.transition={};try{e(!1),n()}finally{Xe=i,ya.transition=l}}function fh(){return Zt().memoizedState}function mg(e,n,i){var l=qn(e);if(i={lane:l,action:i,hasEagerState:!1,eagerState:null,next:null},ph(e))mh(n,i);else if(i=Fd(e,n,i,l),i!==null){var u=Lt();un(i,e,l,u),gh(i,n,l)}}function gg(e,n,i){var l=qn(e),u={lane:l,action:i,hasEagerState:!1,eagerState:null,next:null};if(ph(e))mh(n,u);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=n.lastRenderedReducer,h!==null))try{var m=n.lastRenderedState,_=h(m,i);if(u.hasEagerState=!0,u.eagerState=_,sn(_,m)){var b=n.interleaved;b===null?(u.next=u,da(n)):(u.next=b.next,b.next=u),n.interleaved=u;return}}catch{}finally{}i=Fd(e,n,u,l),i!==null&&(u=Lt(),un(i,e,l,u),gh(i,n,l))}}function ph(e){var n=e.alternate;return e===ot||n!==null&&n===ot}function mh(e,n){Ws=ho=!0;var i=e.pending;i===null?n.next=n:(n.next=i.next,i.next=n),e.pending=n}function gh(e,n,i){if((i&4194240)!==0){var l=n.lanes;l&=e.pendingLanes,i|=l,n.lanes=i,Sl(e,i)}}var mo={readContext:Jt,useCallback:Et,useContext:Et,useEffect:Et,useImperativeHandle:Et,useInsertionEffect:Et,useLayoutEffect:Et,useMemo:Et,useReducer:Et,useRef:Et,useState:Et,useDebugValue:Et,useDeferredValue:Et,useTransition:Et,useMutableSource:Et,useSyncExternalStore:Et,useId:Et,unstable_isNewReconciler:!1},xg={readContext:Jt,useCallback:function(e,n){return yn().memoizedState=[e,n===void 0?null:n],e},useContext:Jt,useEffect:ih,useImperativeHandle:function(e,n,i){return i=i!=null?i.concat([e]):null,fo(4194308,4,ah.bind(null,n,e),i)},useLayoutEffect:function(e,n){return fo(4194308,4,e,n)},useInsertionEffect:function(e,n){return fo(4,2,e,n)},useMemo:function(e,n){var i=yn();return n=n===void 0?null:n,e=e(),i.memoizedState=[e,n],e},useReducer:function(e,n,i){var l=yn();return n=i!==void 0?i(n):n,l.memoizedState=l.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},l.queue=e,e=e.dispatch=mg.bind(null,ot,e),[l.memoizedState,e]},useRef:function(e){var n=yn();return e={current:e},n.memoizedState=e},useState:rh,useDebugValue:Sa,useDeferredValue:function(e){return yn().memoizedState=e},useTransition:function(){var e=rh(!1),n=e[0];return e=pg.bind(null,e[1]),yn().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,i){var l=ot,u=yn();if(rt){if(i===void 0)throw Error(r(407));i=i()}else{if(i=n(),vt===null)throw Error(r(349));(gr&30)!==0||Jd(l,n,i)}u.memoizedState=i;var h={value:i,getSnapshot:n};return u.queue=h,ih(eh.bind(null,l,h,e),[e]),l.flags|=2048,Vs(9,Zd.bind(null,l,h,i,n),void 0,null),i},useId:function(){var e=yn(),n=vt.identifierPrefix;if(rt){var i=kn,l=Nn;i=(l&~(1<<32-rn(l)-1)).toString(32)+i,n=":"+n+"R"+i,i=Bs++,0<i&&(n+="H"+i.toString(32)),n+=":"}else i=fg++,n=":"+n+"r"+i.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},vg={readContext:Jt,useCallback:uh,useContext:Jt,useEffect:Ca,useImperativeHandle:ch,useInsertionEffect:oh,useLayoutEffect:lh,useMemo:dh,useReducer:Na,useRef:sh,useState:function(){return Na(Hs)},useDebugValue:Sa,useDeferredValue:function(e){var n=Zt();return hh(n,pt.memoizedState,e)},useTransition:function(){var e=Na(Hs)[0],n=Zt().memoizedState;return[e,n]},useMutableSource:qd,useSyncExternalStore:Kd,useId:fh,unstable_isNewReconciler:!1},yg={readContext:Jt,useCallback:uh,useContext:Jt,useEffect:Ca,useImperativeHandle:ch,useInsertionEffect:oh,useLayoutEffect:lh,useMemo:dh,useReducer:ka,useRef:sh,useState:function(){return ka(Hs)},useDebugValue:Sa,useDeferredValue:function(e){var n=Zt();return pt===null?n.memoizedState=e:hh(n,pt.memoizedState,e)},useTransition:function(){var e=ka(Hs)[0],n=Zt().memoizedState;return[e,n]},useMutableSource:qd,useSyncExternalStore:Kd,useId:fh,unstable_isNewReconciler:!1};function qr(e,n){try{var i="",l=n;do i+=A(l),l=l.return;while(l);var u=i}catch(h){u=`
Error generating stack: `+h.message+`
`+h.stack}return{value:e,source:n,stack:u,digest:null}}function ja(e,n,i){return{value:e,source:null,stack:i??null,digest:n??null}}function Ea(e,n){try{console.error(n.value)}catch(i){setTimeout(function(){throw i})}}var _g=typeof WeakMap=="function"?WeakMap:Map;function xh(e,n,i){i=Sn(-1,i),i.tag=3,i.payload={element:null};var l=n.value;return i.callback=function(){bo||(bo=!0,Ba=l),Ea(e,n)},i}function vh(e,n,i){i=Sn(-1,i),i.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var u=n.value;i.payload=function(){return l(u)},i.callback=function(){Ea(e,n)}}var h=e.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(i.callback=function(){Ea(e,n),typeof l!="function"&&(Gn===null?Gn=new Set([this]):Gn.add(this));var m=n.stack;this.componentDidCatch(n.value,{componentStack:m!==null?m:""})}),i}function yh(e,n,i){var l=e.pingCache;if(l===null){l=e.pingCache=new _g;var u=new Set;l.set(n,u)}else u=l.get(n),u===void 0&&(u=new Set,l.set(n,u));u.has(i)||(u.add(i),e=Mg.bind(null,e,n,i),n.then(e,e))}function _h(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function wh(e,n,i,l,u){return(e.mode&1)===0?(e===n?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(n=Sn(-1,1),n.tag=2,Yn(i,n,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=u,e)}var wg=he.ReactCurrentOwner,Ot=!1;function Pt(e,n,i,l){n.child=e===null?Gd(n,null,i,l):Gr(n,e.child,i,l)}function bh(e,n,i,l,u){i=i.render;var h=n.ref;return Qr(n,u),l=wa(e,n,i,l,h,u),i=ba(),e!==null&&!Ot?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~u,jn(e,n,u)):(rt&&i&&na(n),n.flags|=1,Pt(e,n,l,u),n.child)}function Nh(e,n,i,l,u){if(e===null){var h=i.type;return typeof h=="function"&&!qa(h)&&h.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(n.tag=15,n.type=h,kh(e,n,h,l,u)):(e=Eo(i.type,null,l,n,n.mode,u),e.ref=n.ref,e.return=n,n.child=e)}if(h=e.child,(e.lanes&u)===0){var m=h.memoizedProps;if(i=i.compare,i=i!==null?i:Rs,i(m,l)&&e.ref===n.ref)return jn(e,n,u)}return n.flags|=1,e=Jn(h,l),e.ref=n.ref,e.return=n,n.child=e}function kh(e,n,i,l,u){if(e!==null){var h=e.memoizedProps;if(Rs(h,l)&&e.ref===n.ref)if(Ot=!1,n.pendingProps=l=h,(e.lanes&u)!==0)(e.flags&131072)!==0&&(Ot=!0);else return n.lanes=e.lanes,jn(e,n,u)}return Ia(e,n,i,l,u)}function Ch(e,n,i){var l=n.pendingProps,u=l.children,h=e!==null?e.memoizedState:null;if(l.mode==="hidden")if((n.mode&1)===0)n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ke(Jr,Xt),Xt|=i;else{if((i&1073741824)===0)return e=h!==null?h.baseLanes|i:i,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,Ke(Jr,Xt),Xt|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=h!==null?h.baseLanes:i,Ke(Jr,Xt),Xt|=l}else h!==null?(l=h.baseLanes|i,n.memoizedState=null):l=i,Ke(Jr,Xt),Xt|=l;return Pt(e,n,u,i),n.child}function Sh(e,n){var i=n.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(n.flags|=512,n.flags|=2097152)}function Ia(e,n,i,l,u){var h=Dt(i)?dr:jt.current;return h=Wr(n,h),Qr(n,u),i=wa(e,n,i,l,h,u),l=ba(),e!==null&&!Ot?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~u,jn(e,n,u)):(rt&&l&&na(n),n.flags|=1,Pt(e,n,i,u),n.child)}function jh(e,n,i,l,u){if(Dt(i)){var h=!0;Ji(n)}else h=!1;if(Qr(n,u),n.stateNode===null)xo(e,n),Hd(n,i,l),pa(n,i,l,u),l=!0;else if(e===null){var m=n.stateNode,_=n.memoizedProps;m.props=_;var b=m.context,R=i.contextType;typeof R=="object"&&R!==null?R=Jt(R):(R=Dt(i)?dr:jt.current,R=Wr(n,R));var W=i.getDerivedStateFromProps,V=typeof W=="function"||typeof m.getSnapshotBeforeUpdate=="function";V||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(_!==l||b!==R)&&Vd(n,m,l,R),Vn=!1;var z=n.memoizedState;m.state=z,oo(n,l,m,u),b=n.memoizedState,_!==l||z!==b||Mt.current||Vn?(typeof W=="function"&&(fa(n,i,W,l),b=n.memoizedState),(_=Vn||Bd(n,i,_,l,z,b,R))?(V||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(n.flags|=4194308)):(typeof m.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=l,n.memoizedState=b),m.props=l,m.state=b,m.context=R,l=_):(typeof m.componentDidMount=="function"&&(n.flags|=4194308),l=!1)}else{m=n.stateNode,$d(e,n),_=n.memoizedProps,R=n.type===n.elementType?_:ln(n.type,_),m.props=R,V=n.pendingProps,z=m.context,b=i.contextType,typeof b=="object"&&b!==null?b=Jt(b):(b=Dt(i)?dr:jt.current,b=Wr(n,b));var re=i.getDerivedStateFromProps;(W=typeof re=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(_!==V||z!==b)&&Vd(n,m,l,b),Vn=!1,z=n.memoizedState,m.state=z,oo(n,l,m,u);var de=n.memoizedState;_!==V||z!==de||Mt.current||Vn?(typeof re=="function"&&(fa(n,i,re,l),de=n.memoizedState),(R=Vn||Bd(n,i,R,l,z,de,b)||!1)?(W||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(l,de,b),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(l,de,b)),typeof m.componentDidUpdate=="function"&&(n.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof m.componentDidUpdate!="function"||_===e.memoizedProps&&z===e.memoizedState||(n.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&z===e.memoizedState||(n.flags|=1024),n.memoizedProps=l,n.memoizedState=de),m.props=l,m.state=de,m.context=b,l=R):(typeof m.componentDidUpdate!="function"||_===e.memoizedProps&&z===e.memoizedState||(n.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&z===e.memoizedState||(n.flags|=1024),l=!1)}return Ta(e,n,i,l,h,u)}function Ta(e,n,i,l,u,h){Sh(e,n);var m=(n.flags&128)!==0;if(!l&&!m)return u&&Rd(n,i,!1),jn(e,n,h);l=n.stateNode,wg.current=n;var _=m&&typeof i.getDerivedStateFromError!="function"?null:l.render();return n.flags|=1,e!==null&&m?(n.child=Gr(n,e.child,null,h),n.child=Gr(n,null,_,h)):Pt(e,n,_,h),n.memoizedState=l.state,u&&Rd(n,i,!0),n.child}function Eh(e){var n=e.stateNode;n.pendingContext?Id(e,n.pendingContext,n.pendingContext!==n.context):n.context&&Id(e,n.context,!1),ma(e,n.containerInfo)}function Ih(e,n,i,l,u){return Vr(),oa(u),n.flags|=256,Pt(e,n,i,l),n.child}var Ra={dehydrated:null,treeContext:null,retryLane:0};function Pa(e){return{baseLanes:e,cachePool:null,transitions:null}}function Th(e,n,i){var l=n.pendingProps,u=it.current,h=!1,m=(n.flags&128)!==0,_;if((_=m)||(_=e!==null&&e.memoizedState===null?!1:(u&2)!==0),_?(h=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(u|=1),Ke(it,u&1),e===null)return ia(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((n.mode&1)===0?n.lanes=1:e.data==="$!"?n.lanes=8:n.lanes=1073741824,null):(m=l.children,e=l.fallback,h?(l=n.mode,h=n.child,m={mode:"hidden",children:m},(l&1)===0&&h!==null?(h.childLanes=0,h.pendingProps=m):h=Io(m,l,0,null),e=wr(e,l,i,null),h.return=n,e.return=n,h.sibling=e,n.child=h,n.child.memoizedState=Pa(i),n.memoizedState=Ra,e):La(n,m));if(u=e.memoizedState,u!==null&&(_=u.dehydrated,_!==null))return bg(e,n,m,l,_,u,i);if(h){h=l.fallback,m=n.mode,u=e.child,_=u.sibling;var b={mode:"hidden",children:l.children};return(m&1)===0&&n.child!==u?(l=n.child,l.childLanes=0,l.pendingProps=b,n.deletions=null):(l=Jn(u,b),l.subtreeFlags=u.subtreeFlags&14680064),_!==null?h=Jn(_,h):(h=wr(h,m,i,null),h.flags|=2),h.return=n,l.return=n,l.sibling=h,n.child=l,l=h,h=n.child,m=e.child.memoizedState,m=m===null?Pa(i):{baseLanes:m.baseLanes|i,cachePool:null,transitions:m.transitions},h.memoizedState=m,h.childLanes=e.childLanes&~i,n.memoizedState=Ra,l}return h=e.child,e=h.sibling,l=Jn(h,{mode:"visible",children:l.children}),(n.mode&1)===0&&(l.lanes=i),l.return=n,l.sibling=null,e!==null&&(i=n.deletions,i===null?(n.deletions=[e],n.flags|=16):i.push(e)),n.child=l,n.memoizedState=null,l}function La(e,n){return n=Io({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function go(e,n,i,l){return l!==null&&oa(l),Gr(n,e.child,null,i),e=La(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function bg(e,n,i,l,u,h,m){if(i)return n.flags&256?(n.flags&=-257,l=ja(Error(r(422))),go(e,n,m,l)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(h=l.fallback,u=n.mode,l=Io({mode:"visible",children:l.children},u,0,null),h=wr(h,u,m,null),h.flags|=2,l.return=n,h.return=n,l.sibling=h,n.child=l,(n.mode&1)!==0&&Gr(n,e.child,null,m),n.child.memoizedState=Pa(m),n.memoizedState=Ra,h);if((n.mode&1)===0)return go(e,n,m,null);if(u.data==="$!"){if(l=u.nextSibling&&u.nextSibling.dataset,l)var _=l.dgst;return l=_,h=Error(r(419)),l=ja(h,l,void 0),go(e,n,m,l)}if(_=(m&e.childLanes)!==0,Ot||_){if(l=vt,l!==null){switch(m&-m){case 4:u=2;break;case 16:u=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:u=32;break;case 536870912:u=268435456;break;default:u=0}u=(u&(l.suspendedLanes|m))!==0?0:u,u!==0&&u!==h.retryLane&&(h.retryLane=u,Cn(e,u),un(l,e,u,-1))}return Xa(),l=ja(Error(r(421))),go(e,n,m,l)}return u.data==="$?"?(n.flags|=128,n.child=e.child,n=Dg.bind(null,e),u._reactRetry=n,null):(e=h.treeContext,Gt=Un(u.nextSibling),Qt=n,rt=!0,on=null,e!==null&&(qt[Kt++]=Nn,qt[Kt++]=kn,qt[Kt++]=hr,Nn=e.id,kn=e.overflow,hr=n),n=La(n,l.children),n.flags|=4096,n)}function Rh(e,n,i){e.lanes|=n;var l=e.alternate;l!==null&&(l.lanes|=n),ua(e.return,n,i)}function Ma(e,n,i,l,u){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:l,tail:i,tailMode:u}:(h.isBackwards=n,h.rendering=null,h.renderingStartTime=0,h.last=l,h.tail=i,h.tailMode=u)}function Ph(e,n,i){var l=n.pendingProps,u=l.revealOrder,h=l.tail;if(Pt(e,n,l.children,i),l=it.current,(l&2)!==0)l=l&1|2,n.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Rh(e,i,n);else if(e.tag===19)Rh(e,i,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(Ke(it,l),(n.mode&1)===0)n.memoizedState=null;else switch(u){case"forwards":for(i=n.child,u=null;i!==null;)e=i.alternate,e!==null&&co(e)===null&&(u=i),i=i.sibling;i=u,i===null?(u=n.child,n.child=null):(u=i.sibling,i.sibling=null),Ma(n,!1,u,i,h);break;case"backwards":for(i=null,u=n.child,n.child=null;u!==null;){if(e=u.alternate,e!==null&&co(e)===null){n.child=u;break}e=u.sibling,u.sibling=i,i=u,u=e}Ma(n,!0,i,null,h);break;case"together":Ma(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function xo(e,n){(n.mode&1)===0&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function jn(e,n,i){if(e!==null&&(n.dependencies=e.dependencies),xr|=n.lanes,(i&n.childLanes)===0)return null;if(e!==null&&n.child!==e.child)throw Error(r(153));if(n.child!==null){for(e=n.child,i=Jn(e,e.pendingProps),n.child=i,i.return=n;e.sibling!==null;)e=e.sibling,i=i.sibling=Jn(e,e.pendingProps),i.return=n;i.sibling=null}return n.child}function Ng(e,n,i){switch(n.tag){case 3:Eh(n),Vr();break;case 5:Xd(n);break;case 1:Dt(n.type)&&Ji(n);break;case 4:ma(n,n.stateNode.containerInfo);break;case 10:var l=n.type._context,u=n.memoizedProps.value;Ke(ro,l._currentValue),l._currentValue=u;break;case 13:if(l=n.memoizedState,l!==null)return l.dehydrated!==null?(Ke(it,it.current&1),n.flags|=128,null):(i&n.child.childLanes)!==0?Th(e,n,i):(Ke(it,it.current&1),e=jn(e,n,i),e!==null?e.sibling:null);Ke(it,it.current&1);break;case 19:if(l=(i&n.childLanes)!==0,(e.flags&128)!==0){if(l)return Ph(e,n,i);n.flags|=128}if(u=n.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),Ke(it,it.current),l)break;return null;case 22:case 23:return n.lanes=0,Ch(e,n,i)}return jn(e,n,i)}var Lh,Da,Mh,Dh;Lh=function(e,n){for(var i=n.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Da=function(){},Mh=function(e,n,i,l){var u=e.memoizedProps;if(u!==l){e=n.stateNode,mr(vn.current);var h=null;switch(i){case"input":u=S(e,u),l=S(e,l),h=[];break;case"select":u=w({},u,{value:void 0}),l=w({},l,{value:void 0}),h=[];break;case"textarea":u=st(e,u),l=st(e,l),h=[];break;default:typeof u.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=Xi)}ml(i,l);var m;i=null;for(R in u)if(!l.hasOwnProperty(R)&&u.hasOwnProperty(R)&&u[R]!=null)if(R==="style"){var _=u[R];for(m in _)_.hasOwnProperty(m)&&(i||(i={}),i[m]="")}else R!=="dangerouslySetInnerHTML"&&R!=="children"&&R!=="suppressContentEditableWarning"&&R!=="suppressHydrationWarning"&&R!=="autoFocus"&&(c.hasOwnProperty(R)?h||(h=[]):(h=h||[]).push(R,null));for(R in l){var b=l[R];if(_=u!=null?u[R]:void 0,l.hasOwnProperty(R)&&b!==_&&(b!=null||_!=null))if(R==="style")if(_){for(m in _)!_.hasOwnProperty(m)||b&&b.hasOwnProperty(m)||(i||(i={}),i[m]="");for(m in b)b.hasOwnProperty(m)&&_[m]!==b[m]&&(i||(i={}),i[m]=b[m])}else i||(h||(h=[]),h.push(R,i)),i=b;else R==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,_=_?_.__html:void 0,b!=null&&_!==b&&(h=h||[]).push(R,b)):R==="children"?typeof b!="string"&&typeof b!="number"||(h=h||[]).push(R,""+b):R!=="suppressContentEditableWarning"&&R!=="suppressHydrationWarning"&&(c.hasOwnProperty(R)?(b!=null&&R==="onScroll"&&et("scroll",e),h||_===b||(h=[])):(h=h||[]).push(R,b))}i&&(h=h||[]).push("style",i);var R=h;(n.updateQueue=R)&&(n.flags|=4)}},Dh=function(e,n,i,l){i!==l&&(n.flags|=4)};function Ys(e,n){if(!rt)switch(e.tailMode){case"hidden":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function It(e){var n=e.alternate!==null&&e.alternate.child===e.child,i=0,l=0;if(n)for(var u=e.child;u!==null;)i|=u.lanes|u.childLanes,l|=u.subtreeFlags&14680064,l|=u.flags&14680064,u.return=e,u=u.sibling;else for(u=e.child;u!==null;)i|=u.lanes|u.childLanes,l|=u.subtreeFlags,l|=u.flags,u.return=e,u=u.sibling;return e.subtreeFlags|=l,e.childLanes=i,n}function kg(e,n,i){var l=n.pendingProps;switch(ra(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return It(n),null;case 1:return Dt(n.type)&&Ki(),It(n),null;case 3:return l=n.stateNode,Xr(),tt(Mt),tt(jt),va(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(no(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,on!==null&&(Ya(on),on=null))),Da(e,n),It(n),null;case 5:ga(n);var u=mr(Us.current);if(i=n.type,e!==null&&n.stateNode!=null)Mh(e,n,i,l,u),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!l){if(n.stateNode===null)throw Error(r(166));return It(n),null}if(e=mr(vn.current),no(n)){l=n.stateNode,i=n.type;var h=n.memoizedProps;switch(l[xn]=n,l[Os]=h,e=(n.mode&1)!==0,i){case"dialog":et("cancel",l),et("close",l);break;case"iframe":case"object":case"embed":et("load",l);break;case"video":case"audio":for(u=0;u<Ls.length;u++)et(Ls[u],l);break;case"source":et("error",l);break;case"img":case"image":case"link":et("error",l),et("load",l);break;case"details":et("toggle",l);break;case"input":te(l,h),et("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!h.multiple},et("invalid",l);break;case"textarea":$(l,h),et("invalid",l)}ml(i,h),u=null;for(var m in h)if(h.hasOwnProperty(m)){var _=h[m];m==="children"?typeof _=="string"?l.textContent!==_&&(h.suppressHydrationWarning!==!0&&Gi(l.textContent,_,e),u=["children",_]):typeof _=="number"&&l.textContent!==""+_&&(h.suppressHydrationWarning!==!0&&Gi(l.textContent,_,e),u=["children",""+_]):c.hasOwnProperty(m)&&_!=null&&m==="onScroll"&&et("scroll",l)}switch(i){case"input":T(l),Ee(l,h,!0);break;case"textarea":T(l),we(l);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(l.onclick=Xi)}l=u,n.updateQueue=l,l!==null&&(n.flags|=4)}else{m=u.nodeType===9?u:u.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=X(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=m.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=m.createElement(i,{is:l.is}):(e=m.createElement(i),i==="select"&&(m=e,l.multiple?m.multiple=!0:l.size&&(m.size=l.size))):e=m.createElementNS(e,i),e[xn]=n,e[Os]=l,Lh(e,n,!1,!1),n.stateNode=e;e:{switch(m=gl(i,l),i){case"dialog":et("cancel",e),et("close",e),u=l;break;case"iframe":case"object":case"embed":et("load",e),u=l;break;case"video":case"audio":for(u=0;u<Ls.length;u++)et(Ls[u],e);u=l;break;case"source":et("error",e),u=l;break;case"img":case"image":case"link":et("error",e),et("load",e),u=l;break;case"details":et("toggle",e),u=l;break;case"input":te(e,l),u=S(e,l),et("invalid",e);break;case"option":u=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},u=w({},l,{value:void 0}),et("invalid",e);break;case"textarea":$(e,l),u=st(e,l),et("invalid",e);break;default:u=l}ml(i,u),_=u;for(h in _)if(_.hasOwnProperty(h)){var b=_[h];h==="style"?lr(e,b):h==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,b!=null&&Te(e,b)):h==="children"?typeof b=="string"?(i!=="textarea"||b!=="")&&Be(e,b):typeof b=="number"&&Be(e,""+b):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(c.hasOwnProperty(h)?b!=null&&h==="onScroll"&&et("scroll",e):b!=null&&je(e,h,b,m))}switch(i){case"input":T(e),Ee(e,l,!1);break;case"textarea":T(e),we(e);break;case"option":l.value!=null&&e.setAttribute("value",""+K(l.value));break;case"select":e.multiple=!!l.multiple,h=l.value,h!=null?Ge(e,!!l.multiple,h,!1):l.defaultValue!=null&&Ge(e,!!l.multiple,l.defaultValue,!0);break;default:typeof u.onClick=="function"&&(e.onclick=Xi)}switch(i){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return It(n),null;case 6:if(e&&n.stateNode!=null)Dh(e,n,e.memoizedProps,l);else{if(typeof l!="string"&&n.stateNode===null)throw Error(r(166));if(i=mr(Us.current),mr(vn.current),no(n)){if(l=n.stateNode,i=n.memoizedProps,l[xn]=n,(h=l.nodeValue!==i)&&(e=Qt,e!==null))switch(e.tag){case 3:Gi(l.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Gi(l.nodeValue,i,(e.mode&1)!==0)}h&&(n.flags|=4)}else l=(i.nodeType===9?i:i.ownerDocument).createTextNode(l),l[xn]=n,n.stateNode=l}return It(n),null;case 13:if(tt(it),l=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(rt&&Gt!==null&&(n.mode&1)!==0&&(n.flags&128)===0)Ad(),Vr(),n.flags|=98560,h=!1;else if(h=no(n),l!==null&&l.dehydrated!==null){if(e===null){if(!h)throw Error(r(318));if(h=n.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(r(317));h[xn]=n}else Vr(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;It(n),h=!1}else on!==null&&(Ya(on),on=null),h=!0;if(!h)return n.flags&65536?n:null}return(n.flags&128)!==0?(n.lanes=i,n):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(n.child.flags|=8192,(n.mode&1)!==0&&(e===null||(it.current&1)!==0?mt===0&&(mt=3):Xa())),n.updateQueue!==null&&(n.flags|=4),It(n),null);case 4:return Xr(),Da(e,n),e===null&&Ms(n.stateNode.containerInfo),It(n),null;case 10:return ca(n.type._context),It(n),null;case 17:return Dt(n.type)&&Ki(),It(n),null;case 19:if(tt(it),h=n.memoizedState,h===null)return It(n),null;if(l=(n.flags&128)!==0,m=h.rendering,m===null)if(l)Ys(h,!1);else{if(mt!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(m=co(e),m!==null){for(n.flags|=128,Ys(h,!1),l=m.updateQueue,l!==null&&(n.updateQueue=l,n.flags|=4),n.subtreeFlags=0,l=i,i=n.child;i!==null;)h=i,e=l,h.flags&=14680066,m=h.alternate,m===null?(h.childLanes=0,h.lanes=e,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=m.childLanes,h.lanes=m.lanes,h.child=m.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=m.memoizedProps,h.memoizedState=m.memoizedState,h.updateQueue=m.updateQueue,h.type=m.type,e=m.dependencies,h.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Ke(it,it.current&1|2),n.child}e=e.sibling}h.tail!==null&&ut()>Zr&&(n.flags|=128,l=!0,Ys(h,!1),n.lanes=4194304)}else{if(!l)if(e=co(m),e!==null){if(n.flags|=128,l=!0,i=e.updateQueue,i!==null&&(n.updateQueue=i,n.flags|=4),Ys(h,!0),h.tail===null&&h.tailMode==="hidden"&&!m.alternate&&!rt)return It(n),null}else 2*ut()-h.renderingStartTime>Zr&&i!==1073741824&&(n.flags|=128,l=!0,Ys(h,!1),n.lanes=4194304);h.isBackwards?(m.sibling=n.child,n.child=m):(i=h.last,i!==null?i.sibling=m:n.child=m,h.last=m)}return h.tail!==null?(n=h.tail,h.rendering=n,h.tail=n.sibling,h.renderingStartTime=ut(),n.sibling=null,i=it.current,Ke(it,l?i&1|2:i&1),n):(It(n),null);case 22:case 23:return Ga(),l=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(n.flags|=8192),l&&(n.mode&1)!==0?(Xt&1073741824)!==0&&(It(n),n.subtreeFlags&6&&(n.flags|=8192)):It(n),null;case 24:return null;case 25:return null}throw Error(r(156,n.tag))}function Cg(e,n){switch(ra(n),n.tag){case 1:return Dt(n.type)&&Ki(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Xr(),tt(Mt),tt(jt),va(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 5:return ga(n),null;case 13:if(tt(it),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(r(340));Vr()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return tt(it),null;case 4:return Xr(),null;case 10:return ca(n.type._context),null;case 22:case 23:return Ga(),null;case 24:return null;default:return null}}var vo=!1,Tt=!1,Sg=typeof WeakSet=="function"?WeakSet:Set,le=null;function Kr(e,n){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(l){at(e,n,l)}else i.current=null}function Oa(e,n,i){try{i()}catch(l){at(e,n,l)}}var Oh=!1;function jg(e,n){if(Gl=Ai,e=fd(),zl(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var l=i.getSelection&&i.getSelection();if(l&&l.rangeCount!==0){i=l.anchorNode;var u=l.anchorOffset,h=l.focusNode;l=l.focusOffset;try{i.nodeType,h.nodeType}catch{i=null;break e}var m=0,_=-1,b=-1,R=0,W=0,V=e,z=null;t:for(;;){for(var re;V!==i||u!==0&&V.nodeType!==3||(_=m+u),V!==h||l!==0&&V.nodeType!==3||(b=m+l),V.nodeType===3&&(m+=V.nodeValue.length),(re=V.firstChild)!==null;)z=V,V=re;for(;;){if(V===e)break t;if(z===i&&++R===u&&(_=m),z===h&&++W===l&&(b=m),(re=V.nextSibling)!==null)break;V=z,z=V.parentNode}V=re}i=_===-1||b===-1?null:{start:_,end:b}}else i=null}i=i||{start:0,end:0}}else i=null;for(Xl={focusedElem:e,selectionRange:i},Ai=!1,le=n;le!==null;)if(n=le,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,le=e;else for(;le!==null;){n=le;try{var de=n.alternate;if((n.flags&1024)!==0)switch(n.tag){case 0:case 11:case 15:break;case 1:if(de!==null){var me=de.memoizedProps,dt=de.memoizedState,E=n.stateNode,N=E.getSnapshotBeforeUpdate(n.elementType===n.type?me:ln(n.type,me),dt);E.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var I=n.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(G){at(n,n.return,G)}if(e=n.sibling,e!==null){e.return=n.return,le=e;break}le=n.return}return de=Oh,Oh=!1,de}function Qs(e,n,i){var l=n.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var u=l=l.next;do{if((u.tag&e)===e){var h=u.destroy;u.destroy=void 0,h!==void 0&&Oa(n,i,h)}u=u.next}while(u!==l)}}function yo(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var l=i.create;i.destroy=l()}i=i.next}while(i!==n)}}function Aa(e){var n=e.ref;if(n!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof n=="function"?n(e):n.current=e}}function Ah(e){var n=e.alternate;n!==null&&(e.alternate=null,Ah(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[xn],delete n[Os],delete n[Zl],delete n[cg],delete n[ug])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Fh(e){return e.tag===5||e.tag===3||e.tag===4}function $h(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Fh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Fa(e,n,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?i.nodeType===8?i.parentNode.insertBefore(e,n):i.insertBefore(e,n):(i.nodeType===8?(n=i.parentNode,n.insertBefore(e,i)):(n=i,n.appendChild(e)),i=i._reactRootContainer,i!=null||n.onclick!==null||(n.onclick=Xi));else if(l!==4&&(e=e.child,e!==null))for(Fa(e,n,i),e=e.sibling;e!==null;)Fa(e,n,i),e=e.sibling}function $a(e,n,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?i.insertBefore(e,n):i.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for($a(e,n,i),e=e.sibling;e!==null;)$a(e,n,i),e=e.sibling}var kt=null,an=!1;function Qn(e,n,i){for(i=i.child;i!==null;)zh(e,n,i),i=i.sibling}function zh(e,n,i){if(gn&&typeof gn.onCommitFiberUnmount=="function")try{gn.onCommitFiberUnmount(Ri,i)}catch{}switch(i.tag){case 5:Tt||Kr(i,n);case 6:var l=kt,u=an;kt=null,Qn(e,n,i),kt=l,an=u,kt!==null&&(an?(e=kt,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):kt.removeChild(i.stateNode));break;case 18:kt!==null&&(an?(e=kt,i=i.stateNode,e.nodeType===8?Jl(e.parentNode,i):e.nodeType===1&&Jl(e,i),Cs(e)):Jl(kt,i.stateNode));break;case 4:l=kt,u=an,kt=i.stateNode.containerInfo,an=!0,Qn(e,n,i),kt=l,an=u;break;case 0:case 11:case 14:case 15:if(!Tt&&(l=i.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){u=l=l.next;do{var h=u,m=h.destroy;h=h.tag,m!==void 0&&((h&2)!==0||(h&4)!==0)&&Oa(i,n,m),u=u.next}while(u!==l)}Qn(e,n,i);break;case 1:if(!Tt&&(Kr(i,n),l=i.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=i.memoizedProps,l.state=i.memoizedState,l.componentWillUnmount()}catch(_){at(i,n,_)}Qn(e,n,i);break;case 21:Qn(e,n,i);break;case 22:i.mode&1?(Tt=(l=Tt)||i.memoizedState!==null,Qn(e,n,i),Tt=l):Qn(e,n,i);break;default:Qn(e,n,i)}}function Uh(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new Sg),n.forEach(function(l){var u=Og.bind(null,e,l);i.has(l)||(i.add(l),l.then(u,u))})}}function cn(e,n){var i=n.deletions;if(i!==null)for(var l=0;l<i.length;l++){var u=i[l];try{var h=e,m=n,_=m;e:for(;_!==null;){switch(_.tag){case 5:kt=_.stateNode,an=!1;break e;case 3:kt=_.stateNode.containerInfo,an=!0;break e;case 4:kt=_.stateNode.containerInfo,an=!0;break e}_=_.return}if(kt===null)throw Error(r(160));zh(h,m,u),kt=null,an=!1;var b=u.alternate;b!==null&&(b.return=null),u.return=null}catch(R){at(u,n,R)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)Wh(n,e),n=n.sibling}function Wh(e,n){var i=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(cn(n,e),_n(e),l&4){try{Qs(3,e,e.return),yo(3,e)}catch(me){at(e,e.return,me)}try{Qs(5,e,e.return)}catch(me){at(e,e.return,me)}}break;case 1:cn(n,e),_n(e),l&512&&i!==null&&Kr(i,i.return);break;case 5:if(cn(n,e),_n(e),l&512&&i!==null&&Kr(i,i.return),e.flags&32){var u=e.stateNode;try{Be(u,"")}catch(me){at(e,e.return,me)}}if(l&4&&(u=e.stateNode,u!=null)){var h=e.memoizedProps,m=i!==null?i.memoizedProps:h,_=e.type,b=e.updateQueue;if(e.updateQueue=null,b!==null)try{_==="input"&&h.type==="radio"&&h.name!=null&&pe(u,h),gl(_,m);var R=gl(_,h);for(m=0;m<b.length;m+=2){var W=b[m],V=b[m+1];W==="style"?lr(u,V):W==="dangerouslySetInnerHTML"?Te(u,V):W==="children"?Be(u,V):je(u,W,V,R)}switch(_){case"input":Ie(u,h);break;case"textarea":oe(u,h);break;case"select":var z=u._wrapperState.wasMultiple;u._wrapperState.wasMultiple=!!h.multiple;var re=h.value;re!=null?Ge(u,!!h.multiple,re,!1):z!==!!h.multiple&&(h.defaultValue!=null?Ge(u,!!h.multiple,h.defaultValue,!0):Ge(u,!!h.multiple,h.multiple?[]:"",!1))}u[Os]=h}catch(me){at(e,e.return,me)}}break;case 6:if(cn(n,e),_n(e),l&4){if(e.stateNode===null)throw Error(r(162));u=e.stateNode,h=e.memoizedProps;try{u.nodeValue=h}catch(me){at(e,e.return,me)}}break;case 3:if(cn(n,e),_n(e),l&4&&i!==null&&i.memoizedState.isDehydrated)try{Cs(n.containerInfo)}catch(me){at(e,e.return,me)}break;case 4:cn(n,e),_n(e);break;case 13:cn(n,e),_n(e),u=e.child,u.flags&8192&&(h=u.memoizedState!==null,u.stateNode.isHidden=h,!h||u.alternate!==null&&u.alternate.memoizedState!==null||(Wa=ut())),l&4&&Uh(e);break;case 22:if(W=i!==null&&i.memoizedState!==null,e.mode&1?(Tt=(R=Tt)||W,cn(n,e),Tt=R):cn(n,e),_n(e),l&8192){if(R=e.memoizedState!==null,(e.stateNode.isHidden=R)&&!W&&(e.mode&1)!==0)for(le=e,W=e.child;W!==null;){for(V=le=W;le!==null;){switch(z=le,re=z.child,z.tag){case 0:case 11:case 14:case 15:Qs(4,z,z.return);break;case 1:Kr(z,z.return);var de=z.stateNode;if(typeof de.componentWillUnmount=="function"){l=z,i=z.return;try{n=l,de.props=n.memoizedProps,de.state=n.memoizedState,de.componentWillUnmount()}catch(me){at(l,i,me)}}break;case 5:Kr(z,z.return);break;case 22:if(z.memoizedState!==null){Vh(V);continue}}re!==null?(re.return=z,le=re):Vh(V)}W=W.sibling}e:for(W=null,V=e;;){if(V.tag===5){if(W===null){W=V;try{u=V.stateNode,R?(h=u.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(_=V.stateNode,b=V.memoizedProps.style,m=b!=null&&b.hasOwnProperty("display")?b.display:null,_.style.display=Vt("display",m))}catch(me){at(e,e.return,me)}}}else if(V.tag===6){if(W===null)try{V.stateNode.nodeValue=R?"":V.memoizedProps}catch(me){at(e,e.return,me)}}else if((V.tag!==22&&V.tag!==23||V.memoizedState===null||V===e)&&V.child!==null){V.child.return=V,V=V.child;continue}if(V===e)break e;for(;V.sibling===null;){if(V.return===null||V.return===e)break e;W===V&&(W=null),V=V.return}W===V&&(W=null),V.sibling.return=V.return,V=V.sibling}}break;case 19:cn(n,e),_n(e),l&4&&Uh(e);break;case 21:break;default:cn(n,e),_n(e)}}function _n(e){var n=e.flags;if(n&2){try{e:{for(var i=e.return;i!==null;){if(Fh(i)){var l=i;break e}i=i.return}throw Error(r(160))}switch(l.tag){case 5:var u=l.stateNode;l.flags&32&&(Be(u,""),l.flags&=-33);var h=$h(e);$a(e,h,u);break;case 3:case 4:var m=l.stateNode.containerInfo,_=$h(e);Fa(e,_,m);break;default:throw Error(r(161))}}catch(b){at(e,e.return,b)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function Eg(e,n,i){le=e,Bh(e)}function Bh(e,n,i){for(var l=(e.mode&1)!==0;le!==null;){var u=le,h=u.child;if(u.tag===22&&l){var m=u.memoizedState!==null||vo;if(!m){var _=u.alternate,b=_!==null&&_.memoizedState!==null||Tt;_=vo;var R=Tt;if(vo=m,(Tt=b)&&!R)for(le=u;le!==null;)m=le,b=m.child,m.tag===22&&m.memoizedState!==null?Yh(u):b!==null?(b.return=m,le=b):Yh(u);for(;h!==null;)le=h,Bh(h),h=h.sibling;le=u,vo=_,Tt=R}Hh(e)}else(u.subtreeFlags&8772)!==0&&h!==null?(h.return=u,le=h):Hh(e)}}function Hh(e){for(;le!==null;){var n=le;if((n.flags&8772)!==0){var i=n.alternate;try{if((n.flags&8772)!==0)switch(n.tag){case 0:case 11:case 15:Tt||yo(5,n);break;case 1:var l=n.stateNode;if(n.flags&4&&!Tt)if(i===null)l.componentDidMount();else{var u=n.elementType===n.type?i.memoizedProps:ln(n.type,i.memoizedProps);l.componentDidUpdate(u,i.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var h=n.updateQueue;h!==null&&Ud(n,h,l);break;case 3:var m=n.updateQueue;if(m!==null){if(i=null,n.child!==null)switch(n.child.tag){case 5:i=n.child.stateNode;break;case 1:i=n.child.stateNode}Ud(n,m,i)}break;case 5:var _=n.stateNode;if(i===null&&n.flags&4){i=_;var b=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":b.autoFocus&&i.focus();break;case"img":b.src&&(i.src=b.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var R=n.alternate;if(R!==null){var W=R.memoizedState;if(W!==null){var V=W.dehydrated;V!==null&&Cs(V)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Tt||n.flags&512&&Aa(n)}catch(z){at(n,n.return,z)}}if(n===e){le=null;break}if(i=n.sibling,i!==null){i.return=n.return,le=i;break}le=n.return}}function Vh(e){for(;le!==null;){var n=le;if(n===e){le=null;break}var i=n.sibling;if(i!==null){i.return=n.return,le=i;break}le=n.return}}function Yh(e){for(;le!==null;){var n=le;try{switch(n.tag){case 0:case 11:case 15:var i=n.return;try{yo(4,n)}catch(b){at(n,i,b)}break;case 1:var l=n.stateNode;if(typeof l.componentDidMount=="function"){var u=n.return;try{l.componentDidMount()}catch(b){at(n,u,b)}}var h=n.return;try{Aa(n)}catch(b){at(n,h,b)}break;case 5:var m=n.return;try{Aa(n)}catch(b){at(n,m,b)}}}catch(b){at(n,n.return,b)}if(n===e){le=null;break}var _=n.sibling;if(_!==null){_.return=n.return,le=_;break}le=n.return}}var Ig=Math.ceil,_o=he.ReactCurrentDispatcher,za=he.ReactCurrentOwner,en=he.ReactCurrentBatchConfig,He=0,vt=null,ht=null,Ct=0,Xt=0,Jr=Wn(0),mt=0,Gs=null,xr=0,wo=0,Ua=0,Xs=null,At=null,Wa=0,Zr=1/0,En=null,bo=!1,Ba=null,Gn=null,No=!1,Xn=null,ko=0,qs=0,Ha=null,Co=-1,So=0;function Lt(){return(He&6)!==0?ut():Co!==-1?Co:Co=ut()}function qn(e){return(e.mode&1)===0?1:(He&2)!==0&&Ct!==0?Ct&-Ct:hg.transition!==null?(So===0&&(So=Fu()),So):(e=Xe,e!==0||(e=window.event,e=e===void 0?16:Qu(e.type)),e)}function un(e,n,i,l){if(50<qs)throw qs=0,Ha=null,Error(r(185));_s(e,i,l),((He&2)===0||e!==vt)&&(e===vt&&((He&2)===0&&(wo|=i),mt===4&&Kn(e,Ct)),Ft(e,l),i===1&&He===0&&(n.mode&1)===0&&(Zr=ut()+500,Zi&&Hn()))}function Ft(e,n){var i=e.callbackNode;h0(e,n);var l=Mi(e,e===vt?Ct:0);if(l===0)i!==null&&Du(i),e.callbackNode=null,e.callbackPriority=0;else if(n=l&-l,e.callbackPriority!==n){if(i!=null&&Du(i),n===1)e.tag===0?dg(Gh.bind(null,e)):Pd(Gh.bind(null,e)),lg(function(){(He&6)===0&&Hn()}),i=null;else{switch($u(l)){case 1:i=Nl;break;case 4:i=Ou;break;case 16:i=Ti;break;case 536870912:i=Au;break;default:i=Ti}i=nf(i,Qh.bind(null,e))}e.callbackPriority=n,e.callbackNode=i}}function Qh(e,n){if(Co=-1,So=0,(He&6)!==0)throw Error(r(327));var i=e.callbackNode;if(es()&&e.callbackNode!==i)return null;var l=Mi(e,e===vt?Ct:0);if(l===0)return null;if((l&30)!==0||(l&e.expiredLanes)!==0||n)n=jo(e,l);else{n=l;var u=He;He|=2;var h=qh();(vt!==e||Ct!==n)&&(En=null,Zr=ut()+500,yr(e,n));do try{Pg();break}catch(_){Xh(e,_)}while(!0);aa(),_o.current=h,He=u,ht!==null?n=0:(vt=null,Ct=0,n=mt)}if(n!==0){if(n===2&&(u=kl(e),u!==0&&(l=u,n=Va(e,u))),n===1)throw i=Gs,yr(e,0),Kn(e,l),Ft(e,ut()),i;if(n===6)Kn(e,l);else{if(u=e.current.alternate,(l&30)===0&&!Tg(u)&&(n=jo(e,l),n===2&&(h=kl(e),h!==0&&(l=h,n=Va(e,h))),n===1))throw i=Gs,yr(e,0),Kn(e,l),Ft(e,ut()),i;switch(e.finishedWork=u,e.finishedLanes=l,n){case 0:case 1:throw Error(r(345));case 2:_r(e,At,En);break;case 3:if(Kn(e,l),(l&130023424)===l&&(n=Wa+500-ut(),10<n)){if(Mi(e,0)!==0)break;if(u=e.suspendedLanes,(u&l)!==l){Lt(),e.pingedLanes|=e.suspendedLanes&u;break}e.timeoutHandle=Kl(_r.bind(null,e,At,En),n);break}_r(e,At,En);break;case 4:if(Kn(e,l),(l&4194240)===l)break;for(n=e.eventTimes,u=-1;0<l;){var m=31-rn(l);h=1<<m,m=n[m],m>u&&(u=m),l&=~h}if(l=u,l=ut()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*Ig(l/1960))-l,10<l){e.timeoutHandle=Kl(_r.bind(null,e,At,En),l);break}_r(e,At,En);break;case 5:_r(e,At,En);break;default:throw Error(r(329))}}}return Ft(e,ut()),e.callbackNode===i?Qh.bind(null,e):null}function Va(e,n){var i=Xs;return e.current.memoizedState.isDehydrated&&(yr(e,n).flags|=256),e=jo(e,n),e!==2&&(n=At,At=i,n!==null&&Ya(n)),e}function Ya(e){At===null?At=e:At.push.apply(At,e)}function Tg(e){for(var n=e;;){if(n.flags&16384){var i=n.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var l=0;l<i.length;l++){var u=i[l],h=u.getSnapshot;u=u.value;try{if(!sn(h(),u))return!1}catch{return!1}}}if(i=n.child,n.subtreeFlags&16384&&i!==null)i.return=n,n=i;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Kn(e,n){for(n&=~Ua,n&=~wo,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var i=31-rn(n),l=1<<i;e[i]=-1,n&=~l}}function Gh(e){if((He&6)!==0)throw Error(r(327));es();var n=Mi(e,0);if((n&1)===0)return Ft(e,ut()),null;var i=jo(e,n);if(e.tag!==0&&i===2){var l=kl(e);l!==0&&(n=l,i=Va(e,l))}if(i===1)throw i=Gs,yr(e,0),Kn(e,n),Ft(e,ut()),i;if(i===6)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,_r(e,At,En),Ft(e,ut()),null}function Qa(e,n){var i=He;He|=1;try{return e(n)}finally{He=i,He===0&&(Zr=ut()+500,Zi&&Hn())}}function vr(e){Xn!==null&&Xn.tag===0&&(He&6)===0&&es();var n=He;He|=1;var i=en.transition,l=Xe;try{if(en.transition=null,Xe=1,e)return e()}finally{Xe=l,en.transition=i,He=n,(He&6)===0&&Hn()}}function Ga(){Xt=Jr.current,tt(Jr)}function yr(e,n){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,og(i)),ht!==null)for(i=ht.return;i!==null;){var l=i;switch(ra(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&Ki();break;case 3:Xr(),tt(Mt),tt(jt),va();break;case 5:ga(l);break;case 4:Xr();break;case 13:tt(it);break;case 19:tt(it);break;case 10:ca(l.type._context);break;case 22:case 23:Ga()}i=i.return}if(vt=e,ht=e=Jn(e.current,null),Ct=Xt=n,mt=0,Gs=null,Ua=wo=xr=0,At=Xs=null,pr!==null){for(n=0;n<pr.length;n++)if(i=pr[n],l=i.interleaved,l!==null){i.interleaved=null;var u=l.next,h=i.pending;if(h!==null){var m=h.next;h.next=u,l.next=m}i.pending=l}pr=null}return e}function Xh(e,n){do{var i=ht;try{if(aa(),uo.current=mo,ho){for(var l=ot.memoizedState;l!==null;){var u=l.queue;u!==null&&(u.pending=null),l=l.next}ho=!1}if(gr=0,xt=pt=ot=null,Ws=!1,Bs=0,za.current=null,i===null||i.return===null){mt=1,Gs=n,ht=null;break}e:{var h=e,m=i.return,_=i,b=n;if(n=Ct,_.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){var R=b,W=_,V=W.tag;if((W.mode&1)===0&&(V===0||V===11||V===15)){var z=W.alternate;z?(W.updateQueue=z.updateQueue,W.memoizedState=z.memoizedState,W.lanes=z.lanes):(W.updateQueue=null,W.memoizedState=null)}var re=_h(m);if(re!==null){re.flags&=-257,wh(re,m,_,h,n),re.mode&1&&yh(h,R,n),n=re,b=R;var de=n.updateQueue;if(de===null){var me=new Set;me.add(b),n.updateQueue=me}else de.add(b);break e}else{if((n&1)===0){yh(h,R,n),Xa();break e}b=Error(r(426))}}else if(rt&&_.mode&1){var dt=_h(m);if(dt!==null){(dt.flags&65536)===0&&(dt.flags|=256),wh(dt,m,_,h,n),oa(qr(b,_));break e}}h=b=qr(b,_),mt!==4&&(mt=2),Xs===null?Xs=[h]:Xs.push(h),h=m;do{switch(h.tag){case 3:h.flags|=65536,n&=-n,h.lanes|=n;var E=xh(h,b,n);zd(h,E);break e;case 1:_=b;var N=h.type,I=h.stateNode;if((h.flags&128)===0&&(typeof N.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Gn===null||!Gn.has(I)))){h.flags|=65536,n&=-n,h.lanes|=n;var G=vh(h,_,n);zd(h,G);break e}}h=h.return}while(h!==null)}Jh(i)}catch(ge){n=ge,ht===i&&i!==null&&(ht=i=i.return);continue}break}while(!0)}function qh(){var e=_o.current;return _o.current=mo,e===null?mo:e}function Xa(){(mt===0||mt===3||mt===2)&&(mt=4),vt===null||(xr&268435455)===0&&(wo&268435455)===0||Kn(vt,Ct)}function jo(e,n){var i=He;He|=2;var l=qh();(vt!==e||Ct!==n)&&(En=null,yr(e,n));do try{Rg();break}catch(u){Xh(e,u)}while(!0);if(aa(),He=i,_o.current=l,ht!==null)throw Error(r(261));return vt=null,Ct=0,mt}function Rg(){for(;ht!==null;)Kh(ht)}function Pg(){for(;ht!==null&&!r0();)Kh(ht)}function Kh(e){var n=tf(e.alternate,e,Xt);e.memoizedProps=e.pendingProps,n===null?Jh(e):ht=n,za.current=null}function Jh(e){var n=e;do{var i=n.alternate;if(e=n.return,(n.flags&32768)===0){if(i=kg(i,n,Xt),i!==null){ht=i;return}}else{if(i=Cg(i,n),i!==null){i.flags&=32767,ht=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{mt=6,ht=null;return}}if(n=n.sibling,n!==null){ht=n;return}ht=n=e}while(n!==null);mt===0&&(mt=5)}function _r(e,n,i){var l=Xe,u=en.transition;try{en.transition=null,Xe=1,Lg(e,n,i,l)}finally{en.transition=u,Xe=l}return null}function Lg(e,n,i,l){do es();while(Xn!==null);if((He&6)!==0)throw Error(r(327));i=e.finishedWork;var u=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var h=i.lanes|i.childLanes;if(f0(e,h),e===vt&&(ht=vt=null,Ct=0),(i.subtreeFlags&2064)===0&&(i.flags&2064)===0||No||(No=!0,nf(Ti,function(){return es(),null})),h=(i.flags&15990)!==0,(i.subtreeFlags&15990)!==0||h){h=en.transition,en.transition=null;var m=Xe;Xe=1;var _=He;He|=4,za.current=null,jg(e,i),Wh(i,e),Z0(Xl),Ai=!!Gl,Xl=Gl=null,e.current=i,Eg(i),s0(),He=_,Xe=m,en.transition=h}else e.current=i;if(No&&(No=!1,Xn=e,ko=u),h=e.pendingLanes,h===0&&(Gn=null),l0(i.stateNode),Ft(e,ut()),n!==null)for(l=e.onRecoverableError,i=0;i<n.length;i++)u=n[i],l(u.value,{componentStack:u.stack,digest:u.digest});if(bo)throw bo=!1,e=Ba,Ba=null,e;return(ko&1)!==0&&e.tag!==0&&es(),h=e.pendingLanes,(h&1)!==0?e===Ha?qs++:(qs=0,Ha=e):qs=0,Hn(),null}function es(){if(Xn!==null){var e=$u(ko),n=en.transition,i=Xe;try{if(en.transition=null,Xe=16>e?16:e,Xn===null)var l=!1;else{if(e=Xn,Xn=null,ko=0,(He&6)!==0)throw Error(r(331));var u=He;for(He|=4,le=e.current;le!==null;){var h=le,m=h.child;if((le.flags&16)!==0){var _=h.deletions;if(_!==null){for(var b=0;b<_.length;b++){var R=_[b];for(le=R;le!==null;){var W=le;switch(W.tag){case 0:case 11:case 15:Qs(8,W,h)}var V=W.child;if(V!==null)V.return=W,le=V;else for(;le!==null;){W=le;var z=W.sibling,re=W.return;if(Ah(W),W===R){le=null;break}if(z!==null){z.return=re,le=z;break}le=re}}}var de=h.alternate;if(de!==null){var me=de.child;if(me!==null){de.child=null;do{var dt=me.sibling;me.sibling=null,me=dt}while(me!==null)}}le=h}}if((h.subtreeFlags&2064)!==0&&m!==null)m.return=h,le=m;else e:for(;le!==null;){if(h=le,(h.flags&2048)!==0)switch(h.tag){case 0:case 11:case 15:Qs(9,h,h.return)}var E=h.sibling;if(E!==null){E.return=h.return,le=E;break e}le=h.return}}var N=e.current;for(le=N;le!==null;){m=le;var I=m.child;if((m.subtreeFlags&2064)!==0&&I!==null)I.return=m,le=I;else e:for(m=N;le!==null;){if(_=le,(_.flags&2048)!==0)try{switch(_.tag){case 0:case 11:case 15:yo(9,_)}}catch(ge){at(_,_.return,ge)}if(_===m){le=null;break e}var G=_.sibling;if(G!==null){G.return=_.return,le=G;break e}le=_.return}}if(He=u,Hn(),gn&&typeof gn.onPostCommitFiberRoot=="function")try{gn.onPostCommitFiberRoot(Ri,e)}catch{}l=!0}return l}finally{Xe=i,en.transition=n}}return!1}function Zh(e,n,i){n=qr(i,n),n=xh(e,n,1),e=Yn(e,n,1),n=Lt(),e!==null&&(_s(e,1,n),Ft(e,n))}function at(e,n,i){if(e.tag===3)Zh(e,e,i);else for(;n!==null;){if(n.tag===3){Zh(n,e,i);break}else if(n.tag===1){var l=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Gn===null||!Gn.has(l))){e=qr(i,e),e=vh(n,e,1),n=Yn(n,e,1),e=Lt(),n!==null&&(_s(n,1,e),Ft(n,e));break}}n=n.return}}function Mg(e,n,i){var l=e.pingCache;l!==null&&l.delete(n),n=Lt(),e.pingedLanes|=e.suspendedLanes&i,vt===e&&(Ct&i)===i&&(mt===4||mt===3&&(Ct&130023424)===Ct&&500>ut()-Wa?yr(e,0):Ua|=i),Ft(e,n)}function ef(e,n){n===0&&((e.mode&1)===0?n=1:(n=Li,Li<<=1,(Li&130023424)===0&&(Li=4194304)));var i=Lt();e=Cn(e,n),e!==null&&(_s(e,n,i),Ft(e,i))}function Dg(e){var n=e.memoizedState,i=0;n!==null&&(i=n.retryLane),ef(e,i)}function Og(e,n){var i=0;switch(e.tag){case 13:var l=e.stateNode,u=e.memoizedState;u!==null&&(i=u.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(r(314))}l!==null&&l.delete(n),ef(e,i)}var tf;tf=function(e,n,i){if(e!==null)if(e.memoizedProps!==n.pendingProps||Mt.current)Ot=!0;else{if((e.lanes&i)===0&&(n.flags&128)===0)return Ot=!1,Ng(e,n,i);Ot=(e.flags&131072)!==0}else Ot=!1,rt&&(n.flags&1048576)!==0&&Ld(n,to,n.index);switch(n.lanes=0,n.tag){case 2:var l=n.type;xo(e,n),e=n.pendingProps;var u=Wr(n,jt.current);Qr(n,i),u=wa(null,n,l,e,u,i);var h=ba();return n.flags|=1,typeof u=="object"&&u!==null&&typeof u.render=="function"&&u.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,Dt(l)?(h=!0,Ji(n)):h=!1,n.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,ha(n),u.updater=lo,n.stateNode=u,u._reactInternals=n,pa(n,l,e,i),n=Ta(null,n,l,!0,h,i)):(n.tag=0,rt&&h&&na(n),Pt(null,n,u,i),n=n.child),n;case 16:l=n.elementType;e:{switch(xo(e,n),e=n.pendingProps,u=l._init,l=u(l._payload),n.type=l,u=n.tag=Fg(l),e=ln(l,e),u){case 0:n=Ia(null,n,l,e,i);break e;case 1:n=jh(null,n,l,e,i);break e;case 11:n=bh(null,n,l,e,i);break e;case 14:n=Nh(null,n,l,ln(l.type,e),i);break e}throw Error(r(306,l,""))}return n;case 0:return l=n.type,u=n.pendingProps,u=n.elementType===l?u:ln(l,u),Ia(e,n,l,u,i);case 1:return l=n.type,u=n.pendingProps,u=n.elementType===l?u:ln(l,u),jh(e,n,l,u,i);case 3:e:{if(Eh(n),e===null)throw Error(r(387));l=n.pendingProps,h=n.memoizedState,u=h.element,$d(e,n),oo(n,l,null,i);var m=n.memoizedState;if(l=m.element,h.isDehydrated)if(h={element:l,isDehydrated:!1,cache:m.cache,pendingSuspenseBoundaries:m.pendingSuspenseBoundaries,transitions:m.transitions},n.updateQueue.baseState=h,n.memoizedState=h,n.flags&256){u=qr(Error(r(423)),n),n=Ih(e,n,l,i,u);break e}else if(l!==u){u=qr(Error(r(424)),n),n=Ih(e,n,l,i,u);break e}else for(Gt=Un(n.stateNode.containerInfo.firstChild),Qt=n,rt=!0,on=null,i=Gd(n,null,l,i),n.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Vr(),l===u){n=jn(e,n,i);break e}Pt(e,n,l,i)}n=n.child}return n;case 5:return Xd(n),e===null&&ia(n),l=n.type,u=n.pendingProps,h=e!==null?e.memoizedProps:null,m=u.children,ql(l,u)?m=null:h!==null&&ql(l,h)&&(n.flags|=32),Sh(e,n),Pt(e,n,m,i),n.child;case 6:return e===null&&ia(n),null;case 13:return Th(e,n,i);case 4:return ma(n,n.stateNode.containerInfo),l=n.pendingProps,e===null?n.child=Gr(n,null,l,i):Pt(e,n,l,i),n.child;case 11:return l=n.type,u=n.pendingProps,u=n.elementType===l?u:ln(l,u),bh(e,n,l,u,i);case 7:return Pt(e,n,n.pendingProps,i),n.child;case 8:return Pt(e,n,n.pendingProps.children,i),n.child;case 12:return Pt(e,n,n.pendingProps.children,i),n.child;case 10:e:{if(l=n.type._context,u=n.pendingProps,h=n.memoizedProps,m=u.value,Ke(ro,l._currentValue),l._currentValue=m,h!==null)if(sn(h.value,m)){if(h.children===u.children&&!Mt.current){n=jn(e,n,i);break e}}else for(h=n.child,h!==null&&(h.return=n);h!==null;){var _=h.dependencies;if(_!==null){m=h.child;for(var b=_.firstContext;b!==null;){if(b.context===l){if(h.tag===1){b=Sn(-1,i&-i),b.tag=2;var R=h.updateQueue;if(R!==null){R=R.shared;var W=R.pending;W===null?b.next=b:(b.next=W.next,W.next=b),R.pending=b}}h.lanes|=i,b=h.alternate,b!==null&&(b.lanes|=i),ua(h.return,i,n),_.lanes|=i;break}b=b.next}}else if(h.tag===10)m=h.type===n.type?null:h.child;else if(h.tag===18){if(m=h.return,m===null)throw Error(r(341));m.lanes|=i,_=m.alternate,_!==null&&(_.lanes|=i),ua(m,i,n),m=h.sibling}else m=h.child;if(m!==null)m.return=h;else for(m=h;m!==null;){if(m===n){m=null;break}if(h=m.sibling,h!==null){h.return=m.return,m=h;break}m=m.return}h=m}Pt(e,n,u.children,i),n=n.child}return n;case 9:return u=n.type,l=n.pendingProps.children,Qr(n,i),u=Jt(u),l=l(u),n.flags|=1,Pt(e,n,l,i),n.child;case 14:return l=n.type,u=ln(l,n.pendingProps),u=ln(l.type,u),Nh(e,n,l,u,i);case 15:return kh(e,n,n.type,n.pendingProps,i);case 17:return l=n.type,u=n.pendingProps,u=n.elementType===l?u:ln(l,u),xo(e,n),n.tag=1,Dt(l)?(e=!0,Ji(n)):e=!1,Qr(n,i),Hd(n,l,u),pa(n,l,u,i),Ta(null,n,l,!0,e,i);case 19:return Ph(e,n,i);case 22:return Ch(e,n,i)}throw Error(r(156,n.tag))};function nf(e,n){return Mu(e,n)}function Ag(e,n,i,l){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tn(e,n,i,l){return new Ag(e,n,i,l)}function qa(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Fg(e){if(typeof e=="function")return qa(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ve)return 11;if(e===lt)return 14}return 2}function Jn(e,n){var i=e.alternate;return i===null?(i=tn(e.tag,n,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=n,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,n=e.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function Eo(e,n,i,l,u,h){var m=2;if(l=e,typeof e=="function")qa(e)&&(m=1);else if(typeof e=="string")m=5;else e:switch(e){case L:return wr(i.children,u,h,n);case P:m=8,u|=8;break;case _e:return e=tn(12,i,n,u|2),e.elementType=_e,e.lanes=h,e;case fe:return e=tn(13,i,n,u),e.elementType=fe,e.lanes=h,e;case Me:return e=tn(19,i,n,u),e.elementType=Me,e.lanes=h,e;case De:return Io(i,u,h,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ae:m=10;break e;case ie:m=9;break e;case ve:m=11;break e;case lt:m=14;break e;case Qe:m=16,l=null;break e}throw Error(r(130,e==null?e:typeof e,""))}return n=tn(m,i,n,u),n.elementType=e,n.type=l,n.lanes=h,n}function wr(e,n,i,l){return e=tn(7,e,l,n),e.lanes=i,e}function Io(e,n,i,l){return e=tn(22,e,l,n),e.elementType=De,e.lanes=i,e.stateNode={isHidden:!1},e}function Ka(e,n,i){return e=tn(6,e,null,n),e.lanes=i,e}function Ja(e,n,i){return n=tn(4,e.children!==null?e.children:[],e.key,n),n.lanes=i,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function $g(e,n,i,l,u){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cl(0),this.expirationTimes=Cl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cl(0),this.identifierPrefix=l,this.onRecoverableError=u,this.mutableSourceEagerHydrationData=null}function Za(e,n,i,l,u,h,m,_,b){return e=new $g(e,n,i,_,b),n===1?(n=1,h===!0&&(n|=8)):n=0,h=tn(3,null,null,n),e.current=h,h.stateNode=e,h.memoizedState={element:l,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},ha(h),e}function zg(e,n,i){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:J,key:l==null?null:""+l,children:e,containerInfo:n,implementation:i}}function rf(e){if(!e)return Bn;e=e._reactInternals;e:{if(cr(e)!==e||e.tag!==1)throw Error(r(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(Dt(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(r(171))}if(e.tag===1){var i=e.type;if(Dt(i))return Td(e,i,n)}return n}function sf(e,n,i,l,u,h,m,_,b){return e=Za(i,l,!0,e,u,h,m,_,b),e.context=rf(null),i=e.current,l=Lt(),u=qn(i),h=Sn(l,u),h.callback=n??null,Yn(i,h,u),e.current.lanes=u,_s(e,u,l),Ft(e,l),e}function To(e,n,i,l){var u=n.current,h=Lt(),m=qn(u);return i=rf(i),n.context===null?n.context=i:n.pendingContext=i,n=Sn(h,m),n.payload={element:e},l=l===void 0?null:l,l!==null&&(n.callback=l),e=Yn(u,n,m),e!==null&&(un(e,u,m,h),io(e,u,m)),m}function Ro(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function of(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<n?i:n}}function ec(e,n){of(e,n),(e=e.alternate)&&of(e,n)}function Ug(){return null}var lf=typeof reportError=="function"?reportError:function(e){console.error(e)};function tc(e){this._internalRoot=e}Po.prototype.render=tc.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(r(409));To(e,n,null,null)},Po.prototype.unmount=tc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;vr(function(){To(null,e,null,null)}),n[wn]=null}};function Po(e){this._internalRoot=e}Po.prototype.unstable_scheduleHydration=function(e){if(e){var n=Wu();e={blockedOn:null,target:e,priority:n};for(var i=0;i<Fn.length&&n!==0&&n<Fn[i].priority;i++);Fn.splice(i,0,e),i===0&&Vu(e)}};function nc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Lo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function af(){}function Wg(e,n,i,l,u){if(u){if(typeof l=="function"){var h=l;l=function(){var R=Ro(m);h.call(R)}}var m=sf(n,l,e,0,null,!1,!1,"",af);return e._reactRootContainer=m,e[wn]=m.current,Ms(e.nodeType===8?e.parentNode:e),vr(),m}for(;u=e.lastChild;)e.removeChild(u);if(typeof l=="function"){var _=l;l=function(){var R=Ro(b);_.call(R)}}var b=Za(e,0,!1,null,null,!1,!1,"",af);return e._reactRootContainer=b,e[wn]=b.current,Ms(e.nodeType===8?e.parentNode:e),vr(function(){To(n,b,i,l)}),b}function Mo(e,n,i,l,u){var h=i._reactRootContainer;if(h){var m=h;if(typeof u=="function"){var _=u;u=function(){var b=Ro(m);_.call(b)}}To(n,m,e,u)}else m=Wg(i,n,e,u,l);return Ro(m)}zu=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var i=ys(n.pendingLanes);i!==0&&(Sl(n,i|1),Ft(n,ut()),(He&6)===0&&(Zr=ut()+500,Hn()))}break;case 13:vr(function(){var l=Cn(e,1);if(l!==null){var u=Lt();un(l,e,1,u)}}),ec(e,1)}},jl=function(e){if(e.tag===13){var n=Cn(e,134217728);if(n!==null){var i=Lt();un(n,e,134217728,i)}ec(e,134217728)}},Uu=function(e){if(e.tag===13){var n=qn(e),i=Cn(e,n);if(i!==null){var l=Lt();un(i,e,n,l)}ec(e,n)}},Wu=function(){return Xe},Bu=function(e,n){var i=Xe;try{return Xe=e,n()}finally{Xe=i}},yl=function(e,n,i){switch(n){case"input":if(Ie(e,i),n=i.name,i.type==="radio"&&n!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<i.length;n++){var l=i[n];if(l!==e&&l.form===e.form){var u=qi(l);if(!u)throw Error(r(90));H(l),Ie(l,u)}}}break;case"textarea":oe(e,i);break;case"select":n=i.value,n!=null&&Ge(e,!!i.multiple,n,!1)}},ju=Qa,Eu=vr;var Bg={usingClientEntryPoint:!1,Events:[As,zr,qi,Cu,Su,Qa]},Ks={findFiberByHostInstance:ur,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Hg={bundleType:Ks.bundleType,version:Ks.version,rendererPackageName:Ks.rendererPackageName,rendererConfig:Ks.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:he.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Pu(e),e===null?null:e.stateNode},findFiberByHostInstance:Ks.findFiberByHostInstance||Ug,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Do=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Do.isDisabled&&Do.supportsFiber)try{Ri=Do.inject(Hg),gn=Do}catch{}}return $t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bg,$t.createPortal=function(e,n){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nc(n))throw Error(r(200));return zg(e,n,null,i)},$t.createRoot=function(e,n){if(!nc(e))throw Error(r(299));var i=!1,l="",u=lf;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(u=n.onRecoverableError)),n=Za(e,1,!1,null,null,i,!1,l,u),e[wn]=n.current,Ms(e.nodeType===8?e.parentNode:e),new tc(n)},$t.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(r(188)):(e=Object.keys(e).join(","),Error(r(268,e)));return e=Pu(n),e=e===null?null:e.stateNode,e},$t.flushSync=function(e){return vr(e)},$t.hydrate=function(e,n,i){if(!Lo(n))throw Error(r(200));return Mo(null,e,n,!0,i)},$t.hydrateRoot=function(e,n,i){if(!nc(e))throw Error(r(405));var l=i!=null&&i.hydratedSources||null,u=!1,h="",m=lf;if(i!=null&&(i.unstable_strictMode===!0&&(u=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(m=i.onRecoverableError)),n=sf(n,null,e,1,i??null,u,!1,h,m),e[wn]=n.current,Ms(e),l)for(e=0;e<l.length;e++)i=l[e],u=i._getVersion,u=u(i._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[i,u]:n.mutableSourceEagerHydrationData.push(i,u);return new Po(n)},$t.render=function(e,n,i){if(!Lo(n))throw Error(r(200));return Mo(null,e,n,!1,i)},$t.unmountComponentAtNode=function(e){if(!Lo(e))throw Error(r(40));return e._reactRootContainer?(vr(function(){Mo(null,null,e,!1,function(){e._reactRootContainer=null,e[wn]=null})}),!0):!1},$t.unstable_batchedUpdates=Qa,$t.unstable_renderSubtreeIntoContainer=function(e,n,i,l){if(!Lo(i))throw Error(r(200));if(e==null||e._reactInternals===void 0)throw Error(r(38));return Mo(e,n,i,!1,l)},$t.version="18.2.0-next-9e3b772b8-20220608",$t}var gf;function Jg(){if(gf)return ic.exports;gf=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),ic.exports=Kg(),ic.exports}var xf;function Zg(){if(xf)return Oo;xf=1;var s=Jg();return Oo.createRoot=s.createRoot,Oo.hydrateRoot=s.hydrateRoot,Oo}var ex=Zg();const tx=_p(ex),nx=({children:s,activeTab:t,setActiveTab:r,isAdmin:o,onToggleAdmin:c,onDownloadDB:d,onUploadDB:f,onOpenSync:p,isSyncActive:g})=>{const x=F.useRef(null),k=[{id:"characters",label:"",icon:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})},{id:"connections",label:"",icon:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})},{id:"worlds",label:"",icon:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})},{id:"notes",label:"",icon:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})},{id:"admin",label:"",adminOnly:!0,icon:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"})}],y=C=>{var ne;const M=(ne=C.target.files)==null?void 0:ne[0];if(!M)return;const B=new FileReader;B.onload=ue=>{var je;const se=(je=ue.target)==null?void 0:je.result;typeof se=="string"&&f(se)},B.readAsText(M),x.current&&(x.current.value="")},v=()=>t==="notes"?"max-w-[1920px] w-full px-4 md:px-8":"max-w-6xl w-full px-4 py-8 md:px-12 md:py-12";return a.jsxs("div",{className:"min-h-screen flex flex-col md:flex-row bg-[#050505] text-stone-300",children:[a.jsxs("div",{className:"md:hidden flex items-center justify-between px-6 py-5 border-b border-stone-900 bg-[#050505]/95 backdrop-blur sticky top-0 z-40",children:[a.jsx("h1",{className:"text-lg font-serif font-bold tracking-[0.2em] text-stone-400 uppercase",children:""}),a.jsx("button",{onClick:c,className:`p-2 rounded-lg transition-all border ${o?"bg-emerald-950/20 border-emerald-900/50 text-emerald-500":"bg-stone-900/50 border-stone-800 text-stone-500"}`,children:a.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})]}),a.jsxs("aside",{className:"hidden md:flex w-64 border-r border-stone-900 flex-col fixed h-screen bg-[#050505] z-50",children:[a.jsx("div",{className:"p-8",children:a.jsx("h1",{className:"text-xl font-serif font-bold tracking-[0.2em] text-stone-400 uppercase",children:""})}),a.jsx("nav",{className:"flex-grow px-4 space-y-2",children:k.filter(C=>!C.adminOnly||o).map(C=>a.jsxs("button",{onClick:()=>r(C.id),className:`w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all flex items-center gap-3 ${t===C.id?"bg-stone-900 text-stone-100 border-l-2 border-emerald-500 rounded-l-none":"hover:bg-stone-900/50 text-stone-500 hover:text-stone-300"} ${C.adminOnly?"text-emerald-500/70":""}`,children:[a.jsx("svg",{className:"w-5 h-5 opacity-70",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.icon}),C.label]},C.id))}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("button",{onClick:p,className:`w-full py-2 px-3 rounded-lg border text-[9px] uppercase tracking-widest font-bold flex items-center justify-center gap-2 transition-all ${g?"bg-emerald-900/10 border-emerald-500/30 text-emerald-500 hover:bg-emerald-900/20":"bg-stone-900/30 border-stone-800 text-stone-600 hover:bg-stone-900/60 hover:text-stone-400"}`,children:[a.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${g?"bg-emerald-500 animate-pulse":"bg-stone-600"}`}),g?"":""]}),a.jsx("button",{onClick:c,className:`w-full py-3 text-[10px] uppercase tracking-widest font-bold rounded-md transition-all border ${o?"bg-emerald-950/20 border-emerald-900/50 text-emerald-500 shadow-lg shadow-emerald-900/10":"bg-stone-900/50 hover:bg-stone-900 border-stone-800 text-stone-400"}`,children:o?" ()":"  "})]})]}),a.jsx("nav",{className:"md:hidden fixed bottom-0 w-full bg-[#050505]/95 backdrop-blur-xl border-t border-stone-900 z-50 px-2 pb-safe-area",children:a.jsxs("div",{className:"flex justify-around items-center",children:[k.filter(C=>!C.adminOnly||o).map(C=>a.jsxs("button",{onClick:()=>r(C.id),className:`flex flex-col items-center justify-center py-3 px-2 w-full transition-all ${t===C.id?"text-emerald-500":"text-stone-600"}`,children:[a.jsx("svg",{className:"w-6 h-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.icon}),a.jsx("span",{className:"text-[9px] uppercase font-bold tracking-wider",children:C.label})]},C.id)),a.jsxs("button",{onClick:p,className:`flex flex-col items-center justify-center py-3 px-2 w-full transition-all ${g?"text-emerald-500":"text-stone-700"}`,children:[a.jsx("svg",{className:"w-6 h-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),a.jsx("span",{className:"text-[9px] uppercase font-bold tracking-wider",children:""})]})]})}),a.jsxs("main",{className:"flex-grow md:ml-64 min-h-screen relative pb-24 md:pb-0",children:[a.jsx("div",{className:`${v()} mx-auto transition-all duration-300 py-8 md:py-12`,children:s}),a.jsxs("div",{className:"fixed bottom-24 md:bottom-8 right-4 md:right-8 flex gap-3 z-40 scale-90 md:scale-100 origin-bottom-right",children:[a.jsx("input",{type:"file",ref:x,onChange:y,accept:".json",className:"hidden"}),a.jsx("button",{onClick:()=>{var C;return(C=x.current)==null?void 0:C.click()},className:"px-4 py-2 md:px-5 md:py-2.5 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 rounded-full text-[9px] md:text-[10px] uppercase tracking-widest font-bold text-emerald-500 transition-all backdrop-blur-sm shadow-lg shadow-emerald-900/10",children:" "}),a.jsx("button",{onClick:d,className:"px-4 py-2 md:px-5 md:py-2.5 bg-stone-900/80 hover:bg-stone-800 border border-stone-700 rounded-full text-[9px] md:text-[10px] uppercase tracking-widest font-bold text-stone-300 transition-all backdrop-blur-sm",children:" "})]})]})]})},rx=({character:s,isVisible:t=!0,staggerIndex:r=0,onClick:o})=>{const c=F.useRef(null),[d,f]=F.useState({x:0,y:0}),[p,g]=F.useState({x:50,y:50,opacity:0}),[x,k]=F.useState(!1),[y,v]=F.useState(!1),C=F.useMemo(()=>Array.from({length:8}).map((L,P)=>({id:P,left:`${Math.random()*100}%`,delay:`${Math.random()*.6}s`,duration:`${1+Math.random()}s`,size:`${1.5+Math.random()*2}px`})),[]),M=L=>{if(!c.current||!t)return;const P=c.current.getBoundingClientRect(),_e=P.left+P.width/2,ae=P.top+P.height/2,ie=-(L.clientY-ae)/(P.height/2)*12,ve=(L.clientX-_e)/(P.width/2)*12,fe=(L.clientX-P.left)/P.width*100,Me=(L.clientY-P.top)/P.height*100;f({x:ie,y:ve}),g({x:fe,y:Me,opacity:.5})},B=()=>t&&k(!0),ne=()=>{f({x:0,y:0}),g(L=>({...L,opacity:0})),k(!1),v(!1)},ue={objectFit:"cover",objectPosition:`${s.miniImageX??50}% ${s.miniImageY??50}%`,transformOrigin:`${s.miniImageX??50}% ${s.miniImageY??50}%`,transform:`scale(${s.miniImageScale??1})`},se=s.name.length,je=se>20?"text-sm":se>15?"text-base":"text-xl",he=x?`${-d.y*2.5}px ${d.x*2.5}px 50px -10px rgba(16, 185, 129, 0.3)`:"0 10px 15px -3px rgba(0, 0, 0, 0.1)",We=t?`${Math.min(r*45,900)}ms`:"0ms",J=y?.96:x?1.04:1;return a.jsx("div",{className:`relative mb-10 px-5 w-full sm:w-1/2 lg:w-1/4 perspective-2000 preserve-3d transition-opacity duration-500 ${t?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,style:{animation:t?"reveal-3d-fire 1.1s cubic-bezier(0.22, 1, 0.36, 1) both":"disappear-3d-fire 0.6s cubic-bezier(0.22, 1, 0.36, 1) both",animationDelay:t?We:"0ms"},children:a.jsxs("div",{className:"h-full relative preserve-3d pointer-events-none",children:[t&&C.map(L=>a.jsx("div",{className:"absolute bottom-4 bg-emerald-400 rounded-full blur-[0.5px] z-0 pointer-events-none",style:{left:L.left,width:L.size,height:L.size,animation:`ember-float ${L.duration} ease-out both`,animationDelay:`calc(${We} + ${L.delay})`,boxShadow:"0 0 6px #10b981"}},L.id)),a.jsx("div",{className:"absolute inset-0 bg-emerald-500/20 blur-[60px] rounded-full transition-opacity duration-700 pointer-events-none -z-10",style:{opacity:x?.45:0,transform:`translate3d(${-d.y*4}px, ${d.x*4}px, -50px) scale(${x?1.1:1})`}}),a.jsxs("div",{ref:c,onMouseMove:M,onMouseEnter:B,onMouseLeave:ne,onMouseDown:()=>t&&v(!0),onMouseUp:()=>v(!1),onClick:()=>t&&o(s.id),style:{transform:`rotateX(${d.x}deg) rotateY(${d.y}deg) scale(${J})`,boxShadow:he,transition:x&&!y?"transform 0.1s ease-out, box-shadow 0.1s ease-out":"transform 0.7s cubic-bezier(0.23, 1, 0.32, 1), box-shadow 0.7s ease"},className:"relative bg-[#0f0f0f]/80 border border-stone-900 rounded-2xl p-6 flex flex-col items-center group cursor-pointer h-full min-h-[320px] preserve-3d overflow-hidden backdrop-blur-sm pointer-events-auto z-10",children:[a.jsx("div",{className:"absolute inset-0 pointer-events-none z-20 transition-opacity duration-300",style:{background:`radial-gradient(circle at ${p.x}% ${p.y}%, rgba(255,255,255,0.12) 0%, transparent 60%)`,opacity:p.opacity}}),a.jsx("div",{className:`absolute inset-0 border border-emerald-500/20 rounded-2xl transition-opacity duration-500 pointer-events-none ${x?"opacity-100":"opacity-0"}`}),a.jsx("div",{className:"relative mt-2 shrink-0 translate-z-30 pointer-events-none",children:a.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden border-2 border-stone-800 group-hover:border-emerald-500/50 transition-all duration-500 bg-black shadow-2xl",children:a.jsx("img",{src:s.imageUrl,alt:s.name,style:ue,className:"w-full h-full opacity-80 group-hover:opacity-100 transition-all duration-700 group-hover:scale-110"})})}),a.jsxs("div",{className:"mt-6 flex flex-col items-center justify-center w-full px-2 shrink-0 translate-z-20 pointer-events-none",children:[a.jsx("h3",{className:`font-serif font-medium text-stone-100 group-hover:text-emerald-100 transition-colors text-center leading-tight line-clamp-1 ${je}`,children:s.name}),a.jsxs("div",{className:"flex items-center gap-1.5 mt-3",children:[s.age&&a.jsxs("div",{className:"bg-stone-900/60 border border-stone-800 px-2.5 py-1 rounded-lg flex items-baseline gap-1 shadow-inner",children:[a.jsx("span",{className:"text-[11px] font-bold text-stone-300 tracking-tight",children:s.age.toString().replace(/[^0-9]/g,"")||s.age}),a.jsx("span",{className:"text-[7px] font-black uppercase tracking-widest text-emerald-600/80",children:""})]}),s.height&&a.jsxs("div",{className:"bg-stone-900/60 border border-stone-800 px-2.5 py-1 rounded-lg flex items-baseline gap-1 shadow-inner",children:[a.jsx("span",{className:"text-[11px] font-bold text-stone-300 tracking-tight",children:s.height.toString().replace(/[^0-9]/g,"")||s.height}),a.jsx("span",{className:"text-[7px] font-black uppercase tracking-widest text-emerald-600/80",children:""})]})]})]}),a.jsx("div",{className:"mt-5 flex flex-wrap gap-1.5 justify-center content-start min-h-[28px] w-full px-1 translate-z-10 pointer-events-none",children:s.tags&&s.tags.length>0?a.jsx(a.Fragment,{children:s.tags.slice(0,3).map(L=>a.jsx("span",{className:"px-2 py-0.5 bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 text-[8px] uppercase tracking-wider font-black rounded-md whitespace-nowrap",children:L},L))}):a.jsx("div",{className:"h-4"})}),a.jsx("div",{className:"mt-auto pt-6 border-t border-stone-900/50 w-full flex justify-center shrink-0 translate-z-10 pointer-events-none",children:a.jsx("span",{className:"text-[8px] uppercase tracking-[0.3em] font-black text-stone-700 group-hover:text-emerald-500 transition-colors",children:" "})})]})]})})},sx=wp.memo(rx,(s,t)=>s.character.id===t.character.id&&JSON.stringify(s.character)===JSON.stringify(t.character)&&s.isVisible===t.isVisible&&s.staggerIndex===t.staggerIndex),vf=({imageUrl:s,scale:t,x:r,y:o,isCircular:c=!1,onUpdate:d})=>{const f=F.useRef(null),[p,g]=F.useState(!1),[x,k]=F.useState({x:0,y:0}),y=v=>{g(!0),k({x:v.clientX,y:v.clientY})};return F.useEffect(()=>{const v=M=>{if(!p||!f.current)return;const B=M.clientX-x.x,ne=M.clientY-x.y,ue=.2,se=r-B*ue/t,je=o-ne*ue/t;d({x:se,y:je}),k({x:M.clientX,y:M.clientY})},C=()=>g(!1);return p&&(window.addEventListener("mousemove",v),window.addEventListener("mouseup",C)),()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",C)}},[p,x,r,o,t,d]),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{ref:f,className:`relative overflow-hidden bg-black border border-stone-800 cursor-move group select-none shadow-2xl transition-all duration-500 hover:border-emerald-500/40 ${c?"w-48 h-48 rounded-full mx-auto":"aspect-[4/5] rounded-3xl w-full"}`,onMouseDown:y,children:[a.jsx("img",{src:s,alt:"",draggable:!1,style:{width:"100%",height:"100%",objectFit:"cover",objectPosition:`${r}% ${o}%`,transformOrigin:`${r}% ${o}%`,transform:`scale(${t})`},className:"pointer-events-none transition-opacity duration-300 opacity-90 group-hover:opacity-100"}),a.jsx("div",{className:"absolute inset-0 ring-1 ring-inset ring-white/5 pointer-events-none"}),a.jsx("div",{className:"absolute inset-0 bg-emerald-500/5 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity flex items-center justify-center",children:a.jsx("div",{className:"bg-black/60 backdrop-blur-md px-4 py-2 rounded-full border border-emerald-500/20",children:a.jsx("span",{className:"text-[9px] font-black text-emerald-400 uppercase tracking-[0.25em]",children:" "})})})]}),a.jsxs("div",{className:"bg-stone-900/60 p-4 rounded-2xl border border-stone-800/50 space-y-3 shadow-inner",children:[a.jsxs("div",{className:"flex justify-between items-center px-1",children:[a.jsx("span",{className:"text-[10px] font-black text-stone-500 uppercase tracking-widest",children:""}),a.jsxs("span",{className:"text-[10px] font-mono text-emerald-500 bg-emerald-500/10 px-2 py-0.5 rounded",children:[t.toFixed(2),"x"]})]}),a.jsx("input",{type:"range",min:"1",max:"5",step:"0.01",value:t,onChange:v=>d({scale:parseFloat(v.target.value)}),className:"w-full h-1.5 bg-stone-800 rounded-full appearance-none cursor-pointer accent-emerald-500"}),a.jsx("p",{className:"text-[8px] text-stone-700 text-center uppercase tracking-tighter",children:"      "})]})]})},zo=(s,t=800,r=.6)=>new Promise((o,c)=>{const d=new FileReader;d.readAsDataURL(s),d.onload=f=>{var g;const p=new Image;p.src=(g=f.target)==null?void 0:g.result,p.onload=()=>{const x=document.createElement("canvas");let k=p.width,y=p.height;k>t&&(y=y*t/k,k=t),x.width=k,x.height=y;const v=x.getContext("2d");if(v){v.drawImage(p,0,0,k,y);const C=x.toDataURL("image/jpeg",r);o(C)}else c(new Error("Canvas context not available"))},p.onerror=x=>c(x)},d.onerror=f=>c(f)}),dn=(s,t)=>{if(!s)return null;const r=/(\*\*.*?\*\*|__.*?__|~~.*?~~|\|\|.*?\|\||\[c=#[0-9a-fA-F]{3,6}\].*?\[\/c\]|\[link=.*?\].*?\[\/link\]|\[tip=.*?\].*?\[\/tip\]|\[char=.*?\].*?\[\/char\])/g;return s.split(r).map((c,d)=>{if(c.startsWith("**")&&c.endsWith("**")&&c.length>4)return a.jsx("strong",{className:"text-stone-100 font-bold",children:dn(c.slice(2,-2),t)},d);if(c.startsWith("__")&&c.endsWith("__")&&c.length>4)return a.jsx("em",{className:"text-stone-300 italic font-light",children:dn(c.slice(2,-2),t)},d);if(c.startsWith("~~")&&c.endsWith("~~")&&c.length>4)return a.jsx("span",{className:"line-through opacity-60 decoration-stone-500",children:dn(c.slice(2,-2),t)},d);if(c.startsWith("||")&&c.endsWith("||")&&c.length>4)return a.jsxs("span",{className:"group/spoiler relative cursor-help rounded bg-stone-800 px-1 py-0.5 mx-0.5 align-middle select-none transition-all hover:bg-stone-700",children:[a.jsx("span",{className:"opacity-0 group-hover/spoiler:opacity-100 transition-opacity duration-300 text-stone-200",children:dn(c.slice(2,-2),t)}),a.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-[9px] uppercase font-black tracking-widest text-stone-500 group-hover/spoiler:opacity-0 pointer-events-none transition-opacity",children:""})]},d);if(c.startsWith("[c=")&&c.endsWith("[/c]")){const f=c.match(/\[c=(#[0-9a-fA-F]{3,6})\](.*?)\[\/c\]/);if(f)return a.jsx("span",{style:{color:f[1]},className:"font-medium drop-shadow-sm",children:dn(f[2],t)},d)}if(c.startsWith("[link=")&&c.endsWith("[/link]")){const f=c.match(/\[link=(.*?)\](.*?)\[\/link\]/);if(f)return a.jsx("a",{href:f[1],target:"_blank",rel:"noopener noreferrer",className:"text-emerald-400 hover:text-emerald-300 hover:underline decoration-emerald-500/50 underline-offset-2 transition-colors cursor-pointer",onClick:p=>p.stopPropagation(),children:dn(f[2],t)},d)}if(c.startsWith("[char=")&&c.endsWith("[/char]")){const f=c.match(/\[char=(.*?)\](.*?)\[\/char\]/);if(f){const p=f[1],g=f[2];return a.jsxs("span",{onClick:x=>{x.stopPropagation(),t&&t(p)},className:"inline-flex items-center gap-1 text-amber-400 hover:text-amber-200 cursor-pointer transition-colors border-b border-amber-500/30 hover:border-amber-400 px-0.5 rounded hover:bg-amber-900/20 group/char",title:"  ",children:[a.jsx("svg",{className:"w-3 h-3 opacity-50 group-hover/char:opacity-100 transition-opacity",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),dn(g,t)]},d)}}if(c.startsWith("[tip=")&&c.endsWith("[/tip]")){const f=c.match(/\[tip=(.*?)\](.*?)\[\/tip\]/);if(f)return a.jsxs("span",{className:"relative group/tooltip cursor-help border-b border-dotted border-stone-500 hover:border-emerald-500 transition-colors inline-block leading-tight",children:[dn(f[2],t),a.jsxs("span",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-max max-w-[200px] p-2 bg-[#1a1a1a] border border-stone-700 rounded-lg text-xs text-stone-300 opacity-0 group-hover/tooltip:opacity-100 transition-opacity duration-200 pointer-events-none z-50 shadow-xl text-center whitespace-normal leading-tight",children:[f[1],a.jsx("span",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-stone-700"})]})]},d)}return c})},_c=(s,t)=>s?s.split(`
`).map((o,c)=>{const d=o.trim();return d?d==="---"?a.jsx("div",{className:"h-px w-full bg-gradient-to-r from-transparent via-stone-700 to-transparent my-6 opacity-50"},c):d.startsWith("# ")?a.jsx("h3",{className:"text-xl md:text-2xl font-serif text-emerald-100 border-b border-stone-800/60 pb-2 mb-3 mt-6 first:mt-0 italic",children:dn(d.slice(2),t)},c):d.startsWith("> ")?a.jsx("blockquote",{className:"border-l-2 border-emerald-500/40 bg-stone-900/20 pl-4 py-2 my-2 rounded-r-lg italic text-stone-400",children:dn(d.slice(2),t)},c):a.jsx("div",{className:"min-h-[1.5em] text-stone-300 leading-relaxed font-serif text-base md:text-lg break-words",children:dn(o,t)},c):a.jsx("div",{className:"h-4"},c)}):null,ix=({notes:s,characters:t,availableTags:r,availableHiddenTags:o,onUpdate:c,isAdmin:d,onSelectCharacter:f})=>{var A,Q;const[p,g]=F.useState("list"),[x,k]=F.useState(null),[y,v]=F.useState(new Set),[C,M]=F.useState({}),[B,ne]=F.useState(""),[ue,se]=F.useState(!1),[je,he]=F.useState("#10b981"),[We,J]=F.useState(!1),[L,P]=F.useState(""),[_e,ae]=F.useState([]),[ie,ve]=F.useState(!1),fe=F.useRef(null);F.useEffect(()=>{p!=="list"&&window.scrollTo({top:0,behavior:"smooth"})},[p]);const Me=(j,K)=>{if(!fe.current)return;const ye=fe.current.selectionStart,$e=fe.current.selectionEnd,T=C.content||"",H=T.substring(0,ye),ce=T.substring(ye,$e),S=T.substring($e),te=H+j+ce+K+S;M({...C,content:te}),setTimeout(()=>{if(fe.current){ie||fe.current.focus({preventScroll:!0});const pe=ce.length>0?ye+j.length+ce.length+K.length:ye+j.length;fe.current.setSelectionRange(pe,pe)}},0)},lt=j=>{if(!fe.current)return;const K=fe.current.selectionStart,ye=fe.current.selectionEnd,$e=C.content||"",T=$e.substring(0,K),H=$e.substring(K,ye),ce=$e.substring(ye),S=H.length>0?H:j.name,te=`${T}[char=${j.id}]${S}[/char]${ce}`;M({...C,content:te}),J(!1),P(""),ae([]),setTimeout(()=>{if(fe.current){ie||fe.current.focus({preventScroll:!0});const pe=K+`[char=${j.id}]${S}[/char]`.length;fe.current.setSelectionRange(pe,pe)}},0)};F.useEffect(()=>{if(fe.current&&p==="editor"&&!ie){const j=window.scrollY;fe.current.style.height="auto",fe.current.style.height=`${fe.current.scrollHeight}px`,window.scrollY!==j&&window.scrollTo({top:j,behavior:"instant"})}},[C.content,p,ie]);const Qe=j=>{v(K=>{const ye=new Set(K);return ye.has(j)?ye.delete(j):ye.add(j),ye})},De=j=>{j?(k(j.id),M({...j})):(k(null),M({title:"",content:""})),g("editor"),ne(""),se(!1),J(!1),ve(!1)},Y=()=>{g("list"),k(null),M({})},Z=()=>{if(!(!C.title||!C.content)){if(x){const j=s.map(K=>K.id===x?{...K,...C}:K);c(j)}else{const j={id:Date.now().toString(),title:C.title||"",content:C.content||"",date:new Date().toLocaleDateString("ru-RU"),authorId:C.authorId,targetId:C.targetId};c([j,...s])}Y()}},w=()=>{if(x&&window.confirm("     ?")){const j=s.filter(K=>K.id!==x);c(j),Y()}},O=j=>t.find(K=>K&&K.id===j),ee=F.useMemo(()=>t.filter(j=>j.name.toLowerCase().includes(B.toLowerCase())).sort((j,K)=>j.name.localeCompare(K.name)),[t,B]),ke=F.useMemo(()=>t.filter(j=>{const K=j.name.toLowerCase().includes(L.toLowerCase()),ye=_e.length===0||_e.every($e=>(j.tags||[]).includes($e)||(j.hiddenTags||[]).includes($e));return K&&ye}).sort((j,K)=>j.name.localeCompare(K.name)),[t,L,_e]),D=j=>{ae(K=>K.includes(j)?K.filter(ye=>ye!==j):[...K,j])};return p==="list"?a.jsxs("div",{className:"space-y-12 animate-in fade-in duration-500 w-full mx-auto pb-20",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-b border-stone-900/50 pb-8",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100 italic",children:""}),a.jsx("p",{className:"text-stone-500 uppercase tracking-[0.3em] text-[9px] font-black",children:"   "})]}),d&&a.jsxs("button",{onClick:()=>De(),className:"group relative bg-white hover:bg-emerald-50 text-black px-8 py-4 rounded-2xl text-[10px] uppercase tracking-[0.2em] font-black transition-all shadow-xl hover:shadow-emerald-500/10 flex items-center gap-3 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})," "]})]}),a.jsx("div",{className:"space-y-6",children:s.length===0?a.jsxs("div",{className:"py-32 text-center animate-slide-up-fade",style:{animationDelay:"100ms"},children:[a.jsx("div",{className:"w-16 h-16 bg-stone-900/20 rounded-full flex items-center justify-center mx-auto mb-6 border border-stone-800/50",children:a.jsx("svg",{className:"w-8 h-8 text-stone-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),a.jsx("p",{className:"text-stone-700 italic font-serif text-lg",children:" ,   .    ."})]}):s.map((j,K)=>{const ye=O(j.authorId),$e=O(j.targetId),T=y.has(j.id);return a.jsxs("article",{style:{animationDelay:`${K*100}ms`},className:`relative group bg-[#0a0a0a] border rounded-3xl p-6 md:p-8 transition-all duration-500 shadow-2xl overflow-hidden animate-slide-up-fade ${T?"border-emerald-900/40 bg-stone-950/80":"border-stone-900/60 hover:border-emerald-900/30"}`,children:[a.jsx("div",{className:`absolute top-0 right-0 w-64 h-64 bg-emerald-500/5 rounded-full blur-[100px] -translate-y-32 translate-x-32 pointer-events-none transition-opacity duration-700 ${T?"opacity-100":"opacity-0 group-hover:opacity-50"}`}),a.jsxs("div",{className:"relative z-10",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6",children:[a.jsx("div",{className:"flex items-center gap-3",children:ye?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-10 h-10 rounded-full border border-stone-800 overflow-hidden bg-black shrink-0",children:a.jsx("img",{src:ye.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${ye.miniImageX??50}% ${ye.miniImageY??50}%`,transformOrigin:`${ye.miniImageX??50}% ${ye.miniImageY??50}%`,transform:`scale(${ye.miniImageScale??1})`}})}),a.jsx("span",{className:"text-[10px] uppercase tracking-widest font-black text-stone-200",children:ye.name})]}):a.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-stone-700 bg-stone-900/50 px-3 py-1.5 rounded-lg",children:" "})}),a.jsx("div",{className:"h-px w-6 bg-stone-900"}),a.jsx("div",{className:"flex items-center gap-3",children:$e?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-emerald-500/60",children:":"}),a.jsx("div",{className:"w-10 h-10 rounded-full border border-emerald-900/20 overflow-hidden bg-black shrink-0",children:a.jsx("img",{src:$e.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${$e.miniImageX??50}% ${$e.miniImageY??50}%`,transformOrigin:`${$e.miniImageX??50}% ${$e.miniImageY??50}%`,transform:`scale(${$e.miniImageScale??1})`}})}),a.jsx("span",{className:"text-[10px] uppercase tracking-widest font-black text-emerald-400",children:$e.name})]}):a.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-stone-700",children:""})}),a.jsx("div",{className:"ml-auto text-[9px] font-black text-stone-800 uppercase tracking-[0.2em]",children:j.date})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:`font-serif font-bold transition-all duration-500 drop-shadow-md italic break-words ${T?"text-2xl md:text-3xl text-emerald-100 mb-6":"text-xl text-stone-300 group-hover:text-emerald-200"}`,children:j.title}),!T&&a.jsxs("button",{onClick:()=>Qe(j.id),className:"text-[10px] uppercase tracking-[0.2em] font-black text-stone-600 hover:text-emerald-500 transition-colors pt-4 flex items-center gap-2 outline-none group/btn animate-in fade-in duration-500",children:[a.jsx("span",{children:""}),a.jsx("svg",{className:"w-3 h-3 transition-transform group-hover/btn:translate-y-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),a.jsx("div",{className:`grid transition-[grid-template-rows,opacity] duration-500 ease-[cubic-bezier(0.4,0,0.2,1)] ${T?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"}`,children:a.jsxs("div",{className:"overflow-hidden min-h-0",children:[a.jsx("div",{className:"w-full h-px bg-gradient-to-r from-emerald-900/50 to-transparent my-6"}),a.jsx("div",{className:"space-y-2",children:_c(j.content,f)}),a.jsxs("div",{className:"mt-10 pt-6 border-t border-stone-900/50 flex justify-between items-center",children:[a.jsxs("button",{className:"text-[9px] uppercase tracking-[0.2em] font-black text-emerald-900 hover:text-emerald-600 transition-colors flex items-center gap-2",onClick:()=>Qe(j.id),children:[a.jsx("svg",{className:"w-3 h-3 rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),""]}),d&&a.jsxs("button",{onClick:()=>De(j),className:"flex items-center gap-2 bg-stone-900/50 hover:bg-stone-800 text-stone-400 px-4 py-2 rounded-lg text-[9px] uppercase font-black tracking-widest transition-all",children:[a.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),""]})]})]})})]})]},j.id)})})]}):p==="select-author"||p==="select-target"?a.jsxs("div",{className:"min-h-screen animate-in fade-in slide-in-from-bottom-4 duration-500 pb-20",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-b border-stone-900/50 pb-8 mb-8",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl font-serif text-stone-100 italic",children:p==="select-author"?" ":" "}),a.jsx("p",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-emerald-500/60 mt-2",children:"   "})]}),a.jsxs("button",{onClick:()=>g("editor"),className:"flex items-center gap-2 text-stone-500 hover:text-white transition-all text-[10px] uppercase font-bold tracking-widest",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"  "]})]}),a.jsx("div",{className:"mb-8",children:a.jsx("input",{type:"text",placeholder:"    ...",value:B,onChange:j=>ne(j.target.value),className:"w-full bg-stone-900/50 border border-stone-800 rounded-2xl px-6 py-4 text-sm text-stone-200 outline-none focus:border-emerald-500/50 transition-colors shadow-inner font-serif",autoFocus:!0})}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("button",{onClick:()=>{M({...C,[p==="select-author"?"authorId":"targetId"]:void 0}),g("editor")},className:"flex items-center gap-4 p-4 rounded-2xl border border-stone-800 hover:border-red-900/50 hover:bg-red-950/10 transition-all group text-left",children:[a.jsx("div",{className:"w-12 h-12 rounded-full border border-stone-800 group-hover:border-red-500/30 bg-stone-900 flex items-center justify-center shrink-0 transition-colors",children:a.jsx("svg",{className:"w-5 h-5 text-stone-600 group-hover:text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("span",{className:"text-stone-400 font-bold text-sm block truncate group-hover:text-red-400 transition-colors",children:" "}),a.jsx("span",{className:"text-[9px] uppercase tracking-widest text-stone-600 block truncate",children:" "})]})]}),ee.map(j=>a.jsxs("button",{onClick:()=>{M({...C,[p==="select-author"?"authorId":"targetId"]:j.id}),g("editor")},className:"flex items-center gap-4 p-4 rounded-2xl bg-[#0a0a0a] hover:bg-emerald-950/10 border border-stone-900 hover:border-emerald-900/30 transition-all group text-left",children:[a.jsx("div",{className:"w-12 h-12 rounded-full border border-stone-800 group-hover:border-emerald-500/50 bg-black overflow-hidden shrink-0 transition-colors",children:a.jsx("img",{src:j.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${j.miniImageX??50}% ${j.miniImageY??50}%`,transformOrigin:`${j.miniImageX??50}% ${j.miniImageY??50}%`,transform:`scale(${j.miniImageScale??1})`}})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("span",{className:"text-stone-300 font-bold text-sm block truncate group-hover:text-emerald-300 transition-colors",children:j.name}),a.jsx("span",{className:"text-[9px] uppercase tracking-widest text-stone-600 block truncate",children:""})]})]},j.id))]})]}):a.jsxs("div",{className:"min-h-screen animate-in fade-in slide-in-from-bottom-4 duration-500 flex flex-col pb-20",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6 border-b border-stone-900/50 pb-6 mb-8 shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:Y,className:"group p-3 rounded-full border border-stone-800 hover:bg-stone-900 transition-all text-stone-500 hover:text-white",children:a.jsx("svg",{className:"w-5 h-5 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl font-serif text-stone-100 font-bold italic",children:x?" ":" "}),a.jsx("p",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-emerald-500/60 mt-1",children:"   "})]})]}),a.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[x&&a.jsx("button",{onClick:w,className:"px-6 py-3 bg-red-950/10 hover:bg-red-900/20 border border-red-900/30 text-red-500/70 hover:text-red-500 rounded-xl text-[10px] uppercase tracking-widest font-black transition-all flex-grow md:flex-grow-0",children:""}),a.jsxs("button",{onClick:Z,disabled:!C.title||!C.content,className:"px-8 py-3 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 text-emerald-500 rounded-xl text-[10px] uppercase tracking-widest font-black transition-all shadow-lg hover:shadow-emerald-900/10 disabled:opacity-30 disabled:cursor-not-allowed flex-grow md:flex-grow-0 flex items-center justify-center gap-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),""]})]})]}),a.jsxs("div",{className:"flex-grow flex flex-col space-y-8",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 shrink-0",children:[a.jsxs("button",{onClick:()=>g("select-author"),className:`group relative p-4 rounded-3xl border transition-all text-left flex items-center gap-5 ${C.authorId?"bg-emerald-950/10 border-emerald-900/30":"bg-stone-900/20 border-stone-800/50 hover:border-emerald-900/30"}`,children:[a.jsx("div",{className:`w-14 h-14 rounded-full border-2 overflow-hidden bg-black shrink-0 transition-transform group-hover:scale-105 ${C.authorId?"border-emerald-500 shadow-[0_0_15px_rgba(16,185,129,0.3)]":"border-stone-800"}`,children:C.authorId?(()=>{const j=O(C.authorId);return j?a.jsx("img",{src:j.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${j.miniImageX??50}% ${j.miniImageY??50}%`,transformOrigin:`${j.miniImageX??50}% ${j.miniImageY??50}%`,transform:`scale(${j.miniImageScale??1})`}}):null})():a.jsx("div",{className:"w-full h-full flex items-center justify-center text-stone-800",children:a.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-[9px] uppercase tracking-widest font-black text-stone-600 mb-1",children:":"}),a.jsx("p",{className:`text-sm font-bold truncate ${C.authorId?"text-stone-100":"text-stone-700 italic"}`,children:C.authorId?(A=O(C.authorId))==null?void 0:A.name:" "})]})]}),a.jsxs("button",{onClick:()=>g("select-target"),className:`group relative p-4 rounded-3xl border transition-all text-left flex items-center gap-5 ${C.targetId?"bg-amber-950/10 border-amber-900/30":"bg-stone-900/20 border-stone-800/50 hover:border-amber-900/30"}`,children:[a.jsx("div",{className:`w-14 h-14 rounded-full border-2 overflow-hidden bg-black shrink-0 transition-transform group-hover:scale-105 ${C.targetId?"border-amber-500 shadow-[0_0_15px_rgba(245,158,11,0.3)]":"border-stone-800"}`,children:C.targetId?(()=>{const j=O(C.targetId);return j?a.jsx("img",{src:j.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${j.miniImageX??50}% ${j.miniImageY??50}%`,transformOrigin:`${j.miniImageX??50}% ${j.miniImageY??50}%`,transform:`scale(${j.miniImageScale??1})`}}):null})():a.jsx("div",{className:"w-full h-full flex items-center justify-center text-stone-800",children:a.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-[9px] uppercase tracking-widest font-black text-stone-600 mb-1",children:":"}),a.jsx("p",{className:`text-sm font-bold truncate ${C.targetId?"text-stone-100":"text-stone-700 italic"}`,children:C.targetId?(Q=O(C.targetId))==null?void 0:Q.name:""})]})]})]}),a.jsx("div",{className:"space-y-4",children:a.jsx("input",{placeholder:"  ...",className:"w-full bg-transparent border-b-2 border-stone-800 px-2 py-4 text-stone-100 outline-none focus:border-emerald-500/40 transition-all font-serif font-bold italic text-3xl md:text-4xl placeholder-stone-700",value:C.title||"",onChange:j=>M({...C,title:j.target.value})})}),a.jsxs("div",{className:"flex-grow flex flex-col w-full relative group/editor",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4 px-1 sticky top-0 bg-[#050505] z-10 py-2 border-b border-stone-900/50",children:[a.jsx("label",{className:"text-[10px] uppercase tracking-[0.4em] font-black text-stone-600",children:" "}),a.jsxs("div",{className:"flex flex-wrap gap-1 bg-stone-900/50 p-1 rounded-lg border border-stone-800",children:[a.jsx("button",{type:"button",disabled:ie,onClick:j=>{j.preventDefault(),Me("**","**")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 font-serif font-bold text-lg transition-colors ${ie?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:"B"}),a.jsx("button",{type:"button",disabled:ie,onClick:j=>{j.preventDefault(),Me("__","__")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 font-serif italic text-lg transition-colors ${ie?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:"I"}),a.jsx("button",{type:"button",disabled:ie,onClick:j=>{j.preventDefault(),Me("~~","~~")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 line-through decoration-emerald-500/50 transition-colors ${ie?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:"S"}),a.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),a.jsx("button",{type:"button",disabled:ie,onClick:j=>{j.preventDefault(),Me("# ","")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 font-serif font-bold transition-colors ${ie?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:"H"}),a.jsx("button",{type:"button",disabled:ie,onClick:j=>{j.preventDefault(),Me("> ","")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ie?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:a.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M14.017 21L14.017 18C14.017 16.896 14.321 16.067 14.929 15.513C15.537 14.959 16.485 14.682 17.773 14.682V14.128C17.773 13.068 17.411 12.152 16.687 11.38C15.963 10.608 14.887 10.222 13.459 10.222V4.99998C15.827 4.99998 17.754 5.75398 19.24 7.26198C20.726 8.76998 21.469 10.871 21.469 13.565V21H14.017ZM2.53699 21L2.53699 18C2.53699 16.896 2.84099 16.067 3.44899 15.513C4.05699 14.959 5.00499 14.682 6.29299 14.682V14.128C6.29299 13.068 5.93099 12.152 5.20699 11.38C4.48299 10.608 3.40699 10.222 1.97899 10.222V4.99998C4.34699 4.99998 6.27399 5.75398 7.75999 7.26198C9.24599 8.76998 9.98899 10.871 9.98899 13.565V21H2.53699Z"})})}),a.jsx("button",{type:"button",disabled:ie,onClick:j=>{j.preventDefault(),Me("---","")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ie?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:a.jsx("div",{className:"w-4 h-0.5 bg-current opacity-50"})}),a.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{type:"button",disabled:ie,onClick:j=>{j.preventDefault(),J(!We)},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ie?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-amber-400"}`,title:" ",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),We&&!ie&&a.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-[#1a1a1a] border border-stone-700 rounded-xl shadow-2xl z-50 animate-in fade-in zoom-in-95 duration-200 w-72 md:w-80",children:a.jsxs("div",{className:"space-y-3",children:[a.jsx("input",{autoFocus:!0,type:"text",placeholder:"...",value:L,onChange:j=>P(j.target.value),className:"w-full bg-stone-900 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-amber-500/50 transition-colors"}),((r==null?void 0:r.length)||0)>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5 max-h-20 overflow-y-auto custom-scrollbar",children:r==null?void 0:r.map(j=>{const K=_e.includes(j);return a.jsx("button",{onClick:ye=>{ye.preventDefault(),D(j)},className:`px-2 py-1 rounded text-[8px] uppercase font-bold tracking-wider transition-all border ${K?"bg-amber-500/20 border-amber-500/40 text-amber-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:j},j)})}),a.jsx("div",{className:"max-h-48 overflow-y-auto custom-scrollbar space-y-1",children:ke.length===0?a.jsx("p",{className:"text-center text-[10px] text-stone-600 italic py-2",children:"  "}):ke.map(j=>a.jsxs("button",{onClick:K=>{K.preventDefault(),lt(j)},className:"w-full flex items-center gap-3 p-2 hover:bg-stone-900 rounded-lg text-left transition-colors group",children:[a.jsx("div",{className:"w-6 h-6 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:a.jsx("img",{src:j.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${j.miniImageX??50}% ${j.miniImageY??50}%`,transform:`scale(${j.miniImageScale??1})`,transformOrigin:`${j.miniImageX??50}% ${j.miniImageY??50}%`}})}),a.jsx("span",{className:"text-xs font-bold text-stone-300 group-hover:text-amber-400 truncate",children:j.name})]},j.id))})]})})]}),a.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),a.jsx("button",{type:"button",onClick:j=>{j.preventDefault(),Me("[link=]","[/link]")},className:"w-8 h-8 flex items-center justify-center rounded-md hover:bg-stone-800 text-stone-400 hover:text-emerald-400 transition-colors",title:"",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),a.jsx("button",{type:"button",onClick:j=>{j.preventDefault(),Me("[tip=]","[/tip]")},className:"w-8 h-8 flex items-center justify-center rounded-md hover:bg-stone-800 text-stone-400 hover:text-emerald-400 transition-colors",title:"",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsx("button",{type:"button",onClick:j=>{j.preventDefault(),Me("||","||")},className:"w-8 h-8 flex items-center justify-center rounded-md hover:bg-stone-800 text-stone-400 hover:text-emerald-400 transition-colors",title:"",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{type:"button",onClick:j=>{j.preventDefault(),se(!ue)},className:"w-8 h-8 flex items-center justify-center rounded-md hover:bg-stone-800 text-stone-400 hover:text-emerald-400 transition-colors",title:"",children:a.jsx("div",{className:"w-3.5 h-3.5 rounded-full bg-gradient-to-br from-red-500 via-yellow-500 to-blue-500 border border-stone-600"})}),ue&&!ie&&a.jsxs("div",{className:"absolute top-full right-0 mt-2 p-3 bg-[#1a1a1a] border border-stone-700 rounded-xl shadow-2xl z-50 flex items-center gap-3 animate-in fade-in zoom-in-95 duration-200 min-w-[140px]",children:[a.jsx("input",{type:"color",className:"w-8 h-8 rounded cursor-pointer bg-transparent border-none p-0",value:je,onChange:j=>he(j.target.value)}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[8px] uppercase font-bold text-stone-500 tracking-wider",children:""}),a.jsx("span",{className:"text-[10px] font-mono text-stone-300",children:je})]}),a.jsx("button",{type:"button",onClick:j=>{j.preventDefault(),Me(`[c=${je}]`,"[/c]"),se(!1)},className:"ml-auto p-1.5 bg-emerald-500/20 text-emerald-500 hover:bg-emerald-500/30 rounded-lg transition-colors border border-emerald-500/30",title:"",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]})]})]})]}),a.jsxs("div",{className:"relative flex-grow min-h-[500px]",children:[a.jsx("div",{className:`w-full bg-[#030303] border border-stone-900 rounded-2xl px-6 py-6 text-stone-300 shadow-inner custom-scrollbar text-lg font-serif h-full overflow-y-auto break-words absolute inset-0 z-10 ${ie?"block":"hidden"}`,children:ie&&_c(C.content||"",f)}),a.jsx("textarea",{ref:fe,placeholder:"  ...",className:`w-full bg-[#030303] border border-stone-900 rounded-2xl px-6 py-6 text-stone-300 outline-none focus:border-emerald-500/40 transition-all resize-none leading-relaxed shadow-inner custom-scrollbar text-lg font-serif h-full min-h-[500px] overflow-hidden ${ie?"invisible pointer-events-none absolute inset-0":"block"}`,value:C.content||"",onChange:j=>M({...C,content:j.target.value})})]}),a.jsxs("div",{className:"flex justify-between items-start mt-2 px-2 pb-10",children:[a.jsx("p",{className:"text-[8px] text-stone-700 italic",children:": # , > , --- "}),a.jsx("p",{className:"text-[8px] text-stone-700 italic",children:"**B**, __I__, ~~S~~, ||Spoiler||, [c=hex]Color[/c], [link=url]Text[/link], [tip=Text]Trig[/tip], [char=ID]Name[/char]"})]})]})]})]})},ox=({character:s,isAdmin:t,allCharacters:r,availableTags:o,availableHiddenTags:c,worlds:d,notes:f=[],onBack:p,onSave:g,onSelectCharacter:x,onDeleteNote:k})=>{var ye,$e;const[y,v]=F.useState(s),[C,M]=F.useState(!1),[B,ne]=F.useState(!1),[ue,se]=F.useState(!1),[je,he]=F.useState(!1),[We,J]=F.useState(new Set),[L,P]=F.useState(""),[_e,ae]=F.useState([]);F.useEffect(()=>{v(s)},[s]);const ie=F.useMemo(()=>{var T,H;if(!d)return null;for(const ce of d){if((T=ce.characterIds)!=null&&T.includes(s.id))return ce.name;if(ce.subLocations){for(const S of ce.subLocations)if((H=S.characterIds)!=null&&H.includes(s.id))return`${ce.name} / ${S.name}`}}return null},[d,s.id]),ve=F.useMemo(()=>Array.isArray(f)?f.filter(T=>T&&(T.targetId===s.id||T.authorId===s.id)):[],[f,s.id]),fe=(T,H)=>{v(ce=>({...ce,[T]:H}))},Me=T=>{v(H=>({...H,imageScale:T.scale??H.imageScale,imageX:T.x??H.imageX,imageY:T.y??H.imageY}))},lt=T=>{v(H=>({...H,miniImageScale:T.scale??H.miniImageScale,miniImageX:T.x??H.miniImageX,miniImageY:T.y??H.miniImageY}))},Qe=async T=>{var ce;const H=(ce=T.target.files)==null?void 0:ce[0];if(H){he(!0);try{const S=await zo(H);fe("imageUrl",S)}catch(S){console.error("Error processing image",S),alert("   ")}finally{he(!1)}}},De=(T,H=!1)=>{if(H){const ce=y.hiddenTags||[],S=ce.includes(T)?ce.filter(te=>te!==T):[...ce,T];fe("hiddenTags",S)}else{const ce=y.tags||[],S=ce.includes(T)?ce.filter(te=>te!==T):[...ce,T];fe("tags",S)}},Y=()=>{g(y)},Z=()=>{v(s)},w=()=>{t&&g(y),p()},O=()=>{se(!ue),P(""),ae([])},ee=T=>{const H={id:T.id,name:T.name,role:"",color:"#ef4444"},ce=y.connections||[];ce.some(S=>S.id===T.id)||fe("connections",[...ce,H]),se(!1)},ke=T=>{const H=y.connections||[];fe("connections",H.filter(ce=>ce.id!==T))},D=(T,H)=>{const ce=y.connections||[];fe("connections",ce.map(S=>S.id===T?{...S,role:H}:S))},A=(T,H)=>{const ce=y.connections||[];fe("connections",ce.map(S=>S.id===T?{...S,color:H}:S))},Q=T=>{ae(H=>H.includes(T)?H.filter(ce=>ce!==T):[...H,T])},j=T=>{J(H=>{const ce=new Set(H);return ce.has(T)?ce.delete(T):ce.add(T),ce})},K=r.filter(T=>{var H;if(!T||T.id===y.id||(H=y.connections)!=null&&H.some(ce=>ce.id===T.id)||L&&!T.name.toLowerCase().includes(L.toLowerCase()))return!1;if(_e.length>0){const ce=[...T.tags||[],...T.hiddenTags||[]];return _e.every(S=>ce.includes(S))}return!0});return a.jsxs("div",{className:"animate-reveal-details space-y-6 md:space-y-8 pb-20",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4 animate-stagger-1",children:[a.jsxs("button",{onClick:w,className:"flex items-center text-stone-500 hover:text-emerald-500 transition-colors group text-sm md:text-base order-1",children:[a.jsx("svg",{className:"w-5 h-5 mr-2 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})," ()"]}),t&&a.jsxs("div",{className:"flex items-center gap-3 order-2 w-full md:w-auto justify-end",children:[a.jsx("button",{onClick:Z,className:"px-4 py-2 rounded-lg border border-stone-800 text-stone-500 hover:text-white hover:bg-stone-800 text-[10px] uppercase font-bold tracking-wider transition-all",children:""}),a.jsxs("button",{onClick:Y,className:"px-5 py-2 rounded-lg bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 hover:bg-emerald-900/40 text-[10px] uppercase font-bold tracking-wider transition-all flex items-center gap-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),""]})]})]}),a.jsxs("div",{className:"block clearfix",children:[a.jsxs("div",{className:"w-full lg:w-[35%] lg:float-left lg:mr-12 mb-8 space-y-8 animate-stagger-2",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("h4",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 px-1",children:" "}),t?a.jsxs("div",{className:"space-y-4",children:[a.jsx(vf,{imageUrl:y.imageUrl,scale:y.imageScale??1,x:y.imageX??50,y:y.imageY??50,onUpdate:Me}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{className:"w-full bg-[#050505] border border-stone-800 rounded-lg px-3 py-2 text-[10px] text-stone-400 outline-none focus:border-emerald-500",placeholder:y.imageUrl.startsWith("data:")?"   ":"URL ...",value:y.imageUrl.startsWith("data:")?"":y.imageUrl,onChange:T=>fe("imageUrl",T.target.value)}),a.jsxs("label",{className:`cursor-pointer bg-stone-900 border border-stone-800 hover:bg-stone-800 rounded-lg px-3 flex items-center justify-center transition-colors ${je?"opacity-50":""}`,children:[a.jsx("input",{type:"file",onChange:Qe,accept:"image/*",className:"hidden",disabled:je}),a.jsx("svg",{className:"w-4 h-4 text-emerald-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})]})]})]}):a.jsx("div",{className:"aspect-[4/5] rounded-2xl overflow-hidden border border-stone-800 shadow-2xl bg-black transition-transform duration-700 hover:scale-[1.02]",children:a.jsx("img",{src:y.imageUrl,alt:y.name,style:{objectFit:"cover",objectPosition:`${y.imageX??50}% ${y.imageY??50}%`,transformOrigin:`${y.imageX??50}% ${y.imageY??50}%`,transform:`scale(${y.imageScale??1})`},className:"w-full h-full"})})]}),t&&a.jsxs("div",{className:"space-y-4 pt-4 border-t border-stone-900/50",children:[a.jsx("h4",{className:"text-[10px] uppercase tracking-widest font-bold text-emerald-500/60 px-1",children:"- ()"}),a.jsx(vf,{imageUrl:y.imageUrl,scale:y.miniImageScale??1,x:y.miniImageX??50,y:y.miniImageY??50,isCircular:!0,onUpdate:lt})]}),a.jsxs("div",{className:"space-y-5 p-5 md:p-7 bg-[#0f0f0f]/40 border border-stone-900 rounded-[2rem] md:rounded-[2.5rem] shadow-inner transition-all hover:bg-[#0f0f0f]/50",children:[a.jsx("h4",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-emerald-500/60 px-1 text-center",children:""}),a.jsx("div",{className:"flex flex-wrap gap-2 justify-center min-h-[40px]",children:t?a.jsxs(a.Fragment,{children:[o.map(T=>{var H;return a.jsx("button",{onClick:()=>De(T,!1),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border ${(H=y.tags)!=null&&H.includes(T)?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400":"bg-stone-950 border-stone-800/50 text-stone-700 hover:text-stone-400"}`,children:T},T)}),o.length>0&&c.length>0&&a.jsx("div",{className:"w-full h-px bg-stone-900/50 my-1"}),c.map(T=>{var H;return a.jsx("button",{onClick:()=>De(T,!0),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border ${(H=y.hiddenTags)!=null&&H.includes(T)?"bg-amber-500/10 border-amber-500/40 text-amber-400":"bg-stone-950 border-stone-800/50 text-stone-700 hover:text-stone-400"}`,children:T},T)})]}):(ye=y.tags)==null?void 0:ye.map(T=>a.jsx("span",{className:"px-3 py-1.5 md:px-4 md:py-2 bg-emerald-500/5 border border-emerald-500/10 text-emerald-500/70 text-[9px] md:text-[10px] uppercase tracking-widest font-black rounded-xl",children:T},T))})]})]}),a.jsx("div",{className:"animate-stagger-3",children:a.jsxs("div",{className:"mb-6 md:mb-8",children:[t?a.jsx("div",{className:"space-y-4 mb-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[a.jsxs("div",{className:"flex-grow",children:[a.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-1",children:""}),a.jsx("input",{className:"w-full bg-transparent border-b border-stone-800 text-3xl md:text-4xl font-serif font-bold text-stone-100 outline-none focus:border-emerald-800 transition-colors py-1",value:y.name,onChange:T=>fe("name",T.target.value)})]}),a.jsxs("div",{className:"w-full md:w-32",children:[a.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-1",children:""}),a.jsx("input",{className:"w-full bg-transparent border-b border-stone-800 text-xl font-light text-stone-500 outline-none focus:border-emerald-800 transition-colors py-2",value:y.age,onChange:T=>fe("age",T.target.value)})]}),a.jsxs("div",{className:"w-full md:w-32",children:[a.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-1",children:""}),a.jsx("input",{className:"w-full bg-transparent border-b border-stone-800 text-xl font-light text-stone-500 outline-none focus:border-emerald-800 transition-colors py-2",value:y.height||"",placeholder:". 180 ",onChange:T=>fe("height",T.target.value)})]})]})}):a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 md:gap-6",children:[a.jsx("h1",{className:"text-3xl md:text-5xl font-serif font-bold text-stone-100 leading-tight",children:y.name}),a.jsxs("div",{className:"flex items-center gap-2",children:[y.age&&a.jsxs("div",{className:"bg-stone-900 border border-stone-800 px-3 py-1 rounded-xl flex items-baseline gap-1.5 shadow-lg",children:[a.jsx("span",{className:"text-stone-100 font-bold text-lg",children:y.age.toString().replace(/[^0-9]/g,"")||y.age}),a.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-emerald-500/70",children:""})]}),y.height&&a.jsxs("div",{className:"bg-stone-900 border border-stone-800 px-3 py-1 rounded-xl flex items-baseline gap-1.5 shadow-lg",children:[a.jsx("span",{className:"text-stone-100 font-bold text-lg",children:y.height.toString().replace(/[^0-9]/g,"")||y.height}),a.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-emerald-500/70",children:""})]})]})]}),ie&&a.jsxs("div",{className:"inline-flex items-center gap-2 bg-emerald-900/10 border border-emerald-900/30 px-3 py-1.5 rounded-full mt-2",children:[a.jsx("span",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"}),a.jsx("span",{className:"text-[10px] uppercase tracking-widest font-bold text-emerald-500",children:ie})]})]}),a.jsx("div",{className:"h-px bg-stone-900 w-full mb-6 md:mb-8"}),a.jsxs("section",{className:"space-y-4 mb-8",children:[a.jsx("h4",{className:"text-emerald-500 text-sm font-semibold uppercase tracking-wider",children:""}),t?a.jsx("textarea",{className:"w-full bg-stone-900/20 border border-stone-800 rounded-xl p-4 text-stone-200 text-base md:text-lg leading-relaxed font-light outline-none focus:border-emerald-900 transition-colors resize-none break-words",rows:12,value:y.additionalInfo,onChange:T=>fe("additionalInfo",T.target.value)}):a.jsx("p",{className:"text-stone-300 text-base md:text-lg leading-relaxed font-light whitespace-pre-wrap break-words",children:y.additionalInfo})]}),ve.length>0&&a.jsxs("div",{className:"space-y-3 mb-6",children:[a.jsxs("button",{onClick:()=>ne(!B),className:"w-full flex items-center justify-between bg-[#0f0f0f]/30 border border-stone-900 p-4 md:p-5 rounded-xl transition-all group hover:border-amber-900/30 shadow-md",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-amber-600 font-bold tracking-widest text-xs uppercase",children:"  "}),a.jsxs("span",{className:"text-stone-600 text-sm",children:["(",ve.length,")"]})]}),a.jsx("svg",{className:`w-4 h-4 text-stone-600 transition-transform duration-300 ${B?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]}),a.jsx("div",{className:`grid transition-[grid-template-rows,opacity] duration-500 ease-[cubic-bezier(0.4,0,0.2,1)] ${B?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"}`,children:a.jsx("div",{className:"overflow-hidden",children:a.jsx("div",{className:"space-y-4 pt-4",children:ve.map(T=>{const H=r.find(pe=>pe.id===T.authorId),ce=r.find(pe=>pe.id===T.targetId),S=T.authorId===s.id,te=We.has(T.id);return a.jsxs("div",{className:"bg-stone-900/20 border border-stone-900/50 rounded-xl p-4 md:p-5 hover:border-emerald-900/30 transition-colors",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3 border-b border-stone-900/50 pb-2",children:[a.jsx("div",{className:"flex items-center gap-2",children:S?a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-stone-600",children:":"}),a.jsx("span",{className:"text-[10px] uppercase tracking-widest font-bold text-emerald-500",children:ce?ce.name:""})]}):a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-stone-600",children:":"}),a.jsx("span",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-300",children:H?H.name:""})]})}),a.jsx("span",{className:"text-[9px] uppercase font-bold text-stone-700",children:T.date})]}),a.jsx("h5",{className:"text-stone-200 font-serif italic text-xl mb-2 break-words",children:T.title}),!te&&a.jsxs("button",{onClick:()=>j(T.id),className:"text-[9px] uppercase tracking-[0.2em] font-black text-stone-600 hover:text-emerald-500 transition-colors pt-2 flex items-center gap-1 outline-none",children:["",a.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a.jsx("div",{className:`grid transition-[grid-template-rows,opacity] duration-500 ease-[cubic-bezier(0.4,0,0.2,1)] ${te?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"}`,children:a.jsx("div",{className:"overflow-hidden",children:a.jsxs("div",{className:"pt-2",children:[a.jsx("div",{className:"text-stone-400 text-sm md:text-base leading-relaxed whitespace-pre-wrap font-light break-words",children:_c(T.content,x)}),a.jsxs("button",{onClick:()=>j(T.id),className:"text-[9px] uppercase tracking-[0.2em] font-black text-emerald-900 hover:text-emerald-600 transition-colors flex items-center gap-1 mt-4",children:[a.jsx("svg",{className:"w-3 h-3 rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),""]})]})})})]},T.id)})})})})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex flex-col gap-4",children:[t&&a.jsxs("button",{onClick:O,className:`w-full py-4 rounded-xl border transition-all text-[10px] uppercase font-bold tracking-[0.2em] flex items-center justify-center gap-3 ${ue?"bg-emerald-500 border-emerald-400 text-black shadow-[0_0_20px_rgba(16,185,129,0.2)]":"bg-emerald-900/20 border-emerald-900/50 text-emerald-400 hover:bg-emerald-900/30"}`,children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:ue?"M6 18L18 6M6 6l12 12":"M12 4v16m8-8H4"})}),ue?"":" "]}),a.jsxs("button",{onClick:()=>M(!C),className:"w-full flex items-center justify-between bg-[#0f0f0f]/30 border border-stone-900 p-4 md:p-5 rounded-xl transition-all group hover:border-emerald-900/30 shadow-md",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-emerald-500 font-bold tracking-widest text-xs uppercase",children:""}),a.jsxs("span",{className:"text-stone-600 text-sm",children:["(",(($e=y.connections)==null?void 0:$e.length)||0,")"]})]}),a.jsx("svg",{className:`w-4 h-4 text-stone-600 transition-transform duration-300 ${C?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]})]}),t&&ue&&a.jsxs("div",{className:"animate-reveal-details bg-[#0a0a0a] border border-emerald-900/30 rounded-2xl p-4 md:p-6 space-y-4 shadow-2xl overflow-hidden relative",children:[a.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:a.jsx("input",{autoFocus:!0,type:"text",placeholder:"   ...",className:"flex-grow bg-stone-950 border border-stone-800 rounded-xl px-4 py-3 text-sm text-stone-200 outline-none focus:border-emerald-500/50 transition-colors",value:L,onChange:T=>P(T.target.value)})}),a.jsx("div",{className:"flex flex-wrap gap-1.5 max-h-24 overflow-y-auto custom-scrollbar",children:o.map(T=>a.jsx("button",{onClick:()=>Q(T),className:`px-2 py-1 rounded-lg text-[9px] uppercase font-bold tracking-wider transition-all border ${_e.includes(T)?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:T},T))}),a.jsx("div",{className:"flex flex-col gap-2 max-h-60 overflow-y-auto custom-scrollbar pr-2",children:K.length>0?K.map(T=>a.jsxs("button",{onClick:()=>ee(T),className:"flex items-center gap-4 p-3 bg-stone-900/50 border border-stone-800 rounded-xl hover:bg-emerald-900/20 hover:border-emerald-900/40 transition-all text-left group",children:[a.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:a.jsx("img",{src:T.imageUrl,style:{objectFit:"cover",objectPosition:`${T.miniImageX??50}% ${T.miniImageY??50}%`,transformOrigin:`${T.miniImageX??50}% ${T.miniImageY??50}%`,transform:`scale(${T.miniImageScale??1})`},className:"w-full h-full",alt:""})}),a.jsxs("div",{className:"min-w-0 flex-grow",children:[a.jsx("span",{className:"text-stone-200 font-bold text-sm block truncate group-hover:text-emerald-400",children:T.name}),a.jsx("span",{className:"text-[10px] text-stone-600 uppercase tracking-widest block truncate",children:"  "})]}),a.jsx("svg",{className:"w-4 h-4 text-emerald-500 opacity-0 group-hover:opacity-100 transition-all",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})]},T.id)):a.jsx("p",{className:"text-stone-700 italic text-xs py-4 text-center",children:"  "})})]}),a.jsx("div",{className:`grid transition-[grid-template-rows,opacity] duration-500 ease-[cubic-bezier(0.4,0,0.2,1)] ${C?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"}`,children:a.jsx("div",{className:"overflow-hidden",children:a.jsx("div",{className:"space-y-3 pt-3",children:a.jsx("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-xl overflow-hidden divide-y divide-stone-900/50",children:y.connections&&y.connections.length>0?y.connections.map(T=>{const H=r.find(ce=>ce&&ce.id===T.id);return a.jsxs("div",{className:"p-4 flex flex-row items-center gap-4 group hover:bg-stone-900/20 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-4 flex-grow min-w-0",children:[a.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 rounded-full overflow-hidden border border-stone-800 shrink-0 bg-black",children:a.jsx("img",{src:(H==null?void 0:H.imageUrl)||"",style:{objectFit:"cover",objectPosition:`${(H==null?void 0:H.miniImageX)??50}% ${(H==null?void 0:H.miniImageY)??50}%`,transformOrigin:`${(H==null?void 0:H.miniImageX)??50}% ${(H==null?void 0:H.miniImageY)??50}%`,transform:`scale(${(H==null?void 0:H.miniImageScale)??1})`},className:"w-full h-full",alt:""})}),a.jsxs("div",{className:"flex-grow min-w-0",children:[a.jsx("p",{className:"text-stone-200 font-bold text-sm truncate",children:T.name}),t?a.jsx("input",{className:"bg-transparent border-b border-stone-800 text-xs text-stone-500 outline-none focus:border-emerald-500 py-1 w-full max-w-[150px]",value:T.role,onChange:ce=>D(T.id,ce.target.value)}):a.jsx("p",{className:"text-stone-600 text-xs mt-1 font-medium truncate",children:T.role})]})]}),a.jsxs("div",{className:"flex items-center justify-end gap-5 shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[t?a.jsx("input",{type:"color",className:"w-6 h-6 rounded-sm bg-transparent border-none cursor-pointer p-0 appearance-none shadow-lg",value:T.color||"#ef4444",onChange:ce=>A(T.id,ce.target.value)}):a.jsx("div",{className:"w-4 h-4 rounded-sm shadow-sm",style:{backgroundColor:T.color||"#ef4444"}}),a.jsx("button",{onClick:()=>x(T.id),className:"text-stone-700 hover:text-stone-100 transition-colors text-[9px] md:text-[10px] uppercase font-bold tracking-[0.2em]",children:""})]}),t&&a.jsx("button",{onClick:()=>ke(T.id),className:"text-stone-800 hover:text-red-500 transition-colors p-1",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})]},T.id)}):a.jsx("div",{className:"p-10 text-center text-stone-700 italic text-sm",children:"  "})})})})})]})]})})]})]})},lx=({initialData:s,availableTags:t,availableHiddenTags:r,onSave:o,onClose:c})=>{const[d,f]=F.useState({name:"",age:"",height:"",imageUrl:"",additionalInfo:"",imageScale:1,imageX:50,imageY:50,tags:[],hiddenTags:[]}),[p,g]=F.useState(!1);F.useEffect(()=>{var v;s&&f({name:s.name,age:s.age.toString(),height:((v=s.height)==null?void 0:v.toString())||"",imageUrl:s.imageUrl,additionalInfo:s.additionalInfo,imageScale:s.imageScale??1,imageX:s.imageX??50,imageY:s.imageY??50,tags:s.tags||[],hiddenTags:s.hiddenTags||[]})},[s]);const x=(v,C)=>{f(C?M=>({...M,hiddenTags:M.hiddenTags.includes(v)?M.hiddenTags.filter(B=>B!==v):[...M.hiddenTags,v]}):M=>({...M,tags:M.tags.includes(v)?M.tags.filter(B=>B!==v):[...M.tags,v]}))},k=async v=>{var M;const C=(M=v.target.files)==null?void 0:M[0];if(C){g(!0);try{const B=await zo(C);f(ne=>({...ne,imageUrl:B}))}catch(B){console.error("Error processing image",B),alert("   .")}finally{g(!1)}}},y=v=>{v.preventDefault();const C={id:(s==null?void 0:s.id)||Date.now().toString(),name:d.name,age:d.age,height:d.height,imageUrl:d.imageUrl||`https://picsum.photos/seed/${Date.now()}/400/500`,additionalInfo:d.additionalInfo,tags:d.tags,hiddenTags:d.hiddenTags,connections:(s==null?void 0:s.connections)||[],imageScale:d.imageScale,imageX:d.imageX,imageY:d.imageY};o(C)};return a.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center p-4 bg-black/95 backdrop-blur-2xl animate-in fade-in duration-300",children:a.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-2xl rounded-[2rem] md:rounded-[3rem] overflow-hidden shadow-[0_0_120px_rgba(0,0,0,1)] border-white/5 flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-6 md:p-10 border-b border-stone-900 flex justify-between items-center bg-gradient-to-b from-stone-900/30 to-transparent shrink-0",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl md:text-3xl font-serif text-stone-100 italic",children:s?" ":" "}),a.jsx("p",{className:"text-stone-600 text-[10px] uppercase tracking-widest mt-1",children:"  "})]}),a.jsx("button",{onClick:c,className:"text-stone-700 hover:text-white transition-all p-2 md:p-3 hover:bg-white/5 rounded-full",children:a.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("form",{onSubmit:y,className:"p-6 md:p-10 space-y-8 md:space-y-10 overflow-y-auto custom-scrollbar flex-grow",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:"  "}),a.jsx("input",{required:!0,className:"w-full bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-4 text-stone-100 outline-none focus:border-emerald-500/30 transition-all font-serif italic text-lg shadow-inner",value:d.name,onChange:v=>f({...d,name:v.target.value})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:""}),a.jsx("input",{required:!0,className:"w-full bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-4 text-stone-100 outline-none focus:border-emerald-500/30 transition-all shadow-inner",value:d.age,onChange:v=>f({...d,age:v.target.value})})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:""}),a.jsx("input",{className:"w-full bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-4 text-stone-100 outline-none focus:border-emerald-500/30 transition-all shadow-inner",value:d.height,placeholder:". 185 ",onChange:v=>f({...d,height:v.target.value})})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-end px-1",children:[a.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600",children:"  ()"}),a.jsxs("span",{className:"text-[9px] text-stone-800 font-black uppercase tracking-widest",children:[": ",d.tags.length]})]}),a.jsx("div",{className:"flex flex-wrap gap-2 p-6 bg-black/30 border border-stone-900 rounded-[2rem] min-h-[80px] shadow-inner",children:t.length===0?a.jsx("p",{className:"text-stone-800 italic text-xs w-full text-center py-4",children:"     -"}):t.map(v=>{const C=d.tags.includes(v);return a.jsx("button",{type:"button",onClick:()=>x(v,!1),className:`px-4 py-2 rounded-xl text-[10px] uppercase tracking-wider font-black transition-all border ${C?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":"bg-stone-900/20 border-stone-800/40 text-stone-600 hover:border-stone-700 hover:text-stone-400"}`,children:v},v)})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-end px-1",children:[a.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-amber-600",children:"  ()"}),a.jsxs("span",{className:"text-[9px] text-amber-900/60 font-black uppercase tracking-widest",children:[": ",d.hiddenTags.length]})]}),a.jsx("div",{className:"flex flex-wrap gap-2 p-6 bg-black/30 border border-amber-900/20 rounded-[2rem] min-h-[80px] shadow-inner",children:r.length===0?a.jsx("p",{className:"text-stone-800 italic text-xs w-full text-center py-4",children:"    "}):r.map(v=>{const C=d.hiddenTags.includes(v);return a.jsx("button",{type:"button",onClick:()=>x(v,!0),className:`px-4 py-2 rounded-xl text-[10px] uppercase tracking-wider font-black transition-all border ${C?"bg-amber-500/10 border-amber-500/40 text-amber-400 shadow-[0_0_15px_rgba(245,158,11,0.1)]":"bg-stone-900/20 border-stone-800/40 text-stone-600 hover:border-amber-900/30 hover:text-amber-500/50"}`,children:v},v)})})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:" (  )"}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[a.jsx("input",{className:"flex-grow bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-3 text-xs text-stone-500 outline-none focus:border-emerald-500/30 transition-all",placeholder:"    ...",value:d.imageUrl.startsWith("data:")?"":d.imageUrl,onChange:v=>f({...d,imageUrl:v.target.value})}),a.jsxs("label",{className:`cursor-pointer bg-stone-900/50 hover:bg-stone-800 px-5 py-3 rounded-2xl transition-all flex items-center justify-center border border-stone-800 gap-2 ${p?"opacity-50 cursor-wait":""}`,children:[a.jsx("input",{type:"file",accept:"image/*",onChange:k,className:"hidden",disabled:p}),a.jsx("svg",{className:"w-5 h-5 text-stone-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),d.imageUrl.startsWith("data:")&&a.jsx("span",{className:"text-[9px] font-bold text-emerald-500 uppercase tracking-wider",children:""})]})]}),d.imageUrl.startsWith("data:")&&a.jsx("p",{className:"text-[9px] text-emerald-500/70 px-2",children:"    ."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:" "}),a.jsx("textarea",{required:!0,rows:8,className:"w-full bg-stone-900/30 border border-stone-800 rounded-[2rem] px-8 py-6 text-stone-300 text-base leading-relaxed outline-none focus:border-emerald-900/30 transition-all resize-none shadow-inner custom-scrollbar",value:d.additionalInfo,onChange:v=>f({...d,additionalInfo:v.target.value})})]})]}),a.jsxs("div",{className:"p-6 md:p-10 border-t border-stone-900 bg-stone-900/10 flex gap-4 md:gap-6 shrink-0",children:[a.jsx("button",{type:"button",onClick:c,className:"flex-1 py-4 md:py-5 text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 hover:text-stone-300 transition-all",children:""}),a.jsx("button",{onClick:y,disabled:p,className:"flex-[2] py-4 md:py-5 bg-white hover:bg-emerald-50 text-black rounded-2xl text-[10px] uppercase tracking-[0.3em] font-black transition-all shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",children:p?"...":""})]})]})})},ax=({characters:s,availableTags:t,availableHiddenTags:r,onDelete:o,onEdit:c,onAdd:d,onUpdateTags:f,onUpdateHiddenTags:p,onDownloadDB:g,onUploadDB:x})=>{const[k,y]=F.useState(""),[v,C]=F.useState(""),M=F.useRef(null),B=L=>{L.preventDefault();const P=k.trim().toLowerCase();P&&!t.includes(P)&&(f([...t,P]),y(""))},ne=L=>{L.preventDefault();const P=v.trim().toLowerCase();P&&!r.includes(P)&&(p([...r,P]),C(""))},ue=L=>{f(t.filter(P=>P!==L))},se=L=>{p(r.filter(P=>P!==L))},je=(L,P,_e=!1)=>{const ae=_e?[...r]:[...t],ie=_e?p:f;P==="left"&&L>0?[ae[L-1],ae[L]]=[ae[L],ae[L-1]]:P==="right"&&L<ae.length-1&&([ae[L+1],ae[L]]=[ae[L],ae[L+1]]),ie(ae)},he=(L=!1)=>{window.confirm(` ,      ${L?"":""} ?`)&&(L?p([]):f([]))},We=L=>{var ae;const P=(ae=L.target.files)==null?void 0:ae[0];if(!P)return;const _e=new FileReader;_e.onload=ie=>{var fe;const ve=(fe=ie.target)==null?void 0:fe.result;typeof ve=="string"&&x(ve)},_e.readAsText(P),M.current&&(M.current.value="")},J=(L,P)=>a.jsx("div",{className:"flex flex-wrap gap-2 max-h-[300px] overflow-y-auto custom-scrollbar pr-2",children:L.length===0?a.jsx("p",{className:"text-stone-800 italic text-[10px] w-full text-center py-8",children:" ."}):L.map((_e,ae)=>a.jsxs("div",{className:`group flex items-center border rounded-xl pr-2 pl-1 py-1 transition-all hover:bg-stone-900 ${P?"bg-amber-900/10 border-amber-900/30 hover:border-amber-700":"bg-stone-900/50 border-stone-800/50 hover:border-stone-600"}`,children:[a.jsx("button",{onClick:()=>je(ae,"left",P),disabled:ae===0,className:`p-1 text-stone-600 hover:text-emerald-500 transition-all ${ae===0?"opacity-0 pointer-events-none":"opacity-0 group-hover:opacity-100"}`,children:a.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M15 19l-7-7 7-7"})})}),a.jsx("span",{className:`text-[10px] uppercase tracking-wider font-bold px-1 select-none ${P?"text-amber-500":"text-stone-500"}`,children:_e}),a.jsx("button",{onClick:()=>je(ae,"right",P),disabled:ae===L.length-1,className:`p-1 text-stone-600 hover:text-emerald-500 transition-all ${ae===L.length-1?"opacity-0 pointer-events-none":"opacity-0 group-hover:opacity-100"}`,children:a.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M9 5l7 7-7 7"})})}),a.jsx("div",{className:`w-px h-3 mx-1 ${P?"bg-amber-900/30":"bg-stone-800"}`}),a.jsx("button",{onClick:()=>P?se(_e):ue(_e),className:"text-stone-700 hover:text-red-500 transition-colors ml-1",children:a.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:a.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]},_e))});return a.jsxs("div",{className:"space-y-12 animate-in fade-in duration-700 pb-32",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-b border-stone-900/50 pb-8",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100",children:""}),a.jsx("p",{className:"text-stone-500 uppercase tracking-widest text-[10px]",children:"   "})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("input",{type:"file",ref:M,onChange:We,accept:".json",className:"hidden"}),a.jsxs("button",{onClick:()=>{var L;return(L=M.current)==null?void 0:L.click()},className:"px-5 py-2.5 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 rounded-lg text-[10px] uppercase tracking-widest font-bold text-emerald-500 transition-all flex items-center gap-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})," "]}),a.jsxs("button",{onClick:g,className:"px-5 py-2.5 bg-stone-900/80 hover:bg-stone-800 border border-stone-700 rounded-lg text-[10px] uppercase tracking-widest font-bold text-stone-300 transition-all flex items-center gap-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})," "]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("h2",{className:"text-2xl font-serif text-stone-100 italic",children:" "}),a.jsx("span",{className:"text-[10px] bg-emerald-500/10 text-emerald-500 px-2 py-0.5 rounded-full font-black",children:s.length})]}),a.jsx("button",{onClick:d,className:"bg-white hover:bg-emerald-50 text-black px-6 py-2 rounded-full text-[10px] uppercase tracking-widest font-black transition-all",children:""})]}),a.jsx("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl overflow-hidden shadow-xl",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left min-w-[600px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-stone-900 bg-stone-900/20",children:[a.jsx("th",{className:"px-6 py-5 text-[10px] uppercase tracking-widest font-black text-stone-600",children:""}),a.jsx("th",{className:"px-6 py-5 text-[10px] uppercase tracking-widest font-black text-stone-600",children:""}),a.jsx("th",{className:"px-6 py-5 text-[10px] uppercase tracking-widest font-black text-stone-600 text-right",children:""})]})}),a.jsx("tbody",{className:"divide-y divide-stone-900/50",children:s.map(L=>{var P,_e,ae,ie;return a.jsxs("tr",{className:"hover:bg-stone-900/10 transition-colors",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:a.jsx("img",{src:L.imageUrl,style:{objectFit:"cover",objectPosition:`${L.miniImageX??50}% ${L.miniImageY??50}%`,transformOrigin:`${L.miniImageX??50}% ${L.miniImageY??50}%`,transform:`scale(${L.miniImageScale??1})`},className:"w-full h-full",alt:""})}),a.jsx("span",{className:"font-bold text-stone-200 text-sm tracking-wide",children:L.name})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:"flex flex-wrap gap-1",children:[(P=L.tags)==null?void 0:P.slice(0,3).map(ve=>a.jsx("span",{className:"text-[8px] uppercase bg-stone-900 px-1.5 py-0.5 rounded text-stone-500",children:ve},ve)),(((_e=L.tags)==null?void 0:_e.length)||0)>3&&a.jsxs("span",{className:"text-[8px] text-stone-700",children:["+",L.tags.length-3]})]}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[(ae=L.hiddenTags)==null?void 0:ae.slice(0,3).map(ve=>a.jsx("span",{className:"text-[8px] uppercase bg-amber-900/20 border border-amber-900/30 px-1.5 py-0.5 rounded text-amber-600",children:ve},ve)),(((ie=L.hiddenTags)==null?void 0:ie.length)||0)>3&&a.jsxs("span",{className:"text-[8px] text-amber-700",children:["+",L.hiddenTags.length-3]})]})]})}),a.jsxs("td",{className:"px-6 py-4 text-right space-x-3",children:[a.jsx("button",{onClick:()=>c(L),className:"text-emerald-500/70 hover:text-emerald-500 text-[10px] font-black uppercase tracking-widest transition-colors",children:""}),a.jsx("button",{onClick:()=>o(L.id),className:"text-stone-800 hover:text-red-500 text-[10px] font-black uppercase tracking-widest transition-colors",children:""})]})]},L.id)})})]})})})]}),a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl p-6 space-y-6 shadow-xl",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-serif text-stone-100 italic",children:" "}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[10px] bg-stone-800 text-stone-400 px-2 py-0.5 rounded-full font-black",children:t.length}),t.length>0&&a.jsx("button",{onClick:()=>he(!1),className:"text-[8px] text-red-900 hover:text-red-500 uppercase font-black",children:""})]})]}),a.jsxs("form",{onSubmit:B,className:"flex gap-2",children:[a.jsx("input",{type:"text",value:k,onChange:L=>y(L.target.value),placeholder:" ...",className:"flex-grow bg-black/50 border border-stone-800 rounded-xl px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-all"}),a.jsx("button",{className:"bg-stone-800 hover:bg-stone-700 text-white p-2 rounded-xl transition-all",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{d:"M12 4v16m8-8H4",strokeWidth:2.5})})})]}),J(t,!1)]}),a.jsxs("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl p-6 space-y-6 shadow-xl relative overflow-hidden",children:[a.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-amber-500/5 rounded-full blur-2xl -translate-y-10 translate-x-10 pointer-events-none"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-serif text-amber-500 italic",children:" "}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[10px] bg-amber-900/20 text-amber-500 px-2 py-0.5 rounded-full font-black",children:r.length}),r.length>0&&a.jsx("button",{onClick:()=>he(!0),className:"text-[8px] text-red-900 hover:text-red-500 uppercase font-black",children:""})]})]}),a.jsxs("form",{onSubmit:ne,className:"flex gap-2",children:[a.jsx("input",{type:"text",value:v,onChange:L=>C(L.target.value),placeholder:"  ...",className:"flex-grow bg-black/50 border border-amber-900/30 rounded-xl px-3 py-2 text-xs text-stone-200 outline-none focus:border-amber-500/50 transition-all placeholder-amber-900/50"}),a.jsx("button",{className:"bg-amber-900/20 hover:bg-amber-900/40 text-amber-500 border border-amber-900/30 p-2 rounded-xl transition-all",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{d:"M12 4v16m8-8H4",strokeWidth:2.5})})})]}),J(r,!0)]})]})]})]})},cx="modulepreload",ux=function(s){return"/raz/"+s},yf={},_f=function(t,r,o){let c=Promise.resolve();if(r&&r.length>0){let f=function(x){return Promise.all(x.map(k=>Promise.resolve(k).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),g=(p==null?void 0:p.nonce)||(p==null?void 0:p.getAttribute("nonce"));c=f(r.map(x=>{if(x=ux(x),x in yf)return;yf[x]=!0;const k=x.endsWith(".css"),y=k?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${y}`))return;const v=document.createElement("link");if(v.rel=k?"stylesheet":cx,k||(v.as="script"),v.crossOrigin="",v.href=x,g&&v.setAttribute("nonce",g),document.head.appendChild(v),k)return new Promise((C,M)=>{v.addEventListener("load",C),v.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${x}`)))})}))}function d(f){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=f,window.dispatchEvent(p),!p.defaultPrevented)throw f}return c.then(f=>{for(const p of f||[])p.status==="rejected"&&d(p.reason);return t().catch(d)})},dx=({characters:s,availableTags:t,availableHiddenTags:r,filterStates:o,onToggleTag:c,onClearFilters:d,onSelectCharacter:f})=>{var ce;const[p,g]=F.useState("graph"),[x,k]=F.useState(""),[y,v]=F.useState(!1),[C,M]=F.useState(""),[B,ne]=F.useState([]),ue=F.useRef(null),[se,je]=F.useState(!1),[he,We]=F.useState(null),[J,L]=F.useState(null),[P,_e]=F.useState(0),[ae,ie]=F.useState(!0),[ve,fe]=F.useState(!1),Me=F.useRef(null),lt=F.useRef(null),Qe=F.useRef(null),De=F.useRef(null),Y=F.useRef(new Map),[Z,w]=F.useState({x:0,y:0,k:1}),O=Object.keys(o).length;F.useEffect(()=>{if(p==="graph"){fe(!0);const S=setTimeout(()=>fe(!1),2200);return()=>clearTimeout(S)}},[he,se,O,p]),F.useEffect(()=>{const S=te=>{ue.current&&!ue.current.contains(te.target)&&v(!1)};return y&&document.addEventListener("mousedown",S),()=>{document.removeEventListener("mousedown",S)}},[y]);const{nodes:ee,links:ke,uniqueColors:D}=F.useMemo(()=>{if(p!=="graph")return{nodes:[],links:[],uniqueColors:[]};const S=s.filter(X=>he&&X.id===he?!0:Object.entries(o).every(([U,xe])=>{var nn,Vt;const Te=(nn=X.tags)==null?void 0:nn.includes(U),Be=(Vt=X.hiddenTags)==null?void 0:Vt.includes(U),Ue=Te||Be;return xe==="include"?Ue:xe==="exclude"?!Ue:!0})),te=new Set(S.map(X=>X.id)),pe=new Set;he&&(pe.add(he),S.forEach(X=>{var U,xe;X.id===he&&((U=X.connections)==null||U.forEach(Te=>{te.has(Te.id)&&pe.add(Te.id)})),(xe=X.connections)!=null&&xe.some(Te=>Te.id===he)&&pe.add(X.id)}));const Ie=new Map,Ee=[...t],ze=380,Re=260;Ee.forEach((X,U)=>{const xe=U/Ee.length*2*Math.PI;Ie.set(X,{x:500+Math.cos(xe)*ze,y:350+Math.sin(xe)*Re})});const Ge=S.map(X=>{const U=Y.current.get(X.id);let xe=!1;if(he)xe=!pe.has(X.id);else if(se){const Ue=X.connections||[],nn=S.filter(Vt=>{var lr;return Vt.id!==X.id&&((lr=Vt.connections)==null?void 0:lr.some(ar=>ar.id===X.id))});xe=Ue.length+nn.length===0}let Te=500,Be=350;if(!U)if(X.tags&&X.tags.length>0){let Ue=0,nn=0,Vt=0;X.tags.forEach(lr=>{const ar=Ie.get(lr);ar&&(Ue+=ar.x,nn+=ar.y,Vt++)}),Vt>0?(Te=Ue/Vt,Be=nn/Vt,Te+=(Math.random()-.5)*80,Be+=(Math.random()-.5)*80):(Te+=(Math.random()-.5)*150,Be+=(Math.random()-.5)*150)}else Te+=(Math.random()-.5)*120,Be+=(Math.random()-.5)*120;return{id:X.id,name:X.name,imageUrl:X.imageUrl,miniImageScale:X.miniImageScale,miniImageX:X.miniImageX,miniImageY:X.miniImageY,x:(U==null?void 0:U.x)??Te,y:(U==null?void 0:U.y)??Be,vx:U==null?void 0:U.vx,vy:U==null?void 0:U.vy,isDimmed:xe,tags:X.tags,hiddenTags:X.hiddenTags}}),st=new Map;Ge.forEach(X=>st.set(X.id,X)),Y.current=st;const $=[],oe=new Set,we=new Map;return S.forEach(X=>{var U;(U=X.connections)==null||U.forEach(xe=>{if(te.has(xe.id)){const Te=xe.color||"#10b981";oe.add(Te);let Be=!1;he&&(Be=X.id!==he&&xe.id!==he),$.push({source:X.id,target:xe.id,role:xe.role,color:Te,isDouble:!1,isHidden:Be}),we.set(`${X.id}-${xe.id}`,!0)}})}),$.forEach(X=>{const U=typeof X.source=="string"?X.source:X.source.id,xe=typeof X.target=="string"?X.target:X.target.id;we.has(`${xe}-${U}`)&&(X.isDouble=!0)}),{nodes:Ge,links:$,uniqueColors:Array.from(oe)}},[s,se,he,o,t,p]),A=S=>{if(!Me.current||!De.current)return;const te=ee.find(pe=>pe.id===S);!te||te.x===void 0||te.y===void 0||_f(()=>import("https://esm.sh/d3@7"),[]).then(pe=>{const Ie=pe.select(Me.current),Ee=1e3,ze=700,Re=.8,Ge=Ee/2-te.x*Re,st=ze/2-te.y*Re;Ie.transition().duration(1200).ease(pe.easePolyInOut.exponent(3)).call(De.current.transform,pe.zoomIdentity.translate(Ge,st).scale(Re))})};F.useEffect(()=>{if(he&&p==="graph"){const S=setTimeout(()=>A(he),100);return()=>clearTimeout(S)}},[he,p]),F.useEffect(()=>{!Me.current||p!=="graph"||(ie(!0),_f(()=>import("https://esm.sh/d3@7"),[]).then(S=>{const te=S.select(Me.current),pe=S.select(lt.current),Ie=S.zoom().scaleExtent([.1,4]).on("zoom",Re=>{pe.attr("transform",Re.transform),w({x:Re.transform.x,y:Re.transform.y,k:Re.transform.k}),L(null)});De.current=Ie,te.call(Ie);const Ee=S.forceSimulation(ee).velocityDecay(.4).force("link",S.forceLink(ke.filter(Re=>!Re.isHidden)).id(Re=>Re.id).distance(Re=>{const Ge=Re.source.tags||[],st=Re.target.tags||[],$=Ge.some(oe=>st.includes(oe));return Ge.length===0||st.length===0?250:$?150:450}).strength(he?.05:.03)).force("charge",S.forceManyBody().strength(he?-5e3:-3500)).force("x",S.forceX(500).strength(.05)).force("y",S.forceY(350).strength(.05)).force("collision",S.forceCollide().radius(90)).alphaDecay(.05);Ee.on("tick",()=>{_e(Re=>Re+1),Ee.alpha()<.2&&ie(!1)}),Qe.current=Ee;const ze=Re=>{function Ge(oe,we){oe.active||Re.alphaTarget(.3).restart(),we.fx=we.x,we.fy=we.y,L(null)}function st(oe,we){we.fx=oe.x,we.fy=oe.y}function $(oe,we){oe.active||Re.alphaTarget(0),we.fx=null,we.fy=null}return S.drag().on("start",Ge).on("drag",st).on("end",$)};return pe.selectAll(".node-group").data(ee).call(ze(Ee)),()=>Ee.stop()}))},[ee,ke,p]);const Q=S=>{const te=typeof S.source=="string"?ee.find(Te=>Te.id===S.source):S.source,pe=typeof S.target=="string"?ee.find(Te=>Te.id===S.target):S.target;if(!(te!=null&&te.x)||!(te!=null&&te.y)||!(pe!=null&&pe.x)||!(pe!=null&&pe.y))return null;const Ie=52,Ee=pe.x-te.x,ze=pe.y-te.y,Re=Math.sqrt(Ee*Ee+ze*ze);if(Re<Ie*2.2)return null;const Ge=Ee/Re,st=ze/Re,$=te.x+Ie*Ge,oe=te.y+Ie*st,we=pe.x-Ie*Ge,X=pe.y-Ie*st;let U="",xe={x:0,y:0};if(S.isDouble){const Be=(te.x+pe.x)/2+-st*50,Ue=(te.y+pe.y)/2+Ge*50;U=`M${$},${oe} Q${Be},${Ue} ${we},${X}`,xe.x=.25*$+.5*Be+.25*we,xe.y=.25*oe+.5*Ue+.25*X}else U=`M${$},${oe} L${we},${X}`,xe.x=($+we)/2,xe.y=(oe+X)/2;return{path:U,textPos:xe}},j=S=>S.replace("#",""),K=S=>{ne(te=>te.includes(S)?te.filter(pe=>pe!==S):[...te,S])},ye=F.useMemo(()=>s.filter(S=>{const te=S.name.toLowerCase().includes(C.toLowerCase()),pe=B.length===0||B.every(Ie=>{var Ee,ze;return((Ee=S.tags)==null?void 0:Ee.includes(Ie))||((ze=S.hiddenTags)==null?void 0:ze.includes(Ie))});return te&&pe}).sort((S,te)=>S.name.localeCompare(te.name)),[s,C,B]),{outgoingConnections:$e,incomingConnections:T,currentTableChar:H}=F.useMemo(()=>{if(p!=="table"||!x)return{outgoingConnections:[],incomingConnections:[],currentTableChar:null};const S=s.find(Ie=>Ie.id===x),te=((S==null?void 0:S.connections)||[]).map(Ie=>{const Ee=s.find(ze=>ze.id===Ie.id);return{...Ie,targetChar:Ee}}),pe=s.filter(Ie=>{var Ee;return(Ee=Ie.connections)==null?void 0:Ee.some(ze=>ze.id===x)}).map(Ie=>{var ze;const Ee=(ze=Ie.connections)==null?void 0:ze.find(Re=>Re.id===x);return{sourceChar:Ie,role:Ee==null?void 0:Ee.role,color:Ee==null?void 0:Ee.color}});return{outgoingConnections:te,incomingConnections:pe,currentTableChar:S}},[s,x,p]);return a.jsxs("div",{className:`flex flex-col h-full space-y-4 md:space-y-4 select-none relative ${ve?"is-mounting":""}`,onClick:()=>L(null),children:[a.jsxs("div",{className:"bg-[#0f0f0f]/50 border border-stone-900 rounded-2xl p-4 flex flex-col gap-4 backdrop-blur-sm shadow-lg relative z-20",children:[a.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[a.jsxs("div",{className:"bg-stone-950 p-1 rounded-lg border border-stone-800 flex items-center",children:[a.jsx("button",{onClick:()=>g("graph"),className:`px-4 py-1.5 rounded-md text-[10px] uppercase font-bold tracking-wider transition-all ${p==="graph"?"bg-stone-800 text-stone-100 shadow-sm":"text-stone-500 hover:text-stone-300"}`,children:""}),a.jsx("button",{onClick:()=>g("table"),className:`px-4 py-1.5 rounded-md text-[10px] uppercase font-bold tracking-wider transition-all ${p==="table"?"bg-stone-800 text-stone-100 shadow-sm":"text-stone-500 hover:text-stone-300"}`,children:""})]}),p==="graph"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"h-6 w-px bg-stone-800 hidden md:block"}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[a.jsx("input",{type:"checkbox",checked:se,disabled:!!he,onChange:S=>je(S.target.checked),className:"sr-only"}),a.jsx("div",{className:`w-4 h-4 border border-stone-700 rounded transition-colors ${se?"bg-emerald-600 border-emerald-500":"bg-transparent"}`,children:se&&a.jsx("svg",{className:"w-3.5 h-3.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),a.jsx("span",{className:`text-[11px] uppercase tracking-wider font-bold text-stone-500 group-hover:text-stone-300 transition-colors ${he?"opacity-30":""}`,children:" "})]})]})]}),p==="graph"?he&&a.jsx("button",{onClick:()=>{We(null),ie(!0)},className:"w-full md:w-auto bg-emerald-950/30 border border-emerald-900/50 text-emerald-500 px-4 py-2 rounded-full text-[10px] uppercase tracking-[0.2em] font-black hover:bg-emerald-900/40 transition-all",children:" "}):a.jsxs("div",{className:"w-full md:w-80 relative z-50",ref:ue,children:[a.jsxs("button",{onClick:()=>v(!y),className:"w-full bg-stone-950 border border-stone-800 text-stone-300 text-xs py-2.5 pl-4 pr-10 rounded-xl text-left focus:border-emerald-900 transition-colors flex items-center justify-between",children:[a.jsx("span",{className:x?"":"text-stone-500 italic",children:x?(ce=s.find(S=>S.id===x))==null?void 0:ce.name:"--   --"}),a.jsx("svg",{className:`w-4 h-4 text-stone-600 transition-transform ${y?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),y&&a.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-[#0a0a0a] border border-stone-800 rounded-xl shadow-2xl overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200 flex flex-col max-h-[400px]",children:[a.jsxs("div",{className:"p-3 bg-stone-900/50 border-b border-stone-900 space-y-3 shrink-0 backdrop-blur-md",children:[a.jsx("input",{type:"text",placeholder:"...",value:C,onChange:S=>M(S.target.value),className:"w-full bg-stone-950 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-colors",autoFocus:!0}),(t.length>0||r.length>0)&&a.jsxs("div",{className:"flex flex-wrap gap-1.5 max-h-20 overflow-y-auto custom-scrollbar",children:[t.map(S=>{const te=B.includes(S);return a.jsx("button",{onClick:()=>K(S),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${te?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:S},S)}),r.map(S=>{const te=B.includes(S);return a.jsx("button",{onClick:()=>K(S),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${te?"bg-amber-500/20 border-amber-500/40 text-amber-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-amber-500"}`,children:S},S)})]})]}),a.jsx("div",{className:"overflow-y-auto p-1 custom-scrollbar",children:ye.length>0?ye.map(S=>a.jsxs("button",{onClick:()=>{k(S.id),v(!1),M(""),ne([])},className:`w-full flex items-center gap-3 p-2 hover:bg-stone-900 rounded-lg text-left transition-colors group ${x===S.id?"bg-stone-900/80":""}`,children:[a.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:a.jsx("img",{src:S.imageUrl,style:{objectPosition:`${S.miniImageX??50}% ${S.miniImageY??50}%`,transform:`scale(${S.miniImageScale??1})`,transformOrigin:`${S.miniImageX??50}% ${S.miniImageY??50}%`},className:"w-full h-full object-cover",alt:""})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("span",{className:`text-xs font-bold block truncate ${x===S.id?"text-emerald-400":"text-stone-300"}`,children:S.name}),S.tags&&S.tags.length>0&&a.jsxs("span",{className:"text-[8px] text-stone-600 truncate block mt-0.5",children:[S.tags.slice(0,3).join(", "),S.tags.length>3?"...":""]})]}),x===S.id&&a.jsx("div",{className:"ml-auto text-emerald-500",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]},S.id)):a.jsx("div",{className:"text-center py-4 text-[10px] text-stone-600 italic",children:"  "})})]})]})]}),p==="graph"&&(t.length>0||r.length>0)&&a.jsxs("div",{className:"flex flex-wrap items-center gap-2 pt-3 border-t border-stone-800/50 animate-in fade-in slide-in-from-top-1 duration-500",children:[a.jsx("span",{className:"text-[9px] uppercase tracking-[0.2em] font-black text-stone-600 mr-2",children:":"}),t.map(S=>{const te=o[S]||"none";return a.jsxs("button",{onClick:()=>c(S),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${te==="include"?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":te==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-stone-400 hover:border-stone-700"}`,children:[te==="include"&&a.jsx("span",{className:"text-emerald-500",children:"+"}),te==="exclude"&&a.jsx("span",{className:"text-red-500",children:""}),S]},S)}),r.map(S=>{const te=o[S]||"none";return a.jsxs("button",{onClick:()=>c(S),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${te==="include"?"bg-amber-500/10 border-amber-500/40 text-amber-400 shadow-[0_0_15px_rgba(245,158,11,0.1)]":te==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-amber-500 hover:border-amber-900/30"}`,children:[te==="include"&&a.jsx("span",{className:"text-amber-500",children:"+"}),te==="exclude"&&a.jsx("span",{className:"text-red-500",children:""}),S]},S)}),O>0&&a.jsx("button",{onClick:d,className:"ml-2 text-[9px] uppercase tracking-[0.2em] font-black text-stone-700 hover:text-red-500 transition-colors",children:""})]})]}),a.jsxs("div",{className:"relative z-0 w-full h-full min-h-[500px] bg-[#030303] border border-stone-900 rounded-2xl overflow-hidden shadow-2xl graph-container-reveal",children:[p==="graph"&&a.jsxs(a.Fragment,{children:[a.jsxs("svg",{ref:Me,viewBox:"0 0 1000 700",className:"w-full h-full touch-none cursor-grab active:cursor-grabbing",children:[a.jsx("defs",{children:D.map(S=>a.jsx("marker",{id:`arrow-${j(S)}`,markerWidth:"8",markerHeight:"6",refX:"7.5",refY:"3",orient:"auto",children:a.jsx("path",{d:"M0,0 L8,3 L0,6",fill:S})},`arrow-${j(S)}`))}),a.jsxs("g",{ref:lt,children:[ke.map((S,te)=>{const pe=Q(S);if(!pe)return null;const Ie=S.color||"#10b981",Ee=S.isHidden;return a.jsxs("g",{className:`transition-opacity duration-700 ${Ee?"opacity-0":"opacity-100"}`,children:[a.jsx("path",{d:pe.path,fill:"none",stroke:Ie,strokeWidth:he?"3":"1.5",strokeOpacity:he?"0.8":"0.3",markerEnd:`url(#arrow-${j(Ie)})`,className:"link-path",style:ve?{animationDelay:`${te*.015}s`}:{}}),he&&S.role&&!Ee&&a.jsxs("g",{transform:`translate(${pe.textPos.x}, ${pe.textPos.y})`,children:[a.jsx("text",{dy:"-14",textAnchor:"middle",className:"fill-[#030303] text-[10px] font-bold uppercase tracking-[0.2em]",style:{paintOrder:"stroke",stroke:"#030303",strokeWidth:"5px"},children:S.role}),a.jsx("text",{dy:"-14",textAnchor:"middle",fill:Ie,className:"text-[10px] font-bold uppercase tracking-[0.2em] opacity-90",children:S.role})]})]},`link-${te}-${P}`)}),ee.map((S,te)=>{const pe=he===S.id;return a.jsx("g",{transform:`translate(${S.x||500}, ${S.y||350})`,className:`node-group cursor-pointer group ${S.isDimmed?"opacity-0 pointer-events-none":"opacity-100"}`,onClick:Ie=>{if(Ie.stopPropagation(),S.x&&S.y){const Ee=S.x*Z.k+Z.x,ze=S.y*Z.k+Z.y;L({id:S.id,x:Ee,y:ze})}},children:a.jsxs("g",{className:"node-animator",style:ve?{animationDelay:`${te*.06}s`}:{},children:[a.jsxs("g",{className:"node-content",children:[a.jsx("circle",{r:"48",fill:"#1c1917"}),a.jsx("circle",{r:"46",fill:"#050505",stroke:pe?"#10b981":"#292524",strokeWidth:pe?"4":"1.5"}),a.jsx("clipPath",{id:`clip-${S.id}`,children:a.jsx("circle",{r:"45"})}),a.jsx("foreignObject",{x:"-45",y:"-45",width:"90",height:"90",clipPath:`url(#clip-${S.id})`,children:a.jsx("div",{className:"w-full h-full bg-black flex items-center justify-center overflow-hidden",children:a.jsx("img",{src:S.imageUrl,alt:"",style:{width:"100%",height:"100%",objectFit:"cover",objectPosition:`${S.miniImageX??50}% ${S.miniImageY??50}%`,transformOrigin:`${S.miniImageX??50}% ${S.miniImageY??50}%`,transform:`scale(${S.miniImageScale??1})`},className:"opacity-90 group-hover:opacity-100 group-hover:scale-110 transition-all duration-500"})})})]}),a.jsx("text",{y:"70",textAnchor:"middle",className:"fill-stone-500 text-[12px] font-bold uppercase tracking-[0.15em] group-hover:fill-stone-100 transition-colors drop-shadow-[0_2px_2px_rgba(0,0,0,0.8)] font-serif",children:S.name})]})},S.id)})]})]}),ae&&a.jsx("div",{className:"absolute inset-0 bg-[#030303]/40 flex items-center justify-center backdrop-blur-[1px] pointer-events-none",children:a.jsx("div",{className:"text-[10px] uppercase tracking-[0.4em] font-black text-emerald-500/50 animate-pulse",children:" ..."})})]}),p==="table"&&a.jsx("div",{className:"w-full h-full overflow-y-auto custom-scrollbar p-6 md:p-10",children:x?a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center gap-3 border-b border-stone-800 pb-4",children:[a.jsx("span",{className:"text-emerald-500 bg-emerald-900/10 px-2 py-1 rounded text-xs font-bold",children:"OUT"}),a.jsxs("h3",{className:"text-lg font-serif text-stone-200 italic",children:["  ",H==null?void 0:H.name,"?"]}),a.jsx("span",{className:"ml-auto text-stone-600 text-xs font-bold",children:$e.length})]}),a.jsx("div",{className:"space-y-3",children:$e.length===0?a.jsx("p",{className:"text-stone-700 text-xs italic py-4",children:"       ..."}):$e.map((S,te)=>{var pe,Ie,Ee,ze,Re,Ge;return a.jsxs("div",{className:"flex items-start gap-4 p-4 bg-stone-900/30 border border-stone-900/50 rounded-xl hover:bg-stone-900/50 hover:border-emerald-900/30 transition-all group",children:[a.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:a.jsx("img",{src:(pe=S.targetChar)==null?void 0:pe.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${((Ie=S.targetChar)==null?void 0:Ie.miniImageX)??50}% ${((Ee=S.targetChar)==null?void 0:Ee.miniImageY)??50}%`,transform:`scale(${((ze=S.targetChar)==null?void 0:ze.miniImageScale)??1})`,transformOrigin:`${((Re=S.targetChar)==null?void 0:Re.miniImageX)??50}% ${((Ge=S.targetChar)==null?void 0:Ge.miniImageY)??50}%`},alt:""})}),a.jsxs("div",{className:"flex-grow min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-baseline",children:[a.jsx("h4",{className:"text-stone-300 font-bold text-sm truncate",children:S.name}),a.jsx("button",{onClick:()=>f(S.id),className:"text-[9px] uppercase font-bold text-stone-700 hover:text-emerald-500 transition-colors opacity-0 group-hover:opacity-100",children:""})]}),a.jsx("p",{className:"text-stone-500 text-xs mt-1 font-medium",children:S.role})]}),a.jsx("div",{className:"w-1.5 h-8 rounded-full self-center",style:{backgroundColor:S.color||"#10b981"}})]},te)})})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center gap-3 border-b border-stone-800 pb-4",children:[a.jsx("span",{className:"text-blue-500 bg-blue-900/10 px-2 py-1 rounded text-xs font-bold",children:"IN"}),a.jsxs("h3",{className:"text-lg font-serif text-stone-200 italic",children:["  ",H==null?void 0:H.name,"?"]}),a.jsx("span",{className:"ml-auto text-stone-600 text-xs font-bold",children:T.length})]}),a.jsx("div",{className:"space-y-3",children:T.length===0?a.jsx("p",{className:"text-stone-700 text-xs italic py-4",children:"    ..."}):T.map((S,te)=>{var pe,Ie,Ee,ze,Re,Ge,st;return a.jsxs("div",{className:"flex items-start gap-4 p-4 bg-stone-900/30 border border-stone-900/50 rounded-xl hover:bg-stone-900/50 hover:border-blue-900/30 transition-all group",children:[a.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:a.jsx("img",{src:(pe=S.sourceChar)==null?void 0:pe.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${((Ie=S.sourceChar)==null?void 0:Ie.miniImageX)??50}% ${((Ee=S.sourceChar)==null?void 0:Ee.miniImageY)??50}%`,transform:`scale(${((ze=S.sourceChar)==null?void 0:ze.miniImageScale)??1})`,transformOrigin:`${((Re=S.sourceChar)==null?void 0:Re.miniImageX)??50}% ${((Ge=S.sourceChar)==null?void 0:Ge.miniImageY)??50}%`},alt:""})}),a.jsxs("div",{className:"flex-grow min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-baseline",children:[a.jsx("h4",{className:"text-stone-300 font-bold text-sm truncate",children:(st=S.sourceChar)==null?void 0:st.name}),a.jsx("button",{onClick:()=>f(S.sourceChar.id),className:"text-[9px] uppercase font-bold text-stone-700 hover:text-blue-500 transition-colors opacity-0 group-hover:opacity-100",children:""})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx("span",{className:"text-stone-600 text-[10px] uppercase tracking-wider",children:"  :"}),a.jsx("p",{className:"text-stone-400 text-xs font-medium",children:S.role})]})]}),a.jsx("div",{className:"w-1.5 h-8 rounded-full self-center",style:{backgroundColor:S.color||"#10b981"}})]},te)})})]})]}):a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-stone-600 space-y-4",children:[a.jsx("svg",{className:"w-16 h-16 opacity-30",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),a.jsx("p",{className:"text-sm italic font-serif opacity-70",children:"    ,    "})]})}),J&&p==="graph"&&a.jsx("div",{className:"absolute z-[100] animate-in zoom-in-95 fade-in duration-300",style:{left:J.x+40,top:J.y-40},onClick:S=>S.stopPropagation(),children:a.jsxs("div",{className:"bg-[#0f0f0f]/95 border border-stone-800 rounded-xl overflow-hidden shadow-2xl min-w-[200px] backdrop-blur-md",children:[a.jsx("button",{onClick:()=>f(J.id),className:"w-full text-left px-5 py-3 text-[11px] uppercase tracking-wider font-bold text-stone-200 hover:bg-emerald-900/40 border-b border-stone-900",children:" "}),a.jsx("button",{onClick:()=>{We(J.id),L(null),ie(!0)},className:"w-full text-left px-5 py-3 text-[11px] uppercase tracking-wider font-bold text-emerald-400 hover:bg-emerald-900/40",children:" "})]})})]})]})},hx=({realms:s,worlds:t,characters:r,availableTags:o,availableHiddenTags:c,onUpdateRealms:d,onUpdateWorlds:f,isAdmin:p})=>{var te,pe,Ie,Ee,ze,Re,Ge,st;const[g,x]=F.useState(null),[k,y]=F.useState(null);F.useEffect(()=>{window.scrollTo(0,0)},[g,k]);const[v,C]=F.useState(!1),[M,B]=F.useState(!1),[ne,ue]=F.useState(!1),[se,je]=F.useState(null),[he,We]=F.useState(!1),[J,L]=F.useState(""),[P,_e]=F.useState(!1),[ae,ie]=F.useState({}),[ve,fe]=F.useState({type:""}),[Me,lt]=F.useState(""),[Qe,De]=F.useState([]),Y=s.find($=>$.id===g),Z=t.find($=>$.id===k),w=t.filter($=>$.realmId===g),O=$=>{var oe,we;for(const X of t){if((oe=X.characterIds)!=null&&oe.includes($))return X.name;if(X.subLocations){for(const U of X.subLocations)if((we=U.characterIds)!=null&&we.includes($))return`${X.name} / ${U.name}`}}return null},ee=$=>{ie($||{}),C(!0)},ke=()=>{if(!ae.name)return;let $;if(ae.id)$=s.map(oe=>oe.id===ae.id?{...oe,...ae}:oe);else{const oe={id:Date.now().toString(),name:ae.name,imageUrl:ae.imageUrl||"https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=1080&auto=format&fit=crop"};$=[...s,oe]}d($),C(!1),ie({})},D=$=>{window.confirm("  ?  ,   .")&&(d(s.filter(oe=>oe.id!==$)),g===$&&x(null))},A=$=>{fe($||{type:"",realmId:g}),B(!0)},Q=()=>{if(!ve.name||!g)return;let $;if(ve.id)$=t.map(oe=>oe.id===ve.id?{...oe,...ve}:oe);else{const oe={id:Date.now().toString(),realmId:g,name:ve.name,type:ve.type||"",description:ve.description||"",imageUrl:ve.imageUrl||"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?q=80&w=800&auto=format&fit=crop",characterIds:[],subLocations:[]};$=[...t,oe]}f($),B(!1),fe({type:""})},j=$=>{window.confirm("  ?")&&(f(t.filter(oe=>oe.id!==$)),k===$&&y(null))},K=()=>{if(!Z||!J.trim())return;const $={id:Date.now().toString(),name:J.trim(),characterIds:[]},oe=t.map(we=>we.id===Z.id?{...we,subLocations:[...we.subLocations||[],$]}:we);f(oe),L(""),We(!1)},ye=$=>{if(!Z||!window.confirm("  ?        ."))return;const oe=t.map(we=>we.id===Z.id?{...we,subLocations:(we.subLocations||[]).filter(X=>X.id!==$)}:we);f(oe)},$e=$=>{if(!Z)return;let oe={...Z};if(se){const X=oe.subLocations?[...oe.subLocations]:[],U=X.findIndex(xe=>xe.id===se);if(U>-1){const xe=X[U].characterIds||[],Te=xe.includes($)?xe.filter(Be=>Be!==$):[...xe,$];X[U]={...X[U],characterIds:Te},oe.subLocations=X}}else{const X=oe.characterIds||[],U=X.includes($)?X.filter(xe=>xe!==$):[...X,$];oe.characterIds=U}const we=t.map(X=>X.id===Z.id?oe:X);f(we)},T=$=>{De(oe=>oe.includes($)?oe.filter(we=>we!==$):[...oe,$])},H=($=null)=>{je($),lt(""),De([]),ue(!0)},ce=async $=>{var we;const oe=(we=$.target.files)==null?void 0:we[0];if(oe){_e(!0);try{const X=await zo(oe);ie(U=>({...U,imageUrl:X}))}finally{_e(!1)}}},S=async $=>{var we;const oe=(we=$.target.files)==null?void 0:we[0];if(oe){_e(!0);try{const X=await zo(oe);fe(U=>({...U,imageUrl:X}))}finally{_e(!1)}}};if(k&&Z){const $=se?((pe=(te=Z.subLocations)==null?void 0:te.find(U=>U.id===se))==null?void 0:pe.characterIds)||[]:Z.characterIds||[],oe=r.filter(U=>!$.includes(U.id)),we=oe.filter(U=>{const xe=U.name.toLowerCase().includes(Me.toLowerCase());if(Qe.length===0)return xe;const Te=[...U.tags||[],...U.hiddenTags||[]];return xe&&Qe.every(Be=>Te.includes(Be))}),X=(U,xe)=>{const Te=U||[],Be=r.filter(Ue=>Te.includes(Ue.id));return Be.length===0?a.jsx("p",{className:"text-stone-600 italic text-sm py-4",children:"  ..."}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:Be.map((Ue,nn)=>a.jsxs("div",{style:{animationDelay:`${nn*50}ms`,animationFillMode:"both"},className:"animate-slide-up-fade bg-stone-900/30 border border-stone-800 rounded-xl p-3 flex items-center gap-3 group relative hover:bg-stone-900/50 hover:border-stone-700 transition-all",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-black border border-stone-700 overflow-hidden shrink-0",children:a.jsx("img",{src:Ue.imageUrl,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",alt:"",style:{objectPosition:`${Ue.miniImageX??50}% ${Ue.miniImageY??50}%`,transform:`scale(${Ue.miniImageScale??1})`,transformOrigin:`${Ue.miniImageX??50}% ${Ue.miniImageY??50}%`}})}),a.jsx("span",{className:"text-stone-300 font-bold text-sm truncate group-hover:text-emerald-400 transition-colors",children:Ue.name}),p&&a.jsx("button",{onClick:()=>{je(xe),setTimeout(()=>$e(Ue.id),0)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-stone-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all p-2",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},Ue.id))})};return a.jsxs("div",{className:"space-y-8 animate-epic-reveal pb-20",children:[a.jsxs("div",{className:"flex flex-col gap-6",children:[a.jsxs("button",{onClick:()=>y(null),className:"self-start flex items-center gap-2 text-stone-500 hover:text-emerald-500 transition-colors group",children:[a.jsx("svg",{className:"w-5 h-5 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),a.jsxs("span",{className:"text-xs font-bold uppercase tracking-widest",children:["  ",Y==null?void 0:Y.name]})]}),a.jsxs("div",{className:"relative h-[300px] md:h-[400px] rounded-3xl overflow-hidden border border-stone-900 group shadow-2xl animate-slide-up-fade",style:{animationDelay:"0.1s"},children:[a.jsx("img",{src:Z.imageUrl,className:"w-full h-full object-cover transition-transform duration-[3s] ease-out group-hover:scale-105",alt:Z.name}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#050505] via-transparent to-transparent opacity-90"}),a.jsx("div",{className:"absolute bottom-0 left-0 p-8 md:p-12 w-full",children:a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4",children:[a.jsxs("div",{className:"animate-slide-up-fade",style:{animationDelay:"0.2s"},children:[a.jsx("div",{className:"inline-block px-3 py-1 bg-emerald-900/40 border border-emerald-500/30 rounded-lg text-emerald-400 text-[10px] font-bold uppercase tracking-widest mb-3 backdrop-blur-md",children:Z.type}),a.jsx("h1",{className:"text-4xl md:text-6xl font-serif font-medium text-stone-100 drop-shadow-xl",children:Z.name})]}),p&&a.jsxs("div",{className:"flex gap-3 animate-slide-up-fade",style:{animationDelay:"0.3s"},children:[a.jsx("button",{onClick:()=>A(Z),className:"bg-white/10 hover:bg-white/20 backdrop-blur-md text-stone-200 px-5 py-2 rounded-full text-[10px] uppercase font-bold tracking-widest transition-all border border-white/10",children:""}),a.jsx("button",{onClick:()=>j(Z.id),className:"bg-red-900/20 hover:bg-red-900/40 backdrop-blur-md text-red-400 px-5 py-2 rounded-full text-[10px] uppercase font-bold tracking-widest transition-all border border-red-900/30",children:""})]})]})})]}),a.jsx("div",{className:"max-w-4xl animate-slide-up-fade",style:{animationDelay:"0.4s"},children:a.jsx("p",{className:"text-lg md:text-xl font-serif text-stone-300 leading-relaxed whitespace-pre-wrap",children:Z.description})}),a.jsx("div",{className:"h-px bg-stone-900 w-full my-4"}),a.jsxs("div",{className:"space-y-10",children:[a.jsxs("div",{className:"space-y-4 animate-slide-up-fade",style:{animationDelay:"0.5s"},children:[a.jsxs("div",{className:"flex justify-between items-center border-b border-stone-800/50 pb-2",children:[a.jsx("h3",{className:"text-xl font-serif text-stone-200 italic",children:" "}),p&&a.jsx("button",{onClick:()=>H(null),className:"text-emerald-500 hover:text-emerald-400 text-[10px] uppercase font-bold tracking-widest transition-colors flex items-center gap-2",children:"+ "})]}),X(Z.characterIds||[],null)]}),(Ie=Z.subLocations)==null?void 0:Ie.map((U,xe)=>a.jsxs("div",{className:"space-y-4 pt-4 animate-slide-up-fade",style:{animationDelay:`${(xe+6)*100}ms`},children:[a.jsxs("div",{className:"flex justify-between items-center border-b border-stone-800/50 pb-2",children:[a.jsxs("div",{className:"flex items-baseline gap-3",children:[a.jsx("h3",{className:"text-xl font-serif text-stone-300 italic",children:U.name}),p&&a.jsx("button",{onClick:()=>ye(U.id),className:"text-stone-700 hover:text-red-500 transition-colors",children:a.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),p&&a.jsx("button",{onClick:()=>H(U.id),className:"text-emerald-500 hover:text-emerald-400 text-[10px] uppercase font-bold tracking-widest transition-colors flex items-center gap-2",children:"+ "})]}),X(U.characterIds||[],U.id)]},U.id)),p&&a.jsx("div",{className:"pt-4 animate-slide-up-fade",style:{animationDelay:"0.8s"},children:he?a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{autoFocus:!0,placeholder:" ...",className:"bg-stone-900 border border-stone-800 rounded-lg px-3 py-2 text-sm text-stone-200 outline-none focus:border-emerald-900 w-64",value:J,onChange:U=>L(U.target.value),onKeyDown:U=>U.key==="Enter"&&K()}),a.jsx("button",{onClick:K,className:"text-emerald-500 hover:text-emerald-400 font-bold p-2 bg-stone-900 rounded-lg",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),a.jsx("button",{onClick:()=>We(!1),className:"text-stone-600 hover:text-stone-400 font-bold p-2",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):a.jsxs("button",{onClick:()=>We(!0),className:"flex items-center gap-2 text-stone-600 hover:text-emerald-500 transition-colors group",children:[a.jsx("div",{className:"w-8 h-8 rounded-full border border-stone-800 group-hover:border-emerald-500/50 flex items-center justify-center transition-colors",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),a.jsx("span",{className:"text-[10px] uppercase font-bold tracking-widest",children:" "})]})})]})]}),ne&&a.jsx("div",{className:"fixed inset-0 z-[120] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",onClick:()=>ue(!1),children:a.jsxs("div",{className:"bg-[#0f0f0f] border border-stone-800 w-full max-w-lg rounded-2xl shadow-2xl flex flex-col max-h-[85vh] animate-in zoom-in-95 duration-300",onClick:U=>U.stopPropagation(),children:[a.jsxs("div",{className:"p-6 border-b border-stone-900 shrink-0 space-y-4 bg-[#0f0f0f] rounded-t-2xl z-10",children:[a.jsxs("h3",{className:"text-xl font-serif text-stone-100 shrink-0",children:[" : ",se?(ze=(Ee=Z.subLocations)==null?void 0:Ee.find(U=>U.id===se))==null?void 0:ze.name:" "]}),a.jsx("input",{type:"text",placeholder:"  ...",value:Me,onChange:U=>lt(U.target.value),className:"w-full bg-stone-900 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-colors",autoFocus:!0}),(o.length>0||c.length>0)&&a.jsxs("div",{className:"flex flex-wrap gap-1.5 max-h-24 overflow-y-auto custom-scrollbar",children:[o.map(U=>{const xe=Qe.includes(U);return a.jsx("button",{onClick:()=>T(U),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${xe?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:U},U)}),c.map(U=>{const xe=Qe.includes(U);return a.jsx("button",{onClick:()=>T(U),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${xe?"bg-amber-500/20 border-amber-500/40 text-amber-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-amber-500"}`,children:U},U)})]})]}),a.jsx("div",{className:"overflow-y-auto custom-scrollbar flex-grow p-4 space-y-1",children:we.length===0?a.jsx("div",{className:"text-center py-8 text-stone-600 italic text-sm",children:oe.length===0?"      .":"  ."}):we.map(U=>{const xe=O(U.id),Te=!!xe;return a.jsxs("button",{onClick:()=>!Te&&$e(U.id),disabled:Te,className:`w-full flex items-center gap-3 p-2 rounded-lg transition-colors group text-left ${Te?"opacity-50 cursor-not-allowed bg-stone-900/20":"hover:bg-stone-900"}`,children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-black border border-stone-800 overflow-hidden shrink-0",children:a.jsx("img",{src:U.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${U.miniImageX??50}% ${U.miniImageY??50}%`,transform:`scale(${U.miniImageScale??1})`,transformOrigin:`${U.miniImageX??50}% ${U.miniImageY??50}%`}})}),a.jsxs("div",{className:"min-w-0 flex-grow",children:[a.jsx("span",{className:`text-stone-300 text-sm font-bold block truncate ${!Te&&"group-hover:text-emerald-400"}`,children:U.name}),Te?a.jsxs("span",{className:"text-[10px] text-red-500/70 font-bold uppercase tracking-wider block truncate",children:[": ",xe]}):a.jsx(a.Fragment,{children:Qe.length>0&&a.jsx("span",{className:"text-[8px] text-stone-600 block truncate",children:Qe.filter(Be=>(U.tags||[]).includes(Be)||(U.hiddenTags||[]).includes(Be)).join(", ")})})]}),!Te&&a.jsx("span",{className:"ml-auto text-emerald-500 opacity-0 group-hover:opacity-100",children:"+"})]},U.id)})}),a.jsx("div",{className:"p-4 border-t border-stone-900 shrink-0",children:a.jsx("button",{onClick:()=>ue(!1),className:"w-full py-3 bg-stone-900 hover:bg-stone-800 text-stone-400 rounded-xl text-[10px] uppercase font-bold tracking-widest",children:""})})]})})]})}return g?a.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-500",children:[a.jsxs("div",{className:"flex flex-col gap-6",children:[a.jsxs("button",{onClick:()=>x(null),className:"self-start flex items-center gap-2 text-stone-500 hover:text-emerald-500 transition-colors group",children:[a.jsx("svg",{className:"w-5 h-5 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),a.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"  "})]}),a.jsxs("div",{className:"flex justify-between items-end border-b border-stone-800 pb-8",children:[a.jsxs("div",{className:"flex items-center gap-6 animate-in slide-in-from-bottom-2 duration-700",children:[a.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-2xl overflow-hidden border border-stone-800 bg-black shadow-lg",children:a.jsx("img",{src:Y==null?void 0:Y.imageUrl,className:"w-full h-full object-cover",alt:""})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl md:text-5xl font-serif font-medium text-stone-100",children:Y==null?void 0:Y.name}),a.jsxs("p",{className:"text-stone-500 uppercase tracking-widest text-[10px] mt-2",children:[": ",w.length]})]})]}),p&&a.jsxs("div",{className:"flex gap-2 flex-col md:flex-row",children:[a.jsx("button",{onClick:()=>ee(Y),className:"bg-stone-900/50 border border-stone-800 text-stone-400 px-6 py-3 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-stone-900 transition-all mb-1",children:". "}),a.jsx("button",{onClick:()=>A(),className:"bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 px-6 py-3 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-emerald-900/30 transition-all mb-1",children:"+ "})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[w.length===0&&a.jsx("div",{className:"col-span-full py-20 text-center text-stone-700 italic",children:"     .   ."}),w.map(($,oe)=>{var we,X,U,xe;return a.jsxs("div",{onClick:()=>y($.id),style:{animationDelay:`${oe*100}ms`,animationFillMode:"both"},className:"animate-slide-up-fade bg-[#0f0f0f]/30 border border-stone-900 rounded-2xl overflow-hidden group hover:border-emerald-900/30 transition-all flex flex-col cursor-pointer active:scale-95 shadow-lg",children:[a.jsxs("div",{className:"aspect-video relative overflow-hidden",children:[a.jsx("img",{src:$.imageUrl,className:"w-full h-full object-cover opacity-60 group-hover:opacity-100 transition-all duration-[2s] group-hover:scale-110 ease-out",alt:""}),a.jsx("div",{className:"absolute top-4 left-4 bg-black/80 px-3 py-1 rounded text-[9px] uppercase tracking-widest font-bold text-emerald-500 border border-emerald-900/50 backdrop-blur-sm",children:$.type}),(((we=$.characterIds)==null?void 0:we.length)||0)+(((X=$.subLocations)==null?void 0:X.reduce((Te,Be)=>{var Ue;return Te+(((Ue=Be.characterIds)==null?void 0:Ue.length)||0)},0))||0)>0&&a.jsx("div",{className:"absolute bottom-4 right-4 bg-black/60 backdrop-blur-md px-2 py-1 rounded flex items-center gap-2",children:a.jsxs("span",{className:"text-[9px] text-stone-300 font-bold uppercase tracking-widest",children:[(((U=$.characterIds)==null?void 0:U.length)||0)+(((xe=$.subLocations)==null?void 0:xe.reduce((Te,Be)=>{var Ue;return Te+(((Ue=Be.characterIds)==null?void 0:Ue.length)||0)},0))||0)," ."]})})]}),a.jsxs("div",{className:"p-6 space-y-3 flex-grow flex flex-col relative z-10 bg-[#0f0f0f]",children:[a.jsx("h3",{className:"text-xl font-serif text-stone-100 group-hover:text-emerald-200 transition-colors",children:$.name}),a.jsx("p",{className:"text-stone-500 text-sm leading-relaxed line-clamp-3 mb-2",children:$.description}),p&&a.jsxs("div",{className:"mt-auto pt-4 border-t border-stone-900/50 flex justify-between",children:[a.jsx("button",{onClick:Te=>{Te.stopPropagation(),A($)},className:"text-[9px] font-bold uppercase tracking-widest text-stone-600 hover:text-white",children:"."}),a.jsx("button",{onClick:Te=>{Te.stopPropagation(),j($.id)},className:"text-[9px] font-bold uppercase tracking-widest text-stone-600 hover:text-red-500",children:""})]})]})]},$.id)})]}),M&&a.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-md flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-lg rounded-2xl p-6 md:p-8 space-y-6 max-h-[90vh] flex flex-col overflow-hidden shadow-2xl animate-in zoom-in-95 duration-200",children:[a.jsx("h2",{className:"text-2xl font-serif text-stone-100 shrink-0",children:ve.id?"":" "}),a.jsxs("div",{className:"space-y-4 overflow-y-auto custom-scrollbar pr-2 flex-grow",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600",children:""}),a.jsx("input",{className:"w-full bg-stone-900 border border-stone-800 p-3 rounded-lg text-stone-200 outline-none focus:border-emerald-900",value:ve.name||"",onChange:$=>fe({...ve,name:$.target.value}),placeholder:" ..."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600",children:""}),a.jsxs("select",{className:"w-full bg-stone-900 border border-stone-800 p-3 rounded-lg text-stone-200 outline-none focus:border-emerald-900",value:ve.type,onChange:$=>fe({...ve,type:$.target.value}),children:[a.jsx("option",{children:""}),a.jsx("option",{children:""}),a.jsx("option",{children:""}),a.jsx("option",{children:""})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600",children:""}),a.jsx("textarea",{placeholder:"  ...",className:"w-full bg-stone-900 border border-stone-800 p-3 rounded-lg text-stone-200 h-32 outline-none resize-none focus:border-emerald-900",value:ve.description||"",onChange:$=>fe({...ve,description:$.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600",children:""}),a.jsxs("div",{className:"flex gap-4 items-center",children:[a.jsxs("label",{className:`flex-1 cursor-pointer bg-stone-900 hover:bg-stone-800 p-3 rounded-lg border border-stone-800 flex items-center justify-center gap-2 transition-colors ${P?"opacity-50":""}`,children:[a.jsx("input",{type:"file",onChange:S,className:"hidden",disabled:P,accept:"image/*"}),a.jsx("span",{className:"text-[10px] text-stone-400 font-bold uppercase",children:P?"...":""})]}),a.jsx("input",{className:"flex-[1.5] bg-stone-900 border border-stone-800 p-3 rounded-lg text-xs text-stone-400 outline-none",placeholder:"...",value:(Re=ve.imageUrl)!=null&&Re.startsWith("data:")?"":ve.imageUrl||"",onChange:$=>fe({...ve,imageUrl:$.target.value})})]}),ve.imageUrl&&a.jsx("img",{src:ve.imageUrl,className:"h-20 w-full object-cover rounded mt-2 opacity-50"})]})]}),a.jsxs("div",{className:"flex gap-4 shrink-0 pt-2 border-t border-stone-900 mt-2",children:[a.jsx("button",{onClick:()=>B(!1),className:"flex-1 py-3 text-[10px] font-bold uppercase text-stone-500 hover:text-stone-300",children:""}),a.jsx("button",{onClick:Q,disabled:P||!ve.name,className:"flex-1 py-3 bg-emerald-900/30 text-emerald-500 border border-emerald-900/50 rounded-lg font-bold text-[10px] uppercase disabled:opacity-50 hover:bg-emerald-900/50 transition-colors",children:""})]})]})}),v&&a.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-md flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-lg rounded-3xl p-8 space-y-6 shadow-2xl animate-in zoom-in-95 duration-300",children:[a.jsx("h2",{className:"text-2xl font-serif text-stone-100",children:" "}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-2",children:""}),a.jsx("input",{className:"w-full bg-stone-900 border border-stone-800 p-4 rounded-xl text-stone-200 outline-none focus:border-emerald-900",value:ae.name||"",onChange:$=>ie({...ae,name:$.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-2",children:""}),a.jsxs("div",{className:"flex gap-4 items-center",children:[a.jsxs("label",{className:`flex-1 cursor-pointer bg-stone-900 hover:bg-stone-800 p-4 rounded-xl border border-stone-800 flex items-center justify-center gap-2 ${P?"opacity-50":""}`,children:[a.jsx("input",{type:"file",onChange:ce,className:"hidden",disabled:P,accept:"image/*"}),a.jsx("span",{className:"text-xs text-stone-400 font-bold uppercase",children:P?"...":""})]}),a.jsx("input",{className:"flex-[2] bg-stone-900 border border-stone-800 p-4 rounded-xl text-xs text-stone-400 outline-none",placeholder:"...",value:(Ge=ae.imageUrl)!=null&&Ge.startsWith("data:")?"":ae.imageUrl||"",onChange:$=>ie({...ae,imageUrl:$.target.value})})]})]})]}),a.jsxs("div",{className:"flex gap-4 pt-4",children:[a.jsx("button",{onClick:()=>C(!1),className:"flex-1 py-4 text-[10px] uppercase font-bold text-stone-500 hover:text-stone-300",children:""}),a.jsx("button",{onClick:ke,disabled:!ae.name||P,className:"flex-1 py-4 bg-emerald-900/30 text-emerald-500 border border-emerald-900/50 rounded-xl font-bold text-[10px] uppercase hover:bg-emerald-900/50 transition-all disabled:opacity-50",children:""})]})]})})]}):a.jsxs("div",{className:"space-y-12 animate-in fade-in duration-700 pb-20",children:[a.jsxs("div",{className:"flex justify-between items-baseline",children:[a.jsx("div",{className:"space-y-2",children:a.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100",children:""})}),p&&a.jsx("button",{onClick:()=>ee(),className:"bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 px-6 py-3 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-emerald-900/30 transition-all",children:"  "})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[s.length===0&&a.jsx("div",{className:"col-span-full py-20 text-center",children:a.jsx("p",{className:"text-stone-700 italic font-serif text-xl",children:" .   ."})}),s.map(($,oe)=>a.jsxs("div",{onClick:()=>x($.id),style:{animationDelay:`${oe*150}ms`,animationFillMode:"both"},className:"animate-slide-up-fade bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl overflow-hidden group cursor-pointer relative shadow-lg hover:shadow-emerald-900/10 hover:border-emerald-900/40 transition-all active:scale-95",children:[a.jsxs("div",{className:"aspect-[16/9] relative",children:[a.jsx("img",{src:$.imageUrl,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-all duration-[2s] ease-out group-hover:scale-110",alt:$.name}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-80"}),a.jsx("h3",{className:"absolute bottom-6 left-6 text-3xl font-serif text-stone-100 z-10 font-bold group-hover:text-emerald-100 transition-colors drop-shadow-md",children:$.name})]}),p&&a.jsxs("div",{className:"absolute top-4 right-4 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[a.jsx("button",{onClick:we=>{we.stopPropagation(),ee($)},className:"bg-black/50 hover:bg-white text-white hover:text-black p-2 rounded-full backdrop-blur-sm transition-all",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),a.jsx("button",{onClick:we=>{we.stopPropagation(),D($.id)},className:"bg-black/50 hover:bg-red-900/80 text-white p-2 rounded-full backdrop-blur-sm transition-all",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]},$.id))]}),v&&a.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-md flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-lg rounded-3xl p-8 space-y-6 shadow-2xl animate-in zoom-in-95 duration-300",children:[a.jsx("h2",{className:"text-2xl font-serif text-stone-100",children:ae.id?" ":" "}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-2",children:""}),a.jsx("input",{autoFocus:!0,className:"w-full bg-stone-900 border border-stone-800 p-4 rounded-xl text-stone-200 outline-none focus:border-emerald-900 transition-colors",value:ae.name||"",onChange:$=>ie({...ae,name:$.target.value}),placeholder:":  "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-2",children:""}),a.jsxs("div",{className:"flex gap-4 items-center",children:[a.jsxs("label",{className:`flex-1 cursor-pointer bg-stone-900 hover:bg-stone-800 p-4 rounded-xl border border-stone-800 flex items-center justify-center gap-2 transition-colors ${P?"opacity-50":""}`,children:[a.jsx("input",{type:"file",onChange:ce,className:"hidden",disabled:P,accept:"image/*"}),a.jsx("span",{className:"text-xs text-stone-400 font-bold uppercase",children:P?"...":""})]}),a.jsx("input",{className:"flex-[2] bg-stone-900 border border-stone-800 p-4 rounded-xl text-xs text-stone-400 outline-none",placeholder:"...",value:(st=ae.imageUrl)!=null&&st.startsWith("data:")?"":ae.imageUrl||"",onChange:$=>ie({...ae,imageUrl:$.target.value})})]})]})]}),a.jsxs("div",{className:"flex gap-4 pt-4",children:[a.jsx("button",{onClick:()=>C(!1),className:"flex-1 py-4 text-[10px] uppercase font-bold text-stone-500 hover:text-stone-300",children:""}),a.jsx("button",{onClick:ke,disabled:!ae.name||P,className:"flex-1 py-4 bg-emerald-900/30 text-emerald-500 border border-emerald-900/50 rounded-xl font-bold text-[10px] uppercase hover:bg-emerald-900/50 transition-all disabled:opacity-50",children:""})]})]})})]})},fx=({sessions:s,characters:t,onUpdate:r,isAdmin:o})=>{const[c,d]=F.useState(null),[f,p]=F.useState(null),[g,x]=F.useState("");F.useEffect(()=>{window.scrollTo(0,0)},[c]);const[k,y]=F.useState(!1),[v,C]=F.useState(""),[M,B]=F.useState(""),ne=F.useRef(null),ue=s.find(J=>J.id===c);F.useEffect(()=>{ne.current&&ne.current.scrollIntoView({behavior:"smooth"})},[ue==null?void 0:ue.posts.length,c]);const se=()=>{if(!v.trim())return;const J={id:Date.now().toString(),name:v,description:M,posts:[]};r([...s,J]),y(!1),C(""),B("")},je=J=>{window.confirm("     ?")&&(r(s.filter(L=>L.id!==J)),c===J&&d(null))},he=J=>{if(!g.trim()||!f||!c)return;const L={id:Date.now().toString(),characterId:f,content:g,timestamp:Date.now(),type:"speech"},P=s.map(_e=>_e.id===c?{..._e,posts:[..._e.posts,L]}:_e);r(P),x("")},We=J=>new Date(J).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return c?a.jsxs("div",{className:"h-[calc(100vh-8rem)] flex flex-col animate-in fade-in duration-300",children:[a.jsx("div",{className:"flex items-center justify-between pb-4 border-b border-stone-900 shrink-0",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>d(null),className:"p-2 hover:bg-stone-900 rounded-full text-stone-500 transition-colors",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-serif text-stone-100 italic",children:ue==null?void 0:ue.name}),a.jsx("p",{className:"text-[10px] uppercase tracking-widest text-stone-500",children:ue==null?void 0:ue.description})]})]})}),a.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar py-6 space-y-8 pr-2",children:[(ue==null?void 0:ue.posts.length)===0?a.jsx("div",{className:"text-center text-stone-700 italic text-sm mt-10",children:"...   ,   ."}):ue==null?void 0:ue.posts.map(J=>{const L=t.find(P=>P.id===J.characterId);return L?a.jsxs("div",{className:"flex gap-4 md:gap-6 group animate-in slide-in-from-bottom-2 duration-500",children:[a.jsx("div",{className:"shrink-0 flex flex-col items-center gap-2 mt-1",children:a.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 rounded-full border border-stone-800 overflow-hidden bg-black shadow-lg",children:a.jsx("img",{src:L.imageUrl,alt:L.name,style:{objectFit:"cover",objectPosition:`${L.miniImageX??50}% ${L.miniImageY??50}%`,transformOrigin:`${L.miniImageX??50}% ${L.miniImageY??50}%`,transform:`scale(${L.miniImageScale??1})`},className:"w-full h-full"})})}),a.jsxs("div",{className:"flex-grow max-w-4xl",children:[a.jsxs("div",{className:"flex items-baseline gap-3 mb-1",children:[a.jsx("span",{className:"text-stone-300 font-bold text-sm tracking-wide",children:L.name}),a.jsx("span",{className:"text-[9px] text-stone-700 font-mono",children:We(J.timestamp)})]}),a.jsx("div",{className:"text-stone-400 leading-relaxed font-serif whitespace-pre-wrap text-[15px] md:text-[16px]",children:J.content})]})]},J.id):null}),a.jsx("div",{ref:ne})]}),a.jsx("div",{className:"mt-4 pt-4 border-t border-stone-900 shrink-0 bg-[#050505] z-10",children:a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsx("div",{className:"flex gap-2 overflow-x-auto custom-scrollbar pb-3",children:t.map(J=>{const L=f===J.id;return a.jsxs("button",{onClick:()=>p(J.id),className:`flex items-center gap-3 px-4 py-2.5 rounded-xl transition-all shrink-0 border relative ${L?"bg-stone-900/80 border-stone-800 text-stone-100":"bg-transparent border-transparent text-stone-500 hover:text-stone-400"}`,children:[a.jsx("div",{className:"w-7 h-7 rounded-full overflow-hidden bg-black shrink-0",children:a.jsx("img",{src:J.imageUrl,style:{objectFit:"cover",objectPosition:`${J.miniImageX??50}% ${J.miniImageY??50}%`,transformOrigin:`${J.miniImageX??50}% ${J.miniImageY??50}%`,transform:`scale(${J.miniImageScale??1})`},className:"w-full h-full",alt:""})}),a.jsx("span",{className:"text-[11px] font-bold uppercase tracking-wider",children:J.name}),L&&a.jsx("div",{className:"ml-1 w-2.5 h-2.5 rounded-sm bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)] animate-in zoom-in-50 duration-300"})]},J.id)})}),a.jsxs("div",{className:"relative",children:[a.jsx("textarea",{value:g,onChange:J=>x(J.target.value),onKeyDown:J=>{J.key==="Enter"&&!J.shiftKey&&(J.preventDefault(),he())},placeholder:f?" -...":"  ...",disabled:!f,className:"w-full bg-[#0f0f0f] border border-stone-800 rounded-xl p-4 pr-14 text-stone-300 outline-none focus:border-emerald-900/50 transition-colors resize-none h-24 custom-scrollbar font-serif"}),a.jsx("button",{onClick:()=>he(),disabled:!g.trim()||!f,className:"absolute right-3 bottom-3 p-2 bg-stone-800 text-stone-400 rounded-lg hover:bg-emerald-600 hover:text-white disabled:opacity-30 disabled:hover:bg-stone-800 disabled:hover:text-stone-400 transition-all",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})]})})]}):a.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[a.jsxs("div",{className:"flex justify-between items-baseline",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100",children:""}),a.jsx("p",{className:"text-stone-500 uppercase tracking-widest text-[10px]",children:"   "})]}),a.jsx("button",{onClick:()=>y(!0),className:"bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 px-6 py-2 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-emerald-900/30 transition-all",children:"+  "})]}),k&&a.jsxs("div",{className:"bg-[#0f0f0f]/50 border border-stone-800 p-6 rounded-2xl space-y-4 animate-in slide-in-from-top-4",children:[a.jsx("input",{autoFocus:!0,placeholder:"   ...",className:"w-full bg-stone-900/50 border border-stone-800 p-3 rounded-lg text-stone-200 outline-none focus:border-emerald-900",value:v,onChange:J=>C(J.target.value)}),a.jsx("input",{placeholder:" ...",className:"w-full bg-stone-900/50 border border-stone-800 p-3 rounded-lg text-stone-400 outline-none focus:border-emerald-900 text-sm",value:M,onChange:J=>B(J.target.value)}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>y(!1),className:"px-4 py-2 text-[10px] uppercase font-bold text-stone-500",children:""}),a.jsx("button",{onClick:se,className:"px-6 py-2 bg-emerald-700 hover:bg-emerald-600 text-white rounded-lg text-[10px] uppercase font-bold transition-colors",children:""})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[s.length===0&&!k&&a.jsx("div",{className:"col-span-full text-center py-20 opacity-50 italic font-serif",children:"   .   ."}),s.map(J=>a.jsxs("div",{onClick:()=>d(J.id),className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-2xl p-6 cursor-pointer hover:border-emerald-900/50 hover:bg-stone-900/30 transition-all group flex flex-col h-[200px]",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsx("h3",{className:"text-xl font-serif text-stone-200 group-hover:text-emerald-400 transition-colors",children:J.name}),a.jsxs("span",{className:"text-[10px] bg-stone-900 text-stone-500 px-2 py-1 rounded-md font-mono",children:[J.posts.length," "]})]}),a.jsx("p",{className:"text-sm text-stone-500 mt-2 line-clamp-2",children:J.description}),a.jsxs("div",{className:"mt-auto pt-4 border-t border-stone-900/50 flex justify-between items-center",children:[a.jsx("span",{className:"text-[9px] uppercase tracking-widest text-stone-600 font-bold group-hover:text-stone-400",children:"  "}),o&&a.jsx("button",{onClick:L=>{L.stopPropagation(),je(J.id)},className:"text-stone-800 hover:text-red-500 p-1 transition-colors",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},J.id))]})]})},px=({onConnect:s,onDisconnect:t,onClose:r,isConnected:o})=>a.jsx("div",{className:"fixed inset-0 z-[120] bg-black/95 backdrop-blur-md flex items-center justify-center p-6",onClick:r,children:a.jsxs("div",{className:"bg-[#0a0a0a] border border-emerald-900/50 w-full max-w-lg rounded-3xl p-8 space-y-8 shadow-[0_0_80px_rgba(16,185,129,0.05)]",onClick:c=>c.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl font-serif text-emerald-500 italic",children:" "}),a.jsx("p",{className:"text-stone-500 text-[10px] uppercase tracking-widest mt-2",children:"  "})]}),a.jsx("button",{onClick:r,className:"text-stone-600 hover:text-stone-300 transition-colors",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o?a.jsxs("div",{className:"space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[a.jsxs("div",{className:"p-6 rounded-2xl border bg-emerald-950/20 border-emerald-500/30",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-3 h-3 rounded-full animate-pulse bg-emerald-500"}),a.jsx("span",{className:"text-sm font-bold uppercase tracking-widest text-emerald-400",children:" "})]}),a.jsx("div",{className:"space-y-2",children:a.jsx("p",{className:"text-[10px] text-stone-600 mt-2 leading-relaxed",children:"     .  ,     ,    ."})})]}),a.jsx("button",{onClick:t,className:"w-full py-4 rounded-xl border border-red-900/30 text-red-500/70 hover:bg-red-950/20 hover:text-red-500 hover:border-red-900/60 transition-all text-[10px] uppercase font-bold tracking-[0.2em]",children:" "})]}):a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"bg-stone-900/30 border border-stone-800 rounded-2xl p-6 text-center space-y-4",children:[a.jsx("div",{className:"w-16 h-16 bg-stone-900 rounded-full flex items-center justify-center mx-auto text-stone-600",children:a.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),a.jsx("p",{className:"text-stone-400 text-sm leading-relaxed",children:"  ,           ."})]}),a.jsx("button",{onClick:s,className:"w-full py-5 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 hover:border-emerald-500/50 text-emerald-500 rounded-xl text-[11px] uppercase font-bold tracking-[0.25em] transition-all shadow-lg shadow-emerald-900/10",children:""}),a.jsx("p",{className:"text-[9px] text-stone-600 text-center border-t border-stone-900 pt-4",children:":          ."})]})]})}),wf=["","","","","","",""],bf=["","NPC","","",""],ac=[{id:"1",name:" ",age:34,height:"182 ",imageUrl:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?q=80&w=800&auto=format&fit=crop",tags:["","",""],hiddenTags:[""],connections:[{id:"2",name:"  ",role:""}],additionalInfo:"      ,     . ,         ,         .     ,    ."},{id:"2",name:"  ",age:21,height:"168 ",imageUrl:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?q=80&w=800&auto=format&fit=crop",tags:["",""],hiddenTags:["",""],connections:[{id:"1",name:" ",role:"  "}],additionalInfo:"   ,          .         .    ,        ."},{id:"3",name:"",age:"124 ",height:"195 ",imageUrl:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?q=80&w=800&auto=format&fit=crop",tags:["",""],hiddenTags:["NPC"],connections:[{id:"1",name:" ",role:" "}],additionalInfo:"  ,       .         .      ."}],mx=()=>{};var Nf={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bp={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q=function(s,t){if(!s)throw ds(t)},ds=function(s){return new Error("Firebase Database ("+bp.SDK_VERSION+") INTERNAL ASSERT FAILED: "+s)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Np=function(s){const t=[];let r=0;for(let o=0;o<s.length;o++){let c=s.charCodeAt(o);c<128?t[r++]=c:c<2048?(t[r++]=c>>6|192,t[r++]=c&63|128):(c&64512)===55296&&o+1<s.length&&(s.charCodeAt(o+1)&64512)===56320?(c=65536+((c&1023)<<10)+(s.charCodeAt(++o)&1023),t[r++]=c>>18|240,t[r++]=c>>12&63|128,t[r++]=c>>6&63|128,t[r++]=c&63|128):(t[r++]=c>>12|224,t[r++]=c>>6&63|128,t[r++]=c&63|128)}return t},gx=function(s){const t=[];let r=0,o=0;for(;r<s.length;){const c=s[r++];if(c<128)t[o++]=String.fromCharCode(c);else if(c>191&&c<224){const d=s[r++];t[o++]=String.fromCharCode((c&31)<<6|d&63)}else if(c>239&&c<365){const d=s[r++],f=s[r++],p=s[r++],g=((c&7)<<18|(d&63)<<12|(f&63)<<6|p&63)-65536;t[o++]=String.fromCharCode(55296+(g>>10)),t[o++]=String.fromCharCode(56320+(g&1023))}else{const d=s[r++],f=s[r++];t[o++]=String.fromCharCode((c&15)<<12|(d&63)<<6|f&63)}}return t.join("")},Uc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,t){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let c=0;c<s.length;c+=3){const d=s[c],f=c+1<s.length,p=f?s[c+1]:0,g=c+2<s.length,x=g?s[c+2]:0,k=d>>2,y=(d&3)<<4|p>>4;let v=(p&15)<<2|x>>6,C=x&63;g||(C=64,f||(v=64)),o.push(r[k],r[y],r[v],r[C])}return o.join("")},encodeString(s,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(s):this.encodeByteArray(Np(s),t)},decodeString(s,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(s):gx(this.decodeStringToByteArray(s,t))},decodeStringToByteArray(s,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let c=0;c<s.length;){const d=r[s.charAt(c++)],p=c<s.length?r[s.charAt(c)]:0;++c;const x=c<s.length?r[s.charAt(c)]:64;++c;const y=c<s.length?r[s.charAt(c)]:64;if(++c,d==null||p==null||x==null||y==null)throw new xx;const v=d<<2|p>>4;if(o.push(v),x!==64){const C=p<<4&240|x>>2;if(o.push(C),y!==64){const M=x<<6&192|y;o.push(M)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class xx extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const kp=function(s){const t=Np(s);return Uc.encodeByteArray(t,!0)},Uo=function(s){return kp(s).replace(/\./g,"")},wc=function(s){try{return Uc.decodeString(s,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vx(s){return Cp(void 0,s)}function Cp(s,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const r=t;return new Date(r.getTime());case Object:s===void 0&&(s={});break;case Array:s=[];break;default:return t}for(const r in t)!t.hasOwnProperty(r)||!yx(r)||(s[r]=Cp(s[r],t[r]));return s}function yx(s){return s!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _x(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wx=()=>_x().__FIREBASE_DEFAULTS__,bx=()=>{if(typeof process>"u"||typeof Nf>"u")return;const s=Nf.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},Nx=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=s&&wc(s[1]);return t&&JSON.parse(t)},Sp=()=>{try{return mx()||wx()||bx()||Nx()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},kx=s=>{var t,r;return(r=(t=Sp())==null?void 0:t.emulatorHosts)==null?void 0:r[s]},Cx=s=>{const t=kx(s);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const o=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),o]:[t.substring(0,r),o]},jp=()=>{var s;return(s=Sp())==null?void 0:s.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,o)=>{r?this.reject(r):this.resolve(o),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,o))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wc(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Sx(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jx(s,t){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},o=t||"demo-project",c=s.iat||0,d=s.sub||s.user_id;if(!d)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const f={iss:`https://securetoken.google.com/${o}`,aud:o,iat:c,exp:c+3600,auth_time:c,sub:d,user_id:d,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Uo(JSON.stringify(r)),Uo(JSON.stringify(f)),""].join(".")}const si={};function Ex(){const s={prod:[],emulator:[]};for(const t of Object.keys(si))si[t]?s.emulator.push(t):s.prod.push(t);return s}function Ix(s){let t=document.getElementById(s),r=!1;return t||(t=document.createElement("div"),t.setAttribute("id",s),r=!0),{created:r,element:t}}let kf=!1;function Tx(s,t){if(typeof window>"u"||typeof document>"u"||!Wc(window.location.host)||si[s]===t||si[s]||kf)return;si[s]=t;function r(v){return`__firebase__banner__${v}`}const o="__firebase__banner",d=Ex().prod.length>0;function f(){const v=document.getElementById(o);v&&v.remove()}function p(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function g(v,C){v.setAttribute("width","24"),v.setAttribute("id",C),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function x(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{kf=!0,f()},v}function k(v,C){v.setAttribute("id",C),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function y(){const v=Ix(o),C=r("text"),M=document.getElementById(C)||document.createElement("span"),B=r("learnmore"),ne=document.getElementById(B)||document.createElement("a"),ue=r("preprendIcon"),se=document.getElementById(ue)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const je=v.element;p(je),k(ne,B);const he=x();g(se,ue),je.append(se,M,ne,he),document.body.appendChild(je)}d?(M.innerText="Preview backend disconnected.",se.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(se.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,M.innerText="Preview backend running in this workspace."),M.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rx(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ep(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Rx())}function Px(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Lx(){return bp.NODE_ADMIN===!0}function Mx(){try{return typeof indexedDB=="object"}catch{return!1}}function Dx(){return new Promise((s,t)=>{try{let r=!0;const o="validate-browser-context-for-indexeddb-analytics-module",c=self.indexedDB.open(o);c.onsuccess=()=>{c.result.close(),r||self.indexedDB.deleteDatabase(o),s(!0)},c.onupgradeneeded=()=>{r=!1},c.onerror=()=>{var d;t(((d=c.error)==null?void 0:d.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ox="FirebaseError";class yi extends Error{constructor(t,r,o){super(r),this.code=t,this.customData=o,this.name=Ox,Object.setPrototypeOf(this,yi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ip.prototype.create)}}class Ip{constructor(t,r,o){this.service=t,this.serviceName=r,this.errors=o}create(t,...r){const o=r[0]||{},c=`${this.service}/${t}`,d=this.errors[t],f=d?Ax(d,o):"Error",p=`${this.serviceName}: ${f} (${c}).`;return new yi(c,p,o)}}function Ax(s,t){return s.replace(Fx,(r,o)=>{const c=t[o];return c!=null?String(c):`<${o}?>`})}const Fx=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(s){return JSON.parse(s)}function bt(s){return JSON.stringify(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp=function(s){let t={},r={},o={},c="";try{const d=s.split(".");t=ui(wc(d[0])||""),r=ui(wc(d[1])||""),c=d[2],o=r.d||{},delete r.d}catch{}return{header:t,claims:r,data:o,signature:c}},$x=function(s){const t=Tp(s),r=t.claims;return!!r&&typeof r=="object"&&r.hasOwnProperty("iat")},zx=function(s){const t=Tp(s).claims;return typeof t=="object"&&t.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mn(s,t){return Object.prototype.hasOwnProperty.call(s,t)}function ls(s,t){if(Object.prototype.hasOwnProperty.call(s,t))return s[t]}function Cf(s){for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t))return!1;return!0}function Wo(s,t,r){const o={};for(const c in s)Object.prototype.hasOwnProperty.call(s,c)&&(o[c]=t.call(r,s[c],c,s));return o}function Bo(s,t){if(s===t)return!0;const r=Object.keys(s),o=Object.keys(t);for(const c of r){if(!o.includes(c))return!1;const d=s[c],f=t[c];if(Sf(d)&&Sf(f)){if(!Bo(d,f))return!1}else if(d!==f)return!1}for(const c of o)if(!r.includes(c))return!1;return!0}function Sf(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ux(s){const t=[];for(const[r,o]of Object.entries(s))Array.isArray(o)?o.forEach(c=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(c))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(o));return t.length?"&"+t.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,r){r||(r=0);const o=this.W_;if(typeof t=="string")for(let y=0;y<16;y++)o[y]=t.charCodeAt(r)<<24|t.charCodeAt(r+1)<<16|t.charCodeAt(r+2)<<8|t.charCodeAt(r+3),r+=4;else for(let y=0;y<16;y++)o[y]=t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3],r+=4;for(let y=16;y<80;y++){const v=o[y-3]^o[y-8]^o[y-14]^o[y-16];o[y]=(v<<1|v>>>31)&4294967295}let c=this.chain_[0],d=this.chain_[1],f=this.chain_[2],p=this.chain_[3],g=this.chain_[4],x,k;for(let y=0;y<80;y++){y<40?y<20?(x=p^d&(f^p),k=1518500249):(x=d^f^p,k=1859775393):y<60?(x=d&f|p&(d|f),k=2400959708):(x=d^f^p,k=3395469782);const v=(c<<5|c>>>27)+x+g+k+o[y]&4294967295;g=p,p=f,f=(d<<30|d>>>2)&4294967295,d=c,c=v}this.chain_[0]=this.chain_[0]+c&4294967295,this.chain_[1]=this.chain_[1]+d&4294967295,this.chain_[2]=this.chain_[2]+f&4294967295,this.chain_[3]=this.chain_[3]+p&4294967295,this.chain_[4]=this.chain_[4]+g&4294967295}update(t,r){if(t==null)return;r===void 0&&(r=t.length);const o=r-this.blockSize;let c=0;const d=this.buf_;let f=this.inbuf_;for(;c<r;){if(f===0)for(;c<=o;)this.compress_(t,c),c+=this.blockSize;if(typeof t=="string"){for(;c<r;)if(d[f]=t.charCodeAt(c),++f,++c,f===this.blockSize){this.compress_(d),f=0;break}}else for(;c<r;)if(d[f]=t[c],++f,++c,f===this.blockSize){this.compress_(d),f=0;break}}this.inbuf_=f,this.total_+=r}digest(){const t=[];let r=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let c=this.blockSize-1;c>=56;c--)this.buf_[c]=r&255,r/=256;this.compress_(this.buf_);let o=0;for(let c=0;c<5;c++)for(let d=24;d>=0;d-=8)t[o]=this.chain_[c]>>d&255,++o;return t}}function Bc(s,t){return`${s} failed: ${t} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bx=function(s){const t=[];let r=0;for(let o=0;o<s.length;o++){let c=s.charCodeAt(o);if(c>=55296&&c<=56319){const d=c-55296;o++,q(o<s.length,"Surrogate pair missing trail surrogate.");const f=s.charCodeAt(o)-56320;c=65536+(d<<10)+f}c<128?t[r++]=c:c<2048?(t[r++]=c>>6|192,t[r++]=c&63|128):c<65536?(t[r++]=c>>12|224,t[r++]=c>>6&63|128,t[r++]=c&63|128):(t[r++]=c>>18|240,t[r++]=c>>12&63|128,t[r++]=c>>6&63|128,t[r++]=c&63|128)}return t},ol=function(s){let t=0;for(let r=0;r<s.length;r++){const o=s.charCodeAt(r);o<128?t++:o<2048?t+=2:o>=55296&&o<=56319?(t+=4,r++):t+=3}return t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _i(s){return s&&s._delegate?s._delegate:s}class di{constructor(t,r,o){this.name=t,this.instanceFactory=r,this.type=o,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hx{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const o=new il;if(this.instancesDeferred.set(r,o),this.isInitialized(r)||this.shouldAutoInitialize())try{const c=this.getOrInitializeService({instanceIdentifier:r});c&&o.resolve(c)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),o=(t==null?void 0:t.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(c){if(o)return null;throw c}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Yx(t))try{this.getOrInitializeService({instanceIdentifier:br})}catch{}for(const[r,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(r);try{const d=this.getOrInitializeService({instanceIdentifier:c});o.resolve(d)}catch{}}}}clearInstance(t=br){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=br){return this.instances.has(t)}getOptions(t=br){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(`${this.name}(${o}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const c=this.getOrInitializeService({instanceIdentifier:o,options:r});for(const[d,f]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(d);o===p&&f.resolve(c)}return c}onInit(t,r){const o=this.normalizeInstanceIdentifier(r),c=this.onInitCallbacks.get(o)??new Set;c.add(t),this.onInitCallbacks.set(o,c);const d=this.instances.get(o);return d&&t(d,o),()=>{c.delete(t)}}invokeOnInitCallbacks(t,r){const o=this.onInitCallbacks.get(r);if(o)for(const c of o)try{c(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let o=this.instances.get(t);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:Vx(t),options:r}),this.instances.set(t,o),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(o,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,o)}catch{}return o||null}normalizeInstanceIdentifier(t=br){return this.component?this.component.multipleInstances?t:br:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Vx(s){return s===br?void 0:s}function Yx(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new Hx(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Je;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Je||(Je={}));const Gx={debug:Je.DEBUG,verbose:Je.VERBOSE,info:Je.INFO,warn:Je.WARN,error:Je.ERROR,silent:Je.SILENT},Xx=Je.INFO,qx={[Je.DEBUG]:"log",[Je.VERBOSE]:"log",[Je.INFO]:"info",[Je.WARN]:"warn",[Je.ERROR]:"error"},Kx=(s,t,...r)=>{if(t<s.logLevel)return;const o=new Date().toISOString(),c=qx[t];if(c)console[c](`[${o}]  ${s.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Rp{constructor(t){this.name=t,this._logLevel=Xx,this._logHandler=Kx,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Je))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Gx[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Je.DEBUG,...t),this._logHandler(this,Je.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Je.VERBOSE,...t),this._logHandler(this,Je.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Je.INFO,...t),this._logHandler(this,Je.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Je.WARN,...t),this._logHandler(this,Je.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Je.ERROR,...t),this._logHandler(this,Je.ERROR,...t)}}const Jx=(s,t)=>t.some(r=>s instanceof r);let jf,Ef;function Zx(){return jf||(jf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ev(){return Ef||(Ef=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Pp=new WeakMap,bc=new WeakMap,Lp=new WeakMap,cc=new WeakMap,Hc=new WeakMap;function tv(s){const t=new Promise((r,o)=>{const c=()=>{s.removeEventListener("success",d),s.removeEventListener("error",f)},d=()=>{r(er(s.result)),c()},f=()=>{o(s.error),c()};s.addEventListener("success",d),s.addEventListener("error",f)});return t.then(r=>{r instanceof IDBCursor&&Pp.set(r,s)}).catch(()=>{}),Hc.set(t,s),t}function nv(s){if(bc.has(s))return;const t=new Promise((r,o)=>{const c=()=>{s.removeEventListener("complete",d),s.removeEventListener("error",f),s.removeEventListener("abort",f)},d=()=>{r(),c()},f=()=>{o(s.error||new DOMException("AbortError","AbortError")),c()};s.addEventListener("complete",d),s.addEventListener("error",f),s.addEventListener("abort",f)});bc.set(s,t)}let Nc={get(s,t,r){if(s instanceof IDBTransaction){if(t==="done")return bc.get(s);if(t==="objectStoreNames")return s.objectStoreNames||Lp.get(s);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return er(s[t])},set(s,t,r){return s[t]=r,!0},has(s,t){return s instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in s}};function rv(s){Nc=s(Nc)}function sv(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const o=s.call(uc(this),t,...r);return Lp.set(o,t.sort?t.sort():[t]),er(o)}:ev().includes(s)?function(...t){return s.apply(uc(this),t),er(Pp.get(this))}:function(...t){return er(s.apply(uc(this),t))}}function iv(s){return typeof s=="function"?sv(s):(s instanceof IDBTransaction&&nv(s),Jx(s,Zx())?new Proxy(s,Nc):s)}function er(s){if(s instanceof IDBRequest)return tv(s);if(cc.has(s))return cc.get(s);const t=iv(s);return t!==s&&(cc.set(s,t),Hc.set(t,s)),t}const uc=s=>Hc.get(s);function ov(s,t,{blocked:r,upgrade:o,blocking:c,terminated:d}={}){const f=indexedDB.open(s,t),p=er(f);return o&&f.addEventListener("upgradeneeded",g=>{o(er(f.result),g.oldVersion,g.newVersion,er(f.transaction),g)}),r&&f.addEventListener("blocked",g=>r(g.oldVersion,g.newVersion,g)),p.then(g=>{d&&g.addEventListener("close",()=>d()),c&&g.addEventListener("versionchange",x=>c(x.oldVersion,x.newVersion,x))}).catch(()=>{}),p}const lv=["get","getKey","getAll","getAllKeys","count"],av=["put","add","delete","clear"],dc=new Map;function If(s,t){if(!(s instanceof IDBDatabase&&!(t in s)&&typeof t=="string"))return;if(dc.get(t))return dc.get(t);const r=t.replace(/FromIndex$/,""),o=t!==r,c=av.includes(r);if(!(r in(o?IDBIndex:IDBObjectStore).prototype)||!(c||lv.includes(r)))return;const d=async function(f,...p){const g=this.transaction(f,c?"readwrite":"readonly");let x=g.store;return o&&(x=x.index(p.shift())),(await Promise.all([x[r](...p),c&&g.done]))[0]};return dc.set(t,d),d}rv(s=>({...s,get:(t,r,o)=>If(t,r)||s.get(t,r,o),has:(t,r)=>!!If(t,r)||s.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(uv(r)){const o=r.getImmediate();return`${o.library}/${o.version}`}else return null}).filter(r=>r).join(" ")}}function uv(s){const t=s.getComponent();return(t==null?void 0:t.type)==="VERSION"}const kc="@firebase/app",Tf="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn=new Rp("@firebase/app"),dv="@firebase/app-compat",hv="@firebase/analytics-compat",fv="@firebase/analytics",pv="@firebase/app-check-compat",mv="@firebase/app-check",gv="@firebase/auth",xv="@firebase/auth-compat",vv="@firebase/database",yv="@firebase/data-connect",_v="@firebase/database-compat",wv="@firebase/functions",bv="@firebase/functions-compat",Nv="@firebase/installations",kv="@firebase/installations-compat",Cv="@firebase/messaging",Sv="@firebase/messaging-compat",jv="@firebase/performance",Ev="@firebase/performance-compat",Iv="@firebase/remote-config",Tv="@firebase/remote-config-compat",Rv="@firebase/storage",Pv="@firebase/storage-compat",Lv="@firebase/firestore",Mv="@firebase/ai",Dv="@firebase/firestore-compat",Ov="firebase",Av="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cc="[DEFAULT]",Fv={[kc]:"fire-core",[dv]:"fire-core-compat",[fv]:"fire-analytics",[hv]:"fire-analytics-compat",[mv]:"fire-app-check",[pv]:"fire-app-check-compat",[gv]:"fire-auth",[xv]:"fire-auth-compat",[vv]:"fire-rtdb",[yv]:"fire-data-connect",[_v]:"fire-rtdb-compat",[wv]:"fire-fn",[bv]:"fire-fn-compat",[Nv]:"fire-iid",[kv]:"fire-iid-compat",[Cv]:"fire-fcm",[Sv]:"fire-fcm-compat",[jv]:"fire-perf",[Ev]:"fire-perf-compat",[Iv]:"fire-rc",[Tv]:"fire-rc-compat",[Rv]:"fire-gcs",[Pv]:"fire-gcs-compat",[Lv]:"fire-fst",[Dv]:"fire-fst-compat",[Mv]:"fire-vertex","fire-js":"fire-js",[Ov]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ho=new Map,$v=new Map,Sc=new Map;function Rf(s,t){try{s.container.addComponent(t)}catch(r){Rn.debug(`Component ${t.name} failed to register with FirebaseApp ${s.name}`,r)}}function Vo(s){const t=s.name;if(Sc.has(t))return Rn.debug(`There were multiple attempts to register component ${t}.`),!1;Sc.set(t,s);for(const r of Ho.values())Rf(r,s);for(const r of $v.values())Rf(r,s);return!0}function zv(s,t){const r=s.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),s.container.getProvider(t)}function Uv(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wv={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},tr=new Ip("app","Firebase",Wv);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(t,r,o){this._isDeleted=!1,this._options={...t},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=o,this.container.addComponent(new di("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw tr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hv=Av;function Mp(s,t={}){let r=s;typeof t!="object"&&(t={name:t});const o={name:Cc,automaticDataCollectionEnabled:!0,...t},c=o.name;if(typeof c!="string"||!c)throw tr.create("bad-app-name",{appName:String(c)});if(r||(r=jp()),!r)throw tr.create("no-options");const d=Ho.get(c);if(d){if(Bo(r,d.options)&&Bo(o,d.config))return d;throw tr.create("duplicate-app",{appName:c})}const f=new Qx(c);for(const g of Sc.values())f.addComponent(g);const p=new Bv(r,o,f);return Ho.set(c,p),p}function Vv(s=Cc){const t=Ho.get(s);if(!t&&s===Cc&&jp())return Mp();if(!t)throw tr.create("no-app",{appName:s});return t}function rs(s,t,r){let o=Fv[s]??s;r&&(o+=`-${r}`);const c=o.match(/\s|\//),d=t.match(/\s|\//);if(c||d){const f=[`Unable to register library "${o}" with version "${t}":`];c&&f.push(`library name "${o}" contains illegal characters (whitespace or "/")`),c&&d&&f.push("and"),d&&f.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Rn.warn(f.join(" "));return}Vo(new di(`${o}-version`,()=>({library:o,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yv="firebase-heartbeat-database",Qv=1,hi="firebase-heartbeat-store";let hc=null;function Dp(){return hc||(hc=ov(Yv,Qv,{upgrade:(s,t)=>{switch(t){case 0:try{s.createObjectStore(hi)}catch(r){console.warn(r)}}}}).catch(s=>{throw tr.create("idb-open",{originalErrorMessage:s.message})})),hc}async function Gv(s){try{const r=(await Dp()).transaction(hi),o=await r.objectStore(hi).get(Op(s));return await r.done,o}catch(t){if(t instanceof yi)Rn.warn(t.message);else{const r=tr.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Rn.warn(r.message)}}}async function Pf(s,t){try{const o=(await Dp()).transaction(hi,"readwrite");await o.objectStore(hi).put(t,Op(s)),await o.done}catch(r){if(r instanceof yi)Rn.warn(r.message);else{const o=tr.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Rn.warn(o.message)}}}function Op(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xv=1024,qv=30;class Kv{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Zv(r),this._heartbeatsCachePromise=this._storage.read().then(o=>(this._heartbeatsCache=o,o))}async triggerHeartbeat(){var t,r;try{const c=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),d=Lf();if(((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===d||this._heartbeatsCache.heartbeats.some(f=>f.date===d))return;if(this._heartbeatsCache.heartbeats.push({date:d,agent:c}),this._heartbeatsCache.heartbeats.length>qv){const f=ey(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(f,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(o){Rn.warn(o)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Lf(),{heartbeatsToSend:o,unsentEntries:c}=Jv(this._heartbeatsCache.heartbeats),d=Uo(JSON.stringify({version:2,heartbeats:o}));return this._heartbeatsCache.lastSentHeartbeatDate=r,c.length>0?(this._heartbeatsCache.heartbeats=c,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),d}catch(r){return Rn.warn(r),""}}}function Lf(){return new Date().toISOString().substring(0,10)}function Jv(s,t=Xv){const r=[];let o=s.slice();for(const c of s){const d=r.find(f=>f.agent===c.agent);if(d){if(d.dates.push(c.date),Mf(r)>t){d.dates.pop();break}}else if(r.push({agent:c.agent,dates:[c.date]}),Mf(r)>t){r.pop();break}o=o.slice(1)}return{heartbeatsToSend:r,unsentEntries:o}}class Zv{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Mx()?Dx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Gv(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const o=await this.read();return Pf(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??o.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const o=await this.read();return Pf(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...t.heartbeats]})}else return}}function Mf(s){return Uo(JSON.stringify({version:2,heartbeats:s})).length}function ey(s){if(s.length===0)return-1;let t=0,r=s[0].date;for(let o=1;o<s.length;o++)s[o].date<r&&(r=s[o].date,t=o);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(s){Vo(new di("platform-logger",t=>new cv(t),"PRIVATE")),Vo(new di("heartbeat",t=>new Kv(t),"PRIVATE")),rs(kc,Tf,s),rs(kc,Tf,"esm2020"),rs("fire-js","")}ty("");var ny="firebase",ry="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rs(ny,ry,"app");var Df={};const Of="@firebase/database",Af="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ap="";function sy(s){Ap=s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,r){r==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),bt(r))}get(t){const r=this.domStorage_.getItem(this.prefixedName_(t));return r==null?null:ui(r)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,r){r==null?delete this.cache_[t]:this.cache_[t]=r}get(t){return Mn(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fp=function(s){try{if(typeof window<"u"&&typeof window[s]<"u"){const t=window[s];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new iy(t)}}catch{}return new oy},kr=Fp("localStorage"),ly=Fp("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss=new Rp("@firebase/database"),ay=(function(){let s=1;return function(){return s++}})(),$p=function(s){const t=Bx(s),r=new Wx;r.update(t);const o=r.digest();return Uc.encodeByteArray(o)},wi=function(...s){let t="";for(let r=0;r<s.length;r++){const o=s[r];Array.isArray(o)||o&&typeof o=="object"&&typeof o.length=="number"?t+=wi.apply(null,o):typeof o=="object"?t+=bt(o):t+=o,t+=" "}return t};let ii=null,Ff=!0;const cy=function(s,t){q(!0,"Can't turn on custom loggers persistently."),ss.logLevel=Je.VERBOSE,ii=ss.log.bind(ss)},Rt=function(...s){if(Ff===!0&&(Ff=!1,ii===null&&ly.get("logging_enabled")===!0&&cy()),ii){const t=wi.apply(null,s);ii(t)}},bi=function(s){return function(...t){Rt(s,...t)}},jc=function(...s){const t="FIREBASE INTERNAL ERROR: "+wi(...s);ss.error(t)},Pn=function(...s){const t=`FIREBASE FATAL ERROR: ${wi(...s)}`;throw ss.error(t),new Error(t)},Bt=function(...s){const t="FIREBASE WARNING: "+wi(...s);ss.warn(t)},uy=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Bt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},zp=function(s){return typeof s=="number"&&(s!==s||s===Number.POSITIVE_INFINITY||s===Number.NEGATIVE_INFINITY)},dy=function(s){if(document.readyState==="complete")s();else{let t=!1;const r=function(){if(!document.body){setTimeout(r,Math.floor(10));return}t||(t=!0,s())};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&r()}),window.attachEvent("onload",r))}},as="[MIN_NAME]",Sr="[MAX_NAME]",hs=function(s,t){if(s===t)return 0;if(s===as||t===Sr)return-1;if(t===as||s===Sr)return 1;{const r=$f(s),o=$f(t);return r!==null?o!==null?r-o===0?s.length-t.length:r-o:-1:o!==null?1:s<t?-1:1}},hy=function(s,t){return s===t?0:s<t?-1:1},Zs=function(s,t){if(t&&s in t)return t[s];throw new Error("Missing required key ("+s+") in object: "+bt(t))},Vc=function(s){if(typeof s!="object"||s===null)return bt(s);const t=[];for(const o in s)t.push(o);t.sort();let r="{";for(let o=0;o<t.length;o++)o!==0&&(r+=","),r+=bt(t[o]),r+=":",r+=Vc(s[t[o]]);return r+="}",r},Up=function(s,t){const r=s.length;if(r<=t)return[s];const o=[];for(let c=0;c<r;c+=t)c+t>r?o.push(s.substring(c,r)):o.push(s.substring(c,c+t));return o};function Ht(s,t){for(const r in s)s.hasOwnProperty(r)&&t(r,s[r])}const Wp=function(s){q(!zp(s),"Invalid JSON number");const t=11,r=52,o=(1<<t-1)-1;let c,d,f,p,g;s===0?(d=0,f=0,c=1/s===-1/0?1:0):(c=s<0,s=Math.abs(s),s>=Math.pow(2,1-o)?(p=Math.min(Math.floor(Math.log(s)/Math.LN2),o),d=p+o,f=Math.round(s*Math.pow(2,r-p)-Math.pow(2,r))):(d=0,f=Math.round(s/Math.pow(2,1-o-r))));const x=[];for(g=r;g;g-=1)x.push(f%2?1:0),f=Math.floor(f/2);for(g=t;g;g-=1)x.push(d%2?1:0),d=Math.floor(d/2);x.push(c?1:0),x.reverse();const k=x.join("");let y="";for(g=0;g<64;g+=8){let v=parseInt(k.substr(g,8),2).toString(16);v.length===1&&(v="0"+v),y=y+v}return y.toLowerCase()},fy=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},py=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function my(s,t){let r="Unknown Error";s==="too_big"?r="The data requested exceeds the maximum size that can be accessed with a single request.":s==="permission_denied"?r="Client doesn't have permission to access the desired data.":s==="unavailable"&&(r="The service is unavailable");const o=new Error(s+" at "+t._path.toString()+": "+r);return o.code=s.toUpperCase(),o}const gy=new RegExp("^-?(0*)\\d{1,10}$"),xy=-2147483648,vy=2147483647,$f=function(s){if(gy.test(s)){const t=Number(s);if(t>=xy&&t<=vy)return t}return null},fs=function(s){try{s()}catch(t){setTimeout(()=>{const r=t.stack||"";throw Bt("Exception was thrown by user callback.",r),t},Math.floor(0))}},yy=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},oi=function(s,t){const r=setTimeout(s,t);return typeof r=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(r):typeof r=="object"&&r.unref&&r.unref(),r};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(t,r){this.appCheckProvider=r,this.appName=t.name,Uv(t)&&t.settings.appCheckToken&&(this.serverAppAppCheckToken=t.settings.appCheckToken),this.appCheck=r==null?void 0:r.getImmediate({optional:!0}),this.appCheck||r==null||r.get().then(o=>this.appCheck=o)}getToken(t){if(this.serverAppAppCheckToken){if(t)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(t):new Promise((r,o)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(r,o):r(null)},0)})}addTokenChangeListener(t){var r;(r=this.appCheckProvider)==null||r.get().then(o=>o.addTokenListener(t))}notifyForInvalidToken(){Bt(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(t,r,o){this.appName_=t,this.firebaseOptions_=r,this.authProvider_=o,this.auth_=null,this.auth_=o.getImmediate({optional:!0}),this.auth_||o.onInit(c=>this.auth_=c)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(r=>r&&r.code==="auth/token-not-initialized"?(Rt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(r)):new Promise((r,o)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(r,o):r(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(r=>r.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(r=>r.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Bt(t)}}class $o{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}$o.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yc="5",Bp="v",Hp="s",Vp="r",Yp="f",Qp=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Gp="ls",Xp="p",Ec="ac",qp="websocket",Kp="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(t,r,o,c,d=!1,f="",p=!1,g=!1,x=null){this.secure=r,this.namespace=o,this.webSocketOnly=c,this.nodeAdmin=d,this.persistenceKey=f,this.includeNamespaceInQueryParams=p,this.isUsingEmulator=g,this.emulatorOptions=x,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=kr.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&kr.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",r=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${r}`}}function by(s){return s.host!==s.internalHost||s.isCustomHost()||s.includeNamespaceInQueryParams}function Zp(s,t,r){q(typeof t=="string","typeof type must == string"),q(typeof r=="object","typeof params must == object");let o;if(t===qp)o=(s.secure?"wss://":"ws://")+s.internalHost+"/.ws?";else if(t===Kp)o=(s.secure?"https://":"http://")+s.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);by(s)&&(r.ns=s.namespace);const c=[];return Ht(r,(d,f)=>{c.push(d+"="+f)}),o+c.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(){this.counters_={}}incrementCounter(t,r=1){Mn(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=r}get(){return vx(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fc={},pc={};function Qc(s){const t=s.toString();return fc[t]||(fc[t]=new Ny),fc[t]}function ky(s,t){const r=s.toString();return pc[r]||(pc[r]=t()),pc[r]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,r){this.closeAfterResponse=t,this.onClose=r,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,r){for(this.pendingResponses[t]=r;this.pendingResponses[this.currentResponseNum];){const o=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let c=0;c<o.length;++c)o[c]&&fs(()=>{this.onMessage_(o[c])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zf="start",Sy="close",jy="pLPCommand",Ey="pRTLPCB",em="id",tm="pw",nm="ser",Iy="cb",Ty="seg",Ry="ts",Py="d",Ly="dframe",rm=1870,sm=30,My=rm-sm,Dy=25e3,Oy=3e4;class ns{constructor(t,r,o,c,d,f,p){this.connId=t,this.repoInfo=r,this.applicationId=o,this.appCheckToken=c,this.authToken=d,this.transportSessionId=f,this.lastSessionId=p,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=bi(t),this.stats_=Qc(r),this.urlFn=g=>(this.appCheckToken&&(g[Ec]=this.appCheckToken),Zp(r,Kp,g))}open(t,r){this.curSegmentNum=0,this.onDisconnect_=r,this.myPacketOrderer=new Cy(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Oy)),dy(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Gc((...d)=>{const[f,p,g,x,k]=d;if(this.incrementIncomingBytes_(d),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,f===zf)this.id=p,this.password=g;else if(f===Sy)p?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(p,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+f)},(...d)=>{const[f,p]=d;this.incrementIncomingBytes_(d),this.myPacketOrderer.handleResponse(f,p)},()=>{this.onClosed_()},this.urlFn);const o={};o[zf]="t",o[nm]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(o[Iy]=this.scriptTagHolder.uniqueCallbackIdentifier),o[Bp]=Yc,this.transportSessionId&&(o[Hp]=this.transportSessionId),this.lastSessionId&&(o[Gp]=this.lastSessionId),this.applicationId&&(o[Xp]=this.applicationId),this.appCheckToken&&(o[Ec]=this.appCheckToken),typeof location<"u"&&location.hostname&&Qp.test(location.hostname)&&(o[Vp]=Yp);const c=this.urlFn(o);this.log_("Connecting via long-poll to "+c),this.scriptTagHolder.addTag(c,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ns.forceAllow_=!0}static forceDisallow(){ns.forceDisallow_=!0}static isAvailable(){return ns.forceAllow_?!0:!ns.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!fy()&&!py()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const r=bt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const o=kp(r),c=Up(o,My);for(let d=0;d<c.length;d++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,c.length,c[d]),this.curSegmentNum++}addDisconnectPingFrame(t,r){this.myDisconnFrame=document.createElement("iframe");const o={};o[Ly]="t",o[em]=t,o[tm]=r,this.myDisconnFrame.src=this.urlFn(o),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const r=bt(t).length;this.bytesReceived+=r,this.stats_.incrementCounter("bytes_received",r)}}class Gc{constructor(t,r,o,c){this.onDisconnect=o,this.urlFn=c,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=ay(),window[jy+this.uniqueCallbackIdentifier]=t,window[Ey+this.uniqueCallbackIdentifier]=r,this.myIFrame=Gc.createIFrame_();let d="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(d='<script>document.domain="'+document.domain+'";<\/script>');const f="<html><body>"+d+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(f),this.myIFrame.doc.close()}catch(p){Rt("frame writing exception"),p.stack&&Rt(p.stack),Rt(p)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||Rt("No IE domain setting required")}catch{const o=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+o+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,r){for(this.myID=t,this.myPW=r,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t[em]=this.myID,t[tm]=this.myPW,t[nm]=this.currentSerial;let r=this.urlFn(t),o="",c=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+sm+o.length<=rm;){const f=this.pendingSegs.shift();o=o+"&"+Ty+c+"="+f.seg+"&"+Ry+c+"="+f.ts+"&"+Py+c+"="+f.d,c++}return r=r+o,this.addLongPollTag_(r,this.currentSerial),!0}else return!1}enqueueSegment(t,r,o){this.pendingSegs.push({seg:t,ts:r,d:o}),this.alive&&this.newRequest_()}addLongPollTag_(t,r){this.outstandingRequests.add(r);const o=()=>{this.outstandingRequests.delete(r),this.newRequest_()},c=setTimeout(o,Math.floor(Dy)),d=()=>{clearTimeout(c),o()};this.addTag(t,d)}addTag(t,r){setTimeout(()=>{try{if(!this.sendNewPolls)return;const o=this.myIFrame.doc.createElement("script");o.type="text/javascript",o.async=!0,o.src=t,o.onload=o.onreadystatechange=function(){const c=o.readyState;(!c||c==="loaded"||c==="complete")&&(o.onload=o.onreadystatechange=null,o.parentNode&&o.parentNode.removeChild(o),r())},o.onerror=()=>{Rt("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(o)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay=16384,Fy=45e3;let Yo=null;typeof MozWebSocket<"u"?Yo=MozWebSocket:typeof WebSocket<"u"&&(Yo=WebSocket);class hn{constructor(t,r,o,c,d,f,p){this.connId=t,this.applicationId=o,this.appCheckToken=c,this.authToken=d,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=bi(this.connId),this.stats_=Qc(r),this.connURL=hn.connectionURL_(r,f,p,c,o),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,o,c,d){const f={};return f[Bp]=Yc,typeof location<"u"&&location.hostname&&Qp.test(location.hostname)&&(f[Vp]=Yp),r&&(f[Hp]=r),o&&(f[Gp]=o),c&&(f[Ec]=c),d&&(f[Xp]=d),Zp(t,qp,f)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,kr.set("previous_websocket_failure",!0);try{let o;Lx(),this.mySock=new Yo(this.connURL,[],o)}catch(o){this.log_("Error instantiating WebSocket.");const c=o.message||o.data;c&&this.log_(c),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=o=>{this.handleIncomingFrame(o)},this.mySock.onerror=o=>{this.log_("WebSocket error.  Closing connection.");const c=o.message||o.data;c&&this.log_(c),this.onClosed_()}}start(){}static forceDisallow(){hn.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=/Android ([0-9]{0,}\.[0-9]{0,})/,o=navigator.userAgent.match(r);o&&o.length>1&&parseFloat(o[1])<4.4&&(t=!0)}return!t&&Yo!==null&&!hn.forceDisallow_}static previouslyFailed(){return kr.isInMemoryStorage||kr.get("previous_websocket_failure")===!0}markConnectionHealthy(){kr.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const o=ui(r);this.onMessage(o)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(q(this.frames===null,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{const o=this.extractFrameCount_(r);o!==null&&this.appendFrame_(o)}}send(t){this.resetKeepAlive();const r=bt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const o=Up(r,Ay);o.length>1&&this.sendString_(String(o.length));for(let c=0;c<o.length;c++)this.sendString_(o[c])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Fy))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}hn.responsesRequiredToBeHealthy=2;hn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{static get ALL_TRANSPORTS(){return[ns,hn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){const r=hn&&hn.isAvailable();let o=r&&!hn.previouslyFailed();if(t.webSocketOnly&&(r||Bt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[hn];else{const c=this.transports_=[];for(const d of fi.ALL_TRANSPORTS)d&&d.isAvailable()&&c.push(d);fi.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}fi.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y=6e4,zy=5e3,Uy=10*1024,Wy=100*1024,mc="t",Uf="d",By="s",Wf="r",Hy="e",Bf="o",Hf="a",Vf="n",Yf="p",Vy="h";class Yy{constructor(t,r,o,c,d,f,p,g,x,k){this.id=t,this.repoInfo_=r,this.applicationId_=o,this.appCheckToken_=c,this.authToken_=d,this.onMessage_=f,this.onReady_=p,this.onDisconnect_=g,this.onKill_=x,this.lastSessionId=k,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=bi("c:"+this.id+":"),this.transportManager_=new fi(r),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.conn_),o=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(r,o)},Math.floor(0));const c=t.healthyTimeout||0;c>0&&(this.healthyTimeout_=oi(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Wy?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Uy?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(c)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return r=>{t===this.conn_?this.onConnectionLost_(r):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return r=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(r):t===this.secondaryConn_?this.onSecondaryMessageReceived_(r):this.log_("message on old connection"))}}sendRequest(t){const r={t:"d",d:t};this.sendData_(r)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(mc in t){const r=t[mc];r===Hf?this.upgradeIfSecondaryHealthy_():r===Wf?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):r===Bf&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const r=Zs("t",t),o=Zs("d",t);if(r==="c")this.onSecondaryControl_(o);else if(r==="d")this.pendingDataMessages.push(o);else throw new Error("Unknown protocol layer: "+r)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Yf,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Hf,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Vf,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const r=Zs("t",t),o=Zs("d",t);r==="c"?this.onControl_(o):r==="d"&&this.onDataMessage_(o)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const r=Zs(mc,t);if(Uf in t){const o=t[Uf];if(r===Vy){const c={...o};this.repoInfo_.isUsingEmulator&&(c.h=this.repoInfo_.host),this.onHandshake_(c)}else if(r===Vf){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let c=0;c<this.pendingDataMessages.length;++c)this.onDataMessage_(this.pendingDataMessages[c]);this.pendingDataMessages=[],this.tryCleanupConnection()}else r===By?this.onConnectionShutdown_(o):r===Wf?this.onReset_(o):r===Hy?jc("Server Error: "+o):r===Bf?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):jc("Unknown control packet command: "+r)}}onHandshake_(t){const r=t.ts,o=t.v,c=t.h;this.sessionId=t.s,this.repoInfo_.host=c,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,r),Yc!==o&&Bt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.secondaryConn_),o=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,o),oi(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor($y))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,r){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(r,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):oi(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(zy))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Yf,d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(kr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class im{put(t,r,o,c){}merge(t,r,o,c){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,r,o){}onDisconnectMerge(t,r,o){}onDisconnectCancel(t,r){}reportStats(t){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(t){this.allowedEvents_=t,this.listeners_={},q(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...r){if(Array.isArray(this.listeners_[t])){const o=[...this.listeners_[t]];for(let c=0;c<o.length;c++)o[c].callback.apply(o[c].context,r)}}on(t,r,o){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:r,context:o});const c=this.getInitialEvent(t);c&&r.apply(o,c)}off(t,r,o){this.validateEventType_(t);const c=this.listeners_[t]||[];for(let d=0;d<c.length;d++)if(c[d].callback===r&&(!o||o===c[d].context)){c.splice(d,1);return}}validateEventType_(t){q(this.allowedEvents_.find(r=>r===t),"Unknown event: "+t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo extends om{static getInstance(){return new Qo}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Ep()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(t){return q(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf=32,Gf=768;class qe{constructor(t,r){if(r===void 0){this.pieces_=t.split("/");let o=0;for(let c=0;c<this.pieces_.length;c++)this.pieces_[c].length>0&&(this.pieces_[o]=this.pieces_[c],o++);this.pieces_.length=o,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=r}toString(){let t="";for(let r=this.pieceNum_;r<this.pieces_.length;r++)this.pieces_[r]!==""&&(t+="/"+this.pieces_[r]);return t||"/"}}function Ye(){return new qe("")}function Pe(s){return s.pieceNum_>=s.pieces_.length?null:s.pieces_[s.pieceNum_]}function rr(s){return s.pieces_.length-s.pieceNum_}function Ze(s){let t=s.pieceNum_;return t<s.pieces_.length&&t++,new qe(s.pieces_,t)}function lm(s){return s.pieceNum_<s.pieces_.length?s.pieces_[s.pieces_.length-1]:null}function Qy(s){let t="";for(let r=s.pieceNum_;r<s.pieces_.length;r++)s.pieces_[r]!==""&&(t+="/"+encodeURIComponent(String(s.pieces_[r])));return t||"/"}function am(s,t=0){return s.pieces_.slice(s.pieceNum_+t)}function cm(s){if(s.pieceNum_>=s.pieces_.length)return null;const t=[];for(let r=s.pieceNum_;r<s.pieces_.length-1;r++)t.push(s.pieces_[r]);return new qe(t,0)}function gt(s,t){const r=[];for(let o=s.pieceNum_;o<s.pieces_.length;o++)r.push(s.pieces_[o]);if(t instanceof qe)for(let o=t.pieceNum_;o<t.pieces_.length;o++)r.push(t.pieces_[o]);else{const o=t.split("/");for(let c=0;c<o.length;c++)o[c].length>0&&r.push(o[c])}return new qe(r,0)}function Ae(s){return s.pieceNum_>=s.pieces_.length}function Ut(s,t){const r=Pe(s),o=Pe(t);if(r===null)return t;if(r===o)return Ut(Ze(s),Ze(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+s+")")}function Xc(s,t){if(rr(s)!==rr(t))return!1;for(let r=s.pieceNum_,o=t.pieceNum_;r<=s.pieces_.length;r++,o++)if(s.pieces_[r]!==t.pieces_[o])return!1;return!0}function fn(s,t){let r=s.pieceNum_,o=t.pieceNum_;if(rr(s)>rr(t))return!1;for(;r<s.pieces_.length;){if(s.pieces_[r]!==t.pieces_[o])return!1;++r,++o}return!0}class Gy{constructor(t,r){this.errorPrefix_=r,this.parts_=am(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let o=0;o<this.parts_.length;o++)this.byteLength_+=ol(this.parts_[o]);um(this)}}function Xy(s,t){s.parts_.length>0&&(s.byteLength_+=1),s.parts_.push(t),s.byteLength_+=ol(t),um(s)}function qy(s){const t=s.parts_.pop();s.byteLength_-=ol(t),s.parts_.length>0&&(s.byteLength_-=1)}function um(s){if(s.byteLength_>Gf)throw new Error(s.errorPrefix_+"has a key path longer than "+Gf+" bytes ("+s.byteLength_+").");if(s.parts_.length>Qf)throw new Error(s.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Qf+") or object contains a cycle "+Nr(s))}function Nr(s){return s.parts_.length===0?"":"in property '"+s.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc extends om{static getInstance(){return new qc}constructor(){super(["visible"]);let t,r;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(r="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(r="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(r="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(r="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,r&&document.addEventListener(r,()=>{const o=!document[t];o!==this.visible_&&(this.visible_=o,this.trigger("visible",o))},!1)}getInitialEvent(t){return q(t==="visible","Unknown event type: "+t),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ei=1e3,Ky=300*1e3,Xf=30*1e3,Jy=1.3,Zy=3e4,e1="server_kill",qf=3;class Tn extends im{constructor(t,r,o,c,d,f,p,g){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=o,this.onConnectStatus_=c,this.onServerInfoUpdate_=d,this.authTokenProvider_=f,this.appCheckTokenProvider_=p,this.authOverride_=g,this.id=Tn.nextPersistentConnectionId_++,this.log_=bi("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ei,this.maxReconnectDelay_=Ky,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,g)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");qc.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Qo.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,o){const c=++this.requestNumber_,d={r:c,a:t,b:r};this.log_(bt(d)),q(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(d),o&&(this.requestCBHash_[c]=o)}get(t){this.initConnection_();const r=new il,c={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:f=>{const p=f.d;f.s==="ok"?r.resolve(p):r.reject(p)}};this.outstandingGets_.push(c),this.outstandingGetCount_++;const d=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(d),r.promise}listen(t,r,o,c){this.initConnection_();const d=t._queryIdentifier,f=t._path.toString();this.log_("Listen called for "+f+" "+d),this.listens.has(f)||this.listens.set(f,new Map),q(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),q(!this.listens.get(f).has(d),"listen() called twice for same path/queryId.");const p={onComplete:c,hashFn:r,query:t,tag:o};this.listens.get(f).set(d,p),this.connected_&&this.sendListen_(p)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,o=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(o)})}sendListen_(t){const r=t.query,o=r._path.toString(),c=r._queryIdentifier;this.log_("Listen on "+o+" for "+c);const d={p:o},f="q";t.tag&&(d.q=r._queryObject,d.t=t.tag),d.h=t.hashFn(),this.sendRequest(f,d,p=>{const g=p.d,x=p.s;Tn.warnOnListenWarnings_(g,r),(this.listens.get(o)&&this.listens.get(o).get(c))===t&&(this.log_("listen response",p),x!=="ok"&&this.removeListen_(o,c),t.onComplete&&t.onComplete(x,g))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&Mn(t,"w")){const o=ls(t,"w");if(Array.isArray(o)&&~o.indexOf("no_index")){const c='".indexOn": "'+r._queryParams.getIndex().toString()+'"',d=r._path.toString();Bt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${c} at ${d} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||zx(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Xf)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=$x(t)?"auth":"gauth",o={cred:t};this.authOverride_===null?o.noauth=!0:typeof this.authOverride_=="object"&&(o.authvar=this.authOverride_),this.sendRequest(r,o,c=>{const d=c.s,f=c.d||"error";this.authToken_===t&&(d==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(d,f))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,o=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,o)})}unlisten(t,r){const o=t._path.toString(),c=t._queryIdentifier;this.log_("Unlisten called for "+o+" "+c),q(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(o,c)&&this.connected_&&this.sendUnlisten_(o,c,t._queryObject,r)}sendUnlisten_(t,r,o,c){this.log_("Unlisten on "+t+" for "+r);const d={p:t},f="n";c&&(d.q=o,d.t=c),this.sendRequest(f,d)}onDisconnectPut(t,r,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,o):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:o})}onDisconnectMerge(t,r,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,o):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:o})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,o,c){const d={p:r,d:o};this.log_("onDisconnect "+t,d),this.sendRequest(t,d,f=>{c&&setTimeout(()=>{c(f.s,f.d)},Math.floor(0))})}put(t,r,o,c){this.putInternal("p",t,r,o,c)}merge(t,r,o,c){this.putInternal("m",t,r,o,c)}putInternal(t,r,o,c,d){this.initConnection_();const f={p:r,d:o};d!==void 0&&(f.h=d),this.outstandingPuts_.push({action:t,request:f,onComplete:c}),this.outstandingPutCount_++;const p=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(p):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,o=this.outstandingPuts_[t].request,c=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,o,d=>{this.log_(r+" response",d),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),c&&c(d.s,d.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,o=>{if(o.s!=="ok"){const d=o.d;this.log_("reportStats","Error sending stats: "+d)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+bt(t));const r=t.r,o=this.requestCBHash_[r];o&&(delete this.requestCBHash_[r],o(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):jc("Unrecognized action received from server: "+bt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){q(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ei,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=ei,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Zy&&(this.reconnectDelay_=ei),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Jy)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),o=this.onRealtimeDisconnect_.bind(this),c=this.id+":"+Tn.nextConnectionId_++,d=this.lastSessionId;let f=!1,p=null;const g=function(){p?p.close():(f=!0,o())},x=function(y){q(p,"sendRequest call when we're not connected not allowed."),p.sendRequest(y)};this.realtime_={close:g,sendRequest:x};const k=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[y,v]=await Promise.all([this.authTokenProvider_.getToken(k),this.appCheckTokenProvider_.getToken(k)]);f?Rt("getToken() completed but was canceled"):(Rt("getToken() completed. Creating connection."),this.authToken_=y&&y.accessToken,this.appCheckToken_=v&&v.token,p=new Yy(c,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,o,C=>{Bt(C+" ("+this.repoInfo_.toString()+")"),this.interrupt(e1)},d))}catch(y){this.log_("Failed to get token: "+y),f||(this.repoInfo_.nodeAdmin&&Bt(y),g())}}}interrupt(t){Rt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Rt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Cf(this.interruptReasons_)&&(this.reconnectDelay_=ei,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let o;r?o=r.map(d=>Vc(d)).join("$"):o="default";const c=this.removeListen_(t,o);c&&c.onComplete&&c.onComplete("permission_denied")}removeListen_(t,r){const o=new qe(t).toString();let c;if(this.listens.has(o)){const d=this.listens.get(o);c=d.get(r),d.delete(r),d.size===0&&this.listens.delete(o)}else c=void 0;return c}onAuthRevoked_(t,r){Rt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=qf&&(this.reconnectDelay_=Xf,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Rt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=qf&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";t["sdk."+r+"."+Ap.replace(/\./g,"-")]=1,Ep()?t["framework.cordova"]=1:Px()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Qo.getInstance().currentlyOnline();return Cf(this.interruptReasons_)&&t}}Tn.nextPersistentConnectionId_=0;Tn.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(t,r){this.name=t,this.node=r}static Wrap(t,r){return new Le(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,r){const o=new Le(as,t),c=new Le(as,r);return this.compare(o,c)!==0}minPost(){return Le.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ao;class dm extends ll{static get __EMPTY_NODE(){return Ao}static set __EMPTY_NODE(t){Ao=t}compare(t,r){return hs(t.name,r.name)}isDefinedOn(t){throw ds("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,r){return!1}minPost(){return Le.MIN}maxPost(){return new Le(Sr,Ao)}makePost(t,r){return q(typeof t=="string","KeyIndex indexValue must always be a string."),new Le(t,Ao)}toString(){return".key"}}const is=new dm;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(t,r,o,c,d=null){this.isReverse_=c,this.resultGenerator_=d,this.nodeStack_=[];let f=1;for(;!t.isEmpty();)if(t=t,f=r?o(t.key,r):1,c&&(f*=-1),f<0)this.isReverse_?t=t.left:t=t.right;else if(f===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),r;if(this.resultGenerator_?r=this.resultGenerator_(t.key,t.value):r={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return r}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class wt{constructor(t,r,o,c,d){this.key=t,this.value=r,this.color=o??wt.RED,this.left=c??Wt.EMPTY_NODE,this.right=d??Wt.EMPTY_NODE}copy(t,r,o,c,d){return new wt(t??this.key,r??this.value,o??this.color,c??this.left,d??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,o){let c=this;const d=o(t,c.key);return d<0?c=c.copy(null,null,null,c.left.insert(t,r,o),null):d===0?c=c.copy(null,r,null,null,null):c=c.copy(null,null,null,null,c.right.insert(t,r,o)),c.fixUp_()}removeMin_(){if(this.left.isEmpty())return Wt.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let o,c;if(o=this,r(t,o.key)<0)!o.left.isEmpty()&&!o.left.isRed_()&&!o.left.left.isRed_()&&(o=o.moveRedLeft_()),o=o.copy(null,null,null,o.left.remove(t,r),null);else{if(o.left.isRed_()&&(o=o.rotateRight_()),!o.right.isEmpty()&&!o.right.isRed_()&&!o.right.left.isRed_()&&(o=o.moveRedRight_()),r(t,o.key)===0){if(o.right.isEmpty())return Wt.EMPTY_NODE;c=o.right.min_(),o=o.copy(c.key,c.value,null,null,o.right.removeMin_())}o=o.copy(null,null,null,null,o.right.remove(t,r))}return o.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,wt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,wt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}wt.RED=!0;wt.BLACK=!1;class t1{copy(t,r,o,c,d){return this}insert(t,r,o){return new wt(t,r,null)}remove(t,r){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Wt{constructor(t,r=Wt.EMPTY_NODE){this.comparator_=t,this.root_=r}insert(t,r){return new Wt(this.comparator_,this.root_.insert(t,r,this.comparator_).copy(null,null,wt.BLACK,null,null))}remove(t){return new Wt(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,wt.BLACK,null,null))}get(t){let r,o=this.root_;for(;!o.isEmpty();){if(r=this.comparator_(t,o.key),r===0)return o.value;r<0?o=o.left:r>0&&(o=o.right)}return null}getPredecessorKey(t){let r,o=this.root_,c=null;for(;!o.isEmpty();)if(r=this.comparator_(t,o.key),r===0){if(o.left.isEmpty())return c?c.key:null;for(o=o.left;!o.right.isEmpty();)o=o.right;return o.key}else r<0?o=o.left:r>0&&(c=o,o=o.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new Fo(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,r){return new Fo(this.root_,t,this.comparator_,!1,r)}getReverseIteratorFrom(t,r){return new Fo(this.root_,t,this.comparator_,!0,r)}getReverseIterator(t){return new Fo(this.root_,null,this.comparator_,!0,t)}}Wt.EMPTY_NODE=new t1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n1(s,t){return hs(s.name,t.name)}function Kc(s,t){return hs(s,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ic;function r1(s){Ic=s}const hm=function(s){return typeof s=="number"?"number:"+Wp(s):"string:"+s},fm=function(s){if(s.isLeafNode()){const t=s.val();q(typeof t=="string"||typeof t=="number"||typeof t=="object"&&Mn(t,".sv"),"Priority must be a string or number.")}else q(s===Ic||s.isEmpty(),"priority of unexpected type.");q(s===Ic||s.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kf;class _t{static set __childrenNodeConstructor(t){Kf=t}static get __childrenNodeConstructor(){return Kf}constructor(t,r=_t.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,q(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),fm(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new _t(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:_t.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Ae(t)?this:Pe(t)===".priority"?this.priorityNode_:_t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:_t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const o=Pe(t);return o===null?r:r.isEmpty()&&o!==".priority"?this:(q(o!==".priority"||rr(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(o,_t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ze(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+hm(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",r==="number"?t+=Wp(this.value_):t+=this.value_,this.lazyHash_=$p(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===_t.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof _t.__childrenNodeConstructor?-1:(q(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,o=typeof this.value_,c=_t.VALUE_TYPE_ORDER.indexOf(r),d=_t.VALUE_TYPE_ORDER.indexOf(o);return q(c>=0,"Unknown leaf type: "+r),q(d>=0,"Unknown leaf type: "+o),c===d?o==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:d-c}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}_t.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pm,mm;function s1(s){pm=s}function i1(s){mm=s}class o1 extends ll{compare(t,r){const o=t.node.getPriority(),c=r.node.getPriority(),d=o.compareTo(c);return d===0?hs(t.name,r.name):d}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,r){return!t.getPriority().equals(r.getPriority())}minPost(){return Le.MIN}maxPost(){return new Le(Sr,new _t("[PRIORITY-POST]",mm))}makePost(t,r){const o=pm(t);return new Le(r,new _t("[PRIORITY-POST]",o))}toString(){return".priority"}}const ct=new o1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l1=Math.log(2);class a1{constructor(t){const r=d=>parseInt(Math.log(d)/l1,10),o=d=>parseInt(Array(d+1).join("1"),2);this.count=r(t+1),this.current_=this.count-1;const c=o(this.count);this.bits_=t+1&c}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const Go=function(s,t,r,o){s.sort(t);const c=function(g,x){const k=x-g;let y,v;if(k===0)return null;if(k===1)return y=s[g],v=r?r(y):y,new wt(v,y.node,wt.BLACK,null,null);{const C=parseInt(k/2,10)+g,M=c(g,C),B=c(C+1,x);return y=s[C],v=r?r(y):y,new wt(v,y.node,wt.BLACK,M,B)}},d=function(g){let x=null,k=null,y=s.length;const v=function(M,B){const ne=y-M,ue=y;y-=M;const se=c(ne+1,ue),je=s[ne],he=r?r(je):je;C(new wt(he,je.node,B,null,se))},C=function(M){x?(x.left=M,x=M):(k=M,x=M)};for(let M=0;M<g.count;++M){const B=g.nextBitIsOne(),ne=Math.pow(2,g.count-(M+1));B?v(ne,wt.BLACK):(v(ne,wt.BLACK),v(ne,wt.RED))}return k},f=new a1(s.length),p=d(f);return new Wt(o||t,p)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gc;const ts={};class In{static get Default(){return q(ts&&ct,"ChildrenNode.ts has not been loaded"),gc=gc||new In({".priority":ts},{".priority":ct}),gc}constructor(t,r){this.indexes_=t,this.indexSet_=r}get(t){const r=ls(this.indexes_,t);if(!r)throw new Error("No index defined for "+t);return r instanceof Wt?r:null}hasIndex(t){return Mn(this.indexSet_,t.toString())}addIndex(t,r){q(t!==is,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const o=[];let c=!1;const d=r.getIterator(Le.Wrap);let f=d.getNext();for(;f;)c=c||t.isDefinedOn(f.node),o.push(f),f=d.getNext();let p;c?p=Go(o,t.getCompare()):p=ts;const g=t.toString(),x={...this.indexSet_};x[g]=t;const k={...this.indexes_};return k[g]=p,new In(k,x)}addToIndexes(t,r){const o=Wo(this.indexes_,(c,d)=>{const f=ls(this.indexSet_,d);if(q(f,"Missing index implementation for "+d),c===ts)if(f.isDefinedOn(t.node)){const p=[],g=r.getIterator(Le.Wrap);let x=g.getNext();for(;x;)x.name!==t.name&&p.push(x),x=g.getNext();return p.push(t),Go(p,f.getCompare())}else return ts;else{const p=r.get(t.name);let g=c;return p&&(g=g.remove(new Le(t.name,p))),g.insert(t,t.node)}});return new In(o,this.indexSet_)}removeFromIndexes(t,r){const o=Wo(this.indexes_,c=>{if(c===ts)return c;{const d=r.get(t.name);return d?c.remove(new Le(t.name,d)):c}});return new In(o,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ti;class Ce{static get EMPTY_NODE(){return ti||(ti=new Ce(new Wt(Kc),null,In.Default))}constructor(t,r,o){this.children_=t,this.priorityNode_=r,this.indexMap_=o,this.lazyHash_=null,this.priorityNode_&&fm(this.priorityNode_),this.children_.isEmpty()&&q(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ti}updatePriority(t){return this.children_.isEmpty()?this:new Ce(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{const r=this.children_.get(t);return r===null?ti:r}}getChild(t){const r=Pe(t);return r===null?this:this.getImmediateChild(r).getChild(Ze(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(q(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{const o=new Le(t,r);let c,d;r.isEmpty()?(c=this.children_.remove(t),d=this.indexMap_.removeFromIndexes(o,this.children_)):(c=this.children_.insert(t,r),d=this.indexMap_.addToIndexes(o,this.children_));const f=c.isEmpty()?ti:this.priorityNode_;return new Ce(c,f,d)}}updateChild(t,r){const o=Pe(t);if(o===null)return r;{q(Pe(t)!==".priority"||rr(t)===1,".priority must be the last token in a path");const c=this.getImmediateChild(o).updateChild(Ze(t),r);return this.updateImmediateChild(o,c)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let o=0,c=0,d=!0;if(this.forEachChild(ct,(f,p)=>{r[f]=p.val(t),o++,d&&Ce.INTEGER_REGEXP_.test(f)?c=Math.max(c,Number(f)):d=!1}),!t&&d&&c<2*o){const f=[];for(const p in r)f[p]=r[p];return f}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+hm(this.getPriority().val())+":"),this.forEachChild(ct,(r,o)=>{const c=o.hash();c!==""&&(t+=":"+r+":"+c)}),this.lazyHash_=t===""?"":$p(t)}return this.lazyHash_}getPredecessorChildName(t,r,o){const c=this.resolveIndex_(o);if(c){const d=c.getPredecessorKey(new Le(t,r));return d?d.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const o=r.minKey();return o&&o.name}else return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new Le(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const o=r.maxKey();return o&&o.name}else return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new Le(r,this.children_.get(r)):null}forEachChild(t,r){const o=this.resolveIndex_(t);return o?o.inorderTraversal(c=>r(c.name,c.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const o=this.resolveIndex_(r);if(o)return o.getIteratorFrom(t,c=>c);{const c=this.children_.getIteratorFrom(t.name,Le.Wrap);let d=c.peek();for(;d!=null&&r.compare(d,t)<0;)c.getNext(),d=c.peek();return c}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const o=this.resolveIndex_(r);if(o)return o.getReverseIteratorFrom(t,c=>c);{const c=this.children_.getReverseIteratorFrom(t.name,Le.Wrap);let d=c.peek();for(;d!=null&&r.compare(d,t)>0;)c.getNext(),d=c.peek();return c}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Ni?-1:0}withIndex(t){if(t===is||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new Ce(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===is||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){const o=this.getIterator(ct),c=r.getIterator(ct);let d=o.getNext(),f=c.getNext();for(;d&&f;){if(d.name!==f.name||!d.node.equals(f.node))return!1;d=o.getNext(),f=c.getNext()}return d===null&&f===null}else return!1;else return!1}}resolveIndex_(t){return t===is?null:this.indexMap_.get(t.toString())}}Ce.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class c1 extends Ce{constructor(){super(new Wt(Kc),Ce.EMPTY_NODE,In.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return Ce.EMPTY_NODE}isEmpty(){return!1}}const Ni=new c1;Object.defineProperties(Le,{MIN:{value:new Le(as,Ce.EMPTY_NODE)},MAX:{value:new Le(Sr,Ni)}});dm.__EMPTY_NODE=Ce.EMPTY_NODE;_t.__childrenNodeConstructor=Ce;r1(Ni);i1(Ni);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1=!0;function St(s,t=null){if(s===null)return Ce.EMPTY_NODE;if(typeof s=="object"&&".priority"in s&&(t=s[".priority"]),q(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof s=="object"&&".value"in s&&s[".value"]!==null&&(s=s[".value"]),typeof s!="object"||".sv"in s){const r=s;return new _t(r,St(t))}if(!(s instanceof Array)&&u1){const r=[];let o=!1;if(Ht(s,(f,p)=>{if(f.substring(0,1)!=="."){const g=St(p);g.isEmpty()||(o=o||!g.getPriority().isEmpty(),r.push(new Le(f,g)))}}),r.length===0)return Ce.EMPTY_NODE;const d=Go(r,n1,f=>f.name,Kc);if(o){const f=Go(r,ct.getCompare());return new Ce(d,St(t),new In({".priority":f},{".priority":ct}))}else return new Ce(d,St(t),In.Default)}else{let r=Ce.EMPTY_NODE;return Ht(s,(o,c)=>{if(Mn(s,o)&&o.substring(0,1)!=="."){const d=St(c);(d.isLeafNode()||!d.isEmpty())&&(r=r.updateImmediateChild(o,d))}}),r.updatePriority(St(t))}}s1(St);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1 extends ll{constructor(t){super(),this.indexPath_=t,q(!Ae(t)&&Pe(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,r){const o=this.extractChild(t.node),c=this.extractChild(r.node),d=o.compareTo(c);return d===0?hs(t.name,r.name):d}makePost(t,r){const o=St(t),c=Ce.EMPTY_NODE.updateChild(this.indexPath_,o);return new Le(r,c)}maxPost(){const t=Ce.EMPTY_NODE.updateChild(this.indexPath_,Ni);return new Le(Sr,t)}toString(){return am(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1 extends ll{compare(t,r){const o=t.node.compareTo(r.node);return o===0?hs(t.name,r.name):o}isDefinedOn(t){return!0}indexedValueChanged(t,r){return!t.equals(r)}minPost(){return Le.MIN}maxPost(){return Le.MAX}makePost(t,r){const o=St(t);return new Le(r,o)}toString(){return".value"}}const f1=new h1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gm(s){return{type:"value",snapshotNode:s}}function cs(s,t){return{type:"child_added",snapshotNode:t,childName:s}}function pi(s,t){return{type:"child_removed",snapshotNode:t,childName:s}}function mi(s,t,r){return{type:"child_changed",snapshotNode:t,childName:s,oldSnap:r}}function p1(s,t){return{type:"child_moved",snapshotNode:t,childName:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(t){this.index_=t}updateChild(t,r,o,c,d,f){q(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const p=t.getImmediateChild(r);return p.getChild(c).equals(o.getChild(c))&&p.isEmpty()===o.isEmpty()||(f!=null&&(o.isEmpty()?t.hasChild(r)?f.trackChildChange(pi(r,p)):q(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):p.isEmpty()?f.trackChildChange(cs(r,o)):f.trackChildChange(mi(r,o,p))),t.isLeafNode()&&o.isEmpty())?t:t.updateImmediateChild(r,o).withIndex(this.index_)}updateFullNode(t,r,o){return o!=null&&(t.isLeafNode()||t.forEachChild(ct,(c,d)=>{r.hasChild(c)||o.trackChildChange(pi(c,d))}),r.isLeafNode()||r.forEachChild(ct,(c,d)=>{if(t.hasChild(c)){const f=t.getImmediateChild(c);f.equals(d)||o.trackChildChange(mi(c,d,f))}else o.trackChildChange(cs(c,d))})),r.withIndex(this.index_)}updatePriority(t,r){return t.isEmpty()?Ce.EMPTY_NODE:t.updatePriority(r)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(t){this.indexedFilter_=new Jc(t.getIndex()),this.index_=t.getIndex(),this.startPost_=gi.getStartPost_(t),this.endPost_=gi.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const r=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,o=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return r&&o}updateChild(t,r,o,c,d,f){return this.matches(new Le(r,o))||(o=Ce.EMPTY_NODE),this.indexedFilter_.updateChild(t,r,o,c,d,f)}updateFullNode(t,r,o){r.isLeafNode()&&(r=Ce.EMPTY_NODE);let c=r.withIndex(this.index_);c=c.updatePriority(Ce.EMPTY_NODE);const d=this;return r.forEachChild(ct,(f,p)=>{d.matches(new Le(f,p))||(c=c.updateImmediateChild(f,Ce.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,c,o)}updatePriority(t,r){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const r=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),r)}else return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const r=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),r)}else return t.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(t){this.withinDirectionalStart=r=>this.reverse_?this.withinEndPost(r):this.withinStartPost(r),this.withinDirectionalEnd=r=>this.reverse_?this.withinStartPost(r):this.withinEndPost(r),this.withinStartPost=r=>{const o=this.index_.compare(this.rangedFilter_.getStartPost(),r);return this.startIsInclusive_?o<=0:o<0},this.withinEndPost=r=>{const o=this.index_.compare(r,this.rangedFilter_.getEndPost());return this.endIsInclusive_?o<=0:o<0},this.rangedFilter_=new gi(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,r,o,c,d,f){return this.rangedFilter_.matches(new Le(r,o))||(o=Ce.EMPTY_NODE),t.getImmediateChild(r).equals(o)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,r,o,c,d,f):this.fullLimitUpdateChild_(t,r,o,d,f)}updateFullNode(t,r,o){let c;if(r.isLeafNode()||r.isEmpty())c=Ce.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<r.numChildren()&&r.isIndexed(this.index_)){c=Ce.EMPTY_NODE.withIndex(this.index_);let d;this.reverse_?d=r.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):d=r.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let f=0;for(;d.hasNext()&&f<this.limit_;){const p=d.getNext();if(this.withinDirectionalStart(p))if(this.withinDirectionalEnd(p))c=c.updateImmediateChild(p.name,p.node),f++;else break;else continue}}else{c=r.withIndex(this.index_),c=c.updatePriority(Ce.EMPTY_NODE);let d;this.reverse_?d=c.getReverseIterator(this.index_):d=c.getIterator(this.index_);let f=0;for(;d.hasNext();){const p=d.getNext();f<this.limit_&&this.withinDirectionalStart(p)&&this.withinDirectionalEnd(p)?f++:c=c.updateImmediateChild(p.name,Ce.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,c,o)}updatePriority(t,r){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,r,o,c,d){let f;if(this.reverse_){const y=this.index_.getCompare();f=(v,C)=>y(C,v)}else f=this.index_.getCompare();const p=t;q(p.numChildren()===this.limit_,"");const g=new Le(r,o),x=this.reverse_?p.getFirstChild(this.index_):p.getLastChild(this.index_),k=this.rangedFilter_.matches(g);if(p.hasChild(r)){const y=p.getImmediateChild(r);let v=c.getChildAfterChild(this.index_,x,this.reverse_);for(;v!=null&&(v.name===r||p.hasChild(v.name));)v=c.getChildAfterChild(this.index_,v,this.reverse_);const C=v==null?1:f(v,g);if(k&&!o.isEmpty()&&C>=0)return d!=null&&d.trackChildChange(mi(r,o,y)),p.updateImmediateChild(r,o);{d!=null&&d.trackChildChange(pi(r,y));const B=p.updateImmediateChild(r,Ce.EMPTY_NODE);return v!=null&&this.rangedFilter_.matches(v)?(d!=null&&d.trackChildChange(cs(v.name,v.node)),B.updateImmediateChild(v.name,v.node)):B}}else return o.isEmpty()?t:k&&f(x,g)>=0?(d!=null&&(d.trackChildChange(pi(x.name,x.node)),d.trackChildChange(cs(r,o))),p.updateImmediateChild(r,o).updateImmediateChild(x.name,Ce.EMPTY_NODE)):t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ct}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return q(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return q(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:as}hasEnd(){return this.endSet_}getIndexEndValue(){return q(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return q(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Sr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return q(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ct}copy(){const t=new Zc;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function g1(s){return s.loadsAllData()?new Jc(s.getIndex()):s.hasLimit()?new m1(s):new gi(s)}function Jf(s){const t={};if(s.isDefault())return t;let r;if(s.index_===ct?r="$priority":s.index_===f1?r="$value":s.index_===is?r="$key":(q(s.index_ instanceof d1,"Unrecognized index type!"),r=s.index_.toString()),t.orderBy=bt(r),s.startSet_){const o=s.startAfterSet_?"startAfter":"startAt";t[o]=bt(s.indexStartValue_),s.startNameSet_&&(t[o]+=","+bt(s.indexStartName_))}if(s.endSet_){const o=s.endBeforeSet_?"endBefore":"endAt";t[o]=bt(s.indexEndValue_),s.endNameSet_&&(t[o]+=","+bt(s.indexEndName_))}return s.limitSet_&&(s.isViewFromLeft()?t.limitToFirst=s.limit_:t.limitToLast=s.limit_),t}function Zf(s){const t={};if(s.startSet_&&(t.sp=s.indexStartValue_,s.startNameSet_&&(t.sn=s.indexStartName_),t.sin=!s.startAfterSet_),s.endSet_&&(t.ep=s.indexEndValue_,s.endNameSet_&&(t.en=s.indexEndName_),t.ein=!s.endBeforeSet_),s.limitSet_){t.l=s.limit_;let r=s.viewFrom_;r===""&&(s.isViewFromLeft()?r="l":r="r"),t.vf=r}return s.index_!==ct&&(t.i=s.index_.toString()),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo extends im{reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,r){return r!==void 0?"tag$"+r:(q(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}constructor(t,r,o,c){super(),this.repoInfo_=t,this.onDataUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=c,this.log_=bi("p:rest:"),this.listens_={}}listen(t,r,o,c){const d=t._path.toString();this.log_("Listen called for "+d+" "+t._queryIdentifier);const f=Xo.getListenId_(t,o),p={};this.listens_[f]=p;const g=Jf(t._queryParams);this.restRequest_(d+".json",g,(x,k)=>{let y=k;if(x===404&&(y=null,x=null),x===null&&this.onDataUpdate_(d,y,!1,o),ls(this.listens_,f)===p){let v;x?x===401?v="permission_denied":v="rest_error:"+x:v="ok",c(v,null)}})}unlisten(t,r){const o=Xo.getListenId_(t,r);delete this.listens_[o]}get(t){const r=Jf(t._queryParams),o=t._path.toString(),c=new il;return this.restRequest_(o+".json",r,(d,f)=>{let p=f;d===404&&(p=null,d=null),d===null?(this.onDataUpdate_(o,p,!1,null),c.resolve(p)):c.reject(new Error(p))}),c.promise}refreshAuthToken(t){}restRequest_(t,r={},o){return r.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([c,d])=>{c&&c.accessToken&&(r.auth=c.accessToken),d&&d.token&&(r.ac=d.token);const f=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+Ux(r);this.log_("Sending REST request for "+f);const p=new XMLHttpRequest;p.onreadystatechange=()=>{if(o&&p.readyState===4){this.log_("REST Response for "+f+" received. status:",p.status,"response:",p.responseText);let g=null;if(p.status>=200&&p.status<300){try{g=ui(p.responseText)}catch{Bt("Failed to parse JSON response for "+f+": "+p.responseText)}o(null,g)}else p.status!==401&&p.status!==404&&Bt("Got unsuccessful REST response for "+f+" Status: "+p.status),o(p.status);o=null}},p.open("GET",f,!0),p.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(){this.rootNode_=Ce.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,r){this.rootNode_=this.rootNode_.updateChild(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qo(){return{value:null,children:new Map}}function xm(s,t,r){if(Ae(t))s.value=r,s.children.clear();else if(s.value!==null)s.value=s.value.updateChild(t,r);else{const o=Pe(t);s.children.has(o)||s.children.set(o,qo());const c=s.children.get(o);t=Ze(t),xm(c,t,r)}}function Tc(s,t,r){s.value!==null?r(t,s.value):v1(s,(o,c)=>{const d=new qe(t.toString()+"/"+o);Tc(c,d,r)})}function v1(s,t){s.children.forEach((r,o)=>{t(o,r)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),r={...t};return this.last_&&Ht(this.last_,(o,c)=>{r[o]=r[o]-c}),this.last_=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ep=10*1e3,_1=30*1e3,w1=300*1e3;class b1{constructor(t,r){this.server_=r,this.statsToReport_={},this.statsListener_=new y1(t);const o=ep+(_1-ep)*Math.random();oi(this.reportStats_.bind(this),Math.floor(o))}reportStats_(){const t=this.statsListener_.get(),r={};let o=!1;Ht(t,(c,d)=>{d>0&&Mn(this.statsToReport_,c)&&(r[c]=d,o=!0)}),o&&this.server_.reportStats(r),oi(this.reportStats_.bind(this),Math.floor(Math.random()*2*w1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pn;(function(s){s[s.OVERWRITE=0]="OVERWRITE",s[s.MERGE=1]="MERGE",s[s.ACK_USER_WRITE=2]="ACK_USER_WRITE",s[s.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(pn||(pn={}));function vm(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function eu(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function tu(s){return{fromUser:!1,fromServer:!0,queryId:s,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(t,r,o){this.path=t,this.affectedTree=r,this.revert=o,this.type=pn.ACK_USER_WRITE,this.source=vm()}operationForChild(t){if(Ae(this.path)){if(this.affectedTree.value!=null)return q(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const r=this.affectedTree.subtree(new qe(t));return new Ko(Ye(),r,this.revert)}}else return q(Pe(this.path)===t,"operationForChild called for unrelated child."),new Ko(Ze(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(t,r){this.source=t,this.path=r,this.type=pn.LISTEN_COMPLETE}operationForChild(t){return Ae(this.path)?new xi(this.source,Ye()):new xi(this.source,Ze(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(t,r,o){this.source=t,this.path=r,this.snap=o,this.type=pn.OVERWRITE}operationForChild(t){return Ae(this.path)?new jr(this.source,Ye(),this.snap.getImmediateChild(t)):new jr(this.source,Ze(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(t,r,o){this.source=t,this.path=r,this.children=o,this.type=pn.MERGE}operationForChild(t){if(Ae(this.path)){const r=this.children.subtree(new qe(t));return r.isEmpty()?null:r.value?new jr(this.source,Ye(),r.value):new vi(this.source,Ye(),r)}else return q(Pe(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new vi(this.source,Ze(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(t,r,o){this.node_=t,this.fullyInitialized_=r,this.filtered_=o}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(Ae(t))return this.isFullyInitialized()&&!this.filtered_;const r=Pe(t);return this.isCompleteForChild(r)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function k1(s,t,r,o){const c=[],d=[];return t.forEach(f=>{f.type==="child_changed"&&s.index_.indexedValueChanged(f.oldSnap,f.snapshotNode)&&d.push(p1(f.childName,f.snapshotNode))}),ni(s,c,"child_removed",t,o,r),ni(s,c,"child_added",t,o,r),ni(s,c,"child_moved",d,o,r),ni(s,c,"child_changed",t,o,r),ni(s,c,"value",t,o,r),c}function ni(s,t,r,o,c,d){const f=o.filter(p=>p.type===r);f.sort((p,g)=>S1(s,p,g)),f.forEach(p=>{const g=C1(s,p,d);c.forEach(x=>{x.respondsTo(p.type)&&t.push(x.createEvent(g,s.query_))})})}function C1(s,t,r){return t.type==="value"||t.type==="child_removed"||(t.prevName=r.getPredecessorChildName(t.childName,t.snapshotNode,s.index_)),t}function S1(s,t,r){if(t.childName==null||r.childName==null)throw ds("Should only compare child_ events.");const o=new Le(t.childName,t.snapshotNode),c=new Le(r.childName,r.snapshotNode);return s.index_.compare(o,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function al(s,t){return{eventCache:s,serverCache:t}}function li(s,t,r,o){return al(new Er(t,r,o),s.serverCache)}function ym(s,t,r,o){return al(s.eventCache,new Er(t,r,o))}function Rc(s){return s.eventCache.isFullyInitialized()?s.eventCache.getNode():null}function Ir(s){return s.serverCache.isFullyInitialized()?s.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xc;const j1=()=>(xc||(xc=new Wt(hy)),xc);class nt{static fromObject(t){let r=new nt(null);return Ht(t,(o,c)=>{r=r.set(new qe(o),c)}),r}constructor(t,r=j1()){this.value=t,this.children=r}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,r){if(this.value!=null&&r(this.value))return{path:Ye(),value:this.value};if(Ae(t))return null;{const o=Pe(t),c=this.children.get(o);if(c!==null){const d=c.findRootMostMatchingPathAndValue(Ze(t),r);return d!=null?{path:gt(new qe(o),d.path),value:d.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(Ae(t))return this;{const r=Pe(t),o=this.children.get(r);return o!==null?o.subtree(Ze(t)):new nt(null)}}set(t,r){if(Ae(t))return new nt(r,this.children);{const o=Pe(t),d=(this.children.get(o)||new nt(null)).set(Ze(t),r),f=this.children.insert(o,d);return new nt(this.value,f)}}remove(t){if(Ae(t))return this.children.isEmpty()?new nt(null):new nt(null,this.children);{const r=Pe(t),o=this.children.get(r);if(o){const c=o.remove(Ze(t));let d;return c.isEmpty()?d=this.children.remove(r):d=this.children.insert(r,c),this.value===null&&d.isEmpty()?new nt(null):new nt(this.value,d)}else return this}}get(t){if(Ae(t))return this.value;{const r=Pe(t),o=this.children.get(r);return o?o.get(Ze(t)):null}}setTree(t,r){if(Ae(t))return r;{const o=Pe(t),d=(this.children.get(o)||new nt(null)).setTree(Ze(t),r);let f;return d.isEmpty()?f=this.children.remove(o):f=this.children.insert(o,d),new nt(this.value,f)}}fold(t){return this.fold_(Ye(),t)}fold_(t,r){const o={};return this.children.inorderTraversal((c,d)=>{o[c]=d.fold_(gt(t,c),r)}),r(t,this.value,o)}findOnPath(t,r){return this.findOnPath_(t,Ye(),r)}findOnPath_(t,r,o){const c=this.value?o(r,this.value):!1;if(c)return c;if(Ae(t))return null;{const d=Pe(t),f=this.children.get(d);return f?f.findOnPath_(Ze(t),gt(r,d),o):null}}foreachOnPath(t,r){return this.foreachOnPath_(t,Ye(),r)}foreachOnPath_(t,r,o){if(Ae(t))return this;{this.value&&o(r,this.value);const c=Pe(t),d=this.children.get(c);return d?d.foreachOnPath_(Ze(t),gt(r,c),o):new nt(null)}}foreach(t){this.foreach_(Ye(),t)}foreach_(t,r){this.children.inorderTraversal((o,c)=>{c.foreach_(gt(t,o),r)}),this.value&&r(t,this.value)}foreachChild(t){this.children.inorderTraversal((r,o)=>{o.value&&t(r,o.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(t){this.writeTree_=t}static empty(){return new mn(new nt(null))}}function ai(s,t,r){if(Ae(t))return new mn(new nt(r));{const o=s.writeTree_.findRootMostValueAndPath(t);if(o!=null){const c=o.path;let d=o.value;const f=Ut(c,t);return d=d.updateChild(f,r),new mn(s.writeTree_.set(c,d))}else{const c=new nt(r),d=s.writeTree_.setTree(t,c);return new mn(d)}}}function tp(s,t,r){let o=s;return Ht(r,(c,d)=>{o=ai(o,gt(t,c),d)}),o}function np(s,t){if(Ae(t))return mn.empty();{const r=s.writeTree_.setTree(t,new nt(null));return new mn(r)}}function Pc(s,t){return Tr(s,t)!=null}function Tr(s,t){const r=s.writeTree_.findRootMostValueAndPath(t);return r!=null?s.writeTree_.get(r.path).getChild(Ut(r.path,t)):null}function rp(s){const t=[],r=s.writeTree_.value;return r!=null?r.isLeafNode()||r.forEachChild(ct,(o,c)=>{t.push(new Le(o,c))}):s.writeTree_.children.inorderTraversal((o,c)=>{c.value!=null&&t.push(new Le(o,c.value))}),t}function nr(s,t){if(Ae(t))return s;{const r=Tr(s,t);return r!=null?new mn(new nt(r)):new mn(s.writeTree_.subtree(t))}}function Lc(s){return s.writeTree_.isEmpty()}function us(s,t){return _m(Ye(),s.writeTree_,t)}function _m(s,t,r){if(t.value!=null)return r.updateChild(s,t.value);{let o=null;return t.children.inorderTraversal((c,d)=>{c===".priority"?(q(d.value!==null,"Priority writes must always be leaf nodes"),o=d.value):r=_m(gt(s,c),d,r)}),!r.getChild(s).isEmpty()&&o!==null&&(r=r.updateChild(gt(s,".priority"),o)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nu(s,t){return km(t,s)}function E1(s,t,r,o,c){q(o>s.lastWriteId,"Stacking an older write on top of newer ones"),c===void 0&&(c=!0),s.allWrites.push({path:t,snap:r,writeId:o,visible:c}),c&&(s.visibleWrites=ai(s.visibleWrites,t,r)),s.lastWriteId=o}function I1(s,t){for(let r=0;r<s.allWrites.length;r++){const o=s.allWrites[r];if(o.writeId===t)return o}return null}function T1(s,t){const r=s.allWrites.findIndex(p=>p.writeId===t);q(r>=0,"removeWrite called with nonexistent writeId.");const o=s.allWrites[r];s.allWrites.splice(r,1);let c=o.visible,d=!1,f=s.allWrites.length-1;for(;c&&f>=0;){const p=s.allWrites[f];p.visible&&(f>=r&&R1(p,o.path)?c=!1:fn(o.path,p.path)&&(d=!0)),f--}if(c){if(d)return P1(s),!0;if(o.snap)s.visibleWrites=np(s.visibleWrites,o.path);else{const p=o.children;Ht(p,g=>{s.visibleWrites=np(s.visibleWrites,gt(o.path,g))})}return!0}else return!1}function R1(s,t){if(s.snap)return fn(s.path,t);for(const r in s.children)if(s.children.hasOwnProperty(r)&&fn(gt(s.path,r),t))return!0;return!1}function P1(s){s.visibleWrites=wm(s.allWrites,L1,Ye()),s.allWrites.length>0?s.lastWriteId=s.allWrites[s.allWrites.length-1].writeId:s.lastWriteId=-1}function L1(s){return s.visible}function wm(s,t,r){let o=mn.empty();for(let c=0;c<s.length;++c){const d=s[c];if(t(d)){const f=d.path;let p;if(d.snap)fn(r,f)?(p=Ut(r,f),o=ai(o,p,d.snap)):fn(f,r)&&(p=Ut(f,r),o=ai(o,Ye(),d.snap.getChild(p)));else if(d.children){if(fn(r,f))p=Ut(r,f),o=tp(o,p,d.children);else if(fn(f,r))if(p=Ut(f,r),Ae(p))o=tp(o,Ye(),d.children);else{const g=ls(d.children,Pe(p));if(g){const x=g.getChild(Ze(p));o=ai(o,Ye(),x)}}}else throw ds("WriteRecord should have .snap or .children")}}return o}function bm(s,t,r,o,c){if(!o&&!c){const d=Tr(s.visibleWrites,t);if(d!=null)return d;{const f=nr(s.visibleWrites,t);if(Lc(f))return r;if(r==null&&!Pc(f,Ye()))return null;{const p=r||Ce.EMPTY_NODE;return us(f,p)}}}else{const d=nr(s.visibleWrites,t);if(!c&&Lc(d))return r;if(!c&&r==null&&!Pc(d,Ye()))return null;{const f=function(x){return(x.visible||c)&&(!o||!~o.indexOf(x.writeId))&&(fn(x.path,t)||fn(t,x.path))},p=wm(s.allWrites,f,t),g=r||Ce.EMPTY_NODE;return us(p,g)}}}function M1(s,t,r){let o=Ce.EMPTY_NODE;const c=Tr(s.visibleWrites,t);if(c)return c.isLeafNode()||c.forEachChild(ct,(d,f)=>{o=o.updateImmediateChild(d,f)}),o;if(r){const d=nr(s.visibleWrites,t);return r.forEachChild(ct,(f,p)=>{const g=us(nr(d,new qe(f)),p);o=o.updateImmediateChild(f,g)}),rp(d).forEach(f=>{o=o.updateImmediateChild(f.name,f.node)}),o}else{const d=nr(s.visibleWrites,t);return rp(d).forEach(f=>{o=o.updateImmediateChild(f.name,f.node)}),o}}function D1(s,t,r,o,c){q(o||c,"Either existingEventSnap or existingServerSnap must exist");const d=gt(t,r);if(Pc(s.visibleWrites,d))return null;{const f=nr(s.visibleWrites,d);return Lc(f)?c.getChild(r):us(f,c.getChild(r))}}function O1(s,t,r,o){const c=gt(t,r),d=Tr(s.visibleWrites,c);if(d!=null)return d;if(o.isCompleteForChild(r)){const f=nr(s.visibleWrites,c);return us(f,o.getNode().getImmediateChild(r))}else return null}function A1(s,t){return Tr(s.visibleWrites,t)}function F1(s,t,r,o,c,d,f){let p;const g=nr(s.visibleWrites,t),x=Tr(g,Ye());if(x!=null)p=x;else if(r!=null)p=us(g,r);else return[];if(p=p.withIndex(f),!p.isEmpty()&&!p.isLeafNode()){const k=[],y=f.getCompare(),v=d?p.getReverseIteratorFrom(o,f):p.getIteratorFrom(o,f);let C=v.getNext();for(;C&&k.length<c;)y(C,o)!==0&&k.push(C),C=v.getNext();return k}else return[]}function $1(){return{visibleWrites:mn.empty(),allWrites:[],lastWriteId:-1}}function Jo(s,t,r,o){return bm(s.writeTree,s.treePath,t,r,o)}function ru(s,t){return M1(s.writeTree,s.treePath,t)}function sp(s,t,r,o){return D1(s.writeTree,s.treePath,t,r,o)}function Zo(s,t){return A1(s.writeTree,gt(s.treePath,t))}function z1(s,t,r,o,c,d){return F1(s.writeTree,s.treePath,t,r,o,c,d)}function su(s,t,r){return O1(s.writeTree,s.treePath,t,r)}function Nm(s,t){return km(gt(s.treePath,t),s.writeTree)}function km(s,t){return{treePath:s,writeTree:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(){this.changeMap=new Map}trackChildChange(t){const r=t.type,o=t.childName;q(r==="child_added"||r==="child_changed"||r==="child_removed","Only child changes supported for tracking"),q(o!==".priority","Only non-priority child changes can be tracked.");const c=this.changeMap.get(o);if(c){const d=c.type;if(r==="child_added"&&d==="child_removed")this.changeMap.set(o,mi(o,t.snapshotNode,c.snapshotNode));else if(r==="child_removed"&&d==="child_added")this.changeMap.delete(o);else if(r==="child_removed"&&d==="child_changed")this.changeMap.set(o,pi(o,c.oldSnap));else if(r==="child_changed"&&d==="child_added")this.changeMap.set(o,cs(o,t.snapshotNode));else if(r==="child_changed"&&d==="child_changed")this.changeMap.set(o,mi(o,t.snapshotNode,c.oldSnap));else throw ds("Illegal combination of changes: "+t+" occurred after "+c)}else this.changeMap.set(o,t)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{getCompleteChild(t){return null}getChildAfterChild(t,r,o){return null}}const Cm=new W1;class iu{constructor(t,r,o=null){this.writes_=t,this.viewCache_=r,this.optCompleteServerCache_=o}getCompleteChild(t){const r=this.viewCache_.eventCache;if(r.isCompleteForChild(t))return r.getNode().getImmediateChild(t);{const o=this.optCompleteServerCache_!=null?new Er(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return su(this.writes_,t,o)}}getChildAfterChild(t,r,o){const c=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ir(this.viewCache_),d=z1(this.writes_,c,r,1,o,t);return d.length===0?null:d[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B1(s){return{filter:s}}function H1(s,t){q(t.eventCache.getNode().isIndexed(s.filter.getIndex()),"Event snap not indexed"),q(t.serverCache.getNode().isIndexed(s.filter.getIndex()),"Server snap not indexed")}function V1(s,t,r,o,c){const d=new U1;let f,p;if(r.type===pn.OVERWRITE){const x=r;x.source.fromUser?f=Mc(s,t,x.path,x.snap,o,c,d):(q(x.source.fromServer,"Unknown source."),p=x.source.tagged||t.serverCache.isFiltered()&&!Ae(x.path),f=el(s,t,x.path,x.snap,o,c,p,d))}else if(r.type===pn.MERGE){const x=r;x.source.fromUser?f=Q1(s,t,x.path,x.children,o,c,d):(q(x.source.fromServer,"Unknown source."),p=x.source.tagged||t.serverCache.isFiltered(),f=Dc(s,t,x.path,x.children,o,c,p,d))}else if(r.type===pn.ACK_USER_WRITE){const x=r;x.revert?f=q1(s,t,x.path,o,c,d):f=G1(s,t,x.path,x.affectedTree,o,c,d)}else if(r.type===pn.LISTEN_COMPLETE)f=X1(s,t,r.path,o,d);else throw ds("Unknown operation type: "+r.type);const g=d.getChanges();return Y1(t,f,g),{viewCache:f,changes:g}}function Y1(s,t,r){const o=t.eventCache;if(o.isFullyInitialized()){const c=o.getNode().isLeafNode()||o.getNode().isEmpty(),d=Rc(s);(r.length>0||!s.eventCache.isFullyInitialized()||c&&!o.getNode().equals(d)||!o.getNode().getPriority().equals(d.getPriority()))&&r.push(gm(Rc(t)))}}function Sm(s,t,r,o,c,d){const f=t.eventCache;if(Zo(o,r)!=null)return t;{let p,g;if(Ae(r))if(q(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const x=Ir(t),k=x instanceof Ce?x:Ce.EMPTY_NODE,y=ru(o,k);p=s.filter.updateFullNode(t.eventCache.getNode(),y,d)}else{const x=Jo(o,Ir(t));p=s.filter.updateFullNode(t.eventCache.getNode(),x,d)}else{const x=Pe(r);if(x===".priority"){q(rr(r)===1,"Can't have a priority with additional path components");const k=f.getNode();g=t.serverCache.getNode();const y=sp(o,r,k,g);y!=null?p=s.filter.updatePriority(k,y):p=f.getNode()}else{const k=Ze(r);let y;if(f.isCompleteForChild(x)){g=t.serverCache.getNode();const v=sp(o,r,f.getNode(),g);v!=null?y=f.getNode().getImmediateChild(x).updateChild(k,v):y=f.getNode().getImmediateChild(x)}else y=su(o,x,t.serverCache);y!=null?p=s.filter.updateChild(f.getNode(),x,y,k,c,d):p=f.getNode()}}return li(t,p,f.isFullyInitialized()||Ae(r),s.filter.filtersNodes())}}function el(s,t,r,o,c,d,f,p){const g=t.serverCache;let x;const k=f?s.filter:s.filter.getIndexedFilter();if(Ae(r))x=k.updateFullNode(g.getNode(),o,null);else if(k.filtersNodes()&&!g.isFiltered()){const C=g.getNode().updateChild(r,o);x=k.updateFullNode(g.getNode(),C,null)}else{const C=Pe(r);if(!g.isCompleteForPath(r)&&rr(r)>1)return t;const M=Ze(r),ne=g.getNode().getImmediateChild(C).updateChild(M,o);C===".priority"?x=k.updatePriority(g.getNode(),ne):x=k.updateChild(g.getNode(),C,ne,M,Cm,null)}const y=ym(t,x,g.isFullyInitialized()||Ae(r),k.filtersNodes()),v=new iu(c,y,d);return Sm(s,y,r,c,v,p)}function Mc(s,t,r,o,c,d,f){const p=t.eventCache;let g,x;const k=new iu(c,t,d);if(Ae(r))x=s.filter.updateFullNode(t.eventCache.getNode(),o,f),g=li(t,x,!0,s.filter.filtersNodes());else{const y=Pe(r);if(y===".priority")x=s.filter.updatePriority(t.eventCache.getNode(),o),g=li(t,x,p.isFullyInitialized(),p.isFiltered());else{const v=Ze(r),C=p.getNode().getImmediateChild(y);let M;if(Ae(v))M=o;else{const B=k.getCompleteChild(y);B!=null?lm(v)===".priority"&&B.getChild(cm(v)).isEmpty()?M=B:M=B.updateChild(v,o):M=Ce.EMPTY_NODE}if(C.equals(M))g=t;else{const B=s.filter.updateChild(p.getNode(),y,M,v,k,f);g=li(t,B,p.isFullyInitialized(),s.filter.filtersNodes())}}}return g}function ip(s,t){return s.eventCache.isCompleteForChild(t)}function Q1(s,t,r,o,c,d,f){let p=t;return o.foreach((g,x)=>{const k=gt(r,g);ip(t,Pe(k))&&(p=Mc(s,p,k,x,c,d,f))}),o.foreach((g,x)=>{const k=gt(r,g);ip(t,Pe(k))||(p=Mc(s,p,k,x,c,d,f))}),p}function op(s,t,r){return r.foreach((o,c)=>{t=t.updateChild(o,c)}),t}function Dc(s,t,r,o,c,d,f,p){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let g=t,x;Ae(r)?x=o:x=new nt(null).setTree(r,o);const k=t.serverCache.getNode();return x.children.inorderTraversal((y,v)=>{if(k.hasChild(y)){const C=t.serverCache.getNode().getImmediateChild(y),M=op(s,C,v);g=el(s,g,new qe(y),M,c,d,f,p)}}),x.children.inorderTraversal((y,v)=>{const C=!t.serverCache.isCompleteForChild(y)&&v.value===null;if(!k.hasChild(y)&&!C){const M=t.serverCache.getNode().getImmediateChild(y),B=op(s,M,v);g=el(s,g,new qe(y),B,c,d,f,p)}}),g}function G1(s,t,r,o,c,d,f){if(Zo(c,r)!=null)return t;const p=t.serverCache.isFiltered(),g=t.serverCache;if(o.value!=null){if(Ae(r)&&g.isFullyInitialized()||g.isCompleteForPath(r))return el(s,t,r,g.getNode().getChild(r),c,d,p,f);if(Ae(r)){let x=new nt(null);return g.getNode().forEachChild(is,(k,y)=>{x=x.set(new qe(k),y)}),Dc(s,t,r,x,c,d,p,f)}else return t}else{let x=new nt(null);return o.foreach((k,y)=>{const v=gt(r,k);g.isCompleteForPath(v)&&(x=x.set(k,g.getNode().getChild(v)))}),Dc(s,t,r,x,c,d,p,f)}}function X1(s,t,r,o,c){const d=t.serverCache,f=ym(t,d.getNode(),d.isFullyInitialized()||Ae(r),d.isFiltered());return Sm(s,f,r,o,Cm,c)}function q1(s,t,r,o,c,d){let f;if(Zo(o,r)!=null)return t;{const p=new iu(o,t,c),g=t.eventCache.getNode();let x;if(Ae(r)||Pe(r)===".priority"){let k;if(t.serverCache.isFullyInitialized())k=Jo(o,Ir(t));else{const y=t.serverCache.getNode();q(y instanceof Ce,"serverChildren would be complete if leaf node"),k=ru(o,y)}k=k,x=s.filter.updateFullNode(g,k,d)}else{const k=Pe(r);let y=su(o,k,t.serverCache);y==null&&t.serverCache.isCompleteForChild(k)&&(y=g.getImmediateChild(k)),y!=null?x=s.filter.updateChild(g,k,y,Ze(r),p,d):t.eventCache.getNode().hasChild(k)?x=s.filter.updateChild(g,k,Ce.EMPTY_NODE,Ze(r),p,d):x=g,x.isEmpty()&&t.serverCache.isFullyInitialized()&&(f=Jo(o,Ir(t)),f.isLeafNode()&&(x=s.filter.updateFullNode(x,f,d)))}return f=t.serverCache.isFullyInitialized()||Zo(o,Ye())!=null,li(t,x,f,s.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(t,r){this.query_=t,this.eventRegistrations_=[];const o=this.query_._queryParams,c=new Jc(o.getIndex()),d=g1(o);this.processor_=B1(d);const f=r.serverCache,p=r.eventCache,g=c.updateFullNode(Ce.EMPTY_NODE,f.getNode(),null),x=d.updateFullNode(Ce.EMPTY_NODE,p.getNode(),null),k=new Er(g,f.isFullyInitialized(),c.filtersNodes()),y=new Er(x,p.isFullyInitialized(),d.filtersNodes());this.viewCache_=al(y,k),this.eventGenerator_=new N1(this.query_)}get query(){return this.query_}}function J1(s){return s.viewCache_.serverCache.getNode()}function Z1(s,t){const r=Ir(s.viewCache_);return r&&(s.query._queryParams.loadsAllData()||!Ae(t)&&!r.getImmediateChild(Pe(t)).isEmpty())?r.getChild(t):null}function lp(s){return s.eventRegistrations_.length===0}function e_(s,t){s.eventRegistrations_.push(t)}function ap(s,t,r){const o=[];if(r){q(t==null,"A cancel should cancel all event registrations.");const c=s.query._path;s.eventRegistrations_.forEach(d=>{const f=d.createCancelEvent(r,c);f&&o.push(f)})}if(t){let c=[];for(let d=0;d<s.eventRegistrations_.length;++d){const f=s.eventRegistrations_[d];if(!f.matches(t))c.push(f);else if(t.hasAnyCallback()){c=c.concat(s.eventRegistrations_.slice(d+1));break}}s.eventRegistrations_=c}else s.eventRegistrations_=[];return o}function cp(s,t,r,o){t.type===pn.MERGE&&t.source.queryId!==null&&(q(Ir(s.viewCache_),"We should always have a full cache before handling merges"),q(Rc(s.viewCache_),"Missing event cache, even though we have a server cache"));const c=s.viewCache_,d=V1(s.processor_,c,t,r,o);return H1(s.processor_,d.viewCache),q(d.viewCache.serverCache.isFullyInitialized()||!c.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),s.viewCache_=d.viewCache,jm(s,d.changes,d.viewCache.eventCache.getNode(),null)}function t_(s,t){const r=s.viewCache_.eventCache,o=[];return r.getNode().isLeafNode()||r.getNode().forEachChild(ct,(d,f)=>{o.push(cs(d,f))}),r.isFullyInitialized()&&o.push(gm(r.getNode())),jm(s,o,r.getNode(),t)}function jm(s,t,r,o){const c=o?[o]:s.eventRegistrations_;return k1(s.eventGenerator_,t,r,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tl;class n_{constructor(){this.views=new Map}}function r_(s){q(!tl,"__referenceConstructor has already been defined"),tl=s}function s_(){return q(tl,"Reference.ts has not been loaded"),tl}function i_(s){return s.views.size===0}function ou(s,t,r,o){const c=t.source.queryId;if(c!==null){const d=s.views.get(c);return q(d!=null,"SyncTree gave us an op for an invalid query."),cp(d,t,r,o)}else{let d=[];for(const f of s.views.values())d=d.concat(cp(f,t,r,o));return d}}function o_(s,t,r,o,c){const d=t._queryIdentifier,f=s.views.get(d);if(!f){let p=Jo(r,c?o:null),g=!1;p?g=!0:o instanceof Ce?(p=ru(r,o),g=!1):(p=Ce.EMPTY_NODE,g=!1);const x=al(new Er(p,g,!1),new Er(o,c,!1));return new K1(t,x)}return f}function l_(s,t,r,o,c,d){const f=o_(s,t,o,c,d);return s.views.has(t._queryIdentifier)||s.views.set(t._queryIdentifier,f),e_(f,r),t_(f,r)}function a_(s,t,r,o){const c=t._queryIdentifier,d=[];let f=[];const p=sr(s);if(c==="default")for(const[g,x]of s.views.entries())f=f.concat(ap(x,r,o)),lp(x)&&(s.views.delete(g),x.query._queryParams.loadsAllData()||d.push(x.query));else{const g=s.views.get(c);g&&(f=f.concat(ap(g,r,o)),lp(g)&&(s.views.delete(c),g.query._queryParams.loadsAllData()||d.push(g.query)))}return p&&!sr(s)&&d.push(new(s_())(t._repo,t._path)),{removed:d,events:f}}function Em(s){const t=[];for(const r of s.views.values())r.query._queryParams.loadsAllData()||t.push(r);return t}function os(s,t){let r=null;for(const o of s.views.values())r=r||Z1(o,t);return r}function Im(s,t){if(t._queryParams.loadsAllData())return cl(s);{const o=t._queryIdentifier;return s.views.get(o)}}function Tm(s,t){return Im(s,t)!=null}function sr(s){return cl(s)!=null}function cl(s){for(const t of s.views.values())if(t.query._queryParams.loadsAllData())return t;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nl;function c_(s){q(!nl,"__referenceConstructor has already been defined"),nl=s}function u_(){return q(nl,"Reference.ts has not been loaded"),nl}let d_=1;class up{constructor(t){this.listenProvider_=t,this.syncPointTree_=new nt(null),this.pendingWriteTree_=$1(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Rm(s,t,r,o,c){return E1(s.pendingWriteTree_,t,r,o,c),c?ki(s,new jr(vm(),t,r)):[]}function Cr(s,t,r=!1){const o=I1(s.pendingWriteTree_,t);if(T1(s.pendingWriteTree_,t)){let d=new nt(null);return o.snap!=null?d=d.set(Ye(),!0):Ht(o.children,f=>{d=d.set(new qe(f),!0)}),ki(s,new Ko(o.path,d,r))}else return[]}function ul(s,t,r){return ki(s,new jr(eu(),t,r))}function h_(s,t,r){const o=nt.fromObject(r);return ki(s,new vi(eu(),t,o))}function f_(s,t){return ki(s,new xi(eu(),t))}function p_(s,t,r){const o=au(s,r);if(o){const c=cu(o),d=c.path,f=c.queryId,p=Ut(d,t),g=new xi(tu(f),p);return uu(s,d,g)}else return[]}function Oc(s,t,r,o,c=!1){const d=t._path,f=s.syncPointTree_.get(d);let p=[];if(f&&(t._queryIdentifier==="default"||Tm(f,t))){const g=a_(f,t,r,o);i_(f)&&(s.syncPointTree_=s.syncPointTree_.remove(d));const x=g.removed;if(p=g.events,!c){const k=x.findIndex(v=>v._queryParams.loadsAllData())!==-1,y=s.syncPointTree_.findOnPath(d,(v,C)=>sr(C));if(k&&!y){const v=s.syncPointTree_.subtree(d);if(!v.isEmpty()){const C=x_(v);for(let M=0;M<C.length;++M){const B=C[M],ne=B.query,ue=Mm(s,B);s.listenProvider_.startListening(ci(ne),rl(s,ne),ue.hashFn,ue.onComplete)}}}!y&&x.length>0&&!o&&(k?s.listenProvider_.stopListening(ci(t),null):x.forEach(v=>{const C=s.queryToTagMap.get(dl(v));s.listenProvider_.stopListening(ci(v),C)}))}v_(s,x)}return p}function m_(s,t,r,o){const c=au(s,o);if(c!=null){const d=cu(c),f=d.path,p=d.queryId,g=Ut(f,t),x=new jr(tu(p),g,r);return uu(s,f,x)}else return[]}function g_(s,t,r,o){const c=au(s,o);if(c){const d=cu(c),f=d.path,p=d.queryId,g=Ut(f,t),x=nt.fromObject(r),k=new vi(tu(p),g,x);return uu(s,f,k)}else return[]}function dp(s,t,r,o=!1){const c=t._path;let d=null,f=!1;s.syncPointTree_.foreachOnPath(c,(v,C)=>{const M=Ut(v,c);d=d||os(C,M),f=f||sr(C)});let p=s.syncPointTree_.get(c);p?(f=f||sr(p),d=d||os(p,Ye())):(p=new n_,s.syncPointTree_=s.syncPointTree_.set(c,p));let g;d!=null?g=!0:(g=!1,d=Ce.EMPTY_NODE,s.syncPointTree_.subtree(c).foreachChild((C,M)=>{const B=os(M,Ye());B&&(d=d.updateImmediateChild(C,B))}));const x=Tm(p,t);if(!x&&!t._queryParams.loadsAllData()){const v=dl(t);q(!s.queryToTagMap.has(v),"View does not exist, but we have a tag");const C=y_();s.queryToTagMap.set(v,C),s.tagToQueryMap.set(C,v)}const k=nu(s.pendingWriteTree_,c);let y=l_(p,t,r,k,d,g);if(!x&&!f&&!o){const v=Im(p,t);y=y.concat(__(s,t,v))}return y}function lu(s,t,r){const c=s.pendingWriteTree_,d=s.syncPointTree_.findOnPath(t,(f,p)=>{const g=Ut(f,t),x=os(p,g);if(x)return x});return bm(c,t,d,r,!0)}function ki(s,t){return Pm(t,s.syncPointTree_,null,nu(s.pendingWriteTree_,Ye()))}function Pm(s,t,r,o){if(Ae(s.path))return Lm(s,t,r,o);{const c=t.get(Ye());r==null&&c!=null&&(r=os(c,Ye()));let d=[];const f=Pe(s.path),p=s.operationForChild(f),g=t.children.get(f);if(g&&p){const x=r?r.getImmediateChild(f):null,k=Nm(o,f);d=d.concat(Pm(p,g,x,k))}return c&&(d=d.concat(ou(c,s,o,r))),d}}function Lm(s,t,r,o){const c=t.get(Ye());r==null&&c!=null&&(r=os(c,Ye()));let d=[];return t.children.inorderTraversal((f,p)=>{const g=r?r.getImmediateChild(f):null,x=Nm(o,f),k=s.operationForChild(f);k&&(d=d.concat(Lm(k,p,g,x)))}),c&&(d=d.concat(ou(c,s,o,r))),d}function Mm(s,t){const r=t.query,o=rl(s,r);return{hashFn:()=>(J1(t)||Ce.EMPTY_NODE).hash(),onComplete:c=>{if(c==="ok")return o?p_(s,r._path,o):f_(s,r._path);{const d=my(c,r);return Oc(s,r,null,d)}}}}function rl(s,t){const r=dl(t);return s.queryToTagMap.get(r)}function dl(s){return s._path.toString()+"$"+s._queryIdentifier}function au(s,t){return s.tagToQueryMap.get(t)}function cu(s){const t=s.indexOf("$");return q(t!==-1&&t<s.length-1,"Bad queryKey."),{queryId:s.substr(t+1),path:new qe(s.substr(0,t))}}function uu(s,t,r){const o=s.syncPointTree_.get(t);q(o,"Missing sync point for query tag that we're tracking");const c=nu(s.pendingWriteTree_,t);return ou(o,r,c,null)}function x_(s){return s.fold((t,r,o)=>{if(r&&sr(r))return[cl(r)];{let c=[];return r&&(c=Em(r)),Ht(o,(d,f)=>{c=c.concat(f)}),c}})}function ci(s){return s._queryParams.loadsAllData()&&!s._queryParams.isDefault()?new(u_())(s._repo,s._path):s}function v_(s,t){for(let r=0;r<t.length;++r){const o=t[r];if(!o._queryParams.loadsAllData()){const c=dl(o),d=s.queryToTagMap.get(c);s.queryToTagMap.delete(c),s.tagToQueryMap.delete(d)}}}function y_(){return d_++}function __(s,t,r){const o=t._path,c=rl(s,t),d=Mm(s,r),f=s.listenProvider_.startListening(ci(t),c,d.hashFn,d.onComplete),p=s.syncPointTree_.subtree(o);if(c)q(!sr(p.value),"If we're adding a query, it shouldn't be shadowed");else{const g=p.fold((x,k,y)=>{if(!Ae(x)&&k&&sr(k))return[cl(k).query];{let v=[];return k&&(v=v.concat(Em(k).map(C=>C.query))),Ht(y,(C,M)=>{v=v.concat(M)}),v}});for(let x=0;x<g.length;++x){const k=g[x];s.listenProvider_.stopListening(ci(k),rl(s,k))}}return f}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(t){this.node_=t}getImmediateChild(t){const r=this.node_.getImmediateChild(t);return new du(r)}node(){return this.node_}}class hu{constructor(t,r){this.syncTree_=t,this.path_=r}getImmediateChild(t){const r=gt(this.path_,t);return new hu(this.syncTree_,r)}node(){return lu(this.syncTree_,this.path_)}}const w_=function(s){return s=s||{},s.timestamp=s.timestamp||new Date().getTime(),s},hp=function(s,t,r){if(!s||typeof s!="object")return s;if(q(".sv"in s,"Unexpected leaf node or priority contents"),typeof s[".sv"]=="string")return b_(s[".sv"],t,r);if(typeof s[".sv"]=="object")return N_(s[".sv"],t);q(!1,"Unexpected server value: "+JSON.stringify(s,null,2))},b_=function(s,t,r){switch(s){case"timestamp":return r.timestamp;default:q(!1,"Unexpected server value: "+s)}},N_=function(s,t,r){s.hasOwnProperty("increment")||q(!1,"Unexpected server value: "+JSON.stringify(s,null,2));const o=s.increment;typeof o!="number"&&q(!1,"Unexpected increment value: "+o);const c=t.node();if(q(c!==null&&typeof c<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!c.isLeafNode())return o;const f=c.getValue();return typeof f!="number"?o:f+o},k_=function(s,t,r,o){return fu(t,new hu(r,s),o)},Dm=function(s,t,r){return fu(s,new du(t),r)};function fu(s,t,r){const o=s.getPriority().val(),c=hp(o,t.getImmediateChild(".priority"),r);let d;if(s.isLeafNode()){const f=s,p=hp(f.getValue(),t,r);return p!==f.getValue()||c!==f.getPriority().val()?new _t(p,St(c)):s}else{const f=s;return d=f,c!==f.getPriority().val()&&(d=d.updatePriority(new _t(c))),f.forEachChild(ct,(p,g)=>{const x=fu(g,t.getImmediateChild(p),r);x!==g&&(d=d.updateImmediateChild(p,x))}),d}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(t="",r=null,o={children:{},childCount:0}){this.name=t,this.parent=r,this.node=o}}function mu(s,t){let r=t instanceof qe?t:new qe(t),o=s,c=Pe(r);for(;c!==null;){const d=ls(o.node.children,c)||{children:{},childCount:0};o=new pu(c,o,d),r=Ze(r),c=Pe(r)}return o}function ps(s){return s.node.value}function Om(s,t){s.node.value=t,Ac(s)}function Am(s){return s.node.childCount>0}function C_(s){return ps(s)===void 0&&!Am(s)}function hl(s,t){Ht(s.node.children,(r,o)=>{t(new pu(r,s,o))})}function Fm(s,t,r,o){r&&t(s),hl(s,c=>{Fm(c,t,!0)})}function S_(s,t,r){let o=s.parent;for(;o!==null;){if(t(o))return!0;o=o.parent}return!1}function Ci(s){return new qe(s.parent===null?s.name:Ci(s.parent)+"/"+s.name)}function Ac(s){s.parent!==null&&j_(s.parent,s.name,s)}function j_(s,t,r){const o=C_(r),c=Mn(s.node.children,t);o&&c?(delete s.node.children[t],s.node.childCount--,Ac(s)):!o&&!c&&(s.node.children[t]=r.node,s.node.childCount++,Ac(s))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E_=/[\[\].#$\/\u0000-\u001F\u007F]/,I_=/[\[\].#$\u0000-\u001F\u007F]/,vc=10*1024*1024,$m=function(s){return typeof s=="string"&&s.length!==0&&!E_.test(s)},zm=function(s){return typeof s=="string"&&s.length!==0&&!I_.test(s)},T_=function(s){return s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),zm(s)},R_=function(s,t,r,o){gu(Bc(s,"value"),t,r)},gu=function(s,t,r){const o=r instanceof qe?new Gy(r,s):r;if(t===void 0)throw new Error(s+"contains undefined "+Nr(o));if(typeof t=="function")throw new Error(s+"contains a function "+Nr(o)+" with contents = "+t.toString());if(zp(t))throw new Error(s+"contains "+t.toString()+" "+Nr(o));if(typeof t=="string"&&t.length>vc/3&&ol(t)>vc)throw new Error(s+"contains a string greater than "+vc+" utf8 bytes "+Nr(o)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let c=!1,d=!1;if(Ht(t,(f,p)=>{if(f===".value")c=!0;else if(f!==".priority"&&f!==".sv"&&(d=!0,!$m(f)))throw new Error(s+" contains an invalid key ("+f+") "+Nr(o)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Xy(o,f),gu(s,p,o),qy(o)}),c&&d)throw new Error(s+' contains ".value" child '+Nr(o)+" in addition to actual children.")}},Um=function(s,t,r,o){if(!zm(r))throw new Error(Bc(s,t)+'was an invalid path = "'+r+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},P_=function(s,t,r,o){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),Um(s,t,r)},Wm=function(s,t){if(Pe(t)===".info")throw new Error(s+" failed = Can't modify data under /.info/")},L_=function(s,t){const r=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!$m(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||r.length!==0&&!T_(r))throw new Error(Bc(s,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function xu(s,t){let r=null;for(let o=0;o<t.length;o++){const c=t[o],d=c.getPath();r!==null&&!Xc(d,r.path)&&(s.eventLists_.push(r),r=null),r===null&&(r={events:[],path:d}),r.events.push(c)}r&&s.eventLists_.push(r)}function Bm(s,t,r){xu(s,r),Hm(s,o=>Xc(o,t))}function Ln(s,t,r){xu(s,r),Hm(s,o=>fn(o,t)||fn(t,o))}function Hm(s,t){s.recursionDepth_++;let r=!0;for(let o=0;o<s.eventLists_.length;o++){const c=s.eventLists_[o];if(c){const d=c.path;t(d)?(D_(s.eventLists_[o]),s.eventLists_[o]=null):r=!1}}r&&(s.eventLists_=[]),s.recursionDepth_--}function D_(s){for(let t=0;t<s.events.length;t++){const r=s.events[t];if(r!==null){s.events[t]=null;const o=r.getEventRunner();ii&&Rt("event: "+r.toString()),fs(o)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_="repo_interrupt",A_=25;class F_{constructor(t,r,o,c){this.repoInfo_=t,this.forceRestClient_=r,this.authTokenProvider_=o,this.appCheckProvider_=c,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new M_,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=qo(),this.transactionQueueTree_=new pu,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function $_(s,t,r){if(s.stats_=Qc(s.repoInfo_),s.forceRestClient_||yy())s.server_=new Xo(s.repoInfo_,(o,c,d,f)=>{fp(s,o,c,d,f)},s.authTokenProvider_,s.appCheckProvider_),setTimeout(()=>pp(s,!0),0);else{if(typeof r<"u"&&r!==null){if(typeof r!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{bt(r)}catch(o){throw new Error("Invalid authOverride provided: "+o)}}s.persistentConnection_=new Tn(s.repoInfo_,t,(o,c,d,f)=>{fp(s,o,c,d,f)},o=>{pp(s,o)},o=>{U_(s,o)},s.authTokenProvider_,s.appCheckProvider_,r),s.server_=s.persistentConnection_}s.authTokenProvider_.addTokenChangeListener(o=>{s.server_.refreshAuthToken(o)}),s.appCheckProvider_.addTokenChangeListener(o=>{s.server_.refreshAppCheckToken(o.token)}),s.statsReporter_=ky(s.repoInfo_,()=>new b1(s.stats_,s.server_)),s.infoData_=new x1,s.infoSyncTree_=new up({startListening:(o,c,d,f)=>{let p=[];const g=s.infoData_.getNode(o._path);return g.isEmpty()||(p=ul(s.infoSyncTree_,o._path,g),setTimeout(()=>{f("ok")},0)),p},stopListening:()=>{}}),yu(s,"connected",!1),s.serverSyncTree_=new up({startListening:(o,c,d,f)=>(s.server_.listen(o,d,c,(p,g)=>{const x=f(p,g);Ln(s.eventQueue_,o._path,x)}),[]),stopListening:(o,c)=>{s.server_.unlisten(o,c)}})}function z_(s){const r=s.infoData_.getNode(new qe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+r}function vu(s){return w_({timestamp:z_(s)})}function fp(s,t,r,o,c){s.dataUpdateCount++;const d=new qe(t);r=s.interceptServerDataCallback_?s.interceptServerDataCallback_(t,r):r;let f=[];if(c)if(o){const g=Wo(r,x=>St(x));f=g_(s.serverSyncTree_,d,g,c)}else{const g=St(r);f=m_(s.serverSyncTree_,d,g,c)}else if(o){const g=Wo(r,x=>St(x));f=h_(s.serverSyncTree_,d,g)}else{const g=St(r);f=ul(s.serverSyncTree_,d,g)}let p=d;f.length>0&&(p=fl(s,d)),Ln(s.eventQueue_,p,f)}function pp(s,t){yu(s,"connected",t),t===!1&&B_(s)}function U_(s,t){Ht(t,(r,o)=>{yu(s,r,o)})}function yu(s,t,r){const o=new qe("/.info/"+t),c=St(r);s.infoData_.updateSnapshot(o,c);const d=ul(s.infoSyncTree_,o,c);Ln(s.eventQueue_,o,d)}function Vm(s){return s.nextWriteId_++}function W_(s,t,r,o,c){_u(s,"set",{path:t.toString(),value:r,priority:o});const d=vu(s),f=St(r,o),p=lu(s.serverSyncTree_,t),g=Dm(f,p,d),x=Vm(s),k=Rm(s.serverSyncTree_,t,g,x,!0);xu(s.eventQueue_,k),s.server_.put(t.toString(),f.val(!0),(v,C)=>{const M=v==="ok";M||Bt("set at "+t+" failed: "+v);const B=Cr(s.serverSyncTree_,x,!M);Ln(s.eventQueue_,t,B),Q_(s,c,v,C)});const y=qm(s,t);fl(s,y),Ln(s.eventQueue_,y,[])}function B_(s){_u(s,"onDisconnectEvents");const t=vu(s),r=qo();Tc(s.onDisconnect_,Ye(),(c,d)=>{const f=k_(c,d,s.serverSyncTree_,t);xm(r,c,f)});let o=[];Tc(r,Ye(),(c,d)=>{o=o.concat(ul(s.serverSyncTree_,c,d));const f=qm(s,c);fl(s,f)}),s.onDisconnect_=qo(),Ln(s.eventQueue_,Ye(),o)}function H_(s,t,r){let o;Pe(t._path)===".info"?o=dp(s.infoSyncTree_,t,r):o=dp(s.serverSyncTree_,t,r),Bm(s.eventQueue_,t._path,o)}function V_(s,t,r){let o;Pe(t._path)===".info"?o=Oc(s.infoSyncTree_,t,r):o=Oc(s.serverSyncTree_,t,r),Bm(s.eventQueue_,t._path,o)}function Y_(s){s.persistentConnection_&&s.persistentConnection_.interrupt(O_)}function _u(s,...t){let r="";s.persistentConnection_&&(r=s.persistentConnection_.id+":"),Rt(r,...t)}function Q_(s,t,r,o){t&&fs(()=>{if(r==="ok")t(null);else{const c=(r||"error").toUpperCase();let d=c;o&&(d+=": "+o);const f=new Error(d);f.code=c,t(f)}})}function Ym(s,t,r){return lu(s.serverSyncTree_,t,r)||Ce.EMPTY_NODE}function wu(s,t=s.transactionQueueTree_){if(t||pl(s,t),ps(t)){const r=Gm(s,t);q(r.length>0,"Sending zero length transaction queue"),r.every(c=>c.status===0)&&G_(s,Ci(t),r)}else Am(t)&&hl(t,r=>{wu(s,r)})}function G_(s,t,r){const o=r.map(x=>x.currentWriteId),c=Ym(s,t,o);let d=c;const f=c.hash();for(let x=0;x<r.length;x++){const k=r[x];q(k.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),k.status=1,k.retryCount++;const y=Ut(t,k.path);d=d.updateChild(y,k.currentOutputSnapshotRaw)}const p=d.val(!0),g=t;s.server_.put(g.toString(),p,x=>{_u(s,"transaction put response",{path:g.toString(),status:x});let k=[];if(x==="ok"){const y=[];for(let v=0;v<r.length;v++)r[v].status=2,k=k.concat(Cr(s.serverSyncTree_,r[v].currentWriteId)),r[v].onComplete&&y.push(()=>r[v].onComplete(null,!0,r[v].currentOutputSnapshotResolved)),r[v].unwatcher();pl(s,mu(s.transactionQueueTree_,t)),wu(s,s.transactionQueueTree_),Ln(s.eventQueue_,t,k);for(let v=0;v<y.length;v++)fs(y[v])}else{if(x==="datastale")for(let y=0;y<r.length;y++)r[y].status===3?r[y].status=4:r[y].status=0;else{Bt("transaction at "+g.toString()+" failed: "+x);for(let y=0;y<r.length;y++)r[y].status=4,r[y].abortReason=x}fl(s,t)}},f)}function fl(s,t){const r=Qm(s,t),o=Ci(r),c=Gm(s,r);return X_(s,c,o),o}function X_(s,t,r){if(t.length===0)return;const o=[];let c=[];const f=t.filter(p=>p.status===0).map(p=>p.currentWriteId);for(let p=0;p<t.length;p++){const g=t[p],x=Ut(r,g.path);let k=!1,y;if(q(x!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),g.status===4)k=!0,y=g.abortReason,c=c.concat(Cr(s.serverSyncTree_,g.currentWriteId,!0));else if(g.status===0)if(g.retryCount>=A_)k=!0,y="maxretry",c=c.concat(Cr(s.serverSyncTree_,g.currentWriteId,!0));else{const v=Ym(s,g.path,f);g.currentInputSnapshot=v;const C=t[p].update(v.val());if(C!==void 0){gu("transaction failed: Data returned ",C,g.path);let M=St(C);typeof C=="object"&&C!=null&&Mn(C,".priority")||(M=M.updatePriority(v.getPriority()));const ne=g.currentWriteId,ue=vu(s),se=Dm(M,v,ue);g.currentOutputSnapshotRaw=M,g.currentOutputSnapshotResolved=se,g.currentWriteId=Vm(s),f.splice(f.indexOf(ne),1),c=c.concat(Rm(s.serverSyncTree_,g.path,se,g.currentWriteId,g.applyLocally)),c=c.concat(Cr(s.serverSyncTree_,ne,!0))}else k=!0,y="nodata",c=c.concat(Cr(s.serverSyncTree_,g.currentWriteId,!0))}Ln(s.eventQueue_,r,c),c=[],k&&(t[p].status=2,(function(v){setTimeout(v,Math.floor(0))})(t[p].unwatcher),t[p].onComplete&&(y==="nodata"?o.push(()=>t[p].onComplete(null,!1,t[p].currentInputSnapshot)):o.push(()=>t[p].onComplete(new Error(y),!1,null))))}pl(s,s.transactionQueueTree_);for(let p=0;p<o.length;p++)fs(o[p]);wu(s,s.transactionQueueTree_)}function Qm(s,t){let r,o=s.transactionQueueTree_;for(r=Pe(t);r!==null&&ps(o)===void 0;)o=mu(o,r),t=Ze(t),r=Pe(t);return o}function Gm(s,t){const r=[];return Xm(s,t,r),r.sort((o,c)=>o.order-c.order),r}function Xm(s,t,r){const o=ps(t);if(o)for(let c=0;c<o.length;c++)r.push(o[c]);hl(t,c=>{Xm(s,c,r)})}function pl(s,t){const r=ps(t);if(r){let o=0;for(let c=0;c<r.length;c++)r[c].status!==2&&(r[o]=r[c],o++);r.length=o,Om(t,r.length>0?r:void 0)}hl(t,o=>{pl(s,o)})}function qm(s,t){const r=Ci(Qm(s,t)),o=mu(s.transactionQueueTree_,t);return S_(o,c=>{yc(s,c)}),yc(s,o),Fm(o,c=>{yc(s,c)}),r}function yc(s,t){const r=ps(t);if(r){const o=[];let c=[],d=-1;for(let f=0;f<r.length;f++)r[f].status===3||(r[f].status===1?(q(d===f-1,"All SENT items should be at beginning of queue."),d=f,r[f].status=3,r[f].abortReason="set"):(q(r[f].status===0,"Unexpected transaction status in abort"),r[f].unwatcher(),c=c.concat(Cr(s.serverSyncTree_,r[f].currentWriteId,!0)),r[f].onComplete&&o.push(r[f].onComplete.bind(null,new Error("set"),!1,null))));d===-1?Om(t,void 0):r.length=d+1,Ln(s.eventQueue_,Ci(t),c);for(let f=0;f<o.length;f++)fs(o[f])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q_(s){let t="";const r=s.split("/");for(let o=0;o<r.length;o++)if(r[o].length>0){let c=r[o];try{c=decodeURIComponent(c.replace(/\+/g," "))}catch{}t+="/"+c}return t}function K_(s){const t={};s.charAt(0)==="?"&&(s=s.substring(1));for(const r of s.split("&")){if(r.length===0)continue;const o=r.split("=");o.length===2?t[decodeURIComponent(o[0])]=decodeURIComponent(o[1]):Bt(`Invalid query segment '${r}' in query '${s}'`)}return t}const mp=function(s,t){const r=J_(s),o=r.namespace;r.domain==="firebase.com"&&Pn(r.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!o||o==="undefined")&&r.domain!=="localhost"&&Pn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r.secure||uy();const c=r.scheme==="ws"||r.scheme==="wss";return{repoInfo:new Jp(r.host,r.secure,o,c,t,"",o!==r.subdomain),path:new qe(r.pathString)}},J_=function(s){let t="",r="",o="",c="",d="",f=!0,p="https",g=443;if(typeof s=="string"){let x=s.indexOf("//");x>=0&&(p=s.substring(0,x-1),s=s.substring(x+2));let k=s.indexOf("/");k===-1&&(k=s.length);let y=s.indexOf("?");y===-1&&(y=s.length),t=s.substring(0,Math.min(k,y)),k<y&&(c=q_(s.substring(k,y)));const v=K_(s.substring(Math.min(s.length,y)));x=t.indexOf(":"),x>=0?(f=p==="https"||p==="wss",g=parseInt(t.substring(x+1),10)):x=t.length;const C=t.slice(0,x);if(C.toLowerCase()==="localhost")r="localhost";else if(C.split(".").length<=2)r=C;else{const M=t.indexOf(".");o=t.substring(0,M).toLowerCase(),r=t.substring(M+1),d=o}"ns"in v&&(d=v.ns)}return{host:t,port:g,domain:r,subdomain:o,secure:f,scheme:p,pathString:c,namespace:d}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(t,r,o,c){this.eventType=t,this.eventRegistration=r,this.snapshot=o,this.prevName=c}getPath(){const t=this.snapshot.ref;return this.eventType==="value"?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+bt(this.snapshot.exportVal())}}class ew{constructor(t,r,o){this.eventRegistration=t,this.error=r,this.path=o}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(t,r){this.snapshotCallback=t,this.cancelCallback=r}onValue(t,r){this.snapshotCallback.call(null,t,r)}onCancel(t){return q(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(t,r,o,c){this._repo=t,this._path=r,this._queryParams=o,this._orderByCalled=c}get key(){return Ae(this._path)?null:lm(this._path)}get ref(){return new ir(this._repo,this._path)}get _queryIdentifier(){const t=Zf(this._queryParams),r=Vc(t);return r==="{}"?"default":r}get _queryObject(){return Zf(this._queryParams)}isEqual(t){if(t=_i(t),!(t instanceof bu))return!1;const r=this._repo===t._repo,o=Xc(this._path,t._path),c=this._queryIdentifier===t._queryIdentifier;return r&&o&&c}toJSON(){return this.toString()}toString(){return this._repo.toString()+Qy(this._path)}}class ir extends bu{constructor(t,r){super(t,r,new Zc,!1)}get parent(){const t=cm(this._path);return t===null?null:new ir(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}}class sl{constructor(t,r,o){this._node=t,this.ref=r,this._index=o}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const r=new qe(t),o=Fc(this.ref,t);return new sl(this._node.getChild(r),o,ct)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(o,c)=>t(new sl(c,Fc(this.ref,o),ct)))}hasChild(t){const r=new qe(t);return!this._node.getChild(r).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Nt(s,t){return s=_i(s),s._checkNotDeleted("ref"),t!==void 0?Fc(s._root,t):s._root}function Fc(s,t){return s=_i(s),Pe(s._path)===null?P_("child","path",t):Um("child","path",t),new ir(s._repo,gt(s._path,t))}function Si(s){return Wm("remove",s._path),or(s,null)}function or(s,t){s=_i(s),Wm("set",s._path),R_("set",t,s._path);const r=new il;return W_(s._repo,s._path,t,null,r.wrapCallback(()=>{})),r.promise}class Nu{constructor(t){this.callbackContext=t}respondsTo(t){return t==="value"}createEvent(t,r){const o=r._queryParams.getIndex();return new Z_("value",this,new sl(t.snapshotNode,new ir(r._repo,r._path),o))}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,r){return this.callbackContext.hasCancelCallback?new ew(this,t,r):null}matches(t){return t instanceof Nu?!t.callbackContext||!this.callbackContext?!0:t.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function nw(s,t,r,o,c){const d=new tw(r,void 0),f=new Nu(d);return H_(s._repo,s,f),()=>V_(s._repo,s,f)}function ms(s,t,r,o){return nw(s,"value",t)}r_(ir);c_(ir);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rw="FIREBASE_DATABASE_EMULATOR_HOST",$c={};let sw=!1;function iw(s,t,r,o){const c=t.lastIndexOf(":"),d=t.substring(0,c),f=Wc(d);s.repoInfo_=new Jp(t,f,s.repoInfo_.namespace,s.repoInfo_.webSocketOnly,s.repoInfo_.nodeAdmin,s.repoInfo_.persistenceKey,s.repoInfo_.includeNamespaceInQueryParams,!0,r),o&&(s.authTokenProvider_=o)}function ow(s,t,r,o,c){let d=o||s.options.databaseURL;d===void 0&&(s.options.projectId||Pn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Rt("Using default host for project ",s.options.projectId),d=`${s.options.projectId}-default-rtdb.firebaseio.com`);let f=mp(d,c),p=f.repoInfo,g;typeof process<"u"&&Df&&(g=Df[rw]),g?(d=`http://${g}?ns=${p.namespace}`,f=mp(d,c),p=f.repoInfo):f.repoInfo.secure;const x=new wy(s.name,s.options,t);L_("Invalid Firebase Database URL",f),Ae(f.path)||Pn("Database URL must point to the root of a Firebase Database (not including a child path).");const k=aw(p,s,x,new _y(s,r));return new cw(k,s)}function lw(s,t){const r=$c[t];(!r||r[s.key]!==s)&&Pn(`Database ${t}(${s.repoInfo_}) has already been deleted.`),Y_(s),delete r[s.key]}function aw(s,t,r,o){let c=$c[t.name];c||(c={},$c[t.name]=c);let d=c[s.toURLString()];return d&&Pn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),d=new F_(s,sw,r,o),c[s.toURLString()]=d,d}class cw{constructor(t,r){this._repoInternal=t,this.app=r,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||($_(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ir(this._repo,Ye())),this._rootInternal}_delete(){return this._rootInternal!==null&&(lw(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&Pn("Cannot call "+t+" on a deleted database.")}}function uw(s=Vv(),t){const r=zv(s,"database").getImmediate({identifier:t});if(!r._instanceStarted){const o=Cx("database");o&&dw(r,...o)}return r}function dw(s,t,r,o={}){s=_i(s),s._checkNotDeleted("useEmulator");const c=`${t}:${r}`,d=s._repoInternal;if(s._instanceStarted){if(c===s._repoInternal.repoInfo_.host&&Bo(o,d.repoInfo_.emulatorOptions))return;Pn("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let f;if(d.repoInfo_.nodeAdmin)o.mockUserToken&&Pn('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),f=new $o($o.OWNER);else if(o.mockUserToken){const p=typeof o.mockUserToken=="string"?o.mockUserToken:jx(o.mockUserToken,s.app.options.projectId);f=new $o(p)}Wc(t)&&(Sx(t),Tx("Database",!0)),iw(d,c,o,f)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hw(s){sy(Hv),Vo(new di("database",(t,{instanceIdentifier:r})=>{const o=t.getProvider("app").getImmediate(),c=t.getProvider("auth-internal"),d=t.getProvider("app-check-internal");return ow(o,c,d,r)},"PUBLIC").setMultipleInstances(!0)),rs(Of,Af,s),rs(Of,Af,"esm2020")}Tn.prototype.simpleListen=function(s,t){this.sendRequest("q",{p:s},t)};Tn.prototype.echo=function(s,t){this.sendRequest("echo",{d:s},t)};hw();const fw={apiKey:"AIzaSyCIA80U-Nb235O5SG_2d1TzdylvYQrzNUc",authDomain:"razlom-db061.firebaseapp.com",projectId:"razlom-db061",storageBucket:"razlom-db061.firebasestorage.app",messagingSenderId:"343432819418",appId:"1:343432819418:web:73f0fedc8a5e5a32912be3",measurementId:"G-EPLQFH5LMJ",databaseURL:"https://razlom-db061-default-rtdb.firebaseio.com"};let gp,Fe;try{gp=Mp(fw),Fe=uw(gp),console.log("Firebase initialized successfully (RTDB only)")}catch(s){console.error("Firebase init error:",s)}const ji=s=>{if(!s)return[];const t=Array.isArray(s)?s:Object.values(s),r=new Map;return t.forEach(o=>{o&&typeof o=="object"&&o.id&&r.set(o.id,o)}),Array.from(r.values())},ri=s=>(s||[]).reduce((t,r)=>(r&&r.id&&(t[r.id]=r),t),{}),pw=(s,t)=>{if(!Fe)return()=>{};const r=Nt(Fe,`rooms/${s}/characters`);return ms(r,o=>{t(ji(o.val()))})},mw=(s,t)=>{if(!Fe)return()=>{};const r=Nt(Fe,`rooms/${s}/realms`);return ms(r,o=>{t(ji(o.val()))})},gw=(s,t)=>{if(!Fe)return()=>{};const r=Nt(Fe,`rooms/${s}/worlds`);return ms(r,o=>{t(ji(o.val()))})},xw=(s,t)=>{if(!Fe)return()=>{};const r=Nt(Fe,`rooms/${s}/notes`);return ms(r,o=>{t(ji(o.val()))})},vw=(s,t)=>{if(!Fe)return()=>{};const r=Nt(Fe,`rooms/${s}/rpSessions`);return ms(r,o=>{t(ji(o.val()))})},xp=(s,t,r=!1)=>{if(!Fe)return()=>{};const c=Nt(Fe,`rooms/${s}/${r?"availableHiddenTags":"availableTags"}`);return ms(c,d=>{const f=d.val();t(Array.isArray(f)?f:[])})},yw=async(s,t)=>{if(!Fe)return;const r=Nt(Fe,`rooms/${s}`),o={...t,characters:ri(t.characters),realms:ri(t.realms),worlds:ri(t.worlds),notes:ri(t.notes),rpSessions:ri(t.rpSessions)};try{await or(r,o)}catch(c){console.error("Firebase write error:",c)}},_w=async(s,t)=>{if(!Fe||!t.id)return;const r=Nt(Fe,`rooms/${s}/characters/${t.id}`);try{await or(r,t)}catch(o){console.error("Error saving character:",o)}},ww=async(s,t)=>{if(!Fe)return;const r=Nt(Fe,`rooms/${s}/characters/${t}`);try{await Si(r)}catch(o){console.error("Error deleting character:",o)}},bw=async(s,t)=>{if(!Fe||!t.id)return;const r=Nt(Fe,`rooms/${s}/realms/${t.id}`);try{await or(r,t)}catch(o){console.error(o)}},Nw=async(s,t)=>{if(!Fe)return;const r=Nt(Fe,`rooms/${s}/realms/${t}`);try{await Si(r)}catch(o){console.error(o)}},kw=async(s,t)=>{if(!Fe||!t.id)return;const r=Nt(Fe,`rooms/${s}/worlds/${t.id}`);try{await or(r,t)}catch(o){console.error(o)}},Cw=async(s,t)=>{if(!Fe)return;const r=Nt(Fe,`rooms/${s}/worlds/${t}`);try{await Si(r)}catch(o){console.error(o)}},Sw=async(s,t)=>{if(!Fe||!t.id)return;const r=Nt(Fe,`rooms/${s}/notes/${t.id}`);try{await or(r,t)}catch(o){console.error(o)}},jw=async(s,t)=>{if(!Fe)return;const r=Nt(Fe,`rooms/${s}/notes/${t}`);try{await Si(r)}catch(o){console.error(o)}},Ew=async(s,t)=>{if(!Fe||!t.id)return;const r=Nt(Fe,`rooms/${s}/rpSessions/${t.id}`);try{await or(r,t)}catch(o){console.error(o)}},Iw=async(s,t)=>{if(!Fe)return;const r=Nt(Fe,`rooms/${s}/rpSessions/${t}`);try{await Si(r)}catch(o){console.error(o)}},vp=async(s,t,r=!1)=>{if(!Fe)return;const c=Nt(Fe,`rooms/${s}/${r?"availableHiddenTags":"availableTags"}`);try{await or(c,t)}catch(d){console.error("Error saving tags:",d)}},yp="rp_haven_master_data_v3",ft="global_chronicles_main",zt=(s,t=[])=>Array.isArray(s)?s:t,Tw=()=>{const[s,t]=F.useState("characters"),[r,o]=F.useState(null),[c,d]=F.useState(""),[f,p]=F.useState({}),[g,x]=F.useState(!1),[k,y]=F.useState(!1),[v,C]=F.useState(null),[M,B]=F.useState(!1),[ne,ue]=F.useState(!1),[se,je]=F.useState(!0);F.useEffect(()=>{window.scrollTo(0,0)},[s,r]);const[he,We]=F.useState(!1),[J,L]=F.useState(ac),[P,_e]=F.useState(()=>{const D=localStorage.getItem(yp);if(D)try{const A=JSON.parse(D);return{characters:zt(A.characters,ac),realms:zt(A.realms),worlds:zt(A.worlds),notes:zt(A.notes),availableTags:zt(A.availableTags,wf),availableHiddenTags:zt(A.availableHiddenTags,bf),rpSessions:zt(A.rpSessions)}}catch(A){console.error("Failed to parse storage",A)}return{characters:ac,realms:[],worlds:[],notes:[],availableTags:wf,availableHiddenTags:bf,rpSessions:[]}});F.useEffect(()=>{L(P.characters)},[P.characters]),F.useEffect(()=>{if(se){const D=pw(ft,T=>_e(H=>({...H,characters:T}))),A=mw(ft,T=>_e(H=>({...H,realms:T}))),Q=gw(ft,T=>_e(H=>({...H,worlds:T}))),j=xw(ft,T=>_e(H=>({...H,notes:T}))),K=vw(ft,T=>_e(H=>({...H,rpSessions:T}))),ye=xp(ft,T=>_e(H=>({...H,availableTags:T})),!1),$e=xp(ft,T=>_e(H=>({...H,availableHiddenTags:T})),!0);return()=>{D(),A(),Q(),j(),K(),ye(),$e()}}},[se]);const ae=()=>{const D=P.characters.filter(A=>{const Q=A.name.toLowerCase().includes(c.toLowerCase()),j=Object.entries(f).every(([K,ye])=>{const $e=(A.tags||[]).includes(K)||(A.hiddenTags||[]).includes(K);return ye==="include"?$e:ye==="exclude"?!$e:!0});return Q&&j});We(!0),setTimeout(()=>{L(D),requestAnimationFrame(()=>{We(!1)})},600)};F.useEffect(()=>{ae()},[c,f,P.characters]);const ie=D=>{_e(D),B(!0),setTimeout(()=>B(!1),2e3);try{const A=JSON.parse(JSON.stringify(D));A.characters.forEach(Q=>{Q.imageUrl&&Q.imageUrl.startsWith("data:")&&(Q.imageUrl="")}),A.worlds.forEach(Q=>{Q.imageUrl&&Q.imageUrl.startsWith("data:")&&(Q.imageUrl="")}),A.realms.forEach(Q=>{Q.imageUrl&&Q.imageUrl.startsWith("data:")&&(Q.imageUrl="")}),localStorage.setItem(yp,JSON.stringify(A))}catch(A){console.warn("Local storage quota exceeded.",A)}},ve=D=>{const A=P.characters.some(Q=>Q.id===D.id)?P.characters.map(Q=>Q.id===D.id?D:Q):[...P.characters,D];ie({...P,characters:A}),y(!1),C(null),se&&_w(ft,D)},fe=D=>{if(window.confirm("    ?")){const A=P.characters.filter(Q=>Q.id!==D);ie({...P,characters:A}),r===D&&o(null),se&&ww(ft,D)}},Me=D=>{se&&(D.forEach(A=>{const Q=P.notes.find(j=>j.id===A.id);(!Q||JSON.stringify(Q)!==JSON.stringify(A))&&Sw(ft,A)}),P.notes.forEach(A=>{D.find(Q=>Q.id===A.id)||jw(ft,A.id)})),ie({...P,notes:D})},lt=D=>{se&&(D.forEach(A=>{const Q=P.realms.find(j=>j.id===A.id);(!Q||JSON.stringify(Q)!==JSON.stringify(A))&&bw(ft,A)}),P.realms.forEach(A=>{D.find(Q=>Q.id===A.id)||Nw(ft,A.id)})),ie({...P,realms:D})},Qe=D=>{se&&(D.forEach(A=>{const Q=P.worlds.find(j=>j.id===A.id);(!Q||JSON.stringify(Q)!==JSON.stringify(A))&&kw(ft,A)}),P.worlds.forEach(A=>{D.find(Q=>Q.id===A.id)||Cw(ft,A.id)})),ie({...P,worlds:D})},De=D=>{se&&(D.forEach(A=>{const Q=P.rpSessions.find(j=>j.id===A.id);(!Q||JSON.stringify(Q)!==JSON.stringify(A))&&Ew(ft,A)}),P.rpSessions.forEach(A=>{D.find(Q=>Q.id===A.id)||Iw(ft,A.id)})),ie({...P,rpSessions:D})},Y=D=>{ie({...P,availableTags:D}),se&&vp(ft,D,!1)},Z=D=>{ie({...P,availableHiddenTags:D}),se&&vp(ft,D,!0)},w=D=>{p(A=>{const Q=A[D]||"none";let j="none";Q==="none"?j="include":Q==="include"?j="exclude":j="none";const K={...A};return j==="none"?delete K[D]:K[D]=j,K})},O=()=>{d(""),p({})},ee=D=>{o(D),t("characters")},ke=Object.keys(f).length;return a.jsxs(nx,{activeTab:s,setActiveTab:D=>{t(D),o(null),p({})},isAdmin:g,onToggleAdmin:()=>x(!g),onOpenSync:()=>ue(!0),isSyncActive:se,onDownloadDB:()=>{const D=new Blob([JSON.stringify(P,null,2)],{type:"application/json"}),A=URL.createObjectURL(D),Q=document.createElement("a");Q.href=A,Q.download=`rp-vault-${new Date().toISOString().slice(0,10)}.json`,Q.click()},onUploadDB:D=>{const A=JSON.parse(D);if(window.confirm("  ?")){const Q={characters:zt(A.characters),realms:zt(A.realms),worlds:zt(A.worlds),notes:zt(A.notes),availableTags:zt(A.availableTags),availableHiddenTags:zt(A.availableHiddenTags),rpSessions:zt(A.rpSessions)};ie(Q),se&&yw(ft,Q)}},children:[a.jsx("div",{className:`fixed top-20 md:top-6 right-6 z-[90] transition-all duration-500 pointer-events-none ${M?"opacity-100 translate-y-0":"opacity-0 -translate-y-4"}`,children:a.jsx("div",{className:"bg-emerald-950/80 border border-emerald-500/30 backdrop-blur-2xl px-5 py-2.5 rounded-2xl flex items-center gap-3 shadow-2xl",children:a.jsx("span",{className:"text-[10px] uppercase tracking-[0.2em] font-black text-emerald-400",children:""})})}),ne&&a.jsx(px,{isConnected:se,onConnect:()=>je(!0),onDisconnect:()=>je(!1),onClose:()=>ue(!1)}),a.jsxs("div",{className:"animate-tab-switch",children:[s==="characters"&&a.jsx("div",{className:"space-y-8",children:r?a.jsx(ox,{character:P.characters.find(D=>D.id===r),isAdmin:g,allCharacters:P.characters,availableTags:P.availableTags,availableHiddenTags:P.availableHiddenTags,worlds:P.worlds,notes:P.notes,onBack:()=>o(null),onSave:ve,onSelectCharacter:ee}):a.jsxs("div",{className:"animate-reveal-list space-y-8",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-6",children:[a.jsx("input",{type:"text",placeholder:"  ...",value:c,onChange:D=>d(D.target.value),className:"w-full bg-transparent border-b border-stone-900 text-3xl outline-none font-serif italic py-4"}),g&&a.jsx("button",{onClick:()=>{C(null),y(!0)},className:"bg-white text-black px-8 py-3.5 rounded-full text-[10px] uppercase font-black transition-all shadow-xl",children:" "})]}),(P.availableTags.length>0||P.availableHiddenTags.length>0)&&a.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-4 bg-[#0f0f0f]/30 border border-stone-900/50 rounded-2xl",children:[a.jsx("span",{className:"text-[9px] uppercase tracking-[0.2em] font-black text-stone-600 mr-2",children:":"}),P.availableTags.map(D=>{const A=f[D]||"none";return a.jsxs("button",{onClick:()=>w(D),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${A==="include"?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":A==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-stone-400 hover:border-stone-700"}`,children:[A==="include"&&a.jsx("span",{className:"text-emerald-500 font-black",children:"+"}),A==="exclude"&&a.jsx("span",{className:"text-red-500 font-black",children:""}),D]},D)}),P.availableHiddenTags.map(D=>{const A=f[D]||"none";return a.jsxs("button",{onClick:()=>w(D),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${A==="include"?"bg-amber-500/10 border-amber-500/40 text-amber-400 shadow-[0_0_15px_rgba(245,158,11,0.1)]":A==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-amber-500 hover:border-amber-900/30"}`,children:[A==="include"&&a.jsx("span",{className:"text-amber-500 font-black",children:"+"}),A==="exclude"&&a.jsx("span",{className:"text-red-500 font-black",children:""}),D]},D)}),(ke>0||c)&&a.jsx("button",{onClick:O,className:"ml-auto text-[9px] uppercase tracking-[0.2em] font-black text-stone-700 hover:text-red-500 transition-colors",children:" "})]}),a.jsxs("div",{className:"flex flex-wrap -mx-5 relative min-h-[400px]",children:[J.map((D,A)=>a.jsx(sx,{character:D,isVisible:!he,staggerIndex:A,onClick:o},D.id)),J.length===0&&!he&&a.jsx("div",{className:"w-full py-20 text-center text-stone-700 italic font-serif animate-in fade-in duration-700",children:"       ..."})]})]})}),s==="connections"&&a.jsx(dx,{characters:P.characters,availableTags:P.availableTags,availableHiddenTags:P.availableHiddenTags,filterStates:f,onToggleTag:w,onClearFilters:()=>p({}),onSelectCharacter:ee}),s==="roleplay"&&a.jsx(fx,{sessions:P.rpSessions,characters:P.characters,onUpdate:De,isAdmin:g}),s==="worlds"&&a.jsx(hx,{realms:P.realms,worlds:P.worlds,characters:P.characters,availableTags:P.availableTags,availableHiddenTags:P.availableHiddenTags,onUpdateRealms:lt,onUpdateWorlds:Qe,isAdmin:g}),s==="notes"&&a.jsx(ix,{notes:P.notes,characters:P.characters,availableTags:P.availableTags,availableHiddenTags:P.availableHiddenTags,onUpdate:Me,isAdmin:g,onSelectCharacter:ee}),s==="admin"&&g&&a.jsx(ax,{characters:P.characters,availableTags:P.availableTags,availableHiddenTags:P.availableHiddenTags,onDelete:fe,onEdit:D=>{C(D),y(!0)},onAdd:()=>{C(null),y(!0)},onUpdateTags:Y,onUpdateHiddenTags:Z,onDownloadDB:()=>{},onUploadDB:()=>{}})]}),k&&a.jsx(lx,{initialData:v,availableTags:P.availableTags,availableHiddenTags:P.availableHiddenTags,onSave:ve,onClose:()=>y(!1)})]})},Km=document.getElementById("root");if(!Km)throw new Error("Could not find root element to mount to");const Rw=tx.createRoot(Km);Rw.render(a.jsx(wp.StrictMode,{children:a.jsx(Tw,{})}));
