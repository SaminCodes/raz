(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const u of a)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function r(a){const u={};return a.integrity&&(u.integrity=a.integrity),a.referrerPolicy&&(u.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?u.credentials="include":a.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function o(a){if(a.ep)return;a.ep=!0;const u=r(a);fetch(a.href,u)}})();function up(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Qa={exports:{}},Vs={},Ga={exports:{}},ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zf;function Mg(){if(Zf)return ve;Zf=1;var s=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),h=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),y=Symbol.iterator;function x(C){return C===null||typeof C!="object"?null:(C=y&&C[y]||C["@@iterator"],typeof C=="function"?C:null)}var R={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},P=Object.assign,B={};function Q(C,D,w){this.props=C,this.context=D,this.refs=B,this.updater=w||R}Q.prototype.isReactComponent={},Q.prototype.setState=function(C,D){if(typeof C!="object"&&typeof C!="function"&&C!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,C,D,"setState")},Q.prototype.forceUpdate=function(C){this.updater.enqueueForceUpdate(this,C,"forceUpdate")};function te(){}te.prototype=Q.prototype;function ie(C,D,w){this.props=C,this.context=D,this.refs=B,this.updater=w||R}var _e=ie.prototype=new te;_e.constructor=ie,P(_e,Q.prototype),_e.isPureReactComponent=!0;var A=Array.isArray,$e=Object.prototype.hasOwnProperty,H={current:null},z={key:!0,ref:!0,__self:!0,__source:!0};function oe(C,D,w){var T,L={},K=null,ue=null;if(D!=null)for(T in D.ref!==void 0&&(ue=D.ref),D.key!==void 0&&(K=""+D.key),D)$e.call(D,T)&&!z.hasOwnProperty(T)&&(L[T]=D[T]);var ke=arguments.length-2;if(ke===1)L.children=w;else if(1<ke){for(var we=Array(ke),et=0;et<ke;et++)we[et]=arguments[et+2];L.children=we}if(C&&C.defaultProps)for(T in ke=C.defaultProps,ke)L[T]===void 0&&(L[T]=ke[T]);return{$$typeof:s,type:C,key:K,ref:ue,props:L,_owner:H.current}}function ye(C,D){return{$$typeof:s,type:C.type,key:D,ref:C.ref,props:C.props,_owner:C._owner}}function he(C){return typeof C=="object"&&C!==null&&C.$$typeof===s}function Ue(C){var D={"=":"=0",":":"=2"};return"$"+C.replace(/[=:]/g,function(w){return D[w]})}var Re=/\/+/g;function We(C,D){return typeof C=="object"&&C!==null&&C.key!=null?Ue(""+C.key):D.toString(36)}function Ke(C,D,w,T,L){var K=typeof C;(K==="undefined"||K==="boolean")&&(C=null);var ue=!1;if(C===null)ue=!0;else switch(K){case"string":case"number":ue=!0;break;case"object":switch(C.$$typeof){case s:case t:ue=!0}}if(ue)return ue=C,L=L(ue),C=T===""?"."+We(ue,0):T,A(L)?(w="",C!=null&&(w=C.replace(Re,"$&/")+"/"),Ke(L,D,w,"",function(et){return et})):L!=null&&(he(L)&&(L=ye(L,w+(!L.key||ue&&ue.key===L.key?"":(""+L.key).replace(Re,"$&/")+"/")+C)),D.push(L)),1;if(ue=0,T=T===""?".":T+":",A(C))for(var ke=0;ke<C.length;ke++){K=C[ke];var we=T+We(K,ke);ue+=Ke(K,D,w,we,L)}else if(we=x(C),typeof we=="function")for(C=we.call(C),ke=0;!(K=C.next()).done;)K=K.value,we=T+We(K,ke++),ue+=Ke(K,D,w,we,L);else if(K==="object")throw D=String(C),Error("Objects are not valid as a React child (found: "+(D==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":D)+"). If you meant to render a collection of children, use an array instead.");return ue}function pt(C,D,w){if(C==null)return C;var T=[],L=0;return Ke(C,T,"","",function(K){return D.call(w,K,L++)}),T}function Ze(C){if(C._status===-1){var D=C._result;D=D(),D.then(function(w){(C._status===0||C._status===-1)&&(C._status=1,C._result=w)},function(w){(C._status===0||C._status===-1)&&(C._status=2,C._result=w)}),C._status===-1&&(C._status=0,C._result=D)}if(C._status===1)return C._result.default;throw C._result}var Te={current:null},W={transition:null},Z={ReactCurrentDispatcher:Te,ReactCurrentBatchConfig:W,ReactCurrentOwner:H};return ve.Children={map:pt,forEach:function(C,D,w){pt(C,function(){D.apply(this,arguments)},w)},count:function(C){var D=0;return pt(C,function(){D++}),D},toArray:function(C){return pt(C,function(D){return D})||[]},only:function(C){if(!he(C))throw Error("React.Children.only expected to receive a single React element child.");return C}},ve.Component=Q,ve.Fragment=r,ve.Profiler=a,ve.PureComponent=ie,ve.StrictMode=o,ve.Suspense=g,ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z,ve.cloneElement=function(C,D,w){if(C==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+C+".");var T=P({},C.props),L=C.key,K=C.ref,ue=C._owner;if(D!=null){if(D.ref!==void 0&&(K=D.ref,ue=H.current),D.key!==void 0&&(L=""+D.key),C.type&&C.type.defaultProps)var ke=C.type.defaultProps;for(we in D)$e.call(D,we)&&!z.hasOwnProperty(we)&&(T[we]=D[we]===void 0&&ke!==void 0?ke[we]:D[we])}var we=arguments.length-2;if(we===1)T.children=w;else if(1<we){ke=Array(we);for(var et=0;et<we;et++)ke[et]=arguments[et+2];T.children=ke}return{$$typeof:s,type:C.type,key:L,ref:K,props:T,_owner:ue}},ve.createContext=function(C){return C={$$typeof:h,_currentValue:C,_currentValue2:C,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},C.Provider={$$typeof:u,_context:C},C.Consumer=C},ve.createElement=oe,ve.createFactory=function(C){var D=oe.bind(null,C);return D.type=C,D},ve.createRef=function(){return{current:null}},ve.forwardRef=function(C){return{$$typeof:p,render:C}},ve.isValidElement=he,ve.lazy=function(C){return{$$typeof:S,_payload:{_status:-1,_result:C},_init:Ze}},ve.memo=function(C,D){return{$$typeof:v,type:C,compare:D===void 0?null:D}},ve.startTransition=function(C){var D=W.transition;W.transition={};try{C()}finally{W.transition=D}},ve.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},ve.useCallback=function(C,D){return Te.current.useCallback(C,D)},ve.useContext=function(C){return Te.current.useContext(C)},ve.useDebugValue=function(){},ve.useDeferredValue=function(C){return Te.current.useDeferredValue(C)},ve.useEffect=function(C,D){return Te.current.useEffect(C,D)},ve.useId=function(){return Te.current.useId()},ve.useImperativeHandle=function(C,D,w){return Te.current.useImperativeHandle(C,D,w)},ve.useInsertionEffect=function(C,D){return Te.current.useInsertionEffect(C,D)},ve.useLayoutEffect=function(C,D){return Te.current.useLayoutEffect(C,D)},ve.useMemo=function(C,D){return Te.current.useMemo(C,D)},ve.useReducer=function(C,D,w){return Te.current.useReducer(C,D,w)},ve.useRef=function(C){return Te.current.useRef(C)},ve.useState=function(C){return Te.current.useState(C)},ve.useSyncExternalStore=function(C,D,w){return Te.current.useSyncExternalStore(C,D,w)},ve.useTransition=function(){return Te.current.useTransition()},ve.version="18.2.0",ve}var eh;function Tc(){return eh||(eh=1,Ga.exports=Mg()),Ga.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var th;function Ag(){if(th)return Vs;th=1;var s=Tc(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function h(p,g,v){var S,y={},x=null,R=null;v!==void 0&&(x=""+v),g.key!==void 0&&(x=""+g.key),g.ref!==void 0&&(R=g.ref);for(S in g)o.call(g,S)&&!u.hasOwnProperty(S)&&(y[S]=g[S]);if(p&&p.defaultProps)for(S in g=p.defaultProps,g)y[S]===void 0&&(y[S]=g[S]);return{$$typeof:t,type:p,key:x,ref:R,props:y,_owner:a.current}}return Vs.Fragment=r,Vs.jsx=h,Vs.jsxs=h,Vs}var nh;function Og(){return nh||(nh=1,Qa.exports=Ag()),Qa.exports}var f=Og(),V=Tc();const Fg=up(V);var bo={},Ka={exports:{}},Pt={},qa={exports:{}},Xa={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rh;function zg(){return rh||(rh=1,(function(s){function t(W,Z){var C=W.length;W.push(Z);e:for(;0<C;){var D=C-1>>>1,w=W[D];if(0<a(w,Z))W[D]=Z,W[C]=w,C=D;else break e}}function r(W){return W.length===0?null:W[0]}function o(W){if(W.length===0)return null;var Z=W[0],C=W.pop();if(C!==Z){W[0]=C;e:for(var D=0,w=W.length,T=w>>>1;D<T;){var L=2*(D+1)-1,K=W[L],ue=L+1,ke=W[ue];if(0>a(K,C))ue<w&&0>a(ke,K)?(W[D]=ke,W[ue]=C,D=ue):(W[D]=K,W[L]=C,D=L);else if(ue<w&&0>a(ke,C))W[D]=ke,W[ue]=C,D=ue;else break e}}return Z}function a(W,Z){var C=W.sortIndex-Z.sortIndex;return C!==0?C:W.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var h=Date,p=h.now();s.unstable_now=function(){return h.now()-p}}var g=[],v=[],S=1,y=null,x=3,R=!1,P=!1,B=!1,Q=typeof setTimeout=="function"?setTimeout:null,te=typeof clearTimeout=="function"?clearTimeout:null,ie=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _e(W){for(var Z=r(v);Z!==null;){if(Z.callback===null)o(v);else if(Z.startTime<=W)o(v),Z.sortIndex=Z.expirationTime,t(g,Z);else break;Z=r(v)}}function A(W){if(B=!1,_e(W),!P)if(r(g)!==null)P=!0,Ze($e);else{var Z=r(v);Z!==null&&Te(A,Z.startTime-W)}}function $e(W,Z){P=!1,B&&(B=!1,te(oe),oe=-1),R=!0;var C=x;try{for(_e(Z),y=r(g);y!==null&&(!(y.expirationTime>Z)||W&&!Ue());){var D=y.callback;if(typeof D=="function"){y.callback=null,x=y.priorityLevel;var w=D(y.expirationTime<=Z);Z=s.unstable_now(),typeof w=="function"?y.callback=w:y===r(g)&&o(g),_e(Z)}else o(g);y=r(g)}if(y!==null)var T=!0;else{var L=r(v);L!==null&&Te(A,L.startTime-Z),T=!1}return T}finally{y=null,x=C,R=!1}}var H=!1,z=null,oe=-1,ye=5,he=-1;function Ue(){return!(s.unstable_now()-he<ye)}function Re(){if(z!==null){var W=s.unstable_now();he=W;var Z=!0;try{Z=z(!0,W)}finally{Z?We():(H=!1,z=null)}}else H=!1}var We;if(typeof ie=="function")We=function(){ie(Re)};else if(typeof MessageChannel<"u"){var Ke=new MessageChannel,pt=Ke.port2;Ke.port1.onmessage=Re,We=function(){pt.postMessage(null)}}else We=function(){Q(Re,0)};function Ze(W){z=W,H||(H=!0,We())}function Te(W,Z){oe=Q(function(){W(s.unstable_now())},Z)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(W){W.callback=null},s.unstable_continueExecution=function(){P||R||(P=!0,Ze($e))},s.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ye=0<W?Math.floor(1e3/W):5},s.unstable_getCurrentPriorityLevel=function(){return x},s.unstable_getFirstCallbackNode=function(){return r(g)},s.unstable_next=function(W){switch(x){case 1:case 2:case 3:var Z=3;break;default:Z=x}var C=x;x=Z;try{return W()}finally{x=C}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(W,Z){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var C=x;x=W;try{return Z()}finally{x=C}},s.unstable_scheduleCallback=function(W,Z,C){var D=s.unstable_now();switch(typeof C=="object"&&C!==null?(C=C.delay,C=typeof C=="number"&&0<C?D+C:D):C=D,W){case 1:var w=-1;break;case 2:w=250;break;case 5:w=1073741823;break;case 4:w=1e4;break;default:w=5e3}return w=C+w,W={id:S++,callback:Z,priorityLevel:W,startTime:C,expirationTime:w,sortIndex:-1},C>D?(W.sortIndex=C,t(v,W),r(g)===null&&W===r(v)&&(B?(te(oe),oe=-1):B=!0,Te(A,C-D))):(W.sortIndex=w,t(g,W),P||R||(P=!0,Ze($e))),W},s.unstable_shouldYield=Ue,s.unstable_wrapCallback=function(W){var Z=x;return function(){var C=x;x=Z;try{return W.apply(this,arguments)}finally{x=C}}}})(Xa)),Xa}var sh;function Ug(){return sh||(sh=1,qa.exports=zg()),qa.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ih;function Bg(){if(ih)return Pt;ih=1;var s=Tc(),t=Ug();function r(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)n+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function u(e,n){h(e,n),h(e+"Capture",n)}function h(e,n){for(a[e]=n,e=0;e<n.length;e++)o.add(n[e])}var p=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),g=Object.prototype.hasOwnProperty,v=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,S={},y={};function x(e){return g.call(y,e)?!0:g.call(S,e)?!1:v.test(e)?y[e]=!0:(S[e]=!0,!1)}function R(e,n,i,l){if(i!==null&&i.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return l?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function P(e,n,i,l){if(n===null||typeof n>"u"||R(e,n,i,l))return!0;if(l)return!1;if(i!==null)switch(i.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function B(e,n,i,l,c,d,m){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=l,this.attributeNamespace=c,this.mustUseProperty=i,this.propertyName=e,this.type=n,this.sanitizeURL=d,this.removeEmptyString=m}var Q={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Q[e]=new B(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];Q[n]=new B(n,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){Q[e]=new B(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Q[e]=new B(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Q[e]=new B(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){Q[e]=new B(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){Q[e]=new B(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){Q[e]=new B(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){Q[e]=new B(e,5,!1,e.toLowerCase(),null,!1,!1)});var te=/[\-:]([a-z])/g;function ie(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(te,ie);Q[n]=new B(n,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(te,ie);Q[n]=new B(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(te,ie);Q[n]=new B(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){Q[e]=new B(e,1,!1,e.toLowerCase(),null,!1,!1)}),Q.xlinkHref=new B("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){Q[e]=new B(e,1,!1,e.toLowerCase(),null,!0,!0)});function _e(e,n,i,l){var c=Q.hasOwnProperty(n)?Q[n]:null;(c!==null?c.type!==0:l||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(P(n,i,c,l)&&(i=null),l||c===null?x(n)&&(i===null?e.removeAttribute(n):e.setAttribute(n,""+i)):c.mustUseProperty?e[c.propertyName]=i===null?c.type===3?!1:"":i:(n=c.attributeName,l=c.attributeNamespace,i===null?e.removeAttribute(n):(c=c.type,i=c===3||c===4&&i===!0?"":""+i,l?e.setAttributeNS(l,n,i):e.setAttribute(n,i))))}var A=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$e=Symbol.for("react.element"),H=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),oe=Symbol.for("react.strict_mode"),ye=Symbol.for("react.profiler"),he=Symbol.for("react.provider"),Ue=Symbol.for("react.context"),Re=Symbol.for("react.forward_ref"),We=Symbol.for("react.suspense"),Ke=Symbol.for("react.suspense_list"),pt=Symbol.for("react.memo"),Ze=Symbol.for("react.lazy"),Te=Symbol.for("react.offscreen"),W=Symbol.iterator;function Z(e){return e===null||typeof e!="object"?null:(e=W&&e[W]||e["@@iterator"],typeof e=="function"?e:null)}var C=Object.assign,D;function w(e){if(D===void 0)try{throw Error()}catch(i){var n=i.stack.trim().match(/\n( *(at )?)/);D=n&&n[1]||""}return`
`+D+e}var T=!1;function L(e,n){if(!e||T)return"";T=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(j){var l=j}Reflect.construct(e,[],n)}else{try{n.call()}catch(j){l=j}e.call(n.prototype)}else{try{throw Error()}catch(j){l=j}e()}}catch(j){if(j&&l&&typeof j.stack=="string"){for(var c=j.stack.split(`
`),d=l.stack.split(`
`),m=c.length-1,_=d.length-1;1<=m&&0<=_&&c[m]!==d[_];)_--;for(;1<=m&&0<=_;m--,_--)if(c[m]!==d[_]){if(m!==1||_!==1)do if(m--,_--,0>_||c[m]!==d[_]){var k=`
`+c[m].replace(" at new "," at ");return e.displayName&&k.includes("<anonymous>")&&(k=k.replace("<anonymous>",e.displayName)),k}while(1<=m&&0<=_);break}}}finally{T=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?w(e):""}function K(e){switch(e.tag){case 5:return w(e.type);case 16:return w("Lazy");case 13:return w("Suspense");case 19:return w("SuspenseList");case 0:case 2:case 15:return e=L(e.type,!1),e;case 11:return e=L(e.type.render,!1),e;case 1:return e=L(e.type,!0),e;default:return""}}function ue(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case z:return"Fragment";case H:return"Portal";case ye:return"Profiler";case oe:return"StrictMode";case We:return"Suspense";case Ke:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ue:return(e.displayName||"Context")+".Consumer";case he:return(e._context.displayName||"Context")+".Provider";case Re:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case pt:return n=e.displayName||null,n!==null?n:ue(e.type)||"Memo";case Ze:n=e._payload,e=e._init;try{return ue(e(n))}catch{}}return null}function ke(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ue(n);case 8:return n===oe?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function we(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function et(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function In(e){var n=et(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),l=""+e[n];if(!e.hasOwnProperty(n)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var c=i.get,d=i.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return c.call(this)},set:function(m){l=""+m,d.call(this,m)}}),Object.defineProperty(e,n,{enumerable:i.enumerable}),{getValue:function(){return l},setValue:function(m){l=""+m},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function Gt(e){e._valueTracker||(e._valueTracker=In(e))}function fn(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var i=n.getValue(),l="";return e&&(l=et(e)?e.checked?"true":"false":e.value),e=l,e!==i?(n.setValue(e),!0):!1}function er(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function I(e,n){var i=n.checked;return C({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function J(e,n){var i=n.defaultValue==null?"":n.defaultValue,l=n.checked!=null?n.checked:n.defaultChecked;i=we(n.value!=null?n.value:i),e._wrapperState={initialChecked:l,initialValue:i,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function le(e,n){n=n.checked,n!=null&&_e(e,"checked",n,!1)}function fe(e,n){le(e,n);var i=we(n.value),l=n.type;if(i!=null)l==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?be(e,n.type,i):n.hasOwnProperty("defaultValue")&&be(e,n.type,we(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function de(e,n,i){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var l=n.type;if(!(l!=="submit"&&l!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,i||n===e.value||(e.value=n),e.defaultValue=n}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function be(e,n,i){(n!=="number"||er(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var pe=Array.isArray;function De(e,n,i,l){if(e=e.options,n){n={};for(var c=0;c<i.length;c++)n["$"+i[c]]=!0;for(i=0;i<e.length;i++)c=n.hasOwnProperty("$"+e[i].value),e[i].selected!==c&&(e[i].selected=c),c&&l&&(e[i].defaultSelected=!0)}else{for(i=""+we(i),n=null,c=0;c<e.length;c++){if(e[c].value===i){e[c].selected=!0,l&&(e[c].defaultSelected=!0);return}n!==null||e[c].disabled||(n=e[c])}n!==null&&(n.selected=!0)}}function tt(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(r(91));return C({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Nt(e,n){var i=n.value;if(i==null){if(i=n.children,n=n.defaultValue,i!=null){if(n!=null)throw Error(r(92));if(pe(i)){if(1<i.length)throw Error(r(93));i=i[0]}n=i}n==null&&(n=""),i=n}e._wrapperState={initialValue:we(i)}}function rt(e,n){var i=we(n.value),l=we(n.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),n.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),l!=null&&(e.defaultValue=""+l)}function qe(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function ne(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ce(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?ne(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Se,He=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,i,l,c){MSApp.execUnsafeLocalFunction(function(){return e(n,i,l,c)})}:e})(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(Se=Se||document.createElement("div"),Se.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=Se.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function st(e,n){if(n){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=n;return}}e.textContent=n}var xt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},hn=["Webkit","ms","Moz","O"];Object.keys(xt).forEach(function(e){hn.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),xt[n]=xt[e]})});function Ot(e,n,i){return n==null||typeof n=="boolean"||n===""?"":i||typeof n!="number"||n===0||xt.hasOwnProperty(e)&&xt[e]?(""+n).trim():n+"px"}function tr(e,n){e=e.style;for(var i in n)if(n.hasOwnProperty(i)){var l=i.indexOf("--")===0,c=Ot(i,n[i],l);i==="float"&&(i="cssFloat"),l?e.setProperty(i,c):e[i]=c}}var nr=C({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function il(e,n){if(n){if(nr[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(r(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(r(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(r(61))}if(n.style!=null&&typeof n.style!="object")throw Error(r(62))}}function ol(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ll=null;function al(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var cl=null,Sr=null,Er=null;function pu(e){if(e=js(e)){if(typeof cl!="function")throw Error(r(280));var n=e.stateNode;n&&(n=Bi(n),cl(e.stateNode,e.type,n))}}function mu(e){Sr?Er?Er.push(e):Er=[e]:Sr=e}function gu(){if(Sr){var e=Sr,n=Er;if(Er=Sr=null,pu(e),n)for(e=0;e<n.length;e++)pu(n[e])}}function vu(e,n){return e(n)}function xu(){}var ul=!1;function _u(e,n,i){if(ul)return e(n,i);ul=!0;try{return vu(e,n,i)}finally{ul=!1,(Sr!==null||Er!==null)&&(xu(),gu())}}function cs(e,n){var i=e.stateNode;if(i===null)return null;var l=Bi(i);if(l===null)return null;i=l[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(r(231,n,typeof i));return i}var dl=!1;if(p)try{var us={};Object.defineProperty(us,"passive",{get:function(){dl=!0}}),window.addEventListener("test",us,us),window.removeEventListener("test",us,us)}catch{dl=!1}function Bm(e,n,i,l,c,d,m,_,k){var j=Array.prototype.slice.call(arguments,3);try{n.apply(i,j)}catch(O){this.onError(O)}}var ds=!1,_i=null,yi=!1,fl=null,$m={onError:function(e){ds=!0,_i=e}};function Wm(e,n,i,l,c,d,m,_,k){ds=!1,_i=null,Bm.apply($m,arguments)}function Hm(e,n,i,l,c,d,m,_,k){if(Wm.apply(this,arguments),ds){if(ds){var j=_i;ds=!1,_i=null}else throw Error(r(198));yi||(yi=!0,fl=j)}}function rr(e){var n=e,i=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(i=n.return),e=n.return;while(e)}return n.tag===3?i:null}function yu(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function wu(e){if(rr(e)!==e)throw Error(r(188))}function Vm(e){var n=e.alternate;if(!n){if(n=rr(e),n===null)throw Error(r(188));return n!==e?null:e}for(var i=e,l=n;;){var c=i.return;if(c===null)break;var d=c.alternate;if(d===null){if(l=c.return,l!==null){i=l;continue}break}if(c.child===d.child){for(d=c.child;d;){if(d===i)return wu(c),e;if(d===l)return wu(c),n;d=d.sibling}throw Error(r(188))}if(i.return!==l.return)i=c,l=d;else{for(var m=!1,_=c.child;_;){if(_===i){m=!0,i=c,l=d;break}if(_===l){m=!0,l=c,i=d;break}_=_.sibling}if(!m){for(_=d.child;_;){if(_===i){m=!0,i=d,l=c;break}if(_===l){m=!0,l=d,i=c;break}_=_.sibling}if(!m)throw Error(r(189))}}if(i.alternate!==l)throw Error(r(190))}if(i.tag!==3)throw Error(r(188));return i.stateNode.current===i?e:n}function Cu(e){return e=Vm(e),e!==null?ku(e):null}function ku(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=ku(e);if(n!==null)return n;e=e.sibling}return null}var Nu=t.unstable_scheduleCallback,Su=t.unstable_cancelCallback,Ym=t.unstable_shouldYield,Qm=t.unstable_requestPaint,Xe=t.unstable_now,Gm=t.unstable_getCurrentPriorityLevel,hl=t.unstable_ImmediatePriority,Eu=t.unstable_UserBlockingPriority,wi=t.unstable_NormalPriority,Km=t.unstable_LowPriority,bu=t.unstable_IdlePriority,Ci=null,ln=null;function qm(e){if(ln&&typeof ln.onCommitFiberRoot=="function")try{ln.onCommitFiberRoot(Ci,e,void 0,(e.current.flags&128)===128)}catch{}}var Kt=Math.clz32?Math.clz32:Zm,Xm=Math.log,Jm=Math.LN2;function Zm(e){return e>>>=0,e===0?32:31-(Xm(e)/Jm|0)|0}var ki=64,Ni=4194304;function fs(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Si(e,n){var i=e.pendingLanes;if(i===0)return 0;var l=0,c=e.suspendedLanes,d=e.pingedLanes,m=i&268435455;if(m!==0){var _=m&~c;_!==0?l=fs(_):(d&=m,d!==0&&(l=fs(d)))}else m=i&~c,m!==0?l=fs(m):d!==0&&(l=fs(d));if(l===0)return 0;if(n!==0&&n!==l&&(n&c)===0&&(c=l&-l,d=n&-n,c>=d||c===16&&(d&4194240)!==0))return n;if((l&4)!==0&&(l|=i&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=l;0<n;)i=31-Kt(n),c=1<<i,l|=e[i],n&=~c;return l}function e0(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function t0(e,n){for(var i=e.suspendedLanes,l=e.pingedLanes,c=e.expirationTimes,d=e.pendingLanes;0<d;){var m=31-Kt(d),_=1<<m,k=c[m];k===-1?((_&i)===0||(_&l)!==0)&&(c[m]=e0(_,n)):k<=n&&(e.expiredLanes|=_),d&=~_}}function pl(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Iu(){var e=ki;return ki<<=1,(ki&4194240)===0&&(ki=64),e}function ml(e){for(var n=[],i=0;31>i;i++)n.push(e);return n}function hs(e,n,i){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-Kt(n),e[n]=i}function n0(e,n){var i=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<i;){var c=31-Kt(i),d=1<<c;n[c]=0,l[c]=-1,e[c]=-1,i&=~d}}function gl(e,n){var i=e.entangledLanes|=n;for(e=e.entanglements;i;){var l=31-Kt(i),c=1<<l;c&n|e[l]&n&&(e[l]|=n),i&=~c}}var je=0;function Tu(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var ju,vl,Ru,Pu,Du,xl=!1,Ei=[],Tn=null,jn=null,Rn=null,ps=new Map,ms=new Map,Pn=[],r0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lu(e,n){switch(e){case"focusin":case"focusout":Tn=null;break;case"dragenter":case"dragleave":jn=null;break;case"mouseover":case"mouseout":Rn=null;break;case"pointerover":case"pointerout":ps.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":ms.delete(n.pointerId)}}function gs(e,n,i,l,c,d){return e===null||e.nativeEvent!==d?(e={blockedOn:n,domEventName:i,eventSystemFlags:l,nativeEvent:d,targetContainers:[c]},n!==null&&(n=js(n),n!==null&&vl(n)),e):(e.eventSystemFlags|=l,n=e.targetContainers,c!==null&&n.indexOf(c)===-1&&n.push(c),e)}function s0(e,n,i,l,c){switch(n){case"focusin":return Tn=gs(Tn,e,n,i,l,c),!0;case"dragenter":return jn=gs(jn,e,n,i,l,c),!0;case"mouseover":return Rn=gs(Rn,e,n,i,l,c),!0;case"pointerover":var d=c.pointerId;return ps.set(d,gs(ps.get(d)||null,e,n,i,l,c)),!0;case"gotpointercapture":return d=c.pointerId,ms.set(d,gs(ms.get(d)||null,e,n,i,l,c)),!0}return!1}function Mu(e){var n=sr(e.target);if(n!==null){var i=rr(n);if(i!==null){if(n=i.tag,n===13){if(n=yu(i),n!==null){e.blockedOn=n,Du(e.priority,function(){Ru(i)});return}}else if(n===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function bi(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var i=yl(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var l=new i.constructor(i.type,i);ll=l,i.target.dispatchEvent(l),ll=null}else return n=js(i),n!==null&&vl(n),e.blockedOn=i,!1;n.shift()}return!0}function Au(e,n,i){bi(e)&&i.delete(n)}function i0(){xl=!1,Tn!==null&&bi(Tn)&&(Tn=null),jn!==null&&bi(jn)&&(jn=null),Rn!==null&&bi(Rn)&&(Rn=null),ps.forEach(Au),ms.forEach(Au)}function vs(e,n){e.blockedOn===n&&(e.blockedOn=null,xl||(xl=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,i0)))}function xs(e){function n(c){return vs(c,e)}if(0<Ei.length){vs(Ei[0],e);for(var i=1;i<Ei.length;i++){var l=Ei[i];l.blockedOn===e&&(l.blockedOn=null)}}for(Tn!==null&&vs(Tn,e),jn!==null&&vs(jn,e),Rn!==null&&vs(Rn,e),ps.forEach(n),ms.forEach(n),i=0;i<Pn.length;i++)l=Pn[i],l.blockedOn===e&&(l.blockedOn=null);for(;0<Pn.length&&(i=Pn[0],i.blockedOn===null);)Mu(i),i.blockedOn===null&&Pn.shift()}var br=A.ReactCurrentBatchConfig,Ii=!0;function o0(e,n,i,l){var c=je,d=br.transition;br.transition=null;try{je=1,_l(e,n,i,l)}finally{je=c,br.transition=d}}function l0(e,n,i,l){var c=je,d=br.transition;br.transition=null;try{je=4,_l(e,n,i,l)}finally{je=c,br.transition=d}}function _l(e,n,i,l){if(Ii){var c=yl(e,n,i,l);if(c===null)Ol(e,n,l,Ti,i),Lu(e,l);else if(s0(c,e,n,i,l))l.stopPropagation();else if(Lu(e,l),n&4&&-1<r0.indexOf(e)){for(;c!==null;){var d=js(c);if(d!==null&&ju(d),d=yl(e,n,i,l),d===null&&Ol(e,n,l,Ti,i),d===c)break;c=d}c!==null&&l.stopPropagation()}else Ol(e,n,l,null,i)}}var Ti=null;function yl(e,n,i,l){if(Ti=null,e=al(l),e=sr(e),e!==null)if(n=rr(e),n===null)e=null;else if(i=n.tag,i===13){if(e=yu(n),e!==null)return e;e=null}else if(i===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Ti=e,null}function Ou(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Gm()){case hl:return 1;case Eu:return 4;case wi:case Km:return 16;case bu:return 536870912;default:return 16}default:return 16}}var Dn=null,wl=null,ji=null;function Fu(){if(ji)return ji;var e,n=wl,i=n.length,l,c="value"in Dn?Dn.value:Dn.textContent,d=c.length;for(e=0;e<i&&n[e]===c[e];e++);var m=i-e;for(l=1;l<=m&&n[i-l]===c[d-l];l++);return ji=c.slice(e,1<l?1-l:void 0)}function Ri(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Pi(){return!0}function zu(){return!1}function Ft(e){function n(i,l,c,d,m){this._reactName=i,this._targetInst=c,this.type=l,this.nativeEvent=d,this.target=m,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(i=e[_],this[_]=i?i(d):d[_]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?Pi:zu,this.isPropagationStopped=zu,this}return C(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=Pi)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=Pi)},persist:function(){},isPersistent:Pi}),n}var Ir={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cl=Ft(Ir),_s=C({},Ir,{view:0,detail:0}),a0=Ft(_s),kl,Nl,ys,Di=C({},_s,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:El,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ys&&(ys&&e.type==="mousemove"?(kl=e.screenX-ys.screenX,Nl=e.screenY-ys.screenY):Nl=kl=0,ys=e),kl)},movementY:function(e){return"movementY"in e?e.movementY:Nl}}),Uu=Ft(Di),c0=C({},Di,{dataTransfer:0}),u0=Ft(c0),d0=C({},_s,{relatedTarget:0}),Sl=Ft(d0),f0=C({},Ir,{animationName:0,elapsedTime:0,pseudoElement:0}),h0=Ft(f0),p0=C({},Ir,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),m0=Ft(p0),g0=C({},Ir,{data:0}),Bu=Ft(g0),v0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},x0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function y0(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=_0[e])?!!n[e]:!1}function El(){return y0}var w0=C({},_s,{key:function(e){if(e.key){var n=v0[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Ri(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?x0[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:El,charCode:function(e){return e.type==="keypress"?Ri(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ri(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),C0=Ft(w0),k0=C({},Di,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$u=Ft(k0),N0=C({},_s,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:El}),S0=Ft(N0),E0=C({},Ir,{propertyName:0,elapsedTime:0,pseudoElement:0}),b0=Ft(E0),I0=C({},Di,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),T0=Ft(I0),j0=[9,13,27,32],bl=p&&"CompositionEvent"in window,ws=null;p&&"documentMode"in document&&(ws=document.documentMode);var R0=p&&"TextEvent"in window&&!ws,Wu=p&&(!bl||ws&&8<ws&&11>=ws),Hu=" ",Vu=!1;function Yu(e,n){switch(e){case"keyup":return j0.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qu(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Tr=!1;function P0(e,n){switch(e){case"compositionend":return Qu(n);case"keypress":return n.which!==32?null:(Vu=!0,Hu);case"textInput":return e=n.data,e===Hu&&Vu?null:e;default:return null}}function D0(e,n){if(Tr)return e==="compositionend"||!bl&&Yu(e,n)?(e=Fu(),ji=wl=Dn=null,Tr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Wu&&n.locale!=="ko"?null:n.data;default:return null}}var L0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gu(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!L0[e.type]:n==="textarea"}function Ku(e,n,i,l){mu(l),n=Fi(n,"onChange"),0<n.length&&(i=new Cl("onChange","change",null,i,l),e.push({event:i,listeners:n}))}var Cs=null,ks=null;function M0(e){hd(e,0)}function Li(e){var n=Lr(e);if(fn(n))return e}function A0(e,n){if(e==="change")return n}var qu=!1;if(p){var Il;if(p){var Tl="oninput"in document;if(!Tl){var Xu=document.createElement("div");Xu.setAttribute("oninput","return;"),Tl=typeof Xu.oninput=="function"}Il=Tl}else Il=!1;qu=Il&&(!document.documentMode||9<document.documentMode)}function Ju(){Cs&&(Cs.detachEvent("onpropertychange",Zu),ks=Cs=null)}function Zu(e){if(e.propertyName==="value"&&Li(ks)){var n=[];Ku(n,ks,e,al(e)),_u(M0,n)}}function O0(e,n,i){e==="focusin"?(Ju(),Cs=n,ks=i,Cs.attachEvent("onpropertychange",Zu)):e==="focusout"&&Ju()}function F0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Li(ks)}function z0(e,n){if(e==="click")return Li(n)}function U0(e,n){if(e==="input"||e==="change")return Li(n)}function B0(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var qt=typeof Object.is=="function"?Object.is:B0;function Ns(e,n){if(qt(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var i=Object.keys(e),l=Object.keys(n);if(i.length!==l.length)return!1;for(l=0;l<i.length;l++){var c=i[l];if(!g.call(n,c)||!qt(e[c],n[c]))return!1}return!0}function ed(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function td(e,n){var i=ed(e);e=0;for(var l;i;){if(i.nodeType===3){if(l=e+i.textContent.length,e<=n&&l>=n)return{node:i,offset:n-e};e=l}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ed(i)}}function nd(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?nd(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function rd(){for(var e=window,n=er();n instanceof e.HTMLIFrameElement;){try{var i=typeof n.contentWindow.location.href=="string"}catch{i=!1}if(i)e=n.contentWindow;else break;n=er(e.document)}return n}function jl(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function $0(e){var n=rd(),i=e.focusedElem,l=e.selectionRange;if(n!==i&&i&&i.ownerDocument&&nd(i.ownerDocument.documentElement,i)){if(l!==null&&jl(i)){if(n=l.start,e=l.end,e===void 0&&(e=n),"selectionStart"in i)i.selectionStart=n,i.selectionEnd=Math.min(e,i.value.length);else if(e=(n=i.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var c=i.textContent.length,d=Math.min(l.start,c);l=l.end===void 0?d:Math.min(l.end,c),!e.extend&&d>l&&(c=l,l=d,d=c),c=td(i,d);var m=td(i,l);c&&m&&(e.rangeCount!==1||e.anchorNode!==c.node||e.anchorOffset!==c.offset||e.focusNode!==m.node||e.focusOffset!==m.offset)&&(n=n.createRange(),n.setStart(c.node,c.offset),e.removeAllRanges(),d>l?(e.addRange(n),e.extend(m.node,m.offset)):(n.setEnd(m.node,m.offset),e.addRange(n)))}}for(n=[],e=i;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<n.length;i++)e=n[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var W0=p&&"documentMode"in document&&11>=document.documentMode,jr=null,Rl=null,Ss=null,Pl=!1;function sd(e,n,i){var l=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Pl||jr==null||jr!==er(l)||(l=jr,"selectionStart"in l&&jl(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Ss&&Ns(Ss,l)||(Ss=l,l=Fi(Rl,"onSelect"),0<l.length&&(n=new Cl("onSelect","select",null,n,i),e.push({event:n,listeners:l}),n.target=jr)))}function Mi(e,n){var i={};return i[e.toLowerCase()]=n.toLowerCase(),i["Webkit"+e]="webkit"+n,i["Moz"+e]="moz"+n,i}var Rr={animationend:Mi("Animation","AnimationEnd"),animationiteration:Mi("Animation","AnimationIteration"),animationstart:Mi("Animation","AnimationStart"),transitionend:Mi("Transition","TransitionEnd")},Dl={},id={};p&&(id=document.createElement("div").style,"AnimationEvent"in window||(delete Rr.animationend.animation,delete Rr.animationiteration.animation,delete Rr.animationstart.animation),"TransitionEvent"in window||delete Rr.transitionend.transition);function Ai(e){if(Dl[e])return Dl[e];if(!Rr[e])return e;var n=Rr[e],i;for(i in n)if(n.hasOwnProperty(i)&&i in id)return Dl[e]=n[i];return e}var od=Ai("animationend"),ld=Ai("animationiteration"),ad=Ai("animationstart"),cd=Ai("transitionend"),ud=new Map,dd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ln(e,n){ud.set(e,n),u(n,[e])}for(var Ll=0;Ll<dd.length;Ll++){var Ml=dd[Ll],H0=Ml.toLowerCase(),V0=Ml[0].toUpperCase()+Ml.slice(1);Ln(H0,"on"+V0)}Ln(od,"onAnimationEnd"),Ln(ld,"onAnimationIteration"),Ln(ad,"onAnimationStart"),Ln("dblclick","onDoubleClick"),Ln("focusin","onFocus"),Ln("focusout","onBlur"),Ln(cd,"onTransitionEnd"),h("onMouseEnter",["mouseout","mouseover"]),h("onMouseLeave",["mouseout","mouseover"]),h("onPointerEnter",["pointerout","pointerover"]),h("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Es="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Y0=new Set("cancel close invalid load scroll toggle".split(" ").concat(Es));function fd(e,n,i){var l=e.type||"unknown-event";e.currentTarget=i,Hm(l,n,void 0,e),e.currentTarget=null}function hd(e,n){n=(n&4)!==0;for(var i=0;i<e.length;i++){var l=e[i],c=l.event;l=l.listeners;e:{var d=void 0;if(n)for(var m=l.length-1;0<=m;m--){var _=l[m],k=_.instance,j=_.currentTarget;if(_=_.listener,k!==d&&c.isPropagationStopped())break e;fd(c,_,j),d=k}else for(m=0;m<l.length;m++){if(_=l[m],k=_.instance,j=_.currentTarget,_=_.listener,k!==d&&c.isPropagationStopped())break e;fd(c,_,j),d=k}}}if(yi)throw e=fl,yi=!1,fl=null,e}function Oe(e,n){var i=n[Wl];i===void 0&&(i=n[Wl]=new Set);var l=e+"__bubble";i.has(l)||(pd(n,e,2,!1),i.add(l))}function Al(e,n,i){var l=0;n&&(l|=4),pd(i,e,l,n)}var Oi="_reactListening"+Math.random().toString(36).slice(2);function bs(e){if(!e[Oi]){e[Oi]=!0,o.forEach(function(i){i!=="selectionchange"&&(Y0.has(i)||Al(i,!1,e),Al(i,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Oi]||(n[Oi]=!0,Al("selectionchange",!1,n))}}function pd(e,n,i,l){switch(Ou(n)){case 1:var c=o0;break;case 4:c=l0;break;default:c=_l}i=c.bind(null,n,i,e),c=void 0,!dl||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(c=!0),l?c!==void 0?e.addEventListener(n,i,{capture:!0,passive:c}):e.addEventListener(n,i,!0):c!==void 0?e.addEventListener(n,i,{passive:c}):e.addEventListener(n,i,!1)}function Ol(e,n,i,l,c){var d=l;if((n&1)===0&&(n&2)===0&&l!==null)e:for(;;){if(l===null)return;var m=l.tag;if(m===3||m===4){var _=l.stateNode.containerInfo;if(_===c||_.nodeType===8&&_.parentNode===c)break;if(m===4)for(m=l.return;m!==null;){var k=m.tag;if((k===3||k===4)&&(k=m.stateNode.containerInfo,k===c||k.nodeType===8&&k.parentNode===c))return;m=m.return}for(;_!==null;){if(m=sr(_),m===null)return;if(k=m.tag,k===5||k===6){l=d=m;continue e}_=_.parentNode}}l=l.return}_u(function(){var j=d,O=al(i),F=[];e:{var M=ud.get(e);if(M!==void 0){var Y=Cl,q=e;switch(e){case"keypress":if(Ri(i)===0)break e;case"keydown":case"keyup":Y=C0;break;case"focusin":q="focus",Y=Sl;break;case"focusout":q="blur",Y=Sl;break;case"beforeblur":case"afterblur":Y=Sl;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Y=Uu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Y=u0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Y=S0;break;case od:case ld:case ad:Y=h0;break;case cd:Y=b0;break;case"scroll":Y=a0;break;case"wheel":Y=T0;break;case"copy":case"cut":case"paste":Y=m0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Y=$u}var X=(n&4)!==0,Je=!X&&e==="scroll",E=X?M!==null?M+"Capture":null:M;X=[];for(var N=j,b;N!==null;){b=N;var U=b.stateNode;if(b.tag===5&&U!==null&&(b=U,E!==null&&(U=cs(N,E),U!=null&&X.push(Is(N,U,b)))),Je)break;N=N.return}0<X.length&&(M=new Y(M,q,null,i,O),F.push({event:M,listeners:X}))}}if((n&7)===0){e:{if(M=e==="mouseover"||e==="pointerover",Y=e==="mouseout"||e==="pointerout",M&&i!==ll&&(q=i.relatedTarget||i.fromElement)&&(sr(q)||q[pn]))break e;if((Y||M)&&(M=O.window===O?O:(M=O.ownerDocument)?M.defaultView||M.parentWindow:window,Y?(q=i.relatedTarget||i.toElement,Y=j,q=q?sr(q):null,q!==null&&(Je=rr(q),q!==Je||q.tag!==5&&q.tag!==6)&&(q=null)):(Y=null,q=j),Y!==q)){if(X=Uu,U="onMouseLeave",E="onMouseEnter",N="mouse",(e==="pointerout"||e==="pointerover")&&(X=$u,U="onPointerLeave",E="onPointerEnter",N="pointer"),Je=Y==null?M:Lr(Y),b=q==null?M:Lr(q),M=new X(U,N+"leave",Y,i,O),M.target=Je,M.relatedTarget=b,U=null,sr(O)===j&&(X=new X(E,N+"enter",q,i,O),X.target=b,X.relatedTarget=Je,U=X),Je=U,Y&&q)t:{for(X=Y,E=q,N=0,b=X;b;b=Pr(b))N++;for(b=0,U=E;U;U=Pr(U))b++;for(;0<N-b;)X=Pr(X),N--;for(;0<b-N;)E=Pr(E),b--;for(;N--;){if(X===E||E!==null&&X===E.alternate)break t;X=Pr(X),E=Pr(E)}X=null}else X=null;Y!==null&&md(F,M,Y,X,!1),q!==null&&Je!==null&&md(F,Je,q,X,!0)}}e:{if(M=j?Lr(j):window,Y=M.nodeName&&M.nodeName.toLowerCase(),Y==="select"||Y==="input"&&M.type==="file")var ee=A0;else if(Gu(M))if(qu)ee=U0;else{ee=F0;var re=O0}else(Y=M.nodeName)&&Y.toLowerCase()==="input"&&(M.type==="checkbox"||M.type==="radio")&&(ee=z0);if(ee&&(ee=ee(e,j))){Ku(F,ee,i,O);break e}re&&re(e,M,j),e==="focusout"&&(re=M._wrapperState)&&re.controlled&&M.type==="number"&&be(M,"number",M.value)}switch(re=j?Lr(j):window,e){case"focusin":(Gu(re)||re.contentEditable==="true")&&(jr=re,Rl=j,Ss=null);break;case"focusout":Ss=Rl=jr=null;break;case"mousedown":Pl=!0;break;case"contextmenu":case"mouseup":case"dragend":Pl=!1,sd(F,i,O);break;case"selectionchange":if(W0)break;case"keydown":case"keyup":sd(F,i,O)}var se;if(bl)e:{switch(e){case"compositionstart":var ce="onCompositionStart";break e;case"compositionend":ce="onCompositionEnd";break e;case"compositionupdate":ce="onCompositionUpdate";break e}ce=void 0}else Tr?Yu(e,i)&&(ce="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(ce="onCompositionStart");ce&&(Wu&&i.locale!=="ko"&&(Tr||ce!=="onCompositionStart"?ce==="onCompositionEnd"&&Tr&&(se=Fu()):(Dn=O,wl="value"in Dn?Dn.value:Dn.textContent,Tr=!0)),re=Fi(j,ce),0<re.length&&(ce=new Bu(ce,e,null,i,O),F.push({event:ce,listeners:re}),se?ce.data=se:(se=Qu(i),se!==null&&(ce.data=se)))),(se=R0?P0(e,i):D0(e,i))&&(j=Fi(j,"onBeforeInput"),0<j.length&&(O=new Bu("onBeforeInput","beforeinput",null,i,O),F.push({event:O,listeners:j}),O.data=se))}hd(F,n)})}function Is(e,n,i){return{instance:e,listener:n,currentTarget:i}}function Fi(e,n){for(var i=n+"Capture",l=[];e!==null;){var c=e,d=c.stateNode;c.tag===5&&d!==null&&(c=d,d=cs(e,i),d!=null&&l.unshift(Is(e,d,c)),d=cs(e,n),d!=null&&l.push(Is(e,d,c))),e=e.return}return l}function Pr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function md(e,n,i,l,c){for(var d=n._reactName,m=[];i!==null&&i!==l;){var _=i,k=_.alternate,j=_.stateNode;if(k!==null&&k===l)break;_.tag===5&&j!==null&&(_=j,c?(k=cs(i,d),k!=null&&m.unshift(Is(i,k,_))):c||(k=cs(i,d),k!=null&&m.push(Is(i,k,_)))),i=i.return}m.length!==0&&e.push({event:n,listeners:m})}var Q0=/\r\n?/g,G0=/\u0000|\uFFFD/g;function gd(e){return(typeof e=="string"?e:""+e).replace(Q0,`
`).replace(G0,"")}function zi(e,n,i){if(n=gd(n),gd(e)!==n&&i)throw Error(r(425))}function Ui(){}var Fl=null,zl=null;function Ul(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Bl=typeof setTimeout=="function"?setTimeout:void 0,K0=typeof clearTimeout=="function"?clearTimeout:void 0,vd=typeof Promise=="function"?Promise:void 0,q0=typeof queueMicrotask=="function"?queueMicrotask:typeof vd<"u"?function(e){return vd.resolve(null).then(e).catch(X0)}:Bl;function X0(e){setTimeout(function(){throw e})}function $l(e,n){var i=n,l=0;do{var c=i.nextSibling;if(e.removeChild(i),c&&c.nodeType===8)if(i=c.data,i==="/$"){if(l===0){e.removeChild(c),xs(n);return}l--}else i!=="$"&&i!=="$?"&&i!=="$!"||l++;i=c}while(i);xs(n)}function Mn(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function xd(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(n===0)return e;n--}else i==="/$"&&n++}e=e.previousSibling}return null}var Dr=Math.random().toString(36).slice(2),an="__reactFiber$"+Dr,Ts="__reactProps$"+Dr,pn="__reactContainer$"+Dr,Wl="__reactEvents$"+Dr,J0="__reactListeners$"+Dr,Z0="__reactHandles$"+Dr;function sr(e){var n=e[an];if(n)return n;for(var i=e.parentNode;i;){if(n=i[pn]||i[an]){if(i=n.alternate,n.child!==null||i!==null&&i.child!==null)for(e=xd(e);e!==null;){if(i=e[an])return i;e=xd(e)}return n}e=i,i=e.parentNode}return null}function js(e){return e=e[an]||e[pn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Lr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(r(33))}function Bi(e){return e[Ts]||null}var Hl=[],Mr=-1;function An(e){return{current:e}}function Fe(e){0>Mr||(e.current=Hl[Mr],Hl[Mr]=null,Mr--)}function Le(e,n){Mr++,Hl[Mr]=e.current,e.current=n}var On={},_t=An(On),bt=An(!1),ir=On;function Ar(e,n){var i=e.type.contextTypes;if(!i)return On;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===n)return l.__reactInternalMemoizedMaskedChildContext;var c={},d;for(d in i)c[d]=n[d];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=c),c}function It(e){return e=e.childContextTypes,e!=null}function $i(){Fe(bt),Fe(_t)}function _d(e,n,i){if(_t.current!==On)throw Error(r(168));Le(_t,n),Le(bt,i)}function yd(e,n,i){var l=e.stateNode;if(n=n.childContextTypes,typeof l.getChildContext!="function")return i;l=l.getChildContext();for(var c in l)if(!(c in n))throw Error(r(108,ke(e)||"Unknown",c));return C({},i,l)}function Wi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||On,ir=_t.current,Le(_t,e),Le(bt,bt.current),!0}function wd(e,n,i){var l=e.stateNode;if(!l)throw Error(r(169));i?(e=yd(e,n,ir),l.__reactInternalMemoizedMergedChildContext=e,Fe(bt),Fe(_t),Le(_t,e)):Fe(bt),Le(bt,i)}var mn=null,Hi=!1,Vl=!1;function Cd(e){mn===null?mn=[e]:mn.push(e)}function eg(e){Hi=!0,Cd(e)}function Fn(){if(!Vl&&mn!==null){Vl=!0;var e=0,n=je;try{var i=mn;for(je=1;e<i.length;e++){var l=i[e];do l=l(!0);while(l!==null)}mn=null,Hi=!1}catch(c){throw mn!==null&&(mn=mn.slice(e+1)),Nu(hl,Fn),c}finally{je=n,Vl=!1}}return null}var Or=[],Fr=0,Vi=null,Yi=0,$t=[],Wt=0,or=null,gn=1,vn="";function lr(e,n){Or[Fr++]=Yi,Or[Fr++]=Vi,Vi=e,Yi=n}function kd(e,n,i){$t[Wt++]=gn,$t[Wt++]=vn,$t[Wt++]=or,or=e;var l=gn;e=vn;var c=32-Kt(l)-1;l&=~(1<<c),i+=1;var d=32-Kt(n)+c;if(30<d){var m=c-c%5;d=(l&(1<<m)-1).toString(32),l>>=m,c-=m,gn=1<<32-Kt(n)+c|i<<c|l,vn=d+e}else gn=1<<d|i<<c|l,vn=e}function Yl(e){e.return!==null&&(lr(e,1),kd(e,1,0))}function Ql(e){for(;e===Vi;)Vi=Or[--Fr],Or[Fr]=null,Yi=Or[--Fr],Or[Fr]=null;for(;e===or;)or=$t[--Wt],$t[Wt]=null,vn=$t[--Wt],$t[Wt]=null,gn=$t[--Wt],$t[Wt]=null}var zt=null,Ut=null,Be=!1,Xt=null;function Nd(e,n){var i=Qt(5,null,null,0);i.elementType="DELETED",i.stateNode=n,i.return=e,n=e.deletions,n===null?(e.deletions=[i],e.flags|=16):n.push(i)}function Sd(e,n){switch(e.tag){case 5:var i=e.type;return n=n.nodeType!==1||i.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,zt=e,Ut=Mn(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,zt=e,Ut=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(i=or!==null?{id:gn,overflow:vn}:null,e.memoizedState={dehydrated:n,treeContext:i,retryLane:1073741824},i=Qt(18,null,null,0),i.stateNode=n,i.return=e,e.child=i,zt=e,Ut=null,!0):!1;default:return!1}}function Gl(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Kl(e){if(Be){var n=Ut;if(n){var i=n;if(!Sd(e,n)){if(Gl(e))throw Error(r(418));n=Mn(i.nextSibling);var l=zt;n&&Sd(e,n)?Nd(l,i):(e.flags=e.flags&-4097|2,Be=!1,zt=e)}}else{if(Gl(e))throw Error(r(418));e.flags=e.flags&-4097|2,Be=!1,zt=e}}}function Ed(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;zt=e}function Qi(e){if(e!==zt)return!1;if(!Be)return Ed(e),Be=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!Ul(e.type,e.memoizedProps)),n&&(n=Ut)){if(Gl(e))throw bd(),Error(r(418));for(;n;)Nd(e,n),n=Mn(n.nextSibling)}if(Ed(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(r(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(n===0){Ut=Mn(e.nextSibling);break e}n--}else i!=="$"&&i!=="$!"&&i!=="$?"||n++}e=e.nextSibling}Ut=null}}else Ut=zt?Mn(e.stateNode.nextSibling):null;return!0}function bd(){for(var e=Ut;e;)e=Mn(e.nextSibling)}function zr(){Ut=zt=null,Be=!1}function ql(e){Xt===null?Xt=[e]:Xt.push(e)}var tg=A.ReactCurrentBatchConfig;function Jt(e,n){if(e&&e.defaultProps){n=C({},n),e=e.defaultProps;for(var i in e)n[i]===void 0&&(n[i]=e[i]);return n}return n}var Gi=An(null),Ki=null,Ur=null,Xl=null;function Jl(){Xl=Ur=Ki=null}function Zl(e){var n=Gi.current;Fe(Gi),e._currentValue=n}function ea(e,n,i){for(;e!==null;){var l=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,l!==null&&(l.childLanes|=n)):l!==null&&(l.childLanes&n)!==n&&(l.childLanes|=n),e===i)break;e=e.return}}function Br(e,n){Ki=e,Xl=Ur=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&n)!==0&&(Tt=!0),e.firstContext=null)}function Ht(e){var n=e._currentValue;if(Xl!==e)if(e={context:e,memoizedValue:n,next:null},Ur===null){if(Ki===null)throw Error(r(308));Ur=e,Ki.dependencies={lanes:0,firstContext:e}}else Ur=Ur.next=e;return n}var ar=null;function ta(e){ar===null?ar=[e]:ar.push(e)}function Id(e,n,i,l){var c=n.interleaved;return c===null?(i.next=i,ta(n)):(i.next=c.next,c.next=i),n.interleaved=i,xn(e,l)}function xn(e,n){e.lanes|=n;var i=e.alternate;for(i!==null&&(i.lanes|=n),i=e,e=e.return;e!==null;)e.childLanes|=n,i=e.alternate,i!==null&&(i.childLanes|=n),i=e,e=e.return;return i.tag===3?i.stateNode:null}var zn=!1;function na(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Td(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function _n(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function Un(e,n,i){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(Ne&2)!==0){var c=l.pending;return c===null?n.next=n:(n.next=c.next,c.next=n),l.pending=n,xn(e,i)}return c=l.interleaved,c===null?(n.next=n,ta(l)):(n.next=c.next,c.next=n),l.interleaved=n,xn(e,i)}function qi(e,n,i){if(n=n.updateQueue,n!==null&&(n=n.shared,(i&4194240)!==0)){var l=n.lanes;l&=e.pendingLanes,i|=l,n.lanes=i,gl(e,i)}}function jd(e,n){var i=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,i===l)){var c=null,d=null;if(i=i.firstBaseUpdate,i!==null){do{var m={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};d===null?c=d=m:d=d.next=m,i=i.next}while(i!==null);d===null?c=d=n:d=d.next=n}else c=d=n;i={baseState:l.baseState,firstBaseUpdate:c,lastBaseUpdate:d,shared:l.shared,effects:l.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=n:e.next=n,i.lastBaseUpdate=n}function Xi(e,n,i,l){var c=e.updateQueue;zn=!1;var d=c.firstBaseUpdate,m=c.lastBaseUpdate,_=c.shared.pending;if(_!==null){c.shared.pending=null;var k=_,j=k.next;k.next=null,m===null?d=j:m.next=j,m=k;var O=e.alternate;O!==null&&(O=O.updateQueue,_=O.lastBaseUpdate,_!==m&&(_===null?O.firstBaseUpdate=j:_.next=j,O.lastBaseUpdate=k))}if(d!==null){var F=c.baseState;m=0,O=j=k=null,_=d;do{var M=_.lane,Y=_.eventTime;if((l&M)===M){O!==null&&(O=O.next={eventTime:Y,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});e:{var q=e,X=_;switch(M=n,Y=i,X.tag){case 1:if(q=X.payload,typeof q=="function"){F=q.call(Y,F,M);break e}F=q;break e;case 3:q.flags=q.flags&-65537|128;case 0:if(q=X.payload,M=typeof q=="function"?q.call(Y,F,M):q,M==null)break e;F=C({},F,M);break e;case 2:zn=!0}}_.callback!==null&&_.lane!==0&&(e.flags|=64,M=c.effects,M===null?c.effects=[_]:M.push(_))}else Y={eventTime:Y,lane:M,tag:_.tag,payload:_.payload,callback:_.callback,next:null},O===null?(j=O=Y,k=F):O=O.next=Y,m|=M;if(_=_.next,_===null){if(_=c.shared.pending,_===null)break;M=_,_=M.next,M.next=null,c.lastBaseUpdate=M,c.shared.pending=null}}while(!0);if(O===null&&(k=F),c.baseState=k,c.firstBaseUpdate=j,c.lastBaseUpdate=O,n=c.shared.interleaved,n!==null){c=n;do m|=c.lane,c=c.next;while(c!==n)}else d===null&&(c.shared.lanes=0);dr|=m,e.lanes=m,e.memoizedState=F}}function Rd(e,n,i){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var l=e[n],c=l.callback;if(c!==null){if(l.callback=null,l=i,typeof c!="function")throw Error(r(191,c));c.call(l)}}}var Pd=new s.Component().refs;function ra(e,n,i,l){n=e.memoizedState,i=i(l,n),i=i==null?n:C({},n,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var Ji={isMounted:function(e){return(e=e._reactInternals)?rr(e)===e:!1},enqueueSetState:function(e,n,i){e=e._reactInternals;var l=Et(),c=Hn(e),d=_n(l,c);d.payload=n,i!=null&&(d.callback=i),n=Un(e,d,c),n!==null&&(tn(n,e,c,l),qi(n,e,c))},enqueueReplaceState:function(e,n,i){e=e._reactInternals;var l=Et(),c=Hn(e),d=_n(l,c);d.tag=1,d.payload=n,i!=null&&(d.callback=i),n=Un(e,d,c),n!==null&&(tn(n,e,c,l),qi(n,e,c))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var i=Et(),l=Hn(e),c=_n(i,l);c.tag=2,n!=null&&(c.callback=n),n=Un(e,c,l),n!==null&&(tn(n,e,l,i),qi(n,e,l))}};function Dd(e,n,i,l,c,d,m){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,d,m):n.prototype&&n.prototype.isPureReactComponent?!Ns(i,l)||!Ns(c,d):!0}function Ld(e,n,i){var l=!1,c=On,d=n.contextType;return typeof d=="object"&&d!==null?d=Ht(d):(c=It(n)?ir:_t.current,l=n.contextTypes,d=(l=l!=null)?Ar(e,c):On),n=new n(i,d),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=Ji,e.stateNode=n,n._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=c,e.__reactInternalMemoizedMaskedChildContext=d),n}function Md(e,n,i,l){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(i,l),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(i,l),n.state!==e&&Ji.enqueueReplaceState(n,n.state,null)}function sa(e,n,i,l){var c=e.stateNode;c.props=i,c.state=e.memoizedState,c.refs=Pd,na(e);var d=n.contextType;typeof d=="object"&&d!==null?c.context=Ht(d):(d=It(n)?ir:_t.current,c.context=Ar(e,d)),c.state=e.memoizedState,d=n.getDerivedStateFromProps,typeof d=="function"&&(ra(e,n,d,i),c.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(n=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),n!==c.state&&Ji.enqueueReplaceState(c,c.state,null),Xi(e,i,c,l),c.state=e.memoizedState),typeof c.componentDidMount=="function"&&(e.flags|=4194308)}function Rs(e,n,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(r(309));var l=i.stateNode}if(!l)throw Error(r(147,e));var c=l,d=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===d?n.ref:(n=function(m){var _=c.refs;_===Pd&&(_=c.refs={}),m===null?delete _[d]:_[d]=m},n._stringRef=d,n)}if(typeof e!="string")throw Error(r(284));if(!i._owner)throw Error(r(290,e))}return e}function Zi(e,n){throw e=Object.prototype.toString.call(n),Error(r(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function Ad(e){var n=e._init;return n(e._payload)}function Od(e){function n(E,N){if(e){var b=E.deletions;b===null?(E.deletions=[N],E.flags|=16):b.push(N)}}function i(E,N){if(!e)return null;for(;N!==null;)n(E,N),N=N.sibling;return null}function l(E,N){for(E=new Map;N!==null;)N.key!==null?E.set(N.key,N):E.set(N.index,N),N=N.sibling;return E}function c(E,N){return E=Yn(E,N),E.index=0,E.sibling=null,E}function d(E,N,b){return E.index=b,e?(b=E.alternate,b!==null?(b=b.index,b<N?(E.flags|=2,N):b):(E.flags|=2,N)):(E.flags|=1048576,N)}function m(E){return e&&E.alternate===null&&(E.flags|=2),E}function _(E,N,b,U){return N===null||N.tag!==6?(N=Ba(b,E.mode,U),N.return=E,N):(N=c(N,b),N.return=E,N)}function k(E,N,b,U){var ee=b.type;return ee===z?O(E,N,b.props.children,U,b.key):N!==null&&(N.elementType===ee||typeof ee=="object"&&ee!==null&&ee.$$typeof===Ze&&Ad(ee)===N.type)?(U=c(N,b.props),U.ref=Rs(E,N,b),U.return=E,U):(U=_o(b.type,b.key,b.props,null,E.mode,U),U.ref=Rs(E,N,b),U.return=E,U)}function j(E,N,b,U){return N===null||N.tag!==4||N.stateNode.containerInfo!==b.containerInfo||N.stateNode.implementation!==b.implementation?(N=$a(b,E.mode,U),N.return=E,N):(N=c(N,b.children||[]),N.return=E,N)}function O(E,N,b,U,ee){return N===null||N.tag!==7?(N=mr(b,E.mode,U,ee),N.return=E,N):(N=c(N,b),N.return=E,N)}function F(E,N,b){if(typeof N=="string"&&N!==""||typeof N=="number")return N=Ba(""+N,E.mode,b),N.return=E,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case $e:return b=_o(N.type,N.key,N.props,null,E.mode,b),b.ref=Rs(E,null,N),b.return=E,b;case H:return N=$a(N,E.mode,b),N.return=E,N;case Ze:var U=N._init;return F(E,U(N._payload),b)}if(pe(N)||Z(N))return N=mr(N,E.mode,b,null),N.return=E,N;Zi(E,N)}return null}function M(E,N,b,U){var ee=N!==null?N.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return ee!==null?null:_(E,N,""+b,U);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case $e:return b.key===ee?k(E,N,b,U):null;case H:return b.key===ee?j(E,N,b,U):null;case Ze:return ee=b._init,M(E,N,ee(b._payload),U)}if(pe(b)||Z(b))return ee!==null?null:O(E,N,b,U,null);Zi(E,b)}return null}function Y(E,N,b,U,ee){if(typeof U=="string"&&U!==""||typeof U=="number")return E=E.get(b)||null,_(N,E,""+U,ee);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case $e:return E=E.get(U.key===null?b:U.key)||null,k(N,E,U,ee);case H:return E=E.get(U.key===null?b:U.key)||null,j(N,E,U,ee);case Ze:var re=U._init;return Y(E,N,b,re(U._payload),ee)}if(pe(U)||Z(U))return E=E.get(b)||null,O(N,E,U,ee,null);Zi(N,U)}return null}function q(E,N,b,U){for(var ee=null,re=null,se=N,ce=N=0,ut=null;se!==null&&ce<b.length;ce++){se.index>ce?(ut=se,se=null):ut=se.sibling;var Ee=M(E,se,b[ce],U);if(Ee===null){se===null&&(se=ut);break}e&&se&&Ee.alternate===null&&n(E,se),N=d(Ee,N,ce),re===null?ee=Ee:re.sibling=Ee,re=Ee,se=ut}if(ce===b.length)return i(E,se),Be&&lr(E,ce),ee;if(se===null){for(;ce<b.length;ce++)se=F(E,b[ce],U),se!==null&&(N=d(se,N,ce),re===null?ee=se:re.sibling=se,re=se);return Be&&lr(E,ce),ee}for(se=l(E,se);ce<b.length;ce++)ut=Y(se,E,ce,b[ce],U),ut!==null&&(e&&ut.alternate!==null&&se.delete(ut.key===null?ce:ut.key),N=d(ut,N,ce),re===null?ee=ut:re.sibling=ut,re=ut);return e&&se.forEach(function(Qn){return n(E,Qn)}),Be&&lr(E,ce),ee}function X(E,N,b,U){var ee=Z(b);if(typeof ee!="function")throw Error(r(150));if(b=ee.call(b),b==null)throw Error(r(151));for(var re=ee=null,se=N,ce=N=0,ut=null,Ee=b.next();se!==null&&!Ee.done;ce++,Ee=b.next()){se.index>ce?(ut=se,se=null):ut=se.sibling;var Qn=M(E,se,Ee.value,U);if(Qn===null){se===null&&(se=ut);break}e&&se&&Qn.alternate===null&&n(E,se),N=d(Qn,N,ce),re===null?ee=Qn:re.sibling=Qn,re=Qn,se=ut}if(Ee.done)return i(E,se),Be&&lr(E,ce),ee;if(se===null){for(;!Ee.done;ce++,Ee=b.next())Ee=F(E,Ee.value,U),Ee!==null&&(N=d(Ee,N,ce),re===null?ee=Ee:re.sibling=Ee,re=Ee);return Be&&lr(E,ce),ee}for(se=l(E,se);!Ee.done;ce++,Ee=b.next())Ee=Y(se,E,ce,Ee.value,U),Ee!==null&&(e&&Ee.alternate!==null&&se.delete(Ee.key===null?ce:Ee.key),N=d(Ee,N,ce),re===null?ee=Ee:re.sibling=Ee,re=Ee);return e&&se.forEach(function(Lg){return n(E,Lg)}),Be&&lr(E,ce),ee}function Je(E,N,b,U){if(typeof b=="object"&&b!==null&&b.type===z&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case $e:e:{for(var ee=b.key,re=N;re!==null;){if(re.key===ee){if(ee=b.type,ee===z){if(re.tag===7){i(E,re.sibling),N=c(re,b.props.children),N.return=E,E=N;break e}}else if(re.elementType===ee||typeof ee=="object"&&ee!==null&&ee.$$typeof===Ze&&Ad(ee)===re.type){i(E,re.sibling),N=c(re,b.props),N.ref=Rs(E,re,b),N.return=E,E=N;break e}i(E,re);break}else n(E,re);re=re.sibling}b.type===z?(N=mr(b.props.children,E.mode,U,b.key),N.return=E,E=N):(U=_o(b.type,b.key,b.props,null,E.mode,U),U.ref=Rs(E,N,b),U.return=E,E=U)}return m(E);case H:e:{for(re=b.key;N!==null;){if(N.key===re)if(N.tag===4&&N.stateNode.containerInfo===b.containerInfo&&N.stateNode.implementation===b.implementation){i(E,N.sibling),N=c(N,b.children||[]),N.return=E,E=N;break e}else{i(E,N);break}else n(E,N);N=N.sibling}N=$a(b,E.mode,U),N.return=E,E=N}return m(E);case Ze:return re=b._init,Je(E,N,re(b._payload),U)}if(pe(b))return q(E,N,b,U);if(Z(b))return X(E,N,b,U);Zi(E,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,N!==null&&N.tag===6?(i(E,N.sibling),N=c(N,b),N.return=E,E=N):(i(E,N),N=Ba(b,E.mode,U),N.return=E,E=N),m(E)):i(E,N)}return Je}var $r=Od(!0),Fd=Od(!1),Ps={},cn=An(Ps),Ds=An(Ps),Ls=An(Ps);function cr(e){if(e===Ps)throw Error(r(174));return e}function ia(e,n){switch(Le(Ls,n),Le(Ds,e),Le(cn,Ps),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:Ce(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=Ce(n,e)}Fe(cn),Le(cn,n)}function Wr(){Fe(cn),Fe(Ds),Fe(Ls)}function zd(e){cr(Ls.current);var n=cr(cn.current),i=Ce(n,e.type);n!==i&&(Le(Ds,e),Le(cn,i))}function oa(e){Ds.current===e&&(Fe(cn),Fe(Ds))}var Ve=An(0);function eo(e){for(var n=e;n!==null;){if(n.tag===13){var i=n.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var la=[];function aa(){for(var e=0;e<la.length;e++)la[e]._workInProgressVersionPrimary=null;la.length=0}var to=A.ReactCurrentDispatcher,ca=A.ReactCurrentBatchConfig,ur=0,Ye=null,it=null,at=null,no=!1,Ms=!1,As=0,ng=0;function yt(){throw Error(r(321))}function ua(e,n){if(n===null)return!1;for(var i=0;i<n.length&&i<e.length;i++)if(!qt(e[i],n[i]))return!1;return!0}function da(e,n,i,l,c,d){if(ur=d,Ye=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,to.current=e===null||e.memoizedState===null?og:lg,e=i(l,c),Ms){d=0;do{if(Ms=!1,As=0,25<=d)throw Error(r(301));d+=1,at=it=null,n.updateQueue=null,to.current=ag,e=i(l,c)}while(Ms)}if(to.current=io,n=it!==null&&it.next!==null,ur=0,at=it=Ye=null,no=!1,n)throw Error(r(300));return e}function fa(){var e=As!==0;return As=0,e}function un(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return at===null?Ye.memoizedState=at=e:at=at.next=e,at}function Vt(){if(it===null){var e=Ye.alternate;e=e!==null?e.memoizedState:null}else e=it.next;var n=at===null?Ye.memoizedState:at.next;if(n!==null)at=n,it=e;else{if(e===null)throw Error(r(310));it=e,e={memoizedState:it.memoizedState,baseState:it.baseState,baseQueue:it.baseQueue,queue:it.queue,next:null},at===null?Ye.memoizedState=at=e:at=at.next=e}return at}function Os(e,n){return typeof n=="function"?n(e):n}function ha(e){var n=Vt(),i=n.queue;if(i===null)throw Error(r(311));i.lastRenderedReducer=e;var l=it,c=l.baseQueue,d=i.pending;if(d!==null){if(c!==null){var m=c.next;c.next=d.next,d.next=m}l.baseQueue=c=d,i.pending=null}if(c!==null){d=c.next,l=l.baseState;var _=m=null,k=null,j=d;do{var O=j.lane;if((ur&O)===O)k!==null&&(k=k.next={lane:0,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null}),l=j.hasEagerState?j.eagerState:e(l,j.action);else{var F={lane:O,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null};k===null?(_=k=F,m=l):k=k.next=F,Ye.lanes|=O,dr|=O}j=j.next}while(j!==null&&j!==d);k===null?m=l:k.next=_,qt(l,n.memoizedState)||(Tt=!0),n.memoizedState=l,n.baseState=m,n.baseQueue=k,i.lastRenderedState=l}if(e=i.interleaved,e!==null){c=e;do d=c.lane,Ye.lanes|=d,dr|=d,c=c.next;while(c!==e)}else c===null&&(i.lanes=0);return[n.memoizedState,i.dispatch]}function pa(e){var n=Vt(),i=n.queue;if(i===null)throw Error(r(311));i.lastRenderedReducer=e;var l=i.dispatch,c=i.pending,d=n.memoizedState;if(c!==null){i.pending=null;var m=c=c.next;do d=e(d,m.action),m=m.next;while(m!==c);qt(d,n.memoizedState)||(Tt=!0),n.memoizedState=d,n.baseQueue===null&&(n.baseState=d),i.lastRenderedState=d}return[d,l]}function Ud(){}function Bd(e,n){var i=Ye,l=Vt(),c=n(),d=!qt(l.memoizedState,c);if(d&&(l.memoizedState=c,Tt=!0),l=l.queue,ma(Hd.bind(null,i,l,e),[e]),l.getSnapshot!==n||d||at!==null&&at.memoizedState.tag&1){if(i.flags|=2048,Fs(9,Wd.bind(null,i,l,c,n),void 0,null),ct===null)throw Error(r(349));(ur&30)!==0||$d(i,n,c)}return c}function $d(e,n,i){e.flags|=16384,e={getSnapshot:n,value:i},n=Ye.updateQueue,n===null?(n={lastEffect:null,stores:null},Ye.updateQueue=n,n.stores=[e]):(i=n.stores,i===null?n.stores=[e]:i.push(e))}function Wd(e,n,i,l){n.value=i,n.getSnapshot=l,Vd(n)&&Yd(e)}function Hd(e,n,i){return i(function(){Vd(n)&&Yd(e)})}function Vd(e){var n=e.getSnapshot;e=e.value;try{var i=n();return!qt(e,i)}catch{return!0}}function Yd(e){var n=xn(e,1);n!==null&&tn(n,e,1,-1)}function Qd(e){var n=un();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Os,lastRenderedState:e},n.queue=e,e=e.dispatch=ig.bind(null,Ye,e),[n.memoizedState,e]}function Fs(e,n,i,l){return e={tag:e,create:n,destroy:i,deps:l,next:null},n=Ye.updateQueue,n===null?(n={lastEffect:null,stores:null},Ye.updateQueue=n,n.lastEffect=e.next=e):(i=n.lastEffect,i===null?n.lastEffect=e.next=e:(l=i.next,i.next=e,e.next=l,n.lastEffect=e)),e}function Gd(){return Vt().memoizedState}function ro(e,n,i,l){var c=un();Ye.flags|=e,c.memoizedState=Fs(1|n,i,void 0,l===void 0?null:l)}function so(e,n,i,l){var c=Vt();l=l===void 0?null:l;var d=void 0;if(it!==null){var m=it.memoizedState;if(d=m.destroy,l!==null&&ua(l,m.deps)){c.memoizedState=Fs(n,i,d,l);return}}Ye.flags|=e,c.memoizedState=Fs(1|n,i,d,l)}function Kd(e,n){return ro(8390656,8,e,n)}function ma(e,n){return so(2048,8,e,n)}function qd(e,n){return so(4,2,e,n)}function Xd(e,n){return so(4,4,e,n)}function Jd(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function Zd(e,n,i){return i=i!=null?i.concat([e]):null,so(4,4,Jd.bind(null,n,e),i)}function ga(){}function ef(e,n){var i=Vt();n=n===void 0?null:n;var l=i.memoizedState;return l!==null&&n!==null&&ua(n,l[1])?l[0]:(i.memoizedState=[e,n],e)}function tf(e,n){var i=Vt();n=n===void 0?null:n;var l=i.memoizedState;return l!==null&&n!==null&&ua(n,l[1])?l[0]:(e=e(),i.memoizedState=[e,n],e)}function nf(e,n,i){return(ur&21)===0?(e.baseState&&(e.baseState=!1,Tt=!0),e.memoizedState=i):(qt(i,n)||(i=Iu(),Ye.lanes|=i,dr|=i,e.baseState=!0),n)}function rg(e,n){var i=je;je=i!==0&&4>i?i:4,e(!0);var l=ca.transition;ca.transition={};try{e(!1),n()}finally{je=i,ca.transition=l}}function rf(){return Vt().memoizedState}function sg(e,n,i){var l=Hn(e);if(i={lane:l,action:i,hasEagerState:!1,eagerState:null,next:null},sf(e))of(n,i);else if(i=Id(e,n,i,l),i!==null){var c=Et();tn(i,e,l,c),lf(i,n,l)}}function ig(e,n,i){var l=Hn(e),c={lane:l,action:i,hasEagerState:!1,eagerState:null,next:null};if(sf(e))of(n,c);else{var d=e.alternate;if(e.lanes===0&&(d===null||d.lanes===0)&&(d=n.lastRenderedReducer,d!==null))try{var m=n.lastRenderedState,_=d(m,i);if(c.hasEagerState=!0,c.eagerState=_,qt(_,m)){var k=n.interleaved;k===null?(c.next=c,ta(n)):(c.next=k.next,k.next=c),n.interleaved=c;return}}catch{}finally{}i=Id(e,n,c,l),i!==null&&(c=Et(),tn(i,e,l,c),lf(i,n,l))}}function sf(e){var n=e.alternate;return e===Ye||n!==null&&n===Ye}function of(e,n){Ms=no=!0;var i=e.pending;i===null?n.next=n:(n.next=i.next,i.next=n),e.pending=n}function lf(e,n,i){if((i&4194240)!==0){var l=n.lanes;l&=e.pendingLanes,i|=l,n.lanes=i,gl(e,i)}}var io={readContext:Ht,useCallback:yt,useContext:yt,useEffect:yt,useImperativeHandle:yt,useInsertionEffect:yt,useLayoutEffect:yt,useMemo:yt,useReducer:yt,useRef:yt,useState:yt,useDebugValue:yt,useDeferredValue:yt,useTransition:yt,useMutableSource:yt,useSyncExternalStore:yt,useId:yt,unstable_isNewReconciler:!1},og={readContext:Ht,useCallback:function(e,n){return un().memoizedState=[e,n===void 0?null:n],e},useContext:Ht,useEffect:Kd,useImperativeHandle:function(e,n,i){return i=i!=null?i.concat([e]):null,ro(4194308,4,Jd.bind(null,n,e),i)},useLayoutEffect:function(e,n){return ro(4194308,4,e,n)},useInsertionEffect:function(e,n){return ro(4,2,e,n)},useMemo:function(e,n){var i=un();return n=n===void 0?null:n,e=e(),i.memoizedState=[e,n],e},useReducer:function(e,n,i){var l=un();return n=i!==void 0?i(n):n,l.memoizedState=l.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},l.queue=e,e=e.dispatch=sg.bind(null,Ye,e),[l.memoizedState,e]},useRef:function(e){var n=un();return e={current:e},n.memoizedState=e},useState:Qd,useDebugValue:ga,useDeferredValue:function(e){return un().memoizedState=e},useTransition:function(){var e=Qd(!1),n=e[0];return e=rg.bind(null,e[1]),un().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,i){var l=Ye,c=un();if(Be){if(i===void 0)throw Error(r(407));i=i()}else{if(i=n(),ct===null)throw Error(r(349));(ur&30)!==0||$d(l,n,i)}c.memoizedState=i;var d={value:i,getSnapshot:n};return c.queue=d,Kd(Hd.bind(null,l,d,e),[e]),l.flags|=2048,Fs(9,Wd.bind(null,l,d,i,n),void 0,null),i},useId:function(){var e=un(),n=ct.identifierPrefix;if(Be){var i=vn,l=gn;i=(l&~(1<<32-Kt(l)-1)).toString(32)+i,n=":"+n+"R"+i,i=As++,0<i&&(n+="H"+i.toString(32)),n+=":"}else i=ng++,n=":"+n+"r"+i.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},lg={readContext:Ht,useCallback:ef,useContext:Ht,useEffect:ma,useImperativeHandle:Zd,useInsertionEffect:qd,useLayoutEffect:Xd,useMemo:tf,useReducer:ha,useRef:Gd,useState:function(){return ha(Os)},useDebugValue:ga,useDeferredValue:function(e){var n=Vt();return nf(n,it.memoizedState,e)},useTransition:function(){var e=ha(Os)[0],n=Vt().memoizedState;return[e,n]},useMutableSource:Ud,useSyncExternalStore:Bd,useId:rf,unstable_isNewReconciler:!1},ag={readContext:Ht,useCallback:ef,useContext:Ht,useEffect:ma,useImperativeHandle:Zd,useInsertionEffect:qd,useLayoutEffect:Xd,useMemo:tf,useReducer:pa,useRef:Gd,useState:function(){return pa(Os)},useDebugValue:ga,useDeferredValue:function(e){var n=Vt();return it===null?n.memoizedState=e:nf(n,it.memoizedState,e)},useTransition:function(){var e=pa(Os)[0],n=Vt().memoizedState;return[e,n]},useMutableSource:Ud,useSyncExternalStore:Bd,useId:rf,unstable_isNewReconciler:!1};function Hr(e,n){try{var i="",l=n;do i+=K(l),l=l.return;while(l);var c=i}catch(d){c=`
Error generating stack: `+d.message+`
`+d.stack}return{value:e,source:n,stack:c,digest:null}}function va(e,n,i){return{value:e,source:null,stack:i??null,digest:n??null}}function xa(e,n){try{console.error(n.value)}catch(i){setTimeout(function(){throw i})}}var cg=typeof WeakMap=="function"?WeakMap:Map;function af(e,n,i){i=_n(-1,i),i.tag=3,i.payload={element:null};var l=n.value;return i.callback=function(){ho||(ho=!0,Da=l),xa(e,n)},i}function cf(e,n,i){i=_n(-1,i),i.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var c=n.value;i.payload=function(){return l(c)},i.callback=function(){xa(e,n)}}var d=e.stateNode;return d!==null&&typeof d.componentDidCatch=="function"&&(i.callback=function(){xa(e,n),typeof l!="function"&&($n===null?$n=new Set([this]):$n.add(this));var m=n.stack;this.componentDidCatch(n.value,{componentStack:m!==null?m:""})}),i}function uf(e,n,i){var l=e.pingCache;if(l===null){l=e.pingCache=new cg;var c=new Set;l.set(n,c)}else c=l.get(n),c===void 0&&(c=new Set,l.set(n,c));c.has(i)||(c.add(i),e=kg.bind(null,e,n,i),n.then(e,e))}function df(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function ff(e,n,i,l,c){return(e.mode&1)===0?(e===n?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(n=_n(-1,1),n.tag=2,Un(i,n,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=c,e)}var ug=A.ReactCurrentOwner,Tt=!1;function St(e,n,i,l){n.child=e===null?Fd(n,null,i,l):$r(n,e.child,i,l)}function hf(e,n,i,l,c){i=i.render;var d=n.ref;return Br(n,c),l=da(e,n,i,l,d,c),i=fa(),e!==null&&!Tt?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~c,yn(e,n,c)):(Be&&i&&Yl(n),n.flags|=1,St(e,n,l,c),n.child)}function pf(e,n,i,l,c){if(e===null){var d=i.type;return typeof d=="function"&&!Ua(d)&&d.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(n.tag=15,n.type=d,mf(e,n,d,l,c)):(e=_o(i.type,null,l,n,n.mode,c),e.ref=n.ref,e.return=n,n.child=e)}if(d=e.child,(e.lanes&c)===0){var m=d.memoizedProps;if(i=i.compare,i=i!==null?i:Ns,i(m,l)&&e.ref===n.ref)return yn(e,n,c)}return n.flags|=1,e=Yn(d,l),e.ref=n.ref,e.return=n,n.child=e}function mf(e,n,i,l,c){if(e!==null){var d=e.memoizedProps;if(Ns(d,l)&&e.ref===n.ref)if(Tt=!1,n.pendingProps=l=d,(e.lanes&c)!==0)(e.flags&131072)!==0&&(Tt=!0);else return n.lanes=e.lanes,yn(e,n,c)}return _a(e,n,i,l,c)}function gf(e,n,i){var l=n.pendingProps,c=l.children,d=e!==null?e.memoizedState:null;if(l.mode==="hidden")if((n.mode&1)===0)n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Le(Yr,Bt),Bt|=i;else{if((i&1073741824)===0)return e=d!==null?d.baseLanes|i:i,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,Le(Yr,Bt),Bt|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=d!==null?d.baseLanes:i,Le(Yr,Bt),Bt|=l}else d!==null?(l=d.baseLanes|i,n.memoizedState=null):l=i,Le(Yr,Bt),Bt|=l;return St(e,n,c,i),n.child}function vf(e,n){var i=n.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(n.flags|=512,n.flags|=2097152)}function _a(e,n,i,l,c){var d=It(i)?ir:_t.current;return d=Ar(n,d),Br(n,c),i=da(e,n,i,l,d,c),l=fa(),e!==null&&!Tt?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~c,yn(e,n,c)):(Be&&l&&Yl(n),n.flags|=1,St(e,n,i,c),n.child)}function xf(e,n,i,l,c){if(It(i)){var d=!0;Wi(n)}else d=!1;if(Br(n,c),n.stateNode===null)lo(e,n),Ld(n,i,l),sa(n,i,l,c),l=!0;else if(e===null){var m=n.stateNode,_=n.memoizedProps;m.props=_;var k=m.context,j=i.contextType;typeof j=="object"&&j!==null?j=Ht(j):(j=It(i)?ir:_t.current,j=Ar(n,j));var O=i.getDerivedStateFromProps,F=typeof O=="function"||typeof m.getSnapshotBeforeUpdate=="function";F||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(_!==l||k!==j)&&Md(n,m,l,j),zn=!1;var M=n.memoizedState;m.state=M,Xi(n,l,m,c),k=n.memoizedState,_!==l||M!==k||bt.current||zn?(typeof O=="function"&&(ra(n,i,O,l),k=n.memoizedState),(_=zn||Dd(n,i,_,l,M,k,j))?(F||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(n.flags|=4194308)):(typeof m.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=l,n.memoizedState=k),m.props=l,m.state=k,m.context=j,l=_):(typeof m.componentDidMount=="function"&&(n.flags|=4194308),l=!1)}else{m=n.stateNode,Td(e,n),_=n.memoizedProps,j=n.type===n.elementType?_:Jt(n.type,_),m.props=j,F=n.pendingProps,M=m.context,k=i.contextType,typeof k=="object"&&k!==null?k=Ht(k):(k=It(i)?ir:_t.current,k=Ar(n,k));var Y=i.getDerivedStateFromProps;(O=typeof Y=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(_!==F||M!==k)&&Md(n,m,l,k),zn=!1,M=n.memoizedState,m.state=M,Xi(n,l,m,c);var q=n.memoizedState;_!==F||M!==q||bt.current||zn?(typeof Y=="function"&&(ra(n,i,Y,l),q=n.memoizedState),(j=zn||Dd(n,i,j,l,M,q,k)||!1)?(O||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(l,q,k),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(l,q,k)),typeof m.componentDidUpdate=="function"&&(n.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof m.componentDidUpdate!="function"||_===e.memoizedProps&&M===e.memoizedState||(n.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&M===e.memoizedState||(n.flags|=1024),n.memoizedProps=l,n.memoizedState=q),m.props=l,m.state=q,m.context=k,l=j):(typeof m.componentDidUpdate!="function"||_===e.memoizedProps&&M===e.memoizedState||(n.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&M===e.memoizedState||(n.flags|=1024),l=!1)}return ya(e,n,i,l,d,c)}function ya(e,n,i,l,c,d){vf(e,n);var m=(n.flags&128)!==0;if(!l&&!m)return c&&wd(n,i,!1),yn(e,n,d);l=n.stateNode,ug.current=n;var _=m&&typeof i.getDerivedStateFromError!="function"?null:l.render();return n.flags|=1,e!==null&&m?(n.child=$r(n,e.child,null,d),n.child=$r(n,null,_,d)):St(e,n,_,d),n.memoizedState=l.state,c&&wd(n,i,!0),n.child}function _f(e){var n=e.stateNode;n.pendingContext?_d(e,n.pendingContext,n.pendingContext!==n.context):n.context&&_d(e,n.context,!1),ia(e,n.containerInfo)}function yf(e,n,i,l,c){return zr(),ql(c),n.flags|=256,St(e,n,i,l),n.child}var wa={dehydrated:null,treeContext:null,retryLane:0};function Ca(e){return{baseLanes:e,cachePool:null,transitions:null}}function wf(e,n,i){var l=n.pendingProps,c=Ve.current,d=!1,m=(n.flags&128)!==0,_;if((_=m)||(_=e!==null&&e.memoizedState===null?!1:(c&2)!==0),_?(d=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(c|=1),Le(Ve,c&1),e===null)return Kl(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((n.mode&1)===0?n.lanes=1:e.data==="$!"?n.lanes=8:n.lanes=1073741824,null):(m=l.children,e=l.fallback,d?(l=n.mode,d=n.child,m={mode:"hidden",children:m},(l&1)===0&&d!==null?(d.childLanes=0,d.pendingProps=m):d=yo(m,l,0,null),e=mr(e,l,i,null),d.return=n,e.return=n,d.sibling=e,n.child=d,n.child.memoizedState=Ca(i),n.memoizedState=wa,e):ka(n,m));if(c=e.memoizedState,c!==null&&(_=c.dehydrated,_!==null))return dg(e,n,m,l,_,c,i);if(d){d=l.fallback,m=n.mode,c=e.child,_=c.sibling;var k={mode:"hidden",children:l.children};return(m&1)===0&&n.child!==c?(l=n.child,l.childLanes=0,l.pendingProps=k,n.deletions=null):(l=Yn(c,k),l.subtreeFlags=c.subtreeFlags&14680064),_!==null?d=Yn(_,d):(d=mr(d,m,i,null),d.flags|=2),d.return=n,l.return=n,l.sibling=d,n.child=l,l=d,d=n.child,m=e.child.memoizedState,m=m===null?Ca(i):{baseLanes:m.baseLanes|i,cachePool:null,transitions:m.transitions},d.memoizedState=m,d.childLanes=e.childLanes&~i,n.memoizedState=wa,l}return d=e.child,e=d.sibling,l=Yn(d,{mode:"visible",children:l.children}),(n.mode&1)===0&&(l.lanes=i),l.return=n,l.sibling=null,e!==null&&(i=n.deletions,i===null?(n.deletions=[e],n.flags|=16):i.push(e)),n.child=l,n.memoizedState=null,l}function ka(e,n){return n=yo({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function oo(e,n,i,l){return l!==null&&ql(l),$r(n,e.child,null,i),e=ka(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function dg(e,n,i,l,c,d,m){if(i)return n.flags&256?(n.flags&=-257,l=va(Error(r(422))),oo(e,n,m,l)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(d=l.fallback,c=n.mode,l=yo({mode:"visible",children:l.children},c,0,null),d=mr(d,c,m,null),d.flags|=2,l.return=n,d.return=n,l.sibling=d,n.child=l,(n.mode&1)!==0&&$r(n,e.child,null,m),n.child.memoizedState=Ca(m),n.memoizedState=wa,d);if((n.mode&1)===0)return oo(e,n,m,null);if(c.data==="$!"){if(l=c.nextSibling&&c.nextSibling.dataset,l)var _=l.dgst;return l=_,d=Error(r(419)),l=va(d,l,void 0),oo(e,n,m,l)}if(_=(m&e.childLanes)!==0,Tt||_){if(l=ct,l!==null){switch(m&-m){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=(c&(l.suspendedLanes|m))!==0?0:c,c!==0&&c!==d.retryLane&&(d.retryLane=c,xn(e,c),tn(l,e,c,-1))}return za(),l=va(Error(r(421))),oo(e,n,m,l)}return c.data==="$?"?(n.flags|=128,n.child=e.child,n=Ng.bind(null,e),c._reactRetry=n,null):(e=d.treeContext,Ut=Mn(c.nextSibling),zt=n,Be=!0,Xt=null,e!==null&&($t[Wt++]=gn,$t[Wt++]=vn,$t[Wt++]=or,gn=e.id,vn=e.overflow,or=n),n=ka(n,l.children),n.flags|=4096,n)}function Cf(e,n,i){e.lanes|=n;var l=e.alternate;l!==null&&(l.lanes|=n),ea(e.return,n,i)}function Na(e,n,i,l,c){var d=e.memoizedState;d===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:l,tail:i,tailMode:c}:(d.isBackwards=n,d.rendering=null,d.renderingStartTime=0,d.last=l,d.tail=i,d.tailMode=c)}function kf(e,n,i){var l=n.pendingProps,c=l.revealOrder,d=l.tail;if(St(e,n,l.children,i),l=Ve.current,(l&2)!==0)l=l&1|2,n.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Cf(e,i,n);else if(e.tag===19)Cf(e,i,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(Le(Ve,l),(n.mode&1)===0)n.memoizedState=null;else switch(c){case"forwards":for(i=n.child,c=null;i!==null;)e=i.alternate,e!==null&&eo(e)===null&&(c=i),i=i.sibling;i=c,i===null?(c=n.child,n.child=null):(c=i.sibling,i.sibling=null),Na(n,!1,c,i,d);break;case"backwards":for(i=null,c=n.child,n.child=null;c!==null;){if(e=c.alternate,e!==null&&eo(e)===null){n.child=c;break}e=c.sibling,c.sibling=i,i=c,c=e}Na(n,!0,i,null,d);break;case"together":Na(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function lo(e,n){(n.mode&1)===0&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function yn(e,n,i){if(e!==null&&(n.dependencies=e.dependencies),dr|=n.lanes,(i&n.childLanes)===0)return null;if(e!==null&&n.child!==e.child)throw Error(r(153));if(n.child!==null){for(e=n.child,i=Yn(e,e.pendingProps),n.child=i,i.return=n;e.sibling!==null;)e=e.sibling,i=i.sibling=Yn(e,e.pendingProps),i.return=n;i.sibling=null}return n.child}function fg(e,n,i){switch(n.tag){case 3:_f(n),zr();break;case 5:zd(n);break;case 1:It(n.type)&&Wi(n);break;case 4:ia(n,n.stateNode.containerInfo);break;case 10:var l=n.type._context,c=n.memoizedProps.value;Le(Gi,l._currentValue),l._currentValue=c;break;case 13:if(l=n.memoizedState,l!==null)return l.dehydrated!==null?(Le(Ve,Ve.current&1),n.flags|=128,null):(i&n.child.childLanes)!==0?wf(e,n,i):(Le(Ve,Ve.current&1),e=yn(e,n,i),e!==null?e.sibling:null);Le(Ve,Ve.current&1);break;case 19:if(l=(i&n.childLanes)!==0,(e.flags&128)!==0){if(l)return kf(e,n,i);n.flags|=128}if(c=n.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),Le(Ve,Ve.current),l)break;return null;case 22:case 23:return n.lanes=0,gf(e,n,i)}return yn(e,n,i)}var Nf,Sa,Sf,Ef;Nf=function(e,n){for(var i=n.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Sa=function(){},Sf=function(e,n,i,l){var c=e.memoizedProps;if(c!==l){e=n.stateNode,cr(cn.current);var d=null;switch(i){case"input":c=I(e,c),l=I(e,l),d=[];break;case"select":c=C({},c,{value:void 0}),l=C({},l,{value:void 0}),d=[];break;case"textarea":c=tt(e,c),l=tt(e,l),d=[];break;default:typeof c.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=Ui)}il(i,l);var m;i=null;for(j in c)if(!l.hasOwnProperty(j)&&c.hasOwnProperty(j)&&c[j]!=null)if(j==="style"){var _=c[j];for(m in _)_.hasOwnProperty(m)&&(i||(i={}),i[m]="")}else j!=="dangerouslySetInnerHTML"&&j!=="children"&&j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&j!=="autoFocus"&&(a.hasOwnProperty(j)?d||(d=[]):(d=d||[]).push(j,null));for(j in l){var k=l[j];if(_=c!=null?c[j]:void 0,l.hasOwnProperty(j)&&k!==_&&(k!=null||_!=null))if(j==="style")if(_){for(m in _)!_.hasOwnProperty(m)||k&&k.hasOwnProperty(m)||(i||(i={}),i[m]="");for(m in k)k.hasOwnProperty(m)&&_[m]!==k[m]&&(i||(i={}),i[m]=k[m])}else i||(d||(d=[]),d.push(j,i)),i=k;else j==="dangerouslySetInnerHTML"?(k=k?k.__html:void 0,_=_?_.__html:void 0,k!=null&&_!==k&&(d=d||[]).push(j,k)):j==="children"?typeof k!="string"&&typeof k!="number"||(d=d||[]).push(j,""+k):j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&(a.hasOwnProperty(j)?(k!=null&&j==="onScroll"&&Oe("scroll",e),d||_===k||(d=[])):(d=d||[]).push(j,k))}i&&(d=d||[]).push("style",i);var j=d;(n.updateQueue=j)&&(n.flags|=4)}},Ef=function(e,n,i,l){i!==l&&(n.flags|=4)};function zs(e,n){if(!Be)switch(e.tailMode){case"hidden":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function wt(e){var n=e.alternate!==null&&e.alternate.child===e.child,i=0,l=0;if(n)for(var c=e.child;c!==null;)i|=c.lanes|c.childLanes,l|=c.subtreeFlags&14680064,l|=c.flags&14680064,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)i|=c.lanes|c.childLanes,l|=c.subtreeFlags,l|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=l,e.childLanes=i,n}function hg(e,n,i){var l=n.pendingProps;switch(Ql(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wt(n),null;case 1:return It(n.type)&&$i(),wt(n),null;case 3:return l=n.stateNode,Wr(),Fe(bt),Fe(_t),aa(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(Qi(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Xt!==null&&(Aa(Xt),Xt=null))),Sa(e,n),wt(n),null;case 5:oa(n);var c=cr(Ls.current);if(i=n.type,e!==null&&n.stateNode!=null)Sf(e,n,i,l,c),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!l){if(n.stateNode===null)throw Error(r(166));return wt(n),null}if(e=cr(cn.current),Qi(n)){l=n.stateNode,i=n.type;var d=n.memoizedProps;switch(l[an]=n,l[Ts]=d,e=(n.mode&1)!==0,i){case"dialog":Oe("cancel",l),Oe("close",l);break;case"iframe":case"object":case"embed":Oe("load",l);break;case"video":case"audio":for(c=0;c<Es.length;c++)Oe(Es[c],l);break;case"source":Oe("error",l);break;case"img":case"image":case"link":Oe("error",l),Oe("load",l);break;case"details":Oe("toggle",l);break;case"input":J(l,d),Oe("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!d.multiple},Oe("invalid",l);break;case"textarea":Nt(l,d),Oe("invalid",l)}il(i,d),c=null;for(var m in d)if(d.hasOwnProperty(m)){var _=d[m];m==="children"?typeof _=="string"?l.textContent!==_&&(d.suppressHydrationWarning!==!0&&zi(l.textContent,_,e),c=["children",_]):typeof _=="number"&&l.textContent!==""+_&&(d.suppressHydrationWarning!==!0&&zi(l.textContent,_,e),c=["children",""+_]):a.hasOwnProperty(m)&&_!=null&&m==="onScroll"&&Oe("scroll",l)}switch(i){case"input":Gt(l),de(l,d,!0);break;case"textarea":Gt(l),qe(l);break;case"select":case"option":break;default:typeof d.onClick=="function"&&(l.onclick=Ui)}l=c,n.updateQueue=l,l!==null&&(n.flags|=4)}else{m=c.nodeType===9?c:c.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ne(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=m.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=m.createElement(i,{is:l.is}):(e=m.createElement(i),i==="select"&&(m=e,l.multiple?m.multiple=!0:l.size&&(m.size=l.size))):e=m.createElementNS(e,i),e[an]=n,e[Ts]=l,Nf(e,n,!1,!1),n.stateNode=e;e:{switch(m=ol(i,l),i){case"dialog":Oe("cancel",e),Oe("close",e),c=l;break;case"iframe":case"object":case"embed":Oe("load",e),c=l;break;case"video":case"audio":for(c=0;c<Es.length;c++)Oe(Es[c],e);c=l;break;case"source":Oe("error",e),c=l;break;case"img":case"image":case"link":Oe("error",e),Oe("load",e),c=l;break;case"details":Oe("toggle",e),c=l;break;case"input":J(e,l),c=I(e,l),Oe("invalid",e);break;case"option":c=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},c=C({},l,{value:void 0}),Oe("invalid",e);break;case"textarea":Nt(e,l),c=tt(e,l),Oe("invalid",e);break;default:c=l}il(i,c),_=c;for(d in _)if(_.hasOwnProperty(d)){var k=_[d];d==="style"?tr(e,k):d==="dangerouslySetInnerHTML"?(k=k?k.__html:void 0,k!=null&&He(e,k)):d==="children"?typeof k=="string"?(i!=="textarea"||k!=="")&&st(e,k):typeof k=="number"&&st(e,""+k):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(a.hasOwnProperty(d)?k!=null&&d==="onScroll"&&Oe("scroll",e):k!=null&&_e(e,d,k,m))}switch(i){case"input":Gt(e),de(e,l,!1);break;case"textarea":Gt(e),qe(e);break;case"option":l.value!=null&&e.setAttribute("value",""+we(l.value));break;case"select":e.multiple=!!l.multiple,d=l.value,d!=null?De(e,!!l.multiple,d,!1):l.defaultValue!=null&&De(e,!!l.multiple,l.defaultValue,!0);break;default:typeof c.onClick=="function"&&(e.onclick=Ui)}switch(i){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return wt(n),null;case 6:if(e&&n.stateNode!=null)Ef(e,n,e.memoizedProps,l);else{if(typeof l!="string"&&n.stateNode===null)throw Error(r(166));if(i=cr(Ls.current),cr(cn.current),Qi(n)){if(l=n.stateNode,i=n.memoizedProps,l[an]=n,(d=l.nodeValue!==i)&&(e=zt,e!==null))switch(e.tag){case 3:zi(l.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&zi(l.nodeValue,i,(e.mode&1)!==0)}d&&(n.flags|=4)}else l=(i.nodeType===9?i:i.ownerDocument).createTextNode(l),l[an]=n,n.stateNode=l}return wt(n),null;case 13:if(Fe(Ve),l=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Be&&Ut!==null&&(n.mode&1)!==0&&(n.flags&128)===0)bd(),zr(),n.flags|=98560,d=!1;else if(d=Qi(n),l!==null&&l.dehydrated!==null){if(e===null){if(!d)throw Error(r(318));if(d=n.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(r(317));d[an]=n}else zr(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;wt(n),d=!1}else Xt!==null&&(Aa(Xt),Xt=null),d=!0;if(!d)return n.flags&65536?n:null}return(n.flags&128)!==0?(n.lanes=i,n):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(n.child.flags|=8192,(n.mode&1)!==0&&(e===null||(Ve.current&1)!==0?ot===0&&(ot=3):za())),n.updateQueue!==null&&(n.flags|=4),wt(n),null);case 4:return Wr(),Sa(e,n),e===null&&bs(n.stateNode.containerInfo),wt(n),null;case 10:return Zl(n.type._context),wt(n),null;case 17:return It(n.type)&&$i(),wt(n),null;case 19:if(Fe(Ve),d=n.memoizedState,d===null)return wt(n),null;if(l=(n.flags&128)!==0,m=d.rendering,m===null)if(l)zs(d,!1);else{if(ot!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(m=eo(e),m!==null){for(n.flags|=128,zs(d,!1),l=m.updateQueue,l!==null&&(n.updateQueue=l,n.flags|=4),n.subtreeFlags=0,l=i,i=n.child;i!==null;)d=i,e=l,d.flags&=14680066,m=d.alternate,m===null?(d.childLanes=0,d.lanes=e,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=m.childLanes,d.lanes=m.lanes,d.child=m.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=m.memoizedProps,d.memoizedState=m.memoizedState,d.updateQueue=m.updateQueue,d.type=m.type,e=m.dependencies,d.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Le(Ve,Ve.current&1|2),n.child}e=e.sibling}d.tail!==null&&Xe()>Qr&&(n.flags|=128,l=!0,zs(d,!1),n.lanes=4194304)}else{if(!l)if(e=eo(m),e!==null){if(n.flags|=128,l=!0,i=e.updateQueue,i!==null&&(n.updateQueue=i,n.flags|=4),zs(d,!0),d.tail===null&&d.tailMode==="hidden"&&!m.alternate&&!Be)return wt(n),null}else 2*Xe()-d.renderingStartTime>Qr&&i!==1073741824&&(n.flags|=128,l=!0,zs(d,!1),n.lanes=4194304);d.isBackwards?(m.sibling=n.child,n.child=m):(i=d.last,i!==null?i.sibling=m:n.child=m,d.last=m)}return d.tail!==null?(n=d.tail,d.rendering=n,d.tail=n.sibling,d.renderingStartTime=Xe(),n.sibling=null,i=Ve.current,Le(Ve,l?i&1|2:i&1),n):(wt(n),null);case 22:case 23:return Fa(),l=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(n.flags|=8192),l&&(n.mode&1)!==0?(Bt&1073741824)!==0&&(wt(n),n.subtreeFlags&6&&(n.flags|=8192)):wt(n),null;case 24:return null;case 25:return null}throw Error(r(156,n.tag))}function pg(e,n){switch(Ql(n),n.tag){case 1:return It(n.type)&&$i(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Wr(),Fe(bt),Fe(_t),aa(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 5:return oa(n),null;case 13:if(Fe(Ve),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(r(340));zr()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return Fe(Ve),null;case 4:return Wr(),null;case 10:return Zl(n.type._context),null;case 22:case 23:return Fa(),null;case 24:return null;default:return null}}var ao=!1,Ct=!1,mg=typeof WeakSet=="function"?WeakSet:Set,G=null;function Vr(e,n){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(l){Qe(e,n,l)}else i.current=null}function Ea(e,n,i){try{i()}catch(l){Qe(e,n,l)}}var bf=!1;function gg(e,n){if(Fl=Ii,e=rd(),jl(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var l=i.getSelection&&i.getSelection();if(l&&l.rangeCount!==0){i=l.anchorNode;var c=l.anchorOffset,d=l.focusNode;l=l.focusOffset;try{i.nodeType,d.nodeType}catch{i=null;break e}var m=0,_=-1,k=-1,j=0,O=0,F=e,M=null;t:for(;;){for(var Y;F!==i||c!==0&&F.nodeType!==3||(_=m+c),F!==d||l!==0&&F.nodeType!==3||(k=m+l),F.nodeType===3&&(m+=F.nodeValue.length),(Y=F.firstChild)!==null;)M=F,F=Y;for(;;){if(F===e)break t;if(M===i&&++j===c&&(_=m),M===d&&++O===l&&(k=m),(Y=F.nextSibling)!==null)break;F=M,M=F.parentNode}F=Y}i=_===-1||k===-1?null:{start:_,end:k}}else i=null}i=i||{start:0,end:0}}else i=null;for(zl={focusedElem:e,selectionRange:i},Ii=!1,G=n;G!==null;)if(n=G,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,G=e;else for(;G!==null;){n=G;try{var q=n.alternate;if((n.flags&1024)!==0)switch(n.tag){case 0:case 11:case 15:break;case 1:if(q!==null){var X=q.memoizedProps,Je=q.memoizedState,E=n.stateNode,N=E.getSnapshotBeforeUpdate(n.elementType===n.type?X:Jt(n.type,X),Je);E.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var b=n.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(U){Qe(n,n.return,U)}if(e=n.sibling,e!==null){e.return=n.return,G=e;break}G=n.return}return q=bf,bf=!1,q}function Us(e,n,i){var l=n.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var c=l=l.next;do{if((c.tag&e)===e){var d=c.destroy;c.destroy=void 0,d!==void 0&&Ea(n,i,d)}c=c.next}while(c!==l)}}function co(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var l=i.create;i.destroy=l()}i=i.next}while(i!==n)}}function ba(e){var n=e.ref;if(n!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof n=="function"?n(e):n.current=e}}function If(e){var n=e.alternate;n!==null&&(e.alternate=null,If(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[an],delete n[Ts],delete n[Wl],delete n[J0],delete n[Z0])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Tf(e){return e.tag===5||e.tag===3||e.tag===4}function jf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Tf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ia(e,n,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?i.nodeType===8?i.parentNode.insertBefore(e,n):i.insertBefore(e,n):(i.nodeType===8?(n=i.parentNode,n.insertBefore(e,i)):(n=i,n.appendChild(e)),i=i._reactRootContainer,i!=null||n.onclick!==null||(n.onclick=Ui));else if(l!==4&&(e=e.child,e!==null))for(Ia(e,n,i),e=e.sibling;e!==null;)Ia(e,n,i),e=e.sibling}function Ta(e,n,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?i.insertBefore(e,n):i.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(Ta(e,n,i),e=e.sibling;e!==null;)Ta(e,n,i),e=e.sibling}var mt=null,Zt=!1;function Bn(e,n,i){for(i=i.child;i!==null;)Rf(e,n,i),i=i.sibling}function Rf(e,n,i){if(ln&&typeof ln.onCommitFiberUnmount=="function")try{ln.onCommitFiberUnmount(Ci,i)}catch{}switch(i.tag){case 5:Ct||Vr(i,n);case 6:var l=mt,c=Zt;mt=null,Bn(e,n,i),mt=l,Zt=c,mt!==null&&(Zt?(e=mt,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):mt.removeChild(i.stateNode));break;case 18:mt!==null&&(Zt?(e=mt,i=i.stateNode,e.nodeType===8?$l(e.parentNode,i):e.nodeType===1&&$l(e,i),xs(e)):$l(mt,i.stateNode));break;case 4:l=mt,c=Zt,mt=i.stateNode.containerInfo,Zt=!0,Bn(e,n,i),mt=l,Zt=c;break;case 0:case 11:case 14:case 15:if(!Ct&&(l=i.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){c=l=l.next;do{var d=c,m=d.destroy;d=d.tag,m!==void 0&&((d&2)!==0||(d&4)!==0)&&Ea(i,n,m),c=c.next}while(c!==l)}Bn(e,n,i);break;case 1:if(!Ct&&(Vr(i,n),l=i.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=i.memoizedProps,l.state=i.memoizedState,l.componentWillUnmount()}catch(_){Qe(i,n,_)}Bn(e,n,i);break;case 21:Bn(e,n,i);break;case 22:i.mode&1?(Ct=(l=Ct)||i.memoizedState!==null,Bn(e,n,i),Ct=l):Bn(e,n,i);break;default:Bn(e,n,i)}}function Pf(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new mg),n.forEach(function(l){var c=Sg.bind(null,e,l);i.has(l)||(i.add(l),l.then(c,c))})}}function en(e,n){var i=n.deletions;if(i!==null)for(var l=0;l<i.length;l++){var c=i[l];try{var d=e,m=n,_=m;e:for(;_!==null;){switch(_.tag){case 5:mt=_.stateNode,Zt=!1;break e;case 3:mt=_.stateNode.containerInfo,Zt=!0;break e;case 4:mt=_.stateNode.containerInfo,Zt=!0;break e}_=_.return}if(mt===null)throw Error(r(160));Rf(d,m,c),mt=null,Zt=!1;var k=c.alternate;k!==null&&(k.return=null),c.return=null}catch(j){Qe(c,n,j)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)Df(n,e),n=n.sibling}function Df(e,n){var i=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(en(n,e),dn(e),l&4){try{Us(3,e,e.return),co(3,e)}catch(X){Qe(e,e.return,X)}try{Us(5,e,e.return)}catch(X){Qe(e,e.return,X)}}break;case 1:en(n,e),dn(e),l&512&&i!==null&&Vr(i,i.return);break;case 5:if(en(n,e),dn(e),l&512&&i!==null&&Vr(i,i.return),e.flags&32){var c=e.stateNode;try{st(c,"")}catch(X){Qe(e,e.return,X)}}if(l&4&&(c=e.stateNode,c!=null)){var d=e.memoizedProps,m=i!==null?i.memoizedProps:d,_=e.type,k=e.updateQueue;if(e.updateQueue=null,k!==null)try{_==="input"&&d.type==="radio"&&d.name!=null&&le(c,d),ol(_,m);var j=ol(_,d);for(m=0;m<k.length;m+=2){var O=k[m],F=k[m+1];O==="style"?tr(c,F):O==="dangerouslySetInnerHTML"?He(c,F):O==="children"?st(c,F):_e(c,O,F,j)}switch(_){case"input":fe(c,d);break;case"textarea":rt(c,d);break;case"select":var M=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!d.multiple;var Y=d.value;Y!=null?De(c,!!d.multiple,Y,!1):M!==!!d.multiple&&(d.defaultValue!=null?De(c,!!d.multiple,d.defaultValue,!0):De(c,!!d.multiple,d.multiple?[]:"",!1))}c[Ts]=d}catch(X){Qe(e,e.return,X)}}break;case 6:if(en(n,e),dn(e),l&4){if(e.stateNode===null)throw Error(r(162));c=e.stateNode,d=e.memoizedProps;try{c.nodeValue=d}catch(X){Qe(e,e.return,X)}}break;case 3:if(en(n,e),dn(e),l&4&&i!==null&&i.memoizedState.isDehydrated)try{xs(n.containerInfo)}catch(X){Qe(e,e.return,X)}break;case 4:en(n,e),dn(e);break;case 13:en(n,e),dn(e),c=e.child,c.flags&8192&&(d=c.memoizedState!==null,c.stateNode.isHidden=d,!d||c.alternate!==null&&c.alternate.memoizedState!==null||(Pa=Xe())),l&4&&Pf(e);break;case 22:if(O=i!==null&&i.memoizedState!==null,e.mode&1?(Ct=(j=Ct)||O,en(n,e),Ct=j):en(n,e),dn(e),l&8192){if(j=e.memoizedState!==null,(e.stateNode.isHidden=j)&&!O&&(e.mode&1)!==0)for(G=e,O=e.child;O!==null;){for(F=G=O;G!==null;){switch(M=G,Y=M.child,M.tag){case 0:case 11:case 14:case 15:Us(4,M,M.return);break;case 1:Vr(M,M.return);var q=M.stateNode;if(typeof q.componentWillUnmount=="function"){l=M,i=M.return;try{n=l,q.props=n.memoizedProps,q.state=n.memoizedState,q.componentWillUnmount()}catch(X){Qe(l,i,X)}}break;case 5:Vr(M,M.return);break;case 22:if(M.memoizedState!==null){Af(F);continue}}Y!==null?(Y.return=M,G=Y):Af(F)}O=O.sibling}e:for(O=null,F=e;;){if(F.tag===5){if(O===null){O=F;try{c=F.stateNode,j?(d=c.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none"):(_=F.stateNode,k=F.memoizedProps.style,m=k!=null&&k.hasOwnProperty("display")?k.display:null,_.style.display=Ot("display",m))}catch(X){Qe(e,e.return,X)}}}else if(F.tag===6){if(O===null)try{F.stateNode.nodeValue=j?"":F.memoizedProps}catch(X){Qe(e,e.return,X)}}else if((F.tag!==22&&F.tag!==23||F.memoizedState===null||F===e)&&F.child!==null){F.child.return=F,F=F.child;continue}if(F===e)break e;for(;F.sibling===null;){if(F.return===null||F.return===e)break e;O===F&&(O=null),F=F.return}O===F&&(O=null),F.sibling.return=F.return,F=F.sibling}}break;case 19:en(n,e),dn(e),l&4&&Pf(e);break;case 21:break;default:en(n,e),dn(e)}}function dn(e){var n=e.flags;if(n&2){try{e:{for(var i=e.return;i!==null;){if(Tf(i)){var l=i;break e}i=i.return}throw Error(r(160))}switch(l.tag){case 5:var c=l.stateNode;l.flags&32&&(st(c,""),l.flags&=-33);var d=jf(e);Ta(e,d,c);break;case 3:case 4:var m=l.stateNode.containerInfo,_=jf(e);Ia(e,_,m);break;default:throw Error(r(161))}}catch(k){Qe(e,e.return,k)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function vg(e,n,i){G=e,Lf(e)}function Lf(e,n,i){for(var l=(e.mode&1)!==0;G!==null;){var c=G,d=c.child;if(c.tag===22&&l){var m=c.memoizedState!==null||ao;if(!m){var _=c.alternate,k=_!==null&&_.memoizedState!==null||Ct;_=ao;var j=Ct;if(ao=m,(Ct=k)&&!j)for(G=c;G!==null;)m=G,k=m.child,m.tag===22&&m.memoizedState!==null?Of(c):k!==null?(k.return=m,G=k):Of(c);for(;d!==null;)G=d,Lf(d),d=d.sibling;G=c,ao=_,Ct=j}Mf(e)}else(c.subtreeFlags&8772)!==0&&d!==null?(d.return=c,G=d):Mf(e)}}function Mf(e){for(;G!==null;){var n=G;if((n.flags&8772)!==0){var i=n.alternate;try{if((n.flags&8772)!==0)switch(n.tag){case 0:case 11:case 15:Ct||co(5,n);break;case 1:var l=n.stateNode;if(n.flags&4&&!Ct)if(i===null)l.componentDidMount();else{var c=n.elementType===n.type?i.memoizedProps:Jt(n.type,i.memoizedProps);l.componentDidUpdate(c,i.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var d=n.updateQueue;d!==null&&Rd(n,d,l);break;case 3:var m=n.updateQueue;if(m!==null){if(i=null,n.child!==null)switch(n.child.tag){case 5:i=n.child.stateNode;break;case 1:i=n.child.stateNode}Rd(n,m,i)}break;case 5:var _=n.stateNode;if(i===null&&n.flags&4){i=_;var k=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":k.autoFocus&&i.focus();break;case"img":k.src&&(i.src=k.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var j=n.alternate;if(j!==null){var O=j.memoizedState;if(O!==null){var F=O.dehydrated;F!==null&&xs(F)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Ct||n.flags&512&&ba(n)}catch(M){Qe(n,n.return,M)}}if(n===e){G=null;break}if(i=n.sibling,i!==null){i.return=n.return,G=i;break}G=n.return}}function Af(e){for(;G!==null;){var n=G;if(n===e){G=null;break}var i=n.sibling;if(i!==null){i.return=n.return,G=i;break}G=n.return}}function Of(e){for(;G!==null;){var n=G;try{switch(n.tag){case 0:case 11:case 15:var i=n.return;try{co(4,n)}catch(k){Qe(n,i,k)}break;case 1:var l=n.stateNode;if(typeof l.componentDidMount=="function"){var c=n.return;try{l.componentDidMount()}catch(k){Qe(n,c,k)}}var d=n.return;try{ba(n)}catch(k){Qe(n,d,k)}break;case 5:var m=n.return;try{ba(n)}catch(k){Qe(n,m,k)}}}catch(k){Qe(n,n.return,k)}if(n===e){G=null;break}var _=n.sibling;if(_!==null){_.return=n.return,G=_;break}G=n.return}}var xg=Math.ceil,uo=A.ReactCurrentDispatcher,ja=A.ReactCurrentOwner,Yt=A.ReactCurrentBatchConfig,Ne=0,ct=null,nt=null,gt=0,Bt=0,Yr=An(0),ot=0,Bs=null,dr=0,fo=0,Ra=0,$s=null,jt=null,Pa=0,Qr=1/0,wn=null,ho=!1,Da=null,$n=null,po=!1,Wn=null,mo=0,Ws=0,La=null,go=-1,vo=0;function Et(){return(Ne&6)!==0?Xe():go!==-1?go:go=Xe()}function Hn(e){return(e.mode&1)===0?1:(Ne&2)!==0&&gt!==0?gt&-gt:tg.transition!==null?(vo===0&&(vo=Iu()),vo):(e=je,e!==0||(e=window.event,e=e===void 0?16:Ou(e.type)),e)}function tn(e,n,i,l){if(50<Ws)throw Ws=0,La=null,Error(r(185));hs(e,i,l),((Ne&2)===0||e!==ct)&&(e===ct&&((Ne&2)===0&&(fo|=i),ot===4&&Vn(e,gt)),Rt(e,l),i===1&&Ne===0&&(n.mode&1)===0&&(Qr=Xe()+500,Hi&&Fn()))}function Rt(e,n){var i=e.callbackNode;t0(e,n);var l=Si(e,e===ct?gt:0);if(l===0)i!==null&&Su(i),e.callbackNode=null,e.callbackPriority=0;else if(n=l&-l,e.callbackPriority!==n){if(i!=null&&Su(i),n===1)e.tag===0?eg(zf.bind(null,e)):Cd(zf.bind(null,e)),q0(function(){(Ne&6)===0&&Fn()}),i=null;else{switch(Tu(l)){case 1:i=hl;break;case 4:i=Eu;break;case 16:i=wi;break;case 536870912:i=bu;break;default:i=wi}i=Qf(i,Ff.bind(null,e))}e.callbackPriority=n,e.callbackNode=i}}function Ff(e,n){if(go=-1,vo=0,(Ne&6)!==0)throw Error(r(327));var i=e.callbackNode;if(Gr()&&e.callbackNode!==i)return null;var l=Si(e,e===ct?gt:0);if(l===0)return null;if((l&30)!==0||(l&e.expiredLanes)!==0||n)n=xo(e,l);else{n=l;var c=Ne;Ne|=2;var d=Bf();(ct!==e||gt!==n)&&(wn=null,Qr=Xe()+500,hr(e,n));do try{wg();break}catch(_){Uf(e,_)}while(!0);Jl(),uo.current=d,Ne=c,nt!==null?n=0:(ct=null,gt=0,n=ot)}if(n!==0){if(n===2&&(c=pl(e),c!==0&&(l=c,n=Ma(e,c))),n===1)throw i=Bs,hr(e,0),Vn(e,l),Rt(e,Xe()),i;if(n===6)Vn(e,l);else{if(c=e.current.alternate,(l&30)===0&&!_g(c)&&(n=xo(e,l),n===2&&(d=pl(e),d!==0&&(l=d,n=Ma(e,d))),n===1))throw i=Bs,hr(e,0),Vn(e,l),Rt(e,Xe()),i;switch(e.finishedWork=c,e.finishedLanes=l,n){case 0:case 1:throw Error(r(345));case 2:pr(e,jt,wn);break;case 3:if(Vn(e,l),(l&130023424)===l&&(n=Pa+500-Xe(),10<n)){if(Si(e,0)!==0)break;if(c=e.suspendedLanes,(c&l)!==l){Et(),e.pingedLanes|=e.suspendedLanes&c;break}e.timeoutHandle=Bl(pr.bind(null,e,jt,wn),n);break}pr(e,jt,wn);break;case 4:if(Vn(e,l),(l&4194240)===l)break;for(n=e.eventTimes,c=-1;0<l;){var m=31-Kt(l);d=1<<m,m=n[m],m>c&&(c=m),l&=~d}if(l=c,l=Xe()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*xg(l/1960))-l,10<l){e.timeoutHandle=Bl(pr.bind(null,e,jt,wn),l);break}pr(e,jt,wn);break;case 5:pr(e,jt,wn);break;default:throw Error(r(329))}}}return Rt(e,Xe()),e.callbackNode===i?Ff.bind(null,e):null}function Ma(e,n){var i=$s;return e.current.memoizedState.isDehydrated&&(hr(e,n).flags|=256),e=xo(e,n),e!==2&&(n=jt,jt=i,n!==null&&Aa(n)),e}function Aa(e){jt===null?jt=e:jt.push.apply(jt,e)}function _g(e){for(var n=e;;){if(n.flags&16384){var i=n.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var l=0;l<i.length;l++){var c=i[l],d=c.getSnapshot;c=c.value;try{if(!qt(d(),c))return!1}catch{return!1}}}if(i=n.child,n.subtreeFlags&16384&&i!==null)i.return=n,n=i;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Vn(e,n){for(n&=~Ra,n&=~fo,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var i=31-Kt(n),l=1<<i;e[i]=-1,n&=~l}}function zf(e){if((Ne&6)!==0)throw Error(r(327));Gr();var n=Si(e,0);if((n&1)===0)return Rt(e,Xe()),null;var i=xo(e,n);if(e.tag!==0&&i===2){var l=pl(e);l!==0&&(n=l,i=Ma(e,l))}if(i===1)throw i=Bs,hr(e,0),Vn(e,n),Rt(e,Xe()),i;if(i===6)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,pr(e,jt,wn),Rt(e,Xe()),null}function Oa(e,n){var i=Ne;Ne|=1;try{return e(n)}finally{Ne=i,Ne===0&&(Qr=Xe()+500,Hi&&Fn())}}function fr(e){Wn!==null&&Wn.tag===0&&(Ne&6)===0&&Gr();var n=Ne;Ne|=1;var i=Yt.transition,l=je;try{if(Yt.transition=null,je=1,e)return e()}finally{je=l,Yt.transition=i,Ne=n,(Ne&6)===0&&Fn()}}function Fa(){Bt=Yr.current,Fe(Yr)}function hr(e,n){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,K0(i)),nt!==null)for(i=nt.return;i!==null;){var l=i;switch(Ql(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&$i();break;case 3:Wr(),Fe(bt),Fe(_t),aa();break;case 5:oa(l);break;case 4:Wr();break;case 13:Fe(Ve);break;case 19:Fe(Ve);break;case 10:Zl(l.type._context);break;case 22:case 23:Fa()}i=i.return}if(ct=e,nt=e=Yn(e.current,null),gt=Bt=n,ot=0,Bs=null,Ra=fo=dr=0,jt=$s=null,ar!==null){for(n=0;n<ar.length;n++)if(i=ar[n],l=i.interleaved,l!==null){i.interleaved=null;var c=l.next,d=i.pending;if(d!==null){var m=d.next;d.next=c,l.next=m}i.pending=l}ar=null}return e}function Uf(e,n){do{var i=nt;try{if(Jl(),to.current=io,no){for(var l=Ye.memoizedState;l!==null;){var c=l.queue;c!==null&&(c.pending=null),l=l.next}no=!1}if(ur=0,at=it=Ye=null,Ms=!1,As=0,ja.current=null,i===null||i.return===null){ot=1,Bs=n,nt=null;break}e:{var d=e,m=i.return,_=i,k=n;if(n=gt,_.flags|=32768,k!==null&&typeof k=="object"&&typeof k.then=="function"){var j=k,O=_,F=O.tag;if((O.mode&1)===0&&(F===0||F===11||F===15)){var M=O.alternate;M?(O.updateQueue=M.updateQueue,O.memoizedState=M.memoizedState,O.lanes=M.lanes):(O.updateQueue=null,O.memoizedState=null)}var Y=df(m);if(Y!==null){Y.flags&=-257,ff(Y,m,_,d,n),Y.mode&1&&uf(d,j,n),n=Y,k=j;var q=n.updateQueue;if(q===null){var X=new Set;X.add(k),n.updateQueue=X}else q.add(k);break e}else{if((n&1)===0){uf(d,j,n),za();break e}k=Error(r(426))}}else if(Be&&_.mode&1){var Je=df(m);if(Je!==null){(Je.flags&65536)===0&&(Je.flags|=256),ff(Je,m,_,d,n),ql(Hr(k,_));break e}}d=k=Hr(k,_),ot!==4&&(ot=2),$s===null?$s=[d]:$s.push(d),d=m;do{switch(d.tag){case 3:d.flags|=65536,n&=-n,d.lanes|=n;var E=af(d,k,n);jd(d,E);break e;case 1:_=k;var N=d.type,b=d.stateNode;if((d.flags&128)===0&&(typeof N.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&($n===null||!$n.has(b)))){d.flags|=65536,n&=-n,d.lanes|=n;var U=cf(d,_,n);jd(d,U);break e}}d=d.return}while(d!==null)}Wf(i)}catch(ee){n=ee,nt===i&&i!==null&&(nt=i=i.return);continue}break}while(!0)}function Bf(){var e=uo.current;return uo.current=io,e===null?io:e}function za(){(ot===0||ot===3||ot===2)&&(ot=4),ct===null||(dr&268435455)===0&&(fo&268435455)===0||Vn(ct,gt)}function xo(e,n){var i=Ne;Ne|=2;var l=Bf();(ct!==e||gt!==n)&&(wn=null,hr(e,n));do try{yg();break}catch(c){Uf(e,c)}while(!0);if(Jl(),Ne=i,uo.current=l,nt!==null)throw Error(r(261));return ct=null,gt=0,ot}function yg(){for(;nt!==null;)$f(nt)}function wg(){for(;nt!==null&&!Ym();)$f(nt)}function $f(e){var n=Yf(e.alternate,e,Bt);e.memoizedProps=e.pendingProps,n===null?Wf(e):nt=n,ja.current=null}function Wf(e){var n=e;do{var i=n.alternate;if(e=n.return,(n.flags&32768)===0){if(i=hg(i,n,Bt),i!==null){nt=i;return}}else{if(i=pg(i,n),i!==null){i.flags&=32767,nt=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ot=6,nt=null;return}}if(n=n.sibling,n!==null){nt=n;return}nt=n=e}while(n!==null);ot===0&&(ot=5)}function pr(e,n,i){var l=je,c=Yt.transition;try{Yt.transition=null,je=1,Cg(e,n,i,l)}finally{Yt.transition=c,je=l}return null}function Cg(e,n,i,l){do Gr();while(Wn!==null);if((Ne&6)!==0)throw Error(r(327));i=e.finishedWork;var c=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var d=i.lanes|i.childLanes;if(n0(e,d),e===ct&&(nt=ct=null,gt=0),(i.subtreeFlags&2064)===0&&(i.flags&2064)===0||po||(po=!0,Qf(wi,function(){return Gr(),null})),d=(i.flags&15990)!==0,(i.subtreeFlags&15990)!==0||d){d=Yt.transition,Yt.transition=null;var m=je;je=1;var _=Ne;Ne|=4,ja.current=null,gg(e,i),Df(i,e),$0(zl),Ii=!!Fl,zl=Fl=null,e.current=i,vg(i),Qm(),Ne=_,je=m,Yt.transition=d}else e.current=i;if(po&&(po=!1,Wn=e,mo=c),d=e.pendingLanes,d===0&&($n=null),qm(i.stateNode),Rt(e,Xe()),n!==null)for(l=e.onRecoverableError,i=0;i<n.length;i++)c=n[i],l(c.value,{componentStack:c.stack,digest:c.digest});if(ho)throw ho=!1,e=Da,Da=null,e;return(mo&1)!==0&&e.tag!==0&&Gr(),d=e.pendingLanes,(d&1)!==0?e===La?Ws++:(Ws=0,La=e):Ws=0,Fn(),null}function Gr(){if(Wn!==null){var e=Tu(mo),n=Yt.transition,i=je;try{if(Yt.transition=null,je=16>e?16:e,Wn===null)var l=!1;else{if(e=Wn,Wn=null,mo=0,(Ne&6)!==0)throw Error(r(331));var c=Ne;for(Ne|=4,G=e.current;G!==null;){var d=G,m=d.child;if((G.flags&16)!==0){var _=d.deletions;if(_!==null){for(var k=0;k<_.length;k++){var j=_[k];for(G=j;G!==null;){var O=G;switch(O.tag){case 0:case 11:case 15:Us(8,O,d)}var F=O.child;if(F!==null)F.return=O,G=F;else for(;G!==null;){O=G;var M=O.sibling,Y=O.return;if(If(O),O===j){G=null;break}if(M!==null){M.return=Y,G=M;break}G=Y}}}var q=d.alternate;if(q!==null){var X=q.child;if(X!==null){q.child=null;do{var Je=X.sibling;X.sibling=null,X=Je}while(X!==null)}}G=d}}if((d.subtreeFlags&2064)!==0&&m!==null)m.return=d,G=m;else e:for(;G!==null;){if(d=G,(d.flags&2048)!==0)switch(d.tag){case 0:case 11:case 15:Us(9,d,d.return)}var E=d.sibling;if(E!==null){E.return=d.return,G=E;break e}G=d.return}}var N=e.current;for(G=N;G!==null;){m=G;var b=m.child;if((m.subtreeFlags&2064)!==0&&b!==null)b.return=m,G=b;else e:for(m=N;G!==null;){if(_=G,(_.flags&2048)!==0)try{switch(_.tag){case 0:case 11:case 15:co(9,_)}}catch(ee){Qe(_,_.return,ee)}if(_===m){G=null;break e}var U=_.sibling;if(U!==null){U.return=_.return,G=U;break e}G=_.return}}if(Ne=c,Fn(),ln&&typeof ln.onPostCommitFiberRoot=="function")try{ln.onPostCommitFiberRoot(Ci,e)}catch{}l=!0}return l}finally{je=i,Yt.transition=n}}return!1}function Hf(e,n,i){n=Hr(i,n),n=af(e,n,1),e=Un(e,n,1),n=Et(),e!==null&&(hs(e,1,n),Rt(e,n))}function Qe(e,n,i){if(e.tag===3)Hf(e,e,i);else for(;n!==null;){if(n.tag===3){Hf(n,e,i);break}else if(n.tag===1){var l=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&($n===null||!$n.has(l))){e=Hr(i,e),e=cf(n,e,1),n=Un(n,e,1),e=Et(),n!==null&&(hs(n,1,e),Rt(n,e));break}}n=n.return}}function kg(e,n,i){var l=e.pingCache;l!==null&&l.delete(n),n=Et(),e.pingedLanes|=e.suspendedLanes&i,ct===e&&(gt&i)===i&&(ot===4||ot===3&&(gt&130023424)===gt&&500>Xe()-Pa?hr(e,0):Ra|=i),Rt(e,n)}function Vf(e,n){n===0&&((e.mode&1)===0?n=1:(n=Ni,Ni<<=1,(Ni&130023424)===0&&(Ni=4194304)));var i=Et();e=xn(e,n),e!==null&&(hs(e,n,i),Rt(e,i))}function Ng(e){var n=e.memoizedState,i=0;n!==null&&(i=n.retryLane),Vf(e,i)}function Sg(e,n){var i=0;switch(e.tag){case 13:var l=e.stateNode,c=e.memoizedState;c!==null&&(i=c.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(r(314))}l!==null&&l.delete(n),Vf(e,i)}var Yf;Yf=function(e,n,i){if(e!==null)if(e.memoizedProps!==n.pendingProps||bt.current)Tt=!0;else{if((e.lanes&i)===0&&(n.flags&128)===0)return Tt=!1,fg(e,n,i);Tt=(e.flags&131072)!==0}else Tt=!1,Be&&(n.flags&1048576)!==0&&kd(n,Yi,n.index);switch(n.lanes=0,n.tag){case 2:var l=n.type;lo(e,n),e=n.pendingProps;var c=Ar(n,_t.current);Br(n,i),c=da(null,n,l,e,c,i);var d=fa();return n.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,It(l)?(d=!0,Wi(n)):d=!1,n.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,na(n),c.updater=Ji,n.stateNode=c,c._reactInternals=n,sa(n,l,e,i),n=ya(null,n,l,!0,d,i)):(n.tag=0,Be&&d&&Yl(n),St(null,n,c,i),n=n.child),n;case 16:l=n.elementType;e:{switch(lo(e,n),e=n.pendingProps,c=l._init,l=c(l._payload),n.type=l,c=n.tag=bg(l),e=Jt(l,e),c){case 0:n=_a(null,n,l,e,i);break e;case 1:n=xf(null,n,l,e,i);break e;case 11:n=hf(null,n,l,e,i);break e;case 14:n=pf(null,n,l,Jt(l.type,e),i);break e}throw Error(r(306,l,""))}return n;case 0:return l=n.type,c=n.pendingProps,c=n.elementType===l?c:Jt(l,c),_a(e,n,l,c,i);case 1:return l=n.type,c=n.pendingProps,c=n.elementType===l?c:Jt(l,c),xf(e,n,l,c,i);case 3:e:{if(_f(n),e===null)throw Error(r(387));l=n.pendingProps,d=n.memoizedState,c=d.element,Td(e,n),Xi(n,l,null,i);var m=n.memoizedState;if(l=m.element,d.isDehydrated)if(d={element:l,isDehydrated:!1,cache:m.cache,pendingSuspenseBoundaries:m.pendingSuspenseBoundaries,transitions:m.transitions},n.updateQueue.baseState=d,n.memoizedState=d,n.flags&256){c=Hr(Error(r(423)),n),n=yf(e,n,l,i,c);break e}else if(l!==c){c=Hr(Error(r(424)),n),n=yf(e,n,l,i,c);break e}else for(Ut=Mn(n.stateNode.containerInfo.firstChild),zt=n,Be=!0,Xt=null,i=Fd(n,null,l,i),n.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(zr(),l===c){n=yn(e,n,i);break e}St(e,n,l,i)}n=n.child}return n;case 5:return zd(n),e===null&&Kl(n),l=n.type,c=n.pendingProps,d=e!==null?e.memoizedProps:null,m=c.children,Ul(l,c)?m=null:d!==null&&Ul(l,d)&&(n.flags|=32),vf(e,n),St(e,n,m,i),n.child;case 6:return e===null&&Kl(n),null;case 13:return wf(e,n,i);case 4:return ia(n,n.stateNode.containerInfo),l=n.pendingProps,e===null?n.child=$r(n,null,l,i):St(e,n,l,i),n.child;case 11:return l=n.type,c=n.pendingProps,c=n.elementType===l?c:Jt(l,c),hf(e,n,l,c,i);case 7:return St(e,n,n.pendingProps,i),n.child;case 8:return St(e,n,n.pendingProps.children,i),n.child;case 12:return St(e,n,n.pendingProps.children,i),n.child;case 10:e:{if(l=n.type._context,c=n.pendingProps,d=n.memoizedProps,m=c.value,Le(Gi,l._currentValue),l._currentValue=m,d!==null)if(qt(d.value,m)){if(d.children===c.children&&!bt.current){n=yn(e,n,i);break e}}else for(d=n.child,d!==null&&(d.return=n);d!==null;){var _=d.dependencies;if(_!==null){m=d.child;for(var k=_.firstContext;k!==null;){if(k.context===l){if(d.tag===1){k=_n(-1,i&-i),k.tag=2;var j=d.updateQueue;if(j!==null){j=j.shared;var O=j.pending;O===null?k.next=k:(k.next=O.next,O.next=k),j.pending=k}}d.lanes|=i,k=d.alternate,k!==null&&(k.lanes|=i),ea(d.return,i,n),_.lanes|=i;break}k=k.next}}else if(d.tag===10)m=d.type===n.type?null:d.child;else if(d.tag===18){if(m=d.return,m===null)throw Error(r(341));m.lanes|=i,_=m.alternate,_!==null&&(_.lanes|=i),ea(m,i,n),m=d.sibling}else m=d.child;if(m!==null)m.return=d;else for(m=d;m!==null;){if(m===n){m=null;break}if(d=m.sibling,d!==null){d.return=m.return,m=d;break}m=m.return}d=m}St(e,n,c.children,i),n=n.child}return n;case 9:return c=n.type,l=n.pendingProps.children,Br(n,i),c=Ht(c),l=l(c),n.flags|=1,St(e,n,l,i),n.child;case 14:return l=n.type,c=Jt(l,n.pendingProps),c=Jt(l.type,c),pf(e,n,l,c,i);case 15:return mf(e,n,n.type,n.pendingProps,i);case 17:return l=n.type,c=n.pendingProps,c=n.elementType===l?c:Jt(l,c),lo(e,n),n.tag=1,It(l)?(e=!0,Wi(n)):e=!1,Br(n,i),Ld(n,l,c),sa(n,l,c,i),ya(null,n,l,!0,e,i);case 19:return kf(e,n,i);case 22:return gf(e,n,i)}throw Error(r(156,n.tag))};function Qf(e,n){return Nu(e,n)}function Eg(e,n,i,l){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qt(e,n,i,l){return new Eg(e,n,i,l)}function Ua(e){return e=e.prototype,!(!e||!e.isReactComponent)}function bg(e){if(typeof e=="function")return Ua(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Re)return 11;if(e===pt)return 14}return 2}function Yn(e,n){var i=e.alternate;return i===null?(i=Qt(e.tag,n,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=n,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,n=e.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function _o(e,n,i,l,c,d){var m=2;if(l=e,typeof e=="function")Ua(e)&&(m=1);else if(typeof e=="string")m=5;else e:switch(e){case z:return mr(i.children,c,d,n);case oe:m=8,c|=8;break;case ye:return e=Qt(12,i,n,c|2),e.elementType=ye,e.lanes=d,e;case We:return e=Qt(13,i,n,c),e.elementType=We,e.lanes=d,e;case Ke:return e=Qt(19,i,n,c),e.elementType=Ke,e.lanes=d,e;case Te:return yo(i,c,d,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case he:m=10;break e;case Ue:m=9;break e;case Re:m=11;break e;case pt:m=14;break e;case Ze:m=16,l=null;break e}throw Error(r(130,e==null?e:typeof e,""))}return n=Qt(m,i,n,c),n.elementType=e,n.type=l,n.lanes=d,n}function mr(e,n,i,l){return e=Qt(7,e,l,n),e.lanes=i,e}function yo(e,n,i,l){return e=Qt(22,e,l,n),e.elementType=Te,e.lanes=i,e.stateNode={isHidden:!1},e}function Ba(e,n,i){return e=Qt(6,e,null,n),e.lanes=i,e}function $a(e,n,i){return n=Qt(4,e.children!==null?e.children:[],e.key,n),n.lanes=i,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function Ig(e,n,i,l,c){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ml(0),this.expirationTimes=ml(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ml(0),this.identifierPrefix=l,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function Wa(e,n,i,l,c,d,m,_,k){return e=new Ig(e,n,i,_,k),n===1?(n=1,d===!0&&(n|=8)):n=0,d=Qt(3,null,null,n),e.current=d,d.stateNode=e,d.memoizedState={element:l,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},na(d),e}function Tg(e,n,i){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:H,key:l==null?null:""+l,children:e,containerInfo:n,implementation:i}}function Gf(e){if(!e)return On;e=e._reactInternals;e:{if(rr(e)!==e||e.tag!==1)throw Error(r(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(It(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(r(171))}if(e.tag===1){var i=e.type;if(It(i))return yd(e,i,n)}return n}function Kf(e,n,i,l,c,d,m,_,k){return e=Wa(i,l,!0,e,c,d,m,_,k),e.context=Gf(null),i=e.current,l=Et(),c=Hn(i),d=_n(l,c),d.callback=n??null,Un(i,d,c),e.current.lanes=c,hs(e,c,l),Rt(e,l),e}function wo(e,n,i,l){var c=n.current,d=Et(),m=Hn(c);return i=Gf(i),n.context===null?n.context=i:n.pendingContext=i,n=_n(d,m),n.payload={element:e},l=l===void 0?null:l,l!==null&&(n.callback=l),e=Un(c,n,m),e!==null&&(tn(e,c,m,d),qi(e,c,m)),m}function Co(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function qf(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<n?i:n}}function Ha(e,n){qf(e,n),(e=e.alternate)&&qf(e,n)}function jg(){return null}var Xf=typeof reportError=="function"?reportError:function(e){console.error(e)};function Va(e){this._internalRoot=e}ko.prototype.render=Va.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(r(409));wo(e,n,null,null)},ko.prototype.unmount=Va.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;fr(function(){wo(null,e,null,null)}),n[pn]=null}};function ko(e){this._internalRoot=e}ko.prototype.unstable_scheduleHydration=function(e){if(e){var n=Pu();e={blockedOn:null,target:e,priority:n};for(var i=0;i<Pn.length&&n!==0&&n<Pn[i].priority;i++);Pn.splice(i,0,e),i===0&&Mu(e)}};function Ya(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function No(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Jf(){}function Rg(e,n,i,l,c){if(c){if(typeof l=="function"){var d=l;l=function(){var j=Co(m);d.call(j)}}var m=Kf(n,l,e,0,null,!1,!1,"",Jf);return e._reactRootContainer=m,e[pn]=m.current,bs(e.nodeType===8?e.parentNode:e),fr(),m}for(;c=e.lastChild;)e.removeChild(c);if(typeof l=="function"){var _=l;l=function(){var j=Co(k);_.call(j)}}var k=Wa(e,0,!1,null,null,!1,!1,"",Jf);return e._reactRootContainer=k,e[pn]=k.current,bs(e.nodeType===8?e.parentNode:e),fr(function(){wo(n,k,i,l)}),k}function So(e,n,i,l,c){var d=i._reactRootContainer;if(d){var m=d;if(typeof c=="function"){var _=c;c=function(){var k=Co(m);_.call(k)}}wo(n,m,e,c)}else m=Rg(i,n,e,c,l);return Co(m)}ju=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var i=fs(n.pendingLanes);i!==0&&(gl(n,i|1),Rt(n,Xe()),(Ne&6)===0&&(Qr=Xe()+500,Fn()))}break;case 13:fr(function(){var l=xn(e,1);if(l!==null){var c=Et();tn(l,e,1,c)}}),Ha(e,1)}},vl=function(e){if(e.tag===13){var n=xn(e,134217728);if(n!==null){var i=Et();tn(n,e,134217728,i)}Ha(e,134217728)}},Ru=function(e){if(e.tag===13){var n=Hn(e),i=xn(e,n);if(i!==null){var l=Et();tn(i,e,n,l)}Ha(e,n)}},Pu=function(){return je},Du=function(e,n){var i=je;try{return je=e,n()}finally{je=i}},cl=function(e,n,i){switch(n){case"input":if(fe(e,i),n=i.name,i.type==="radio"&&n!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<i.length;n++){var l=i[n];if(l!==e&&l.form===e.form){var c=Bi(l);if(!c)throw Error(r(90));fn(l),fe(l,c)}}}break;case"textarea":rt(e,i);break;case"select":n=i.value,n!=null&&De(e,!!i.multiple,n,!1)}},vu=Oa,xu=fr;var Pg={usingClientEntryPoint:!1,Events:[js,Lr,Bi,mu,gu,Oa]},Hs={findFiberByHostInstance:sr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Dg={bundleType:Hs.bundleType,version:Hs.version,rendererPackageName:Hs.rendererPackageName,rendererConfig:Hs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Cu(e),e===null?null:e.stateNode},findFiberByHostInstance:Hs.findFiberByHostInstance||jg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Eo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Eo.isDisabled&&Eo.supportsFiber)try{Ci=Eo.inject(Dg),ln=Eo}catch{}}return Pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pg,Pt.createPortal=function(e,n){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ya(n))throw Error(r(200));return Tg(e,n,null,i)},Pt.createRoot=function(e,n){if(!Ya(e))throw Error(r(299));var i=!1,l="",c=Xf;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(c=n.onRecoverableError)),n=Wa(e,1,!1,null,null,i,!1,l,c),e[pn]=n.current,bs(e.nodeType===8?e.parentNode:e),new Va(n)},Pt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(r(188)):(e=Object.keys(e).join(","),Error(r(268,e)));return e=Cu(n),e=e===null?null:e.stateNode,e},Pt.flushSync=function(e){return fr(e)},Pt.hydrate=function(e,n,i){if(!No(n))throw Error(r(200));return So(null,e,n,!0,i)},Pt.hydrateRoot=function(e,n,i){if(!Ya(e))throw Error(r(405));var l=i!=null&&i.hydratedSources||null,c=!1,d="",m=Xf;if(i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onRecoverableError!==void 0&&(m=i.onRecoverableError)),n=Kf(n,null,e,1,i??null,c,!1,d,m),e[pn]=n.current,bs(e),l)for(e=0;e<l.length;e++)i=l[e],c=i._getVersion,c=c(i._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[i,c]:n.mutableSourceEagerHydrationData.push(i,c);return new ko(n)},Pt.render=function(e,n,i){if(!No(n))throw Error(r(200));return So(null,e,n,!1,i)},Pt.unmountComponentAtNode=function(e){if(!No(e))throw Error(r(40));return e._reactRootContainer?(fr(function(){So(null,null,e,!1,function(){e._reactRootContainer=null,e[pn]=null})}),!0):!1},Pt.unstable_batchedUpdates=Oa,Pt.unstable_renderSubtreeIntoContainer=function(e,n,i,l){if(!No(i))throw Error(r(200));if(e==null||e._reactInternals===void 0)throw Error(r(38));return So(e,n,i,!1,l)},Pt.version="18.2.0-next-9e3b772b8-20220608",Pt}var oh;function $g(){if(oh)return Ka.exports;oh=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),Ka.exports=Bg(),Ka.exports}var lh;function Wg(){if(lh)return bo;lh=1;var s=$g();return bo.createRoot=s.createRoot,bo.hydrateRoot=s.hydrateRoot,bo}var Hg=Wg();const Vg=up(Hg),Yg=({children:s,activeTab:t,setActiveTab:r,isAdmin:o,onToggleAdmin:a,onDownloadDB:u,onUploadDB:h,onOpenSync:p,isSyncActive:g})=>{const v=V.useRef(null),S=[{id:"characters",label:"",icon:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})},{id:"connections",label:"",icon:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})},{id:"worlds",label:"",icon:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})},{id:"notes",label:"",icon:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})},{id:"admin",label:"",adminOnly:!0,icon:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"})}],y=x=>{var B;const R=(B=x.target.files)==null?void 0:B[0];if(!R)return;const P=new FileReader;P.onload=Q=>{var ie;const te=(ie=Q.target)==null?void 0:ie.result;typeof te=="string"&&h(te)},P.readAsText(R),v.current&&(v.current.value="")};return f.jsxs("div",{className:"min-h-screen flex flex-col md:flex-row bg-[#050505] text-stone-300",children:[f.jsxs("div",{className:"md:hidden flex items-center justify-between px-6 py-5 border-b border-stone-900 bg-[#050505]/95 backdrop-blur sticky top-0 z-40",children:[f.jsx("h1",{className:"text-lg font-serif font-bold tracking-[0.2em] text-stone-400 uppercase",children:""}),f.jsx("button",{onClick:a,className:`p-2 rounded-lg transition-all border ${o?"bg-emerald-950/20 border-emerald-900/50 text-emerald-500":"bg-stone-900/50 border-stone-800 text-stone-500"}`,children:f.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})]}),f.jsxs("aside",{className:"hidden md:flex w-64 border-r border-stone-900 flex-col fixed h-screen bg-[#050505] z-50",children:[f.jsx("div",{className:"p-8",children:f.jsx("h1",{className:"text-xl font-serif font-bold tracking-[0.2em] text-stone-400 uppercase",children:""})}),f.jsx("nav",{className:"flex-grow px-4 space-y-2",children:S.filter(x=>!x.adminOnly||o).map(x=>f.jsxs("button",{onClick:()=>r(x.id),className:`w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all flex items-center gap-3 ${t===x.id?"bg-stone-900 text-stone-100 border-l-2 border-emerald-500 rounded-l-none":"hover:bg-stone-900/50 text-stone-500 hover:text-stone-300"} ${x.adminOnly?"text-emerald-500/70":""}`,children:[f.jsx("svg",{className:"w-5 h-5 opacity-70",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:x.icon}),x.label]},x.id))}),f.jsxs("div",{className:"p-6 space-y-4",children:[f.jsxs("button",{onClick:p,className:`w-full py-2 px-3 rounded-lg border text-[9px] uppercase tracking-widest font-bold flex items-center justify-center gap-2 transition-all ${g?"bg-emerald-900/10 border-emerald-500/30 text-emerald-500 hover:bg-emerald-900/20":"bg-stone-900/30 border-stone-800 text-stone-600 hover:bg-stone-900/60 hover:text-stone-400"}`,children:[f.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${g?"bg-emerald-500 animate-pulse":"bg-stone-600"}`}),g?"":""]}),f.jsx("button",{onClick:a,className:`w-full py-3 text-[10px] uppercase tracking-widest font-bold rounded-md transition-all border ${o?"bg-emerald-950/20 border-emerald-900/50 text-emerald-500 shadow-lg shadow-emerald-900/10":"bg-stone-900/50 hover:bg-stone-900 border-stone-800 text-stone-400"}`,children:o?" ()":"  "})]})]}),f.jsx("nav",{className:"md:hidden fixed bottom-0 w-full bg-[#050505]/95 backdrop-blur-xl border-t border-stone-900 z-50 px-2 pb-safe-area",children:f.jsxs("div",{className:"flex justify-around items-center",children:[S.filter(x=>!x.adminOnly||o).map(x=>f.jsxs("button",{onClick:()=>r(x.id),className:`flex flex-col items-center justify-center py-3 px-2 w-full transition-all ${t===x.id?"text-emerald-500":"text-stone-600"}`,children:[f.jsx("svg",{className:"w-6 h-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:x.icon}),f.jsx("span",{className:"text-[9px] uppercase font-bold tracking-wider",children:x.label})]},x.id)),f.jsxs("button",{onClick:p,className:`flex flex-col items-center justify-center py-3 px-2 w-full transition-all ${g?"text-emerald-500":"text-stone-700"}`,children:[f.jsx("svg",{className:"w-6 h-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),f.jsx("span",{className:"text-[9px] uppercase font-bold tracking-wider",children:""})]})]})}),f.jsxs("main",{className:"flex-grow md:ml-64 min-h-screen relative pb-24 md:pb-0",children:[f.jsx("div",{className:"max-w-6xl mx-auto px-4 py-8 md:px-12 md:py-12",children:s}),f.jsxs("div",{className:"fixed bottom-24 md:bottom-8 right-4 md:right-8 flex gap-3 z-40 scale-90 md:scale-100 origin-bottom-right",children:[f.jsx("input",{type:"file",ref:v,onChange:y,accept:".json",className:"hidden"}),f.jsx("button",{onClick:()=>{var x;return(x=v.current)==null?void 0:x.click()},className:"px-4 py-2 md:px-5 md:py-2.5 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 rounded-full text-[9px] md:text-[10px] uppercase tracking-widest font-bold text-emerald-500 transition-all backdrop-blur-sm shadow-lg shadow-emerald-900/10",children:" "}),f.jsx("button",{onClick:u,className:"px-4 py-2 md:px-5 md:py-2.5 bg-stone-900/80 hover:bg-stone-800 border border-stone-700 rounded-full text-[9px] md:text-[10px] uppercase tracking-widest font-bold text-stone-300 transition-all backdrop-blur-sm",children:" "})]})]})]})},Qg=({character:s,onClick:t})=>{const r={objectFit:"cover",objectPosition:`${s.miniImageX??50}% ${s.miniImageY??50}%`,transformOrigin:`${s.miniImageX??50}% ${s.miniImageY??50}%`,transform:`scale(${s.miniImageScale??1})`},o=s.name.length,a=o>20?"text-sm":o>15?"text-base":"text-xl";return f.jsxs("div",{onClick:()=>t(s.id),className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-2xl p-6 flex flex-col items-center transition-all duration-300 hover:bg-stone-900/40 hover:border-emerald-900/30 group cursor-pointer shadow-lg h-full min-h-[320px] active:scale-95",children:[f.jsxs("div",{className:"relative mt-2 shrink-0",children:[f.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden border-2 border-stone-800 group-hover:border-emerald-600/50 transition-all duration-500 bg-black shadow-2xl",children:f.jsx("img",{src:s.imageUrl,alt:s.name,style:r,className:"w-full h-full opacity-80 group-hover:opacity-100 transition-all duration-700 group-hover:scale-110"})}),f.jsx("div",{className:"absolute inset-0 bg-emerald-500/10 rounded-full blur-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-700 -z-10"})]}),f.jsx("div",{className:"mt-6 h-14 flex items-center justify-center w-full px-2 shrink-0",children:f.jsx("h3",{className:`font-serif font-medium text-stone-100 group-hover:text-emerald-100 transition-colors text-center leading-tight line-clamp-2 ${a}`,children:s.name})}),f.jsx("div",{className:"mt-2 flex flex-wrap gap-1.5 justify-center content-start min-h-[28px] w-full px-1",children:s.tags&&s.tags.length>0?f.jsxs(f.Fragment,{children:[s.tags.slice(0,3).map(u=>f.jsx("span",{className:"px-2 py-0.5 bg-emerald-500/5 border border-emerald-500/10 text-emerald-500/60 text-[8px] uppercase tracking-wider font-black rounded-md whitespace-nowrap",children:u},u)),s.tags.length>3&&f.jsxs("span",{className:"text-[8px] text-stone-700 font-black self-center ml-0.5",children:["+",s.tags.length-3]})]}):f.jsx("div",{className:"h-4"})}),f.jsx("div",{className:"mt-auto pt-6 border-t border-stone-900/50 w-full flex justify-center shrink-0",children:f.jsx("span",{className:"text-[8px] uppercase tracking-[0.3em] font-black text-stone-700 group-hover:text-emerald-900 transition-colors",children:" "})})]})},ah=({imageUrl:s,scale:t,x:r,y:o,isCircular:a=!1,onUpdate:u})=>{const h=V.useRef(null),[p,g]=V.useState(!1),[v,S]=V.useState({x:0,y:0}),y=x=>{g(!0),S({x:x.clientX,y:x.clientY})};return V.useEffect(()=>{const x=P=>{if(!p||!h.current)return;const B=P.clientX-v.x,Q=P.clientY-v.y,te=.2,ie=r-B*te/t,_e=o-Q*te/t;u({x:ie,y:_e}),S({x:P.clientX,y:P.clientY})},R=()=>g(!1);return p&&(window.addEventListener("mousemove",x),window.addEventListener("mouseup",R)),()=>{window.removeEventListener("mousemove",x),window.removeEventListener("mouseup",R)}},[p,v,r,o,t,u]),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{ref:h,className:`relative overflow-hidden bg-black border border-stone-800 cursor-move group select-none shadow-2xl transition-all duration-500 hover:border-emerald-500/40 ${a?"w-48 h-48 rounded-full mx-auto":"aspect-[4/5] rounded-3xl w-full"}`,onMouseDown:y,children:[f.jsx("img",{src:s,alt:"",draggable:!1,style:{width:"100%",height:"100%",objectFit:"cover",objectPosition:`${r}% ${o}%`,transformOrigin:`${r}% ${o}%`,transform:`scale(${t})`},className:"pointer-events-none transition-opacity duration-300 opacity-90 group-hover:opacity-100"}),f.jsx("div",{className:"absolute inset-0 ring-1 ring-inset ring-white/5 pointer-events-none"}),f.jsx("div",{className:"absolute inset-0 bg-emerald-500/5 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity flex items-center justify-center",children:f.jsx("div",{className:"bg-black/60 backdrop-blur-md px-4 py-2 rounded-full border border-emerald-500/20",children:f.jsx("span",{className:"text-[9px] font-black text-emerald-400 uppercase tracking-[0.25em]",children:" "})})})]}),f.jsxs("div",{className:"bg-stone-900/60 p-4 rounded-2xl border border-stone-800/50 space-y-3 shadow-inner",children:[f.jsxs("div",{className:"flex justify-between items-center px-1",children:[f.jsx("span",{className:"text-[10px] font-black text-stone-500 uppercase tracking-widest",children:""}),f.jsxs("span",{className:"text-[10px] font-mono text-emerald-500 bg-emerald-500/10 px-2 py-0.5 rounded",children:[t.toFixed(2),"x"]})]}),f.jsx("input",{type:"range",min:"1",max:"5",step:"0.01",value:t,onChange:x=>u({scale:parseFloat(x.target.value)}),className:"w-full h-1.5 bg-stone-800 rounded-full appearance-none cursor-pointer accent-emerald-500"}),f.jsx("p",{className:"text-[8px] text-stone-700 text-center uppercase tracking-tighter",children:"      "})]})]})},jc=(s,t=800,r=.6)=>new Promise((o,a)=>{const u=new FileReader;u.readAsDataURL(s),u.onload=h=>{var g;const p=new Image;p.src=(g=h.target)==null?void 0:g.result,p.onload=()=>{const v=document.createElement("canvas");let S=p.width,y=p.height;S>t&&(y=y*t/S,S=t),v.width=S,v.height=y;const x=v.getContext("2d");if(x){x.drawImage(p,0,0,S,y);const R=v.toDataURL("image/jpeg",r);o(R)}else a(new Error("Canvas context not available"))},p.onerror=v=>a(v)},u.onerror=h=>a(h)}),Gg=({character:s,isAdmin:t,allCharacters:r,availableTags:o,availableHiddenTags:a,onBack:u,onSave:h,onSelectCharacter:p})=>{var Z,C,D;const[g,v]=V.useState(s),[S,y]=V.useState(!1),[x,R]=V.useState(!1),[P,B]=V.useState(!1),[Q,te]=V.useState(""),[ie,_e]=V.useState([]);V.useEffect(()=>{v(s)},[s]);const A=(w,T)=>{v(L=>({...L,[w]:T}))},$e=w=>{v(T=>({...T,imageScale:w.scale??T.imageScale,imageX:w.x??T.imageX,imageY:w.y??T.imageY}))},H=w=>{v(T=>({...T,miniImageScale:w.scale??T.miniImageScale,miniImageX:w.x??T.miniImageX,miniImageY:w.y??T.miniImageY}))},z=async w=>{var L;const T=(L=w.target.files)==null?void 0:L[0];if(T){B(!0);try{const K=await jc(T);A("imageUrl",K)}catch(K){console.error("Error processing image",K),alert("   ")}finally{B(!1)}}},oe=(w,T=!1)=>{if(T){const L=g.hiddenTags||[],K=L.includes(w)?L.filter(ue=>ue!==w):[...L,w];A("hiddenTags",K)}else{const L=g.tags||[],K=L.includes(w)?L.filter(ue=>ue!==w):[...L,w];A("tags",K)}},ye=w=>{_e(T=>T.includes(w)?T.filter(L=>L!==w):[...T,w])},he=()=>{R(!x),te(""),_e([])},Ue=w=>{const T={id:w.id,name:w.name,role:"",color:"#10b981"},L=g.connections||[];L.some(K=>K.id===w.id)||A("connections",[...L,T]),R(!1),te(""),_e([])},Re=w=>{const T=g.connections||[];A("connections",T.filter(L=>L.id!==w))},We=(w,T)=>{const L=g.connections||[];A("connections",L.map(K=>K.id===w?{...K,role:T}:K))},Ke=(w,T)=>{const L=g.connections||[];A("connections",L.map(K=>K.id===w?{...K,color:T}:K))},pt=()=>{h(g)},Ze=()=>{v(s)},Te=()=>{t&&h(g),u()},W=r.filter(w=>{var T;if(w.id===g.id||(T=g.connections)!=null&&T.some(L=>L.id===w.id)||Q&&!w.name.toLowerCase().includes(Q.toLowerCase()))return!1;if(ie.length>0){const L=[...w.tags||[],...w.hiddenTags||[]];if(!ie.every(ue=>L.includes(ue)))return!1}return!0});return f.jsxs("div",{className:"animate-in fade-in duration-500 space-y-6 md:space-y-8 pb-20",children:[f.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4",children:[f.jsxs("button",{onClick:Te,className:"flex items-center text-stone-500 hover:text-emerald-500 transition-colors group text-sm md:text-base order-1",children:[f.jsx("svg",{className:"w-5 h-5 mr-2 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})," ()"]}),t&&f.jsxs("div",{className:"flex items-center gap-3 order-2 w-full md:w-auto justify-end",children:[f.jsx("button",{onClick:Ze,className:"px-4 py-2 rounded-lg border border-stone-800 text-stone-500 hover:text-white hover:bg-stone-800 text-[10px] uppercase font-bold tracking-wider transition-all",children:""}),f.jsxs("button",{onClick:pt,className:"px-5 py-2 rounded-lg bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 hover:bg-emerald-900/40 text-[10px] uppercase font-bold tracking-wider transition-all flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),""]}),f.jsxs("div",{className:"hidden md:flex items-center gap-2 text-[8px] md:text-[10px] uppercase tracking-widest font-bold text-emerald-500/50 bg-emerald-500/5 px-3 py-1 rounded-full border border-emerald-500/10 ml-2",children:[f.jsx("span",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"})," "]})]})]}),f.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 lg:gap-12",children:[f.jsxs("div",{className:"w-full lg:w-1/3 space-y-8",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsx("h4",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 px-1",children:" "}),t?f.jsxs("div",{className:"space-y-4",children:[f.jsx(ah,{imageUrl:g.imageUrl,scale:g.imageScale??1,x:g.imageX??50,y:g.imageY??50,onUpdate:$e}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{className:"w-full bg-[#050505] border border-stone-800 rounded-lg px-3 py-2 text-[10px] text-stone-400 outline-none focus:border-emerald-500",placeholder:g.imageUrl.startsWith("data:")?"   ":"URL ...",value:g.imageUrl.startsWith("data:")?"":g.imageUrl,onChange:w=>A("imageUrl",w.target.value)}),f.jsxs("label",{className:`cursor-pointer bg-stone-900 border border-stone-800 hover:bg-stone-800 rounded-lg px-3 flex items-center justify-center transition-colors ${P?"opacity-50":""}`,children:[f.jsx("input",{type:"file",onChange:z,accept:"image/*",className:"hidden",disabled:P}),f.jsx("svg",{className:"w-4 h-4 text-emerald-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})]})]})]}):f.jsx("div",{className:"aspect-[4/5] rounded-2xl overflow-hidden border border-stone-800 shadow-2xl bg-black",children:f.jsx("img",{src:g.imageUrl,alt:g.name,style:{objectFit:"cover",objectPosition:`${g.imageX??50}% ${g.imageY??50}%`,transformOrigin:`${g.imageX??50}% ${g.imageY??50}%`,transform:`scale(${g.imageScale??1})`},className:"w-full h-full"})})]}),t&&f.jsxs("div",{className:"space-y-4 pt-4 border-t border-stone-900/50",children:[f.jsx("h4",{className:"text-[10px] uppercase tracking-widest font-bold text-emerald-500/60 px-1",children:"- ()"}),f.jsx(ah,{imageUrl:g.imageUrl,scale:g.miniImageScale??1,x:g.miniImageX??50,y:g.miniImageY??50,isCircular:!0,onUpdate:H})]}),f.jsxs("div",{className:"space-y-5 p-5 md:p-7 bg-[#0f0f0f]/40 border border-stone-900 rounded-[2rem] md:rounded-[2.5rem] shadow-inner",children:[f.jsx("h4",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-emerald-500/60 px-1 text-center",children:""}),f.jsx("div",{className:"flex flex-wrap gap-2 justify-center min-h-[40px]",children:t?o.length===0?f.jsx("p",{className:"text-[9px] text-stone-700 italic text-center w-full py-4 uppercase tracking-widest",children:"  "}):o.map(w=>{var L;const T=(L=g.tags)==null?void 0:L.includes(w);return f.jsx("button",{onClick:()=>oe(w,!1),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border ${T?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":"bg-stone-950 border-stone-800/50 text-stone-700 hover:text-stone-400 hover:border-stone-700"}`,children:w},w)}):g.tags&&g.tags.length>0?g.tags.map(w=>f.jsx("span",{className:"px-3 py-1.5 md:px-4 md:py-2 bg-emerald-500/5 border border-emerald-500/10 text-emerald-500/70 text-[9px] md:text-[10px] uppercase tracking-widest font-black rounded-xl",children:w},w)):f.jsx("p",{className:"text-[10px] text-stone-800 italic text-center w-full py-2",children:" "})}),(t||g.hiddenTags&&g.hiddenTags.length>0)&&f.jsxs("div",{className:"border-t border-stone-800/50 pt-5 mt-2",children:[f.jsx("h4",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-amber-600/60 px-1 text-center mb-4",children:" "}),f.jsx("div",{className:"flex flex-wrap gap-2 justify-center min-h-[20px]",children:t?a.length===0?f.jsx("p",{className:"text-[9px] text-stone-700 italic text-center w-full",children:"  "}):a.map(w=>{var L;const T=(L=g.hiddenTags)==null?void 0:L.includes(w);return f.jsx("button",{onClick:()=>oe(w,!0),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border ${T?"bg-amber-500/10 border-amber-500/40 text-amber-400 shadow-[0_0_15px_rgba(245,158,11,0.1)]":"bg-stone-950/50 border-stone-800/30 text-stone-600 hover:text-amber-500/70 hover:border-amber-900/30"}`,children:w},w)}):(Z=g.hiddenTags)==null?void 0:Z.map(w=>f.jsx("span",{className:"px-3 py-1.5 bg-amber-900/10 border border-amber-900/20 text-amber-600 text-[9px] uppercase tracking-widest font-black rounded-xl opacity-70",children:w},w))})]})]})]}),f.jsxs("div",{className:"w-full lg:w-2/3 space-y-6 md:space-y-8",children:[f.jsxs("div",{children:[t?f.jsx("div",{className:"space-y-4 mb-4",children:f.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[f.jsxs("div",{className:"flex-grow",children:[f.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-1",children:""}),f.jsx("input",{className:"w-full bg-transparent border-b border-stone-800 text-3xl md:text-4xl font-serif font-bold text-stone-100 outline-none focus:border-emerald-800 transition-colors py-1",value:g.name,onChange:w=>A("name",w.target.value)})]}),f.jsxs("div",{className:"w-full md:w-32",children:[f.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-1",children:""}),f.jsx("input",{className:"w-full bg-transparent border-b border-stone-800 text-xl font-light text-stone-500 outline-none focus:border-emerald-800 transition-colors py-2",value:g.age,onChange:w=>A("age",w.target.value)})]})]})}):f.jsx("div",{className:"space-y-4 mb-6",children:f.jsxs("div",{className:"flex flex-col md:flex-row md:items-baseline gap-2 md:gap-4",children:[f.jsx("h1",{className:"text-3xl md:text-5xl font-serif font-bold text-stone-100 leading-tight",children:g.name}),f.jsx("span",{className:"text-emerald-600/60 text-lg md:text-xl font-light",children:g.age})]})}),f.jsx("div",{className:"h-px bg-stone-900 w-full mb-6 md:mb-8"}),f.jsxs("section",{className:"space-y-4",children:[f.jsx("h4",{className:"text-emerald-500 text-sm font-semibold uppercase tracking-wider",children:""}),t?f.jsx("textarea",{className:"w-full bg-stone-900/20 border border-stone-800 rounded-xl p-4 text-stone-200 text-base md:text-lg leading-relaxed font-light outline-none focus:border-emerald-900 transition-colors resize-none",rows:12,value:g.additionalInfo,onChange:w=>A("additionalInfo",w.target.value)}):f.jsx("p",{className:"text-stone-300 text-base md:text-lg leading-relaxed font-light whitespace-pre-wrap",children:g.additionalInfo})]})]}),f.jsxs("div",{className:"space-y-4 pt-4",children:[f.jsxs("button",{onClick:()=>y(!S),className:"w-full flex items-center justify-between bg-[#0f0f0f]/30 border border-stone-900 p-4 md:p-5 rounded-xl transition-all group hover:border-emerald-900/30 shadow-md",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:"text-emerald-500 font-bold tracking-widest text-xs uppercase",children:""}),f.jsxs("span",{className:"text-stone-600 text-sm",children:["(",((C=g.connections)==null?void 0:C.length)||0,")"]})]}),f.jsx("svg",{className:`w-4 h-4 text-stone-600 transition-transform duration-300 ${S?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]}),S&&f.jsxs("div",{className:"space-y-3 animate-in slide-in-from-top-2 duration-300",children:[t&&f.jsxs("div",{className:"space-y-2 relative",children:[f.jsx("button",{onClick:he,className:`w-full py-2.5 hover:bg-emerald-600 text-stone-100 text-[11px] font-bold uppercase tracking-wider rounded-lg transition-all shadow-lg shadow-emerald-900/20 flex items-center justify-center gap-2 ${x?"bg-emerald-600 ring-2 ring-emerald-500/50":"bg-emerald-700/80"}`,children:x?" ":" "}),x&&f.jsxs("div",{className:"bg-stone-950 border border-stone-900 rounded-xl overflow-hidden shadow-2xl animate-in fade-in slide-in-from-top-2 duration-200",children:[f.jsxs("div",{className:"p-3 bg-stone-900/50 border-b border-stone-900 space-y-3 sticky top-0 z-10 backdrop-blur-md",children:[f.jsx("input",{type:"text",placeholder:"  ...",value:Q,onChange:w=>te(w.target.value),className:"w-full bg-stone-950 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-colors"}),(o.length>0||a.length>0)&&f.jsxs("div",{className:"flex flex-wrap gap-1.5 max-h-20 overflow-y-auto custom-scrollbar",children:[o.map(w=>{const T=ie.includes(w);return f.jsx("button",{onClick:()=>ye(w),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${T?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:w},w)}),a.map(w=>{const T=ie.includes(w);return f.jsx("button",{onClick:()=>ye(w),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${T?"bg-amber-500/20 border-amber-500/40 text-amber-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-amber-500"}`,children:w},w)})]})]}),f.jsx("div",{className:"grid grid-cols-1 gap-1 max-h-64 overflow-y-auto p-2",children:W.length>0?W.map(w=>f.jsxs("button",{onClick:()=>Ue(w),className:"flex items-center gap-3 p-2 hover:bg-stone-900 rounded-lg text-left transition-colors group",children:[f.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0 group-hover:border-emerald-500/50 transition-colors",children:f.jsx("img",{src:w.imageUrl,style:{objectFit:"cover",objectPosition:`${w.miniImageX??50}% ${w.miniImageY??50}%`,transformOrigin:`${w.miniImageX??50}% ${w.miniImageY??50}%`,transform:`scale(${w.miniImageScale??1})`},className:"w-full h-full",alt:""})}),f.jsxs("div",{className:"min-w-0",children:[f.jsx("span",{className:"text-stone-300 text-xs font-bold block truncate",children:w.name}),w.tags&&w.tags.length>0&&f.jsxs("span",{className:"text-[8px] text-stone-600 truncate block mt-0.5",children:[w.tags.slice(0,3).join(", "),w.tags.length>3?"...":""]})]})]},w.id)):f.jsx("div",{className:"text-center py-4 text-[10px] text-stone-600 italic",children:"  "})})]})]}),f.jsx("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-xl overflow-hidden divide-y divide-stone-900/50",children:(D=g.connections)==null?void 0:D.map(w=>{const T=r.find(K=>K.id===w.id),L=w.color||"#10b981";return f.jsxs("div",{className:"p-4 flex items-center gap-4 group hover:bg-stone-900/20 transition-colors",children:[f.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full overflow-hidden border border-stone-800 shrink-0 shadow-inner bg-black",children:f.jsx("img",{src:(T==null?void 0:T.imageUrl)||"https://via.placeholder.com/48",style:{objectFit:"cover",objectPosition:`${(T==null?void 0:T.miniImageX)??50}% ${(T==null?void 0:T.miniImageY)??50}%`,transformOrigin:`${(T==null?void 0:T.miniImageX)??50}% ${(T==null?void 0:T.miniImageY)??50}%`,transform:`scale(${(T==null?void 0:T.miniImageScale)??1})`},className:"w-full h-full",alt:""})}),f.jsxs("div",{className:"flex-grow min-w-0",children:[f.jsx("p",{className:"text-stone-200 font-bold text-sm tracking-wide truncate",children:w.name}),t?f.jsx("input",{className:"w-full bg-stone-950/50 border border-transparent hover:border-stone-800 focus:border-emerald-900 rounded px-2 py-0.5 mt-1 text-xs text-stone-500 outline-none transition-all",value:w.role,onChange:K=>We(w.id,K.target.value)}):f.jsx("p",{className:"text-stone-600 text-xs mt-1 font-medium truncate",children:w.role})]}),f.jsxs("div",{className:"flex items-center gap-3 md:gap-4 shrink-0",children:[f.jsxs("div",{className:"relative",children:[f.jsx("button",{onClick:()=>{var K;return t&&((K=document.getElementById(`picker-${w.id}`))==null?void 0:K.click())},className:`w-4 h-4 md:w-5 md:h-5 rounded-[4px] shadow-sm transition-transform ${t?"hover:scale-110 cursor-pointer active:scale-95":"cursor-default"}`,style:{backgroundColor:L}}),t&&f.jsx("input",{id:`picker-${w.id}`,type:"color",value:L,onChange:K=>Ke(w.id,K.target.value),className:"sr-only"})]}),f.jsx("button",{onClick:()=>p(w.id),className:"text-stone-700 hover:text-emerald-500 transition-colors text-[9px] md:text-[10px] uppercase font-bold tracking-[0.1em]",children:""}),t&&f.jsx("button",{onClick:()=>Re(w.id),className:"text-stone-800 hover:text-red-500 transition-colors p-1",children:f.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]},w.id)})})]})]})]})]})]})},Kg=({initialData:s,availableTags:t,availableHiddenTags:r,onSave:o,onClose:a})=>{const[u,h]=V.useState({name:"",age:"",imageUrl:"",additionalInfo:"",imageScale:1,imageX:50,imageY:50,tags:[],hiddenTags:[]}),[p,g]=V.useState(!1);V.useEffect(()=>{s&&h({name:s.name,age:s.age.toString(),imageUrl:s.imageUrl,additionalInfo:s.additionalInfo,imageScale:s.imageScale??1,imageX:s.imageX??50,imageY:s.imageY??50,tags:s.tags||[],hiddenTags:s.hiddenTags||[]})},[s]);const v=(x,R)=>{h(R?P=>({...P,hiddenTags:P.hiddenTags.includes(x)?P.hiddenTags.filter(B=>B!==x):[...P.hiddenTags,x]}):P=>({...P,tags:P.tags.includes(x)?P.tags.filter(B=>B!==x):[...P.tags,x]}))},S=async x=>{var P;const R=(P=x.target.files)==null?void 0:P[0];if(R){g(!0);try{const B=await jc(R);h(Q=>({...Q,imageUrl:B}))}catch(B){console.error("Error processing image",B),alert("   .")}finally{g(!1)}}},y=x=>{x.preventDefault();const R={id:(s==null?void 0:s.id)||Date.now().toString(),name:u.name,age:u.age,imageUrl:u.imageUrl||`https://picsum.photos/seed/${Date.now()}/400/500`,additionalInfo:u.additionalInfo,tags:u.tags,hiddenTags:u.hiddenTags,connections:(s==null?void 0:s.connections)||[],imageScale:u.imageScale,imageX:u.imageX,imageY:u.imageY};o(R)};return f.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center p-4 bg-black/95 backdrop-blur-2xl animate-in fade-in duration-300",children:f.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-2xl rounded-[2rem] md:rounded-[3rem] overflow-hidden shadow-[0_0_120px_rgba(0,0,0,1)] border-white/5 flex flex-col max-h-[90vh]",children:[f.jsxs("div",{className:"p-6 md:p-10 border-b border-stone-900 flex justify-between items-center bg-gradient-to-b from-stone-900/30 to-transparent shrink-0",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-2xl md:text-3xl font-serif text-stone-100 italic",children:s?" ":" "}),f.jsx("p",{className:"text-stone-600 text-[10px] uppercase tracking-widest mt-1",children:"  "})]}),f.jsx("button",{onClick:a,className:"text-stone-700 hover:text-white transition-all p-2 md:p-3 hover:bg-white/5 rounded-full",children:f.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsxs("form",{onSubmit:y,className:"p-6 md:p-10 space-y-8 md:space-y-10 overflow-y-auto custom-scrollbar flex-grow",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:"  "}),f.jsx("input",{required:!0,className:"w-full bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-4 text-stone-100 outline-none focus:border-emerald-500/30 transition-all font-serif italic text-lg shadow-inner",value:u.name,onChange:x=>h({...u,name:x.target.value})})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:""}),f.jsx("input",{required:!0,className:"w-full bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-4 text-stone-100 outline-none focus:border-emerald-500/30 transition-all shadow-inner",value:u.age,onChange:x=>h({...u,age:x.target.value})})]})]}),f.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-end px-1",children:[f.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600",children:"  ()"}),f.jsxs("span",{className:"text-[9px] text-stone-800 font-black uppercase tracking-widest",children:[": ",u.tags.length]})]}),f.jsx("div",{className:"flex flex-wrap gap-2 p-6 bg-black/30 border border-stone-900 rounded-[2rem] min-h-[80px] shadow-inner",children:t.length===0?f.jsx("p",{className:"text-stone-800 italic text-xs w-full text-center py-4",children:"     -"}):t.map(x=>{const R=u.tags.includes(x);return f.jsx("button",{type:"button",onClick:()=>v(x,!1),className:`px-4 py-2 rounded-xl text-[10px] uppercase tracking-wider font-black transition-all border ${R?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":"bg-stone-900/20 border-stone-800/40 text-stone-600 hover:border-stone-700 hover:text-stone-400"}`,children:x},x)})})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-end px-1",children:[f.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-amber-600",children:"  ()"}),f.jsxs("span",{className:"text-[9px] text-amber-900/60 font-black uppercase tracking-widest",children:[": ",u.hiddenTags.length]})]}),f.jsx("div",{className:"flex flex-wrap gap-2 p-6 bg-black/30 border border-amber-900/20 rounded-[2rem] min-h-[80px] shadow-inner",children:r.length===0?f.jsx("p",{className:"text-stone-800 italic text-xs w-full text-center py-4",children:"    "}):r.map(x=>{const R=u.hiddenTags.includes(x);return f.jsx("button",{type:"button",onClick:()=>v(x,!0),className:`px-4 py-2 rounded-xl text-[10px] uppercase tracking-wider font-black transition-all border ${R?"bg-amber-500/10 border-amber-500/40 text-amber-400 shadow-[0_0_15px_rgba(245,158,11,0.1)]":"bg-stone-900/20 border-stone-800/40 text-stone-600 hover:border-amber-900/30 hover:text-amber-500/50"}`,children:x},x)})})]})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:" (  )"}),f.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[f.jsx("input",{className:"flex-grow bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-3 text-xs text-stone-500 outline-none focus:border-emerald-500/30 transition-all",placeholder:"    ...",value:u.imageUrl.startsWith("data:")?"":u.imageUrl,onChange:x=>h({...u,imageUrl:x.target.value})}),f.jsxs("label",{className:`cursor-pointer bg-stone-900/50 hover:bg-stone-800 px-5 py-3 rounded-2xl transition-all flex items-center justify-center border border-stone-800 gap-2 ${p?"opacity-50 cursor-wait":""}`,children:[f.jsx("input",{type:"file",accept:"image/*",onChange:S,className:"hidden",disabled:p}),f.jsx("svg",{className:"w-5 h-5 text-stone-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),u.imageUrl.startsWith("data:")&&f.jsx("span",{className:"text-[9px] font-bold text-emerald-500 uppercase tracking-wider",children:""})]})]}),u.imageUrl.startsWith("data:")&&f.jsx("p",{className:"text-[9px] text-emerald-500/70 px-2",children:"    ."})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:" "}),f.jsx("textarea",{required:!0,rows:8,className:"w-full bg-stone-900/30 border border-stone-800 rounded-[2rem] px-8 py-6 text-stone-300 text-base leading-relaxed outline-none focus:border-emerald-900/30 transition-all resize-none shadow-inner custom-scrollbar",value:u.additionalInfo,onChange:x=>h({...u,additionalInfo:x.target.value})})]})]}),f.jsxs("div",{className:"p-6 md:p-10 border-t border-stone-900 bg-stone-900/10 flex gap-4 md:gap-6 shrink-0",children:[f.jsx("button",{type:"button",onClick:a,className:"flex-1 py-4 md:py-5 text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 hover:text-stone-300 transition-all",children:""}),f.jsx("button",{onClick:y,disabled:p,className:"flex-[2] py-4 md:py-5 bg-white hover:bg-emerald-50 text-black rounded-2xl text-[10px] uppercase tracking-[0.3em] font-black transition-all shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",children:p?"...":""})]})]})})},qg=({characters:s,availableTags:t,availableHiddenTags:r,onDelete:o,onEdit:a,onAdd:u,onUpdateTags:h,onUpdateHiddenTags:p,onDownloadDB:g,onUploadDB:v})=>{const[S,y]=V.useState(""),[x,R]=V.useState(""),P=V.useRef(null),B=z=>{z.preventDefault();const oe=S.trim().toLowerCase();oe&&!t.includes(oe)&&(h([...t,oe]),y(""))},Q=z=>{z.preventDefault();const oe=x.trim().toLowerCase();oe&&!r.includes(oe)&&(p([...r,oe]),R(""))},te=z=>{h(t.filter(oe=>oe!==z))},ie=z=>{p(r.filter(oe=>oe!==z))},_e=(z,oe,ye=!1)=>{const he=ye?[...r]:[...t],Ue=ye?p:h;oe==="left"&&z>0?[he[z-1],he[z]]=[he[z],he[z-1]]:oe==="right"&&z<he.length-1&&([he[z+1],he[z]]=[he[z],he[z+1]]),Ue(he)},A=(z=!1)=>{window.confirm(` ,      ${z?"":""} ?`)&&(z?p([]):h([]))},$e=z=>{var he;const oe=(he=z.target.files)==null?void 0:he[0];if(!oe)return;const ye=new FileReader;ye.onload=Ue=>{var We;const Re=(We=Ue.target)==null?void 0:We.result;typeof Re=="string"&&v(Re)},ye.readAsText(oe),P.current&&(P.current.value="")},H=(z,oe)=>f.jsx("div",{className:"flex flex-wrap gap-2 max-h-[300px] overflow-y-auto custom-scrollbar pr-2",children:z.length===0?f.jsx("p",{className:"text-stone-800 italic text-[10px] w-full text-center py-8",children:" ."}):z.map((ye,he)=>f.jsxs("div",{className:`group flex items-center border rounded-xl pr-2 pl-1 py-1 transition-all hover:bg-stone-900 ${oe?"bg-amber-900/10 border-amber-900/30 hover:border-amber-700":"bg-stone-900/50 border-stone-800/50 hover:border-stone-600"}`,children:[f.jsx("button",{onClick:()=>_e(he,"left",oe),disabled:he===0,className:`p-1 text-stone-600 hover:text-emerald-500 transition-all ${he===0?"opacity-0 pointer-events-none":"opacity-0 group-hover:opacity-100"}`,children:f.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M15 19l-7-7 7-7"})})}),f.jsx("span",{className:`text-[10px] uppercase tracking-wider font-bold px-1 select-none ${oe?"text-amber-500":"text-stone-500"}`,children:ye}),f.jsx("button",{onClick:()=>_e(he,"right",oe),disabled:he===z.length-1,className:`p-1 text-stone-600 hover:text-emerald-500 transition-all ${he===z.length-1?"opacity-0 pointer-events-none":"opacity-0 group-hover:opacity-100"}`,children:f.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M9 5l7 7-7 7"})})}),f.jsx("div",{className:`w-px h-3 mx-1 ${oe?"bg-amber-900/30":"bg-stone-800"}`}),f.jsx("button",{onClick:()=>oe?ie(ye):te(ye),className:"text-stone-700 hover:text-red-500 transition-colors ml-1",children:f.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:f.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]},ye))});return f.jsxs("div",{className:"space-y-12 animate-in fade-in duration-700 pb-32",children:[f.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-b border-stone-900/50 pb-8",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100",children:""}),f.jsx("p",{className:"text-stone-500 uppercase tracking-widest text-[10px]",children:"   "})]}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("input",{type:"file",ref:P,onChange:$e,accept:".json",className:"hidden"}),f.jsxs("button",{onClick:()=>{var z;return(z=P.current)==null?void 0:z.click()},className:"px-5 py-2.5 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 rounded-lg text-[10px] uppercase tracking-widest font-bold text-emerald-500 transition-all flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})," "]}),f.jsxs("button",{onClick:g,className:"px-5 py-2.5 bg-stone-900/80 hover:bg-stone-800 border border-stone-700 rounded-lg text-[10px] uppercase tracking-widest font-bold text-stone-300 transition-all flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})," "]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[f.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("h2",{className:"text-2xl font-serif text-stone-100 italic",children:" "}),f.jsx("span",{className:"text-[10px] bg-emerald-500/10 text-emerald-500 px-2 py-0.5 rounded-full font-black",children:s.length})]}),f.jsx("button",{onClick:u,className:"bg-white hover:bg-emerald-50 text-black px-6 py-2 rounded-full text-[10px] uppercase tracking-widest font-black transition-all",children:""})]}),f.jsx("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl overflow-hidden shadow-xl",children:f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full text-left min-w-[600px]",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"border-b border-stone-900 bg-stone-900/20",children:[f.jsx("th",{className:"px-6 py-5 text-[10px] uppercase tracking-widest font-black text-stone-600",children:""}),f.jsx("th",{className:"px-6 py-5 text-[10px] uppercase tracking-widest font-black text-stone-600",children:""}),f.jsx("th",{className:"px-6 py-5 text-[10px] uppercase tracking-widest font-black text-stone-600 text-right",children:""})]})}),f.jsx("tbody",{className:"divide-y divide-stone-900/50",children:s.map(z=>{var oe,ye,he,Ue;return f.jsxs("tr",{className:"hover:bg-stone-900/10 transition-colors",children:[f.jsx("td",{className:"px-6 py-4",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:f.jsx("img",{src:z.imageUrl,style:{objectFit:"cover",objectPosition:`${z.miniImageX??50}% ${z.miniImageY??50}%`,transformOrigin:`${z.miniImageX??50}% ${z.miniImageY??50}%`,transform:`scale(${z.miniImageScale??1})`},className:"w-full h-full",alt:""})}),f.jsx("span",{className:"font-bold text-stone-200 text-sm tracking-wide",children:z.name})]})}),f.jsx("td",{className:"px-6 py-4",children:f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsxs("div",{className:"flex flex-wrap gap-1",children:[(oe=z.tags)==null?void 0:oe.slice(0,3).map(Re=>f.jsx("span",{className:"text-[8px] uppercase bg-stone-900 px-1.5 py-0.5 rounded text-stone-500",children:Re},Re)),(((ye=z.tags)==null?void 0:ye.length)||0)>3&&f.jsxs("span",{className:"text-[8px] text-stone-700",children:["+",z.tags.length-3]})]}),f.jsxs("div",{className:"flex flex-wrap gap-1",children:[(he=z.hiddenTags)==null?void 0:he.slice(0,3).map(Re=>f.jsx("span",{className:"text-[8px] uppercase bg-amber-900/20 border border-amber-900/30 px-1.5 py-0.5 rounded text-amber-600",children:Re},Re)),(((Ue=z.hiddenTags)==null?void 0:Ue.length)||0)>3&&f.jsxs("span",{className:"text-[8px] text-amber-700",children:["+",z.hiddenTags.length-3]})]})]})}),f.jsxs("td",{className:"px-6 py-4 text-right space-x-3",children:[f.jsx("button",{onClick:()=>a(z),className:"text-emerald-500/70 hover:text-emerald-500 text-[10px] font-black uppercase tracking-widest transition-colors",children:""}),f.jsx("button",{onClick:()=>o(z.id),className:"text-stone-800 hover:text-red-500 text-[10px] font-black uppercase tracking-widest transition-colors",children:""})]})]},z.id)})})]})})})]}),f.jsxs("div",{className:"space-y-8",children:[f.jsxs("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl p-6 space-y-6 shadow-xl",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h2",{className:"text-xl font-serif text-stone-100 italic",children:" "}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] bg-stone-800 text-stone-400 px-2 py-0.5 rounded-full font-black",children:t.length}),t.length>0&&f.jsx("button",{onClick:()=>A(!1),className:"text-[8px] text-red-900 hover:text-red-500 uppercase font-black",children:""})]})]}),f.jsxs("form",{onSubmit:B,className:"flex gap-2",children:[f.jsx("input",{type:"text",value:S,onChange:z=>y(z.target.value),placeholder:" ...",className:"flex-grow bg-black/50 border border-stone-800 rounded-xl px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-all"}),f.jsx("button",{className:"bg-stone-800 hover:bg-stone-700 text-white p-2 rounded-xl transition-all",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{d:"M12 4v16m8-8H4",strokeWidth:2.5})})})]}),H(t,!1)]}),f.jsxs("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl p-6 space-y-6 shadow-xl relative overflow-hidden",children:[f.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-amber-500/5 rounded-full blur-2xl -translate-y-10 translate-x-10 pointer-events-none"}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h2",{className:"text-xl font-serif text-amber-500 italic",children:" "}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-[10px] bg-amber-900/20 text-amber-500 px-2 py-0.5 rounded-full font-black",children:r.length}),r.length>0&&f.jsx("button",{onClick:()=>A(!0),className:"text-[8px] text-red-900 hover:text-red-500 uppercase font-black",children:""})]})]}),f.jsxs("form",{onSubmit:Q,className:"flex gap-2",children:[f.jsx("input",{type:"text",value:x,onChange:z=>R(z.target.value),placeholder:"  ...",className:"flex-grow bg-black/50 border border-amber-900/30 rounded-xl px-3 py-2 text-xs text-stone-200 outline-none focus:border-amber-500/50 transition-all placeholder-amber-900/50"}),f.jsx("button",{className:"bg-amber-900/20 hover:bg-amber-900/40 text-amber-500 border border-amber-900/30 p-2 rounded-xl transition-all",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{d:"M12 4v16m8-8H4",strokeWidth:2.5})})})]}),H(r,!0)]})]})]})]})},Xg="modulepreload",Jg=function(s){return"/raz/"+s},ch={},uh=function(t,r,o){let a=Promise.resolve();if(r&&r.length>0){let h=function(v){return Promise.all(v.map(S=>Promise.resolve(S).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),g=(p==null?void 0:p.nonce)||(p==null?void 0:p.getAttribute("nonce"));a=h(r.map(v=>{if(v=Jg(v),v in ch)return;ch[v]=!0;const S=v.endsWith(".css"),y=S?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${y}`))return;const x=document.createElement("link");if(x.rel=S?"stylesheet":Xg,S||(x.as="script"),x.crossOrigin="",x.href=v,g&&x.setAttribute("nonce",g),document.head.appendChild(x),S)return new Promise((R,P)=>{x.addEventListener("load",R),x.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${v}`)))})}))}function u(h){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=h,window.dispatchEvent(p),!p.defaultPrevented)throw h}return a.then(h=>{for(const p of h||[])p.status==="rejected"&&u(p.reason);return t().catch(u)})},Zg=({characters:s,availableTags:t,availableHiddenTags:r,filterStates:o,onToggleTag:a,onClearFilters:u,onSelectCharacter:h})=>{var er;const[p,g]=V.useState("graph"),[v,S]=V.useState(""),[y,x]=V.useState(!1),[R,P]=V.useState(""),[B,Q]=V.useState([]),te=V.useRef(null),[ie,_e]=V.useState(!1),[A,$e]=V.useState(null),[H,z]=V.useState(null),[oe,ye]=V.useState(0),[he,Ue]=V.useState(!0),[Re,We]=V.useState(!1),Ke=V.useRef(null),pt=V.useRef(null),Ze=V.useRef(null),Te=V.useRef(null),W=V.useRef(new Map),[Z,C]=V.useState({x:0,y:0,k:1}),D=Object.keys(o).length;V.useEffect(()=>{if(p==="graph"){We(!0);const I=setTimeout(()=>We(!1),2200);return()=>clearTimeout(I)}},[A,ie,D,p]),V.useEffect(()=>{const I=J=>{te.current&&!te.current.contains(J.target)&&x(!1)};return y&&document.addEventListener("mousedown",I),()=>{document.removeEventListener("mousedown",I)}},[y]);const{nodes:w,links:T,uniqueColors:L}=V.useMemo(()=>{if(p!=="graph")return{nodes:[],links:[],uniqueColors:[]};const I=s.filter(ne=>A&&ne.id===A?!0:Object.entries(o).every(([Ce,Se])=>{var hn,Ot;const He=(hn=ne.tags)==null?void 0:hn.includes(Ce),st=(Ot=ne.hiddenTags)==null?void 0:Ot.includes(Ce),xt=He||st;return Se==="include"?xt:Se==="exclude"?!xt:!0})),J=new Set(I.map(ne=>ne.id)),le=new Set;A&&(le.add(A),I.forEach(ne=>{var Ce,Se;ne.id===A&&((Ce=ne.connections)==null||Ce.forEach(He=>{J.has(He.id)&&le.add(He.id)})),(Se=ne.connections)!=null&&Se.some(He=>He.id===A)&&le.add(ne.id)}));const fe=new Map,de=[...t],be=380,pe=260;de.forEach((ne,Ce)=>{const Se=Ce/de.length*2*Math.PI;fe.set(ne,{x:500+Math.cos(Se)*be,y:350+Math.sin(Se)*pe})});const De=I.map(ne=>{const Ce=W.current.get(ne.id);let Se=!1;if(A)Se=!le.has(ne.id);else if(ie){const xt=ne.connections||[],hn=I.filter(Ot=>{var tr;return Ot.id!==ne.id&&((tr=Ot.connections)==null?void 0:tr.some(nr=>nr.id===ne.id))});Se=xt.length+hn.length===0}let He=500,st=350;if(!Ce)if(ne.tags&&ne.tags.length>0){let xt=0,hn=0,Ot=0;ne.tags.forEach(tr=>{const nr=fe.get(tr);nr&&(xt+=nr.x,hn+=nr.y,Ot++)}),Ot>0?(He=xt/Ot,st=hn/Ot,He+=(Math.random()-.5)*80,st+=(Math.random()-.5)*80):(He+=(Math.random()-.5)*150,st+=(Math.random()-.5)*150)}else He+=(Math.random()-.5)*120,st+=(Math.random()-.5)*120;return{id:ne.id,name:ne.name,imageUrl:ne.imageUrl,miniImageScale:ne.miniImageScale,miniImageX:ne.miniImageX,miniImageY:ne.miniImageY,x:(Ce==null?void 0:Ce.x)??He,y:(Ce==null?void 0:Ce.y)??st,vx:Ce==null?void 0:Ce.vx,vy:Ce==null?void 0:Ce.vy,isDimmed:Se,tags:ne.tags,hiddenTags:ne.hiddenTags}}),tt=new Map;De.forEach(ne=>tt.set(ne.id,ne)),W.current=tt;const Nt=[],rt=new Set,qe=new Map;return I.forEach(ne=>{var Ce;(Ce=ne.connections)==null||Ce.forEach(Se=>{if(J.has(Se.id)){const He=Se.color||"#10b981";rt.add(He);let st=!1;A&&(st=ne.id!==A&&Se.id!==A),Nt.push({source:ne.id,target:Se.id,role:Se.role,color:He,isDouble:!1,isHidden:st}),qe.set(`${ne.id}-${Se.id}`,!0)}})}),Nt.forEach(ne=>{const Ce=typeof ne.source=="string"?ne.source:ne.source.id,Se=typeof ne.target=="string"?ne.target:ne.target.id;qe.has(`${Se}-${Ce}`)&&(ne.isDouble=!0)}),{nodes:De,links:Nt,uniqueColors:Array.from(rt)}},[s,ie,A,o,t,p]),K=I=>{if(!Ke.current||!Te.current)return;const J=w.find(le=>le.id===I);!J||J.x===void 0||J.y===void 0||uh(()=>import("https://esm.sh/d3@7"),[]).then(le=>{const fe=le.select(Ke.current),de=1e3,be=700,pe=.8,De=de/2-J.x*pe,tt=be/2-J.y*pe;fe.transition().duration(1200).ease(le.easePolyInOut.exponent(3)).call(Te.current.transform,le.zoomIdentity.translate(De,tt).scale(pe))})};V.useEffect(()=>{if(A&&p==="graph"){const I=setTimeout(()=>K(A),100);return()=>clearTimeout(I)}},[A,p]),V.useEffect(()=>{!Ke.current||p!=="graph"||(Ue(!0),uh(()=>import("https://esm.sh/d3@7"),[]).then(I=>{const J=I.select(Ke.current),le=I.select(pt.current),fe=I.zoom().scaleExtent([.1,4]).on("zoom",pe=>{le.attr("transform",pe.transform),C({x:pe.transform.x,y:pe.transform.y,k:pe.transform.k}),z(null)});Te.current=fe,J.call(fe);const de=I.forceSimulation(w).force("link",I.forceLink(T.filter(pe=>!pe.isHidden)).id(pe=>pe.id).distance(pe=>{const De=pe.source.tags||[],tt=pe.target.tags||[],Nt=De.some(rt=>tt.includes(rt));return De.length===0||tt.length===0?250:Nt?150:450}).strength(A?.05:.03)).force("charge",I.forceManyBody().strength(A?-2e3:-1200)).force("center",I.forceCenter(500,350)).force("gravityX",I.forceX(500).strength(.005)).force("gravityY",I.forceY(350).strength(.005)).force("collision",I.forceCollide().radius(75)).alphaDecay(.06);de.on("tick",()=>{ye(pe=>pe+1),de.alpha()<.2&&Ue(!1)}),Ze.current=de;const be=pe=>{function De(rt,qe){rt.active||pe.alphaTarget(.3).restart(),qe.fx=qe.x,qe.fy=qe.y,z(null)}function tt(rt,qe){qe.fx=rt.x,qe.fy=rt.y}function Nt(rt,qe){rt.active||pe.alphaTarget(0),qe.fx=null,qe.fy=null}return I.drag().on("start",De).on("drag",tt).on("end",Nt)};return le.selectAll(".node-group").data(w).call(be(de)),()=>de.stop()}))},[w,T,p]);const ue=I=>{const J=typeof I.source=="string"?w.find(He=>He.id===I.source):I.source,le=typeof I.target=="string"?w.find(He=>He.id===I.target):I.target;if(!(J!=null&&J.x)||!(J!=null&&J.y)||!(le!=null&&le.x)||!(le!=null&&le.y))return null;const fe=52,de=le.x-J.x,be=le.y-J.y,pe=Math.sqrt(de*de+be*be);if(pe<fe*2.2)return null;const De=de/pe,tt=be/pe,Nt=J.x+fe*De,rt=J.y+fe*tt,qe=le.x-fe*De,ne=le.y-fe*tt;let Ce="",Se={x:0,y:0};if(I.isDouble){const st=(J.x+le.x)/2+-tt*50,xt=(J.y+le.y)/2+De*50;Ce=`M${Nt},${rt} Q${st},${xt} ${qe},${ne}`,Se.x=.25*Nt+.5*st+.25*qe,Se.y=.25*rt+.5*xt+.25*ne}else Ce=`M${Nt},${rt} L${qe},${ne}`,Se.x=(Nt+qe)/2,Se.y=(rt+ne)/2;return{path:Ce,textPos:Se}},ke=I=>I.replace("#",""),we=I=>{Q(J=>J.includes(I)?J.filter(le=>le!==I):[...J,I])},et=V.useMemo(()=>s.filter(I=>{const J=I.name.toLowerCase().includes(R.toLowerCase()),le=B.length===0||B.every(fe=>{var de,be;return((de=I.tags)==null?void 0:de.includes(fe))||((be=I.hiddenTags)==null?void 0:be.includes(fe))});return J&&le}).sort((I,J)=>I.name.localeCompare(J.name)),[s,R,B]),{outgoingConnections:In,incomingConnections:Gt,currentTableChar:fn}=V.useMemo(()=>{if(p!=="table"||!v)return{outgoingConnections:[],incomingConnections:[],currentTableChar:null};const I=s.find(fe=>fe.id===v),J=((I==null?void 0:I.connections)||[]).map(fe=>{const de=s.find(be=>be.id===fe.id);return{...fe,targetChar:de}}),le=s.filter(fe=>{var de;return(de=fe.connections)==null?void 0:de.some(be=>be.id===v)}).map(fe=>{var be;const de=(be=fe.connections)==null?void 0:be.find(pe=>pe.id===v);return{sourceChar:fe,role:de==null?void 0:de.role,color:de==null?void 0:de.color}});return{outgoingConnections:J,incomingConnections:le,currentTableChar:I}},[s,v,p]);return f.jsxs("div",{className:`flex flex-col h-full space-y-4 md:space-y-4 select-none relative ${Re?"is-mounting":""}`,onClick:()=>z(null),children:[f.jsxs("div",{className:"bg-[#0f0f0f]/50 border border-stone-900 rounded-2xl p-4 flex flex-col gap-4 backdrop-blur-sm shadow-lg relative z-20",children:[f.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[f.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[f.jsxs("div",{className:"bg-stone-950 p-1 rounded-lg border border-stone-800 flex items-center",children:[f.jsx("button",{onClick:()=>g("graph"),className:`px-4 py-1.5 rounded-md text-[10px] uppercase font-bold tracking-wider transition-all ${p==="graph"?"bg-stone-800 text-stone-100 shadow-sm":"text-stone-500 hover:text-stone-300"}`,children:""}),f.jsx("button",{onClick:()=>g("table"),className:`px-4 py-1.5 rounded-md text-[10px] uppercase font-bold tracking-wider transition-all ${p==="table"?"bg-stone-800 text-stone-100 shadow-sm":"text-stone-500 hover:text-stone-300"}`,children:""})]}),p==="graph"&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"h-6 w-px bg-stone-800 hidden md:block"}),f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[f.jsx("input",{type:"checkbox",checked:ie,disabled:!!A,onChange:I=>_e(I.target.checked),className:"sr-only"}),f.jsx("div",{className:`w-4 h-4 border border-stone-700 rounded transition-colors ${ie?"bg-emerald-600 border-emerald-500":"bg-transparent"}`,children:ie&&f.jsx("svg",{className:"w-3.5 h-3.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),f.jsx("span",{className:`text-[11px] uppercase tracking-wider font-bold text-stone-500 group-hover:text-stone-300 transition-colors ${A?"opacity-30":""}`,children:" "})]})]})]}),p==="graph"?A&&f.jsx("button",{onClick:()=>{$e(null),Ue(!0)},className:"w-full md:w-auto bg-emerald-950/30 border border-emerald-900/50 text-emerald-500 px-4 py-2 rounded-full text-[10px] uppercase tracking-[0.2em] font-black hover:bg-emerald-900/40 transition-all",children:" "}):f.jsxs("div",{className:"w-full md:w-80 relative z-50",ref:te,children:[f.jsxs("button",{onClick:()=>x(!y),className:"w-full bg-stone-950 border border-stone-800 text-stone-300 text-xs py-2.5 pl-4 pr-10 rounded-xl text-left focus:border-emerald-900 transition-colors flex items-center justify-between",children:[f.jsx("span",{className:v?"":"text-stone-500 italic",children:v?(er=s.find(I=>I.id===v))==null?void 0:er.name:"--   --"}),f.jsx("svg",{className:`w-4 h-4 text-stone-600 transition-transform ${y?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),y&&f.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-[#0a0a0a] border border-stone-800 rounded-xl shadow-2xl overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200 flex flex-col max-h-[400px]",children:[f.jsxs("div",{className:"p-3 bg-stone-900/50 border-b border-stone-900 space-y-3 shrink-0 backdrop-blur-md",children:[f.jsx("input",{type:"text",placeholder:"...",value:R,onChange:I=>P(I.target.value),className:"w-full bg-stone-950 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-colors",autoFocus:!0}),(t.length>0||r.length>0)&&f.jsxs("div",{className:"flex flex-wrap gap-1.5 max-h-20 overflow-y-auto custom-scrollbar",children:[t.map(I=>{const J=B.includes(I);return f.jsx("button",{onClick:()=>we(I),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${J?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:I},I)}),r.map(I=>{const J=B.includes(I);return f.jsx("button",{onClick:()=>we(I),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${J?"bg-amber-500/20 border-amber-500/40 text-amber-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-amber-500"}`,children:I},I)})]})]}),f.jsx("div",{className:"overflow-y-auto p-1 custom-scrollbar",children:et.length>0?et.map(I=>f.jsxs("button",{onClick:()=>{S(I.id),x(!1),P(""),Q([])},className:`w-full flex items-center gap-3 p-2 hover:bg-stone-900 rounded-lg text-left transition-colors group ${v===I.id?"bg-stone-900/80":""}`,children:[f.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:f.jsx("img",{src:I.imageUrl,style:{objectPosition:`${I.miniImageX??50}% ${I.miniImageY??50}%`,transform:`scale(${I.miniImageScale??1})`,transformOrigin:`${I.miniImageX??50}% ${I.miniImageY??50}%`},className:"w-full h-full object-cover",alt:""})}),f.jsxs("div",{className:"min-w-0",children:[f.jsx("span",{className:`text-xs font-bold block truncate ${v===I.id?"text-emerald-400":"text-stone-300"}`,children:I.name}),I.tags&&I.tags.length>0&&f.jsxs("span",{className:"text-[8px] text-stone-600 truncate block mt-0.5",children:[I.tags.slice(0,3).join(", "),I.tags.length>3?"...":""]})]}),v===I.id&&f.jsx("div",{className:"ml-auto text-emerald-500",children:f.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]},I.id)):f.jsx("div",{className:"text-center py-4 text-[10px] text-stone-600 italic",children:"  "})})]})]})]}),p==="graph"&&(t.length>0||r.length>0)&&f.jsxs("div",{className:"flex flex-wrap items-center gap-2 pt-3 border-t border-stone-800/50 animate-in fade-in slide-in-from-top-1 duration-500",children:[f.jsx("span",{className:"text-[9px] uppercase tracking-[0.2em] font-black text-stone-600 mr-2",children:":"}),t.map(I=>{const J=o[I]||"none";return f.jsxs("button",{onClick:()=>a(I),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${J==="include"?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":J==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-stone-400 hover:border-stone-700"}`,children:[J==="include"&&f.jsx("span",{className:"text-emerald-500",children:"+"}),J==="exclude"&&f.jsx("span",{className:"text-red-500",children:""}),I]},I)}),r.map(I=>{const J=o[I]||"none";return f.jsxs("button",{onClick:()=>a(I),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${J==="include"?"bg-amber-500/10 border-amber-500/40 text-amber-400 shadow-[0_0_15px_rgba(245,158,11,0.1)]":J==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-amber-500 hover:border-amber-900/30"}`,children:[J==="include"&&f.jsx("span",{className:"text-amber-500",children:"+"}),J==="exclude"&&f.jsx("span",{className:"text-red-500",children:""}),I]},I)}),D>0&&f.jsx("button",{onClick:u,className:"ml-2 text-[9px] uppercase tracking-[0.2em] font-black text-stone-700 hover:text-red-500 transition-colors",children:""})]})]}),f.jsxs("div",{className:"relative z-0 w-full h-full min-h-[500px] bg-[#030303] border border-stone-900 rounded-2xl overflow-hidden shadow-2xl graph-container-reveal",children:[p==="graph"&&f.jsxs(f.Fragment,{children:[f.jsxs("svg",{ref:Ke,viewBox:"0 0 1000 700",className:"w-full h-full touch-none cursor-grab active:cursor-grabbing",children:[f.jsx("defs",{children:L.map(I=>f.jsx("marker",{id:`arrow-${ke(I)}`,markerWidth:"8",markerHeight:"6",refX:"7.5",refY:"3",orient:"auto",children:f.jsx("path",{d:"M0,0 L8,3 L0,6",fill:I})},`arrow-${ke(I)}`))}),f.jsxs("g",{ref:pt,children:[T.map((I,J)=>{const le=ue(I);if(!le)return null;const fe=I.color||"#10b981",de=I.isHidden;return f.jsxs("g",{className:`transition-opacity duration-700 ${de?"opacity-0":"opacity-100"}`,children:[f.jsx("path",{d:le.path,fill:"none",stroke:fe,strokeWidth:A?"3":"1.5",strokeOpacity:A?"0.8":"0.3",markerEnd:`url(#arrow-${ke(fe)})`,className:"link-path",style:Re?{animationDelay:`${J*.015}s`}:{}}),A&&I.role&&!de&&f.jsxs("g",{transform:`translate(${le.textPos.x}, ${le.textPos.y})`,children:[f.jsx("text",{dy:"-14",textAnchor:"middle",className:"fill-[#030303] text-[10px] font-bold uppercase tracking-[0.2em]",style:{paintOrder:"stroke",stroke:"#030303",strokeWidth:"5px"},children:I.role}),f.jsx("text",{dy:"-14",textAnchor:"middle",fill:fe,className:"text-[10px] font-bold uppercase tracking-[0.2em] opacity-90",children:I.role})]})]},`link-${J}-${oe}`)}),w.map((I,J)=>{const le=A===I.id;return f.jsx("g",{transform:`translate(${I.x||500}, ${I.y||350})`,className:`node-group cursor-pointer group ${I.isDimmed?"opacity-0 pointer-events-none":"opacity-100"}`,onClick:fe=>{if(fe.stopPropagation(),I.x&&I.y){const de=I.x*Z.k+Z.x,be=I.y*Z.k+Z.y;z({id:I.id,x:de,y:be})}},children:f.jsxs("g",{className:"node-animator",style:Re?{animationDelay:`${J*.06}s`}:{},children:[f.jsxs("g",{className:"node-content",children:[f.jsx("circle",{r:"48",fill:"#1c1917"}),f.jsx("circle",{r:"46",fill:"#050505",stroke:le?"#10b981":"#292524",strokeWidth:le?"4":"1.5"}),f.jsx("clipPath",{id:`clip-${I.id}`,children:f.jsx("circle",{r:"45"})}),f.jsx("foreignObject",{x:"-45",y:"-45",width:"90",height:"90",clipPath:`url(#clip-${I.id})`,children:f.jsx("div",{className:"w-full h-full bg-black flex items-center justify-center overflow-hidden",children:f.jsx("img",{src:I.imageUrl,alt:"",style:{width:"100%",height:"100%",objectFit:"cover",objectPosition:`${I.miniImageX??50}% ${I.miniImageY??50}%`,transformOrigin:`${I.miniImageX??50}% ${I.miniImageY??50}%`,transform:`scale(${I.miniImageScale??1})`},className:"opacity-90 group-hover:opacity-100 group-hover:scale-110 transition-all duration-500"})})})]}),f.jsx("text",{y:"70",textAnchor:"middle",className:"fill-stone-500 text-[12px] font-bold uppercase tracking-[0.15em] group-hover:fill-stone-100 transition-colors drop-shadow-[0_2px_2px_rgba(0,0,0,0.8)] font-serif",children:I.name})]})},I.id)})]})]}),he&&f.jsx("div",{className:"absolute inset-0 bg-[#030303]/40 flex items-center justify-center backdrop-blur-[1px] pointer-events-none",children:f.jsx("div",{className:"text-[10px] uppercase tracking-[0.4em] font-black text-emerald-500/50 animate-pulse",children:" ..."})})]}),p==="table"&&f.jsx("div",{className:"w-full h-full overflow-y-auto custom-scrollbar p-6 md:p-10",children:v?f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16",children:[f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center gap-3 border-b border-stone-800 pb-4",children:[f.jsx("span",{className:"text-emerald-500 bg-emerald-900/10 px-2 py-1 rounded text-xs font-bold",children:"OUT"}),f.jsxs("h3",{className:"text-lg font-serif text-stone-200 italic",children:["  ",fn==null?void 0:fn.name,"?"]}),f.jsx("span",{className:"ml-auto text-stone-600 text-xs font-bold",children:In.length})]}),f.jsx("div",{className:"space-y-3",children:In.length===0?f.jsx("p",{className:"text-stone-700 text-xs italic py-4",children:"       ..."}):In.map((I,J)=>{var le,fe,de,be,pe,De;return f.jsxs("div",{className:"flex items-start gap-4 p-4 bg-stone-900/30 border border-stone-900/50 rounded-xl hover:bg-stone-900/50 hover:border-emerald-900/30 transition-all group",children:[f.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:f.jsx("img",{src:(le=I.targetChar)==null?void 0:le.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${((fe=I.targetChar)==null?void 0:fe.miniImageX)??50}% ${((de=I.targetChar)==null?void 0:de.miniImageY)??50}%`,transform:`scale(${((be=I.targetChar)==null?void 0:be.miniImageScale)??1})`,transformOrigin:`${((pe=I.targetChar)==null?void 0:pe.miniImageX)??50}% ${((De=I.targetChar)==null?void 0:De.miniImageY)??50}%`},alt:""})}),f.jsxs("div",{className:"flex-grow min-w-0",children:[f.jsxs("div",{className:"flex justify-between items-baseline",children:[f.jsx("h4",{className:"text-stone-300 font-bold text-sm truncate",children:I.name}),f.jsx("button",{onClick:()=>h(I.id),className:"text-[9px] uppercase font-bold text-stone-700 hover:text-emerald-500 transition-colors opacity-0 group-hover:opacity-100",children:""})]}),f.jsx("p",{className:"text-stone-500 text-xs mt-1 font-medium",children:I.role})]}),f.jsx("div",{className:"w-1.5 h-8 rounded-full self-center",style:{backgroundColor:I.color||"#10b981"}})]},J)})})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center gap-3 border-b border-stone-800 pb-4",children:[f.jsx("span",{className:"text-blue-500 bg-blue-900/10 px-2 py-1 rounded text-xs font-bold",children:"IN"}),f.jsxs("h3",{className:"text-lg font-serif text-stone-200 italic",children:["  ",fn==null?void 0:fn.name,"?"]}),f.jsx("span",{className:"ml-auto text-stone-600 text-xs font-bold",children:Gt.length})]}),f.jsx("div",{className:"space-y-3",children:Gt.length===0?f.jsx("p",{className:"text-stone-700 text-xs italic py-4",children:"    ..."}):Gt.map((I,J)=>{var le,fe,de,be,pe,De,tt;return f.jsxs("div",{className:"flex items-start gap-4 p-4 bg-stone-900/30 border border-stone-900/50 rounded-xl hover:bg-stone-900/50 hover:border-blue-900/30 transition-all group",children:[f.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:f.jsx("img",{src:(le=I.sourceChar)==null?void 0:le.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${((fe=I.sourceChar)==null?void 0:fe.miniImageX)??50}% ${((de=I.sourceChar)==null?void 0:de.miniImageY)??50}%`,transform:`scale(${((be=I.sourceChar)==null?void 0:be.miniImageScale)??1})`,transformOrigin:`${((pe=I.sourceChar)==null?void 0:pe.miniImageX)??50}% ${((De=I.sourceChar)==null?void 0:De.miniImageY)??50}%`},alt:""})}),f.jsxs("div",{className:"flex-grow min-w-0",children:[f.jsxs("div",{className:"flex justify-between items-baseline",children:[f.jsx("h4",{className:"text-stone-300 font-bold text-sm truncate",children:(tt=I.sourceChar)==null?void 0:tt.name}),f.jsx("button",{onClick:()=>h(I.sourceChar.id),className:"text-[9px] uppercase font-bold text-stone-700 hover:text-blue-500 transition-colors opacity-0 group-hover:opacity-100",children:""})]}),f.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[f.jsx("span",{className:"text-stone-600 text-[10px] uppercase tracking-wider",children:"  :"}),f.jsx("p",{className:"text-stone-400 text-xs font-medium",children:I.role})]})]}),f.jsx("div",{className:"w-1.5 h-8 rounded-full self-center",style:{backgroundColor:I.color||"#10b981"}})]},J)})})]})]}):f.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-stone-600 space-y-4",children:[f.jsx("svg",{className:"w-16 h-16 opacity-30",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),f.jsx("p",{className:"text-sm italic font-serif opacity-70",children:"    ,    "})]})}),H&&p==="graph"&&f.jsx("div",{className:"absolute z-[100] animate-in zoom-in-95 fade-in duration-300",style:{left:H.x+40,top:H.y-40},onClick:I=>I.stopPropagation(),children:f.jsxs("div",{className:"bg-[#0f0f0f]/95 border border-stone-800 rounded-xl overflow-hidden shadow-2xl min-w-[200px] backdrop-blur-md",children:[f.jsx("button",{onClick:()=>h(H.id),className:"w-full text-left px-5 py-3 text-[11px] uppercase tracking-wider font-bold text-stone-200 hover:bg-emerald-900/40 border-b border-stone-900",children:" "}),f.jsx("button",{onClick:()=>{$e(H.id),z(null),Ue(!0)},className:"w-full text-left px-5 py-3 text-[11px] uppercase tracking-wider font-bold text-emerald-400 hover:bg-emerald-900/40",children:" "})]})})]})]})},ev=({worlds:s,onUpdate:t,isAdmin:r})=>{const[o,a]=V.useState(!1),[u,h]=V.useState({type:""}),[p,g]=V.useState(!1),v=()=>{if(!u.name)return;const y={id:Date.now().toString(),name:u.name||"",type:u.type||"",description:u.description||"",imageUrl:u.imageUrl||"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?q=80&w=800&auto=format&fit=crop"};t([...s,y]),a(!1),h({type:""})},S=async y=>{var R;const x=(R=y.target.files)==null?void 0:R[0];if(x){g(!0);try{const P=await jc(x);h(B=>({...B,imageUrl:P}))}catch(P){console.error("Failed to process image",P),alert("  ")}finally{g(!1)}}};return f.jsxs("div",{className:"space-y-12 animate-in fade-in duration-700",children:[f.jsxs("div",{className:"flex justify-between items-baseline",children:[f.jsx("h1",{className:"text-5xl font-serif font-medium text-stone-100",children:""}),r&&f.jsx("button",{onClick:()=>a(!0),className:"bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 px-6 py-2 rounded-full text-[10px] uppercase tracking-widest font-bold",children:"  "})]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:s.map(y=>f.jsxs("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-2xl overflow-hidden group hover:border-emerald-900/30 transition-all",children:[f.jsxs("div",{className:"aspect-video relative",children:[f.jsx("img",{src:y.imageUrl,className:"w-full h-full object-cover opacity-60 group-hover:opacity-100 transition-opacity",alt:""}),f.jsx("div",{className:"absolute top-4 left-4 bg-black/80 px-3 py-1 rounded text-[9px] uppercase tracking-widest font-bold text-emerald-500 border border-emerald-900/50",children:y.type})]}),f.jsxs("div",{className:"p-6 space-y-3",children:[f.jsx("h3",{className:"text-xl font-serif text-stone-100",children:y.name}),f.jsx("p",{className:"text-stone-500 text-sm leading-relaxed line-clamp-3",children:y.description}),r&&f.jsx("button",{onClick:()=>t(s.filter(x=>x.id!==y.id)),className:"text-red-900/50 hover:text-red-500 text-[9px] uppercase font-bold tracking-widest pt-4",children:""})]})]},y.id))}),o&&f.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-md flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-[#0f0f0f] border border-stone-800 w-full max-w-lg rounded-2xl p-6 md:p-8 space-y-6 max-h-[90vh] flex flex-col overflow-hidden shadow-2xl",children:[f.jsx("h2",{className:"text-2xl font-serif text-stone-100 shrink-0",children:"  "}),f.jsxs("div",{className:"space-y-4 overflow-y-auto custom-scrollbar pr-2",children:[f.jsx("input",{placeholder:" (.  )",className:"w-full bg-stone-900 border border-stone-800 p-3 rounded-lg text-stone-200 outline-none focus:border-emerald-900",value:u.name||"",onChange:y=>h({...u,name:y.target.value})}),f.jsxs("select",{className:"w-full bg-stone-900 border border-stone-800 p-3 rounded-lg text-stone-200 outline-none",value:u.type,onChange:y=>h({...u,type:y.target.value}),children:[f.jsx("option",{children:""}),f.jsx("option",{children:""}),f.jsx("option",{children:""}),f.jsx("option",{children:""})]}),f.jsx("textarea",{placeholder:"...",className:"w-full bg-stone-900 border border-stone-800 p-3 rounded-lg text-stone-200 h-32 outline-none resize-none",value:u.description||"",onChange:y=>h({...u,description:y.target.value})}),f.jsxs("div",{className:"flex gap-4 items-center",children:[f.jsxs("label",{className:`cursor-pointer flex items-center gap-2 ${p?"opacity-50":""}`,children:[f.jsx("input",{type:"file",onChange:S,className:"hidden",disabled:p,accept:"image/*"}),f.jsx("div",{className:"text-xs text-stone-500 hover:text-stone-300 border border-stone-800 px-3 py-1.5 rounded-lg transition-colors",children:p?"...":" "})]}),u.imageUrl&&u.imageUrl.startsWith("data:")&&f.jsx("span",{className:"text-emerald-500 text-[9px] font-bold",children:"   "})]})]}),f.jsxs("div",{className:"flex gap-4 shrink-0 pt-2",children:[f.jsx("button",{onClick:()=>a(!1),className:"flex-1 py-3 text-[10px] font-bold uppercase text-stone-500 hover:text-stone-300 transition-colors",children:""}),f.jsx("button",{onClick:v,disabled:p,className:"flex-1 py-3 bg-emerald-900/30 text-emerald-500 border border-emerald-900/50 rounded-lg font-bold text-[10px] uppercase disabled:opacity-50 hover:bg-emerald-900/50 transition-colors",children:""})]})]})})]})},tv=({notes:s,onUpdate:t,isAdmin:r})=>{const[o,a]=V.useState(!1),[u,h]=V.useState({}),p=()=>{if(!u.title)return;const g={id:Date.now().toString(),title:u.title||"",content:u.content||"",date:new Date().toLocaleDateString("ru-RU")};t([g,...s]),a(!1),h({})};return f.jsxs("div",{className:"space-y-12 animate-in fade-in duration-700 max-w-4xl mx-auto",children:[f.jsxs("div",{className:"flex justify-between items-baseline",children:[f.jsx("h1",{className:"text-5xl font-serif font-medium text-stone-100",children:""}),r&&f.jsx("button",{onClick:()=>a(!0),className:"text-emerald-500 text-[10px] uppercase tracking-widest font-bold hover:text-emerald-400 transition-colors",children:"+  "})]}),f.jsxs("div",{className:"space-y-8",children:[s.length===0&&f.jsx("div",{className:"py-20 text-center text-stone-700 italic font-serif",children:"  .    ."}),s.map(g=>f.jsxs("article",{className:"border-l border-stone-800 pl-8 relative space-y-4 py-2 group",children:[f.jsx("div",{className:"absolute -left-[5px] top-4 w-2 h-2 rounded-full bg-stone-800 group-hover:bg-emerald-500 transition-colors"}),f.jsxs("div",{className:"flex justify-between items-baseline",children:[f.jsx("h3",{className:"text-2xl font-serif text-stone-200",children:g.title}),f.jsx("span",{className:"text-[10px] font-bold text-stone-600 uppercase tracking-widest",children:g.date})]}),f.jsx("p",{className:"text-stone-400 leading-relaxed whitespace-pre-wrap font-light",children:g.content}),r&&f.jsx("button",{onClick:()=>t(s.filter(v=>v.id!==g.id)),className:"text-[9px] uppercase font-bold text-red-900/30 hover:text-red-500 pt-2 transition-colors",children:" "})]},g.id))]}),o&&f.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-md flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-[#0f0f0f] border border-stone-800 w-full max-w-2xl rounded-2xl p-6 md:p-10 space-y-6 md:space-y-8 shadow-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[f.jsx("h2",{className:"text-3xl font-serif text-stone-100 italic shrink-0",children:"  "}),f.jsxs("div",{className:"space-y-6 overflow-y-auto custom-scrollbar pr-2 flex-grow",children:[f.jsx("input",{placeholder:" ...",className:"w-full bg-transparent border-b border-stone-800 pb-2 text-2xl font-serif text-stone-100 outline-none focus:border-emerald-900 transition-colors",value:u.title||"",onChange:g=>h({...u,title:g.target.value})}),f.jsx("textarea",{placeholder:"     ?..",className:"w-full bg-[#050505] border border-stone-900 p-6 rounded-xl text-stone-300 min-h-[250px] outline-none focus:border-emerald-900/50 transition-all resize-none leading-relaxed",value:u.content||"",onChange:g=>h({...u,content:g.target.value})})]}),f.jsxs("div",{className:"flex gap-6 shrink-0 pt-2",children:[f.jsx("button",{onClick:()=>a(!1),className:"flex-1 py-4 text-[10px] font-bold uppercase text-stone-600 hover:text-stone-300 transition-colors",children:" "}),f.jsx("button",{onClick:p,className:"flex-2 py-4 bg-emerald-900/20 text-emerald-500 border border-emerald-900/50 rounded-lg font-bold text-[10px] uppercase hover:bg-emerald-900/30 transition-all",children:"  "})]})]})})]})},nv=({sessions:s,characters:t,onUpdate:r,isAdmin:o})=>{const[a,u]=V.useState(null),[h,p]=V.useState(null),[g,v]=V.useState(""),[S,y]=V.useState(!1),[x,R]=V.useState(""),[P,B]=V.useState(""),Q=V.useRef(null),te=s.find(H=>H.id===a);V.useEffect(()=>{Q.current&&Q.current.scrollIntoView({behavior:"smooth"})},[te==null?void 0:te.posts.length,a]);const ie=()=>{if(!x.trim())return;const H={id:Date.now().toString(),name:x,description:P,posts:[]};r([...s,H]),y(!1),R(""),B("")},_e=H=>{window.confirm("     ?")&&(r(s.filter(z=>z.id!==H)),a===H&&u(null))},A=H=>{if(!g.trim()||!h||!a)return;const z={id:Date.now().toString(),characterId:h,content:g,timestamp:Date.now(),type:"speech"},oe=s.map(ye=>ye.id===a?{...ye,posts:[...ye.posts,z]}:ye);r(oe),v("")},$e=H=>new Date(H).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return a?f.jsxs("div",{className:"h-[calc(100vh-8rem)] flex flex-col animate-in fade-in duration-300",children:[f.jsx("div",{className:"flex items-center justify-between pb-4 border-b border-stone-900 shrink-0",children:f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("button",{onClick:()=>u(null),className:"p-2 hover:bg-stone-900 rounded-full text-stone-500 transition-colors",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),f.jsxs("div",{children:[f.jsx("h2",{className:"text-2xl font-serif text-stone-100 italic",children:te==null?void 0:te.name}),f.jsx("p",{className:"text-[10px] uppercase tracking-widest text-stone-500",children:te==null?void 0:te.description})]})]})}),f.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar py-6 space-y-8 pr-2",children:[(te==null?void 0:te.posts.length)===0?f.jsx("div",{className:"text-center text-stone-700 italic text-sm mt-10",children:"...   ,   ."}):te==null?void 0:te.posts.map(H=>{const z=t.find(oe=>oe.id===H.characterId);return z?f.jsxs("div",{className:"flex gap-4 md:gap-6 group animate-in slide-in-from-bottom-2 duration-500",children:[f.jsx("div",{className:"shrink-0 flex flex-col items-center gap-2 mt-1",children:f.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 rounded-full border border-stone-800 overflow-hidden bg-black shadow-lg",children:f.jsx("img",{src:z.imageUrl,alt:z.name,style:{objectFit:"cover",objectPosition:`${z.miniImageX??50}% ${z.miniImageY??50}%`,transformOrigin:`${z.miniImageX??50}% ${z.miniImageY??50}%`,transform:`scale(${z.miniImageScale??1})`},className:"w-full h-full"})})}),f.jsxs("div",{className:"flex-grow max-w-4xl",children:[f.jsxs("div",{className:"flex items-baseline gap-3 mb-1",children:[f.jsx("span",{className:"text-stone-300 font-bold text-sm tracking-wide",children:z.name}),f.jsx("span",{className:"text-[9px] text-stone-700 font-mono",children:$e(H.timestamp)})]}),f.jsx("div",{className:"text-stone-400 leading-relaxed font-serif whitespace-pre-wrap text-[15px] md:text-[16px]",children:H.content})]})]},H.id):null}),f.jsx("div",{ref:Q})]}),f.jsx("div",{className:"mt-4 pt-4 border-t border-stone-900 shrink-0 bg-[#050505] z-10",children:f.jsxs("div",{className:"flex flex-col gap-3",children:[f.jsx("div",{className:"flex gap-2 overflow-x-auto custom-scrollbar pb-2",children:t.map(H=>f.jsxs("button",{onClick:()=>p(H.id),className:`flex items-center gap-2 px-3 py-1.5 rounded-full border transition-all shrink-0 ${h===H.id?"bg-emerald-900/20 border-emerald-500/50 text-emerald-100 pl-2":"bg-stone-900/30 border-stone-800 text-stone-500 hover:bg-stone-900"}`,children:[f.jsx("div",{className:"w-5 h-5 rounded-full overflow-hidden bg-black",children:f.jsx("img",{src:H.imageUrl,style:{objectFit:"cover",transform:`scale(${H.miniImageScale??1})`},className:"w-full h-full",alt:""})}),f.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:H.name})]},H.id))}),f.jsxs("div",{className:"relative",children:[f.jsx("textarea",{value:g,onChange:H=>v(H.target.value),onKeyDown:H=>{H.key==="Enter"&&!H.shiftKey&&(H.preventDefault(),A())},placeholder:h?" -...":"  ...",disabled:!h,className:"w-full bg-[#0f0f0f] border border-stone-800 rounded-xl p-4 pr-14 text-stone-300 outline-none focus:border-emerald-900/50 transition-colors resize-none h-24 custom-scrollbar font-serif"}),f.jsx("button",{onClick:()=>A(),disabled:!g.trim()||!h,className:"absolute right-3 bottom-3 p-2 bg-stone-800 text-stone-400 rounded-lg hover:bg-emerald-600 hover:text-white disabled:opacity-30 disabled:hover:bg-stone-800 disabled:hover:text-stone-400 transition-all",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})]})})]}):f.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[f.jsxs("div",{className:"flex justify-between items-baseline",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100",children:""}),f.jsx("p",{className:"text-stone-500 uppercase tracking-widest text-[10px]",children:"   "})]}),f.jsx("button",{onClick:()=>y(!0),className:"bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 px-6 py-2 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-emerald-900/30 transition-all",children:"+  "})]}),S&&f.jsxs("div",{className:"bg-[#0f0f0f]/50 border border-stone-800 p-6 rounded-2xl space-y-4 animate-in slide-in-from-top-4",children:[f.jsx("input",{autoFocus:!0,placeholder:"   ...",className:"w-full bg-stone-900/50 border border-stone-800 p-3 rounded-lg text-stone-200 outline-none focus:border-emerald-900",value:x,onChange:H=>R(H.target.value)}),f.jsx("input",{placeholder:" ...",className:"w-full bg-stone-900/50 border border-stone-800 p-3 rounded-lg text-stone-400 outline-none focus:border-emerald-900 text-sm",value:P,onChange:H=>B(H.target.value)}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{onClick:()=>y(!1),className:"px-4 py-2 text-[10px] uppercase font-bold text-stone-500",children:""}),f.jsx("button",{onClick:ie,className:"px-6 py-2 bg-emerald-700 hover:bg-emerald-600 text-white rounded-lg text-[10px] uppercase font-bold transition-colors",children:""})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[s.length===0&&!S&&f.jsx("div",{className:"col-span-full text-center py-20 opacity-50 italic font-serif",children:"   .   ."}),s.map(H=>f.jsxs("div",{onClick:()=>u(H.id),className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-2xl p-6 cursor-pointer hover:border-emerald-900/50 hover:bg-stone-900/30 transition-all group flex flex-col h-[200px]",children:[f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsx("h3",{className:"text-xl font-serif text-stone-200 group-hover:text-emerald-400 transition-colors",children:H.name}),f.jsxs("span",{className:"text-[10px] bg-stone-900 text-stone-500 px-2 py-1 rounded-md font-mono",children:[H.posts.length," "]})]}),f.jsx("p",{className:"text-sm text-stone-500 mt-2 line-clamp-2",children:H.description}),f.jsxs("div",{className:"mt-auto pt-4 border-t border-stone-900/50 flex justify-between items-center",children:[f.jsx("span",{className:"text-[9px] uppercase tracking-widest text-stone-600 font-bold group-hover:text-stone-400",children:"  "}),o&&f.jsx("button",{onClick:z=>{z.stopPropagation(),_e(H.id)},className:"text-stone-800 hover:text-red-500 p-1 transition-colors",children:f.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},H.id))]})]})},rv=({onConnect:s,onDisconnect:t,onClose:r,isConnected:o})=>f.jsx("div",{className:"fixed inset-0 z-[120] bg-black/95 backdrop-blur-md flex items-center justify-center p-6",onClick:r,children:f.jsxs("div",{className:"bg-[#0a0a0a] border border-emerald-900/50 w-full max-w-lg rounded-3xl p-8 space-y-8 shadow-[0_0_80px_rgba(16,185,129,0.05)]",onClick:a=>a.stopPropagation(),children:[f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-3xl font-serif text-emerald-500 italic",children:" "}),f.jsx("p",{className:"text-stone-500 text-[10px] uppercase tracking-widest mt-2",children:"  "})]}),f.jsx("button",{onClick:r,className:"text-stone-600 hover:text-stone-300 transition-colors",children:f.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o?f.jsxs("div",{className:"space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[f.jsxs("div",{className:"p-6 rounded-2xl border bg-emerald-950/20 border-emerald-500/30",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[f.jsx("div",{className:"w-3 h-3 rounded-full animate-pulse bg-emerald-500"}),f.jsx("span",{className:"text-sm font-bold uppercase tracking-widest text-emerald-400",children:" "})]}),f.jsx("div",{className:"space-y-2",children:f.jsx("p",{className:"text-[10px] text-stone-600 mt-2 leading-relaxed",children:"     .  ,     ,    ."})})]}),f.jsx("button",{onClick:t,className:"w-full py-4 rounded-xl border border-red-900/30 text-red-500/70 hover:bg-red-950/20 hover:text-red-500 hover:border-red-900/60 transition-all text-[10px] uppercase font-bold tracking-[0.2em]",children:" "})]}):f.jsxs("div",{className:"space-y-8",children:[f.jsxs("div",{className:"bg-stone-900/30 border border-stone-800 rounded-2xl p-6 text-center space-y-4",children:[f.jsx("div",{className:"w-16 h-16 bg-stone-900 rounded-full flex items-center justify-center mx-auto text-stone-600",children:f.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),f.jsx("p",{className:"text-stone-400 text-sm leading-relaxed",children:"  ,           ."})]}),f.jsx("button",{onClick:s,className:"w-full py-5 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 hover:border-emerald-500/50 text-emerald-500 rounded-xl text-[11px] uppercase font-bold tracking-[0.25em] transition-all shadow-lg shadow-emerald-900/10",children:""}),f.jsx("p",{className:"text-[9px] text-stone-600 text-center border-t border-stone-900 pt-4",children:":          ."})]})]})}),dh=[],fh=[],hh=[{id:"1",name:" ",age:34,imageUrl:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?q=80&w=800&auto=format&fit=crop",tags:[],hiddenTags:[],connections:[{id:"2",name:"  ",role:""}],additionalInfo:"      ,     . ,         ,         .     ,    ."},{id:"2",name:"  ",age:21,imageUrl:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?q=80&w=800&auto=format&fit=crop",tags:[],hiddenTags:[],connections:[{id:"1",name:" ",role:"  "}],additionalInfo:"   ,          .         .    ,        ."},{id:"3",name:"",age:"124 ",imageUrl:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?q=80&w=800&auto=format&fit=crop",tags:[],hiddenTags:[],connections:[{id:"1",name:" ",role:" "}],additionalInfo:"  ,       .         .      ."}],sv=()=>{};var ph={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dp={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $=function(s,t){if(!s)throw is(t)},is=function(s){return new Error("Firebase Database ("+dp.SDK_VERSION+") INTERNAL ASSERT FAILED: "+s)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fp=function(s){const t=[];let r=0;for(let o=0;o<s.length;o++){let a=s.charCodeAt(o);a<128?t[r++]=a:a<2048?(t[r++]=a>>6|192,t[r++]=a&63|128):(a&64512)===55296&&o+1<s.length&&(s.charCodeAt(o+1)&64512)===56320?(a=65536+((a&1023)<<10)+(s.charCodeAt(++o)&1023),t[r++]=a>>18|240,t[r++]=a>>12&63|128,t[r++]=a>>6&63|128,t[r++]=a&63|128):(t[r++]=a>>12|224,t[r++]=a>>6&63|128,t[r++]=a&63|128)}return t},iv=function(s){const t=[];let r=0,o=0;for(;r<s.length;){const a=s[r++];if(a<128)t[o++]=String.fromCharCode(a);else if(a>191&&a<224){const u=s[r++];t[o++]=String.fromCharCode((a&31)<<6|u&63)}else if(a>239&&a<365){const u=s[r++],h=s[r++],p=s[r++],g=((a&7)<<18|(u&63)<<12|(h&63)<<6|p&63)-65536;t[o++]=String.fromCharCode(55296+(g>>10)),t[o++]=String.fromCharCode(56320+(g&1023))}else{const u=s[r++],h=s[r++];t[o++]=String.fromCharCode((a&15)<<12|(u&63)<<6|h&63)}}return t.join("")},Rc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,t){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let a=0;a<s.length;a+=3){const u=s[a],h=a+1<s.length,p=h?s[a+1]:0,g=a+2<s.length,v=g?s[a+2]:0,S=u>>2,y=(u&3)<<4|p>>4;let x=(p&15)<<2|v>>6,R=v&63;g||(R=64,h||(x=64)),o.push(r[S],r[y],r[x],r[R])}return o.join("")},encodeString(s,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(s):this.encodeByteArray(fp(s),t)},decodeString(s,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(s):iv(this.decodeStringToByteArray(s,t))},decodeStringToByteArray(s,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let a=0;a<s.length;){const u=r[s.charAt(a++)],p=a<s.length?r[s.charAt(a)]:0;++a;const v=a<s.length?r[s.charAt(a)]:64;++a;const y=a<s.length?r[s.charAt(a)]:64;if(++a,u==null||p==null||v==null||y==null)throw new ov;const x=u<<2|p>>4;if(o.push(x),v!==64){const R=p<<4&240|v>>2;if(o.push(R),y!==64){const P=v<<6&192|y;o.push(P)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class ov extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const hp=function(s){const t=fp(s);return Rc.encodeByteArray(t,!0)},Ro=function(s){return hp(s).replace(/\./g,"")},uc=function(s){try{return Rc.decodeString(s,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lv(s){return pp(void 0,s)}function pp(s,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const r=t;return new Date(r.getTime());case Object:s===void 0&&(s={});break;case Array:s=[];break;default:return t}for(const r in t)!t.hasOwnProperty(r)||!av(r)||(s[r]=pp(s[r],t[r]));return s}function av(s){return s!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uv=()=>cv().__FIREBASE_DEFAULTS__,dv=()=>{if(typeof process>"u"||typeof ph>"u")return;const s=ph.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},fv=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=s&&uc(s[1]);return t&&JSON.parse(t)},mp=()=>{try{return sv()||uv()||dv()||fv()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},hv=s=>{var t,r;return(r=(t=mp())==null?void 0:t.emulatorHosts)==null?void 0:r[s]},pv=s=>{const t=hv(s);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const o=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),o]:[t.substring(0,r),o]},gp=()=>{var s;return(s=mp())==null?void 0:s.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,o)=>{r?this.reject(r):this.resolve(o),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,o))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function mv(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gv(s,t){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},o=t||"demo-project",a=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const h={iss:`https://securetoken.google.com/${o}`,aud:o,iat:a,exp:a+3600,auth_time:a,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Ro(JSON.stringify(r)),Ro(JSON.stringify(h)),""].join(".")}const qs={};function vv(){const s={prod:[],emulator:[]};for(const t of Object.keys(qs))qs[t]?s.emulator.push(t):s.prod.push(t);return s}function xv(s){let t=document.getElementById(s),r=!1;return t||(t=document.createElement("div"),t.setAttribute("id",s),r=!0),{created:r,element:t}}let mh=!1;function _v(s,t){if(typeof window>"u"||typeof document>"u"||!Pc(window.location.host)||qs[s]===t||qs[s]||mh)return;qs[s]=t;function r(x){return`__firebase__banner__${x}`}const o="__firebase__banner",u=vv().prod.length>0;function h(){const x=document.getElementById(o);x&&x.remove()}function p(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function g(x,R){x.setAttribute("width","24"),x.setAttribute("id",R),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function v(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{mh=!0,h()},x}function S(x,R){x.setAttribute("id",R),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function y(){const x=xv(o),R=r("text"),P=document.getElementById(R)||document.createElement("span"),B=r("learnmore"),Q=document.getElementById(B)||document.createElement("a"),te=r("preprendIcon"),ie=document.getElementById(te)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const _e=x.element;p(_e),S(Q,B);const A=v();g(ie,te),_e.append(ie,P,Q,A),document.body.appendChild(_e)}u?(P.innerText="Preview backend disconnected.",ie.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ie.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,P.innerText="Preview backend running in this workspace."),P.setAttribute("id",R)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function vp(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(yv())}function wv(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Cv(){return dp.NODE_ADMIN===!0}function kv(){try{return typeof indexedDB=="object"}catch{return!1}}function Nv(){return new Promise((s,t)=>{try{let r=!0;const o="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(o);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(o),s(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var u;t(((u=a.error)==null?void 0:u.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sv="FirebaseError";class fi extends Error{constructor(t,r,o){super(r),this.code=t,this.customData=o,this.name=Sv,Object.setPrototypeOf(this,fi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xp.prototype.create)}}class xp{constructor(t,r,o){this.service=t,this.serviceName=r,this.errors=o}create(t,...r){const o=r[0]||{},a=`${this.service}/${t}`,u=this.errors[t],h=u?Ev(u,o):"Error",p=`${this.serviceName}: ${h} (${a}).`;return new fi(a,p,o)}}function Ev(s,t){return s.replace(bv,(r,o)=>{const a=t[o];return a!=null?String(a):`<${o}?>`})}const bv=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ni(s){return JSON.parse(s)}function ht(s){return JSON.stringify(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _p=function(s){let t={},r={},o={},a="";try{const u=s.split(".");t=ni(uc(u[0])||""),r=ni(uc(u[1])||""),a=u[2],o=r.d||{},delete r.d}catch{}return{header:t,claims:r,data:o,signature:a}},Iv=function(s){const t=_p(s),r=t.claims;return!!r&&typeof r=="object"&&r.hasOwnProperty("iat")},Tv=function(s){const t=_p(s).claims;return typeof t=="object"&&t.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bn(s,t){return Object.prototype.hasOwnProperty.call(s,t)}function ts(s,t){if(Object.prototype.hasOwnProperty.call(s,t))return s[t]}function gh(s){for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t))return!1;return!0}function Po(s,t,r){const o={};for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&(o[a]=t.call(r,s[a],a,s));return o}function Do(s,t){if(s===t)return!0;const r=Object.keys(s),o=Object.keys(t);for(const a of r){if(!o.includes(a))return!1;const u=s[a],h=t[a];if(vh(u)&&vh(h)){if(!Do(u,h))return!1}else if(u!==h)return!1}for(const a of o)if(!r.includes(a))return!1;return!0}function vh(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jv(s){const t=[];for(const[r,o]of Object.entries(s))Array.isArray(o)?o.forEach(a=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(o));return t.length?"&"+t.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,r){r||(r=0);const o=this.W_;if(typeof t=="string")for(let y=0;y<16;y++)o[y]=t.charCodeAt(r)<<24|t.charCodeAt(r+1)<<16|t.charCodeAt(r+2)<<8|t.charCodeAt(r+3),r+=4;else for(let y=0;y<16;y++)o[y]=t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3],r+=4;for(let y=16;y<80;y++){const x=o[y-3]^o[y-8]^o[y-14]^o[y-16];o[y]=(x<<1|x>>>31)&4294967295}let a=this.chain_[0],u=this.chain_[1],h=this.chain_[2],p=this.chain_[3],g=this.chain_[4],v,S;for(let y=0;y<80;y++){y<40?y<20?(v=p^u&(h^p),S=1518500249):(v=u^h^p,S=1859775393):y<60?(v=u&h|p&(u|h),S=2400959708):(v=u^h^p,S=3395469782);const x=(a<<5|a>>>27)+v+g+S+o[y]&4294967295;g=p,p=h,h=(u<<30|u>>>2)&4294967295,u=a,a=x}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+p&4294967295,this.chain_[4]=this.chain_[4]+g&4294967295}update(t,r){if(t==null)return;r===void 0&&(r=t.length);const o=r-this.blockSize;let a=0;const u=this.buf_;let h=this.inbuf_;for(;a<r;){if(h===0)for(;a<=o;)this.compress_(t,a),a+=this.blockSize;if(typeof t=="string"){for(;a<r;)if(u[h]=t.charCodeAt(a),++h,++a,h===this.blockSize){this.compress_(u),h=0;break}}else for(;a<r;)if(u[h]=t[a],++h,++a,h===this.blockSize){this.compress_(u),h=0;break}}this.inbuf_=h,this.total_+=r}digest(){const t=[];let r=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let a=this.blockSize-1;a>=56;a--)this.buf_[a]=r&255,r/=256;this.compress_(this.buf_);let o=0;for(let a=0;a<5;a++)for(let u=24;u>=0;u-=8)t[o]=this.chain_[a]>>u&255,++o;return t}}function Dc(s,t){return`${s} failed: ${t} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv=function(s){const t=[];let r=0;for(let o=0;o<s.length;o++){let a=s.charCodeAt(o);if(a>=55296&&a<=56319){const u=a-55296;o++,$(o<s.length,"Surrogate pair missing trail surrogate.");const h=s.charCodeAt(o)-56320;a=65536+(u<<10)+h}a<128?t[r++]=a:a<2048?(t[r++]=a>>6|192,t[r++]=a&63|128):a<65536?(t[r++]=a>>12|224,t[r++]=a>>6&63|128,t[r++]=a&63|128):(t[r++]=a>>18|240,t[r++]=a>>12&63|128,t[r++]=a>>6&63|128,t[r++]=a&63|128)}return t},qo=function(s){let t=0;for(let r=0;r<s.length;r++){const o=s.charCodeAt(r);o<128?t++:o<2048?t+=2:o>=55296&&o<=56319?(t+=4,r++):t+=3}return t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(s){return s&&s._delegate?s._delegate:s}class ri{constructor(t,r,o){this.name=t,this.instanceFactory=r,this.type=o,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const o=new Ko;if(this.instancesDeferred.set(r,o),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&o.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),o=(t==null?void 0:t.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(o)return null;throw a}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Mv(t))try{this.getOrInitializeService({instanceIdentifier:gr})}catch{}for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const u=this.getOrInitializeService({instanceIdentifier:a});o.resolve(u)}catch{}}}}clearInstance(t=gr){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=gr){return this.instances.has(t)}getOptions(t=gr){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(`${this.name}(${o}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:o,options:r});for(const[u,h]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);o===p&&h.resolve(a)}return a}onInit(t,r){const o=this.normalizeInstanceIdentifier(r),a=this.onInitCallbacks.get(o)??new Set;a.add(t),this.onInitCallbacks.set(o,a);const u=this.instances.get(o);return u&&t(u,o),()=>{a.delete(t)}}invokeOnInitCallbacks(t,r){const o=this.onInitCallbacks.get(r);if(o)for(const a of o)try{a(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let o=this.instances.get(t);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:Lv(t),options:r}),this.instances.set(t,o),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(o,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,o)}catch{}return o||null}normalizeInstanceIdentifier(t=gr){return this.component?this.component.multipleInstances?t:gr:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Lv(s){return s===gr?void 0:s}function Mv(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new Dv(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Me;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Me||(Me={}));const Ov={debug:Me.DEBUG,verbose:Me.VERBOSE,info:Me.INFO,warn:Me.WARN,error:Me.ERROR,silent:Me.SILENT},Fv=Me.INFO,zv={[Me.DEBUG]:"log",[Me.VERBOSE]:"log",[Me.INFO]:"info",[Me.WARN]:"warn",[Me.ERROR]:"error"},Uv=(s,t,...r)=>{if(t<s.logLevel)return;const o=new Date().toISOString(),a=zv[t];if(a)console[a](`[${o}]  ${s.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class yp{constructor(t){this.name=t,this._logLevel=Fv,this._logHandler=Uv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Me))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Ov[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Me.DEBUG,...t),this._logHandler(this,Me.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Me.VERBOSE,...t),this._logHandler(this,Me.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Me.INFO,...t),this._logHandler(this,Me.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Me.WARN,...t),this._logHandler(this,Me.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Me.ERROR,...t),this._logHandler(this,Me.ERROR,...t)}}const Bv=(s,t)=>t.some(r=>s instanceof r);let xh,_h;function $v(){return xh||(xh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Wv(){return _h||(_h=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const wp=new WeakMap,dc=new WeakMap,Cp=new WeakMap,Ja=new WeakMap,Lc=new WeakMap;function Hv(s){const t=new Promise((r,o)=>{const a=()=>{s.removeEventListener("success",u),s.removeEventListener("error",h)},u=()=>{r(Gn(s.result)),a()},h=()=>{o(s.error),a()};s.addEventListener("success",u),s.addEventListener("error",h)});return t.then(r=>{r instanceof IDBCursor&&wp.set(r,s)}).catch(()=>{}),Lc.set(t,s),t}function Vv(s){if(dc.has(s))return;const t=new Promise((r,o)=>{const a=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",h),s.removeEventListener("abort",h)},u=()=>{r(),a()},h=()=>{o(s.error||new DOMException("AbortError","AbortError")),a()};s.addEventListener("complete",u),s.addEventListener("error",h),s.addEventListener("abort",h)});dc.set(s,t)}let fc={get(s,t,r){if(s instanceof IDBTransaction){if(t==="done")return dc.get(s);if(t==="objectStoreNames")return s.objectStoreNames||Cp.get(s);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Gn(s[t])},set(s,t,r){return s[t]=r,!0},has(s,t){return s instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in s}};function Yv(s){fc=s(fc)}function Qv(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const o=s.call(Za(this),t,...r);return Cp.set(o,t.sort?t.sort():[t]),Gn(o)}:Wv().includes(s)?function(...t){return s.apply(Za(this),t),Gn(wp.get(this))}:function(...t){return Gn(s.apply(Za(this),t))}}function Gv(s){return typeof s=="function"?Qv(s):(s instanceof IDBTransaction&&Vv(s),Bv(s,$v())?new Proxy(s,fc):s)}function Gn(s){if(s instanceof IDBRequest)return Hv(s);if(Ja.has(s))return Ja.get(s);const t=Gv(s);return t!==s&&(Ja.set(s,t),Lc.set(t,s)),t}const Za=s=>Lc.get(s);function Kv(s,t,{blocked:r,upgrade:o,blocking:a,terminated:u}={}){const h=indexedDB.open(s,t),p=Gn(h);return o&&h.addEventListener("upgradeneeded",g=>{o(Gn(h.result),g.oldVersion,g.newVersion,Gn(h.transaction),g)}),r&&h.addEventListener("blocked",g=>r(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),a&&g.addEventListener("versionchange",v=>a(v.oldVersion,v.newVersion,v))}).catch(()=>{}),p}const qv=["get","getKey","getAll","getAllKeys","count"],Xv=["put","add","delete","clear"],ec=new Map;function yh(s,t){if(!(s instanceof IDBDatabase&&!(t in s)&&typeof t=="string"))return;if(ec.get(t))return ec.get(t);const r=t.replace(/FromIndex$/,""),o=t!==r,a=Xv.includes(r);if(!(r in(o?IDBIndex:IDBObjectStore).prototype)||!(a||qv.includes(r)))return;const u=async function(h,...p){const g=this.transaction(h,a?"readwrite":"readonly");let v=g.store;return o&&(v=v.index(p.shift())),(await Promise.all([v[r](...p),a&&g.done]))[0]};return ec.set(t,u),u}Yv(s=>({...s,get:(t,r,o)=>yh(t,r)||s.get(t,r,o),has:(t,r)=>!!yh(t,r)||s.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Zv(r)){const o=r.getImmediate();return`${o.library}/${o.version}`}else return null}).filter(r=>r).join(" ")}}function Zv(s){const t=s.getComponent();return(t==null?void 0:t.type)==="VERSION"}const hc="@firebase/app",wh="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nn=new yp("@firebase/app"),ex="@firebase/app-compat",tx="@firebase/analytics-compat",nx="@firebase/analytics",rx="@firebase/app-check-compat",sx="@firebase/app-check",ix="@firebase/auth",ox="@firebase/auth-compat",lx="@firebase/database",ax="@firebase/data-connect",cx="@firebase/database-compat",ux="@firebase/functions",dx="@firebase/functions-compat",fx="@firebase/installations",hx="@firebase/installations-compat",px="@firebase/messaging",mx="@firebase/messaging-compat",gx="@firebase/performance",vx="@firebase/performance-compat",xx="@firebase/remote-config",_x="@firebase/remote-config-compat",yx="@firebase/storage",wx="@firebase/storage-compat",Cx="@firebase/firestore",kx="@firebase/ai",Nx="@firebase/firestore-compat",Sx="firebase",Ex="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pc="[DEFAULT]",bx={[hc]:"fire-core",[ex]:"fire-core-compat",[nx]:"fire-analytics",[tx]:"fire-analytics-compat",[sx]:"fire-app-check",[rx]:"fire-app-check-compat",[ix]:"fire-auth",[ox]:"fire-auth-compat",[lx]:"fire-rtdb",[ax]:"fire-data-connect",[cx]:"fire-rtdb-compat",[ux]:"fire-fn",[dx]:"fire-fn-compat",[fx]:"fire-iid",[hx]:"fire-iid-compat",[px]:"fire-fcm",[mx]:"fire-fcm-compat",[gx]:"fire-perf",[vx]:"fire-perf-compat",[xx]:"fire-rc",[_x]:"fire-rc-compat",[yx]:"fire-gcs",[wx]:"fire-gcs-compat",[Cx]:"fire-fst",[Nx]:"fire-fst-compat",[kx]:"fire-vertex","fire-js":"fire-js",[Sx]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lo=new Map,Ix=new Map,mc=new Map;function Ch(s,t){try{s.container.addComponent(t)}catch(r){Nn.debug(`Component ${t.name} failed to register with FirebaseApp ${s.name}`,r)}}function Mo(s){const t=s.name;if(mc.has(t))return Nn.debug(`There were multiple attempts to register component ${t}.`),!1;mc.set(t,s);for(const r of Lo.values())Ch(r,s);for(const r of Ix.values())Ch(r,s);return!0}function Tx(s,t){const r=s.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),s.container.getProvider(t)}function jx(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rx={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Kn=new xp("app","Firebase",Rx);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Px{constructor(t,r,o){this._isDeleted=!1,this._options={...t},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=o,this.container.addComponent(new ri("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Kn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dx=Ex;function kp(s,t={}){let r=s;typeof t!="object"&&(t={name:t});const o={name:pc,automaticDataCollectionEnabled:!0,...t},a=o.name;if(typeof a!="string"||!a)throw Kn.create("bad-app-name",{appName:String(a)});if(r||(r=gp()),!r)throw Kn.create("no-options");const u=Lo.get(a);if(u){if(Do(r,u.options)&&Do(o,u.config))return u;throw Kn.create("duplicate-app",{appName:a})}const h=new Av(a);for(const g of mc.values())h.addComponent(g);const p=new Px(r,o,h);return Lo.set(a,p),p}function Lx(s=pc){const t=Lo.get(s);if(!t&&s===pc&&gp())return kp();if(!t)throw Kn.create("no-app",{appName:s});return t}function Xr(s,t,r){let o=bx[s]??s;r&&(o+=`-${r}`);const a=o.match(/\s|\//),u=t.match(/\s|\//);if(a||u){const h=[`Unable to register library "${o}" with version "${t}":`];a&&h.push(`library name "${o}" contains illegal characters (whitespace or "/")`),a&&u&&h.push("and"),u&&h.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Nn.warn(h.join(" "));return}Mo(new ri(`${o}-version`,()=>({library:o,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mx="firebase-heartbeat-database",Ax=1,si="firebase-heartbeat-store";let tc=null;function Np(){return tc||(tc=Kv(Mx,Ax,{upgrade:(s,t)=>{switch(t){case 0:try{s.createObjectStore(si)}catch(r){console.warn(r)}}}}).catch(s=>{throw Kn.create("idb-open",{originalErrorMessage:s.message})})),tc}async function Ox(s){try{const r=(await Np()).transaction(si),o=await r.objectStore(si).get(Sp(s));return await r.done,o}catch(t){if(t instanceof fi)Nn.warn(t.message);else{const r=Kn.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Nn.warn(r.message)}}}async function kh(s,t){try{const o=(await Np()).transaction(si,"readwrite");await o.objectStore(si).put(t,Sp(s)),await o.done}catch(r){if(r instanceof fi)Nn.warn(r.message);else{const o=Kn.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Nn.warn(o.message)}}}function Sp(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx=1024,zx=30;class Ux{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new $x(r),this._heartbeatsCachePromise=this._storage.read().then(o=>(this._heartbeatsCache=o,o))}async triggerHeartbeat(){var t,r;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),u=Nh();if(((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===u||this._heartbeatsCache.heartbeats.some(h=>h.date===u))return;if(this._heartbeatsCache.heartbeats.push({date:u,agent:a}),this._heartbeatsCache.heartbeats.length>zx){const h=Wx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(h,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(o){Nn.warn(o)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Nh(),{heartbeatsToSend:o,unsentEntries:a}=Bx(this._heartbeatsCache.heartbeats),u=Ro(JSON.stringify({version:2,heartbeats:o}));return this._heartbeatsCache.lastSentHeartbeatDate=r,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),u}catch(r){return Nn.warn(r),""}}}function Nh(){return new Date().toISOString().substring(0,10)}function Bx(s,t=Fx){const r=[];let o=s.slice();for(const a of s){const u=r.find(h=>h.agent===a.agent);if(u){if(u.dates.push(a.date),Sh(r)>t){u.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),Sh(r)>t){r.pop();break}o=o.slice(1)}return{heartbeatsToSend:r,unsentEntries:o}}class $x{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return kv()?Nv().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Ox(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const o=await this.read();return kh(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??o.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const o=await this.read();return kh(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...t.heartbeats]})}else return}}function Sh(s){return Ro(JSON.stringify({version:2,heartbeats:s})).length}function Wx(s){if(s.length===0)return-1;let t=0,r=s[0].date;for(let o=1;o<s.length;o++)s[o].date<r&&(r=s[o].date,t=o);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hx(s){Mo(new ri("platform-logger",t=>new Jv(t),"PRIVATE")),Mo(new ri("heartbeat",t=>new Ux(t),"PRIVATE")),Xr(hc,wh,s),Xr(hc,wh,"esm2020"),Xr("fire-js","")}Hx("");var Vx="firebase",Yx="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xr(Vx,Yx,"app");var Eh={};const bh="@firebase/database",Ih="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ep="";function Qx(s){Ep=s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,r){r==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),ht(r))}get(t){const r=this.domStorage_.getItem(this.prefixedName_(t));return r==null?null:ni(r)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kx{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,r){r==null?delete this.cache_[t]:this.cache_[t]=r}get(t){return bn(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bp=function(s){try{if(typeof window<"u"&&typeof window[s]<"u"){const t=window[s];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Gx(t)}}catch{}return new Kx},xr=bp("localStorage"),qx=bp("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr=new yp("@firebase/database"),Xx=(function(){let s=1;return function(){return s++}})(),Ip=function(s){const t=Pv(s),r=new Rv;r.update(t);const o=r.digest();return Rc.encodeByteArray(o)},pi=function(...s){let t="";for(let r=0;r<s.length;r++){const o=s[r];Array.isArray(o)||o&&typeof o=="object"&&typeof o.length=="number"?t+=pi.apply(null,o):typeof o=="object"?t+=ht(o):t+=o,t+=" "}return t};let Xs=null,Th=!0;const Jx=function(s,t){$(!0,"Can't turn on custom loggers persistently."),Jr.logLevel=Me.VERBOSE,Xs=Jr.log.bind(Jr)},kt=function(...s){if(Th===!0&&(Th=!1,Xs===null&&qx.get("logging_enabled")===!0&&Jx()),Xs){const t=pi.apply(null,s);Xs(t)}},mi=function(s){return function(...t){kt(s,...t)}},gc=function(...s){const t="FIREBASE INTERNAL ERROR: "+pi(...s);Jr.error(t)},Sn=function(...s){const t=`FIREBASE FATAL ERROR: ${pi(...s)}`;throw Jr.error(t),new Error(t)},Mt=function(...s){const t="FIREBASE WARNING: "+pi(...s);Jr.warn(t)},Zx=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Mt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Tp=function(s){return typeof s=="number"&&(s!==s||s===Number.POSITIVE_INFINITY||s===Number.NEGATIVE_INFINITY)},e_=function(s){if(document.readyState==="complete")s();else{let t=!1;const r=function(){if(!document.body){setTimeout(r,Math.floor(10));return}t||(t=!0,s())};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&r()}),window.attachEvent("onload",r))}},ns="[MIN_NAME]",yr="[MAX_NAME]",os=function(s,t){if(s===t)return 0;if(s===ns||t===yr)return-1;if(t===ns||s===yr)return 1;{const r=jh(s),o=jh(t);return r!==null?o!==null?r-o===0?s.length-t.length:r-o:-1:o!==null?1:s<t?-1:1}},t_=function(s,t){return s===t?0:s<t?-1:1},Ys=function(s,t){if(t&&s in t)return t[s];throw new Error("Missing required key ("+s+") in object: "+ht(t))},Mc=function(s){if(typeof s!="object"||s===null)return ht(s);const t=[];for(const o in s)t.push(o);t.sort();let r="{";for(let o=0;o<t.length;o++)o!==0&&(r+=","),r+=ht(t[o]),r+=":",r+=Mc(s[t[o]]);return r+="}",r},jp=function(s,t){const r=s.length;if(r<=t)return[s];const o=[];for(let a=0;a<r;a+=t)a+t>r?o.push(s.substring(a,r)):o.push(s.substring(a,a+t));return o};function At(s,t){for(const r in s)s.hasOwnProperty(r)&&t(r,s[r])}const Rp=function(s){$(!Tp(s),"Invalid JSON number");const t=11,r=52,o=(1<<t-1)-1;let a,u,h,p,g;s===0?(u=0,h=0,a=1/s===-1/0?1:0):(a=s<0,s=Math.abs(s),s>=Math.pow(2,1-o)?(p=Math.min(Math.floor(Math.log(s)/Math.LN2),o),u=p+o,h=Math.round(s*Math.pow(2,r-p)-Math.pow(2,r))):(u=0,h=Math.round(s/Math.pow(2,1-o-r))));const v=[];for(g=r;g;g-=1)v.push(h%2?1:0),h=Math.floor(h/2);for(g=t;g;g-=1)v.push(u%2?1:0),u=Math.floor(u/2);v.push(a?1:0),v.reverse();const S=v.join("");let y="";for(g=0;g<64;g+=8){let x=parseInt(S.substr(g,8),2).toString(16);x.length===1&&(x="0"+x),y=y+x}return y.toLowerCase()},n_=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},r_=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function s_(s,t){let r="Unknown Error";s==="too_big"?r="The data requested exceeds the maximum size that can be accessed with a single request.":s==="permission_denied"?r="Client doesn't have permission to access the desired data.":s==="unavailable"&&(r="The service is unavailable");const o=new Error(s+" at "+t._path.toString()+": "+r);return o.code=s.toUpperCase(),o}const i_=new RegExp("^-?(0*)\\d{1,10}$"),o_=-2147483648,l_=2147483647,jh=function(s){if(i_.test(s)){const t=Number(s);if(t>=o_&&t<=l_)return t}return null},ls=function(s){try{s()}catch(t){setTimeout(()=>{const r=t.stack||"";throw Mt("Exception was thrown by user callback.",r),t},Math.floor(0))}},a_=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Js=function(s,t){const r=setTimeout(s,t);return typeof r=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(r):typeof r=="object"&&r.unref&&r.unref(),r};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(t,r){this.appCheckProvider=r,this.appName=t.name,jx(t)&&t.settings.appCheckToken&&(this.serverAppAppCheckToken=t.settings.appCheckToken),this.appCheck=r==null?void 0:r.getImmediate({optional:!0}),this.appCheck||r==null||r.get().then(o=>this.appCheck=o)}getToken(t){if(this.serverAppAppCheckToken){if(t)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(t):new Promise((r,o)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(r,o):r(null)},0)})}addTokenChangeListener(t){var r;(r=this.appCheckProvider)==null||r.get().then(o=>o.addTokenListener(t))}notifyForInvalidToken(){Mt(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(t,r,o){this.appName_=t,this.firebaseOptions_=r,this.authProvider_=o,this.auth_=null,this.auth_=o.getImmediate({optional:!0}),this.auth_||o.onInit(a=>this.auth_=a)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(r=>r&&r.code==="auth/token-not-initialized"?(kt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(r)):new Promise((r,o)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(r,o):r(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(r=>r.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(r=>r.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Mt(t)}}class jo{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}jo.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ac="5",Pp="v",Dp="s",Lp="r",Mp="f",Ap=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Op="ls",Fp="p",vc="ac",zp="websocket",Up="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(t,r,o,a,u=!1,h="",p=!1,g=!1,v=null){this.secure=r,this.namespace=o,this.webSocketOnly=a,this.nodeAdmin=u,this.persistenceKey=h,this.includeNamespaceInQueryParams=p,this.isUsingEmulator=g,this.emulatorOptions=v,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=xr.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&xr.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",r=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${r}`}}function d_(s){return s.host!==s.internalHost||s.isCustomHost()||s.includeNamespaceInQueryParams}function $p(s,t,r){$(typeof t=="string","typeof type must == string"),$(typeof r=="object","typeof params must == object");let o;if(t===zp)o=(s.secure?"wss://":"ws://")+s.internalHost+"/.ws?";else if(t===Up)o=(s.secure?"https://":"http://")+s.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);d_(s)&&(r.ns=s.namespace);const a=[];return At(r,(u,h)=>{a.push(u+"="+h)}),o+a.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(){this.counters_={}}incrementCounter(t,r=1){bn(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=r}get(){return lv(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nc={},rc={};function Oc(s){const t=s.toString();return nc[t]||(nc[t]=new f_),nc[t]}function h_(s,t){const r=s.toString();return rc[r]||(rc[r]=t()),rc[r]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,r){this.closeAfterResponse=t,this.onClose=r,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,r){for(this.pendingResponses[t]=r;this.pendingResponses[this.currentResponseNum];){const o=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let a=0;a<o.length;++a)o[a]&&ls(()=>{this.onMessage_(o[a])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rh="start",m_="close",g_="pLPCommand",v_="pRTLPCB",Wp="id",Hp="pw",Vp="ser",x_="cb",__="seg",y_="ts",w_="d",C_="dframe",Yp=1870,Qp=30,k_=Yp-Qp,N_=25e3,S_=3e4;class qr{constructor(t,r,o,a,u,h,p){this.connId=t,this.repoInfo=r,this.applicationId=o,this.appCheckToken=a,this.authToken=u,this.transportSessionId=h,this.lastSessionId=p,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=mi(t),this.stats_=Oc(r),this.urlFn=g=>(this.appCheckToken&&(g[vc]=this.appCheckToken),$p(r,Up,g))}open(t,r){this.curSegmentNum=0,this.onDisconnect_=r,this.myPacketOrderer=new p_(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(S_)),e_(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Fc((...u)=>{const[h,p,g,v,S]=u;if(this.incrementIncomingBytes_(u),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,h===Rh)this.id=p,this.password=g;else if(h===m_)p?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(p,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+h)},(...u)=>{const[h,p]=u;this.incrementIncomingBytes_(u),this.myPacketOrderer.handleResponse(h,p)},()=>{this.onClosed_()},this.urlFn);const o={};o[Rh]="t",o[Vp]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(o[x_]=this.scriptTagHolder.uniqueCallbackIdentifier),o[Pp]=Ac,this.transportSessionId&&(o[Dp]=this.transportSessionId),this.lastSessionId&&(o[Op]=this.lastSessionId),this.applicationId&&(o[Fp]=this.applicationId),this.appCheckToken&&(o[vc]=this.appCheckToken),typeof location<"u"&&location.hostname&&Ap.test(location.hostname)&&(o[Lp]=Mp);const a=this.urlFn(o);this.log_("Connecting via long-poll to "+a),this.scriptTagHolder.addTag(a,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){qr.forceAllow_=!0}static forceDisallow(){qr.forceDisallow_=!0}static isAvailable(){return qr.forceAllow_?!0:!qr.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!n_()&&!r_()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const r=ht(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const o=hp(r),a=jp(o,k_);for(let u=0;u<a.length;u++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,a.length,a[u]),this.curSegmentNum++}addDisconnectPingFrame(t,r){this.myDisconnFrame=document.createElement("iframe");const o={};o[C_]="t",o[Wp]=t,o[Hp]=r,this.myDisconnFrame.src=this.urlFn(o),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const r=ht(t).length;this.bytesReceived+=r,this.stats_.incrementCounter("bytes_received",r)}}class Fc{constructor(t,r,o,a){this.onDisconnect=o,this.urlFn=a,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Xx(),window[g_+this.uniqueCallbackIdentifier]=t,window[v_+this.uniqueCallbackIdentifier]=r,this.myIFrame=Fc.createIFrame_();let u="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(u='<script>document.domain="'+document.domain+'";<\/script>');const h="<html><body>"+u+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(h),this.myIFrame.doc.close()}catch(p){kt("frame writing exception"),p.stack&&kt(p.stack),kt(p)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||kt("No IE domain setting required")}catch{const o=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+o+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,r){for(this.myID=t,this.myPW=r,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t[Wp]=this.myID,t[Hp]=this.myPW,t[Vp]=this.currentSerial;let r=this.urlFn(t),o="",a=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Qp+o.length<=Yp;){const h=this.pendingSegs.shift();o=o+"&"+__+a+"="+h.seg+"&"+y_+a+"="+h.ts+"&"+w_+a+"="+h.d,a++}return r=r+o,this.addLongPollTag_(r,this.currentSerial),!0}else return!1}enqueueSegment(t,r,o){this.pendingSegs.push({seg:t,ts:r,d:o}),this.alive&&this.newRequest_()}addLongPollTag_(t,r){this.outstandingRequests.add(r);const o=()=>{this.outstandingRequests.delete(r),this.newRequest_()},a=setTimeout(o,Math.floor(N_)),u=()=>{clearTimeout(a),o()};this.addTag(t,u)}addTag(t,r){setTimeout(()=>{try{if(!this.sendNewPolls)return;const o=this.myIFrame.doc.createElement("script");o.type="text/javascript",o.async=!0,o.src=t,o.onload=o.onreadystatechange=function(){const a=o.readyState;(!a||a==="loaded"||a==="complete")&&(o.onload=o.onreadystatechange=null,o.parentNode&&o.parentNode.removeChild(o),r())},o.onerror=()=>{kt("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(o)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E_=16384,b_=45e3;let Ao=null;typeof MozWebSocket<"u"?Ao=MozWebSocket:typeof WebSocket<"u"&&(Ao=WebSocket);class nn{constructor(t,r,o,a,u,h,p){this.connId=t,this.applicationId=o,this.appCheckToken=a,this.authToken=u,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=mi(this.connId),this.stats_=Oc(r),this.connURL=nn.connectionURL_(r,h,p,a,o),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,o,a,u){const h={};return h[Pp]=Ac,typeof location<"u"&&location.hostname&&Ap.test(location.hostname)&&(h[Lp]=Mp),r&&(h[Dp]=r),o&&(h[Op]=o),a&&(h[vc]=a),u&&(h[Fp]=u),$p(t,zp,h)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,xr.set("previous_websocket_failure",!0);try{let o;Cv(),this.mySock=new Ao(this.connURL,[],o)}catch(o){this.log_("Error instantiating WebSocket.");const a=o.message||o.data;a&&this.log_(a),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=o=>{this.handleIncomingFrame(o)},this.mySock.onerror=o=>{this.log_("WebSocket error.  Closing connection.");const a=o.message||o.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){nn.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=/Android ([0-9]{0,}\.[0-9]{0,})/,o=navigator.userAgent.match(r);o&&o.length>1&&parseFloat(o[1])<4.4&&(t=!0)}return!t&&Ao!==null&&!nn.forceDisallow_}static previouslyFailed(){return xr.isInMemoryStorage||xr.get("previous_websocket_failure")===!0}markConnectionHealthy(){xr.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const o=ni(r);this.onMessage(o)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if($(this.frames===null,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{const o=this.extractFrameCount_(r);o!==null&&this.appendFrame_(o)}}send(t){this.resetKeepAlive();const r=ht(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const o=jp(r,E_);o.length>1&&this.sendString_(String(o.length));for(let a=0;a<o.length;a++)this.sendString_(o[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(b_))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}nn.responsesRequiredToBeHealthy=2;nn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{static get ALL_TRANSPORTS(){return[qr,nn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){const r=nn&&nn.isAvailable();let o=r&&!nn.previouslyFailed();if(t.webSocketOnly&&(r||Mt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[nn];else{const a=this.transports_=[];for(const u of ii.ALL_TRANSPORTS)u&&u.isAvailable()&&a.push(u);ii.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ii.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I_=6e4,T_=5e3,j_=10*1024,R_=100*1024,sc="t",Ph="d",P_="s",Dh="r",D_="e",Lh="o",Mh="a",Ah="n",Oh="p",L_="h";class M_{constructor(t,r,o,a,u,h,p,g,v,S){this.id=t,this.repoInfo_=r,this.applicationId_=o,this.appCheckToken_=a,this.authToken_=u,this.onMessage_=h,this.onReady_=p,this.onDisconnect_=g,this.onKill_=v,this.lastSessionId=S,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=mi("c:"+this.id+":"),this.transportManager_=new ii(r),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.conn_),o=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(r,o)},Math.floor(0));const a=t.healthyTimeout||0;a>0&&(this.healthyTimeout_=Js(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>R_?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>j_?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(a)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return r=>{t===this.conn_?this.onConnectionLost_(r):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return r=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(r):t===this.secondaryConn_?this.onSecondaryMessageReceived_(r):this.log_("message on old connection"))}}sendRequest(t){const r={t:"d",d:t};this.sendData_(r)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(sc in t){const r=t[sc];r===Mh?this.upgradeIfSecondaryHealthy_():r===Dh?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):r===Lh&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const r=Ys("t",t),o=Ys("d",t);if(r==="c")this.onSecondaryControl_(o);else if(r==="d")this.pendingDataMessages.push(o);else throw new Error("Unknown protocol layer: "+r)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Oh,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Mh,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Ah,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const r=Ys("t",t),o=Ys("d",t);r==="c"?this.onControl_(o):r==="d"&&this.onDataMessage_(o)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const r=Ys(sc,t);if(Ph in t){const o=t[Ph];if(r===L_){const a={...o};this.repoInfo_.isUsingEmulator&&(a.h=this.repoInfo_.host),this.onHandshake_(a)}else if(r===Ah){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let a=0;a<this.pendingDataMessages.length;++a)this.onDataMessage_(this.pendingDataMessages[a]);this.pendingDataMessages=[],this.tryCleanupConnection()}else r===P_?this.onConnectionShutdown_(o):r===Dh?this.onReset_(o):r===D_?gc("Server Error: "+o):r===Lh?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):gc("Unknown control packet command: "+r)}}onHandshake_(t){const r=t.ts,o=t.v,a=t.h;this.sessionId=t.s,this.repoInfo_.host=a,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,r),Ac!==o&&Mt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.secondaryConn_),o=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,o),Js(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(I_))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,r){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(r,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Js(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(T_))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Oh,d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(xr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{put(t,r,o,a){}merge(t,r,o,a){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,r,o){}onDisconnectMerge(t,r,o){}onDisconnectCancel(t,r){}reportStats(t){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(t){this.allowedEvents_=t,this.listeners_={},$(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...r){if(Array.isArray(this.listeners_[t])){const o=[...this.listeners_[t]];for(let a=0;a<o.length;a++)o[a].callback.apply(o[a].context,r)}}on(t,r,o){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:r,context:o});const a=this.getInitialEvent(t);a&&r.apply(o,a)}off(t,r,o){this.validateEventType_(t);const a=this.listeners_[t]||[];for(let u=0;u<a.length;u++)if(a[u].callback===r&&(!o||o===a[u].context)){a.splice(u,1);return}}validateEventType_(t){$(this.allowedEvents_.find(r=>r===t),"Unknown event: "+t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo extends Kp{static getInstance(){return new Oo}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!vp()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(t){return $(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fh=32,zh=768;class Pe{constructor(t,r){if(r===void 0){this.pieces_=t.split("/");let o=0;for(let a=0;a<this.pieces_.length;a++)this.pieces_[a].length>0&&(this.pieces_[o]=this.pieces_[a],o++);this.pieces_.length=o,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=r}toString(){let t="";for(let r=this.pieceNum_;r<this.pieces_.length;r++)this.pieces_[r]!==""&&(t+="/"+this.pieces_[r]);return t||"/"}}function Ie(){return new Pe("")}function me(s){return s.pieceNum_>=s.pieces_.length?null:s.pieces_[s.pieceNum_]}function Xn(s){return s.pieces_.length-s.pieceNum_}function Ae(s){let t=s.pieceNum_;return t<s.pieces_.length&&t++,new Pe(s.pieces_,t)}function qp(s){return s.pieceNum_<s.pieces_.length?s.pieces_[s.pieces_.length-1]:null}function A_(s){let t="";for(let r=s.pieceNum_;r<s.pieces_.length;r++)s.pieces_[r]!==""&&(t+="/"+encodeURIComponent(String(s.pieces_[r])));return t||"/"}function Xp(s,t=0){return s.pieces_.slice(s.pieceNum_+t)}function Jp(s){if(s.pieceNum_>=s.pieces_.length)return null;const t=[];for(let r=s.pieceNum_;r<s.pieces_.length-1;r++)t.push(s.pieces_[r]);return new Pe(t,0)}function lt(s,t){const r=[];for(let o=s.pieceNum_;o<s.pieces_.length;o++)r.push(s.pieces_[o]);if(t instanceof Pe)for(let o=t.pieceNum_;o<t.pieces_.length;o++)r.push(t.pieces_[o]);else{const o=t.split("/");for(let a=0;a<o.length;a++)o[a].length>0&&r.push(o[a])}return new Pe(r,0)}function xe(s){return s.pieceNum_>=s.pieces_.length}function Dt(s,t){const r=me(s),o=me(t);if(r===null)return t;if(r===o)return Dt(Ae(s),Ae(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+s+")")}function zc(s,t){if(Xn(s)!==Xn(t))return!1;for(let r=s.pieceNum_,o=t.pieceNum_;r<=s.pieces_.length;r++,o++)if(s.pieces_[r]!==t.pieces_[o])return!1;return!0}function rn(s,t){let r=s.pieceNum_,o=t.pieceNum_;if(Xn(s)>Xn(t))return!1;for(;r<s.pieces_.length;){if(s.pieces_[r]!==t.pieces_[o])return!1;++r,++o}return!0}class O_{constructor(t,r){this.errorPrefix_=r,this.parts_=Xp(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let o=0;o<this.parts_.length;o++)this.byteLength_+=qo(this.parts_[o]);Zp(this)}}function F_(s,t){s.parts_.length>0&&(s.byteLength_+=1),s.parts_.push(t),s.byteLength_+=qo(t),Zp(s)}function z_(s){const t=s.parts_.pop();s.byteLength_-=qo(t),s.parts_.length>0&&(s.byteLength_-=1)}function Zp(s){if(s.byteLength_>zh)throw new Error(s.errorPrefix_+"has a key path longer than "+zh+" bytes ("+s.byteLength_+").");if(s.parts_.length>Fh)throw new Error(s.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Fh+") or object contains a cycle "+vr(s))}function vr(s){return s.parts_.length===0?"":"in property '"+s.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc extends Kp{static getInstance(){return new Uc}constructor(){super(["visible"]);let t,r;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(r="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(r="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(r="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(r="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,r&&document.addEventListener(r,()=>{const o=!document[t];o!==this.visible_&&(this.visible_=o,this.trigger("visible",o))},!1)}getInitialEvent(t){return $(t==="visible","Unknown event type: "+t),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qs=1e3,U_=300*1e3,Uh=30*1e3,B_=1.3,$_=3e4,W_="server_kill",Bh=3;class kn extends Gp{constructor(t,r,o,a,u,h,p,g){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=o,this.onConnectStatus_=a,this.onServerInfoUpdate_=u,this.authTokenProvider_=h,this.appCheckTokenProvider_=p,this.authOverride_=g,this.id=kn.nextPersistentConnectionId_++,this.log_=mi("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Qs,this.maxReconnectDelay_=U_,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,g)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Uc.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Oo.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,o){const a=++this.requestNumber_,u={r:a,a:t,b:r};this.log_(ht(u)),$(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(u),o&&(this.requestCBHash_[a]=o)}get(t){this.initConnection_();const r=new Ko,a={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:h=>{const p=h.d;h.s==="ok"?r.resolve(p):r.reject(p)}};this.outstandingGets_.push(a),this.outstandingGetCount_++;const u=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(u),r.promise}listen(t,r,o,a){this.initConnection_();const u=t._queryIdentifier,h=t._path.toString();this.log_("Listen called for "+h+" "+u),this.listens.has(h)||this.listens.set(h,new Map),$(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),$(!this.listens.get(h).has(u),"listen() called twice for same path/queryId.");const p={onComplete:a,hashFn:r,query:t,tag:o};this.listens.get(h).set(u,p),this.connected_&&this.sendListen_(p)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,o=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(o)})}sendListen_(t){const r=t.query,o=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+o+" for "+a);const u={p:o},h="q";t.tag&&(u.q=r._queryObject,u.t=t.tag),u.h=t.hashFn(),this.sendRequest(h,u,p=>{const g=p.d,v=p.s;kn.warnOnListenWarnings_(g,r),(this.listens.get(o)&&this.listens.get(o).get(a))===t&&(this.log_("listen response",p),v!=="ok"&&this.removeListen_(o,a),t.onComplete&&t.onComplete(v,g))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&bn(t,"w")){const o=ts(t,"w");if(Array.isArray(o)&&~o.indexOf("no_index")){const a='".indexOn": "'+r._queryParams.getIndex().toString()+'"',u=r._path.toString();Mt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${u} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||Tv(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Uh)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=Iv(t)?"auth":"gauth",o={cred:t};this.authOverride_===null?o.noauth=!0:typeof this.authOverride_=="object"&&(o.authvar=this.authOverride_),this.sendRequest(r,o,a=>{const u=a.s,h=a.d||"error";this.authToken_===t&&(u==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(u,h))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,o=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,o)})}unlisten(t,r){const o=t._path.toString(),a=t._queryIdentifier;this.log_("Unlisten called for "+o+" "+a),$(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(o,a)&&this.connected_&&this.sendUnlisten_(o,a,t._queryObject,r)}sendUnlisten_(t,r,o,a){this.log_("Unlisten on "+t+" for "+r);const u={p:t},h="n";a&&(u.q=o,u.t=a),this.sendRequest(h,u)}onDisconnectPut(t,r,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,o):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:o})}onDisconnectMerge(t,r,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,o):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:o})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,o,a){const u={p:r,d:o};this.log_("onDisconnect "+t,u),this.sendRequest(t,u,h=>{a&&setTimeout(()=>{a(h.s,h.d)},Math.floor(0))})}put(t,r,o,a){this.putInternal("p",t,r,o,a)}merge(t,r,o,a){this.putInternal("m",t,r,o,a)}putInternal(t,r,o,a,u){this.initConnection_();const h={p:r,d:o};u!==void 0&&(h.h=u),this.outstandingPuts_.push({action:t,request:h,onComplete:a}),this.outstandingPutCount_++;const p=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(p):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,o=this.outstandingPuts_[t].request,a=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,o,u=>{this.log_(r+" response",u),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),a&&a(u.s,u.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,o=>{if(o.s!=="ok"){const u=o.d;this.log_("reportStats","Error sending stats: "+u)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+ht(t));const r=t.r,o=this.requestCBHash_[r];o&&(delete this.requestCBHash_[r],o(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):gc("Unrecognized action received from server: "+ht(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){$(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Qs,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Qs,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>$_&&(this.reconnectDelay_=Qs),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*B_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),o=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+kn.nextConnectionId_++,u=this.lastSessionId;let h=!1,p=null;const g=function(){p?p.close():(h=!0,o())},v=function(y){$(p,"sendRequest call when we're not connected not allowed."),p.sendRequest(y)};this.realtime_={close:g,sendRequest:v};const S=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[y,x]=await Promise.all([this.authTokenProvider_.getToken(S),this.appCheckTokenProvider_.getToken(S)]);h?kt("getToken() completed but was canceled"):(kt("getToken() completed. Creating connection."),this.authToken_=y&&y.accessToken,this.appCheckToken_=x&&x.token,p=new M_(a,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,o,R=>{Mt(R+" ("+this.repoInfo_.toString()+")"),this.interrupt(W_)},u))}catch(y){this.log_("Failed to get token: "+y),h||(this.repoInfo_.nodeAdmin&&Mt(y),g())}}}interrupt(t){kt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){kt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],gh(this.interruptReasons_)&&(this.reconnectDelay_=Qs,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let o;r?o=r.map(u=>Mc(u)).join("$"):o="default";const a=this.removeListen_(t,o);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(t,r){const o=new Pe(t).toString();let a;if(this.listens.has(o)){const u=this.listens.get(o);a=u.get(r),u.delete(r),u.size===0&&this.listens.delete(o)}else a=void 0;return a}onAuthRevoked_(t,r){kt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Bh&&(this.reconnectDelay_=Uh,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){kt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Bh&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";t["sdk."+r+"."+Ep.replace(/\./g,"-")]=1,vp()?t["framework.cordova"]=1:wv()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Oo.getInstance().currentlyOnline();return gh(this.interruptReasons_)&&t}}kn.nextPersistentConnectionId_=0;kn.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(t,r){this.name=t,this.node=r}static Wrap(t,r){return new ge(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,r){const o=new ge(ns,t),a=new ge(ns,r);return this.compare(o,a)!==0}minPost(){return ge.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Io;class em extends Xo{static get __EMPTY_NODE(){return Io}static set __EMPTY_NODE(t){Io=t}compare(t,r){return os(t.name,r.name)}isDefinedOn(t){throw is("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,r){return!1}minPost(){return ge.MIN}maxPost(){return new ge(yr,Io)}makePost(t,r){return $(typeof t=="string","KeyIndex indexValue must always be a string."),new ge(t,Io)}toString(){return".key"}}const Zr=new em;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(t,r,o,a,u=null){this.isReverse_=a,this.resultGenerator_=u,this.nodeStack_=[];let h=1;for(;!t.isEmpty();)if(t=t,h=r?o(t.key,r):1,a&&(h*=-1),h<0)this.isReverse_?t=t.left:t=t.right;else if(h===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),r;if(this.resultGenerator_?r=this.resultGenerator_(t.key,t.value):r={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return r}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class ft{constructor(t,r,o,a,u){this.key=t,this.value=r,this.color=o??ft.RED,this.left=a??Lt.EMPTY_NODE,this.right=u??Lt.EMPTY_NODE}copy(t,r,o,a,u){return new ft(t??this.key,r??this.value,o??this.color,a??this.left,u??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,o){let a=this;const u=o(t,a.key);return u<0?a=a.copy(null,null,null,a.left.insert(t,r,o),null):u===0?a=a.copy(null,r,null,null,null):a=a.copy(null,null,null,null,a.right.insert(t,r,o)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return Lt.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let o,a;if(o=this,r(t,o.key)<0)!o.left.isEmpty()&&!o.left.isRed_()&&!o.left.left.isRed_()&&(o=o.moveRedLeft_()),o=o.copy(null,null,null,o.left.remove(t,r),null);else{if(o.left.isRed_()&&(o=o.rotateRight_()),!o.right.isEmpty()&&!o.right.isRed_()&&!o.right.left.isRed_()&&(o=o.moveRedRight_()),r(t,o.key)===0){if(o.right.isEmpty())return Lt.EMPTY_NODE;a=o.right.min_(),o=o.copy(a.key,a.value,null,null,o.right.removeMin_())}o=o.copy(null,null,null,null,o.right.remove(t,r))}return o.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,ft.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,ft.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}ft.RED=!0;ft.BLACK=!1;class H_{copy(t,r,o,a,u){return this}insert(t,r,o){return new ft(t,r,null)}remove(t,r){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Lt{constructor(t,r=Lt.EMPTY_NODE){this.comparator_=t,this.root_=r}insert(t,r){return new Lt(this.comparator_,this.root_.insert(t,r,this.comparator_).copy(null,null,ft.BLACK,null,null))}remove(t){return new Lt(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,ft.BLACK,null,null))}get(t){let r,o=this.root_;for(;!o.isEmpty();){if(r=this.comparator_(t,o.key),r===0)return o.value;r<0?o=o.left:r>0&&(o=o.right)}return null}getPredecessorKey(t){let r,o=this.root_,a=null;for(;!o.isEmpty();)if(r=this.comparator_(t,o.key),r===0){if(o.left.isEmpty())return a?a.key:null;for(o=o.left;!o.right.isEmpty();)o=o.right;return o.key}else r<0?o=o.left:r>0&&(a=o,o=o.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new To(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,r){return new To(this.root_,t,this.comparator_,!1,r)}getReverseIteratorFrom(t,r){return new To(this.root_,t,this.comparator_,!0,r)}getReverseIterator(t){return new To(this.root_,null,this.comparator_,!0,t)}}Lt.EMPTY_NODE=new H_;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V_(s,t){return os(s.name,t.name)}function Bc(s,t){return os(s,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xc;function Y_(s){xc=s}const tm=function(s){return typeof s=="number"?"number:"+Rp(s):"string:"+s},nm=function(s){if(s.isLeafNode()){const t=s.val();$(typeof t=="string"||typeof t=="number"||typeof t=="object"&&bn(t,".sv"),"Priority must be a string or number.")}else $(s===xc||s.isEmpty(),"priority of unexpected type.");$(s===xc||s.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $h;class dt{static set __childrenNodeConstructor(t){$h=t}static get __childrenNodeConstructor(){return $h}constructor(t,r=dt.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,$(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),nm(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new dt(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:dt.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return xe(t)?this:me(t)===".priority"?this.priorityNode_:dt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:dt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const o=me(t);return o===null?r:r.isEmpty()&&o!==".priority"?this:($(o!==".priority"||Xn(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(o,dt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ae(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+tm(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",r==="number"?t+=Rp(this.value_):t+=this.value_,this.lazyHash_=Ip(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===dt.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof dt.__childrenNodeConstructor?-1:($(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,o=typeof this.value_,a=dt.VALUE_TYPE_ORDER.indexOf(r),u=dt.VALUE_TYPE_ORDER.indexOf(o);return $(a>=0,"Unknown leaf type: "+r),$(u>=0,"Unknown leaf type: "+o),a===u?o==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:u-a}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}dt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rm,sm;function Q_(s){rm=s}function G_(s){sm=s}class K_ extends Xo{compare(t,r){const o=t.node.getPriority(),a=r.node.getPriority(),u=o.compareTo(a);return u===0?os(t.name,r.name):u}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,r){return!t.getPriority().equals(r.getPriority())}minPost(){return ge.MIN}maxPost(){return new ge(yr,new dt("[PRIORITY-POST]",sm))}makePost(t,r){const o=rm(t);return new ge(r,new dt("[PRIORITY-POST]",o))}toString(){return".priority"}}const Ge=new K_;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_=Math.log(2);class X_{constructor(t){const r=u=>parseInt(Math.log(u)/q_,10),o=u=>parseInt(Array(u+1).join("1"),2);this.count=r(t+1),this.current_=this.count-1;const a=o(this.count);this.bits_=t+1&a}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const Fo=function(s,t,r,o){s.sort(t);const a=function(g,v){const S=v-g;let y,x;if(S===0)return null;if(S===1)return y=s[g],x=r?r(y):y,new ft(x,y.node,ft.BLACK,null,null);{const R=parseInt(S/2,10)+g,P=a(g,R),B=a(R+1,v);return y=s[R],x=r?r(y):y,new ft(x,y.node,ft.BLACK,P,B)}},u=function(g){let v=null,S=null,y=s.length;const x=function(P,B){const Q=y-P,te=y;y-=P;const ie=a(Q+1,te),_e=s[Q],A=r?r(_e):_e;R(new ft(A,_e.node,B,null,ie))},R=function(P){v?(v.left=P,v=P):(S=P,v=P)};for(let P=0;P<g.count;++P){const B=g.nextBitIsOne(),Q=Math.pow(2,g.count-(P+1));B?x(Q,ft.BLACK):(x(Q,ft.BLACK),x(Q,ft.RED))}return S},h=new X_(s.length),p=u(h);return new Lt(o||t,p)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ic;const Kr={};class Cn{static get Default(){return $(Kr&&Ge,"ChildrenNode.ts has not been loaded"),ic=ic||new Cn({".priority":Kr},{".priority":Ge}),ic}constructor(t,r){this.indexes_=t,this.indexSet_=r}get(t){const r=ts(this.indexes_,t);if(!r)throw new Error("No index defined for "+t);return r instanceof Lt?r:null}hasIndex(t){return bn(this.indexSet_,t.toString())}addIndex(t,r){$(t!==Zr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const o=[];let a=!1;const u=r.getIterator(ge.Wrap);let h=u.getNext();for(;h;)a=a||t.isDefinedOn(h.node),o.push(h),h=u.getNext();let p;a?p=Fo(o,t.getCompare()):p=Kr;const g=t.toString(),v={...this.indexSet_};v[g]=t;const S={...this.indexes_};return S[g]=p,new Cn(S,v)}addToIndexes(t,r){const o=Po(this.indexes_,(a,u)=>{const h=ts(this.indexSet_,u);if($(h,"Missing index implementation for "+u),a===Kr)if(h.isDefinedOn(t.node)){const p=[],g=r.getIterator(ge.Wrap);let v=g.getNext();for(;v;)v.name!==t.name&&p.push(v),v=g.getNext();return p.push(t),Fo(p,h.getCompare())}else return Kr;else{const p=r.get(t.name);let g=a;return p&&(g=g.remove(new ge(t.name,p))),g.insert(t,t.node)}});return new Cn(o,this.indexSet_)}removeFromIndexes(t,r){const o=Po(this.indexes_,a=>{if(a===Kr)return a;{const u=r.get(t.name);return u?a.remove(new ge(t.name,u)):a}});return new Cn(o,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gs;class ae{static get EMPTY_NODE(){return Gs||(Gs=new ae(new Lt(Bc),null,Cn.Default))}constructor(t,r,o){this.children_=t,this.priorityNode_=r,this.indexMap_=o,this.lazyHash_=null,this.priorityNode_&&nm(this.priorityNode_),this.children_.isEmpty()&&$(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Gs}updatePriority(t){return this.children_.isEmpty()?this:new ae(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{const r=this.children_.get(t);return r===null?Gs:r}}getChild(t){const r=me(t);return r===null?this:this.getImmediateChild(r).getChild(Ae(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if($(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{const o=new ge(t,r);let a,u;r.isEmpty()?(a=this.children_.remove(t),u=this.indexMap_.removeFromIndexes(o,this.children_)):(a=this.children_.insert(t,r),u=this.indexMap_.addToIndexes(o,this.children_));const h=a.isEmpty()?Gs:this.priorityNode_;return new ae(a,h,u)}}updateChild(t,r){const o=me(t);if(o===null)return r;{$(me(t)!==".priority"||Xn(t)===1,".priority must be the last token in a path");const a=this.getImmediateChild(o).updateChild(Ae(t),r);return this.updateImmediateChild(o,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let o=0,a=0,u=!0;if(this.forEachChild(Ge,(h,p)=>{r[h]=p.val(t),o++,u&&ae.INTEGER_REGEXP_.test(h)?a=Math.max(a,Number(h)):u=!1}),!t&&u&&a<2*o){const h=[];for(const p in r)h[p]=r[p];return h}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+tm(this.getPriority().val())+":"),this.forEachChild(Ge,(r,o)=>{const a=o.hash();a!==""&&(t+=":"+r+":"+a)}),this.lazyHash_=t===""?"":Ip(t)}return this.lazyHash_}getPredecessorChildName(t,r,o){const a=this.resolveIndex_(o);if(a){const u=a.getPredecessorKey(new ge(t,r));return u?u.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const o=r.minKey();return o&&o.name}else return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new ge(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const o=r.maxKey();return o&&o.name}else return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new ge(r,this.children_.get(r)):null}forEachChild(t,r){const o=this.resolveIndex_(t);return o?o.inorderTraversal(a=>r(a.name,a.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const o=this.resolveIndex_(r);if(o)return o.getIteratorFrom(t,a=>a);{const a=this.children_.getIteratorFrom(t.name,ge.Wrap);let u=a.peek();for(;u!=null&&r.compare(u,t)<0;)a.getNext(),u=a.peek();return a}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const o=this.resolveIndex_(r);if(o)return o.getReverseIteratorFrom(t,a=>a);{const a=this.children_.getReverseIteratorFrom(t.name,ge.Wrap);let u=a.peek();for(;u!=null&&r.compare(u,t)>0;)a.getNext(),u=a.peek();return a}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===gi?-1:0}withIndex(t){if(t===Zr||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new ae(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Zr||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){const o=this.getIterator(Ge),a=r.getIterator(Ge);let u=o.getNext(),h=a.getNext();for(;u&&h;){if(u.name!==h.name||!u.node.equals(h.node))return!1;u=o.getNext(),h=a.getNext()}return u===null&&h===null}else return!1;else return!1}}resolveIndex_(t){return t===Zr?null:this.indexMap_.get(t.toString())}}ae.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class J_ extends ae{constructor(){super(new Lt(Bc),ae.EMPTY_NODE,Cn.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return ae.EMPTY_NODE}isEmpty(){return!1}}const gi=new J_;Object.defineProperties(ge,{MIN:{value:new ge(ns,ae.EMPTY_NODE)},MAX:{value:new ge(yr,gi)}});em.__EMPTY_NODE=ae.EMPTY_NODE;dt.__childrenNodeConstructor=ae;Y_(gi);G_(gi);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z_=!0;function vt(s,t=null){if(s===null)return ae.EMPTY_NODE;if(typeof s=="object"&&".priority"in s&&(t=s[".priority"]),$(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof s=="object"&&".value"in s&&s[".value"]!==null&&(s=s[".value"]),typeof s!="object"||".sv"in s){const r=s;return new dt(r,vt(t))}if(!(s instanceof Array)&&Z_){const r=[];let o=!1;if(At(s,(h,p)=>{if(h.substring(0,1)!=="."){const g=vt(p);g.isEmpty()||(o=o||!g.getPriority().isEmpty(),r.push(new ge(h,g)))}}),r.length===0)return ae.EMPTY_NODE;const u=Fo(r,V_,h=>h.name,Bc);if(o){const h=Fo(r,Ge.getCompare());return new ae(u,vt(t),new Cn({".priority":h},{".priority":Ge}))}else return new ae(u,vt(t),Cn.Default)}else{let r=ae.EMPTY_NODE;return At(s,(o,a)=>{if(bn(s,o)&&o.substring(0,1)!=="."){const u=vt(a);(u.isLeafNode()||!u.isEmpty())&&(r=r.updateImmediateChild(o,u))}}),r.updatePriority(vt(t))}}Q_(vt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey extends Xo{constructor(t){super(),this.indexPath_=t,$(!xe(t)&&me(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,r){const o=this.extractChild(t.node),a=this.extractChild(r.node),u=o.compareTo(a);return u===0?os(t.name,r.name):u}makePost(t,r){const o=vt(t),a=ae.EMPTY_NODE.updateChild(this.indexPath_,o);return new ge(r,a)}maxPost(){const t=ae.EMPTY_NODE.updateChild(this.indexPath_,gi);return new ge(yr,t)}toString(){return Xp(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty extends Xo{compare(t,r){const o=t.node.compareTo(r.node);return o===0?os(t.name,r.name):o}isDefinedOn(t){return!0}indexedValueChanged(t,r){return!t.equals(r)}minPost(){return ge.MIN}maxPost(){return ge.MAX}makePost(t,r){const o=vt(t);return new ge(r,o)}toString(){return".value"}}const ny=new ty;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function im(s){return{type:"value",snapshotNode:s}}function rs(s,t){return{type:"child_added",snapshotNode:t,childName:s}}function oi(s,t){return{type:"child_removed",snapshotNode:t,childName:s}}function li(s,t,r){return{type:"child_changed",snapshotNode:t,childName:s,oldSnap:r}}function ry(s,t){return{type:"child_moved",snapshotNode:t,childName:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(t){this.index_=t}updateChild(t,r,o,a,u,h){$(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const p=t.getImmediateChild(r);return p.getChild(a).equals(o.getChild(a))&&p.isEmpty()===o.isEmpty()||(h!=null&&(o.isEmpty()?t.hasChild(r)?h.trackChildChange(oi(r,p)):$(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):p.isEmpty()?h.trackChildChange(rs(r,o)):h.trackChildChange(li(r,o,p))),t.isLeafNode()&&o.isEmpty())?t:t.updateImmediateChild(r,o).withIndex(this.index_)}updateFullNode(t,r,o){return o!=null&&(t.isLeafNode()||t.forEachChild(Ge,(a,u)=>{r.hasChild(a)||o.trackChildChange(oi(a,u))}),r.isLeafNode()||r.forEachChild(Ge,(a,u)=>{if(t.hasChild(a)){const h=t.getImmediateChild(a);h.equals(u)||o.trackChildChange(li(a,u,h))}else o.trackChildChange(rs(a,u))})),r.withIndex(this.index_)}updatePriority(t,r){return t.isEmpty()?ae.EMPTY_NODE:t.updatePriority(r)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(t){this.indexedFilter_=new $c(t.getIndex()),this.index_=t.getIndex(),this.startPost_=ai.getStartPost_(t),this.endPost_=ai.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const r=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,o=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return r&&o}updateChild(t,r,o,a,u,h){return this.matches(new ge(r,o))||(o=ae.EMPTY_NODE),this.indexedFilter_.updateChild(t,r,o,a,u,h)}updateFullNode(t,r,o){r.isLeafNode()&&(r=ae.EMPTY_NODE);let a=r.withIndex(this.index_);a=a.updatePriority(ae.EMPTY_NODE);const u=this;return r.forEachChild(Ge,(h,p)=>{u.matches(new ge(h,p))||(a=a.updateImmediateChild(h,ae.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,a,o)}updatePriority(t,r){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const r=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),r)}else return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const r=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),r)}else return t.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(t){this.withinDirectionalStart=r=>this.reverse_?this.withinEndPost(r):this.withinStartPost(r),this.withinDirectionalEnd=r=>this.reverse_?this.withinStartPost(r):this.withinEndPost(r),this.withinStartPost=r=>{const o=this.index_.compare(this.rangedFilter_.getStartPost(),r);return this.startIsInclusive_?o<=0:o<0},this.withinEndPost=r=>{const o=this.index_.compare(r,this.rangedFilter_.getEndPost());return this.endIsInclusive_?o<=0:o<0},this.rangedFilter_=new ai(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,r,o,a,u,h){return this.rangedFilter_.matches(new ge(r,o))||(o=ae.EMPTY_NODE),t.getImmediateChild(r).equals(o)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,r,o,a,u,h):this.fullLimitUpdateChild_(t,r,o,u,h)}updateFullNode(t,r,o){let a;if(r.isLeafNode()||r.isEmpty())a=ae.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<r.numChildren()&&r.isIndexed(this.index_)){a=ae.EMPTY_NODE.withIndex(this.index_);let u;this.reverse_?u=r.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):u=r.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let h=0;for(;u.hasNext()&&h<this.limit_;){const p=u.getNext();if(this.withinDirectionalStart(p))if(this.withinDirectionalEnd(p))a=a.updateImmediateChild(p.name,p.node),h++;else break;else continue}}else{a=r.withIndex(this.index_),a=a.updatePriority(ae.EMPTY_NODE);let u;this.reverse_?u=a.getReverseIterator(this.index_):u=a.getIterator(this.index_);let h=0;for(;u.hasNext();){const p=u.getNext();h<this.limit_&&this.withinDirectionalStart(p)&&this.withinDirectionalEnd(p)?h++:a=a.updateImmediateChild(p.name,ae.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,a,o)}updatePriority(t,r){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,r,o,a,u){let h;if(this.reverse_){const y=this.index_.getCompare();h=(x,R)=>y(R,x)}else h=this.index_.getCompare();const p=t;$(p.numChildren()===this.limit_,"");const g=new ge(r,o),v=this.reverse_?p.getFirstChild(this.index_):p.getLastChild(this.index_),S=this.rangedFilter_.matches(g);if(p.hasChild(r)){const y=p.getImmediateChild(r);let x=a.getChildAfterChild(this.index_,v,this.reverse_);for(;x!=null&&(x.name===r||p.hasChild(x.name));)x=a.getChildAfterChild(this.index_,x,this.reverse_);const R=x==null?1:h(x,g);if(S&&!o.isEmpty()&&R>=0)return u!=null&&u.trackChildChange(li(r,o,y)),p.updateImmediateChild(r,o);{u!=null&&u.trackChildChange(oi(r,y));const B=p.updateImmediateChild(r,ae.EMPTY_NODE);return x!=null&&this.rangedFilter_.matches(x)?(u!=null&&u.trackChildChange(rs(x.name,x.node)),B.updateImmediateChild(x.name,x.node)):B}}else return o.isEmpty()?t:S&&h(v,g)>=0?(u!=null&&(u.trackChildChange(oi(v.name,v.node)),u.trackChildChange(rs(r,o))),p.updateImmediateChild(r,o).updateImmediateChild(v.name,ae.EMPTY_NODE)):t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ge}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return $(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return $(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ns}hasEnd(){return this.endSet_}getIndexEndValue(){return $(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return $(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:yr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return $(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ge}copy(){const t=new Wc;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function iy(s){return s.loadsAllData()?new $c(s.getIndex()):s.hasLimit()?new sy(s):new ai(s)}function Wh(s){const t={};if(s.isDefault())return t;let r;if(s.index_===Ge?r="$priority":s.index_===ny?r="$value":s.index_===Zr?r="$key":($(s.index_ instanceof ey,"Unrecognized index type!"),r=s.index_.toString()),t.orderBy=ht(r),s.startSet_){const o=s.startAfterSet_?"startAfter":"startAt";t[o]=ht(s.indexStartValue_),s.startNameSet_&&(t[o]+=","+ht(s.indexStartName_))}if(s.endSet_){const o=s.endBeforeSet_?"endBefore":"endAt";t[o]=ht(s.indexEndValue_),s.endNameSet_&&(t[o]+=","+ht(s.indexEndName_))}return s.limitSet_&&(s.isViewFromLeft()?t.limitToFirst=s.limit_:t.limitToLast=s.limit_),t}function Hh(s){const t={};if(s.startSet_&&(t.sp=s.indexStartValue_,s.startNameSet_&&(t.sn=s.indexStartName_),t.sin=!s.startAfterSet_),s.endSet_&&(t.ep=s.indexEndValue_,s.endNameSet_&&(t.en=s.indexEndName_),t.ein=!s.endBeforeSet_),s.limitSet_){t.l=s.limit_;let r=s.viewFrom_;r===""&&(s.isViewFromLeft()?r="l":r="r"),t.vf=r}return s.index_!==Ge&&(t.i=s.index_.toString()),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo extends Gp{reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,r){return r!==void 0?"tag$"+r:($(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}constructor(t,r,o,a){super(),this.repoInfo_=t,this.onDataUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.log_=mi("p:rest:"),this.listens_={}}listen(t,r,o,a){const u=t._path.toString();this.log_("Listen called for "+u+" "+t._queryIdentifier);const h=zo.getListenId_(t,o),p={};this.listens_[h]=p;const g=Wh(t._queryParams);this.restRequest_(u+".json",g,(v,S)=>{let y=S;if(v===404&&(y=null,v=null),v===null&&this.onDataUpdate_(u,y,!1,o),ts(this.listens_,h)===p){let x;v?v===401?x="permission_denied":x="rest_error:"+v:x="ok",a(x,null)}})}unlisten(t,r){const o=zo.getListenId_(t,r);delete this.listens_[o]}get(t){const r=Wh(t._queryParams),o=t._path.toString(),a=new Ko;return this.restRequest_(o+".json",r,(u,h)=>{let p=h;u===404&&(p=null,u=null),u===null?(this.onDataUpdate_(o,p,!1,null),a.resolve(p)):a.reject(new Error(p))}),a.promise}refreshAuthToken(t){}restRequest_(t,r={},o){return r.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([a,u])=>{a&&a.accessToken&&(r.auth=a.accessToken),u&&u.token&&(r.ac=u.token);const h=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+jv(r);this.log_("Sending REST request for "+h);const p=new XMLHttpRequest;p.onreadystatechange=()=>{if(o&&p.readyState===4){this.log_("REST Response for "+h+" received. status:",p.status,"response:",p.responseText);let g=null;if(p.status>=200&&p.status<300){try{g=ni(p.responseText)}catch{Mt("Failed to parse JSON response for "+h+": "+p.responseText)}o(null,g)}else p.status!==401&&p.status!==404&&Mt("Got unsuccessful REST response for "+h+" Status: "+p.status),o(p.status);o=null}},p.open("GET",h,!0),p.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(){this.rootNode_=ae.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,r){this.rootNode_=this.rootNode_.updateChild(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uo(){return{value:null,children:new Map}}function om(s,t,r){if(xe(t))s.value=r,s.children.clear();else if(s.value!==null)s.value=s.value.updateChild(t,r);else{const o=me(t);s.children.has(o)||s.children.set(o,Uo());const a=s.children.get(o);t=Ae(t),om(a,t,r)}}function _c(s,t,r){s.value!==null?r(t,s.value):ly(s,(o,a)=>{const u=new Pe(t.toString()+"/"+o);_c(a,u,r)})}function ly(s,t){s.children.forEach((r,o)=>{t(o,r)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),r={...t};return this.last_&&At(this.last_,(o,a)=>{r[o]=r[o]-a}),this.last_=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vh=10*1e3,cy=30*1e3,uy=300*1e3;class dy{constructor(t,r){this.server_=r,this.statsToReport_={},this.statsListener_=new ay(t);const o=Vh+(cy-Vh)*Math.random();Js(this.reportStats_.bind(this),Math.floor(o))}reportStats_(){const t=this.statsListener_.get(),r={};let o=!1;At(t,(a,u)=>{u>0&&bn(this.statsToReport_,a)&&(r[a]=u,o=!0)}),o&&this.server_.reportStats(r),Js(this.reportStats_.bind(this),Math.floor(Math.random()*2*uy))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sn;(function(s){s[s.OVERWRITE=0]="OVERWRITE",s[s.MERGE=1]="MERGE",s[s.ACK_USER_WRITE=2]="ACK_USER_WRITE",s[s.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(sn||(sn={}));function lm(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Hc(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Vc(s){return{fromUser:!1,fromServer:!0,queryId:s,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(t,r,o){this.path=t,this.affectedTree=r,this.revert=o,this.type=sn.ACK_USER_WRITE,this.source=lm()}operationForChild(t){if(xe(this.path)){if(this.affectedTree.value!=null)return $(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const r=this.affectedTree.subtree(new Pe(t));return new Bo(Ie(),r,this.revert)}}else return $(me(this.path)===t,"operationForChild called for unrelated child."),new Bo(Ae(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(t,r){this.source=t,this.path=r,this.type=sn.LISTEN_COMPLETE}operationForChild(t){return xe(this.path)?new ci(this.source,Ie()):new ci(this.source,Ae(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(t,r,o){this.source=t,this.path=r,this.snap=o,this.type=sn.OVERWRITE}operationForChild(t){return xe(this.path)?new wr(this.source,Ie(),this.snap.getImmediateChild(t)):new wr(this.source,Ae(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(t,r,o){this.source=t,this.path=r,this.children=o,this.type=sn.MERGE}operationForChild(t){if(xe(this.path)){const r=this.children.subtree(new Pe(t));return r.isEmpty()?null:r.value?new wr(this.source,Ie(),r.value):new ui(this.source,Ie(),r)}else return $(me(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new ui(this.source,Ae(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(t,r,o){this.node_=t,this.fullyInitialized_=r,this.filtered_=o}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(xe(t))return this.isFullyInitialized()&&!this.filtered_;const r=me(t);return this.isCompleteForChild(r)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function hy(s,t,r,o){const a=[],u=[];return t.forEach(h=>{h.type==="child_changed"&&s.index_.indexedValueChanged(h.oldSnap,h.snapshotNode)&&u.push(ry(h.childName,h.snapshotNode))}),Ks(s,a,"child_removed",t,o,r),Ks(s,a,"child_added",t,o,r),Ks(s,a,"child_moved",u,o,r),Ks(s,a,"child_changed",t,o,r),Ks(s,a,"value",t,o,r),a}function Ks(s,t,r,o,a,u){const h=o.filter(p=>p.type===r);h.sort((p,g)=>my(s,p,g)),h.forEach(p=>{const g=py(s,p,u);a.forEach(v=>{v.respondsTo(p.type)&&t.push(v.createEvent(g,s.query_))})})}function py(s,t,r){return t.type==="value"||t.type==="child_removed"||(t.prevName=r.getPredecessorChildName(t.childName,t.snapshotNode,s.index_)),t}function my(s,t,r){if(t.childName==null||r.childName==null)throw is("Should only compare child_ events.");const o=new ge(t.childName,t.snapshotNode),a=new ge(r.childName,r.snapshotNode);return s.index_.compare(o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jo(s,t){return{eventCache:s,serverCache:t}}function Zs(s,t,r,o){return Jo(new Cr(t,r,o),s.serverCache)}function am(s,t,r,o){return Jo(s.eventCache,new Cr(t,r,o))}function yc(s){return s.eventCache.isFullyInitialized()?s.eventCache.getNode():null}function kr(s){return s.serverCache.isFullyInitialized()?s.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oc;const gy=()=>(oc||(oc=new Lt(t_)),oc);class ze{static fromObject(t){let r=new ze(null);return At(t,(o,a)=>{r=r.set(new Pe(o),a)}),r}constructor(t,r=gy()){this.value=t,this.children=r}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,r){if(this.value!=null&&r(this.value))return{path:Ie(),value:this.value};if(xe(t))return null;{const o=me(t),a=this.children.get(o);if(a!==null){const u=a.findRootMostMatchingPathAndValue(Ae(t),r);return u!=null?{path:lt(new Pe(o),u.path),value:u.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(xe(t))return this;{const r=me(t),o=this.children.get(r);return o!==null?o.subtree(Ae(t)):new ze(null)}}set(t,r){if(xe(t))return new ze(r,this.children);{const o=me(t),u=(this.children.get(o)||new ze(null)).set(Ae(t),r),h=this.children.insert(o,u);return new ze(this.value,h)}}remove(t){if(xe(t))return this.children.isEmpty()?new ze(null):new ze(null,this.children);{const r=me(t),o=this.children.get(r);if(o){const a=o.remove(Ae(t));let u;return a.isEmpty()?u=this.children.remove(r):u=this.children.insert(r,a),this.value===null&&u.isEmpty()?new ze(null):new ze(this.value,u)}else return this}}get(t){if(xe(t))return this.value;{const r=me(t),o=this.children.get(r);return o?o.get(Ae(t)):null}}setTree(t,r){if(xe(t))return r;{const o=me(t),u=(this.children.get(o)||new ze(null)).setTree(Ae(t),r);let h;return u.isEmpty()?h=this.children.remove(o):h=this.children.insert(o,u),new ze(this.value,h)}}fold(t){return this.fold_(Ie(),t)}fold_(t,r){const o={};return this.children.inorderTraversal((a,u)=>{o[a]=u.fold_(lt(t,a),r)}),r(t,this.value,o)}findOnPath(t,r){return this.findOnPath_(t,Ie(),r)}findOnPath_(t,r,o){const a=this.value?o(r,this.value):!1;if(a)return a;if(xe(t))return null;{const u=me(t),h=this.children.get(u);return h?h.findOnPath_(Ae(t),lt(r,u),o):null}}foreachOnPath(t,r){return this.foreachOnPath_(t,Ie(),r)}foreachOnPath_(t,r,o){if(xe(t))return this;{this.value&&o(r,this.value);const a=me(t),u=this.children.get(a);return u?u.foreachOnPath_(Ae(t),lt(r,a),o):new ze(null)}}foreach(t){this.foreach_(Ie(),t)}foreach_(t,r){this.children.inorderTraversal((o,a)=>{a.foreach_(lt(t,o),r)}),this.value&&r(t,this.value)}foreachChild(t){this.children.inorderTraversal((r,o)=>{o.value&&t(r,o.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(t){this.writeTree_=t}static empty(){return new on(new ze(null))}}function ei(s,t,r){if(xe(t))return new on(new ze(r));{const o=s.writeTree_.findRootMostValueAndPath(t);if(o!=null){const a=o.path;let u=o.value;const h=Dt(a,t);return u=u.updateChild(h,r),new on(s.writeTree_.set(a,u))}else{const a=new ze(r),u=s.writeTree_.setTree(t,a);return new on(u)}}}function Yh(s,t,r){let o=s;return At(r,(a,u)=>{o=ei(o,lt(t,a),u)}),o}function Qh(s,t){if(xe(t))return on.empty();{const r=s.writeTree_.setTree(t,new ze(null));return new on(r)}}function wc(s,t){return Nr(s,t)!=null}function Nr(s,t){const r=s.writeTree_.findRootMostValueAndPath(t);return r!=null?s.writeTree_.get(r.path).getChild(Dt(r.path,t)):null}function Gh(s){const t=[],r=s.writeTree_.value;return r!=null?r.isLeafNode()||r.forEachChild(Ge,(o,a)=>{t.push(new ge(o,a))}):s.writeTree_.children.inorderTraversal((o,a)=>{a.value!=null&&t.push(new ge(o,a.value))}),t}function qn(s,t){if(xe(t))return s;{const r=Nr(s,t);return r!=null?new on(new ze(r)):new on(s.writeTree_.subtree(t))}}function Cc(s){return s.writeTree_.isEmpty()}function ss(s,t){return cm(Ie(),s.writeTree_,t)}function cm(s,t,r){if(t.value!=null)return r.updateChild(s,t.value);{let o=null;return t.children.inorderTraversal((a,u)=>{a===".priority"?($(u.value!==null,"Priority writes must always be leaf nodes"),o=u.value):r=cm(lt(s,a),u,r)}),!r.getChild(s).isEmpty()&&o!==null&&(r=r.updateChild(lt(s,".priority"),o)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yc(s,t){return hm(t,s)}function vy(s,t,r,o,a){$(o>s.lastWriteId,"Stacking an older write on top of newer ones"),a===void 0&&(a=!0),s.allWrites.push({path:t,snap:r,writeId:o,visible:a}),a&&(s.visibleWrites=ei(s.visibleWrites,t,r)),s.lastWriteId=o}function xy(s,t){for(let r=0;r<s.allWrites.length;r++){const o=s.allWrites[r];if(o.writeId===t)return o}return null}function _y(s,t){const r=s.allWrites.findIndex(p=>p.writeId===t);$(r>=0,"removeWrite called with nonexistent writeId.");const o=s.allWrites[r];s.allWrites.splice(r,1);let a=o.visible,u=!1,h=s.allWrites.length-1;for(;a&&h>=0;){const p=s.allWrites[h];p.visible&&(h>=r&&yy(p,o.path)?a=!1:rn(o.path,p.path)&&(u=!0)),h--}if(a){if(u)return wy(s),!0;if(o.snap)s.visibleWrites=Qh(s.visibleWrites,o.path);else{const p=o.children;At(p,g=>{s.visibleWrites=Qh(s.visibleWrites,lt(o.path,g))})}return!0}else return!1}function yy(s,t){if(s.snap)return rn(s.path,t);for(const r in s.children)if(s.children.hasOwnProperty(r)&&rn(lt(s.path,r),t))return!0;return!1}function wy(s){s.visibleWrites=um(s.allWrites,Cy,Ie()),s.allWrites.length>0?s.lastWriteId=s.allWrites[s.allWrites.length-1].writeId:s.lastWriteId=-1}function Cy(s){return s.visible}function um(s,t,r){let o=on.empty();for(let a=0;a<s.length;++a){const u=s[a];if(t(u)){const h=u.path;let p;if(u.snap)rn(r,h)?(p=Dt(r,h),o=ei(o,p,u.snap)):rn(h,r)&&(p=Dt(h,r),o=ei(o,Ie(),u.snap.getChild(p)));else if(u.children){if(rn(r,h))p=Dt(r,h),o=Yh(o,p,u.children);else if(rn(h,r))if(p=Dt(h,r),xe(p))o=Yh(o,Ie(),u.children);else{const g=ts(u.children,me(p));if(g){const v=g.getChild(Ae(p));o=ei(o,Ie(),v)}}}else throw is("WriteRecord should have .snap or .children")}}return o}function dm(s,t,r,o,a){if(!o&&!a){const u=Nr(s.visibleWrites,t);if(u!=null)return u;{const h=qn(s.visibleWrites,t);if(Cc(h))return r;if(r==null&&!wc(h,Ie()))return null;{const p=r||ae.EMPTY_NODE;return ss(h,p)}}}else{const u=qn(s.visibleWrites,t);if(!a&&Cc(u))return r;if(!a&&r==null&&!wc(u,Ie()))return null;{const h=function(v){return(v.visible||a)&&(!o||!~o.indexOf(v.writeId))&&(rn(v.path,t)||rn(t,v.path))},p=um(s.allWrites,h,t),g=r||ae.EMPTY_NODE;return ss(p,g)}}}function ky(s,t,r){let o=ae.EMPTY_NODE;const a=Nr(s.visibleWrites,t);if(a)return a.isLeafNode()||a.forEachChild(Ge,(u,h)=>{o=o.updateImmediateChild(u,h)}),o;if(r){const u=qn(s.visibleWrites,t);return r.forEachChild(Ge,(h,p)=>{const g=ss(qn(u,new Pe(h)),p);o=o.updateImmediateChild(h,g)}),Gh(u).forEach(h=>{o=o.updateImmediateChild(h.name,h.node)}),o}else{const u=qn(s.visibleWrites,t);return Gh(u).forEach(h=>{o=o.updateImmediateChild(h.name,h.node)}),o}}function Ny(s,t,r,o,a){$(o||a,"Either existingEventSnap or existingServerSnap must exist");const u=lt(t,r);if(wc(s.visibleWrites,u))return null;{const h=qn(s.visibleWrites,u);return Cc(h)?a.getChild(r):ss(h,a.getChild(r))}}function Sy(s,t,r,o){const a=lt(t,r),u=Nr(s.visibleWrites,a);if(u!=null)return u;if(o.isCompleteForChild(r)){const h=qn(s.visibleWrites,a);return ss(h,o.getNode().getImmediateChild(r))}else return null}function Ey(s,t){return Nr(s.visibleWrites,t)}function by(s,t,r,o,a,u,h){let p;const g=qn(s.visibleWrites,t),v=Nr(g,Ie());if(v!=null)p=v;else if(r!=null)p=ss(g,r);else return[];if(p=p.withIndex(h),!p.isEmpty()&&!p.isLeafNode()){const S=[],y=h.getCompare(),x=u?p.getReverseIteratorFrom(o,h):p.getIteratorFrom(o,h);let R=x.getNext();for(;R&&S.length<a;)y(R,o)!==0&&S.push(R),R=x.getNext();return S}else return[]}function Iy(){return{visibleWrites:on.empty(),allWrites:[],lastWriteId:-1}}function $o(s,t,r,o){return dm(s.writeTree,s.treePath,t,r,o)}function Qc(s,t){return ky(s.writeTree,s.treePath,t)}function Kh(s,t,r,o){return Ny(s.writeTree,s.treePath,t,r,o)}function Wo(s,t){return Ey(s.writeTree,lt(s.treePath,t))}function Ty(s,t,r,o,a,u){return by(s.writeTree,s.treePath,t,r,o,a,u)}function Gc(s,t,r){return Sy(s.writeTree,s.treePath,t,r)}function fm(s,t){return hm(lt(s.treePath,t),s.writeTree)}function hm(s,t){return{treePath:s,writeTree:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(){this.changeMap=new Map}trackChildChange(t){const r=t.type,o=t.childName;$(r==="child_added"||r==="child_changed"||r==="child_removed","Only child changes supported for tracking"),$(o!==".priority","Only non-priority child changes can be tracked.");const a=this.changeMap.get(o);if(a){const u=a.type;if(r==="child_added"&&u==="child_removed")this.changeMap.set(o,li(o,t.snapshotNode,a.snapshotNode));else if(r==="child_removed"&&u==="child_added")this.changeMap.delete(o);else if(r==="child_removed"&&u==="child_changed")this.changeMap.set(o,oi(o,a.oldSnap));else if(r==="child_changed"&&u==="child_added")this.changeMap.set(o,rs(o,t.snapshotNode));else if(r==="child_changed"&&u==="child_changed")this.changeMap.set(o,li(o,t.snapshotNode,a.oldSnap));else throw is("Illegal combination of changes: "+t+" occurred after "+a)}else this.changeMap.set(o,t)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{getCompleteChild(t){return null}getChildAfterChild(t,r,o){return null}}const pm=new Ry;class Kc{constructor(t,r,o=null){this.writes_=t,this.viewCache_=r,this.optCompleteServerCache_=o}getCompleteChild(t){const r=this.viewCache_.eventCache;if(r.isCompleteForChild(t))return r.getNode().getImmediateChild(t);{const o=this.optCompleteServerCache_!=null?new Cr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Gc(this.writes_,t,o)}}getChildAfterChild(t,r,o){const a=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:kr(this.viewCache_),u=Ty(this.writes_,a,r,1,o,t);return u.length===0?null:u[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Py(s){return{filter:s}}function Dy(s,t){$(t.eventCache.getNode().isIndexed(s.filter.getIndex()),"Event snap not indexed"),$(t.serverCache.getNode().isIndexed(s.filter.getIndex()),"Server snap not indexed")}function Ly(s,t,r,o,a){const u=new jy;let h,p;if(r.type===sn.OVERWRITE){const v=r;v.source.fromUser?h=kc(s,t,v.path,v.snap,o,a,u):($(v.source.fromServer,"Unknown source."),p=v.source.tagged||t.serverCache.isFiltered()&&!xe(v.path),h=Ho(s,t,v.path,v.snap,o,a,p,u))}else if(r.type===sn.MERGE){const v=r;v.source.fromUser?h=Ay(s,t,v.path,v.children,o,a,u):($(v.source.fromServer,"Unknown source."),p=v.source.tagged||t.serverCache.isFiltered(),h=Nc(s,t,v.path,v.children,o,a,p,u))}else if(r.type===sn.ACK_USER_WRITE){const v=r;v.revert?h=zy(s,t,v.path,o,a,u):h=Oy(s,t,v.path,v.affectedTree,o,a,u)}else if(r.type===sn.LISTEN_COMPLETE)h=Fy(s,t,r.path,o,u);else throw is("Unknown operation type: "+r.type);const g=u.getChanges();return My(t,h,g),{viewCache:h,changes:g}}function My(s,t,r){const o=t.eventCache;if(o.isFullyInitialized()){const a=o.getNode().isLeafNode()||o.getNode().isEmpty(),u=yc(s);(r.length>0||!s.eventCache.isFullyInitialized()||a&&!o.getNode().equals(u)||!o.getNode().getPriority().equals(u.getPriority()))&&r.push(im(yc(t)))}}function mm(s,t,r,o,a,u){const h=t.eventCache;if(Wo(o,r)!=null)return t;{let p,g;if(xe(r))if($(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const v=kr(t),S=v instanceof ae?v:ae.EMPTY_NODE,y=Qc(o,S);p=s.filter.updateFullNode(t.eventCache.getNode(),y,u)}else{const v=$o(o,kr(t));p=s.filter.updateFullNode(t.eventCache.getNode(),v,u)}else{const v=me(r);if(v===".priority"){$(Xn(r)===1,"Can't have a priority with additional path components");const S=h.getNode();g=t.serverCache.getNode();const y=Kh(o,r,S,g);y!=null?p=s.filter.updatePriority(S,y):p=h.getNode()}else{const S=Ae(r);let y;if(h.isCompleteForChild(v)){g=t.serverCache.getNode();const x=Kh(o,r,h.getNode(),g);x!=null?y=h.getNode().getImmediateChild(v).updateChild(S,x):y=h.getNode().getImmediateChild(v)}else y=Gc(o,v,t.serverCache);y!=null?p=s.filter.updateChild(h.getNode(),v,y,S,a,u):p=h.getNode()}}return Zs(t,p,h.isFullyInitialized()||xe(r),s.filter.filtersNodes())}}function Ho(s,t,r,o,a,u,h,p){const g=t.serverCache;let v;const S=h?s.filter:s.filter.getIndexedFilter();if(xe(r))v=S.updateFullNode(g.getNode(),o,null);else if(S.filtersNodes()&&!g.isFiltered()){const R=g.getNode().updateChild(r,o);v=S.updateFullNode(g.getNode(),R,null)}else{const R=me(r);if(!g.isCompleteForPath(r)&&Xn(r)>1)return t;const P=Ae(r),Q=g.getNode().getImmediateChild(R).updateChild(P,o);R===".priority"?v=S.updatePriority(g.getNode(),Q):v=S.updateChild(g.getNode(),R,Q,P,pm,null)}const y=am(t,v,g.isFullyInitialized()||xe(r),S.filtersNodes()),x=new Kc(a,y,u);return mm(s,y,r,a,x,p)}function kc(s,t,r,o,a,u,h){const p=t.eventCache;let g,v;const S=new Kc(a,t,u);if(xe(r))v=s.filter.updateFullNode(t.eventCache.getNode(),o,h),g=Zs(t,v,!0,s.filter.filtersNodes());else{const y=me(r);if(y===".priority")v=s.filter.updatePriority(t.eventCache.getNode(),o),g=Zs(t,v,p.isFullyInitialized(),p.isFiltered());else{const x=Ae(r),R=p.getNode().getImmediateChild(y);let P;if(xe(x))P=o;else{const B=S.getCompleteChild(y);B!=null?qp(x)===".priority"&&B.getChild(Jp(x)).isEmpty()?P=B:P=B.updateChild(x,o):P=ae.EMPTY_NODE}if(R.equals(P))g=t;else{const B=s.filter.updateChild(p.getNode(),y,P,x,S,h);g=Zs(t,B,p.isFullyInitialized(),s.filter.filtersNodes())}}}return g}function qh(s,t){return s.eventCache.isCompleteForChild(t)}function Ay(s,t,r,o,a,u,h){let p=t;return o.foreach((g,v)=>{const S=lt(r,g);qh(t,me(S))&&(p=kc(s,p,S,v,a,u,h))}),o.foreach((g,v)=>{const S=lt(r,g);qh(t,me(S))||(p=kc(s,p,S,v,a,u,h))}),p}function Xh(s,t,r){return r.foreach((o,a)=>{t=t.updateChild(o,a)}),t}function Nc(s,t,r,o,a,u,h,p){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let g=t,v;xe(r)?v=o:v=new ze(null).setTree(r,o);const S=t.serverCache.getNode();return v.children.inorderTraversal((y,x)=>{if(S.hasChild(y)){const R=t.serverCache.getNode().getImmediateChild(y),P=Xh(s,R,x);g=Ho(s,g,new Pe(y),P,a,u,h,p)}}),v.children.inorderTraversal((y,x)=>{const R=!t.serverCache.isCompleteForChild(y)&&x.value===null;if(!S.hasChild(y)&&!R){const P=t.serverCache.getNode().getImmediateChild(y),B=Xh(s,P,x);g=Ho(s,g,new Pe(y),B,a,u,h,p)}}),g}function Oy(s,t,r,o,a,u,h){if(Wo(a,r)!=null)return t;const p=t.serverCache.isFiltered(),g=t.serverCache;if(o.value!=null){if(xe(r)&&g.isFullyInitialized()||g.isCompleteForPath(r))return Ho(s,t,r,g.getNode().getChild(r),a,u,p,h);if(xe(r)){let v=new ze(null);return g.getNode().forEachChild(Zr,(S,y)=>{v=v.set(new Pe(S),y)}),Nc(s,t,r,v,a,u,p,h)}else return t}else{let v=new ze(null);return o.foreach((S,y)=>{const x=lt(r,S);g.isCompleteForPath(x)&&(v=v.set(S,g.getNode().getChild(x)))}),Nc(s,t,r,v,a,u,p,h)}}function Fy(s,t,r,o,a){const u=t.serverCache,h=am(t,u.getNode(),u.isFullyInitialized()||xe(r),u.isFiltered());return mm(s,h,r,o,pm,a)}function zy(s,t,r,o,a,u){let h;if(Wo(o,r)!=null)return t;{const p=new Kc(o,t,a),g=t.eventCache.getNode();let v;if(xe(r)||me(r)===".priority"){let S;if(t.serverCache.isFullyInitialized())S=$o(o,kr(t));else{const y=t.serverCache.getNode();$(y instanceof ae,"serverChildren would be complete if leaf node"),S=Qc(o,y)}S=S,v=s.filter.updateFullNode(g,S,u)}else{const S=me(r);let y=Gc(o,S,t.serverCache);y==null&&t.serverCache.isCompleteForChild(S)&&(y=g.getImmediateChild(S)),y!=null?v=s.filter.updateChild(g,S,y,Ae(r),p,u):t.eventCache.getNode().hasChild(S)?v=s.filter.updateChild(g,S,ae.EMPTY_NODE,Ae(r),p,u):v=g,v.isEmpty()&&t.serverCache.isFullyInitialized()&&(h=$o(o,kr(t)),h.isLeafNode()&&(v=s.filter.updateFullNode(v,h,u)))}return h=t.serverCache.isFullyInitialized()||Wo(o,Ie())!=null,Zs(t,v,h,s.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(t,r){this.query_=t,this.eventRegistrations_=[];const o=this.query_._queryParams,a=new $c(o.getIndex()),u=iy(o);this.processor_=Py(u);const h=r.serverCache,p=r.eventCache,g=a.updateFullNode(ae.EMPTY_NODE,h.getNode(),null),v=u.updateFullNode(ae.EMPTY_NODE,p.getNode(),null),S=new Cr(g,h.isFullyInitialized(),a.filtersNodes()),y=new Cr(v,p.isFullyInitialized(),u.filtersNodes());this.viewCache_=Jo(y,S),this.eventGenerator_=new fy(this.query_)}get query(){return this.query_}}function By(s){return s.viewCache_.serverCache.getNode()}function $y(s,t){const r=kr(s.viewCache_);return r&&(s.query._queryParams.loadsAllData()||!xe(t)&&!r.getImmediateChild(me(t)).isEmpty())?r.getChild(t):null}function Jh(s){return s.eventRegistrations_.length===0}function Wy(s,t){s.eventRegistrations_.push(t)}function Zh(s,t,r){const o=[];if(r){$(t==null,"A cancel should cancel all event registrations.");const a=s.query._path;s.eventRegistrations_.forEach(u=>{const h=u.createCancelEvent(r,a);h&&o.push(h)})}if(t){let a=[];for(let u=0;u<s.eventRegistrations_.length;++u){const h=s.eventRegistrations_[u];if(!h.matches(t))a.push(h);else if(t.hasAnyCallback()){a=a.concat(s.eventRegistrations_.slice(u+1));break}}s.eventRegistrations_=a}else s.eventRegistrations_=[];return o}function ep(s,t,r,o){t.type===sn.MERGE&&t.source.queryId!==null&&($(kr(s.viewCache_),"We should always have a full cache before handling merges"),$(yc(s.viewCache_),"Missing event cache, even though we have a server cache"));const a=s.viewCache_,u=Ly(s.processor_,a,t,r,o);return Dy(s.processor_,u.viewCache),$(u.viewCache.serverCache.isFullyInitialized()||!a.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),s.viewCache_=u.viewCache,gm(s,u.changes,u.viewCache.eventCache.getNode(),null)}function Hy(s,t){const r=s.viewCache_.eventCache,o=[];return r.getNode().isLeafNode()||r.getNode().forEachChild(Ge,(u,h)=>{o.push(rs(u,h))}),r.isFullyInitialized()&&o.push(im(r.getNode())),gm(s,o,r.getNode(),t)}function gm(s,t,r,o){const a=o?[o]:s.eventRegistrations_;return hy(s.eventGenerator_,t,r,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vo;class Vy{constructor(){this.views=new Map}}function Yy(s){$(!Vo,"__referenceConstructor has already been defined"),Vo=s}function Qy(){return $(Vo,"Reference.ts has not been loaded"),Vo}function Gy(s){return s.views.size===0}function qc(s,t,r,o){const a=t.source.queryId;if(a!==null){const u=s.views.get(a);return $(u!=null,"SyncTree gave us an op for an invalid query."),ep(u,t,r,o)}else{let u=[];for(const h of s.views.values())u=u.concat(ep(h,t,r,o));return u}}function Ky(s,t,r,o,a){const u=t._queryIdentifier,h=s.views.get(u);if(!h){let p=$o(r,a?o:null),g=!1;p?g=!0:o instanceof ae?(p=Qc(r,o),g=!1):(p=ae.EMPTY_NODE,g=!1);const v=Jo(new Cr(p,g,!1),new Cr(o,a,!1));return new Uy(t,v)}return h}function qy(s,t,r,o,a,u){const h=Ky(s,t,o,a,u);return s.views.has(t._queryIdentifier)||s.views.set(t._queryIdentifier,h),Wy(h,r),Hy(h,r)}function Xy(s,t,r,o){const a=t._queryIdentifier,u=[];let h=[];const p=Jn(s);if(a==="default")for(const[g,v]of s.views.entries())h=h.concat(Zh(v,r,o)),Jh(v)&&(s.views.delete(g),v.query._queryParams.loadsAllData()||u.push(v.query));else{const g=s.views.get(a);g&&(h=h.concat(Zh(g,r,o)),Jh(g)&&(s.views.delete(a),g.query._queryParams.loadsAllData()||u.push(g.query)))}return p&&!Jn(s)&&u.push(new(Qy())(t._repo,t._path)),{removed:u,events:h}}function vm(s){const t=[];for(const r of s.views.values())r.query._queryParams.loadsAllData()||t.push(r);return t}function es(s,t){let r=null;for(const o of s.views.values())r=r||$y(o,t);return r}function xm(s,t){if(t._queryParams.loadsAllData())return Zo(s);{const o=t._queryIdentifier;return s.views.get(o)}}function _m(s,t){return xm(s,t)!=null}function Jn(s){return Zo(s)!=null}function Zo(s){for(const t of s.views.values())if(t.query._queryParams.loadsAllData())return t;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yo;function Jy(s){$(!Yo,"__referenceConstructor has already been defined"),Yo=s}function Zy(){return $(Yo,"Reference.ts has not been loaded"),Yo}let e1=1;class tp{constructor(t){this.listenProvider_=t,this.syncPointTree_=new ze(null),this.pendingWriteTree_=Iy(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function ym(s,t,r,o,a){return vy(s.pendingWriteTree_,t,r,o,a),a?vi(s,new wr(lm(),t,r)):[]}function _r(s,t,r=!1){const o=xy(s.pendingWriteTree_,t);if(_y(s.pendingWriteTree_,t)){let u=new ze(null);return o.snap!=null?u=u.set(Ie(),!0):At(o.children,h=>{u=u.set(new Pe(h),!0)}),vi(s,new Bo(o.path,u,r))}else return[]}function el(s,t,r){return vi(s,new wr(Hc(),t,r))}function t1(s,t,r){const o=ze.fromObject(r);return vi(s,new ui(Hc(),t,o))}function n1(s,t){return vi(s,new ci(Hc(),t))}function r1(s,t,r){const o=Jc(s,r);if(o){const a=Zc(o),u=a.path,h=a.queryId,p=Dt(u,t),g=new ci(Vc(h),p);return eu(s,u,g)}else return[]}function Sc(s,t,r,o,a=!1){const u=t._path,h=s.syncPointTree_.get(u);let p=[];if(h&&(t._queryIdentifier==="default"||_m(h,t))){const g=Xy(h,t,r,o);Gy(h)&&(s.syncPointTree_=s.syncPointTree_.remove(u));const v=g.removed;if(p=g.events,!a){const S=v.findIndex(x=>x._queryParams.loadsAllData())!==-1,y=s.syncPointTree_.findOnPath(u,(x,R)=>Jn(R));if(S&&!y){const x=s.syncPointTree_.subtree(u);if(!x.isEmpty()){const R=o1(x);for(let P=0;P<R.length;++P){const B=R[P],Q=B.query,te=km(s,B);s.listenProvider_.startListening(ti(Q),Qo(s,Q),te.hashFn,te.onComplete)}}}!y&&v.length>0&&!o&&(S?s.listenProvider_.stopListening(ti(t),null):v.forEach(x=>{const R=s.queryToTagMap.get(tl(x));s.listenProvider_.stopListening(ti(x),R)}))}l1(s,v)}return p}function s1(s,t,r,o){const a=Jc(s,o);if(a!=null){const u=Zc(a),h=u.path,p=u.queryId,g=Dt(h,t),v=new wr(Vc(p),g,r);return eu(s,h,v)}else return[]}function i1(s,t,r,o){const a=Jc(s,o);if(a){const u=Zc(a),h=u.path,p=u.queryId,g=Dt(h,t),v=ze.fromObject(r),S=new ui(Vc(p),g,v);return eu(s,h,S)}else return[]}function np(s,t,r,o=!1){const a=t._path;let u=null,h=!1;s.syncPointTree_.foreachOnPath(a,(x,R)=>{const P=Dt(x,a);u=u||es(R,P),h=h||Jn(R)});let p=s.syncPointTree_.get(a);p?(h=h||Jn(p),u=u||es(p,Ie())):(p=new Vy,s.syncPointTree_=s.syncPointTree_.set(a,p));let g;u!=null?g=!0:(g=!1,u=ae.EMPTY_NODE,s.syncPointTree_.subtree(a).foreachChild((R,P)=>{const B=es(P,Ie());B&&(u=u.updateImmediateChild(R,B))}));const v=_m(p,t);if(!v&&!t._queryParams.loadsAllData()){const x=tl(t);$(!s.queryToTagMap.has(x),"View does not exist, but we have a tag");const R=a1();s.queryToTagMap.set(x,R),s.tagToQueryMap.set(R,x)}const S=Yc(s.pendingWriteTree_,a);let y=qy(p,t,r,S,u,g);if(!v&&!h&&!o){const x=xm(p,t);y=y.concat(c1(s,t,x))}return y}function Xc(s,t,r){const a=s.pendingWriteTree_,u=s.syncPointTree_.findOnPath(t,(h,p)=>{const g=Dt(h,t),v=es(p,g);if(v)return v});return dm(a,t,u,r,!0)}function vi(s,t){return wm(t,s.syncPointTree_,null,Yc(s.pendingWriteTree_,Ie()))}function wm(s,t,r,o){if(xe(s.path))return Cm(s,t,r,o);{const a=t.get(Ie());r==null&&a!=null&&(r=es(a,Ie()));let u=[];const h=me(s.path),p=s.operationForChild(h),g=t.children.get(h);if(g&&p){const v=r?r.getImmediateChild(h):null,S=fm(o,h);u=u.concat(wm(p,g,v,S))}return a&&(u=u.concat(qc(a,s,o,r))),u}}function Cm(s,t,r,o){const a=t.get(Ie());r==null&&a!=null&&(r=es(a,Ie()));let u=[];return t.children.inorderTraversal((h,p)=>{const g=r?r.getImmediateChild(h):null,v=fm(o,h),S=s.operationForChild(h);S&&(u=u.concat(Cm(S,p,g,v)))}),a&&(u=u.concat(qc(a,s,o,r))),u}function km(s,t){const r=t.query,o=Qo(s,r);return{hashFn:()=>(By(t)||ae.EMPTY_NODE).hash(),onComplete:a=>{if(a==="ok")return o?r1(s,r._path,o):n1(s,r._path);{const u=s_(a,r);return Sc(s,r,null,u)}}}}function Qo(s,t){const r=tl(t);return s.queryToTagMap.get(r)}function tl(s){return s._path.toString()+"$"+s._queryIdentifier}function Jc(s,t){return s.tagToQueryMap.get(t)}function Zc(s){const t=s.indexOf("$");return $(t!==-1&&t<s.length-1,"Bad queryKey."),{queryId:s.substr(t+1),path:new Pe(s.substr(0,t))}}function eu(s,t,r){const o=s.syncPointTree_.get(t);$(o,"Missing sync point for query tag that we're tracking");const a=Yc(s.pendingWriteTree_,t);return qc(o,r,a,null)}function o1(s){return s.fold((t,r,o)=>{if(r&&Jn(r))return[Zo(r)];{let a=[];return r&&(a=vm(r)),At(o,(u,h)=>{a=a.concat(h)}),a}})}function ti(s){return s._queryParams.loadsAllData()&&!s._queryParams.isDefault()?new(Zy())(s._repo,s._path):s}function l1(s,t){for(let r=0;r<t.length;++r){const o=t[r];if(!o._queryParams.loadsAllData()){const a=tl(o),u=s.queryToTagMap.get(a);s.queryToTagMap.delete(a),s.tagToQueryMap.delete(u)}}}function a1(){return e1++}function c1(s,t,r){const o=t._path,a=Qo(s,t),u=km(s,r),h=s.listenProvider_.startListening(ti(t),a,u.hashFn,u.onComplete),p=s.syncPointTree_.subtree(o);if(a)$(!Jn(p.value),"If we're adding a query, it shouldn't be shadowed");else{const g=p.fold((v,S,y)=>{if(!xe(v)&&S&&Jn(S))return[Zo(S).query];{let x=[];return S&&(x=x.concat(vm(S).map(R=>R.query))),At(y,(R,P)=>{x=x.concat(P)}),x}});for(let v=0;v<g.length;++v){const S=g[v];s.listenProvider_.stopListening(ti(S),Qo(s,S))}}return h}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(t){this.node_=t}getImmediateChild(t){const r=this.node_.getImmediateChild(t);return new tu(r)}node(){return this.node_}}class nu{constructor(t,r){this.syncTree_=t,this.path_=r}getImmediateChild(t){const r=lt(this.path_,t);return new nu(this.syncTree_,r)}node(){return Xc(this.syncTree_,this.path_)}}const u1=function(s){return s=s||{},s.timestamp=s.timestamp||new Date().getTime(),s},rp=function(s,t,r){if(!s||typeof s!="object")return s;if($(".sv"in s,"Unexpected leaf node or priority contents"),typeof s[".sv"]=="string")return d1(s[".sv"],t,r);if(typeof s[".sv"]=="object")return f1(s[".sv"],t);$(!1,"Unexpected server value: "+JSON.stringify(s,null,2))},d1=function(s,t,r){switch(s){case"timestamp":return r.timestamp;default:$(!1,"Unexpected server value: "+s)}},f1=function(s,t,r){s.hasOwnProperty("increment")||$(!1,"Unexpected server value: "+JSON.stringify(s,null,2));const o=s.increment;typeof o!="number"&&$(!1,"Unexpected increment value: "+o);const a=t.node();if($(a!==null&&typeof a<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!a.isLeafNode())return o;const h=a.getValue();return typeof h!="number"?o:h+o},h1=function(s,t,r,o){return ru(t,new nu(r,s),o)},Nm=function(s,t,r){return ru(s,new tu(t),r)};function ru(s,t,r){const o=s.getPriority().val(),a=rp(o,t.getImmediateChild(".priority"),r);let u;if(s.isLeafNode()){const h=s,p=rp(h.getValue(),t,r);return p!==h.getValue()||a!==h.getPriority().val()?new dt(p,vt(a)):s}else{const h=s;return u=h,a!==h.getPriority().val()&&(u=u.updatePriority(new dt(a))),h.forEachChild(Ge,(p,g)=>{const v=ru(g,t.getImmediateChild(p),r);v!==g&&(u=u.updateImmediateChild(p,v))}),u}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(t="",r=null,o={children:{},childCount:0}){this.name=t,this.parent=r,this.node=o}}function iu(s,t){let r=t instanceof Pe?t:new Pe(t),o=s,a=me(r);for(;a!==null;){const u=ts(o.node.children,a)||{children:{},childCount:0};o=new su(a,o,u),r=Ae(r),a=me(r)}return o}function as(s){return s.node.value}function Sm(s,t){s.node.value=t,Ec(s)}function Em(s){return s.node.childCount>0}function p1(s){return as(s)===void 0&&!Em(s)}function nl(s,t){At(s.node.children,(r,o)=>{t(new su(r,s,o))})}function bm(s,t,r,o){r&&t(s),nl(s,a=>{bm(a,t,!0)})}function m1(s,t,r){let o=s.parent;for(;o!==null;){if(t(o))return!0;o=o.parent}return!1}function xi(s){return new Pe(s.parent===null?s.name:xi(s.parent)+"/"+s.name)}function Ec(s){s.parent!==null&&g1(s.parent,s.name,s)}function g1(s,t,r){const o=p1(r),a=bn(s.node.children,t);o&&a?(delete s.node.children[t],s.node.childCount--,Ec(s)):!o&&!a&&(s.node.children[t]=r.node,s.node.childCount++,Ec(s))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v1=/[\[\].#$\/\u0000-\u001F\u007F]/,x1=/[\[\].#$\u0000-\u001F\u007F]/,lc=10*1024*1024,Im=function(s){return typeof s=="string"&&s.length!==0&&!v1.test(s)},Tm=function(s){return typeof s=="string"&&s.length!==0&&!x1.test(s)},_1=function(s){return s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),Tm(s)},y1=function(s,t,r,o){ou(Dc(s,"value"),t,r)},ou=function(s,t,r){const o=r instanceof Pe?new O_(r,s):r;if(t===void 0)throw new Error(s+"contains undefined "+vr(o));if(typeof t=="function")throw new Error(s+"contains a function "+vr(o)+" with contents = "+t.toString());if(Tp(t))throw new Error(s+"contains "+t.toString()+" "+vr(o));if(typeof t=="string"&&t.length>lc/3&&qo(t)>lc)throw new Error(s+"contains a string greater than "+lc+" utf8 bytes "+vr(o)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let a=!1,u=!1;if(At(t,(h,p)=>{if(h===".value")a=!0;else if(h!==".priority"&&h!==".sv"&&(u=!0,!Im(h)))throw new Error(s+" contains an invalid key ("+h+") "+vr(o)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);F_(o,h),ou(s,p,o),z_(o)}),a&&u)throw new Error(s+' contains ".value" child '+vr(o)+" in addition to actual children.")}},jm=function(s,t,r,o){if(!Tm(r))throw new Error(Dc(s,t)+'was an invalid path = "'+r+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},w1=function(s,t,r,o){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),jm(s,t,r)},C1=function(s,t){if(me(t)===".info")throw new Error(s+" failed = Can't modify data under /.info/")},k1=function(s,t){const r=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!Im(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||r.length!==0&&!_1(r))throw new Error(Dc(s,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function lu(s,t){let r=null;for(let o=0;o<t.length;o++){const a=t[o],u=a.getPath();r!==null&&!zc(u,r.path)&&(s.eventLists_.push(r),r=null),r===null&&(r={events:[],path:u}),r.events.push(a)}r&&s.eventLists_.push(r)}function Rm(s,t,r){lu(s,r),Pm(s,o=>zc(o,t))}function En(s,t,r){lu(s,r),Pm(s,o=>rn(o,t)||rn(t,o))}function Pm(s,t){s.recursionDepth_++;let r=!0;for(let o=0;o<s.eventLists_.length;o++){const a=s.eventLists_[o];if(a){const u=a.path;t(u)?(S1(s.eventLists_[o]),s.eventLists_[o]=null):r=!1}}r&&(s.eventLists_=[]),s.recursionDepth_--}function S1(s){for(let t=0;t<s.events.length;t++){const r=s.events[t];if(r!==null){s.events[t]=null;const o=r.getEventRunner();Xs&&kt("event: "+r.toString()),ls(o)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1="repo_interrupt",b1=25;class I1{constructor(t,r,o,a){this.repoInfo_=t,this.forceRestClient_=r,this.authTokenProvider_=o,this.appCheckProvider_=a,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new N1,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Uo(),this.transactionQueueTree_=new su,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function T1(s,t,r){if(s.stats_=Oc(s.repoInfo_),s.forceRestClient_||a_())s.server_=new zo(s.repoInfo_,(o,a,u,h)=>{sp(s,o,a,u,h)},s.authTokenProvider_,s.appCheckProvider_),setTimeout(()=>ip(s,!0),0);else{if(typeof r<"u"&&r!==null){if(typeof r!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ht(r)}catch(o){throw new Error("Invalid authOverride provided: "+o)}}s.persistentConnection_=new kn(s.repoInfo_,t,(o,a,u,h)=>{sp(s,o,a,u,h)},o=>{ip(s,o)},o=>{R1(s,o)},s.authTokenProvider_,s.appCheckProvider_,r),s.server_=s.persistentConnection_}s.authTokenProvider_.addTokenChangeListener(o=>{s.server_.refreshAuthToken(o)}),s.appCheckProvider_.addTokenChangeListener(o=>{s.server_.refreshAppCheckToken(o.token)}),s.statsReporter_=h_(s.repoInfo_,()=>new dy(s.stats_,s.server_)),s.infoData_=new oy,s.infoSyncTree_=new tp({startListening:(o,a,u,h)=>{let p=[];const g=s.infoData_.getNode(o._path);return g.isEmpty()||(p=el(s.infoSyncTree_,o._path,g),setTimeout(()=>{h("ok")},0)),p},stopListening:()=>{}}),cu(s,"connected",!1),s.serverSyncTree_=new tp({startListening:(o,a,u,h)=>(s.server_.listen(o,u,a,(p,g)=>{const v=h(p,g);En(s.eventQueue_,o._path,v)}),[]),stopListening:(o,a)=>{s.server_.unlisten(o,a)}})}function j1(s){const r=s.infoData_.getNode(new Pe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+r}function au(s){return u1({timestamp:j1(s)})}function sp(s,t,r,o,a){s.dataUpdateCount++;const u=new Pe(t);r=s.interceptServerDataCallback_?s.interceptServerDataCallback_(t,r):r;let h=[];if(a)if(o){const g=Po(r,v=>vt(v));h=i1(s.serverSyncTree_,u,g,a)}else{const g=vt(r);h=s1(s.serverSyncTree_,u,g,a)}else if(o){const g=Po(r,v=>vt(v));h=t1(s.serverSyncTree_,u,g)}else{const g=vt(r);h=el(s.serverSyncTree_,u,g)}let p=u;h.length>0&&(p=rl(s,u)),En(s.eventQueue_,p,h)}function ip(s,t){cu(s,"connected",t),t===!1&&D1(s)}function R1(s,t){At(t,(r,o)=>{cu(s,r,o)})}function cu(s,t,r){const o=new Pe("/.info/"+t),a=vt(r);s.infoData_.updateSnapshot(o,a);const u=el(s.infoSyncTree_,o,a);En(s.eventQueue_,o,u)}function Dm(s){return s.nextWriteId_++}function P1(s,t,r,o,a){uu(s,"set",{path:t.toString(),value:r,priority:o});const u=au(s),h=vt(r,o),p=Xc(s.serverSyncTree_,t),g=Nm(h,p,u),v=Dm(s),S=ym(s.serverSyncTree_,t,g,v,!0);lu(s.eventQueue_,S),s.server_.put(t.toString(),h.val(!0),(x,R)=>{const P=x==="ok";P||Mt("set at "+t+" failed: "+x);const B=_r(s.serverSyncTree_,v,!P);En(s.eventQueue_,t,B),A1(s,a,x,R)});const y=Fm(s,t);rl(s,y),En(s.eventQueue_,y,[])}function D1(s){uu(s,"onDisconnectEvents");const t=au(s),r=Uo();_c(s.onDisconnect_,Ie(),(a,u)=>{const h=h1(a,u,s.serverSyncTree_,t);om(r,a,h)});let o=[];_c(r,Ie(),(a,u)=>{o=o.concat(el(s.serverSyncTree_,a,u));const h=Fm(s,a);rl(s,h)}),s.onDisconnect_=Uo(),En(s.eventQueue_,Ie(),o)}function L1(s,t,r){let o;me(t._path)===".info"?o=np(s.infoSyncTree_,t,r):o=np(s.serverSyncTree_,t,r),Rm(s.eventQueue_,t._path,o)}function op(s,t,r){let o;me(t._path)===".info"?o=Sc(s.infoSyncTree_,t,r):o=Sc(s.serverSyncTree_,t,r),Rm(s.eventQueue_,t._path,o)}function M1(s){s.persistentConnection_&&s.persistentConnection_.interrupt(E1)}function uu(s,...t){let r="";s.persistentConnection_&&(r=s.persistentConnection_.id+":"),kt(r,...t)}function A1(s,t,r,o){t&&ls(()=>{if(r==="ok")t(null);else{const a=(r||"error").toUpperCase();let u=a;o&&(u+=": "+o);const h=new Error(u);h.code=a,t(h)}})}function Lm(s,t,r){return Xc(s.serverSyncTree_,t,r)||ae.EMPTY_NODE}function du(s,t=s.transactionQueueTree_){if(t||sl(s,t),as(t)){const r=Am(s,t);$(r.length>0,"Sending zero length transaction queue"),r.every(a=>a.status===0)&&O1(s,xi(t),r)}else Em(t)&&nl(t,r=>{du(s,r)})}function O1(s,t,r){const o=r.map(v=>v.currentWriteId),a=Lm(s,t,o);let u=a;const h=a.hash();for(let v=0;v<r.length;v++){const S=r[v];$(S.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),S.status=1,S.retryCount++;const y=Dt(t,S.path);u=u.updateChild(y,S.currentOutputSnapshotRaw)}const p=u.val(!0),g=t;s.server_.put(g.toString(),p,v=>{uu(s,"transaction put response",{path:g.toString(),status:v});let S=[];if(v==="ok"){const y=[];for(let x=0;x<r.length;x++)r[x].status=2,S=S.concat(_r(s.serverSyncTree_,r[x].currentWriteId)),r[x].onComplete&&y.push(()=>r[x].onComplete(null,!0,r[x].currentOutputSnapshotResolved)),r[x].unwatcher();sl(s,iu(s.transactionQueueTree_,t)),du(s,s.transactionQueueTree_),En(s.eventQueue_,t,S);for(let x=0;x<y.length;x++)ls(y[x])}else{if(v==="datastale")for(let y=0;y<r.length;y++)r[y].status===3?r[y].status=4:r[y].status=0;else{Mt("transaction at "+g.toString()+" failed: "+v);for(let y=0;y<r.length;y++)r[y].status=4,r[y].abortReason=v}rl(s,t)}},h)}function rl(s,t){const r=Mm(s,t),o=xi(r),a=Am(s,r);return F1(s,a,o),o}function F1(s,t,r){if(t.length===0)return;const o=[];let a=[];const h=t.filter(p=>p.status===0).map(p=>p.currentWriteId);for(let p=0;p<t.length;p++){const g=t[p],v=Dt(r,g.path);let S=!1,y;if($(v!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),g.status===4)S=!0,y=g.abortReason,a=a.concat(_r(s.serverSyncTree_,g.currentWriteId,!0));else if(g.status===0)if(g.retryCount>=b1)S=!0,y="maxretry",a=a.concat(_r(s.serverSyncTree_,g.currentWriteId,!0));else{const x=Lm(s,g.path,h);g.currentInputSnapshot=x;const R=t[p].update(x.val());if(R!==void 0){ou("transaction failed: Data returned ",R,g.path);let P=vt(R);typeof R=="object"&&R!=null&&bn(R,".priority")||(P=P.updatePriority(x.getPriority()));const Q=g.currentWriteId,te=au(s),ie=Nm(P,x,te);g.currentOutputSnapshotRaw=P,g.currentOutputSnapshotResolved=ie,g.currentWriteId=Dm(s),h.splice(h.indexOf(Q),1),a=a.concat(ym(s.serverSyncTree_,g.path,ie,g.currentWriteId,g.applyLocally)),a=a.concat(_r(s.serverSyncTree_,Q,!0))}else S=!0,y="nodata",a=a.concat(_r(s.serverSyncTree_,g.currentWriteId,!0))}En(s.eventQueue_,r,a),a=[],S&&(t[p].status=2,(function(x){setTimeout(x,Math.floor(0))})(t[p].unwatcher),t[p].onComplete&&(y==="nodata"?o.push(()=>t[p].onComplete(null,!1,t[p].currentInputSnapshot)):o.push(()=>t[p].onComplete(new Error(y),!1,null))))}sl(s,s.transactionQueueTree_);for(let p=0;p<o.length;p++)ls(o[p]);du(s,s.transactionQueueTree_)}function Mm(s,t){let r,o=s.transactionQueueTree_;for(r=me(t);r!==null&&as(o)===void 0;)o=iu(o,r),t=Ae(t),r=me(t);return o}function Am(s,t){const r=[];return Om(s,t,r),r.sort((o,a)=>o.order-a.order),r}function Om(s,t,r){const o=as(t);if(o)for(let a=0;a<o.length;a++)r.push(o[a]);nl(t,a=>{Om(s,a,r)})}function sl(s,t){const r=as(t);if(r){let o=0;for(let a=0;a<r.length;a++)r[a].status!==2&&(r[o]=r[a],o++);r.length=o,Sm(t,r.length>0?r:void 0)}nl(t,o=>{sl(s,o)})}function Fm(s,t){const r=xi(Mm(s,t)),o=iu(s.transactionQueueTree_,t);return m1(o,a=>{ac(s,a)}),ac(s,o),bm(o,a=>{ac(s,a)}),r}function ac(s,t){const r=as(t);if(r){const o=[];let a=[],u=-1;for(let h=0;h<r.length;h++)r[h].status===3||(r[h].status===1?($(u===h-1,"All SENT items should be at beginning of queue."),u=h,r[h].status=3,r[h].abortReason="set"):($(r[h].status===0,"Unexpected transaction status in abort"),r[h].unwatcher(),a=a.concat(_r(s.serverSyncTree_,r[h].currentWriteId,!0)),r[h].onComplete&&o.push(r[h].onComplete.bind(null,new Error("set"),!1,null))));u===-1?Sm(t,void 0):r.length=u+1,En(s.eventQueue_,xi(t),a);for(let h=0;h<o.length;h++)ls(o[h])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1(s){let t="";const r=s.split("/");for(let o=0;o<r.length;o++)if(r[o].length>0){let a=r[o];try{a=decodeURIComponent(a.replace(/\+/g," "))}catch{}t+="/"+a}return t}function U1(s){const t={};s.charAt(0)==="?"&&(s=s.substring(1));for(const r of s.split("&")){if(r.length===0)continue;const o=r.split("=");o.length===2?t[decodeURIComponent(o[0])]=decodeURIComponent(o[1]):Mt(`Invalid query segment '${r}' in query '${s}'`)}return t}const lp=function(s,t){const r=B1(s),o=r.namespace;r.domain==="firebase.com"&&Sn(r.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!o||o==="undefined")&&r.domain!=="localhost"&&Sn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r.secure||Zx();const a=r.scheme==="ws"||r.scheme==="wss";return{repoInfo:new Bp(r.host,r.secure,o,a,t,"",o!==r.subdomain),path:new Pe(r.pathString)}},B1=function(s){let t="",r="",o="",a="",u="",h=!0,p="https",g=443;if(typeof s=="string"){let v=s.indexOf("//");v>=0&&(p=s.substring(0,v-1),s=s.substring(v+2));let S=s.indexOf("/");S===-1&&(S=s.length);let y=s.indexOf("?");y===-1&&(y=s.length),t=s.substring(0,Math.min(S,y)),S<y&&(a=z1(s.substring(S,y)));const x=U1(s.substring(Math.min(s.length,y)));v=t.indexOf(":"),v>=0?(h=p==="https"||p==="wss",g=parseInt(t.substring(v+1),10)):v=t.length;const R=t.slice(0,v);if(R.toLowerCase()==="localhost")r="localhost";else if(R.split(".").length<=2)r=R;else{const P=t.indexOf(".");o=t.substring(0,P).toLowerCase(),r=t.substring(P+1),u=o}"ns"in x&&(u=x.ns)}return{host:t,port:g,domain:r,subdomain:o,secure:h,scheme:p,pathString:a,namespace:u}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(t,r,o,a){this.eventType=t,this.eventRegistration=r,this.snapshot=o,this.prevName=a}getPath(){const t=this.snapshot.ref;return this.eventType==="value"?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ht(this.snapshot.exportVal())}}class W1{constructor(t,r,o){this.eventRegistration=t,this.error=r,this.path=o}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H1{constructor(t,r){this.snapshotCallback=t,this.cancelCallback=r}onValue(t,r){this.snapshotCallback.call(null,t,r)}onCancel(t){return $(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(t,r,o,a){this._repo=t,this._path=r,this._queryParams=o,this._orderByCalled=a}get key(){return xe(this._path)?null:qp(this._path)}get ref(){return new Zn(this._repo,this._path)}get _queryIdentifier(){const t=Hh(this._queryParams),r=Mc(t);return r==="{}"?"default":r}get _queryObject(){return Hh(this._queryParams)}isEqual(t){if(t=hi(t),!(t instanceof fu))return!1;const r=this._repo===t._repo,o=zc(this._path,t._path),a=this._queryIdentifier===t._queryIdentifier;return r&&o&&a}toJSON(){return this.toString()}toString(){return this._repo.toString()+A_(this._path)}}class Zn extends fu{constructor(t,r){super(t,r,new Wc,!1)}get parent(){const t=Jp(this._path);return t===null?null:new Zn(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}}class Go{constructor(t,r,o){this._node=t,this.ref=r,this._index=o}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const r=new Pe(t),o=bc(this.ref,t);return new Go(this._node.getChild(r),o,Ge)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(o,a)=>t(new Go(a,bc(this.ref,o),Ge)))}hasChild(t){const r=new Pe(t);return!this._node.getChild(r).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function zm(s,t){return s=hi(s),s._checkNotDeleted("ref"),t!==void 0?bc(s._root,t):s._root}function bc(s,t){return s=hi(s),me(s._path)===null?w1("child","path",t):jm("child","path",t),new Zn(s._repo,lt(s._path,t))}function V1(s,t){s=hi(s),C1("set",s._path),y1("set",t,s._path);const r=new Ko;return P1(s._repo,s._path,t,null,r.wrapCallback(()=>{})),r.promise}class hu{constructor(t){this.callbackContext=t}respondsTo(t){return t==="value"}createEvent(t,r){const o=r._queryParams.getIndex();return new $1("value",this,new Go(t.snapshotNode,new Zn(r._repo,r._path),o))}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,r){return this.callbackContext.hasCancelCallback?new W1(this,t,r):null}matches(t){return t instanceof hu?!t.callbackContext||!this.callbackContext?!0:t.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function Y1(s,t,r,o,a){let u;if(typeof o=="object"&&(u=void 0,a=o),typeof o=="function"&&(u=o),a&&a.onlyOnce){const g=r,v=(S,y)=>{op(s._repo,s,p),g(S,y)};v.userCallback=r.userCallback,v.context=r.context,r=v}const h=new H1(r,u||void 0),p=new hu(h);return L1(s._repo,s,p),()=>op(s._repo,s,p)}function Q1(s,t,r,o){return Y1(s,"value",t,r,o)}Yy(Zn);Jy(Zn);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G1="FIREBASE_DATABASE_EMULATOR_HOST",Ic={};let K1=!1;function q1(s,t,r,o){const a=t.lastIndexOf(":"),u=t.substring(0,a),h=Pc(u);s.repoInfo_=new Bp(t,h,s.repoInfo_.namespace,s.repoInfo_.webSocketOnly,s.repoInfo_.nodeAdmin,s.repoInfo_.persistenceKey,s.repoInfo_.includeNamespaceInQueryParams,!0,r),o&&(s.authTokenProvider_=o)}function X1(s,t,r,o,a){let u=o||s.options.databaseURL;u===void 0&&(s.options.projectId||Sn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),kt("Using default host for project ",s.options.projectId),u=`${s.options.projectId}-default-rtdb.firebaseio.com`);let h=lp(u,a),p=h.repoInfo,g;typeof process<"u"&&Eh&&(g=Eh[G1]),g?(u=`http://${g}?ns=${p.namespace}`,h=lp(u,a),p=h.repoInfo):h.repoInfo.secure;const v=new u_(s.name,s.options,t);k1("Invalid Firebase Database URL",h),xe(h.path)||Sn("Database URL must point to the root of a Firebase Database (not including a child path).");const S=Z1(p,s,v,new c_(s,r));return new ew(S,s)}function J1(s,t){const r=Ic[t];(!r||r[s.key]!==s)&&Sn(`Database ${t}(${s.repoInfo_}) has already been deleted.`),M1(s),delete r[s.key]}function Z1(s,t,r,o){let a=Ic[t.name];a||(a={},Ic[t.name]=a);let u=a[s.toURLString()];return u&&Sn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),u=new I1(s,K1,r,o),a[s.toURLString()]=u,u}class ew{constructor(t,r){this._repoInternal=t,this.app=r,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(T1(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Zn(this._repo,Ie())),this._rootInternal}_delete(){return this._rootInternal!==null&&(J1(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&Sn("Cannot call "+t+" on a deleted database.")}}function tw(s=Lx(),t){const r=Tx(s,"database").getImmediate({identifier:t});if(!r._instanceStarted){const o=pv("database");o&&nw(r,...o)}return r}function nw(s,t,r,o={}){s=hi(s),s._checkNotDeleted("useEmulator");const a=`${t}:${r}`,u=s._repoInternal;if(s._instanceStarted){if(a===s._repoInternal.repoInfo_.host&&Do(o,u.repoInfo_.emulatorOptions))return;Sn("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let h;if(u.repoInfo_.nodeAdmin)o.mockUserToken&&Sn('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),h=new jo(jo.OWNER);else if(o.mockUserToken){const p=typeof o.mockUserToken=="string"?o.mockUserToken:gv(o.mockUserToken,s.app.options.projectId);h=new jo(p)}Pc(t)&&(mv(t),_v("Database",!0)),q1(u,a,o,h)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rw(s){Qx(Dx),Mo(new ri("database",(t,{instanceIdentifier:r})=>{const o=t.getProvider("app").getImmediate(),a=t.getProvider("auth-internal"),u=t.getProvider("app-check-internal");return X1(o,a,u,r)},"PUBLIC").setMultipleInstances(!0)),Xr(bh,Ih,s),Xr(bh,Ih,"esm2020")}kn.prototype.simpleListen=function(s,t){this.sendRequest("q",{p:s},t)};kn.prototype.echo=function(s,t){this.sendRequest("echo",{d:s},t)};rw();const sw={apiKey:"AIzaSyCIA80U-Nb235O5SG_2d1TzdylvYQrzNUc",authDomain:"razlom-db061.firebaseapp.com",projectId:"razlom-db061",storageBucket:"razlom-db061.firebasestorage.app",messagingSenderId:"343432819418",appId:"1:343432819418:web:73f0fedc8a5e5a32912be3",measurementId:"G-EPLQFH5LMJ",databaseURL:"https://razlom-db061-default-rtdb.firebaseio.com"};let ap,di;try{ap=kp(sw),di=tw(ap),console.log("Firebase initialized successfully (RTDB only)")}catch(s){console.error("Firebase init error:",s)}const iw=(s,t)=>{if(!di)return console.warn("Database not initialized, cannot subscribe"),()=>{};const r=zm(di,`rooms/${s}`);return Q1(r,a=>{const u=a.val();u&&t(u)},a=>{console.error("Firebase read error:",a)})},ow=async(s,t)=>{if(!di){console.warn("Database not initialized, cannot save");return}const r=zm(di,`rooms/${s}`);try{await V1(r,t)}catch(o){console.error("Firebase write error:",o)}},cp="rp_haven_master_data_v3",cc="global_chronicles_main",lw=()=>{const[s,t]=V.useState("characters"),[r,o]=V.useState(null),[a,u]=V.useState(""),[h,p]=V.useState({}),[g,v]=V.useState(!1),[S,y]=V.useState(!1),[x,R]=V.useState(null),[P,B]=V.useState(!1),[Q,te]=V.useState(!1),[ie,_e]=V.useState(!0),[A,$e]=V.useState(()=>{const w=localStorage.getItem(cp);if(w)try{const T=JSON.parse(w);return{characters:T.characters||hh,worlds:T.worlds||[],notes:T.notes||[],availableTags:T.availableTags||dh,availableHiddenTags:T.availableHiddenTags||fh,rpSessions:T.rpSessions||[]}}catch(T){console.error("Failed to parse storage",T)}return{characters:hh,worlds:[],notes:[],availableTags:dh,availableHiddenTags:fh,rpSessions:[]}});V.useEffect(()=>{if(ie){console.log(`Subscribing to global room: ${cc}`);const w=iw(cc,T=>{console.log("Received update from cloud"),T&&$e({characters:T.characters||[],worlds:T.worlds||[],notes:T.notes||[],availableTags:T.availableTags||[],availableHiddenTags:T.availableHiddenTags||[],rpSessions:T.rpSessions||[]})});return()=>w()}},[ie]);const H=w=>{$e(w),B(!0),setTimeout(()=>B(!1),2e3),ie&&ow(cc,w);try{const T=JSON.parse(JSON.stringify(w));T.characters.forEach(L=>{L.imageUrl&&L.imageUrl.startsWith("data:")&&(L.imageUrl="")}),T.worlds.forEach(L=>{L.imageUrl&&L.imageUrl.startsWith("data:")&&(L.imageUrl="")}),localStorage.setItem(cp,JSON.stringify(T))}catch(T){console.warn("Local storage quota exceeded even with stripped images.",T)}},z=()=>{_e(!0)},oe=()=>{_e(!1)},ye=V.useMemo(()=>A.characters.filter(w=>{const T=w.name.toLowerCase().includes(a.toLowerCase()),L=Object.entries(h).every(([K,ue])=>{var In,Gt;const ke=(In=w.tags)==null?void 0:In.includes(K),we=(Gt=w.hiddenTags)==null?void 0:Gt.includes(K),et=ke||we;return ue==="include"?et:ue==="exclude"?!et:!0});return T&&L}),[a,h,A.characters]),he=w=>{p(T=>{const L=T[w]||"none";let K="none";L==="none"?K="include":L==="include"?K="exclude":K="none";const ue={...T};return K==="none"?delete ue[w]:ue[w]=K,ue})},Ue=V.useMemo(()=>A.characters.find(w=>w.id===r),[r,A.characters]),Re=w=>{const T=A.characters.some(L=>L.id===w.id)?A.characters.map(L=>L.id===w.id?w:L):[...A.characters,w];H({...A,characters:T}),y(!1),R(null)},We=w=>H({...A,worlds:w}),Ke=w=>H({...A,notes:w}),pt=w=>H({...A,availableTags:w}),Ze=w=>H({...A,availableHiddenTags:w}),Te=w=>H({...A,rpSessions:w}),W=w=>{if(window.confirm("    ?")){const T=A.characters.filter(L=>L.id!==w);H({...A,characters:T}),r===w&&o(null)}},Z=()=>{const w=new Blob([JSON.stringify(A,null,2)],{type:"application/json"}),T=URL.createObjectURL(w),L=document.createElement("a");L.href=T,L.download=`rp-vault-${new Date().toISOString().slice(0,10)}.json`,L.click(),URL.revokeObjectURL(T)},C=w=>{try{const T=JSON.parse(w);if(!window.confirm("!      . ?"))return;const L={characters:T.characters||[],worlds:T.worlds||[],notes:T.notes||[],availableTags:T.availableTags||[],availableHiddenTags:T.availableHiddenTags||[],rpSessions:T.rpSessions||[]};o(null),R(null),y(!1),H(L)}catch{alert(":      .")}},D=Object.keys(h).length;return f.jsxs(Yg,{activeTab:s,setActiveTab:w=>{t(w),o(null),w!=="characters"&&w!=="connections"&&p({})},isAdmin:g,onToggleAdmin:()=>v(!g),onOpenSync:()=>te(!0),isSyncActive:ie,onDownloadDB:Z,onUploadDB:C,children:[f.jsx("div",{className:`fixed top-20 md:top-6 right-6 z-[90] transition-all duration-500 pointer-events-none ${P?"opacity-100 translate-y-0":"opacity-0 -translate-y-4"}`,children:f.jsxs("div",{className:"bg-emerald-950/80 border border-emerald-500/30 backdrop-blur-2xl px-5 py-2.5 rounded-2xl flex items-center gap-3 shadow-2xl",children:[f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:`w-2 h-2 rounded-full ${ie?"bg-emerald-500":"bg-stone-500"}`}),ie&&f.jsx("div",{className:"absolute inset-0 w-2 h-2 bg-emerald-500 rounded-full animate-ping"})]}),f.jsx("span",{className:`text-[10px] uppercase tracking-[0.2em] font-black ${ie?"text-emerald-400":"text-stone-400"}`,children:ie?" : Online":" "})]})}),Q&&f.jsx(rv,{isConnected:ie,onConnect:z,onDisconnect:oe,onClose:()=>te(!1)}),f.jsxs("div",{className:"animate-tab-switch",children:[s==="characters"&&f.jsx("div",{className:"relative",children:r?f.jsx("div",{className:"animate-reveal-details",children:Ue&&f.jsx(Gg,{character:Ue,isAdmin:g,allCharacters:A.characters,availableTags:A.availableTags,availableHiddenTags:A.availableHiddenTags,onBack:()=>o(null),onSave:Re,onSelectCharacter:o})},`details-${r}`):f.jsxs("div",{className:"animate-reveal-list space-y-8",children:[f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 sm:gap-6",children:[f.jsxs("div",{className:"relative flex-grow w-full",children:[f.jsx("input",{type:"text",placeholder:"  ...",value:a,onChange:w=>u(w.target.value),className:"w-full bg-transparent border-none text-stone-300 placeholder-stone-800 focus:ring-0 text-2xl md:text-3xl outline-none font-serif italic py-2 md:py-4"}),f.jsx("div",{className:"h-px w-full bg-gradient-to-r from-stone-900 via-emerald-900/30 to-stone-900"})]}),g&&f.jsx("button",{onClick:()=>{R(null),y(!0)},className:"w-full sm:w-auto whitespace-nowrap bg-white hover:bg-emerald-50 text-black px-6 md:px-8 py-3.5 rounded-full text-[10px] uppercase tracking-widest font-black transition-all shadow-xl flex items-center justify-center gap-2",children:" "})]}),(A.availableTags.length>0||A.availableHiddenTags.length>0)&&f.jsxs("div",{className:"flex flex-wrap items-center gap-2 py-2 animate-in fade-in slide-in-from-top-4 duration-500",children:[f.jsx("span",{className:"text-[9px] uppercase tracking-[0.2em] font-black text-stone-600 mr-2 w-full sm:w-auto mb-2 sm:mb-0",children:"  :"}),A.availableTags.map(w=>{const T=h[w]||"none";return f.jsxs("button",{onClick:()=>he(w),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${T==="include"?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":T==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-stone-400 hover:border-stone-700"}`,children:[T==="include"&&f.jsx("span",{className:"text-emerald-500",children:"+"}),T==="exclude"&&f.jsx("span",{className:"text-red-500",children:""}),w]},w)}),A.availableTags.length>0&&A.availableHiddenTags.length>0&&f.jsx("div",{className:"w-px h-6 bg-stone-900 mx-2"}),A.availableHiddenTags.map(w=>{const T=h[w]||"none";return f.jsxs("button",{onClick:()=>he(w),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${T==="include"?"bg-amber-500/10 border-amber-500/40 text-amber-400 shadow-[0_0_15px_rgba(245,158,11,0.1)]":T==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-amber-500/80 hover:border-amber-900/30"}`,children:[T==="include"&&f.jsx("span",{className:"text-amber-500",children:"+"}),T==="exclude"&&f.jsx("span",{className:"text-red-500",children:""}),w]},w)}),D>0&&f.jsx("button",{onClick:()=>p({}),className:"ml-2 text-[9px] uppercase tracking-[0.2em] font-black text-stone-700 hover:text-red-500 transition-colors",children:" "})]})]}),ye.length>0?f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 md:gap-10",children:ye.map(w=>f.jsx(Qg,{character:w,onClick:o},w.id))}):f.jsxs("div",{className:"py-20 text-center space-y-4",children:[f.jsx("p",{className:"text-stone-700 italic font-serif text-xl",children:"      ..."}),f.jsx("button",{onClick:()=>{u(""),p({})},className:"text-emerald-500/50 hover:text-emerald-500 text-[10px] uppercase tracking-[0.2em] font-black transition-all",children:" "})]})]},"character-list")}),s==="connections"&&f.jsx(Zg,{characters:A.characters,availableTags:A.availableTags,availableHiddenTags:A.availableHiddenTags,filterStates:h,onToggleTag:he,onClearFilters:()=>p({}),onSelectCharacter:w=>{o(w),t("characters")}}),s==="worlds"&&f.jsx(ev,{worlds:A.worlds,onUpdate:We,isAdmin:g}),s==="notes"&&f.jsx(tv,{notes:A.notes,onUpdate:Ke,isAdmin:g}),s==="roleplay"&&f.jsx(nv,{sessions:A.rpSessions,characters:A.characters,onUpdate:Te,isAdmin:g}),s==="admin"&&g&&f.jsx(qg,{characters:A.characters,availableTags:A.availableTags,availableHiddenTags:A.availableHiddenTags,onDelete:W,onEdit:w=>{R(w),y(!0)},onAdd:()=>{R(null),y(!0)},onUpdateTags:pt,onUpdateHiddenTags:Ze,onDownloadDB:Z,onUploadDB:C})]},s),S&&f.jsx(Kg,{initialData:x,availableTags:A.availableTags,availableHiddenTags:A.availableHiddenTags,onSave:Re,onClose:()=>{y(!1),R(null)}})]})},Um=document.getElementById("root");if(!Um)throw new Error("Could not find root element to mount to");const aw=Vg.createRoot(Um);aw.render(f.jsx(Fg.StrictMode,{children:f.jsx(lw,{})}));
