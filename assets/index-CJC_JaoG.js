(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function r(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(c){if(c.ep)return;c.ep=!0;const d=r(c);fetch(c.href,d)}})();function _p(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var rc={exports:{}},Js={},sc={exports:{}},ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uf;function Yg(){if(uf)return ze;uf=1;var s=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),f=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),y=Symbol.iterator;function v(w){return w===null||typeof w!="object"?null:(w=y&&w[y]||w["@@iterator"],typeof w=="function"?w:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D=Object.assign,B={};function ne(w,$,te){this.props=w,this.context=$,this.refs=B,this.updater=te||k}ne.prototype.isReactComponent={},ne.prototype.setState=function(w,$){if(typeof w!="object"&&typeof w!="function"&&w!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,w,$,"setState")},ne.prototype.forceUpdate=function(w){this.updater.enqueueForceUpdate(this,w,"forceUpdate")};function ce(){}ce.prototype=ne.prototype;function ie(w,$,te){this.props=w,this.context=$,this.refs=B,this.updater=te||k}var ke=ie.prototype=new ce;ke.constructor=ie,D(ke,ne.prototype),ke.isPureReactComponent=!0;var le=Array.isArray,Oe=Object.prototype.hasOwnProperty,K={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function L(w,$,te){var he,O={},A=null,U=null;if($!=null)for(he in $.ref!==void 0&&(U=$.ref),$.key!==void 0&&(A=""+$.key),$)Oe.call($,he)&&!M.hasOwnProperty(he)&&(O[he]=$[he]);var we=arguments.length-2;if(we===1)O.children=te;else if(1<we){for(var Se=Array(we),qe=0;qe<we;qe++)Se[qe]=arguments[qe+2];O.children=Se}if(w&&w.defaultProps)for(he in we=w.defaultProps,we)O[he]===void 0&&(O[he]=we[he]);return{$$typeof:s,type:w,key:A,ref:U,props:O,_owner:K.current}}function _e(w,$){return{$$typeof:s,type:w.type,key:$,ref:w.ref,props:w.props,_owner:w._owner}}function ae(w){return typeof w=="object"&&w!==null&&w.$$typeof===s}function Ce(w){var $={"=":"=0",":":"=2"};return"$"+w.replace(/[=:]/g,function(te){return $[te]})}var ve=/\/+/g;function je(w,$){return typeof w=="object"&&w!==null&&w.key!=null?Ce(""+w.key):$.toString(36)}function Qe(w,$,te,he,O){var A=typeof w;(A==="undefined"||A==="boolean")&&(w=null);var U=!1;if(w===null)U=!0;else switch(A){case"string":case"number":U=!0;break;case"object":switch(w.$$typeof){case s:case t:U=!0}}if(U)return U=w,O=O(U),w=he===""?"."+je(U,0):he,le(O)?(te="",w!=null&&(te=w.replace(ve,"$&/")+"/"),Qe(O,$,te,"",function(qe){return qe})):O!=null&&(ae(O)&&(O=_e(O,te+(!O.key||U&&U.key===O.key?"":(""+O.key).replace(ve,"$&/")+"/")+w)),$.push(O)),1;if(U=0,he=he===""?".":he+":",le(w))for(var we=0;we<w.length;we++){A=w[we];var Se=he+je(A,we);U+=Qe(A,$,te,Se,O)}else if(Se=v(w),typeof Se=="function")for(w=Se.call(w),we=0;!(A=w.next()).done;)A=A.value,Se=he+je(A,we++),U+=Qe(A,$,te,Se,O);else if(A==="object")throw $=String(w),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(w).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return U}function Ee(w,$,te){if(w==null)return w;var he=[],O=0;return Qe(w,he,"","",function(A){return $.call(te,A,O++)}),he}function Be(w){if(w._status===-1){var $=w._result;$=$(),$.then(function(te){(w._status===0||w._status===-1)&&(w._status=1,w._result=te)},function(te){(w._status===0||w._status===-1)&&(w._status=2,w._result=te)}),w._status===-1&&(w._status=0,w._result=$)}if(w._status===1)return w._result.default;throw w._result}var ee={current:null},Y={transition:null},q={ReactCurrentDispatcher:ee,ReactCurrentBatchConfig:Y,ReactCurrentOwner:K};return ze.Children={map:Ee,forEach:function(w,$,te){Ee(w,function(){$.apply(this,arguments)},te)},count:function(w){var $=0;return Ee(w,function(){$++}),$},toArray:function(w){return Ee(w,function($){return $})||[]},only:function(w){if(!ae(w))throw Error("React.Children.only expected to receive a single React element child.");return w}},ze.Component=ne,ze.Fragment=r,ze.Profiler=c,ze.PureComponent=ie,ze.StrictMode=o,ze.Suspense=g,ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=q,ze.cloneElement=function(w,$,te){if(w==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+w+".");var he=D({},w.props),O=w.key,A=w.ref,U=w._owner;if($!=null){if($.ref!==void 0&&(A=$.ref,U=K.current),$.key!==void 0&&(O=""+$.key),w.type&&w.type.defaultProps)var we=w.type.defaultProps;for(Se in $)Oe.call($,Se)&&!M.hasOwnProperty(Se)&&(he[Se]=$[Se]===void 0&&we!==void 0?we[Se]:$[Se])}var Se=arguments.length-2;if(Se===1)he.children=te;else if(1<Se){we=Array(Se);for(var qe=0;qe<Se;qe++)we[qe]=arguments[qe+2];he.children=we}return{$$typeof:s,type:w.type,key:O,ref:A,props:he,_owner:U}},ze.createContext=function(w){return w={$$typeof:f,_currentValue:w,_currentValue2:w,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},w.Provider={$$typeof:d,_context:w},w.Consumer=w},ze.createElement=L,ze.createFactory=function(w){var $=L.bind(null,w);return $.type=w,$},ze.createRef=function(){return{current:null}},ze.forwardRef=function(w){return{$$typeof:p,render:w}},ze.isValidElement=ae,ze.lazy=function(w){return{$$typeof:C,_payload:{_status:-1,_result:w},_init:Be}},ze.memo=function(w,$){return{$$typeof:x,type:w,compare:$===void 0?null:$}},ze.startTransition=function(w){var $=Y.transition;Y.transition={};try{w()}finally{Y.transition=$}},ze.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},ze.useCallback=function(w,$){return ee.current.useCallback(w,$)},ze.useContext=function(w){return ee.current.useContext(w)},ze.useDebugValue=function(){},ze.useDeferredValue=function(w){return ee.current.useDeferredValue(w)},ze.useEffect=function(w,$){return ee.current.useEffect(w,$)},ze.useId=function(){return ee.current.useId()},ze.useImperativeHandle=function(w,$,te){return ee.current.useImperativeHandle(w,$,te)},ze.useInsertionEffect=function(w,$){return ee.current.useInsertionEffect(w,$)},ze.useLayoutEffect=function(w,$){return ee.current.useLayoutEffect(w,$)},ze.useMemo=function(w,$){return ee.current.useMemo(w,$)},ze.useReducer=function(w,$,te){return ee.current.useReducer(w,$,te)},ze.useRef=function(w){return ee.current.useRef(w)},ze.useState=function(w){return ee.current.useState(w)},ze.useSyncExternalStore=function(w,$,te){return ee.current.useSyncExternalStore(w,$,te)},ze.useTransition=function(){return ee.current.useTransition()},ze.version="18.2.0",ze}var df;function Uc(){return df||(df=1,sc.exports=Yg()),sc.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hf;function Qg(){if(hf)return Js;hf=1;var s=Uc(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,c=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function f(p,g,x){var C,y={},v=null,k=null;x!==void 0&&(v=""+x),g.key!==void 0&&(v=""+g.key),g.ref!==void 0&&(k=g.ref);for(C in g)o.call(g,C)&&!d.hasOwnProperty(C)&&(y[C]=g[C]);if(p&&p.defaultProps)for(C in g=p.defaultProps,g)y[C]===void 0&&(y[C]=g[C]);return{$$typeof:t,type:p,key:v,ref:k,props:y,_owner:c.current}}return Js.Fragment=r,Js.jsx=f,Js.jsxs=f,Js}var ff;function Gg(){return ff||(ff=1,rc.exports=Qg()),rc.exports}var l=Gg(),F=Uc();const wp=_p(F);var Oo={},ic={exports:{}},$t={},oc={exports:{}},lc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pf;function qg(){return pf||(pf=1,(function(s){function t(Y,q){var w=Y.length;Y.push(q);e:for(;0<w;){var $=w-1>>>1,te=Y[$];if(0<c(te,q))Y[$]=q,Y[w]=te,w=$;else break e}}function r(Y){return Y.length===0?null:Y[0]}function o(Y){if(Y.length===0)return null;var q=Y[0],w=Y.pop();if(w!==q){Y[0]=w;e:for(var $=0,te=Y.length,he=te>>>1;$<he;){var O=2*($+1)-1,A=Y[O],U=O+1,we=Y[U];if(0>c(A,w))U<te&&0>c(we,A)?(Y[$]=we,Y[U]=w,$=U):(Y[$]=A,Y[O]=w,$=O);else if(U<te&&0>c(we,w))Y[$]=we,Y[U]=w,$=U;else break e}}return q}function c(Y,q){var w=Y.sortIndex-q.sortIndex;return w!==0?w:Y.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;s.unstable_now=function(){return d.now()}}else{var f=Date,p=f.now();s.unstable_now=function(){return f.now()-p}}var g=[],x=[],C=1,y=null,v=3,k=!1,D=!1,B=!1,ne=typeof setTimeout=="function"?setTimeout:null,ce=typeof clearTimeout=="function"?clearTimeout:null,ie=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ke(Y){for(var q=r(x);q!==null;){if(q.callback===null)o(x);else if(q.startTime<=Y)o(x),q.sortIndex=q.expirationTime,t(g,q);else break;q=r(x)}}function le(Y){if(B=!1,ke(Y),!D)if(r(g)!==null)D=!0,Be(Oe);else{var q=r(x);q!==null&&ee(le,q.startTime-Y)}}function Oe(Y,q){D=!1,B&&(B=!1,ce(L),L=-1),k=!0;var w=v;try{for(ke(q),y=r(g);y!==null&&(!(y.expirationTime>q)||Y&&!Ce());){var $=y.callback;if(typeof $=="function"){y.callback=null,v=y.priorityLevel;var te=$(y.expirationTime<=q);q=s.unstable_now(),typeof te=="function"?y.callback=te:y===r(g)&&o(g),ke(q)}else o(g);y=r(g)}if(y!==null)var he=!0;else{var O=r(x);O!==null&&ee(le,O.startTime-q),he=!1}return he}finally{y=null,v=w,k=!1}}var K=!1,M=null,L=-1,_e=5,ae=-1;function Ce(){return!(s.unstable_now()-ae<_e)}function ve(){if(M!==null){var Y=s.unstable_now();ae=Y;var q=!0;try{q=M(!0,Y)}finally{q?je():(K=!1,M=null)}}else K=!1}var je;if(typeof ie=="function")je=function(){ie(ve)};else if(typeof MessageChannel<"u"){var Qe=new MessageChannel,Ee=Qe.port2;Qe.port1.onmessage=ve,je=function(){Ee.postMessage(null)}}else je=function(){ne(ve,0)};function Be(Y){M=Y,K||(K=!0,je())}function ee(Y,q){L=ne(function(){Y(s.unstable_now())},q)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Y){Y.callback=null},s.unstable_continueExecution=function(){D||k||(D=!0,Be(Oe))},s.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_e=0<Y?Math.floor(1e3/Y):5},s.unstable_getCurrentPriorityLevel=function(){return v},s.unstable_getFirstCallbackNode=function(){return r(g)},s.unstable_next=function(Y){switch(v){case 1:case 2:case 3:var q=3;break;default:q=v}var w=v;v=q;try{return Y()}finally{v=w}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(Y,q){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var w=v;v=Y;try{return q()}finally{v=w}},s.unstable_scheduleCallback=function(Y,q,w){var $=s.unstable_now();switch(typeof w=="object"&&w!==null?(w=w.delay,w=typeof w=="number"&&0<w?$+w:$):w=$,Y){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=w+te,Y={id:C++,callback:q,priorityLevel:Y,startTime:w,expirationTime:te,sortIndex:-1},w>$?(Y.sortIndex=w,t(x,Y),r(g)===null&&Y===r(x)&&(B?(ce(L),L=-1):B=!0,ee(le,w-$))):(Y.sortIndex=te,t(g,Y),D||k||(D=!0,Be(Oe))),Y},s.unstable_shouldYield=Ce,s.unstable_wrapCallback=function(Y){var q=v;return function(){var w=v;v=q;try{return Y.apply(this,arguments)}finally{v=w}}}})(lc)),lc}var mf;function Xg(){return mf||(mf=1,oc.exports=qg()),oc.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gf;function Kg(){if(gf)return $t;gf=1;var s=Uc(),t=Xg();function r(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)n+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,c={};function d(e,n){f(e,n),f(e+"Capture",n)}function f(e,n){for(c[e]=n,e=0;e<n.length;e++)o.add(n[e])}var p=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),g=Object.prototype.hasOwnProperty,x=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,C={},y={};function v(e){return g.call(y,e)?!0:g.call(C,e)?!1:x.test(e)?y[e]=!0:(C[e]=!0,!1)}function k(e,n,i,a){if(i!==null&&i.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return a?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function D(e,n,i,a){if(n===null||typeof n>"u"||k(e,n,i,a))return!0;if(a)return!1;if(i!==null)switch(i.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function B(e,n,i,a,u,h,m){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=a,this.attributeNamespace=u,this.mustUseProperty=i,this.propertyName=e,this.type=n,this.sanitizeURL=h,this.removeEmptyString=m}var ne={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ne[e]=new B(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];ne[n]=new B(n,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){ne[e]=new B(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ne[e]=new B(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ne[e]=new B(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){ne[e]=new B(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){ne[e]=new B(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){ne[e]=new B(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){ne[e]=new B(e,5,!1,e.toLowerCase(),null,!1,!1)});var ce=/[\-:]([a-z])/g;function ie(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(ce,ie);ne[n]=new B(n,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(ce,ie);ne[n]=new B(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(ce,ie);ne[n]=new B(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){ne[e]=new B(e,1,!1,e.toLowerCase(),null,!1,!1)}),ne.xlinkHref=new B("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){ne[e]=new B(e,1,!1,e.toLowerCase(),null,!0,!0)});function ke(e,n,i,a){var u=ne.hasOwnProperty(n)?ne[n]:null;(u!==null?u.type!==0:a||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(D(n,i,u,a)&&(i=null),a||u===null?v(n)&&(i===null?e.removeAttribute(n):e.setAttribute(n,""+i)):u.mustUseProperty?e[u.propertyName]=i===null?u.type===3?!1:"":i:(n=u.attributeName,a=u.attributeNamespace,i===null?e.removeAttribute(n):(u=u.type,i=u===3||u===4&&i===!0?"":""+i,a?e.setAttributeNS(a,n,i):e.setAttribute(n,i))))}var le=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Oe=Symbol.for("react.element"),K=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),_e=Symbol.for("react.profiler"),ae=Symbol.for("react.provider"),Ce=Symbol.for("react.context"),ve=Symbol.for("react.forward_ref"),je=Symbol.for("react.suspense"),Qe=Symbol.for("react.suspense_list"),Ee=Symbol.for("react.memo"),Be=Symbol.for("react.lazy"),ee=Symbol.for("react.offscreen"),Y=Symbol.iterator;function q(e){return e===null||typeof e!="object"?null:(e=Y&&e[Y]||e["@@iterator"],typeof e=="function"?e:null)}var w=Object.assign,$;function te(e){if($===void 0)try{throw Error()}catch(i){var n=i.stack.trim().match(/\n( *(at )?)/);$=n&&n[1]||""}return`
`+$+e}var he=!1;function O(e,n){if(!e||he)return"";he=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(T){var a=T}Reflect.construct(e,[],n)}else{try{n.call()}catch(T){a=T}e.call(n.prototype)}else{try{throw Error()}catch(T){a=T}e()}}catch(T){if(T&&a&&typeof T.stack=="string"){for(var u=T.stack.split(`
`),h=a.stack.split(`
`),m=u.length-1,_=h.length-1;1<=m&&0<=_&&u[m]!==h[_];)_--;for(;1<=m&&0<=_;m--,_--)if(u[m]!==h[_]){if(m!==1||_!==1)do if(m--,_--,0>_||u[m]!==h[_]){var N=`
`+u[m].replace(" at new "," at ");return e.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",e.displayName)),N}while(1<=m&&0<=_);break}}}finally{he=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?te(e):""}function A(e){switch(e.tag){case 5:return te(e.type);case 16:return te("Lazy");case 13:return te("Suspense");case 19:return te("SuspenseList");case 0:case 2:case 15:return e=O(e.type,!1),e;case 11:return e=O(e.type.render,!1),e;case 1:return e=O(e.type,!0),e;default:return""}}function U(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case M:return"Fragment";case K:return"Portal";case _e:return"Profiler";case L:return"StrictMode";case je:return"Suspense";case Qe:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ce:return(e.displayName||"Context")+".Consumer";case ae:return(e._context.displayName||"Context")+".Provider";case ve:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ee:return n=e.displayName||null,n!==null?n:U(e.type)||"Memo";case Be:n=e._payload,e=e._init;try{return U(e(n))}catch{}}return null}function we(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(n);case 8:return n===L?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function Se(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function qe(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function ft(e){var n=qe(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),a=""+e[n];if(!e.hasOwnProperty(n)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var u=i.get,h=i.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return u.call(this)},set:function(m){a=""+m,h.call(this,m)}}),Object.defineProperty(e,n,{enumerable:i.enumerable}),{getValue:function(){return a},setValue:function(m){a=""+m},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function R(e){e._valueTracker||(e._valueTracker=ft(e))}function Q(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var i=n.getValue(),a="";return e&&(a=qe(e)?e.checked?"true":"false":e.value),e=a,e!==i?(n.setValue(e),!0):!1}function ge(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function j(e,n){var i=n.checked;return w({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function se(e,n){var i=n.defaultValue==null?"":n.defaultValue,a=n.checked!=null?n.checked:n.defaultChecked;i=Se(n.value!=null?n.value:i),e._wrapperState={initialChecked:a,initialValue:i,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function xe(e,n){n=n.checked,n!=null&&ke(e,"checked",n,!1)}function Ie(e,n){xe(e,n);var i=Se(n.value),a=n.type;if(i!=null)a==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?$e(e,n.type,i):n.hasOwnProperty("defaultValue")&&$e(e,n.type,Se(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function Te(e,n,i){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var a=n.type;if(!(a!=="submit"&&a!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,i||n===e.value||(e.value=n),e.defaultValue=n}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function $e(e,n,i){(n!=="number"||ge(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var Me=Array.isArray;function b(e,n,i,a){if(e=e.options,n){n={};for(var u=0;u<i.length;u++)n["$"+i[u]]=!0;for(i=0;i<e.length;i++)u=n.hasOwnProperty("$"+e[i].value),e[i].selected!==u&&(e[i].selected=u),u&&a&&(e[i].defaultSelected=!0)}else{for(i=""+Se(i),n=null,u=0;u<e.length;u++){if(e[u].value===i){e[u].selected=!0,a&&(e[u].defaultSelected=!0);return}n!==null||e[u].disabled||(n=e[u])}n!==null&&(n.selected=!0)}}function re(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(r(91));return w({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function P(e,n){var i=n.value;if(i==null){if(i=n.children,n=n.defaultValue,i!=null){if(n!=null)throw Error(r(92));if(Me(i)){if(1<i.length)throw Error(r(93));i=i[0]}n=i}n==null&&(n=""),i=n}e._wrapperState={initialValue:Se(i)}}function J(e,n){var i=Se(n.value),a=Se(n.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),n.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),a!=null&&(e.defaultValue=""+a)}function ue(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function G(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function z(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?G(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var pe,Re=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,i,a,u){MSApp.execUnsafeLocalFunction(function(){return e(n,i,a,u)})}:e})(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(pe=pe||document.createElement("div"),pe.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=pe.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function De(e,n){if(n){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=n;return}}e.textContent=n}var He={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rn=["Webkit","ms","Moz","O"];Object.keys(He).forEach(function(e){rn.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),He[n]=He[e]})});function Vt(e,n,i){return n==null||typeof n=="boolean"||n===""?"":i||typeof n!="number"||n===0||He.hasOwnProperty(e)&&He[e]?(""+n).trim():n+"px"}function lr(e,n){e=e.style;for(var i in n)if(n.hasOwnProperty(i)){var a=i.indexOf("--")===0,u=Vt(i,n[i],a);i==="float"&&(i="cssFloat"),a?e.setProperty(i,u):e[i]=u}}var ar=w({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ml(e,n){if(n){if(ar[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(r(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(r(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(r(61))}if(n.style!=null&&typeof n.style!="object")throw Error(r(62))}}function gl(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xl=null;function vl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yl=null,Rr=null,Lr=null;function Cu(e){if(e=As(e)){if(typeof yl!="function")throw Error(r(280));var n=e.stateNode;n&&(n=Xi(n),yl(e.stateNode,e.type,n))}}function Su(e){Rr?Lr?Lr.push(e):Lr=[e]:Rr=e}function ju(){if(Rr){var e=Rr,n=Lr;if(Lr=Rr=null,Cu(e),n)for(e=0;e<n.length;e++)Cu(n[e])}}function Eu(e,n){return e(n)}function Iu(){}var _l=!1;function Tu(e,n,i){if(_l)return e(n,i);_l=!0;try{return Eu(e,n,i)}finally{_l=!1,(Rr!==null||Lr!==null)&&(Iu(),ju())}}function gs(e,n){var i=e.stateNode;if(i===null)return null;var a=Xi(i);if(a===null)return null;i=a[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(r(231,n,typeof i));return i}var wl=!1;if(p)try{var xs={};Object.defineProperty(xs,"passive",{get:function(){wl=!0}}),window.addEventListener("test",xs,xs),window.removeEventListener("test",xs,xs)}catch{wl=!1}function J0(e,n,i,a,u,h,m,_,N){var T=Array.prototype.slice.call(arguments,3);try{n.apply(i,T)}catch(H){this.onError(H)}}var vs=!1,Ei=null,Ii=!1,bl=null,Z0={onError:function(e){vs=!0,Ei=e}};function em(e,n,i,a,u,h,m,_,N){vs=!1,Ei=null,J0.apply(Z0,arguments)}function tm(e,n,i,a,u,h,m,_,N){if(em.apply(this,arguments),vs){if(vs){var T=Ei;vs=!1,Ei=null}else throw Error(r(198));Ii||(Ii=!0,bl=T)}}function cr(e){var n=e,i=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(i=n.return),e=n.return;while(e)}return n.tag===3?i:null}function Ru(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function Lu(e){if(cr(e)!==e)throw Error(r(188))}function nm(e){var n=e.alternate;if(!n){if(n=cr(e),n===null)throw Error(r(188));return n!==e?null:e}for(var i=e,a=n;;){var u=i.return;if(u===null)break;var h=u.alternate;if(h===null){if(a=u.return,a!==null){i=a;continue}break}if(u.child===h.child){for(h=u.child;h;){if(h===i)return Lu(u),e;if(h===a)return Lu(u),n;h=h.sibling}throw Error(r(188))}if(i.return!==a.return)i=u,a=h;else{for(var m=!1,_=u.child;_;){if(_===i){m=!0,i=u,a=h;break}if(_===a){m=!0,a=u,i=h;break}_=_.sibling}if(!m){for(_=h.child;_;){if(_===i){m=!0,i=h,a=u;break}if(_===a){m=!0,a=h,i=u;break}_=_.sibling}if(!m)throw Error(r(189))}}if(i.alternate!==a)throw Error(r(190))}if(i.tag!==3)throw Error(r(188));return i.stateNode.current===i?e:n}function Pu(e){return e=nm(e),e!==null?Mu(e):null}function Mu(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=Mu(e);if(n!==null)return n;e=e.sibling}return null}var Du=t.unstable_scheduleCallback,Ou=t.unstable_cancelCallback,rm=t.unstable_shouldYield,sm=t.unstable_requestPaint,ct=t.unstable_now,im=t.unstable_getCurrentPriorityLevel,Nl=t.unstable_ImmediatePriority,Au=t.unstable_UserBlockingPriority,Ti=t.unstable_NormalPriority,om=t.unstable_LowPriority,Fu=t.unstable_IdlePriority,Ri=null,gn=null;function lm(e){if(gn&&typeof gn.onCommitFiberRoot=="function")try{gn.onCommitFiberRoot(Ri,e,void 0,(e.current.flags&128)===128)}catch{}}var sn=Math.clz32?Math.clz32:um,am=Math.log,cm=Math.LN2;function um(e){return e>>>=0,e===0?32:31-(am(e)/cm|0)|0}var Li=64,Pi=4194304;function ys(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Mi(e,n){var i=e.pendingLanes;if(i===0)return 0;var a=0,u=e.suspendedLanes,h=e.pingedLanes,m=i&268435455;if(m!==0){var _=m&~u;_!==0?a=ys(_):(h&=m,h!==0&&(a=ys(h)))}else m=i&~u,m!==0?a=ys(m):h!==0&&(a=ys(h));if(a===0)return 0;if(n!==0&&n!==a&&(n&u)===0&&(u=a&-a,h=n&-n,u>=h||u===16&&(h&4194240)!==0))return n;if((a&4)!==0&&(a|=i&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=a;0<n;)i=31-sn(n),u=1<<i,a|=e[i],n&=~u;return a}function dm(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hm(e,n){for(var i=e.suspendedLanes,a=e.pingedLanes,u=e.expirationTimes,h=e.pendingLanes;0<h;){var m=31-sn(h),_=1<<m,N=u[m];N===-1?((_&i)===0||(_&a)!==0)&&(u[m]=dm(_,n)):N<=n&&(e.expiredLanes|=_),h&=~_}}function kl(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function $u(){var e=Li;return Li<<=1,(Li&4194240)===0&&(Li=64),e}function Cl(e){for(var n=[],i=0;31>i;i++)n.push(e);return n}function _s(e,n,i){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-sn(n),e[n]=i}function fm(e,n){var i=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<i;){var u=31-sn(i),h=1<<u;n[u]=0,a[u]=-1,e[u]=-1,i&=~h}}function Sl(e,n){var i=e.entangledLanes|=n;for(e=e.entanglements;i;){var a=31-sn(i),u=1<<a;u&n|e[a]&n&&(e[a]|=n),i&=~u}}var Xe=0;function zu(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var Uu,jl,Wu,Bu,Hu,El=!1,Di=[],Dn=null,On=null,An=null,ws=new Map,bs=new Map,Fn=[],pm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vu(e,n){switch(e){case"focusin":case"focusout":Dn=null;break;case"dragenter":case"dragleave":On=null;break;case"mouseover":case"mouseout":An=null;break;case"pointerover":case"pointerout":ws.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":bs.delete(n.pointerId)}}function Ns(e,n,i,a,u,h){return e===null||e.nativeEvent!==h?(e={blockedOn:n,domEventName:i,eventSystemFlags:a,nativeEvent:h,targetContainers:[u]},n!==null&&(n=As(n),n!==null&&jl(n)),e):(e.eventSystemFlags|=a,n=e.targetContainers,u!==null&&n.indexOf(u)===-1&&n.push(u),e)}function mm(e,n,i,a,u){switch(n){case"focusin":return Dn=Ns(Dn,e,n,i,a,u),!0;case"dragenter":return On=Ns(On,e,n,i,a,u),!0;case"mouseover":return An=Ns(An,e,n,i,a,u),!0;case"pointerover":var h=u.pointerId;return ws.set(h,Ns(ws.get(h)||null,e,n,i,a,u)),!0;case"gotpointercapture":return h=u.pointerId,bs.set(h,Ns(bs.get(h)||null,e,n,i,a,u)),!0}return!1}function Yu(e){var n=ur(e.target);if(n!==null){var i=cr(n);if(i!==null){if(n=i.tag,n===13){if(n=Ru(i),n!==null){e.blockedOn=n,Hu(e.priority,function(){Wu(i)});return}}else if(n===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Oi(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var i=Tl(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var a=new i.constructor(i.type,i);xl=a,i.target.dispatchEvent(a),xl=null}else return n=As(i),n!==null&&jl(n),e.blockedOn=i,!1;n.shift()}return!0}function Qu(e,n,i){Oi(e)&&i.delete(n)}function gm(){El=!1,Dn!==null&&Oi(Dn)&&(Dn=null),On!==null&&Oi(On)&&(On=null),An!==null&&Oi(An)&&(An=null),ws.forEach(Qu),bs.forEach(Qu)}function ks(e,n){e.blockedOn===n&&(e.blockedOn=null,El||(El=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,gm)))}function Cs(e){function n(u){return ks(u,e)}if(0<Di.length){ks(Di[0],e);for(var i=1;i<Di.length;i++){var a=Di[i];a.blockedOn===e&&(a.blockedOn=null)}}for(Dn!==null&&ks(Dn,e),On!==null&&ks(On,e),An!==null&&ks(An,e),ws.forEach(n),bs.forEach(n),i=0;i<Fn.length;i++)a=Fn[i],a.blockedOn===e&&(a.blockedOn=null);for(;0<Fn.length&&(i=Fn[0],i.blockedOn===null);)Yu(i),i.blockedOn===null&&Fn.shift()}var Pr=le.ReactCurrentBatchConfig,Ai=!0;function xm(e,n,i,a){var u=Xe,h=Pr.transition;Pr.transition=null;try{Xe=1,Il(e,n,i,a)}finally{Xe=u,Pr.transition=h}}function vm(e,n,i,a){var u=Xe,h=Pr.transition;Pr.transition=null;try{Xe=4,Il(e,n,i,a)}finally{Xe=u,Pr.transition=h}}function Il(e,n,i,a){if(Ai){var u=Tl(e,n,i,a);if(u===null)Ql(e,n,a,Fi,i),Vu(e,a);else if(mm(u,e,n,i,a))a.stopPropagation();else if(Vu(e,a),n&4&&-1<pm.indexOf(e)){for(;u!==null;){var h=As(u);if(h!==null&&Uu(h),h=Tl(e,n,i,a),h===null&&Ql(e,n,a,Fi,i),h===u)break;u=h}u!==null&&a.stopPropagation()}else Ql(e,n,a,null,i)}}var Fi=null;function Tl(e,n,i,a){if(Fi=null,e=vl(a),e=ur(e),e!==null)if(n=cr(e),n===null)e=null;else if(i=n.tag,i===13){if(e=Ru(n),e!==null)return e;e=null}else if(i===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Fi=e,null}function Gu(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(im()){case Nl:return 1;case Au:return 4;case Ti:case om:return 16;case Fu:return 536870912;default:return 16}default:return 16}}var $n=null,Rl=null,$i=null;function qu(){if($i)return $i;var e,n=Rl,i=n.length,a,u="value"in $n?$n.value:$n.textContent,h=u.length;for(e=0;e<i&&n[e]===u[e];e++);var m=i-e;for(a=1;a<=m&&n[i-a]===u[h-a];a++);return $i=u.slice(e,1<a?1-a:void 0)}function zi(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Ui(){return!0}function Xu(){return!1}function Yt(e){function n(i,a,u,h,m){this._reactName=i,this._targetInst=u,this.type=a,this.nativeEvent=h,this.target=m,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(i=e[_],this[_]=i?i(h):h[_]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?Ui:Xu,this.isPropagationStopped=Xu,this}return w(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=Ui)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=Ui)},persist:function(){},isPersistent:Ui}),n}var Mr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ll=Yt(Mr),Ss=w({},Mr,{view:0,detail:0}),ym=Yt(Ss),Pl,Ml,js,Wi=w({},Ss,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ol,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==js&&(js&&e.type==="mousemove"?(Pl=e.screenX-js.screenX,Ml=e.screenY-js.screenY):Ml=Pl=0,js=e),Pl)},movementY:function(e){return"movementY"in e?e.movementY:Ml}}),Ku=Yt(Wi),_m=w({},Wi,{dataTransfer:0}),wm=Yt(_m),bm=w({},Ss,{relatedTarget:0}),Dl=Yt(bm),Nm=w({},Mr,{animationName:0,elapsedTime:0,pseudoElement:0}),km=Yt(Nm),Cm=w({},Mr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Sm=Yt(Cm),jm=w({},Mr,{data:0}),Ju=Yt(jm),Em={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Im={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rm(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=Tm[e])?!!n[e]:!1}function Ol(){return Rm}var Lm=w({},Ss,{key:function(e){if(e.key){var n=Em[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=zi(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Im[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ol,charCode:function(e){return e.type==="keypress"?zi(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?zi(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Pm=Yt(Lm),Mm=w({},Wi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zu=Yt(Mm),Dm=w({},Ss,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ol}),Om=Yt(Dm),Am=w({},Mr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Fm=Yt(Am),$m=w({},Wi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),zm=Yt($m),Um=[9,13,27,32],Al=p&&"CompositionEvent"in window,Es=null;p&&"documentMode"in document&&(Es=document.documentMode);var Wm=p&&"TextEvent"in window&&!Es,ed=p&&(!Al||Es&&8<Es&&11>=Es),td=" ",nd=!1;function rd(e,n){switch(e){case"keyup":return Um.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Dr=!1;function Bm(e,n){switch(e){case"compositionend":return sd(n);case"keypress":return n.which!==32?null:(nd=!0,td);case"textInput":return e=n.data,e===td&&nd?null:e;default:return null}}function Hm(e,n){if(Dr)return e==="compositionend"||!Al&&rd(e,n)?(e=qu(),$i=Rl=$n=null,Dr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return ed&&n.locale!=="ko"?null:n.data;default:return null}}var Vm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function id(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!Vm[e.type]:n==="textarea"}function od(e,n,i,a){Su(a),n=Qi(n,"onChange"),0<n.length&&(i=new Ll("onChange","change",null,i,a),e.push({event:i,listeners:n}))}var Is=null,Ts=null;function Ym(e){kd(e,0)}function Bi(e){var n=zr(e);if(Q(n))return e}function Qm(e,n){if(e==="change")return n}var ld=!1;if(p){var Fl;if(p){var $l="oninput"in document;if(!$l){var ad=document.createElement("div");ad.setAttribute("oninput","return;"),$l=typeof ad.oninput=="function"}Fl=$l}else Fl=!1;ld=Fl&&(!document.documentMode||9<document.documentMode)}function cd(){Is&&(Is.detachEvent("onpropertychange",ud),Ts=Is=null)}function ud(e){if(e.propertyName==="value"&&Bi(Ts)){var n=[];od(n,Ts,e,vl(e)),Tu(Ym,n)}}function Gm(e,n,i){e==="focusin"?(cd(),Is=n,Ts=i,Is.attachEvent("onpropertychange",ud)):e==="focusout"&&cd()}function qm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Bi(Ts)}function Xm(e,n){if(e==="click")return Bi(n)}function Km(e,n){if(e==="input"||e==="change")return Bi(n)}function Jm(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var on=typeof Object.is=="function"?Object.is:Jm;function Rs(e,n){if(on(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var i=Object.keys(e),a=Object.keys(n);if(i.length!==a.length)return!1;for(a=0;a<i.length;a++){var u=i[a];if(!g.call(n,u)||!on(e[u],n[u]))return!1}return!0}function dd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hd(e,n){var i=dd(e);e=0;for(var a;i;){if(i.nodeType===3){if(a=e+i.textContent.length,e<=n&&a>=n)return{node:i,offset:n-e};e=a}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=dd(i)}}function fd(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?fd(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function pd(){for(var e=window,n=ge();n instanceof e.HTMLIFrameElement;){try{var i=typeof n.contentWindow.location.href=="string"}catch{i=!1}if(i)e=n.contentWindow;else break;n=ge(e.document)}return n}function zl(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function Zm(e){var n=pd(),i=e.focusedElem,a=e.selectionRange;if(n!==i&&i&&i.ownerDocument&&fd(i.ownerDocument.documentElement,i)){if(a!==null&&zl(i)){if(n=a.start,e=a.end,e===void 0&&(e=n),"selectionStart"in i)i.selectionStart=n,i.selectionEnd=Math.min(e,i.value.length);else if(e=(n=i.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var u=i.textContent.length,h=Math.min(a.start,u);a=a.end===void 0?h:Math.min(a.end,u),!e.extend&&h>a&&(u=a,a=h,h=u),u=hd(i,h);var m=hd(i,a);u&&m&&(e.rangeCount!==1||e.anchorNode!==u.node||e.anchorOffset!==u.offset||e.focusNode!==m.node||e.focusOffset!==m.offset)&&(n=n.createRange(),n.setStart(u.node,u.offset),e.removeAllRanges(),h>a?(e.addRange(n),e.extend(m.node,m.offset)):(n.setEnd(m.node,m.offset),e.addRange(n)))}}for(n=[],e=i;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<n.length;i++)e=n[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var eg=p&&"documentMode"in document&&11>=document.documentMode,Or=null,Ul=null,Ls=null,Wl=!1;function md(e,n,i){var a=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Wl||Or==null||Or!==ge(a)||(a=Or,"selectionStart"in a&&zl(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Ls&&Rs(Ls,a)||(Ls=a,a=Qi(Ul,"onSelect"),0<a.length&&(n=new Ll("onSelect","select",null,n,i),e.push({event:n,listeners:a}),n.target=Or)))}function Hi(e,n){var i={};return i[e.toLowerCase()]=n.toLowerCase(),i["Webkit"+e]="webkit"+n,i["Moz"+e]="moz"+n,i}var Ar={animationend:Hi("Animation","AnimationEnd"),animationiteration:Hi("Animation","AnimationIteration"),animationstart:Hi("Animation","AnimationStart"),transitionend:Hi("Transition","TransitionEnd")},Bl={},gd={};p&&(gd=document.createElement("div").style,"AnimationEvent"in window||(delete Ar.animationend.animation,delete Ar.animationiteration.animation,delete Ar.animationstart.animation),"TransitionEvent"in window||delete Ar.transitionend.transition);function Vi(e){if(Bl[e])return Bl[e];if(!Ar[e])return e;var n=Ar[e],i;for(i in n)if(n.hasOwnProperty(i)&&i in gd)return Bl[e]=n[i];return e}var xd=Vi("animationend"),vd=Vi("animationiteration"),yd=Vi("animationstart"),_d=Vi("transitionend"),wd=new Map,bd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zn(e,n){wd.set(e,n),d(n,[e])}for(var Hl=0;Hl<bd.length;Hl++){var Vl=bd[Hl],tg=Vl.toLowerCase(),ng=Vl[0].toUpperCase()+Vl.slice(1);zn(tg,"on"+ng)}zn(xd,"onAnimationEnd"),zn(vd,"onAnimationIteration"),zn(yd,"onAnimationStart"),zn("dblclick","onDoubleClick"),zn("focusin","onFocus"),zn("focusout","onBlur"),zn(_d,"onTransitionEnd"),f("onMouseEnter",["mouseout","mouseover"]),f("onMouseLeave",["mouseout","mouseover"]),f("onPointerEnter",["pointerout","pointerover"]),f("onPointerLeave",["pointerout","pointerover"]),d("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),d("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),d("onBeforeInput",["compositionend","keypress","textInput","paste"]),d("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ps="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rg=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ps));function Nd(e,n,i){var a=e.type||"unknown-event";e.currentTarget=i,tm(a,n,void 0,e),e.currentTarget=null}function kd(e,n){n=(n&4)!==0;for(var i=0;i<e.length;i++){var a=e[i],u=a.event;a=a.listeners;e:{var h=void 0;if(n)for(var m=a.length-1;0<=m;m--){var _=a[m],N=_.instance,T=_.currentTarget;if(_=_.listener,N!==h&&u.isPropagationStopped())break e;Nd(u,_,T),h=N}else for(m=0;m<a.length;m++){if(_=a[m],N=_.instance,T=_.currentTarget,_=_.listener,N!==h&&u.isPropagationStopped())break e;Nd(u,_,T),h=N}}}if(Ii)throw e=bl,Ii=!1,bl=null,e}function tt(e,n){var i=n[Zl];i===void 0&&(i=n[Zl]=new Set);var a=e+"__bubble";i.has(a)||(Cd(n,e,2,!1),i.add(a))}function Yl(e,n,i){var a=0;n&&(a|=4),Cd(i,e,a,n)}var Yi="_reactListening"+Math.random().toString(36).slice(2);function Ms(e){if(!e[Yi]){e[Yi]=!0,o.forEach(function(i){i!=="selectionchange"&&(rg.has(i)||Yl(i,!1,e),Yl(i,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Yi]||(n[Yi]=!0,Yl("selectionchange",!1,n))}}function Cd(e,n,i,a){switch(Gu(n)){case 1:var u=xm;break;case 4:u=vm;break;default:u=Il}i=u.bind(null,n,i,e),u=void 0,!wl||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(u=!0),a?u!==void 0?e.addEventListener(n,i,{capture:!0,passive:u}):e.addEventListener(n,i,!0):u!==void 0?e.addEventListener(n,i,{passive:u}):e.addEventListener(n,i,!1)}function Ql(e,n,i,a,u){var h=a;if((n&1)===0&&(n&2)===0&&a!==null)e:for(;;){if(a===null)return;var m=a.tag;if(m===3||m===4){var _=a.stateNode.containerInfo;if(_===u||_.nodeType===8&&_.parentNode===u)break;if(m===4)for(m=a.return;m!==null;){var N=m.tag;if((N===3||N===4)&&(N=m.stateNode.containerInfo,N===u||N.nodeType===8&&N.parentNode===u))return;m=m.return}for(;_!==null;){if(m=ur(_),m===null)return;if(N=m.tag,N===5||N===6){a=h=m;continue e}_=_.parentNode}}a=a.return}Tu(function(){var T=h,H=vl(i),V=[];e:{var W=wd.get(e);if(W!==void 0){var oe=Ll,fe=e;switch(e){case"keypress":if(zi(i)===0)break e;case"keydown":case"keyup":oe=Pm;break;case"focusin":fe="focus",oe=Dl;break;case"focusout":fe="blur",oe=Dl;break;case"beforeblur":case"afterblur":oe=Dl;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=Ku;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=wm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=Om;break;case xd:case vd:case yd:oe=km;break;case _d:oe=Fm;break;case"scroll":oe=ym;break;case"wheel":oe=zm;break;case"copy":case"cut":case"paste":oe=Sm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=Zu}var me=(n&4)!==0,ut=!me&&e==="scroll",E=me?W!==null?W+"Capture":null:W;me=[];for(var S=T,I;S!==null;){I=S;var X=I.stateNode;if(I.tag===5&&X!==null&&(I=X,E!==null&&(X=gs(S,E),X!=null&&me.push(Ds(S,X,I)))),ut)break;S=S.return}0<me.length&&(W=new oe(W,fe,null,i,H),V.push({event:W,listeners:me}))}}if((n&7)===0){e:{if(W=e==="mouseover"||e==="pointerover",oe=e==="mouseout"||e==="pointerout",W&&i!==xl&&(fe=i.relatedTarget||i.fromElement)&&(ur(fe)||fe[wn]))break e;if((oe||W)&&(W=H.window===H?H:(W=H.ownerDocument)?W.defaultView||W.parentWindow:window,oe?(fe=i.relatedTarget||i.toElement,oe=T,fe=fe?ur(fe):null,fe!==null&&(ut=cr(fe),fe!==ut||fe.tag!==5&&fe.tag!==6)&&(fe=null)):(oe=null,fe=T),oe!==fe)){if(me=Ku,X="onMouseLeave",E="onMouseEnter",S="mouse",(e==="pointerout"||e==="pointerover")&&(me=Zu,X="onPointerLeave",E="onPointerEnter",S="pointer"),ut=oe==null?W:zr(oe),I=fe==null?W:zr(fe),W=new me(X,S+"leave",oe,i,H),W.target=ut,W.relatedTarget=I,X=null,ur(H)===T&&(me=new me(E,S+"enter",fe,i,H),me.target=I,me.relatedTarget=ut,X=me),ut=X,oe&&fe)t:{for(me=oe,E=fe,S=0,I=me;I;I=Fr(I))S++;for(I=0,X=E;X;X=Fr(X))I++;for(;0<S-I;)me=Fr(me),S--;for(;0<I-S;)E=Fr(E),I--;for(;S--;){if(me===E||E!==null&&me===E.alternate)break t;me=Fr(me),E=Fr(E)}me=null}else me=null;oe!==null&&Sd(V,W,oe,me,!1),fe!==null&&ut!==null&&Sd(V,ut,fe,me,!0)}}e:{if(W=T?zr(T):window,oe=W.nodeName&&W.nodeName.toLowerCase(),oe==="select"||oe==="input"&&W.type==="file")var ye=Qm;else if(id(W))if(ld)ye=Km;else{ye=qm;var be=Gm}else(oe=W.nodeName)&&oe.toLowerCase()==="input"&&(W.type==="checkbox"||W.type==="radio")&&(ye=Xm);if(ye&&(ye=ye(e,T))){od(V,ye,i,H);break e}be&&be(e,W,T),e==="focusout"&&(be=W._wrapperState)&&be.controlled&&W.type==="number"&&$e(W,"number",W.value)}switch(be=T?zr(T):window,e){case"focusin":(id(be)||be.contentEditable==="true")&&(Or=be,Ul=T,Ls=null);break;case"focusout":Ls=Ul=Or=null;break;case"mousedown":Wl=!0;break;case"contextmenu":case"mouseup":case"dragend":Wl=!1,md(V,i,H);break;case"selectionchange":if(eg)break;case"keydown":case"keyup":md(V,i,H)}var Ne;if(Al)e:{switch(e){case"compositionstart":var Pe="onCompositionStart";break e;case"compositionend":Pe="onCompositionEnd";break e;case"compositionupdate":Pe="onCompositionUpdate";break e}Pe=void 0}else Dr?rd(e,i)&&(Pe="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(Pe="onCompositionStart");Pe&&(ed&&i.locale!=="ko"&&(Dr||Pe!=="onCompositionStart"?Pe==="onCompositionEnd"&&Dr&&(Ne=qu()):($n=H,Rl="value"in $n?$n.value:$n.textContent,Dr=!0)),be=Qi(T,Pe),0<be.length&&(Pe=new Ju(Pe,e,null,i,H),V.push({event:Pe,listeners:be}),Ne?Pe.data=Ne:(Ne=sd(i),Ne!==null&&(Pe.data=Ne)))),(Ne=Wm?Bm(e,i):Hm(e,i))&&(T=Qi(T,"onBeforeInput"),0<T.length&&(H=new Ju("onBeforeInput","beforeinput",null,i,H),V.push({event:H,listeners:T}),H.data=Ne))}kd(V,n)})}function Ds(e,n,i){return{instance:e,listener:n,currentTarget:i}}function Qi(e,n){for(var i=n+"Capture",a=[];e!==null;){var u=e,h=u.stateNode;u.tag===5&&h!==null&&(u=h,h=gs(e,i),h!=null&&a.unshift(Ds(e,h,u)),h=gs(e,n),h!=null&&a.push(Ds(e,h,u))),e=e.return}return a}function Fr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Sd(e,n,i,a,u){for(var h=n._reactName,m=[];i!==null&&i!==a;){var _=i,N=_.alternate,T=_.stateNode;if(N!==null&&N===a)break;_.tag===5&&T!==null&&(_=T,u?(N=gs(i,h),N!=null&&m.unshift(Ds(i,N,_))):u||(N=gs(i,h),N!=null&&m.push(Ds(i,N,_)))),i=i.return}m.length!==0&&e.push({event:n,listeners:m})}var sg=/\r\n?/g,ig=/\u0000|\uFFFD/g;function jd(e){return(typeof e=="string"?e:""+e).replace(sg,`
`).replace(ig,"")}function Gi(e,n,i){if(n=jd(n),jd(e)!==n&&i)throw Error(r(425))}function qi(){}var Gl=null,ql=null;function Xl(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Kl=typeof setTimeout=="function"?setTimeout:void 0,og=typeof clearTimeout=="function"?clearTimeout:void 0,Ed=typeof Promise=="function"?Promise:void 0,lg=typeof queueMicrotask=="function"?queueMicrotask:typeof Ed<"u"?function(e){return Ed.resolve(null).then(e).catch(ag)}:Kl;function ag(e){setTimeout(function(){throw e})}function Jl(e,n){var i=n,a=0;do{var u=i.nextSibling;if(e.removeChild(i),u&&u.nodeType===8)if(i=u.data,i==="/$"){if(a===0){e.removeChild(u),Cs(n);return}a--}else i!=="$"&&i!=="$?"&&i!=="$!"||a++;i=u}while(i);Cs(n)}function Un(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function Id(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(n===0)return e;n--}else i==="/$"&&n++}e=e.previousSibling}return null}var $r=Math.random().toString(36).slice(2),xn="__reactFiber$"+$r,Os="__reactProps$"+$r,wn="__reactContainer$"+$r,Zl="__reactEvents$"+$r,cg="__reactListeners$"+$r,ug="__reactHandles$"+$r;function ur(e){var n=e[xn];if(n)return n;for(var i=e.parentNode;i;){if(n=i[wn]||i[xn]){if(i=n.alternate,n.child!==null||i!==null&&i.child!==null)for(e=Id(e);e!==null;){if(i=e[xn])return i;e=Id(e)}return n}e=i,i=e.parentNode}return null}function As(e){return e=e[xn]||e[wn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function zr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(r(33))}function Xi(e){return e[Os]||null}var ea=[],Ur=-1;function Wn(e){return{current:e}}function nt(e){0>Ur||(e.current=ea[Ur],ea[Ur]=null,Ur--)}function Je(e,n){Ur++,ea[Ur]=e.current,e.current=n}var Bn={},jt=Wn(Bn),Mt=Wn(!1),dr=Bn;function Wr(e,n){var i=e.type.contextTypes;if(!i)return Bn;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===n)return a.__reactInternalMemoizedMaskedChildContext;var u={},h;for(h in i)u[h]=n[h];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=u),u}function Dt(e){return e=e.childContextTypes,e!=null}function Ki(){nt(Mt),nt(jt)}function Td(e,n,i){if(jt.current!==Bn)throw Error(r(168));Je(jt,n),Je(Mt,i)}function Rd(e,n,i){var a=e.stateNode;if(n=n.childContextTypes,typeof a.getChildContext!="function")return i;a=a.getChildContext();for(var u in a)if(!(u in n))throw Error(r(108,we(e)||"Unknown",u));return w({},i,a)}function Ji(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Bn,dr=jt.current,Je(jt,e),Je(Mt,Mt.current),!0}function Ld(e,n,i){var a=e.stateNode;if(!a)throw Error(r(169));i?(e=Rd(e,n,dr),a.__reactInternalMemoizedMergedChildContext=e,nt(Mt),nt(jt),Je(jt,e)):nt(Mt),Je(Mt,i)}var bn=null,Zi=!1,ta=!1;function Pd(e){bn===null?bn=[e]:bn.push(e)}function dg(e){Zi=!0,Pd(e)}function Hn(){if(!ta&&bn!==null){ta=!0;var e=0,n=Xe;try{var i=bn;for(Xe=1;e<i.length;e++){var a=i[e];do a=a(!0);while(a!==null)}bn=null,Zi=!1}catch(u){throw bn!==null&&(bn=bn.slice(e+1)),Du(Nl,Hn),u}finally{Xe=n,ta=!1}}return null}var Br=[],Hr=0,eo=null,to=0,Xt=[],Kt=0,hr=null,Nn=1,kn="";function fr(e,n){Br[Hr++]=to,Br[Hr++]=eo,eo=e,to=n}function Md(e,n,i){Xt[Kt++]=Nn,Xt[Kt++]=kn,Xt[Kt++]=hr,hr=e;var a=Nn;e=kn;var u=32-sn(a)-1;a&=~(1<<u),i+=1;var h=32-sn(n)+u;if(30<h){var m=u-u%5;h=(a&(1<<m)-1).toString(32),a>>=m,u-=m,Nn=1<<32-sn(n)+u|i<<u|a,kn=h+e}else Nn=1<<h|i<<u|a,kn=e}function na(e){e.return!==null&&(fr(e,1),Md(e,1,0))}function ra(e){for(;e===eo;)eo=Br[--Hr],Br[Hr]=null,to=Br[--Hr],Br[Hr]=null;for(;e===hr;)hr=Xt[--Kt],Xt[Kt]=null,kn=Xt[--Kt],Xt[Kt]=null,Nn=Xt[--Kt],Xt[Kt]=null}var Qt=null,Gt=null,st=!1,ln=null;function Dd(e,n){var i=tn(5,null,null,0);i.elementType="DELETED",i.stateNode=n,i.return=e,n=e.deletions,n===null?(e.deletions=[i],e.flags|=16):n.push(i)}function Od(e,n){switch(e.tag){case 5:var i=e.type;return n=n.nodeType!==1||i.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,Qt=e,Gt=Un(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,Qt=e,Gt=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(i=hr!==null?{id:Nn,overflow:kn}:null,e.memoizedState={dehydrated:n,treeContext:i,retryLane:1073741824},i=tn(18,null,null,0),i.stateNode=n,i.return=e,e.child=i,Qt=e,Gt=null,!0):!1;default:return!1}}function sa(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ia(e){if(st){var n=Gt;if(n){var i=n;if(!Od(e,n)){if(sa(e))throw Error(r(418));n=Un(i.nextSibling);var a=Qt;n&&Od(e,n)?Dd(a,i):(e.flags=e.flags&-4097|2,st=!1,Qt=e)}}else{if(sa(e))throw Error(r(418));e.flags=e.flags&-4097|2,st=!1,Qt=e}}}function Ad(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Qt=e}function no(e){if(e!==Qt)return!1;if(!st)return Ad(e),st=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!Xl(e.type,e.memoizedProps)),n&&(n=Gt)){if(sa(e))throw Fd(),Error(r(418));for(;n;)Dd(e,n),n=Un(n.nextSibling)}if(Ad(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(r(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(n===0){Gt=Un(e.nextSibling);break e}n--}else i!=="$"&&i!=="$!"&&i!=="$?"||n++}e=e.nextSibling}Gt=null}}else Gt=Qt?Un(e.stateNode.nextSibling):null;return!0}function Fd(){for(var e=Gt;e;)e=Un(e.nextSibling)}function Vr(){Gt=Qt=null,st=!1}function oa(e){ln===null?ln=[e]:ln.push(e)}var hg=le.ReactCurrentBatchConfig;function an(e,n){if(e&&e.defaultProps){n=w({},n),e=e.defaultProps;for(var i in e)n[i]===void 0&&(n[i]=e[i]);return n}return n}var ro=Wn(null),so=null,Yr=null,la=null;function aa(){la=Yr=so=null}function ca(e){var n=ro.current;nt(ro),e._currentValue=n}function ua(e,n,i){for(;e!==null;){var a=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,a!==null&&(a.childLanes|=n)):a!==null&&(a.childLanes&n)!==n&&(a.childLanes|=n),e===i)break;e=e.return}}function Qr(e,n){so=e,la=Yr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&n)!==0&&(Ot=!0),e.firstContext=null)}function Jt(e){var n=e._currentValue;if(la!==e)if(e={context:e,memoizedValue:n,next:null},Yr===null){if(so===null)throw Error(r(308));Yr=e,so.dependencies={lanes:0,firstContext:e}}else Yr=Yr.next=e;return n}var pr=null;function da(e){pr===null?pr=[e]:pr.push(e)}function $d(e,n,i,a){var u=n.interleaved;return u===null?(i.next=i,da(n)):(i.next=u.next,u.next=i),n.interleaved=i,Cn(e,a)}function Cn(e,n){e.lanes|=n;var i=e.alternate;for(i!==null&&(i.lanes|=n),i=e,e=e.return;e!==null;)e.childLanes|=n,i=e.alternate,i!==null&&(i.childLanes|=n),i=e,e=e.return;return i.tag===3?i.stateNode:null}var Vn=!1;function ha(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zd(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Sn(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function Yn(e,n,i){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,(Ve&2)!==0){var u=a.pending;return u===null?n.next=n:(n.next=u.next,u.next=n),a.pending=n,Cn(e,i)}return u=a.interleaved,u===null?(n.next=n,da(a)):(n.next=u.next,u.next=n),a.interleaved=n,Cn(e,i)}function io(e,n,i){if(n=n.updateQueue,n!==null&&(n=n.shared,(i&4194240)!==0)){var a=n.lanes;a&=e.pendingLanes,i|=a,n.lanes=i,Sl(e,i)}}function Ud(e,n){var i=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,i===a)){var u=null,h=null;if(i=i.firstBaseUpdate,i!==null){do{var m={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};h===null?u=h=m:h=h.next=m,i=i.next}while(i!==null);h===null?u=h=n:h=h.next=n}else u=h=n;i={baseState:a.baseState,firstBaseUpdate:u,lastBaseUpdate:h,shared:a.shared,effects:a.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=n:e.next=n,i.lastBaseUpdate=n}function oo(e,n,i,a){var u=e.updateQueue;Vn=!1;var h=u.firstBaseUpdate,m=u.lastBaseUpdate,_=u.shared.pending;if(_!==null){u.shared.pending=null;var N=_,T=N.next;N.next=null,m===null?h=T:m.next=T,m=N;var H=e.alternate;H!==null&&(H=H.updateQueue,_=H.lastBaseUpdate,_!==m&&(_===null?H.firstBaseUpdate=T:_.next=T,H.lastBaseUpdate=N))}if(h!==null){var V=u.baseState;m=0,H=T=N=null,_=h;do{var W=_.lane,oe=_.eventTime;if((a&W)===W){H!==null&&(H=H.next={eventTime:oe,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});e:{var fe=e,me=_;switch(W=n,oe=i,me.tag){case 1:if(fe=me.payload,typeof fe=="function"){V=fe.call(oe,V,W);break e}V=fe;break e;case 3:fe.flags=fe.flags&-65537|128;case 0:if(fe=me.payload,W=typeof fe=="function"?fe.call(oe,V,W):fe,W==null)break e;V=w({},V,W);break e;case 2:Vn=!0}}_.callback!==null&&_.lane!==0&&(e.flags|=64,W=u.effects,W===null?u.effects=[_]:W.push(_))}else oe={eventTime:oe,lane:W,tag:_.tag,payload:_.payload,callback:_.callback,next:null},H===null?(T=H=oe,N=V):H=H.next=oe,m|=W;if(_=_.next,_===null){if(_=u.shared.pending,_===null)break;W=_,_=W.next,W.next=null,u.lastBaseUpdate=W,u.shared.pending=null}}while(!0);if(H===null&&(N=V),u.baseState=N,u.firstBaseUpdate=T,u.lastBaseUpdate=H,n=u.shared.interleaved,n!==null){u=n;do m|=u.lane,u=u.next;while(u!==n)}else h===null&&(u.shared.lanes=0);xr|=m,e.lanes=m,e.memoizedState=V}}function Wd(e,n,i){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var a=e[n],u=a.callback;if(u!==null){if(a.callback=null,a=i,typeof u!="function")throw Error(r(191,u));u.call(a)}}}var Bd=new s.Component().refs;function fa(e,n,i,a){n=e.memoizedState,i=i(a,n),i=i==null?n:w({},n,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var lo={isMounted:function(e){return(e=e._reactInternals)?cr(e)===e:!1},enqueueSetState:function(e,n,i){e=e._reactInternals;var a=Pt(),u=Xn(e),h=Sn(a,u);h.payload=n,i!=null&&(h.callback=i),n=Yn(e,h,u),n!==null&&(dn(n,e,u,a),io(n,e,u))},enqueueReplaceState:function(e,n,i){e=e._reactInternals;var a=Pt(),u=Xn(e),h=Sn(a,u);h.tag=1,h.payload=n,i!=null&&(h.callback=i),n=Yn(e,h,u),n!==null&&(dn(n,e,u,a),io(n,e,u))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var i=Pt(),a=Xn(e),u=Sn(i,a);u.tag=2,n!=null&&(u.callback=n),n=Yn(e,u,a),n!==null&&(dn(n,e,a,i),io(n,e,a))}};function Hd(e,n,i,a,u,h,m){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,h,m):n.prototype&&n.prototype.isPureReactComponent?!Rs(i,a)||!Rs(u,h):!0}function Vd(e,n,i){var a=!1,u=Bn,h=n.contextType;return typeof h=="object"&&h!==null?h=Jt(h):(u=Dt(n)?dr:jt.current,a=n.contextTypes,h=(a=a!=null)?Wr(e,u):Bn),n=new n(i,h),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=lo,e.stateNode=n,n._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=u,e.__reactInternalMemoizedMaskedChildContext=h),n}function Yd(e,n,i,a){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(i,a),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(i,a),n.state!==e&&lo.enqueueReplaceState(n,n.state,null)}function pa(e,n,i,a){var u=e.stateNode;u.props=i,u.state=e.memoizedState,u.refs=Bd,ha(e);var h=n.contextType;typeof h=="object"&&h!==null?u.context=Jt(h):(h=Dt(n)?dr:jt.current,u.context=Wr(e,h)),u.state=e.memoizedState,h=n.getDerivedStateFromProps,typeof h=="function"&&(fa(e,n,h,i),u.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(n=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),n!==u.state&&lo.enqueueReplaceState(u,u.state,null),oo(e,i,u,a),u.state=e.memoizedState),typeof u.componentDidMount=="function"&&(e.flags|=4194308)}function Fs(e,n,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(r(309));var a=i.stateNode}if(!a)throw Error(r(147,e));var u=a,h=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===h?n.ref:(n=function(m){var _=u.refs;_===Bd&&(_=u.refs={}),m===null?delete _[h]:_[h]=m},n._stringRef=h,n)}if(typeof e!="string")throw Error(r(284));if(!i._owner)throw Error(r(290,e))}return e}function ao(e,n){throw e=Object.prototype.toString.call(n),Error(r(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function Qd(e){var n=e._init;return n(e._payload)}function Gd(e){function n(E,S){if(e){var I=E.deletions;I===null?(E.deletions=[S],E.flags|=16):I.push(S)}}function i(E,S){if(!e)return null;for(;S!==null;)n(E,S),S=S.sibling;return null}function a(E,S){for(E=new Map;S!==null;)S.key!==null?E.set(S.key,S):E.set(S.index,S),S=S.sibling;return E}function u(E,S){return E=Jn(E,S),E.index=0,E.sibling=null,E}function h(E,S,I){return E.index=I,e?(I=E.alternate,I!==null?(I=I.index,I<S?(E.flags|=2,S):I):(E.flags|=2,S)):(E.flags|=1048576,S)}function m(E){return e&&E.alternate===null&&(E.flags|=2),E}function _(E,S,I,X){return S===null||S.tag!==6?(S=Ka(I,E.mode,X),S.return=E,S):(S=u(S,I),S.return=E,S)}function N(E,S,I,X){var ye=I.type;return ye===M?H(E,S,I.props.children,X,I.key):S!==null&&(S.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===Be&&Qd(ye)===S.type)?(X=u(S,I.props),X.ref=Fs(E,S,I),X.return=E,X):(X=Eo(I.type,I.key,I.props,null,E.mode,X),X.ref=Fs(E,S,I),X.return=E,X)}function T(E,S,I,X){return S===null||S.tag!==4||S.stateNode.containerInfo!==I.containerInfo||S.stateNode.implementation!==I.implementation?(S=Ja(I,E.mode,X),S.return=E,S):(S=u(S,I.children||[]),S.return=E,S)}function H(E,S,I,X,ye){return S===null||S.tag!==7?(S=wr(I,E.mode,X,ye),S.return=E,S):(S=u(S,I),S.return=E,S)}function V(E,S,I){if(typeof S=="string"&&S!==""||typeof S=="number")return S=Ka(""+S,E.mode,I),S.return=E,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Oe:return I=Eo(S.type,S.key,S.props,null,E.mode,I),I.ref=Fs(E,null,S),I.return=E,I;case K:return S=Ja(S,E.mode,I),S.return=E,S;case Be:var X=S._init;return V(E,X(S._payload),I)}if(Me(S)||q(S))return S=wr(S,E.mode,I,null),S.return=E,S;ao(E,S)}return null}function W(E,S,I,X){var ye=S!==null?S.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return ye!==null?null:_(E,S,""+I,X);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Oe:return I.key===ye?N(E,S,I,X):null;case K:return I.key===ye?T(E,S,I,X):null;case Be:return ye=I._init,W(E,S,ye(I._payload),X)}if(Me(I)||q(I))return ye!==null?null:H(E,S,I,X,null);ao(E,I)}return null}function oe(E,S,I,X,ye){if(typeof X=="string"&&X!==""||typeof X=="number")return E=E.get(I)||null,_(S,E,""+X,ye);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case Oe:return E=E.get(X.key===null?I:X.key)||null,N(S,E,X,ye);case K:return E=E.get(X.key===null?I:X.key)||null,T(S,E,X,ye);case Be:var be=X._init;return oe(E,S,I,be(X._payload),ye)}if(Me(X)||q(X))return E=E.get(I)||null,H(S,E,X,ye,null);ao(S,X)}return null}function fe(E,S,I,X){for(var ye=null,be=null,Ne=S,Pe=S=0,yt=null;Ne!==null&&Pe<I.length;Pe++){Ne.index>Pe?(yt=Ne,Ne=null):yt=Ne.sibling;var Ye=W(E,Ne,I[Pe],X);if(Ye===null){Ne===null&&(Ne=yt);break}e&&Ne&&Ye.alternate===null&&n(E,Ne),S=h(Ye,S,Pe),be===null?ye=Ye:be.sibling=Ye,be=Ye,Ne=yt}if(Pe===I.length)return i(E,Ne),st&&fr(E,Pe),ye;if(Ne===null){for(;Pe<I.length;Pe++)Ne=V(E,I[Pe],X),Ne!==null&&(S=h(Ne,S,Pe),be===null?ye=Ne:be.sibling=Ne,be=Ne);return st&&fr(E,Pe),ye}for(Ne=a(E,Ne);Pe<I.length;Pe++)yt=oe(Ne,E,Pe,I[Pe],X),yt!==null&&(e&&yt.alternate!==null&&Ne.delete(yt.key===null?Pe:yt.key),S=h(yt,S,Pe),be===null?ye=yt:be.sibling=yt,be=yt);return e&&Ne.forEach(function(Zn){return n(E,Zn)}),st&&fr(E,Pe),ye}function me(E,S,I,X){var ye=q(I);if(typeof ye!="function")throw Error(r(150));if(I=ye.call(I),I==null)throw Error(r(151));for(var be=ye=null,Ne=S,Pe=S=0,yt=null,Ye=I.next();Ne!==null&&!Ye.done;Pe++,Ye=I.next()){Ne.index>Pe?(yt=Ne,Ne=null):yt=Ne.sibling;var Zn=W(E,Ne,Ye.value,X);if(Zn===null){Ne===null&&(Ne=yt);break}e&&Ne&&Zn.alternate===null&&n(E,Ne),S=h(Zn,S,Pe),be===null?ye=Zn:be.sibling=Zn,be=Zn,Ne=yt}if(Ye.done)return i(E,Ne),st&&fr(E,Pe),ye;if(Ne===null){for(;!Ye.done;Pe++,Ye=I.next())Ye=V(E,Ye.value,X),Ye!==null&&(S=h(Ye,S,Pe),be===null?ye=Ye:be.sibling=Ye,be=Ye);return st&&fr(E,Pe),ye}for(Ne=a(E,Ne);!Ye.done;Pe++,Ye=I.next())Ye=oe(Ne,E,Pe,Ye.value,X),Ye!==null&&(e&&Ye.alternate!==null&&Ne.delete(Ye.key===null?Pe:Ye.key),S=h(Ye,S,Pe),be===null?ye=Ye:be.sibling=Ye,be=Ye);return e&&Ne.forEach(function(Vg){return n(E,Vg)}),st&&fr(E,Pe),ye}function ut(E,S,I,X){if(typeof I=="object"&&I!==null&&I.type===M&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case Oe:e:{for(var ye=I.key,be=S;be!==null;){if(be.key===ye){if(ye=I.type,ye===M){if(be.tag===7){i(E,be.sibling),S=u(be,I.props.children),S.return=E,E=S;break e}}else if(be.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===Be&&Qd(ye)===be.type){i(E,be.sibling),S=u(be,I.props),S.ref=Fs(E,be,I),S.return=E,E=S;break e}i(E,be);break}else n(E,be);be=be.sibling}I.type===M?(S=wr(I.props.children,E.mode,X,I.key),S.return=E,E=S):(X=Eo(I.type,I.key,I.props,null,E.mode,X),X.ref=Fs(E,S,I),X.return=E,E=X)}return m(E);case K:e:{for(be=I.key;S!==null;){if(S.key===be)if(S.tag===4&&S.stateNode.containerInfo===I.containerInfo&&S.stateNode.implementation===I.implementation){i(E,S.sibling),S=u(S,I.children||[]),S.return=E,E=S;break e}else{i(E,S);break}else n(E,S);S=S.sibling}S=Ja(I,E.mode,X),S.return=E,E=S}return m(E);case Be:return be=I._init,ut(E,S,be(I._payload),X)}if(Me(I))return fe(E,S,I,X);if(q(I))return me(E,S,I,X);ao(E,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,S!==null&&S.tag===6?(i(E,S.sibling),S=u(S,I),S.return=E,E=S):(i(E,S),S=Ka(I,E.mode,X),S.return=E,E=S),m(E)):i(E,S)}return ut}var Gr=Gd(!0),qd=Gd(!1),$s={},vn=Wn($s),zs=Wn($s),Us=Wn($s);function mr(e){if(e===$s)throw Error(r(174));return e}function ma(e,n){switch(Je(Us,n),Je(zs,e),Je(vn,$s),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:z(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=z(n,e)}nt(vn),Je(vn,n)}function qr(){nt(vn),nt(zs),nt(Us)}function Xd(e){mr(Us.current);var n=mr(vn.current),i=z(n,e.type);n!==i&&(Je(zs,e),Je(vn,i))}function ga(e){zs.current===e&&(nt(vn),nt(zs))}var it=Wn(0);function co(e){for(var n=e;n!==null;){if(n.tag===13){var i=n.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var xa=[];function va(){for(var e=0;e<xa.length;e++)xa[e]._workInProgressVersionPrimary=null;xa.length=0}var uo=le.ReactCurrentDispatcher,ya=le.ReactCurrentBatchConfig,gr=0,ot=null,pt=null,xt=null,ho=!1,Ws=!1,Bs=0,fg=0;function Et(){throw Error(r(321))}function _a(e,n){if(n===null)return!1;for(var i=0;i<n.length&&i<e.length;i++)if(!on(e[i],n[i]))return!1;return!0}function wa(e,n,i,a,u,h){if(gr=h,ot=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,uo.current=e===null||e.memoizedState===null?xg:vg,e=i(a,u),Ws){h=0;do{if(Ws=!1,Bs=0,25<=h)throw Error(r(301));h+=1,xt=pt=null,n.updateQueue=null,uo.current=yg,e=i(a,u)}while(Ws)}if(uo.current=mo,n=pt!==null&&pt.next!==null,gr=0,xt=pt=ot=null,ho=!1,n)throw Error(r(300));return e}function ba(){var e=Bs!==0;return Bs=0,e}function yn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xt===null?ot.memoizedState=xt=e:xt=xt.next=e,xt}function Zt(){if(pt===null){var e=ot.alternate;e=e!==null?e.memoizedState:null}else e=pt.next;var n=xt===null?ot.memoizedState:xt.next;if(n!==null)xt=n,pt=e;else{if(e===null)throw Error(r(310));pt=e,e={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},xt===null?ot.memoizedState=xt=e:xt=xt.next=e}return xt}function Hs(e,n){return typeof n=="function"?n(e):n}function Na(e){var n=Zt(),i=n.queue;if(i===null)throw Error(r(311));i.lastRenderedReducer=e;var a=pt,u=a.baseQueue,h=i.pending;if(h!==null){if(u!==null){var m=u.next;u.next=h.next,h.next=m}a.baseQueue=u=h,i.pending=null}if(u!==null){h=u.next,a=a.baseState;var _=m=null,N=null,T=h;do{var H=T.lane;if((gr&H)===H)N!==null&&(N=N.next={lane:0,action:T.action,hasEagerState:T.hasEagerState,eagerState:T.eagerState,next:null}),a=T.hasEagerState?T.eagerState:e(a,T.action);else{var V={lane:H,action:T.action,hasEagerState:T.hasEagerState,eagerState:T.eagerState,next:null};N===null?(_=N=V,m=a):N=N.next=V,ot.lanes|=H,xr|=H}T=T.next}while(T!==null&&T!==h);N===null?m=a:N.next=_,on(a,n.memoizedState)||(Ot=!0),n.memoizedState=a,n.baseState=m,n.baseQueue=N,i.lastRenderedState=a}if(e=i.interleaved,e!==null){u=e;do h=u.lane,ot.lanes|=h,xr|=h,u=u.next;while(u!==e)}else u===null&&(i.lanes=0);return[n.memoizedState,i.dispatch]}function ka(e){var n=Zt(),i=n.queue;if(i===null)throw Error(r(311));i.lastRenderedReducer=e;var a=i.dispatch,u=i.pending,h=n.memoizedState;if(u!==null){i.pending=null;var m=u=u.next;do h=e(h,m.action),m=m.next;while(m!==u);on(h,n.memoizedState)||(Ot=!0),n.memoizedState=h,n.baseQueue===null&&(n.baseState=h),i.lastRenderedState=h}return[h,a]}function Kd(){}function Jd(e,n){var i=ot,a=Zt(),u=n(),h=!on(a.memoizedState,u);if(h&&(a.memoizedState=u,Ot=!0),a=a.queue,Ca(th.bind(null,i,a,e),[e]),a.getSnapshot!==n||h||xt!==null&&xt.memoizedState.tag&1){if(i.flags|=2048,Vs(9,eh.bind(null,i,a,u,n),void 0,null),vt===null)throw Error(r(349));(gr&30)!==0||Zd(i,n,u)}return u}function Zd(e,n,i){e.flags|=16384,e={getSnapshot:n,value:i},n=ot.updateQueue,n===null?(n={lastEffect:null,stores:null},ot.updateQueue=n,n.stores=[e]):(i=n.stores,i===null?n.stores=[e]:i.push(e))}function eh(e,n,i,a){n.value=i,n.getSnapshot=a,nh(n)&&rh(e)}function th(e,n,i){return i(function(){nh(n)&&rh(e)})}function nh(e){var n=e.getSnapshot;e=e.value;try{var i=n();return!on(e,i)}catch{return!0}}function rh(e){var n=Cn(e,1);n!==null&&dn(n,e,1,-1)}function sh(e){var n=yn();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hs,lastRenderedState:e},n.queue=e,e=e.dispatch=gg.bind(null,ot,e),[n.memoizedState,e]}function Vs(e,n,i,a){return e={tag:e,create:n,destroy:i,deps:a,next:null},n=ot.updateQueue,n===null?(n={lastEffect:null,stores:null},ot.updateQueue=n,n.lastEffect=e.next=e):(i=n.lastEffect,i===null?n.lastEffect=e.next=e:(a=i.next,i.next=e,e.next=a,n.lastEffect=e)),e}function ih(){return Zt().memoizedState}function fo(e,n,i,a){var u=yn();ot.flags|=e,u.memoizedState=Vs(1|n,i,void 0,a===void 0?null:a)}function po(e,n,i,a){var u=Zt();a=a===void 0?null:a;var h=void 0;if(pt!==null){var m=pt.memoizedState;if(h=m.destroy,a!==null&&_a(a,m.deps)){u.memoizedState=Vs(n,i,h,a);return}}ot.flags|=e,u.memoizedState=Vs(1|n,i,h,a)}function oh(e,n){return fo(8390656,8,e,n)}function Ca(e,n){return po(2048,8,e,n)}function lh(e,n){return po(4,2,e,n)}function ah(e,n){return po(4,4,e,n)}function ch(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function uh(e,n,i){return i=i!=null?i.concat([e]):null,po(4,4,ch.bind(null,n,e),i)}function Sa(){}function dh(e,n){var i=Zt();n=n===void 0?null:n;var a=i.memoizedState;return a!==null&&n!==null&&_a(n,a[1])?a[0]:(i.memoizedState=[e,n],e)}function hh(e,n){var i=Zt();n=n===void 0?null:n;var a=i.memoizedState;return a!==null&&n!==null&&_a(n,a[1])?a[0]:(e=e(),i.memoizedState=[e,n],e)}function fh(e,n,i){return(gr&21)===0?(e.baseState&&(e.baseState=!1,Ot=!0),e.memoizedState=i):(on(i,n)||(i=$u(),ot.lanes|=i,xr|=i,e.baseState=!0),n)}function pg(e,n){var i=Xe;Xe=i!==0&&4>i?i:4,e(!0);var a=ya.transition;ya.transition={};try{e(!1),n()}finally{Xe=i,ya.transition=a}}function ph(){return Zt().memoizedState}function mg(e,n,i){var a=Xn(e);if(i={lane:a,action:i,hasEagerState:!1,eagerState:null,next:null},mh(e))gh(n,i);else if(i=$d(e,n,i,a),i!==null){var u=Pt();dn(i,e,a,u),xh(i,n,a)}}function gg(e,n,i){var a=Xn(e),u={lane:a,action:i,hasEagerState:!1,eagerState:null,next:null};if(mh(e))gh(n,u);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=n.lastRenderedReducer,h!==null))try{var m=n.lastRenderedState,_=h(m,i);if(u.hasEagerState=!0,u.eagerState=_,on(_,m)){var N=n.interleaved;N===null?(u.next=u,da(n)):(u.next=N.next,N.next=u),n.interleaved=u;return}}catch{}finally{}i=$d(e,n,u,a),i!==null&&(u=Pt(),dn(i,e,a,u),xh(i,n,a))}}function mh(e){var n=e.alternate;return e===ot||n!==null&&n===ot}function gh(e,n){Ws=ho=!0;var i=e.pending;i===null?n.next=n:(n.next=i.next,i.next=n),e.pending=n}function xh(e,n,i){if((i&4194240)!==0){var a=n.lanes;a&=e.pendingLanes,i|=a,n.lanes=i,Sl(e,i)}}var mo={readContext:Jt,useCallback:Et,useContext:Et,useEffect:Et,useImperativeHandle:Et,useInsertionEffect:Et,useLayoutEffect:Et,useMemo:Et,useReducer:Et,useRef:Et,useState:Et,useDebugValue:Et,useDeferredValue:Et,useTransition:Et,useMutableSource:Et,useSyncExternalStore:Et,useId:Et,unstable_isNewReconciler:!1},xg={readContext:Jt,useCallback:function(e,n){return yn().memoizedState=[e,n===void 0?null:n],e},useContext:Jt,useEffect:oh,useImperativeHandle:function(e,n,i){return i=i!=null?i.concat([e]):null,fo(4194308,4,ch.bind(null,n,e),i)},useLayoutEffect:function(e,n){return fo(4194308,4,e,n)},useInsertionEffect:function(e,n){return fo(4,2,e,n)},useMemo:function(e,n){var i=yn();return n=n===void 0?null:n,e=e(),i.memoizedState=[e,n],e},useReducer:function(e,n,i){var a=yn();return n=i!==void 0?i(n):n,a.memoizedState=a.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},a.queue=e,e=e.dispatch=mg.bind(null,ot,e),[a.memoizedState,e]},useRef:function(e){var n=yn();return e={current:e},n.memoizedState=e},useState:sh,useDebugValue:Sa,useDeferredValue:function(e){return yn().memoizedState=e},useTransition:function(){var e=sh(!1),n=e[0];return e=pg.bind(null,e[1]),yn().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,i){var a=ot,u=yn();if(st){if(i===void 0)throw Error(r(407));i=i()}else{if(i=n(),vt===null)throw Error(r(349));(gr&30)!==0||Zd(a,n,i)}u.memoizedState=i;var h={value:i,getSnapshot:n};return u.queue=h,oh(th.bind(null,a,h,e),[e]),a.flags|=2048,Vs(9,eh.bind(null,a,h,i,n),void 0,null),i},useId:function(){var e=yn(),n=vt.identifierPrefix;if(st){var i=kn,a=Nn;i=(a&~(1<<32-sn(a)-1)).toString(32)+i,n=":"+n+"R"+i,i=Bs++,0<i&&(n+="H"+i.toString(32)),n+=":"}else i=fg++,n=":"+n+"r"+i.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},vg={readContext:Jt,useCallback:dh,useContext:Jt,useEffect:Ca,useImperativeHandle:uh,useInsertionEffect:lh,useLayoutEffect:ah,useMemo:hh,useReducer:Na,useRef:ih,useState:function(){return Na(Hs)},useDebugValue:Sa,useDeferredValue:function(e){var n=Zt();return fh(n,pt.memoizedState,e)},useTransition:function(){var e=Na(Hs)[0],n=Zt().memoizedState;return[e,n]},useMutableSource:Kd,useSyncExternalStore:Jd,useId:ph,unstable_isNewReconciler:!1},yg={readContext:Jt,useCallback:dh,useContext:Jt,useEffect:Ca,useImperativeHandle:uh,useInsertionEffect:lh,useLayoutEffect:ah,useMemo:hh,useReducer:ka,useRef:ih,useState:function(){return ka(Hs)},useDebugValue:Sa,useDeferredValue:function(e){var n=Zt();return pt===null?n.memoizedState=e:fh(n,pt.memoizedState,e)},useTransition:function(){var e=ka(Hs)[0],n=Zt().memoizedState;return[e,n]},useMutableSource:Kd,useSyncExternalStore:Jd,useId:ph,unstable_isNewReconciler:!1};function Xr(e,n){try{var i="",a=n;do i+=A(a),a=a.return;while(a);var u=i}catch(h){u=`
Error generating stack: `+h.message+`
`+h.stack}return{value:e,source:n,stack:u,digest:null}}function ja(e,n,i){return{value:e,source:null,stack:i??null,digest:n??null}}function Ea(e,n){try{console.error(n.value)}catch(i){setTimeout(function(){throw i})}}var _g=typeof WeakMap=="function"?WeakMap:Map;function vh(e,n,i){i=Sn(-1,i),i.tag=3,i.payload={element:null};var a=n.value;return i.callback=function(){bo||(bo=!0,Ba=a),Ea(e,n)},i}function yh(e,n,i){i=Sn(-1,i),i.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var u=n.value;i.payload=function(){return a(u)},i.callback=function(){Ea(e,n)}}var h=e.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(i.callback=function(){Ea(e,n),typeof a!="function"&&(Gn===null?Gn=new Set([this]):Gn.add(this));var m=n.stack;this.componentDidCatch(n.value,{componentStack:m!==null?m:""})}),i}function _h(e,n,i){var a=e.pingCache;if(a===null){a=e.pingCache=new _g;var u=new Set;a.set(n,u)}else u=a.get(n),u===void 0&&(u=new Set,a.set(n,u));u.has(i)||(u.add(i),e=Mg.bind(null,e,n,i),n.then(e,e))}function wh(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function bh(e,n,i,a,u){return(e.mode&1)===0?(e===n?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(n=Sn(-1,1),n.tag=2,Yn(i,n,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=u,e)}var wg=le.ReactCurrentOwner,Ot=!1;function Lt(e,n,i,a){n.child=e===null?qd(n,null,i,a):Gr(n,e.child,i,a)}function Nh(e,n,i,a,u){i=i.render;var h=n.ref;return Qr(n,u),a=wa(e,n,i,a,h,u),i=ba(),e!==null&&!Ot?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~u,jn(e,n,u)):(st&&i&&na(n),n.flags|=1,Lt(e,n,a,u),n.child)}function kh(e,n,i,a,u){if(e===null){var h=i.type;return typeof h=="function"&&!Xa(h)&&h.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(n.tag=15,n.type=h,Ch(e,n,h,a,u)):(e=Eo(i.type,null,a,n,n.mode,u),e.ref=n.ref,e.return=n,n.child=e)}if(h=e.child,(e.lanes&u)===0){var m=h.memoizedProps;if(i=i.compare,i=i!==null?i:Rs,i(m,a)&&e.ref===n.ref)return jn(e,n,u)}return n.flags|=1,e=Jn(h,a),e.ref=n.ref,e.return=n,n.child=e}function Ch(e,n,i,a,u){if(e!==null){var h=e.memoizedProps;if(Rs(h,a)&&e.ref===n.ref)if(Ot=!1,n.pendingProps=a=h,(e.lanes&u)!==0)(e.flags&131072)!==0&&(Ot=!0);else return n.lanes=e.lanes,jn(e,n,u)}return Ia(e,n,i,a,u)}function Sh(e,n,i){var a=n.pendingProps,u=a.children,h=e!==null?e.memoizedState:null;if(a.mode==="hidden")if((n.mode&1)===0)n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Je(Jr,qt),qt|=i;else{if((i&1073741824)===0)return e=h!==null?h.baseLanes|i:i,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,Je(Jr,qt),qt|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=h!==null?h.baseLanes:i,Je(Jr,qt),qt|=a}else h!==null?(a=h.baseLanes|i,n.memoizedState=null):a=i,Je(Jr,qt),qt|=a;return Lt(e,n,u,i),n.child}function jh(e,n){var i=n.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(n.flags|=512,n.flags|=2097152)}function Ia(e,n,i,a,u){var h=Dt(i)?dr:jt.current;return h=Wr(n,h),Qr(n,u),i=wa(e,n,i,a,h,u),a=ba(),e!==null&&!Ot?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~u,jn(e,n,u)):(st&&a&&na(n),n.flags|=1,Lt(e,n,i,u),n.child)}function Eh(e,n,i,a,u){if(Dt(i)){var h=!0;Ji(n)}else h=!1;if(Qr(n,u),n.stateNode===null)xo(e,n),Vd(n,i,a),pa(n,i,a,u),a=!0;else if(e===null){var m=n.stateNode,_=n.memoizedProps;m.props=_;var N=m.context,T=i.contextType;typeof T=="object"&&T!==null?T=Jt(T):(T=Dt(i)?dr:jt.current,T=Wr(n,T));var H=i.getDerivedStateFromProps,V=typeof H=="function"||typeof m.getSnapshotBeforeUpdate=="function";V||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(_!==a||N!==T)&&Yd(n,m,a,T),Vn=!1;var W=n.memoizedState;m.state=W,oo(n,a,m,u),N=n.memoizedState,_!==a||W!==N||Mt.current||Vn?(typeof H=="function"&&(fa(n,i,H,a),N=n.memoizedState),(_=Vn||Hd(n,i,_,a,W,N,T))?(V||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(n.flags|=4194308)):(typeof m.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=a,n.memoizedState=N),m.props=a,m.state=N,m.context=T,a=_):(typeof m.componentDidMount=="function"&&(n.flags|=4194308),a=!1)}else{m=n.stateNode,zd(e,n),_=n.memoizedProps,T=n.type===n.elementType?_:an(n.type,_),m.props=T,V=n.pendingProps,W=m.context,N=i.contextType,typeof N=="object"&&N!==null?N=Jt(N):(N=Dt(i)?dr:jt.current,N=Wr(n,N));var oe=i.getDerivedStateFromProps;(H=typeof oe=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(_!==V||W!==N)&&Yd(n,m,a,N),Vn=!1,W=n.memoizedState,m.state=W,oo(n,a,m,u);var fe=n.memoizedState;_!==V||W!==fe||Mt.current||Vn?(typeof oe=="function"&&(fa(n,i,oe,a),fe=n.memoizedState),(T=Vn||Hd(n,i,T,a,W,fe,N)||!1)?(H||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(a,fe,N),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(a,fe,N)),typeof m.componentDidUpdate=="function"&&(n.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof m.componentDidUpdate!="function"||_===e.memoizedProps&&W===e.memoizedState||(n.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&W===e.memoizedState||(n.flags|=1024),n.memoizedProps=a,n.memoizedState=fe),m.props=a,m.state=fe,m.context=N,a=T):(typeof m.componentDidUpdate!="function"||_===e.memoizedProps&&W===e.memoizedState||(n.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&W===e.memoizedState||(n.flags|=1024),a=!1)}return Ta(e,n,i,a,h,u)}function Ta(e,n,i,a,u,h){jh(e,n);var m=(n.flags&128)!==0;if(!a&&!m)return u&&Ld(n,i,!1),jn(e,n,h);a=n.stateNode,wg.current=n;var _=m&&typeof i.getDerivedStateFromError!="function"?null:a.render();return n.flags|=1,e!==null&&m?(n.child=Gr(n,e.child,null,h),n.child=Gr(n,null,_,h)):Lt(e,n,_,h),n.memoizedState=a.state,u&&Ld(n,i,!0),n.child}function Ih(e){var n=e.stateNode;n.pendingContext?Td(e,n.pendingContext,n.pendingContext!==n.context):n.context&&Td(e,n.context,!1),ma(e,n.containerInfo)}function Th(e,n,i,a,u){return Vr(),oa(u),n.flags|=256,Lt(e,n,i,a),n.child}var Ra={dehydrated:null,treeContext:null,retryLane:0};function La(e){return{baseLanes:e,cachePool:null,transitions:null}}function Rh(e,n,i){var a=n.pendingProps,u=it.current,h=!1,m=(n.flags&128)!==0,_;if((_=m)||(_=e!==null&&e.memoizedState===null?!1:(u&2)!==0),_?(h=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(u|=1),Je(it,u&1),e===null)return ia(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((n.mode&1)===0?n.lanes=1:e.data==="$!"?n.lanes=8:n.lanes=1073741824,null):(m=a.children,e=a.fallback,h?(a=n.mode,h=n.child,m={mode:"hidden",children:m},(a&1)===0&&h!==null?(h.childLanes=0,h.pendingProps=m):h=Io(m,a,0,null),e=wr(e,a,i,null),h.return=n,e.return=n,h.sibling=e,n.child=h,n.child.memoizedState=La(i),n.memoizedState=Ra,e):Pa(n,m));if(u=e.memoizedState,u!==null&&(_=u.dehydrated,_!==null))return bg(e,n,m,a,_,u,i);if(h){h=a.fallback,m=n.mode,u=e.child,_=u.sibling;var N={mode:"hidden",children:a.children};return(m&1)===0&&n.child!==u?(a=n.child,a.childLanes=0,a.pendingProps=N,n.deletions=null):(a=Jn(u,N),a.subtreeFlags=u.subtreeFlags&14680064),_!==null?h=Jn(_,h):(h=wr(h,m,i,null),h.flags|=2),h.return=n,a.return=n,a.sibling=h,n.child=a,a=h,h=n.child,m=e.child.memoizedState,m=m===null?La(i):{baseLanes:m.baseLanes|i,cachePool:null,transitions:m.transitions},h.memoizedState=m,h.childLanes=e.childLanes&~i,n.memoizedState=Ra,a}return h=e.child,e=h.sibling,a=Jn(h,{mode:"visible",children:a.children}),(n.mode&1)===0&&(a.lanes=i),a.return=n,a.sibling=null,e!==null&&(i=n.deletions,i===null?(n.deletions=[e],n.flags|=16):i.push(e)),n.child=a,n.memoizedState=null,a}function Pa(e,n){return n=Io({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function go(e,n,i,a){return a!==null&&oa(a),Gr(n,e.child,null,i),e=Pa(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function bg(e,n,i,a,u,h,m){if(i)return n.flags&256?(n.flags&=-257,a=ja(Error(r(422))),go(e,n,m,a)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(h=a.fallback,u=n.mode,a=Io({mode:"visible",children:a.children},u,0,null),h=wr(h,u,m,null),h.flags|=2,a.return=n,h.return=n,a.sibling=h,n.child=a,(n.mode&1)!==0&&Gr(n,e.child,null,m),n.child.memoizedState=La(m),n.memoizedState=Ra,h);if((n.mode&1)===0)return go(e,n,m,null);if(u.data==="$!"){if(a=u.nextSibling&&u.nextSibling.dataset,a)var _=a.dgst;return a=_,h=Error(r(419)),a=ja(h,a,void 0),go(e,n,m,a)}if(_=(m&e.childLanes)!==0,Ot||_){if(a=vt,a!==null){switch(m&-m){case 4:u=2;break;case 16:u=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:u=32;break;case 536870912:u=268435456;break;default:u=0}u=(u&(a.suspendedLanes|m))!==0?0:u,u!==0&&u!==h.retryLane&&(h.retryLane=u,Cn(e,u),dn(a,e,u,-1))}return qa(),a=ja(Error(r(421))),go(e,n,m,a)}return u.data==="$?"?(n.flags|=128,n.child=e.child,n=Dg.bind(null,e),u._reactRetry=n,null):(e=h.treeContext,Gt=Un(u.nextSibling),Qt=n,st=!0,ln=null,e!==null&&(Xt[Kt++]=Nn,Xt[Kt++]=kn,Xt[Kt++]=hr,Nn=e.id,kn=e.overflow,hr=n),n=Pa(n,a.children),n.flags|=4096,n)}function Lh(e,n,i){e.lanes|=n;var a=e.alternate;a!==null&&(a.lanes|=n),ua(e.return,n,i)}function Ma(e,n,i,a,u){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:a,tail:i,tailMode:u}:(h.isBackwards=n,h.rendering=null,h.renderingStartTime=0,h.last=a,h.tail=i,h.tailMode=u)}function Ph(e,n,i){var a=n.pendingProps,u=a.revealOrder,h=a.tail;if(Lt(e,n,a.children,i),a=it.current,(a&2)!==0)a=a&1|2,n.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Lh(e,i,n);else if(e.tag===19)Lh(e,i,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(Je(it,a),(n.mode&1)===0)n.memoizedState=null;else switch(u){case"forwards":for(i=n.child,u=null;i!==null;)e=i.alternate,e!==null&&co(e)===null&&(u=i),i=i.sibling;i=u,i===null?(u=n.child,n.child=null):(u=i.sibling,i.sibling=null),Ma(n,!1,u,i,h);break;case"backwards":for(i=null,u=n.child,n.child=null;u!==null;){if(e=u.alternate,e!==null&&co(e)===null){n.child=u;break}e=u.sibling,u.sibling=i,i=u,u=e}Ma(n,!0,i,null,h);break;case"together":Ma(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function xo(e,n){(n.mode&1)===0&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function jn(e,n,i){if(e!==null&&(n.dependencies=e.dependencies),xr|=n.lanes,(i&n.childLanes)===0)return null;if(e!==null&&n.child!==e.child)throw Error(r(153));if(n.child!==null){for(e=n.child,i=Jn(e,e.pendingProps),n.child=i,i.return=n;e.sibling!==null;)e=e.sibling,i=i.sibling=Jn(e,e.pendingProps),i.return=n;i.sibling=null}return n.child}function Ng(e,n,i){switch(n.tag){case 3:Ih(n),Vr();break;case 5:Xd(n);break;case 1:Dt(n.type)&&Ji(n);break;case 4:ma(n,n.stateNode.containerInfo);break;case 10:var a=n.type._context,u=n.memoizedProps.value;Je(ro,a._currentValue),a._currentValue=u;break;case 13:if(a=n.memoizedState,a!==null)return a.dehydrated!==null?(Je(it,it.current&1),n.flags|=128,null):(i&n.child.childLanes)!==0?Rh(e,n,i):(Je(it,it.current&1),e=jn(e,n,i),e!==null?e.sibling:null);Je(it,it.current&1);break;case 19:if(a=(i&n.childLanes)!==0,(e.flags&128)!==0){if(a)return Ph(e,n,i);n.flags|=128}if(u=n.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),Je(it,it.current),a)break;return null;case 22:case 23:return n.lanes=0,Sh(e,n,i)}return jn(e,n,i)}var Mh,Da,Dh,Oh;Mh=function(e,n){for(var i=n.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Da=function(){},Dh=function(e,n,i,a){var u=e.memoizedProps;if(u!==a){e=n.stateNode,mr(vn.current);var h=null;switch(i){case"input":u=j(e,u),a=j(e,a),h=[];break;case"select":u=w({},u,{value:void 0}),a=w({},a,{value:void 0}),h=[];break;case"textarea":u=re(e,u),a=re(e,a),h=[];break;default:typeof u.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=qi)}ml(i,a);var m;i=null;for(T in u)if(!a.hasOwnProperty(T)&&u.hasOwnProperty(T)&&u[T]!=null)if(T==="style"){var _=u[T];for(m in _)_.hasOwnProperty(m)&&(i||(i={}),i[m]="")}else T!=="dangerouslySetInnerHTML"&&T!=="children"&&T!=="suppressContentEditableWarning"&&T!=="suppressHydrationWarning"&&T!=="autoFocus"&&(c.hasOwnProperty(T)?h||(h=[]):(h=h||[]).push(T,null));for(T in a){var N=a[T];if(_=u!=null?u[T]:void 0,a.hasOwnProperty(T)&&N!==_&&(N!=null||_!=null))if(T==="style")if(_){for(m in _)!_.hasOwnProperty(m)||N&&N.hasOwnProperty(m)||(i||(i={}),i[m]="");for(m in N)N.hasOwnProperty(m)&&_[m]!==N[m]&&(i||(i={}),i[m]=N[m])}else i||(h||(h=[]),h.push(T,i)),i=N;else T==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,_=_?_.__html:void 0,N!=null&&_!==N&&(h=h||[]).push(T,N)):T==="children"?typeof N!="string"&&typeof N!="number"||(h=h||[]).push(T,""+N):T!=="suppressContentEditableWarning"&&T!=="suppressHydrationWarning"&&(c.hasOwnProperty(T)?(N!=null&&T==="onScroll"&&tt("scroll",e),h||_===N||(h=[])):(h=h||[]).push(T,N))}i&&(h=h||[]).push("style",i);var T=h;(n.updateQueue=T)&&(n.flags|=4)}},Oh=function(e,n,i,a){i!==a&&(n.flags|=4)};function Ys(e,n){if(!st)switch(e.tailMode){case"hidden":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function It(e){var n=e.alternate!==null&&e.alternate.child===e.child,i=0,a=0;if(n)for(var u=e.child;u!==null;)i|=u.lanes|u.childLanes,a|=u.subtreeFlags&14680064,a|=u.flags&14680064,u.return=e,u=u.sibling;else for(u=e.child;u!==null;)i|=u.lanes|u.childLanes,a|=u.subtreeFlags,a|=u.flags,u.return=e,u=u.sibling;return e.subtreeFlags|=a,e.childLanes=i,n}function kg(e,n,i){var a=n.pendingProps;switch(ra(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return It(n),null;case 1:return Dt(n.type)&&Ki(),It(n),null;case 3:return a=n.stateNode,qr(),nt(Mt),nt(jt),va(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(no(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,ln!==null&&(Ya(ln),ln=null))),Da(e,n),It(n),null;case 5:ga(n);var u=mr(Us.current);if(i=n.type,e!==null&&n.stateNode!=null)Dh(e,n,i,a,u),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!a){if(n.stateNode===null)throw Error(r(166));return It(n),null}if(e=mr(vn.current),no(n)){a=n.stateNode,i=n.type;var h=n.memoizedProps;switch(a[xn]=n,a[Os]=h,e=(n.mode&1)!==0,i){case"dialog":tt("cancel",a),tt("close",a);break;case"iframe":case"object":case"embed":tt("load",a);break;case"video":case"audio":for(u=0;u<Ps.length;u++)tt(Ps[u],a);break;case"source":tt("error",a);break;case"img":case"image":case"link":tt("error",a),tt("load",a);break;case"details":tt("toggle",a);break;case"input":se(a,h),tt("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!h.multiple},tt("invalid",a);break;case"textarea":P(a,h),tt("invalid",a)}ml(i,h),u=null;for(var m in h)if(h.hasOwnProperty(m)){var _=h[m];m==="children"?typeof _=="string"?a.textContent!==_&&(h.suppressHydrationWarning!==!0&&Gi(a.textContent,_,e),u=["children",_]):typeof _=="number"&&a.textContent!==""+_&&(h.suppressHydrationWarning!==!0&&Gi(a.textContent,_,e),u=["children",""+_]):c.hasOwnProperty(m)&&_!=null&&m==="onScroll"&&tt("scroll",a)}switch(i){case"input":R(a),Te(a,h,!0);break;case"textarea":R(a),ue(a);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(a.onclick=qi)}a=u,n.updateQueue=a,a!==null&&(n.flags|=4)}else{m=u.nodeType===9?u:u.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=G(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=m.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=m.createElement(i,{is:a.is}):(e=m.createElement(i),i==="select"&&(m=e,a.multiple?m.multiple=!0:a.size&&(m.size=a.size))):e=m.createElementNS(e,i),e[xn]=n,e[Os]=a,Mh(e,n,!1,!1),n.stateNode=e;e:{switch(m=gl(i,a),i){case"dialog":tt("cancel",e),tt("close",e),u=a;break;case"iframe":case"object":case"embed":tt("load",e),u=a;break;case"video":case"audio":for(u=0;u<Ps.length;u++)tt(Ps[u],e);u=a;break;case"source":tt("error",e),u=a;break;case"img":case"image":case"link":tt("error",e),tt("load",e),u=a;break;case"details":tt("toggle",e),u=a;break;case"input":se(e,a),u=j(e,a),tt("invalid",e);break;case"option":u=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},u=w({},a,{value:void 0}),tt("invalid",e);break;case"textarea":P(e,a),u=re(e,a),tt("invalid",e);break;default:u=a}ml(i,u),_=u;for(h in _)if(_.hasOwnProperty(h)){var N=_[h];h==="style"?lr(e,N):h==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,N!=null&&Re(e,N)):h==="children"?typeof N=="string"?(i!=="textarea"||N!=="")&&De(e,N):typeof N=="number"&&De(e,""+N):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(c.hasOwnProperty(h)?N!=null&&h==="onScroll"&&tt("scroll",e):N!=null&&ke(e,h,N,m))}switch(i){case"input":R(e),Te(e,a,!1);break;case"textarea":R(e),ue(e);break;case"option":a.value!=null&&e.setAttribute("value",""+Se(a.value));break;case"select":e.multiple=!!a.multiple,h=a.value,h!=null?b(e,!!a.multiple,h,!1):a.defaultValue!=null&&b(e,!!a.multiple,a.defaultValue,!0);break;default:typeof u.onClick=="function"&&(e.onclick=qi)}switch(i){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return It(n),null;case 6:if(e&&n.stateNode!=null)Oh(e,n,e.memoizedProps,a);else{if(typeof a!="string"&&n.stateNode===null)throw Error(r(166));if(i=mr(Us.current),mr(vn.current),no(n)){if(a=n.stateNode,i=n.memoizedProps,a[xn]=n,(h=a.nodeValue!==i)&&(e=Qt,e!==null))switch(e.tag){case 3:Gi(a.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Gi(a.nodeValue,i,(e.mode&1)!==0)}h&&(n.flags|=4)}else a=(i.nodeType===9?i:i.ownerDocument).createTextNode(a),a[xn]=n,n.stateNode=a}return It(n),null;case 13:if(nt(it),a=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(st&&Gt!==null&&(n.mode&1)!==0&&(n.flags&128)===0)Fd(),Vr(),n.flags|=98560,h=!1;else if(h=no(n),a!==null&&a.dehydrated!==null){if(e===null){if(!h)throw Error(r(318));if(h=n.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(r(317));h[xn]=n}else Vr(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;It(n),h=!1}else ln!==null&&(Ya(ln),ln=null),h=!0;if(!h)return n.flags&65536?n:null}return(n.flags&128)!==0?(n.lanes=i,n):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(n.child.flags|=8192,(n.mode&1)!==0&&(e===null||(it.current&1)!==0?mt===0&&(mt=3):qa())),n.updateQueue!==null&&(n.flags|=4),It(n),null);case 4:return qr(),Da(e,n),e===null&&Ms(n.stateNode.containerInfo),It(n),null;case 10:return ca(n.type._context),It(n),null;case 17:return Dt(n.type)&&Ki(),It(n),null;case 19:if(nt(it),h=n.memoizedState,h===null)return It(n),null;if(a=(n.flags&128)!==0,m=h.rendering,m===null)if(a)Ys(h,!1);else{if(mt!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(m=co(e),m!==null){for(n.flags|=128,Ys(h,!1),a=m.updateQueue,a!==null&&(n.updateQueue=a,n.flags|=4),n.subtreeFlags=0,a=i,i=n.child;i!==null;)h=i,e=a,h.flags&=14680066,m=h.alternate,m===null?(h.childLanes=0,h.lanes=e,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=m.childLanes,h.lanes=m.lanes,h.child=m.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=m.memoizedProps,h.memoizedState=m.memoizedState,h.updateQueue=m.updateQueue,h.type=m.type,e=m.dependencies,h.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Je(it,it.current&1|2),n.child}e=e.sibling}h.tail!==null&&ct()>Zr&&(n.flags|=128,a=!0,Ys(h,!1),n.lanes=4194304)}else{if(!a)if(e=co(m),e!==null){if(n.flags|=128,a=!0,i=e.updateQueue,i!==null&&(n.updateQueue=i,n.flags|=4),Ys(h,!0),h.tail===null&&h.tailMode==="hidden"&&!m.alternate&&!st)return It(n),null}else 2*ct()-h.renderingStartTime>Zr&&i!==1073741824&&(n.flags|=128,a=!0,Ys(h,!1),n.lanes=4194304);h.isBackwards?(m.sibling=n.child,n.child=m):(i=h.last,i!==null?i.sibling=m:n.child=m,h.last=m)}return h.tail!==null?(n=h.tail,h.rendering=n,h.tail=n.sibling,h.renderingStartTime=ct(),n.sibling=null,i=it.current,Je(it,a?i&1|2:i&1),n):(It(n),null);case 22:case 23:return Ga(),a=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(n.flags|=8192),a&&(n.mode&1)!==0?(qt&1073741824)!==0&&(It(n),n.subtreeFlags&6&&(n.flags|=8192)):It(n),null;case 24:return null;case 25:return null}throw Error(r(156,n.tag))}function Cg(e,n){switch(ra(n),n.tag){case 1:return Dt(n.type)&&Ki(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return qr(),nt(Mt),nt(jt),va(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 5:return ga(n),null;case 13:if(nt(it),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(r(340));Vr()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return nt(it),null;case 4:return qr(),null;case 10:return ca(n.type._context),null;case 22:case 23:return Ga(),null;case 24:return null;default:return null}}var vo=!1,Tt=!1,Sg=typeof WeakSet=="function"?WeakSet:Set,de=null;function Kr(e,n){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(a){lt(e,n,a)}else i.current=null}function Oa(e,n,i){try{i()}catch(a){lt(e,n,a)}}var Ah=!1;function jg(e,n){if(Gl=Ai,e=pd(),zl(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var a=i.getSelection&&i.getSelection();if(a&&a.rangeCount!==0){i=a.anchorNode;var u=a.anchorOffset,h=a.focusNode;a=a.focusOffset;try{i.nodeType,h.nodeType}catch{i=null;break e}var m=0,_=-1,N=-1,T=0,H=0,V=e,W=null;t:for(;;){for(var oe;V!==i||u!==0&&V.nodeType!==3||(_=m+u),V!==h||a!==0&&V.nodeType!==3||(N=m+a),V.nodeType===3&&(m+=V.nodeValue.length),(oe=V.firstChild)!==null;)W=V,V=oe;for(;;){if(V===e)break t;if(W===i&&++T===u&&(_=m),W===h&&++H===a&&(N=m),(oe=V.nextSibling)!==null)break;V=W,W=V.parentNode}V=oe}i=_===-1||N===-1?null:{start:_,end:N}}else i=null}i=i||{start:0,end:0}}else i=null;for(ql={focusedElem:e,selectionRange:i},Ai=!1,de=n;de!==null;)if(n=de,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,de=e;else for(;de!==null;){n=de;try{var fe=n.alternate;if((n.flags&1024)!==0)switch(n.tag){case 0:case 11:case 15:break;case 1:if(fe!==null){var me=fe.memoizedProps,ut=fe.memoizedState,E=n.stateNode,S=E.getSnapshotBeforeUpdate(n.elementType===n.type?me:an(n.type,me),ut);E.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var I=n.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(X){lt(n,n.return,X)}if(e=n.sibling,e!==null){e.return=n.return,de=e;break}de=n.return}return fe=Ah,Ah=!1,fe}function Qs(e,n,i){var a=n.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var u=a=a.next;do{if((u.tag&e)===e){var h=u.destroy;u.destroy=void 0,h!==void 0&&Oa(n,i,h)}u=u.next}while(u!==a)}}function yo(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.create;i.destroy=a()}i=i.next}while(i!==n)}}function Aa(e){var n=e.ref;if(n!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof n=="function"?n(e):n.current=e}}function Fh(e){var n=e.alternate;n!==null&&(e.alternate=null,Fh(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[xn],delete n[Os],delete n[Zl],delete n[cg],delete n[ug])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function $h(e){return e.tag===5||e.tag===3||e.tag===4}function zh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||$h(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Fa(e,n,i){var a=e.tag;if(a===5||a===6)e=e.stateNode,n?i.nodeType===8?i.parentNode.insertBefore(e,n):i.insertBefore(e,n):(i.nodeType===8?(n=i.parentNode,n.insertBefore(e,i)):(n=i,n.appendChild(e)),i=i._reactRootContainer,i!=null||n.onclick!==null||(n.onclick=qi));else if(a!==4&&(e=e.child,e!==null))for(Fa(e,n,i),e=e.sibling;e!==null;)Fa(e,n,i),e=e.sibling}function $a(e,n,i){var a=e.tag;if(a===5||a===6)e=e.stateNode,n?i.insertBefore(e,n):i.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for($a(e,n,i),e=e.sibling;e!==null;)$a(e,n,i),e=e.sibling}var kt=null,cn=!1;function Qn(e,n,i){for(i=i.child;i!==null;)Uh(e,n,i),i=i.sibling}function Uh(e,n,i){if(gn&&typeof gn.onCommitFiberUnmount=="function")try{gn.onCommitFiberUnmount(Ri,i)}catch{}switch(i.tag){case 5:Tt||Kr(i,n);case 6:var a=kt,u=cn;kt=null,Qn(e,n,i),kt=a,cn=u,kt!==null&&(cn?(e=kt,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):kt.removeChild(i.stateNode));break;case 18:kt!==null&&(cn?(e=kt,i=i.stateNode,e.nodeType===8?Jl(e.parentNode,i):e.nodeType===1&&Jl(e,i),Cs(e)):Jl(kt,i.stateNode));break;case 4:a=kt,u=cn,kt=i.stateNode.containerInfo,cn=!0,Qn(e,n,i),kt=a,cn=u;break;case 0:case 11:case 14:case 15:if(!Tt&&(a=i.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){u=a=a.next;do{var h=u,m=h.destroy;h=h.tag,m!==void 0&&((h&2)!==0||(h&4)!==0)&&Oa(i,n,m),u=u.next}while(u!==a)}Qn(e,n,i);break;case 1:if(!Tt&&(Kr(i,n),a=i.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=i.memoizedProps,a.state=i.memoizedState,a.componentWillUnmount()}catch(_){lt(i,n,_)}Qn(e,n,i);break;case 21:Qn(e,n,i);break;case 22:i.mode&1?(Tt=(a=Tt)||i.memoizedState!==null,Qn(e,n,i),Tt=a):Qn(e,n,i);break;default:Qn(e,n,i)}}function Wh(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new Sg),n.forEach(function(a){var u=Og.bind(null,e,a);i.has(a)||(i.add(a),a.then(u,u))})}}function un(e,n){var i=n.deletions;if(i!==null)for(var a=0;a<i.length;a++){var u=i[a];try{var h=e,m=n,_=m;e:for(;_!==null;){switch(_.tag){case 5:kt=_.stateNode,cn=!1;break e;case 3:kt=_.stateNode.containerInfo,cn=!0;break e;case 4:kt=_.stateNode.containerInfo,cn=!0;break e}_=_.return}if(kt===null)throw Error(r(160));Uh(h,m,u),kt=null,cn=!1;var N=u.alternate;N!==null&&(N.return=null),u.return=null}catch(T){lt(u,n,T)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)Bh(n,e),n=n.sibling}function Bh(e,n){var i=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(un(n,e),_n(e),a&4){try{Qs(3,e,e.return),yo(3,e)}catch(me){lt(e,e.return,me)}try{Qs(5,e,e.return)}catch(me){lt(e,e.return,me)}}break;case 1:un(n,e),_n(e),a&512&&i!==null&&Kr(i,i.return);break;case 5:if(un(n,e),_n(e),a&512&&i!==null&&Kr(i,i.return),e.flags&32){var u=e.stateNode;try{De(u,"")}catch(me){lt(e,e.return,me)}}if(a&4&&(u=e.stateNode,u!=null)){var h=e.memoizedProps,m=i!==null?i.memoizedProps:h,_=e.type,N=e.updateQueue;if(e.updateQueue=null,N!==null)try{_==="input"&&h.type==="radio"&&h.name!=null&&xe(u,h),gl(_,m);var T=gl(_,h);for(m=0;m<N.length;m+=2){var H=N[m],V=N[m+1];H==="style"?lr(u,V):H==="dangerouslySetInnerHTML"?Re(u,V):H==="children"?De(u,V):ke(u,H,V,T)}switch(_){case"input":Ie(u,h);break;case"textarea":J(u,h);break;case"select":var W=u._wrapperState.wasMultiple;u._wrapperState.wasMultiple=!!h.multiple;var oe=h.value;oe!=null?b(u,!!h.multiple,oe,!1):W!==!!h.multiple&&(h.defaultValue!=null?b(u,!!h.multiple,h.defaultValue,!0):b(u,!!h.multiple,h.multiple?[]:"",!1))}u[Os]=h}catch(me){lt(e,e.return,me)}}break;case 6:if(un(n,e),_n(e),a&4){if(e.stateNode===null)throw Error(r(162));u=e.stateNode,h=e.memoizedProps;try{u.nodeValue=h}catch(me){lt(e,e.return,me)}}break;case 3:if(un(n,e),_n(e),a&4&&i!==null&&i.memoizedState.isDehydrated)try{Cs(n.containerInfo)}catch(me){lt(e,e.return,me)}break;case 4:un(n,e),_n(e);break;case 13:un(n,e),_n(e),u=e.child,u.flags&8192&&(h=u.memoizedState!==null,u.stateNode.isHidden=h,!h||u.alternate!==null&&u.alternate.memoizedState!==null||(Wa=ct())),a&4&&Wh(e);break;case 22:if(H=i!==null&&i.memoizedState!==null,e.mode&1?(Tt=(T=Tt)||H,un(n,e),Tt=T):un(n,e),_n(e),a&8192){if(T=e.memoizedState!==null,(e.stateNode.isHidden=T)&&!H&&(e.mode&1)!==0)for(de=e,H=e.child;H!==null;){for(V=de=H;de!==null;){switch(W=de,oe=W.child,W.tag){case 0:case 11:case 14:case 15:Qs(4,W,W.return);break;case 1:Kr(W,W.return);var fe=W.stateNode;if(typeof fe.componentWillUnmount=="function"){a=W,i=W.return;try{n=a,fe.props=n.memoizedProps,fe.state=n.memoizedState,fe.componentWillUnmount()}catch(me){lt(a,i,me)}}break;case 5:Kr(W,W.return);break;case 22:if(W.memoizedState!==null){Yh(V);continue}}oe!==null?(oe.return=W,de=oe):Yh(V)}H=H.sibling}e:for(H=null,V=e;;){if(V.tag===5){if(H===null){H=V;try{u=V.stateNode,T?(h=u.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(_=V.stateNode,N=V.memoizedProps.style,m=N!=null&&N.hasOwnProperty("display")?N.display:null,_.style.display=Vt("display",m))}catch(me){lt(e,e.return,me)}}}else if(V.tag===6){if(H===null)try{V.stateNode.nodeValue=T?"":V.memoizedProps}catch(me){lt(e,e.return,me)}}else if((V.tag!==22&&V.tag!==23||V.memoizedState===null||V===e)&&V.child!==null){V.child.return=V,V=V.child;continue}if(V===e)break e;for(;V.sibling===null;){if(V.return===null||V.return===e)break e;H===V&&(H=null),V=V.return}H===V&&(H=null),V.sibling.return=V.return,V=V.sibling}}break;case 19:un(n,e),_n(e),a&4&&Wh(e);break;case 21:break;default:un(n,e),_n(e)}}function _n(e){var n=e.flags;if(n&2){try{e:{for(var i=e.return;i!==null;){if($h(i)){var a=i;break e}i=i.return}throw Error(r(160))}switch(a.tag){case 5:var u=a.stateNode;a.flags&32&&(De(u,""),a.flags&=-33);var h=zh(e);$a(e,h,u);break;case 3:case 4:var m=a.stateNode.containerInfo,_=zh(e);Fa(e,_,m);break;default:throw Error(r(161))}}catch(N){lt(e,e.return,N)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function Eg(e,n,i){de=e,Hh(e)}function Hh(e,n,i){for(var a=(e.mode&1)!==0;de!==null;){var u=de,h=u.child;if(u.tag===22&&a){var m=u.memoizedState!==null||vo;if(!m){var _=u.alternate,N=_!==null&&_.memoizedState!==null||Tt;_=vo;var T=Tt;if(vo=m,(Tt=N)&&!T)for(de=u;de!==null;)m=de,N=m.child,m.tag===22&&m.memoizedState!==null?Qh(u):N!==null?(N.return=m,de=N):Qh(u);for(;h!==null;)de=h,Hh(h),h=h.sibling;de=u,vo=_,Tt=T}Vh(e)}else(u.subtreeFlags&8772)!==0&&h!==null?(h.return=u,de=h):Vh(e)}}function Vh(e){for(;de!==null;){var n=de;if((n.flags&8772)!==0){var i=n.alternate;try{if((n.flags&8772)!==0)switch(n.tag){case 0:case 11:case 15:Tt||yo(5,n);break;case 1:var a=n.stateNode;if(n.flags&4&&!Tt)if(i===null)a.componentDidMount();else{var u=n.elementType===n.type?i.memoizedProps:an(n.type,i.memoizedProps);a.componentDidUpdate(u,i.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var h=n.updateQueue;h!==null&&Wd(n,h,a);break;case 3:var m=n.updateQueue;if(m!==null){if(i=null,n.child!==null)switch(n.child.tag){case 5:i=n.child.stateNode;break;case 1:i=n.child.stateNode}Wd(n,m,i)}break;case 5:var _=n.stateNode;if(i===null&&n.flags&4){i=_;var N=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":N.autoFocus&&i.focus();break;case"img":N.src&&(i.src=N.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var T=n.alternate;if(T!==null){var H=T.memoizedState;if(H!==null){var V=H.dehydrated;V!==null&&Cs(V)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Tt||n.flags&512&&Aa(n)}catch(W){lt(n,n.return,W)}}if(n===e){de=null;break}if(i=n.sibling,i!==null){i.return=n.return,de=i;break}de=n.return}}function Yh(e){for(;de!==null;){var n=de;if(n===e){de=null;break}var i=n.sibling;if(i!==null){i.return=n.return,de=i;break}de=n.return}}function Qh(e){for(;de!==null;){var n=de;try{switch(n.tag){case 0:case 11:case 15:var i=n.return;try{yo(4,n)}catch(N){lt(n,i,N)}break;case 1:var a=n.stateNode;if(typeof a.componentDidMount=="function"){var u=n.return;try{a.componentDidMount()}catch(N){lt(n,u,N)}}var h=n.return;try{Aa(n)}catch(N){lt(n,h,N)}break;case 5:var m=n.return;try{Aa(n)}catch(N){lt(n,m,N)}}}catch(N){lt(n,n.return,N)}if(n===e){de=null;break}var _=n.sibling;if(_!==null){_.return=n.return,de=_;break}de=n.return}}var Ig=Math.ceil,_o=le.ReactCurrentDispatcher,za=le.ReactCurrentOwner,en=le.ReactCurrentBatchConfig,Ve=0,vt=null,dt=null,Ct=0,qt=0,Jr=Wn(0),mt=0,Gs=null,xr=0,wo=0,Ua=0,qs=null,At=null,Wa=0,Zr=1/0,En=null,bo=!1,Ba=null,Gn=null,No=!1,qn=null,ko=0,Xs=0,Ha=null,Co=-1,So=0;function Pt(){return(Ve&6)!==0?ct():Co!==-1?Co:Co=ct()}function Xn(e){return(e.mode&1)===0?1:(Ve&2)!==0&&Ct!==0?Ct&-Ct:hg.transition!==null?(So===0&&(So=$u()),So):(e=Xe,e!==0||(e=window.event,e=e===void 0?16:Gu(e.type)),e)}function dn(e,n,i,a){if(50<Xs)throw Xs=0,Ha=null,Error(r(185));_s(e,i,a),((Ve&2)===0||e!==vt)&&(e===vt&&((Ve&2)===0&&(wo|=i),mt===4&&Kn(e,Ct)),Ft(e,a),i===1&&Ve===0&&(n.mode&1)===0&&(Zr=ct()+500,Zi&&Hn()))}function Ft(e,n){var i=e.callbackNode;hm(e,n);var a=Mi(e,e===vt?Ct:0);if(a===0)i!==null&&Ou(i),e.callbackNode=null,e.callbackPriority=0;else if(n=a&-a,e.callbackPriority!==n){if(i!=null&&Ou(i),n===1)e.tag===0?dg(qh.bind(null,e)):Pd(qh.bind(null,e)),lg(function(){(Ve&6)===0&&Hn()}),i=null;else{switch(zu(a)){case 1:i=Nl;break;case 4:i=Au;break;case 16:i=Ti;break;case 536870912:i=Fu;break;default:i=Ti}i=rf(i,Gh.bind(null,e))}e.callbackPriority=n,e.callbackNode=i}}function Gh(e,n){if(Co=-1,So=0,(Ve&6)!==0)throw Error(r(327));var i=e.callbackNode;if(es()&&e.callbackNode!==i)return null;var a=Mi(e,e===vt?Ct:0);if(a===0)return null;if((a&30)!==0||(a&e.expiredLanes)!==0||n)n=jo(e,a);else{n=a;var u=Ve;Ve|=2;var h=Kh();(vt!==e||Ct!==n)&&(En=null,Zr=ct()+500,yr(e,n));do try{Lg();break}catch(_){Xh(e,_)}while(!0);aa(),_o.current=h,Ve=u,dt!==null?n=0:(vt=null,Ct=0,n=mt)}if(n!==0){if(n===2&&(u=kl(e),u!==0&&(a=u,n=Va(e,u))),n===1)throw i=Gs,yr(e,0),Kn(e,a),Ft(e,ct()),i;if(n===6)Kn(e,a);else{if(u=e.current.alternate,(a&30)===0&&!Tg(u)&&(n=jo(e,a),n===2&&(h=kl(e),h!==0&&(a=h,n=Va(e,h))),n===1))throw i=Gs,yr(e,0),Kn(e,a),Ft(e,ct()),i;switch(e.finishedWork=u,e.finishedLanes=a,n){case 0:case 1:throw Error(r(345));case 2:_r(e,At,En);break;case 3:if(Kn(e,a),(a&130023424)===a&&(n=Wa+500-ct(),10<n)){if(Mi(e,0)!==0)break;if(u=e.suspendedLanes,(u&a)!==a){Pt(),e.pingedLanes|=e.suspendedLanes&u;break}e.timeoutHandle=Kl(_r.bind(null,e,At,En),n);break}_r(e,At,En);break;case 4:if(Kn(e,a),(a&4194240)===a)break;for(n=e.eventTimes,u=-1;0<a;){var m=31-sn(a);h=1<<m,m=n[m],m>u&&(u=m),a&=~h}if(a=u,a=ct()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*Ig(a/1960))-a,10<a){e.timeoutHandle=Kl(_r.bind(null,e,At,En),a);break}_r(e,At,En);break;case 5:_r(e,At,En);break;default:throw Error(r(329))}}}return Ft(e,ct()),e.callbackNode===i?Gh.bind(null,e):null}function Va(e,n){var i=qs;return e.current.memoizedState.isDehydrated&&(yr(e,n).flags|=256),e=jo(e,n),e!==2&&(n=At,At=i,n!==null&&Ya(n)),e}function Ya(e){At===null?At=e:At.push.apply(At,e)}function Tg(e){for(var n=e;;){if(n.flags&16384){var i=n.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var a=0;a<i.length;a++){var u=i[a],h=u.getSnapshot;u=u.value;try{if(!on(h(),u))return!1}catch{return!1}}}if(i=n.child,n.subtreeFlags&16384&&i!==null)i.return=n,n=i;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Kn(e,n){for(n&=~Ua,n&=~wo,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var i=31-sn(n),a=1<<i;e[i]=-1,n&=~a}}function qh(e){if((Ve&6)!==0)throw Error(r(327));es();var n=Mi(e,0);if((n&1)===0)return Ft(e,ct()),null;var i=jo(e,n);if(e.tag!==0&&i===2){var a=kl(e);a!==0&&(n=a,i=Va(e,a))}if(i===1)throw i=Gs,yr(e,0),Kn(e,n),Ft(e,ct()),i;if(i===6)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,_r(e,At,En),Ft(e,ct()),null}function Qa(e,n){var i=Ve;Ve|=1;try{return e(n)}finally{Ve=i,Ve===0&&(Zr=ct()+500,Zi&&Hn())}}function vr(e){qn!==null&&qn.tag===0&&(Ve&6)===0&&es();var n=Ve;Ve|=1;var i=en.transition,a=Xe;try{if(en.transition=null,Xe=1,e)return e()}finally{Xe=a,en.transition=i,Ve=n,(Ve&6)===0&&Hn()}}function Ga(){qt=Jr.current,nt(Jr)}function yr(e,n){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,og(i)),dt!==null)for(i=dt.return;i!==null;){var a=i;switch(ra(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&Ki();break;case 3:qr(),nt(Mt),nt(jt),va();break;case 5:ga(a);break;case 4:qr();break;case 13:nt(it);break;case 19:nt(it);break;case 10:ca(a.type._context);break;case 22:case 23:Ga()}i=i.return}if(vt=e,dt=e=Jn(e.current,null),Ct=qt=n,mt=0,Gs=null,Ua=wo=xr=0,At=qs=null,pr!==null){for(n=0;n<pr.length;n++)if(i=pr[n],a=i.interleaved,a!==null){i.interleaved=null;var u=a.next,h=i.pending;if(h!==null){var m=h.next;h.next=u,a.next=m}i.pending=a}pr=null}return e}function Xh(e,n){do{var i=dt;try{if(aa(),uo.current=mo,ho){for(var a=ot.memoizedState;a!==null;){var u=a.queue;u!==null&&(u.pending=null),a=a.next}ho=!1}if(gr=0,xt=pt=ot=null,Ws=!1,Bs=0,za.current=null,i===null||i.return===null){mt=1,Gs=n,dt=null;break}e:{var h=e,m=i.return,_=i,N=n;if(n=Ct,_.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){var T=N,H=_,V=H.tag;if((H.mode&1)===0&&(V===0||V===11||V===15)){var W=H.alternate;W?(H.updateQueue=W.updateQueue,H.memoizedState=W.memoizedState,H.lanes=W.lanes):(H.updateQueue=null,H.memoizedState=null)}var oe=wh(m);if(oe!==null){oe.flags&=-257,bh(oe,m,_,h,n),oe.mode&1&&_h(h,T,n),n=oe,N=T;var fe=n.updateQueue;if(fe===null){var me=new Set;me.add(N),n.updateQueue=me}else fe.add(N);break e}else{if((n&1)===0){_h(h,T,n),qa();break e}N=Error(r(426))}}else if(st&&_.mode&1){var ut=wh(m);if(ut!==null){(ut.flags&65536)===0&&(ut.flags|=256),bh(ut,m,_,h,n),oa(Xr(N,_));break e}}h=N=Xr(N,_),mt!==4&&(mt=2),qs===null?qs=[h]:qs.push(h),h=m;do{switch(h.tag){case 3:h.flags|=65536,n&=-n,h.lanes|=n;var E=vh(h,N,n);Ud(h,E);break e;case 1:_=N;var S=h.type,I=h.stateNode;if((h.flags&128)===0&&(typeof S.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Gn===null||!Gn.has(I)))){h.flags|=65536,n&=-n,h.lanes|=n;var X=yh(h,_,n);Ud(h,X);break e}}h=h.return}while(h!==null)}Zh(i)}catch(ye){n=ye,dt===i&&i!==null&&(dt=i=i.return);continue}break}while(!0)}function Kh(){var e=_o.current;return _o.current=mo,e===null?mo:e}function qa(){(mt===0||mt===3||mt===2)&&(mt=4),vt===null||(xr&268435455)===0&&(wo&268435455)===0||Kn(vt,Ct)}function jo(e,n){var i=Ve;Ve|=2;var a=Kh();(vt!==e||Ct!==n)&&(En=null,yr(e,n));do try{Rg();break}catch(u){Xh(e,u)}while(!0);if(aa(),Ve=i,_o.current=a,dt!==null)throw Error(r(261));return vt=null,Ct=0,mt}function Rg(){for(;dt!==null;)Jh(dt)}function Lg(){for(;dt!==null&&!rm();)Jh(dt)}function Jh(e){var n=nf(e.alternate,e,qt);e.memoizedProps=e.pendingProps,n===null?Zh(e):dt=n,za.current=null}function Zh(e){var n=e;do{var i=n.alternate;if(e=n.return,(n.flags&32768)===0){if(i=kg(i,n,qt),i!==null){dt=i;return}}else{if(i=Cg(i,n),i!==null){i.flags&=32767,dt=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{mt=6,dt=null;return}}if(n=n.sibling,n!==null){dt=n;return}dt=n=e}while(n!==null);mt===0&&(mt=5)}function _r(e,n,i){var a=Xe,u=en.transition;try{en.transition=null,Xe=1,Pg(e,n,i,a)}finally{en.transition=u,Xe=a}return null}function Pg(e,n,i,a){do es();while(qn!==null);if((Ve&6)!==0)throw Error(r(327));i=e.finishedWork;var u=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var h=i.lanes|i.childLanes;if(fm(e,h),e===vt&&(dt=vt=null,Ct=0),(i.subtreeFlags&2064)===0&&(i.flags&2064)===0||No||(No=!0,rf(Ti,function(){return es(),null})),h=(i.flags&15990)!==0,(i.subtreeFlags&15990)!==0||h){h=en.transition,en.transition=null;var m=Xe;Xe=1;var _=Ve;Ve|=4,za.current=null,jg(e,i),Bh(i,e),Zm(ql),Ai=!!Gl,ql=Gl=null,e.current=i,Eg(i),sm(),Ve=_,Xe=m,en.transition=h}else e.current=i;if(No&&(No=!1,qn=e,ko=u),h=e.pendingLanes,h===0&&(Gn=null),lm(i.stateNode),Ft(e,ct()),n!==null)for(a=e.onRecoverableError,i=0;i<n.length;i++)u=n[i],a(u.value,{componentStack:u.stack,digest:u.digest});if(bo)throw bo=!1,e=Ba,Ba=null,e;return(ko&1)!==0&&e.tag!==0&&es(),h=e.pendingLanes,(h&1)!==0?e===Ha?Xs++:(Xs=0,Ha=e):Xs=0,Hn(),null}function es(){if(qn!==null){var e=zu(ko),n=en.transition,i=Xe;try{if(en.transition=null,Xe=16>e?16:e,qn===null)var a=!1;else{if(e=qn,qn=null,ko=0,(Ve&6)!==0)throw Error(r(331));var u=Ve;for(Ve|=4,de=e.current;de!==null;){var h=de,m=h.child;if((de.flags&16)!==0){var _=h.deletions;if(_!==null){for(var N=0;N<_.length;N++){var T=_[N];for(de=T;de!==null;){var H=de;switch(H.tag){case 0:case 11:case 15:Qs(8,H,h)}var V=H.child;if(V!==null)V.return=H,de=V;else for(;de!==null;){H=de;var W=H.sibling,oe=H.return;if(Fh(H),H===T){de=null;break}if(W!==null){W.return=oe,de=W;break}de=oe}}}var fe=h.alternate;if(fe!==null){var me=fe.child;if(me!==null){fe.child=null;do{var ut=me.sibling;me.sibling=null,me=ut}while(me!==null)}}de=h}}if((h.subtreeFlags&2064)!==0&&m!==null)m.return=h,de=m;else e:for(;de!==null;){if(h=de,(h.flags&2048)!==0)switch(h.tag){case 0:case 11:case 15:Qs(9,h,h.return)}var E=h.sibling;if(E!==null){E.return=h.return,de=E;break e}de=h.return}}var S=e.current;for(de=S;de!==null;){m=de;var I=m.child;if((m.subtreeFlags&2064)!==0&&I!==null)I.return=m,de=I;else e:for(m=S;de!==null;){if(_=de,(_.flags&2048)!==0)try{switch(_.tag){case 0:case 11:case 15:yo(9,_)}}catch(ye){lt(_,_.return,ye)}if(_===m){de=null;break e}var X=_.sibling;if(X!==null){X.return=_.return,de=X;break e}de=_.return}}if(Ve=u,Hn(),gn&&typeof gn.onPostCommitFiberRoot=="function")try{gn.onPostCommitFiberRoot(Ri,e)}catch{}a=!0}return a}finally{Xe=i,en.transition=n}}return!1}function ef(e,n,i){n=Xr(i,n),n=vh(e,n,1),e=Yn(e,n,1),n=Pt(),e!==null&&(_s(e,1,n),Ft(e,n))}function lt(e,n,i){if(e.tag===3)ef(e,e,i);else for(;n!==null;){if(n.tag===3){ef(n,e,i);break}else if(n.tag===1){var a=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Gn===null||!Gn.has(a))){e=Xr(i,e),e=yh(n,e,1),n=Yn(n,e,1),e=Pt(),n!==null&&(_s(n,1,e),Ft(n,e));break}}n=n.return}}function Mg(e,n,i){var a=e.pingCache;a!==null&&a.delete(n),n=Pt(),e.pingedLanes|=e.suspendedLanes&i,vt===e&&(Ct&i)===i&&(mt===4||mt===3&&(Ct&130023424)===Ct&&500>ct()-Wa?yr(e,0):Ua|=i),Ft(e,n)}function tf(e,n){n===0&&((e.mode&1)===0?n=1:(n=Pi,Pi<<=1,(Pi&130023424)===0&&(Pi=4194304)));var i=Pt();e=Cn(e,n),e!==null&&(_s(e,n,i),Ft(e,i))}function Dg(e){var n=e.memoizedState,i=0;n!==null&&(i=n.retryLane),tf(e,i)}function Og(e,n){var i=0;switch(e.tag){case 13:var a=e.stateNode,u=e.memoizedState;u!==null&&(i=u.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(r(314))}a!==null&&a.delete(n),tf(e,i)}var nf;nf=function(e,n,i){if(e!==null)if(e.memoizedProps!==n.pendingProps||Mt.current)Ot=!0;else{if((e.lanes&i)===0&&(n.flags&128)===0)return Ot=!1,Ng(e,n,i);Ot=(e.flags&131072)!==0}else Ot=!1,st&&(n.flags&1048576)!==0&&Md(n,to,n.index);switch(n.lanes=0,n.tag){case 2:var a=n.type;xo(e,n),e=n.pendingProps;var u=Wr(n,jt.current);Qr(n,i),u=wa(null,n,a,e,u,i);var h=ba();return n.flags|=1,typeof u=="object"&&u!==null&&typeof u.render=="function"&&u.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,Dt(a)?(h=!0,Ji(n)):h=!1,n.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,ha(n),u.updater=lo,n.stateNode=u,u._reactInternals=n,pa(n,a,e,i),n=Ta(null,n,a,!0,h,i)):(n.tag=0,st&&h&&na(n),Lt(null,n,u,i),n=n.child),n;case 16:a=n.elementType;e:{switch(xo(e,n),e=n.pendingProps,u=a._init,a=u(a._payload),n.type=a,u=n.tag=Fg(a),e=an(a,e),u){case 0:n=Ia(null,n,a,e,i);break e;case 1:n=Eh(null,n,a,e,i);break e;case 11:n=Nh(null,n,a,e,i);break e;case 14:n=kh(null,n,a,an(a.type,e),i);break e}throw Error(r(306,a,""))}return n;case 0:return a=n.type,u=n.pendingProps,u=n.elementType===a?u:an(a,u),Ia(e,n,a,u,i);case 1:return a=n.type,u=n.pendingProps,u=n.elementType===a?u:an(a,u),Eh(e,n,a,u,i);case 3:e:{if(Ih(n),e===null)throw Error(r(387));a=n.pendingProps,h=n.memoizedState,u=h.element,zd(e,n),oo(n,a,null,i);var m=n.memoizedState;if(a=m.element,h.isDehydrated)if(h={element:a,isDehydrated:!1,cache:m.cache,pendingSuspenseBoundaries:m.pendingSuspenseBoundaries,transitions:m.transitions},n.updateQueue.baseState=h,n.memoizedState=h,n.flags&256){u=Xr(Error(r(423)),n),n=Th(e,n,a,i,u);break e}else if(a!==u){u=Xr(Error(r(424)),n),n=Th(e,n,a,i,u);break e}else for(Gt=Un(n.stateNode.containerInfo.firstChild),Qt=n,st=!0,ln=null,i=qd(n,null,a,i),n.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Vr(),a===u){n=jn(e,n,i);break e}Lt(e,n,a,i)}n=n.child}return n;case 5:return Xd(n),e===null&&ia(n),a=n.type,u=n.pendingProps,h=e!==null?e.memoizedProps:null,m=u.children,Xl(a,u)?m=null:h!==null&&Xl(a,h)&&(n.flags|=32),jh(e,n),Lt(e,n,m,i),n.child;case 6:return e===null&&ia(n),null;case 13:return Rh(e,n,i);case 4:return ma(n,n.stateNode.containerInfo),a=n.pendingProps,e===null?n.child=Gr(n,null,a,i):Lt(e,n,a,i),n.child;case 11:return a=n.type,u=n.pendingProps,u=n.elementType===a?u:an(a,u),Nh(e,n,a,u,i);case 7:return Lt(e,n,n.pendingProps,i),n.child;case 8:return Lt(e,n,n.pendingProps.children,i),n.child;case 12:return Lt(e,n,n.pendingProps.children,i),n.child;case 10:e:{if(a=n.type._context,u=n.pendingProps,h=n.memoizedProps,m=u.value,Je(ro,a._currentValue),a._currentValue=m,h!==null)if(on(h.value,m)){if(h.children===u.children&&!Mt.current){n=jn(e,n,i);break e}}else for(h=n.child,h!==null&&(h.return=n);h!==null;){var _=h.dependencies;if(_!==null){m=h.child;for(var N=_.firstContext;N!==null;){if(N.context===a){if(h.tag===1){N=Sn(-1,i&-i),N.tag=2;var T=h.updateQueue;if(T!==null){T=T.shared;var H=T.pending;H===null?N.next=N:(N.next=H.next,H.next=N),T.pending=N}}h.lanes|=i,N=h.alternate,N!==null&&(N.lanes|=i),ua(h.return,i,n),_.lanes|=i;break}N=N.next}}else if(h.tag===10)m=h.type===n.type?null:h.child;else if(h.tag===18){if(m=h.return,m===null)throw Error(r(341));m.lanes|=i,_=m.alternate,_!==null&&(_.lanes|=i),ua(m,i,n),m=h.sibling}else m=h.child;if(m!==null)m.return=h;else for(m=h;m!==null;){if(m===n){m=null;break}if(h=m.sibling,h!==null){h.return=m.return,m=h;break}m=m.return}h=m}Lt(e,n,u.children,i),n=n.child}return n;case 9:return u=n.type,a=n.pendingProps.children,Qr(n,i),u=Jt(u),a=a(u),n.flags|=1,Lt(e,n,a,i),n.child;case 14:return a=n.type,u=an(a,n.pendingProps),u=an(a.type,u),kh(e,n,a,u,i);case 15:return Ch(e,n,n.type,n.pendingProps,i);case 17:return a=n.type,u=n.pendingProps,u=n.elementType===a?u:an(a,u),xo(e,n),n.tag=1,Dt(a)?(e=!0,Ji(n)):e=!1,Qr(n,i),Vd(n,a,u),pa(n,a,u,i),Ta(null,n,a,!0,e,i);case 19:return Ph(e,n,i);case 22:return Sh(e,n,i)}throw Error(r(156,n.tag))};function rf(e,n){return Du(e,n)}function Ag(e,n,i,a){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tn(e,n,i,a){return new Ag(e,n,i,a)}function Xa(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Fg(e){if(typeof e=="function")return Xa(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ve)return 11;if(e===Ee)return 14}return 2}function Jn(e,n){var i=e.alternate;return i===null?(i=tn(e.tag,n,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=n,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,n=e.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function Eo(e,n,i,a,u,h){var m=2;if(a=e,typeof e=="function")Xa(e)&&(m=1);else if(typeof e=="string")m=5;else e:switch(e){case M:return wr(i.children,u,h,n);case L:m=8,u|=8;break;case _e:return e=tn(12,i,n,u|2),e.elementType=_e,e.lanes=h,e;case je:return e=tn(13,i,n,u),e.elementType=je,e.lanes=h,e;case Qe:return e=tn(19,i,n,u),e.elementType=Qe,e.lanes=h,e;case ee:return Io(i,u,h,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ae:m=10;break e;case Ce:m=9;break e;case ve:m=11;break e;case Ee:m=14;break e;case Be:m=16,a=null;break e}throw Error(r(130,e==null?e:typeof e,""))}return n=tn(m,i,n,u),n.elementType=e,n.type=a,n.lanes=h,n}function wr(e,n,i,a){return e=tn(7,e,a,n),e.lanes=i,e}function Io(e,n,i,a){return e=tn(22,e,a,n),e.elementType=ee,e.lanes=i,e.stateNode={isHidden:!1},e}function Ka(e,n,i){return e=tn(6,e,null,n),e.lanes=i,e}function Ja(e,n,i){return n=tn(4,e.children!==null?e.children:[],e.key,n),n.lanes=i,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function $g(e,n,i,a,u){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cl(0),this.expirationTimes=Cl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cl(0),this.identifierPrefix=a,this.onRecoverableError=u,this.mutableSourceEagerHydrationData=null}function Za(e,n,i,a,u,h,m,_,N){return e=new $g(e,n,i,_,N),n===1?(n=1,h===!0&&(n|=8)):n=0,h=tn(3,null,null,n),e.current=h,h.stateNode=e,h.memoizedState={element:a,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},ha(h),e}function zg(e,n,i){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:K,key:a==null?null:""+a,children:e,containerInfo:n,implementation:i}}function sf(e){if(!e)return Bn;e=e._reactInternals;e:{if(cr(e)!==e||e.tag!==1)throw Error(r(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(Dt(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(r(171))}if(e.tag===1){var i=e.type;if(Dt(i))return Rd(e,i,n)}return n}function of(e,n,i,a,u,h,m,_,N){return e=Za(i,a,!0,e,u,h,m,_,N),e.context=sf(null),i=e.current,a=Pt(),u=Xn(i),h=Sn(a,u),h.callback=n??null,Yn(i,h,u),e.current.lanes=u,_s(e,u,a),Ft(e,a),e}function To(e,n,i,a){var u=n.current,h=Pt(),m=Xn(u);return i=sf(i),n.context===null?n.context=i:n.pendingContext=i,n=Sn(h,m),n.payload={element:e},a=a===void 0?null:a,a!==null&&(n.callback=a),e=Yn(u,n,m),e!==null&&(dn(e,u,m,h),io(e,u,m)),m}function Ro(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function lf(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<n?i:n}}function ec(e,n){lf(e,n),(e=e.alternate)&&lf(e,n)}function Ug(){return null}var af=typeof reportError=="function"?reportError:function(e){console.error(e)};function tc(e){this._internalRoot=e}Lo.prototype.render=tc.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(r(409));To(e,n,null,null)},Lo.prototype.unmount=tc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;vr(function(){To(null,e,null,null)}),n[wn]=null}};function Lo(e){this._internalRoot=e}Lo.prototype.unstable_scheduleHydration=function(e){if(e){var n=Bu();e={blockedOn:null,target:e,priority:n};for(var i=0;i<Fn.length&&n!==0&&n<Fn[i].priority;i++);Fn.splice(i,0,e),i===0&&Yu(e)}};function nc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Po(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function cf(){}function Wg(e,n,i,a,u){if(u){if(typeof a=="function"){var h=a;a=function(){var T=Ro(m);h.call(T)}}var m=of(n,a,e,0,null,!1,!1,"",cf);return e._reactRootContainer=m,e[wn]=m.current,Ms(e.nodeType===8?e.parentNode:e),vr(),m}for(;u=e.lastChild;)e.removeChild(u);if(typeof a=="function"){var _=a;a=function(){var T=Ro(N);_.call(T)}}var N=Za(e,0,!1,null,null,!1,!1,"",cf);return e._reactRootContainer=N,e[wn]=N.current,Ms(e.nodeType===8?e.parentNode:e),vr(function(){To(n,N,i,a)}),N}function Mo(e,n,i,a,u){var h=i._reactRootContainer;if(h){var m=h;if(typeof u=="function"){var _=u;u=function(){var N=Ro(m);_.call(N)}}To(n,m,e,u)}else m=Wg(i,n,e,u,a);return Ro(m)}Uu=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var i=ys(n.pendingLanes);i!==0&&(Sl(n,i|1),Ft(n,ct()),(Ve&6)===0&&(Zr=ct()+500,Hn()))}break;case 13:vr(function(){var a=Cn(e,1);if(a!==null){var u=Pt();dn(a,e,1,u)}}),ec(e,1)}},jl=function(e){if(e.tag===13){var n=Cn(e,134217728);if(n!==null){var i=Pt();dn(n,e,134217728,i)}ec(e,134217728)}},Wu=function(e){if(e.tag===13){var n=Xn(e),i=Cn(e,n);if(i!==null){var a=Pt();dn(i,e,n,a)}ec(e,n)}},Bu=function(){return Xe},Hu=function(e,n){var i=Xe;try{return Xe=e,n()}finally{Xe=i}},yl=function(e,n,i){switch(n){case"input":if(Ie(e,i),n=i.name,i.type==="radio"&&n!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<i.length;n++){var a=i[n];if(a!==e&&a.form===e.form){var u=Xi(a);if(!u)throw Error(r(90));Q(a),Ie(a,u)}}}break;case"textarea":J(e,i);break;case"select":n=i.value,n!=null&&b(e,!!i.multiple,n,!1)}},Eu=Qa,Iu=vr;var Bg={usingClientEntryPoint:!1,Events:[As,zr,Xi,Su,ju,Qa]},Ks={findFiberByHostInstance:ur,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Hg={bundleType:Ks.bundleType,version:Ks.version,rendererPackageName:Ks.rendererPackageName,rendererConfig:Ks.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:le.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Pu(e),e===null?null:e.stateNode},findFiberByHostInstance:Ks.findFiberByHostInstance||Ug,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Do=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Do.isDisabled&&Do.supportsFiber)try{Ri=Do.inject(Hg),gn=Do}catch{}}return $t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bg,$t.createPortal=function(e,n){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nc(n))throw Error(r(200));return zg(e,n,null,i)},$t.createRoot=function(e,n){if(!nc(e))throw Error(r(299));var i=!1,a="",u=af;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(u=n.onRecoverableError)),n=Za(e,1,!1,null,null,i,!1,a,u),e[wn]=n.current,Ms(e.nodeType===8?e.parentNode:e),new tc(n)},$t.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(r(188)):(e=Object.keys(e).join(","),Error(r(268,e)));return e=Pu(n),e=e===null?null:e.stateNode,e},$t.flushSync=function(e){return vr(e)},$t.hydrate=function(e,n,i){if(!Po(n))throw Error(r(200));return Mo(null,e,n,!0,i)},$t.hydrateRoot=function(e,n,i){if(!nc(e))throw Error(r(405));var a=i!=null&&i.hydratedSources||null,u=!1,h="",m=af;if(i!=null&&(i.unstable_strictMode===!0&&(u=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(m=i.onRecoverableError)),n=of(n,null,e,1,i??null,u,!1,h,m),e[wn]=n.current,Ms(e),a)for(e=0;e<a.length;e++)i=a[e],u=i._getVersion,u=u(i._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[i,u]:n.mutableSourceEagerHydrationData.push(i,u);return new Lo(n)},$t.render=function(e,n,i){if(!Po(n))throw Error(r(200));return Mo(null,e,n,!1,i)},$t.unmountComponentAtNode=function(e){if(!Po(e))throw Error(r(40));return e._reactRootContainer?(vr(function(){Mo(null,null,e,!1,function(){e._reactRootContainer=null,e[wn]=null})}),!0):!1},$t.unstable_batchedUpdates=Qa,$t.unstable_renderSubtreeIntoContainer=function(e,n,i,a){if(!Po(i))throw Error(r(200));if(e==null||e._reactInternals===void 0)throw Error(r(38));return Mo(e,n,i,!1,a)},$t.version="18.2.0-next-9e3b772b8-20220608",$t}var xf;function Jg(){if(xf)return ic.exports;xf=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),ic.exports=Kg(),ic.exports}var vf;function Zg(){if(vf)return Oo;vf=1;var s=Jg();return Oo.createRoot=s.createRoot,Oo.hydrateRoot=s.hydrateRoot,Oo}var ex=Zg();const tx=_p(ex),nx=({children:s,activeTab:t,setActiveTab:r,isAdmin:o,onToggleAdmin:c,onDownloadDB:d,onUploadDB:f,onOpenSync:p,isSyncActive:g})=>{const x=F.useRef(null),C=[{id:"characters",label:"",icon:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})},{id:"connections",label:"",icon:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})},{id:"worlds",label:"",icon:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})},{id:"notes",label:"",icon:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})},{id:"admin",label:"",adminOnly:!0,icon:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"})}],y=k=>{var ne;const D=(ne=k.target.files)==null?void 0:ne[0];if(!D)return;const B=new FileReader;B.onload=ce=>{var ke;const ie=(ke=ce.target)==null?void 0:ke.result;typeof ie=="string"&&f(ie)},B.readAsText(D),x.current&&(x.current.value="")},v=()=>t==="notes"?"max-w-[1920px] w-full px-4 md:px-8":"max-w-6xl w-full px-4 py-8 md:px-12 md:py-12";return l.jsxs("div",{className:"min-h-screen flex flex-col md:flex-row bg-[#050505] text-stone-300",children:[l.jsxs("div",{className:"md:hidden flex items-center justify-between px-6 py-5 border-b border-stone-900 bg-[#050505]/95 backdrop-blur sticky top-0 z-40",children:[l.jsx("h1",{className:"text-lg font-serif font-bold tracking-[0.2em] text-stone-400 uppercase",children:""}),l.jsx("button",{onClick:c,className:`p-2 rounded-lg transition-all border ${o?"bg-emerald-950/20 border-emerald-900/50 text-emerald-500":"bg-stone-900/50 border-stone-800 text-stone-500"}`,children:l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})]}),l.jsxs("aside",{className:"hidden md:flex w-64 border-r border-stone-900 flex-col fixed h-screen bg-[#050505] z-50",children:[l.jsx("div",{className:"p-8",children:l.jsx("h1",{className:"text-xl font-serif font-bold tracking-[0.2em] text-stone-400 uppercase",children:""})}),l.jsx("nav",{className:"flex-grow px-4 space-y-2",children:C.filter(k=>!k.adminOnly||o).map(k=>l.jsxs("button",{onClick:()=>r(k.id),className:`w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all flex items-center gap-3 ${t===k.id?"bg-stone-900 text-stone-100 border-l-2 border-emerald-500 rounded-l-none":"hover:bg-stone-900/50 text-stone-500 hover:text-stone-300"} ${k.adminOnly?"text-emerald-500/70":""}`,children:[l.jsx("svg",{className:"w-5 h-5 opacity-70",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:k.icon}),k.label]},k.id))}),l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsxs("button",{onClick:p,className:`w-full py-2 px-3 rounded-lg border text-[9px] uppercase tracking-widest font-bold flex items-center justify-center gap-2 transition-all ${g?"bg-emerald-900/10 border-emerald-500/30 text-emerald-500 hover:bg-emerald-900/20":"bg-stone-900/30 border-stone-800 text-stone-600 hover:bg-stone-900/60 hover:text-stone-400"}`,children:[l.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${g?"bg-emerald-500 animate-pulse":"bg-stone-600"}`}),g?"":""]}),l.jsx("button",{onClick:c,className:`w-full py-3 text-[10px] uppercase tracking-widest font-bold rounded-md transition-all border ${o?"bg-emerald-950/20 border-emerald-900/50 text-emerald-500 shadow-lg shadow-emerald-900/10":"bg-stone-900/50 hover:bg-stone-900 border-stone-800 text-stone-400"}`,children:o?" ()":"  "})]})]}),l.jsx("nav",{className:"md:hidden fixed bottom-0 w-full bg-[#050505]/95 backdrop-blur-xl border-t border-stone-900 z-50 px-2 pb-safe-area",children:l.jsxs("div",{className:"flex justify-around items-center",children:[C.filter(k=>!k.adminOnly||o).map(k=>l.jsxs("button",{onClick:()=>r(k.id),className:`flex flex-col items-center justify-center py-3 px-2 w-full transition-all ${t===k.id?"text-emerald-500":"text-stone-600"}`,children:[l.jsx("svg",{className:"w-6 h-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:k.icon}),l.jsx("span",{className:"text-[9px] uppercase font-bold tracking-wider",children:k.label})]},k.id)),l.jsxs("button",{onClick:p,className:`flex flex-col items-center justify-center py-3 px-2 w-full transition-all ${g?"text-emerald-500":"text-stone-700"}`,children:[l.jsx("svg",{className:"w-6 h-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),l.jsx("span",{className:"text-[9px] uppercase font-bold tracking-wider",children:""})]})]})}),l.jsxs("main",{className:"flex-grow md:ml-64 min-h-screen relative pb-24 md:pb-0",children:[l.jsx("div",{className:`${v()} mx-auto transition-all duration-300 py-8 md:py-12`,children:s}),l.jsxs("div",{className:"fixed bottom-24 md:bottom-8 right-4 md:right-8 flex gap-3 z-40 scale-90 md:scale-100 origin-bottom-right",children:[l.jsx("input",{type:"file",ref:x,onChange:y,accept:".json",className:"hidden"}),l.jsx("button",{onClick:()=>{var k;return(k=x.current)==null?void 0:k.click()},className:"px-4 py-2 md:px-5 md:py-2.5 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 rounded-full text-[9px] md:text-[10px] uppercase tracking-widest font-bold text-emerald-500 transition-all backdrop-blur-sm shadow-lg shadow-emerald-900/10",children:" "}),l.jsx("button",{onClick:d,className:"px-4 py-2 md:px-5 md:py-2.5 bg-stone-900/80 hover:bg-stone-800 border border-stone-700 rounded-full text-[9px] md:text-[10px] uppercase tracking-widest font-bold text-stone-300 transition-all backdrop-blur-sm",children:" "})]})]})]})},rx=({character:s,isVisible:t=!0,staggerIndex:r=0,onClick:o})=>{const c=F.useRef(null),[d,f]=F.useState({x:0,y:0}),[p,g]=F.useState({x:50,y:50,opacity:0}),[x,C]=F.useState(!1),[y,v]=F.useState(!1),k=F.useMemo(()=>Array.from({length:8}).map((M,L)=>({id:L,left:`${Math.random()*100}%`,delay:`${Math.random()*.6}s`,duration:`${1+Math.random()}s`,size:`${1.5+Math.random()*2}px`})),[]),D=M=>{if(!c.current||!t)return;const L=c.current.getBoundingClientRect(),_e=L.left+L.width/2,ae=L.top+L.height/2,Ce=-(M.clientY-ae)/(L.height/2)*12,ve=(M.clientX-_e)/(L.width/2)*12,je=(M.clientX-L.left)/L.width*100,Qe=(M.clientY-L.top)/L.height*100;f({x:Ce,y:ve}),g({x:je,y:Qe,opacity:.5})},B=()=>t&&C(!0),ne=()=>{f({x:0,y:0}),g(M=>({...M,opacity:0})),C(!1),v(!1)},ce={objectFit:"cover",objectPosition:`${s.miniImageX??50}% ${s.miniImageY??50}%`,transformOrigin:`${s.miniImageX??50}% ${s.miniImageY??50}%`,transform:`scale(${s.miniImageScale??1})`},ie=s.name.length,ke=ie>20?"text-sm":ie>15?"text-base":"text-xl",le=x?`${-d.y*2.5}px ${d.x*2.5}px 50px -10px rgba(16, 185, 129, 0.3)`:"0 10px 15px -3px rgba(0, 0, 0, 0.1)",Oe=t?`${Math.min(r*45,900)}ms`:"0ms",K=y?.96:x?1.04:1;return l.jsx("div",{className:`relative mb-10 px-5 w-full sm:w-1/2 lg:w-1/4 perspective-2000 preserve-3d transition-opacity duration-500 ${t?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,style:{animation:t?"reveal-3d-fire 1.1s cubic-bezier(0.22, 1, 0.36, 1) both":"disappear-3d-fire 0.6s cubic-bezier(0.22, 1, 0.36, 1) both",animationDelay:t?Oe:"0ms"},children:l.jsxs("div",{className:"h-full relative preserve-3d pointer-events-none",children:[t&&k.map(M=>l.jsx("div",{className:"absolute bottom-4 bg-emerald-400 rounded-full blur-[0.5px] z-0 pointer-events-none",style:{left:M.left,width:M.size,height:M.size,animation:`ember-float ${M.duration} ease-out both`,animationDelay:`calc(${Oe} + ${M.delay})`,boxShadow:"0 0 6px #10b981"}},M.id)),l.jsx("div",{className:"absolute inset-0 bg-emerald-500/20 blur-[60px] rounded-full transition-opacity duration-700 pointer-events-none -z-10",style:{opacity:x?.45:0,transform:`translate3d(${-d.y*4}px, ${d.x*4}px, -50px) scale(${x?1.1:1})`}}),l.jsxs("div",{ref:c,onMouseMove:D,onMouseEnter:B,onMouseLeave:ne,onMouseDown:()=>t&&v(!0),onMouseUp:()=>v(!1),onClick:()=>t&&o(s.id),style:{transform:`rotateX(${d.x}deg) rotateY(${d.y}deg) scale(${K})`,boxShadow:le,transition:x&&!y?"transform 0.1s ease-out, box-shadow 0.1s ease-out":"transform 0.7s cubic-bezier(0.23, 1, 0.32, 1), box-shadow 0.7s ease"},className:"relative bg-[#0f0f0f]/80 border border-stone-900 rounded-2xl p-6 flex flex-col items-center group cursor-pointer h-full min-h-[320px] preserve-3d overflow-hidden backdrop-blur-sm pointer-events-auto z-10",children:[l.jsx("div",{className:"absolute inset-0 pointer-events-none z-20 transition-opacity duration-300",style:{background:`radial-gradient(circle at ${p.x}% ${p.y}%, rgba(255,255,255,0.12) 0%, transparent 60%)`,opacity:p.opacity}}),l.jsx("div",{className:`absolute inset-0 border border-emerald-500/20 rounded-2xl transition-opacity duration-500 pointer-events-none ${x?"opacity-100":"opacity-0"}`}),l.jsx("div",{className:"relative mt-2 shrink-0 translate-z-30 pointer-events-none",children:l.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden border-2 border-stone-800 group-hover:border-emerald-500/50 transition-all duration-500 bg-black shadow-2xl",children:l.jsx("img",{src:s.imageUrl,alt:s.name,style:ce,className:"w-full h-full opacity-80 group-hover:opacity-100 transition-all duration-700 group-hover:scale-110"})})}),l.jsxs("div",{className:"mt-6 flex flex-col items-center justify-center w-full px-2 shrink-0 translate-z-20 pointer-events-none",children:[l.jsx("h3",{className:`font-serif font-medium text-stone-100 group-hover:text-emerald-100 transition-colors text-center leading-tight line-clamp-1 ${ke}`,children:s.name}),l.jsxs("div",{className:"flex items-center gap-1.5 mt-3",children:[s.age&&l.jsxs("div",{className:"bg-stone-900/60 border border-stone-800 px-2.5 py-1 rounded-lg flex items-baseline gap-1 shadow-inner",children:[l.jsx("span",{className:"text-[11px] font-bold text-stone-300 tracking-tight",children:s.age.toString().replace(/[^0-9]/g,"")||s.age}),l.jsx("span",{className:"text-[7px] font-black uppercase tracking-widest text-emerald-600/80",children:""})]}),s.height&&l.jsxs("div",{className:"bg-stone-900/60 border border-stone-800 px-2.5 py-1 rounded-lg flex items-baseline gap-1 shadow-inner",children:[l.jsx("span",{className:"text-[11px] font-bold text-stone-300 tracking-tight",children:s.height.toString().replace(/[^0-9]/g,"")||s.height}),l.jsx("span",{className:"text-[7px] font-black uppercase tracking-widest text-emerald-600/80",children:""})]})]})]}),l.jsx("div",{className:"mt-5 flex flex-wrap gap-1.5 justify-center content-start min-h-[28px] w-full px-1 translate-z-10 pointer-events-none",children:s.tags&&s.tags.length>0?l.jsx(l.Fragment,{children:s.tags.slice(0,3).map(M=>l.jsx("span",{className:"px-2 py-0.5 bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 text-[8px] uppercase tracking-wider font-black rounded-md whitespace-nowrap",children:M},M))}):l.jsx("div",{className:"h-4"})}),l.jsx("div",{className:"mt-auto pt-6 border-t border-stone-900/50 w-full flex justify-center shrink-0 translate-z-10 pointer-events-none",children:l.jsx("span",{className:"text-[8px] uppercase tracking-[0.3em] font-black text-stone-700 group-hover:text-emerald-500 transition-colors",children:" "})})]})]})})},sx=wp.memo(rx,(s,t)=>s.character.id===t.character.id&&JSON.stringify(s.character)===JSON.stringify(t.character)&&s.isVisible===t.isVisible&&s.staggerIndex===t.staggerIndex),_c=({imageUrl:s,scale:t,x:r,y:o,isCircular:c=!1,aspectRatio:d,onUpdate:f})=>{const p=F.useRef(null),[g,x]=F.useState(!1),[C,y]=F.useState({x:0,y:0}),v=k=>{x(!0),y({x:k.clientX,y:k.clientY})};return F.useEffect(()=>{const k=B=>{if(!g||!p.current)return;const ne=B.clientX-C.x,ce=B.clientY-C.y,ie=.2,ke=Math.max(t,.1),le=r-ne*ie/ke,Oe=o-ce*ie/ke;f({x:le,y:Oe}),y({x:B.clientX,y:B.clientY})},D=()=>x(!1);return g&&(window.addEventListener("mousemove",k),window.addEventListener("mouseup",D)),()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",D)}},[g,C,r,o,t,f]),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{ref:p,className:`relative overflow-hidden bg-black border border-stone-800 cursor-move group select-none shadow-2xl transition-all duration-500 hover:border-emerald-500/40 ${c?"w-48 h-48 rounded-full mx-auto":"rounded-3xl w-full"} ${!c&&!d?"aspect-[4/5]":""}`,style:!c&&d?{aspectRatio:d}:{},onMouseDown:v,children:[l.jsx("img",{src:s,alt:"",draggable:!1,style:{width:"100%",height:"100%",objectFit:"cover",objectPosition:`${r}% ${o}%`,transformOrigin:`${r}% ${o}%`,transform:`scale(${t})`},className:"pointer-events-none transition-opacity duration-300 opacity-90 group-hover:opacity-100"}),l.jsx("div",{className:"absolute inset-0 ring-1 ring-inset ring-white/5 pointer-events-none"}),l.jsx("div",{className:"absolute inset-0 bg-emerald-500/5 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity flex items-center justify-center",children:l.jsx("div",{className:"bg-black/60 backdrop-blur-md px-4 py-2 rounded-full border border-emerald-500/20",children:l.jsx("span",{className:"text-[9px] font-black text-emerald-400 uppercase tracking-[0.25em]",children:" "})})})]}),l.jsxs("div",{className:"bg-stone-900/60 p-4 rounded-2xl border border-stone-800/50 space-y-3 shadow-inner",children:[l.jsxs("div",{className:"flex justify-between items-center px-1",children:[l.jsx("span",{className:"text-[10px] font-black text-stone-500 uppercase tracking-widest",children:""}),l.jsxs("span",{className:"text-[10px] font-mono text-emerald-500 bg-emerald-500/10 px-2 py-0.5 rounded",children:[t.toFixed(2),"x"]})]}),l.jsx("div",{onMouseDown:k=>k.stopPropagation(),children:l.jsx("input",{type:"range",min:"0.1",max:"3",step:"0.05",value:t,onChange:k=>f({scale:parseFloat(k.target.value)}),className:"w-full h-1.5 bg-stone-800 rounded-full appearance-none cursor-pointer accent-emerald-500"})}),l.jsx("p",{className:"text-[8px] text-stone-700 text-center uppercase tracking-tighter",children:"      "})]})]})},zo=(s,t=800,r=.6)=>new Promise((o,c)=>{const d=new FileReader;d.readAsDataURL(s),d.onload=f=>{var g;const p=new Image;p.src=(g=f.target)==null?void 0:g.result,p.onload=()=>{const x=document.createElement("canvas");let C=p.width,y=p.height;C>t&&(y=y*t/C,C=t),x.width=C,x.height=y;const v=x.getContext("2d");if(v){v.drawImage(p,0,0,C,y);const k=x.toDataURL("image/jpeg",r);o(k)}else c(new Error("Canvas context not available"))},p.onerror=x=>c(x)},d.onerror=f=>c(f)}),ix=[{label:"16:9",value:16/9,str:"16/9",icon:"M4 6h16M4 18h16M4 6v12M20 6v12"},{label:"4:3",value:4/3,str:"4/3",icon:"M5 6h14M5 18h14M5 6v12M19 6v12"},{label:"1:1",value:1,str:"1/1",icon:"M5 5h14v14H5z"},{label:"3:4",value:3/4,str:"3/4",icon:"M6 5h12M6 19h12M6 5v14M18 5v14"},{label:"9:16",value:9/16,str:"9/16",icon:"M6 4h12M6 20h12M6 4v16M18 4v16"}],nn=(s,t,r,o,c)=>{if(!s)return null;const d=/(\*\*.*?\*\*|__.*?__|~~.*?~~|\|\|.*?\|\||\[c=#[0-9a-fA-F]{3,6}\].*?\[\/c\]|\[link=.*?\].*?\[\/link\]|\[tip=.*?\].*?\[\/tip\]|\[quote=.*?\].*?\[\/quote\]|\[char=.*?\].*?\[\/char\]|\[img .*?\])/g;return s.split(d).map((p,g)=>{if(p.startsWith("**")&&p.endsWith("**")&&p.length>4)return l.jsx("strong",{className:"text-stone-100 font-bold",children:nn(p.slice(2,-2),t,r,o,c)},g);if(p.startsWith("__")&&p.endsWith("__")&&p.length>4)return l.jsx("em",{className:"text-stone-300 italic font-light",children:nn(p.slice(2,-2),t,r,o,c)},g);if(p.startsWith("~~")&&p.endsWith("~~")&&p.length>4)return l.jsx("span",{className:"line-through opacity-60 decoration-stone-500",children:nn(p.slice(2,-2),t,r,o,c)},g);if(p.startsWith("||")&&p.endsWith("||")&&p.length>4)return l.jsxs("span",{className:"group/spoiler relative cursor-help rounded bg-stone-800 px-1 py-0.5 mx-0.5 align-middle select-none transition-all hover:bg-stone-700",children:[l.jsx("span",{className:"opacity-0 group-hover/spoiler:opacity-100 transition-opacity duration-300 text-stone-200",children:nn(p.slice(2,-2),t,r,o,c)}),l.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-[9px] uppercase font-black tracking-widest text-stone-500 group-hover/spoiler:opacity-0 pointer-events-none transition-opacity",children:""})]},g);if(p.startsWith("[c=")&&p.endsWith("[/c]")){const x=p.match(/\[c=(#[0-9a-fA-F]{3,6})\](.*?)\[\/c\]/);if(x)return l.jsx("span",{style:{color:x[1]},className:"font-medium drop-shadow-sm",children:nn(x[2],t,r,o,c)},g)}if(p.startsWith("[link=")&&p.endsWith("[/link]")){const x=p.match(/\[link=(.*?)\](.*?)\[\/link\]/);if(x)return l.jsx("a",{href:x[1],target:"_blank",rel:"noopener noreferrer",className:"text-emerald-400 hover:text-emerald-300 hover:underline decoration-emerald-500/50 underline-offset-2 transition-colors cursor-pointer",onClick:C=>C.stopPropagation(),children:nn(x[2],t,r,o,c)},g)}if(p.startsWith("[char=")&&p.endsWith("[/char]")){const x=p.match(/\[char=(.*?)\](.*?)\[\/char\]/);if(x){const C=x[1],y=x[2];return l.jsxs("span",{onClick:v=>{v.stopPropagation(),r&&r(C)},className:"inline-flex items-center gap-1 text-amber-400 hover:text-amber-200 cursor-pointer transition-colors border-b border-amber-500/30 hover:border-amber-400 px-0.5 rounded hover:bg-amber-900/20 group/char",title:"  ",children:[l.jsx("svg",{className:"w-3 h-3 opacity-50 group-hover/char:opacity-100 transition-opacity",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),nn(y,t,r,o,c)]},g)}}if(p.startsWith("[tip=")&&p.endsWith("[/tip]")){const x=p.match(/\[tip=(.*?)\](.*?)\[\/tip\]/);if(x)return l.jsxs("span",{className:"relative group/tooltip cursor-help border-b border-dotted border-stone-500 hover:border-emerald-500 transition-colors inline-block leading-tight",children:[nn(x[2],t,r,o,c),l.jsxs("span",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-max max-w-[200px] p-2 bg-[#1a1a1a] border border-stone-700 rounded-lg text-xs text-stone-300 opacity-0 group-hover/tooltip:opacity-100 transition-opacity duration-200 pointer-events-none z-50 shadow-xl text-center whitespace-normal leading-tight",children:[x[1],l.jsx("span",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-stone-700"})]})]},g)}if(p.startsWith("[quote=")&&p.endsWith("[/quote]")){const x=p.match(/\[quote=(.*?)\](.*?)\[\/quote\]/);if(x){const C=x[1],y=x[2],v=t==null?void 0:t.find(k=>k.id===C);return l.jsxs("div",{className:"my-4 border-l-2 border-emerald-500/40 bg-stone-900/20 pl-4 py-3 rounded-r-lg group/quote transition-colors hover:border-emerald-500/60",children:[l.jsx("div",{className:`text-[10px] uppercase font-black text-emerald-500 mb-2 tracking-widest opacity-80 group-hover/quote:opacity-100 transition-opacity flex items-center gap-2 ${v?"cursor-pointer hover:text-emerald-300":""}`,onClick:k=>{v&&r&&(k.stopPropagation(),r(v.id))},children:v?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-5 h-5 rounded-full overflow-hidden border border-emerald-500/30 bg-black shrink-0",children:l.jsx("img",{src:v.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${v.miniImageX??50}% ${v.miniImageY??50}%`,transform:`scale(${v.miniImageScale??1})`,transformOrigin:`${v.miniImageX??50}% ${v.miniImageY??50}%`}})}),l.jsx("span",{children:v.name})]}):l.jsxs(l.Fragment,{children:[l.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M14.017 21L14.017 18C14.017 16.896 14.321 16.067 14.929 15.513C15.537 14.959 16.485 14.682 17.773 14.682V14.128C17.773 13.068 17.411 12.152 16.687 11.38C15.963 10.608 14.887 10.222 13.459 10.222V4.99998C15.827 4.99998 17.754 5.75398 19.24 7.26198C20.726 8.76998 21.469 10.871 21.469 13.565V21H14.017ZM2.53699 21L2.53699 18C2.53699 16.896 2.84099 16.067 3.44899 15.513C4.05699 14.959 5.00499 14.682 6.29299 14.682V14.128C6.29299 13.068 5.93099 12.152 5.20699 11.38C4.48299 10.608 3.40699 10.222 1.97899 10.222V4.99998C4.34699 4.99998 6.27399 5.75398 7.75999 7.26198C9.24599 8.76998 9.98899 10.871 9.98899 13.565V21H2.53699Z"})}),l.jsx("span",{children:C})]})}),l.jsx("div",{className:"italic text-stone-300 font-serif text-lg leading-relaxed",children:nn(y,t,r,o,c)})]},g)}}if(p.startsWith("[img ")&&p.endsWith("]")){const x=p.slice(5,-1),C=x.match(/src=(.*?)(\s|$)/),y=x.match(/w=(\d+)/),v=x.match(/a=(left|center|right)/),k=x.match(/x=(\d+(\.\d+)?)/),D=x.match(/y=(\d+(\.\d+)?)/),B=x.match(/s=(\d+(\.\d+)?)/),ne=x.match(/ar=(\d+\/\d+)/),ce=C?C[1]:"",ie=y?parseInt(y[1]):100,ke=v?v[1]:"center",le=k?parseFloat(k[1]):50,Oe=D?parseFloat(D[1]):50,K=B?parseFloat(B[1]):1,M=ne?ne[1]:"16/9",[L,_e]=M.split("/").map(Number),ae=_e&&L?_e/L*100:56.25;if(ce){const Ce=!!o;return l.jsx("span",{className:`block w-full my-4 flex ${ke==="center"?"justify-center":ke==="right"?"justify-end":"justify-start"}`,children:l.jsxs("div",{className:`relative rounded-lg shadow-lg border border-stone-800/50 overflow-hidden group/img transition-all ${Ce?"hover:scale-[1.01] hover:border-emerald-500/30":"cursor-zoom-in hover:shadow-emerald-900/20"}`,style:{width:`${ie}%`},onClick:ve=>{ve.stopPropagation(),o?o({url:ce,width:ie,align:ke,x:le,y:Oe,scale:K,aspectRatioStr:M,originalTag:p}):c&&c(ce)},children:[l.jsx("div",{style:{paddingTop:`${ae}%`,position:"relative"},children:l.jsx("img",{src:ce,alt:"User content",className:"absolute inset-0 w-full h-full object-cover",style:{objectPosition:`${le}% ${Oe}%`,transformOrigin:`${le}% ${Oe}%`,transform:`scale(${K})`}})}),o&&l.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover/img:opacity-100 flex items-center justify-center transition-opacity cursor-pointer z-10",children:l.jsxs("span",{className:"bg-black/60 backdrop-blur px-3 py-1.5 rounded-full text-[10px] uppercase font-bold text-emerald-400 border border-emerald-500/30 flex items-center gap-2",children:[l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),""]})})]})},g)}}return p})},wc=(s,t,r,o,c)=>s?s.split(`
`).map((f,p)=>{const g=f.trim();return g?g==="---"?l.jsx("div",{className:"h-px w-full bg-gradient-to-r from-stone-400 to-transparent my-8 opacity-80 shadow-[0_0_10px_rgba(168,162,158,0.2)]"},p):g.startsWith("# ")?l.jsx("h3",{className:"text-xl md:text-2xl font-serif text-emerald-100 border-b border-stone-800/60 pb-2 mb-3 mt-6 first:mt-0 italic",children:nn(g.slice(2),c,t,r,o)},p):g.startsWith("> ")?l.jsx("blockquote",{className:"border-l-2 border-emerald-500/40 bg-stone-900/20 pl-4 py-2 my-2 rounded-r-lg italic text-stone-400",children:nn(g.slice(2),c,t,r,o)},p):l.jsx("div",{className:"min-h-[1.5em] text-stone-300 leading-relaxed font-serif text-base md:text-lg break-words",children:nn(f,c,t,r,o)},p):l.jsx("div",{className:"h-4"},p)}):null,ox=({notes:s,characters:t,availableTags:r,availableHiddenTags:o,onUpdate:c,isAdmin:d,onSelectCharacter:f})=>{var $e,Me;const[p,g]=F.useState("list"),[x,C]=F.useState(null),[y,v]=F.useState(new Set),[k,D]=F.useState({}),[B,ne]=F.useState(""),[ce,ie]=F.useState(!1),[ke,le]=F.useState("#10b981"),[Oe,K]=F.useState(!1),[M,L]=F.useState(!1),[_e,ae]=F.useState(""),[Ce,ve]=F.useState([]),[je,Qe]=F.useState(!1),[Ee,Be]=F.useState({url:"",width:100,align:"center",x:50,y:50,scale:1,aspectRatioStr:"16/9"}),[ee,Y]=F.useState(!1),[q,w]=F.useState(!1),[$,te]=F.useState(null),he=F.useRef(null);F.useEffect(()=>{p!=="list"&&window.scrollTo({top:0,behavior:"smooth"})},[p]);const O=b=>{p==="editor"&&(Be(b),Qe(!0))},A=()=>{const b=`[img src=${Ee.url} w=${Ee.width} a=${Ee.align} x=${Ee.x.toFixed(0)} y=${Ee.y.toFixed(0)} s=${Ee.scale.toFixed(2)} ar=${Ee.aspectRatioStr}]`;if(Ee.originalTag){const re=(k.content||"").replace(Ee.originalTag,b);D({...k,content:re})}else U(b,"");Qe(!1),Be({url:"",width:100,align:"center",x:50,y:50,scale:1,aspectRatioStr:"16/9"})},U=(b,re)=>{if(!he.current&&!Ee.originalTag)return;if(!he.current){const De=k.content||"";D({...k,content:De+b+re});return}const P=he.current.selectionStart,J=he.current.selectionEnd,ue=k.content||"",G=ue.substring(0,P),z=ue.substring(P,J),pe=ue.substring(J),Re=G+b+z+re+pe;D({...k,content:Re}),setTimeout(()=>{if(he.current){ee||he.current.focus({preventScroll:!0});const De=z.length>0?P+b.length+z.length+re.length:P+b.length;he.current.setSelectionRange(De,De)}},0)},we=b=>{if(!he.current)return;const re=he.current.selectionStart,P=he.current.selectionEnd,J=k.content||"",ue=J.substring(0,re),G=J.substring(re,P),z=J.substring(P),pe=G.length>0?G:b.name,Re=`${ue}[char=${b.id}]${pe}[/char]${z}`;D({...k,content:Re}),K(!1),ae(""),ve([]),setTimeout(()=>{if(he.current){ee||he.current.focus({preventScroll:!0});const De=re+`[char=${b.id}]${pe}[/char]`.length;he.current.setSelectionRange(De,De)}},0)},Se=b=>{U(`[quote=${b.id}]`,"[/quote]"),L(!1),ae(""),ve([])};F.useEffect(()=>{if(he.current&&p==="editor"&&!ee&&!q){const b=window.scrollY;he.current.style.height="auto",he.current.style.height=`${he.current.scrollHeight}px`,window.scrollY!==b&&window.scrollTo({top:b,behavior:"instant"})}},[k.content,p,ee,q]);const qe=b=>{v(re=>{const P=new Set(re);return P.has(b)?P.delete(b):P.add(b),P})},ft=b=>{b?(C(b.id),D({...b})):(C(null),D({title:"",content:""})),g("editor"),ne(""),ie(!1),K(!1),L(!1),Qe(!1),Be({url:"",width:100,align:"center",x:50,y:50,scale:1,aspectRatioStr:"16/9"}),Y(!1),w(!1)},R=()=>{g("list"),C(null),D({})},Q=()=>{if(!(!k.title||!k.content)){if(x){const b=s.map(re=>re.id===x?{...re,...k}:re);c(b)}else{const b={id:Date.now().toString(),title:k.title||"",content:k.content||"",date:new Date().toLocaleDateString("ru-RU"),authorId:k.authorId,targetId:k.targetId};c([b,...s])}R()}},ge=()=>{if(x&&window.confirm("     ?")){const b=s.filter(re=>re.id!==x);c(b),R()}},j=b=>t.find(re=>re&&re.id===b),se=F.useMemo(()=>t.filter(b=>b.name.toLowerCase().includes(B.toLowerCase())).sort((b,re)=>b.name.localeCompare(re.name)),[t,B]),xe=F.useMemo(()=>t.filter(b=>{const re=b.name.toLowerCase().includes(_e.toLowerCase()),P=Ce.length===0||Ce.every(J=>(b.tags||[]).includes(J)||(b.hiddenTags||[]).includes(J));return re&&P}).sort((b,re)=>b.name.localeCompare(re.name)),[t,_e,Ce]),Ie=b=>{ve(re=>re.includes(b)?re.filter(P=>P!==b):[...re,b])},Te=b=>{const[re,P]=b.split("/").map(Number);return re&&P?re/P:16/9};return p==="list"?l.jsxs("div",{className:"space-y-12 animate-in fade-in duration-500 w-full mx-auto pb-20",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-b border-stone-900/50 pb-8",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100 italic",children:""}),l.jsx("p",{className:"text-stone-500 uppercase tracking-[0.3em] text-[9px] font-black",children:"   "})]}),d&&l.jsxs("button",{onClick:()=>ft(),className:"group relative bg-white hover:bg-emerald-50 text-black px-8 py-4 rounded-2xl text-[10px] uppercase tracking-[0.2em] font-black transition-all shadow-xl hover:shadow-emerald-500/10 flex items-center gap-3 overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})," "]})]}),l.jsx("div",{className:"space-y-6",children:s.length===0?l.jsxs("div",{className:"py-32 text-center animate-slide-up-fade",style:{animationDelay:"100ms"},children:[l.jsx("div",{className:"w-16 h-16 bg-stone-900/20 rounded-full flex items-center justify-center mx-auto mb-6 border border-stone-800/50",children:l.jsx("svg",{className:"w-8 h-8 text-stone-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),l.jsx("p",{className:"text-stone-700 italic font-serif text-lg",children:" ,   .    ."})]}):s.map((b,re)=>{const P=j(b.authorId),J=j(b.targetId),ue=y.has(b.id);return l.jsxs("article",{style:{animationDelay:`${re*100}ms`},className:`relative group bg-[#0a0a0a] border rounded-3xl p-6 md:p-8 transition-all duration-500 shadow-2xl overflow-hidden animate-slide-up-fade ${ue?"border-emerald-900/40 bg-stone-950/80":"border-stone-900/60 hover:border-emerald-900/30"}`,children:[l.jsx("div",{className:`absolute top-0 right-0 w-64 h-64 bg-emerald-500/5 rounded-full blur-[100px] -translate-y-32 translate-x-32 pointer-events-none transition-opacity duration-700 ${ue?"opacity-100":"opacity-0 group-hover:opacity-50"}`}),l.jsxs("div",{className:"relative z-10",children:[l.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6",children:[l.jsx("div",{className:"flex items-center gap-3",children:P?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-10 h-10 rounded-full border border-stone-800 overflow-hidden bg-black shrink-0",children:l.jsx("img",{src:P.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${P.miniImageX??50}% ${P.miniImageY??50}%`,transformOrigin:`${P.miniImageX??50}% ${P.miniImageY??50}%`,transform:`scale(${P.miniImageScale??1})`}})}),l.jsx("span",{className:"text-[10px] uppercase tracking-widest font-black text-stone-200",children:P.name})]}):l.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-stone-700 bg-stone-900/50 px-3 py-1.5 rounded-lg",children:" "})}),l.jsx("div",{className:"h-px w-6 bg-stone-900"}),l.jsx("div",{className:"flex items-center gap-3",children:J?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-emerald-500/60",children:":"}),l.jsx("div",{className:"w-10 h-10 rounded-full border border-emerald-900/20 overflow-hidden bg-black shrink-0",children:l.jsx("img",{src:J.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${J.miniImageX??50}% ${J.miniImageY??50}%`,transformOrigin:`${J.miniImageX??50}% ${J.miniImageY??50}%`,transform:`scale(${J.miniImageScale??1})`}})}),l.jsx("span",{className:"text-[10px] uppercase tracking-widest font-black text-emerald-400",children:J.name})]}):l.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-stone-700",children:""})}),l.jsx("div",{className:"ml-auto text-[9px] font-black text-stone-800 uppercase tracking-[0.2em]",children:b.date})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("h3",{className:`font-serif font-bold transition-all duration-500 drop-shadow-md italic break-words ${ue?"text-2xl md:text-3xl text-emerald-100 mb-6":"text-xl text-stone-300 group-hover:text-emerald-200"}`,children:b.title}),!ue&&l.jsxs("button",{onClick:()=>qe(b.id),className:"text-[10px] uppercase tracking-[0.2em] font-black text-stone-600 hover:text-emerald-500 transition-colors pt-4 flex items-center gap-2 outline-none group/btn animate-in fade-in duration-500",children:[l.jsx("span",{children:""}),l.jsx("svg",{className:"w-3 h-3 transition-transform group-hover/btn:translate-y-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),l.jsx("div",{className:`grid transition-[grid-template-rows,opacity] duration-500 ease-[cubic-bezier(0.4,0,0.2,1)] ${ue?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"}`,children:l.jsxs("div",{className:"overflow-hidden min-h-0",children:[l.jsx("div",{className:"w-full h-px bg-gradient-to-r from-emerald-900/50 to-transparent my-6"}),l.jsx("div",{className:"space-y-2",children:wc(b.content,f,void 0,G=>te(G),t)}),l.jsxs("div",{className:"mt-10 pt-6 border-t border-stone-900/50 flex justify-between items-center",children:[l.jsxs("button",{className:"text-[9px] uppercase tracking-[0.2em] font-black text-emerald-900 hover:text-emerald-600 transition-colors flex items-center gap-2",onClick:()=>qe(b.id),children:[l.jsx("svg",{className:"w-3 h-3 rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),""]}),d&&l.jsxs("button",{onClick:()=>ft(b),className:"flex items-center gap-2 bg-stone-900/50 hover:bg-stone-800 text-stone-400 px-4 py-2 rounded-lg text-[9px] uppercase font-black tracking-widest transition-all",children:[l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),""]})]})]})})]})]},b.id)})}),$&&l.jsx("div",{className:"fixed inset-0 z-[120] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 animate-in fade-in duration-200 cursor-zoom-out",onClick:()=>te(null),children:l.jsxs("div",{className:"relative max-w-full max-h-full",children:[l.jsx("img",{src:$,className:"max-w-[95vw] max-h-[95vh] object-contain rounded-lg shadow-2xl animate-in zoom-in-95 duration-300",alt:"Zoomed"}),l.jsx("button",{className:"absolute -top-12 right-0 text-stone-400 hover:text-white transition-colors",onClick:()=>te(null),children:l.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]})})]}):p==="select-author"||p==="select-target"?l.jsxs("div",{className:"min-h-screen animate-in fade-in slide-in-from-bottom-4 duration-500 pb-20",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-b border-stone-900/50 pb-8 mb-8",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-serif text-stone-100 italic",children:p==="select-author"?" ":" "}),l.jsx("p",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-emerald-500/60 mt-2",children:"   "})]}),l.jsxs("button",{onClick:()=>g("editor"),className:"flex items-center gap-2 text-stone-500 hover:text-white transition-all text-[10px] uppercase font-bold tracking-widest",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"  "]})]}),l.jsx("div",{className:"mb-8",children:l.jsx("input",{type:"text",placeholder:"    ...",value:B,onChange:b=>ne(b.target.value),className:"w-full bg-stone-900/50 border border-stone-800 rounded-2xl px-6 py-4 text-sm text-stone-200 outline-none focus:border-emerald-500/50 transition-colors shadow-inner font-serif",autoFocus:!0})}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[l.jsxs("button",{onClick:()=>{D({...k,[p==="select-author"?"authorId":"targetId"]:void 0}),g("editor")},className:"flex items-center gap-4 p-4 rounded-2xl border border-stone-800 hover:border-red-900/50 hover:bg-red-950/10 transition-all group text-left",children:[l.jsx("div",{className:"w-12 h-12 rounded-full border border-stone-800 group-hover:border-red-500/30 bg-stone-900 flex items-center justify-center shrink-0 transition-colors",children:l.jsx("svg",{className:"w-5 h-5 text-stone-600 group-hover:text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("span",{className:"text-stone-400 font-bold text-sm block truncate group-hover:text-red-400 transition-colors",children:" "}),l.jsx("span",{className:"text-[9px] uppercase tracking-widest text-stone-600 block truncate",children:" "})]})]}),se.map(b=>l.jsxs("button",{onClick:()=>{D({...k,[p==="select-author"?"authorId":"targetId"]:b.id}),g("editor")},className:"flex items-center gap-4 p-4 rounded-2xl bg-[#0a0a0a] hover:bg-emerald-950/10 border border-stone-900 hover:border-emerald-900/30 transition-all group text-left",children:[l.jsx("div",{className:"w-12 h-12 rounded-full border border-stone-800 group-hover:border-emerald-500/50 bg-black overflow-hidden shrink-0 transition-colors",children:l.jsx("img",{src:b.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${b.miniImageX??50}% ${b.miniImageY??50}%`,transformOrigin:`${b.miniImageX??50}% ${b.miniImageY??50}%`,transform:`scale(${b.miniImageScale??1})`}})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("span",{className:"text-stone-300 font-bold text-sm block truncate group-hover:text-emerald-300 transition-colors",children:b.name}),l.jsx("span",{className:"text-[9px] uppercase tracking-widest text-stone-600 block truncate",children:""})]})]},b.id))]})]}):l.jsxs("div",{className:"min-h-screen animate-in fade-in slide-in-from-bottom-4 duration-500 flex flex-col pb-20",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6 border-b border-stone-900/50 pb-6 mb-8 shrink-0",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:R,className:"group p-3 rounded-full border border-stone-800 hover:bg-stone-900 transition-all text-stone-500 hover:text-white",children:l.jsx("svg",{className:"w-5 h-5 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-serif text-stone-100 font-bold italic",children:x?" ":" "}),l.jsx("p",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-emerald-500/60 mt-1",children:"   "})]})]}),l.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[x&&l.jsx("button",{onClick:ge,className:"px-6 py-3 bg-red-950/10 hover:bg-red-900/20 border border-red-900/30 text-red-500/70 hover:text-red-500 rounded-xl text-[10px] uppercase tracking-widest font-black transition-all flex-grow md:flex-grow-0",children:""}),l.jsxs("button",{onClick:Q,disabled:!k.title||!k.content,className:"px-8 py-3 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 text-emerald-500 rounded-xl text-[10px] uppercase tracking-widest font-black transition-all shadow-lg hover:shadow-emerald-900/10 disabled:opacity-30 disabled:cursor-not-allowed flex-grow md:flex-grow-0 flex items-center justify-center gap-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),""]})]})]}),l.jsxs("div",{className:"flex-grow flex flex-col space-y-8",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 shrink-0",children:[l.jsxs("button",{onClick:()=>g("select-author"),className:`group relative p-4 rounded-3xl border transition-all text-left flex items-center gap-5 ${k.authorId?"bg-emerald-950/10 border-emerald-900/30":"bg-stone-900/20 border-stone-800/50 hover:border-emerald-900/30"}`,children:[l.jsx("div",{className:`w-14 h-14 rounded-full border-2 overflow-hidden bg-black shrink-0 transition-transform group-hover:scale-105 ${k.authorId?"border-emerald-500 shadow-[0_0_15px_rgba(16,185,129,0.3)]":"border-stone-800"}`,children:k.authorId?(()=>{const b=j(k.authorId);return b?l.jsx("img",{src:b.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${b.miniImageX??50}% ${b.miniImageY??50}%`,transformOrigin:`${b.miniImageX??50}% ${b.miniImageY??50}%`,transform:`scale(${b.miniImageScale??1})`}}):null})():l.jsx("div",{className:"w-full h-full flex items-center justify-center text-stone-800",children:l.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-[9px] uppercase tracking-widest font-black text-stone-600 mb-1",children:":"}),l.jsx("p",{className:`text-sm font-bold truncate ${k.authorId?"text-stone-100":"text-stone-700 italic"}`,children:k.authorId?($e=j(k.authorId))==null?void 0:$e.name:" "})]})]}),l.jsxs("button",{onClick:()=>g("select-target"),className:`group relative p-4 rounded-3xl border transition-all text-left flex items-center gap-5 ${k.targetId?"bg-amber-950/10 border-amber-900/30":"bg-stone-900/20 border-stone-800/50 hover:border-amber-900/30"}`,children:[l.jsx("div",{className:`w-14 h-14 rounded-full border-2 overflow-hidden bg-black shrink-0 transition-transform group-hover:scale-105 ${k.targetId?"border-amber-500 shadow-[0_0_15px_rgba(245,158,11,0.3)]":"border-stone-800"}`,children:k.targetId?(()=>{const b=j(k.targetId);return b?l.jsx("img",{src:b.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${b.miniImageX??50}% ${b.miniImageY??50}%`,transformOrigin:`${b.miniImageX??50}% ${b.miniImageY??50}%`,transform:`scale(${b.miniImageScale??1})`}}):null})():l.jsx("div",{className:"w-full h-full flex items-center justify-center text-stone-800",children:l.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-[9px] uppercase tracking-widest font-black text-stone-600 mb-1",children:":"}),l.jsx("p",{className:`text-sm font-bold truncate ${k.targetId?"text-stone-100":"text-stone-700 italic"}`,children:k.targetId?(Me=j(k.targetId))==null?void 0:Me.name:""})]})]})]}),l.jsx("div",{className:"space-y-4",children:l.jsx("input",{placeholder:"  ...",className:"w-full bg-transparent border-b-2 border-stone-800 px-2 py-4 text-stone-100 outline-none focus:border-emerald-500/40 transition-all font-serif font-bold italic text-3xl md:text-4xl placeholder-stone-700",value:k.title||"",onChange:b=>D({...k,title:b.target.value})})}),l.jsxs("div",{className:"flex-grow flex flex-col w-full relative group/editor",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4 px-1 sticky top-0 bg-[#050505] z-50 py-2 border-b border-stone-900/50",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.4em] font-black text-stone-600",children:" "}),l.jsxs("div",{className:"flex flex-wrap gap-1 bg-stone-900/50 p-1 rounded-lg border border-stone-800",children:[l.jsx("button",{type:"button",disabled:ee,onClick:b=>{b.preventDefault(),U("**","**")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 font-serif font-bold text-lg transition-colors ${ee?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:"B"}),l.jsx("button",{type:"button",disabled:ee,onClick:b=>{b.preventDefault(),U("__","__")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 font-serif italic text-lg transition-colors ${ee?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:"I"}),l.jsx("button",{type:"button",disabled:ee,onClick:b=>{b.preventDefault(),U("~~","~~")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 line-through decoration-emerald-500/50 transition-colors ${ee?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:"S"}),l.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),l.jsx("button",{type:"button",disabled:ee,onClick:b=>{b.preventDefault(),U("# ","")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 font-serif font-bold transition-colors ${ee?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:"H"}),l.jsx("button",{type:"button",disabled:ee,onClick:b=>{b.preventDefault(),U("> ","")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ee?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:l.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M14.017 21L14.017 18C14.017 16.896 14.321 16.067 14.929 15.513C15.537 14.959 16.485 14.682 17.773 14.682V14.128C17.773 13.068 17.411 12.152 16.687 11.38C15.963 10.608 14.887 10.222 13.459 10.222V4.99998C15.827 4.99998 17.754 5.75398 19.24 7.26198C20.726 8.76998 21.469 10.871 21.469 13.565V21H14.017ZM2.53699 21L2.53699 18C2.53699 16.896 2.84099 16.067 3.44899 15.513C4.05699 14.959 5.00499 14.682 6.29299 14.682V14.128C6.29299 13.068 5.93099 12.152 5.20699 11.38C4.48299 10.608 3.40699 10.222 1.97899 10.222V4.99998C4.34699 4.99998 6.27399 5.75398 7.75999 7.26198C9.24599 8.76998 9.98899 10.871 9.98899 13.565V21H2.53699Z"})})}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{type:"button",disabled:ee,onClick:b=>{b.preventDefault(),L(!M)},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ee?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"  ",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),M&&!ee&&l.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-[#1a1a1a] border border-stone-700 rounded-xl shadow-2xl z-50 animate-in fade-in zoom-in-95 duration-200 w-72 md:w-80",children:l.jsxs("div",{className:"space-y-3",children:[l.jsx("input",{autoFocus:!0,type:"text",placeholder:" ...",value:_e,onChange:b=>ae(b.target.value),className:"w-full bg-stone-900 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-colors"}),((r==null?void 0:r.length)||0)>0&&l.jsx("div",{className:"flex flex-wrap gap-1.5 max-h-20 overflow-y-auto custom-scrollbar",children:r==null?void 0:r.map(b=>{const re=Ce.includes(b);return l.jsx("button",{onClick:P=>{P.preventDefault(),Ie(b)},className:`px-2 py-1 rounded text-[8px] uppercase font-bold tracking-wider transition-all border ${re?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:b},b)})}),l.jsx("div",{className:"max-h-48 overflow-y-auto custom-scrollbar space-y-1",children:xe.length===0?l.jsx("p",{className:"text-center text-[10px] text-stone-600 italic py-2",children:"  "}):xe.map(b=>l.jsxs("button",{onClick:re=>{re.preventDefault(),Se(b)},className:"w-full flex items-center gap-3 p-2 hover:bg-stone-900 rounded-lg text-left transition-colors group",children:[l.jsx("div",{className:"w-6 h-6 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:l.jsx("img",{src:b.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${b.miniImageX??50}% ${b.miniImageY??50}%`,transform:`scale(${b.miniImageScale??1})`,transformOrigin:`${b.miniImageX??50}% ${b.miniImageY??50}%`}})}),l.jsx("span",{className:"text-xs font-bold text-stone-300 group-hover:text-emerald-400 truncate",children:b.name})]},b.id))})]})})]}),l.jsx("button",{type:"button",disabled:ee,onClick:b=>{b.preventDefault(),U("---","")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ee?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:l.jsx("div",{className:"w-4 h-0.5 bg-current opacity-50"})}),l.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{type:"button",disabled:ee,onClick:b=>{b.preventDefault(),K(!Oe)},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ee?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-amber-400"}`,title:" ",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),Oe&&!ee&&l.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-[#1a1a1a] border border-stone-700 rounded-xl shadow-2xl z-50 animate-in fade-in zoom-in-95 duration-200 w-72 md:w-80",children:l.jsxs("div",{className:"space-y-3",children:[l.jsx("input",{autoFocus:!0,type:"text",placeholder:"...",value:_e,onChange:b=>ae(b.target.value),className:"w-full bg-stone-900 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-amber-500/50 transition-colors"}),((r==null?void 0:r.length)||0)>0&&l.jsx("div",{className:"flex flex-wrap gap-1.5 max-h-20 overflow-y-auto custom-scrollbar",children:r==null?void 0:r.map(b=>{const re=Ce.includes(b);return l.jsx("button",{onClick:P=>{P.preventDefault(),Ie(b)},className:`px-2 py-1 rounded text-[8px] uppercase font-bold tracking-wider transition-all border ${re?"bg-amber-500/20 border-amber-500/40 text-amber-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:b},b)})}),l.jsx("div",{className:"max-h-48 overflow-y-auto custom-scrollbar space-y-1",children:xe.length===0?l.jsx("p",{className:"text-center text-[10px] text-stone-600 italic py-2",children:"  "}):xe.map(b=>l.jsxs("button",{onClick:re=>{re.preventDefault(),we(b)},className:"w-full flex items-center gap-3 p-2 hover:bg-stone-900 rounded-lg text-left transition-colors group",children:[l.jsx("div",{className:"w-6 h-6 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:l.jsx("img",{src:b.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${b.miniImageX??50}% ${b.miniImageY??50}%`,transform:`scale(${b.miniImageScale??1})`,transformOrigin:`${b.miniImageX??50}% ${b.miniImageY??50}%`}})}),l.jsx("span",{className:"text-xs font-bold text-stone-300 group-hover:text-amber-400 truncate",children:b.name})]},b.id))})]})})]}),l.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{type:"button",disabled:ee,onClick:b=>{b.preventDefault(),Qe(!je)},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ee?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:" ",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),je&&l.jsx("div",{className:"absolute top-full right-0 origin-top-right mt-2 p-4 bg-[#1a1a1a] border border-stone-700 rounded-xl shadow-2xl z-[60] animate-in fade-in zoom-in-95 duration-200 w-80 max-h-[80vh] overflow-y-auto custom-scrollbar",children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h4",{className:"text-[10px] uppercase font-bold text-stone-400 border-b border-stone-800 pb-2 sticky top-0 bg-[#1a1a1a] z-10",children:Ee.originalTag?"":" "}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-[9px] uppercase font-bold text-stone-500",children:""}),l.jsx("input",{autoFocus:!0,type:"text",placeholder:"https://...",className:"w-full bg-stone-900 border border-stone-800 rounded-lg px-2 py-1.5 text-xs text-stone-200 outline-none focus:border-emerald-500/50",value:Ee.url,onChange:b=>Be({...Ee,url:b.target.value})})]}),Ee.url&&l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-[9px] uppercase font-bold text-stone-500",children:"  "}),l.jsx("div",{className:"w-3/4 mx-auto transition-all",children:l.jsx(_c,{imageUrl:Ee.url,scale:Ee.scale,x:Ee.x,y:Ee.y,aspectRatio:Te(Ee.aspectRatioStr),onUpdate:b=>Be(re=>({...re,x:b.x??re.x,y:b.y??re.y,scale:b.scale??re.scale}))})}),l.jsx("div",{className:"grid grid-cols-5 gap-1 mt-2",children:ix.map(b=>l.jsxs("button",{type:"button",onClick:()=>Be(re=>({...re,aspectRatioStr:b.str})),className:`flex flex-col items-center justify-center p-1.5 rounded-lg border transition-all ${Ee.aspectRatioStr===b.str?"bg-stone-800 border-emerald-500/50 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-500 hover:text-stone-300 hover:border-stone-700"}`,title:b.label,children:[l.jsx("svg",{className:"w-4 h-4 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:b.icon})}),l.jsx("span",{className:"text-[8px] font-black",children:b.label})]},b.label))})]}),l.jsx("button",{type:"button",disabled:!Ee.url,onClick:b=>{b.preventDefault(),A()},className:"w-full py-2 bg-emerald-900/30 border border-emerald-900/50 text-emerald-500 rounded-lg text-[10px] uppercase font-bold hover:bg-emerald-900/50 transition-colors disabled:opacity-50",children:Ee.originalTag?" ":""}),l.jsxs("div",{className:"space-y-1 pt-2 border-t border-stone-800",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("label",{className:"text-[9px] uppercase font-bold text-stone-500",children:"  "}),l.jsxs("span",{className:"text-[9px] font-mono text-emerald-500",children:[Ee.width,"%"]})]}),l.jsx("input",{type:"range",min:"10",max:"100",step:"10",className:"w-full h-1.5 bg-stone-800 rounded-lg appearance-none cursor-pointer accent-emerald-500",value:Ee.width,onChange:b=>Be({...Ee,width:parseInt(b.target.value)})})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-[9px] uppercase font-bold text-stone-500",children:""}),l.jsx("div",{className:"flex bg-stone-900 rounded-lg p-1 border border-stone-800",children:["left","center","right"].map(b=>l.jsxs("button",{type:"button",onClick:()=>Be({...Ee,align:b}),className:`flex-1 py-1 rounded text-stone-400 hover:text-white transition-colors flex justify-center ${Ee.align===b?"bg-stone-800 text-emerald-400 shadow-sm":""}`,children:[b==="left"&&l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h10M4 18h7"})}),b==="center"&&l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M7 12h10M7 18h10"})}),b==="right"&&l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M10 12h10M13 18h7"})})]},b))})]})]})})]}),l.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),l.jsx("button",{type:"button",disabled:ee,onClick:b=>{b.preventDefault(),U("[link=]","[/link]")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ee?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),l.jsx("button",{type:"button",disabled:ee,onClick:b=>{b.preventDefault(),U("[tip=]","[/tip]")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ee?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),l.jsx("button",{type:"button",disabled:ee,onClick:b=>{b.preventDefault(),U("||","||")},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ee?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{type:"button",disabled:ee,onClick:b=>{b.preventDefault(),ie(!ce)},className:`w-8 h-8 flex items-center justify-center rounded-md text-stone-400 transition-colors ${ee?"opacity-30 cursor-not-allowed":"hover:bg-stone-800 hover:text-emerald-400"}`,title:"",children:l.jsx("div",{className:"w-3.5 h-3.5 rounded-full bg-gradient-to-br from-red-500 via-yellow-500 to-blue-500 border border-stone-600"})}),ce&&!ee&&l.jsxs("div",{className:"absolute top-full right-0 mt-2 p-3 bg-[#1a1a1a] border border-stone-700 rounded-xl shadow-2xl z-50 flex items-center gap-3 animate-in fade-in zoom-in-95 duration-200 min-w-[140px]",children:[l.jsx("input",{type:"color",className:"w-8 h-8 rounded cursor-pointer bg-transparent border-none p-0",value:ke,onChange:b=>le(b.target.value)}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-[8px] uppercase font-bold text-stone-500 tracking-wider",children:""}),l.jsx("span",{className:"text-[10px] font-mono text-stone-300",children:ke})]}),l.jsx("button",{type:"button",onClick:b=>{b.preventDefault(),U(`[c=${ke}]`,"[/c]"),ie(!1)},className:"ml-auto p-1.5 bg-emerald-500/20 text-emerald-500 hover:bg-emerald-500/30 rounded-lg transition-colors border border-emerald-500/30",title:"",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]})]}),l.jsx("div",{className:"w-px h-5 bg-stone-800 self-center mx-1"}),l.jsx("button",{type:"button",disabled:ee,onClick:b=>{b.preventDefault(),w(!q)},className:`w-8 h-8 flex items-center justify-center rounded-md transition-colors hidden md:flex ${q&&!ee?"bg-emerald-900/30 text-emerald-400":"text-stone-400 hover:bg-stone-800 hover:text-white"} ${ee?"opacity-30 cursor-not-allowed":""}`,title:q?"  ":"  ",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 00-2 2"})})}),l.jsx("button",{type:"button",onClick:b=>{b.preventDefault(),Y(!ee)},className:`w-8 h-8 flex items-center justify-center rounded-md transition-colors ${ee?"bg-emerald-900/30 text-emerald-400":"text-stone-400 hover:bg-stone-800 hover:text-white"}`,title:ee?"  ":" ",children:ee?l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}):l.jsxs("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),l.jsxs("div",{className:`relative flex-grow min-h-[500px] ${q&&!ee?"grid grid-cols-1 lg:grid-cols-2 gap-4":""}`,children:[l.jsx("textarea",{ref:he,placeholder:"  ...",className:`w-full bg-[#030303] border border-stone-900 rounded-2xl px-6 py-6 text-stone-300 outline-none focus:border-emerald-500/40 transition-all resize-none leading-relaxed shadow-inner custom-scrollbar text-lg font-serif h-full overflow-y-auto ${ee?"hidden":"block"}`,style:q&&!ee?{height:"calc(100vh - 300px)",minHeight:"500px"}:{minHeight:"500px"},value:k.content||"",onChange:b=>D({...k,content:b.target.value})}),l.jsx("div",{className:`w-full bg-[#030303] border border-stone-900 rounded-2xl px-6 py-6 text-stone-300 shadow-inner custom-scrollbar text-lg font-serif overflow-y-auto break-words ${ee||q?"block":"hidden"}`,style:q&&!ee?{height:"calc(100vh - 300px)",minHeight:"500px"}:{height:"100%",position:ee?"absolute":"static",inset:0,zIndex:10},children:(ee||q)&&wc(k.content||"",f,ee?void 0:O,b=>te(b),t)})]}),l.jsxs("div",{className:"flex justify-between items-start mt-2 px-2 pb-10",children:[l.jsx("p",{className:"text-[8px] text-stone-700 italic",children:": # , > , --- "}),l.jsx("p",{className:"text-[8px] text-stone-700 italic",children:"**B**, __I__, ~~S~~, ||Spoiler||, [c=hex]Color[/c], [link=url]Text[/link], [tip=Text]Trig[/tip], [char=ID]Name[/char]"})]})]})]})]})},lx=({character:s,isAdmin:t,allCharacters:r,availableTags:o,availableHiddenTags:c,worlds:d,notes:f=[],onBack:p,onSave:g,onSelectCharacter:x,onDeleteNote:C})=>{var qe,ft;const[y,v]=F.useState(s),[k,D]=F.useState(!1),[B,ne]=F.useState(!1),[ce,ie]=F.useState(!1),[ke,le]=F.useState(!1),[Oe,K]=F.useState(new Set),[M,L]=F.useState(""),[_e,ae]=F.useState([]);F.useEffect(()=>{v(s)},[s]);const Ce=F.useMemo(()=>{var R,Q;if(!d)return null;for(const ge of d){if((R=ge.characterIds)!=null&&R.includes(s.id))return ge.name;if(ge.subLocations){for(const j of ge.subLocations)if((Q=j.characterIds)!=null&&Q.includes(s.id))return`${ge.name} / ${j.name}`}}return null},[d,s.id]),ve=F.useMemo(()=>Array.isArray(f)?f.filter(R=>R&&(R.targetId===s.id||R.authorId===s.id)):[],[f,s.id]),je=(R,Q)=>{v(ge=>({...ge,[R]:Q}))},Qe=R=>{v(Q=>({...Q,imageScale:R.scale??Q.imageScale,imageX:R.x??Q.imageX,imageY:R.y??Q.imageY}))},Ee=R=>{v(Q=>({...Q,miniImageScale:R.scale??Q.miniImageScale,miniImageX:R.x??Q.miniImageX,miniImageY:R.y??Q.miniImageY}))},Be=async R=>{var ge;const Q=(ge=R.target.files)==null?void 0:ge[0];if(Q){le(!0);try{const j=await zo(Q);je("imageUrl",j)}catch(j){console.error("Error processing image",j),alert("   ")}finally{le(!1)}}},ee=(R,Q=!1)=>{if(Q){const ge=y.hiddenTags||[],j=ge.includes(R)?ge.filter(se=>se!==R):[...ge,R];je("hiddenTags",j)}else{const ge=y.tags||[],j=ge.includes(R)?ge.filter(se=>se!==R):[...ge,R];je("tags",j)}},Y=()=>{g(y)},q=()=>{v(s)},w=()=>{t&&g(y),p()},$=()=>{ie(!ce),L(""),ae([])},te=R=>{const Q={id:R.id,name:R.name,role:"",color:"#ef4444"},ge=y.connections||[];ge.some(j=>j.id===R.id)||je("connections",[...ge,Q]),ie(!1)},he=R=>{const Q=y.connections||[];je("connections",Q.filter(ge=>ge.id!==R))},O=(R,Q)=>{const ge=y.connections||[];je("connections",ge.map(j=>j.id===R?{...j,role:Q}:j))},A=(R,Q)=>{const ge=y.connections||[];je("connections",ge.map(j=>j.id===R?{...j,color:Q}:j))},U=R=>{ae(Q=>Q.includes(R)?Q.filter(ge=>ge!==R):[...Q,R])},we=R=>{K(Q=>{const ge=new Set(Q);return ge.has(R)?ge.delete(R):ge.add(R),ge})},Se=r.filter(R=>{var Q;if(!R||R.id===y.id||(Q=y.connections)!=null&&Q.some(ge=>ge.id===R.id)||M&&!R.name.toLowerCase().includes(M.toLowerCase()))return!1;if(_e.length>0){const ge=[...R.tags||[],...R.hiddenTags||[]];return _e.every(j=>ge.includes(j))}return!0});return l.jsxs("div",{className:"animate-reveal-details space-y-6 md:space-y-8 pb-20",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4 animate-stagger-1",children:[l.jsxs("button",{onClick:w,className:"flex items-center text-stone-500 hover:text-emerald-500 transition-colors group text-sm md:text-base order-1",children:[l.jsx("svg",{className:"w-5 h-5 mr-2 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})," ()"]}),t&&l.jsxs("div",{className:"flex items-center gap-3 order-2 w-full md:w-auto justify-end",children:[l.jsx("button",{onClick:q,className:"px-4 py-2 rounded-lg border border-stone-800 text-stone-500 hover:text-white hover:bg-stone-800 text-[10px] uppercase font-bold tracking-wider transition-all",children:""}),l.jsxs("button",{onClick:Y,className:"px-5 py-2 rounded-lg bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 hover:bg-emerald-900/40 text-[10px] uppercase font-bold tracking-wider transition-all flex items-center gap-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),""]})]})]}),l.jsxs("div",{className:"block clearfix",children:[l.jsxs("div",{className:"w-full lg:w-[35%] lg:float-left lg:mr-12 mb-8 space-y-8 animate-stagger-2",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h4",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 px-1",children:" "}),t?l.jsxs("div",{className:"space-y-4",children:[l.jsx(_c,{imageUrl:y.imageUrl,scale:y.imageScale??1,x:y.imageX??50,y:y.imageY??50,onUpdate:Qe}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{className:"w-full bg-[#050505] border border-stone-800 rounded-lg px-3 py-2 text-[10px] text-stone-400 outline-none focus:border-emerald-500",placeholder:y.imageUrl.startsWith("data:")?"   ":"URL ...",value:y.imageUrl.startsWith("data:")?"":y.imageUrl,onChange:R=>je("imageUrl",R.target.value)}),l.jsxs("label",{className:`cursor-pointer bg-stone-900 border border-stone-800 hover:bg-stone-800 rounded-lg px-3 flex items-center justify-center transition-colors ${ke?"opacity-50":""}`,children:[l.jsx("input",{type:"file",onChange:Be,accept:"image/*",className:"hidden",disabled:ke}),l.jsx("svg",{className:"w-4 h-4 text-emerald-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})]})]})]}):l.jsx("div",{className:"aspect-[4/5] rounded-2xl overflow-hidden border border-stone-800 shadow-2xl bg-black transition-transform duration-700 hover:scale-[1.02]",children:l.jsx("img",{src:y.imageUrl,alt:y.name,style:{objectFit:"cover",objectPosition:`${y.imageX??50}% ${y.imageY??50}%`,transformOrigin:`${y.imageX??50}% ${y.imageY??50}%`,transform:`scale(${y.imageScale??1})`},className:"w-full h-full"})})]}),t&&l.jsxs("div",{className:"space-y-4 pt-4 border-t border-stone-900/50",children:[l.jsx("h4",{className:"text-[10px] uppercase tracking-widest font-bold text-emerald-500/60 px-1",children:"- ()"}),l.jsx(_c,{imageUrl:y.imageUrl,scale:y.miniImageScale??1,x:y.miniImageX??50,y:y.miniImageY??50,isCircular:!0,onUpdate:Ee})]}),l.jsxs("div",{className:"space-y-5 p-5 md:p-7 bg-[#0f0f0f]/40 border border-stone-900 rounded-[2rem] md:rounded-[2.5rem] shadow-inner transition-all hover:bg-[#0f0f0f]/50",children:[l.jsx("h4",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-emerald-500/60 px-1 text-center",children:""}),l.jsx("div",{className:"flex flex-wrap gap-2 justify-center min-h-[40px]",children:t?l.jsxs(l.Fragment,{children:[o.map(R=>{var Q;return l.jsx("button",{onClick:()=>ee(R,!1),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border ${(Q=y.tags)!=null&&Q.includes(R)?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400":"bg-stone-950 border-stone-800/50 text-stone-700 hover:text-stone-400"}`,children:R},R)}),o.length>0&&c.length>0&&l.jsx("div",{className:"w-full h-px bg-stone-900/50 my-1"}),c.map(R=>{var Q;return l.jsx("button",{onClick:()=>ee(R,!0),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border ${(Q=y.hiddenTags)!=null&&Q.includes(R)?"bg-amber-500/10 border-amber-500/40 text-amber-400":"bg-stone-950 border-stone-800/50 text-stone-700 hover:text-stone-400"}`,children:R},R)})]}):(qe=y.tags)==null?void 0:qe.map(R=>l.jsx("span",{className:"px-3 py-1.5 md:px-4 md:py-2 bg-emerald-500/5 border border-emerald-500/10 text-emerald-500/70 text-[9px] md:text-[10px] uppercase tracking-widest font-black rounded-xl",children:R},R))})]})]}),l.jsx("div",{className:"animate-stagger-3",children:l.jsxs("div",{className:"mb-6 md:mb-8",children:[t?l.jsx("div",{className:"space-y-4 mb-4",children:l.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[l.jsxs("div",{className:"flex-grow",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-1",children:""}),l.jsx("input",{className:"w-full bg-transparent border-b border-stone-800 text-3xl md:text-4xl font-serif font-bold text-stone-100 outline-none focus:border-emerald-800 transition-colors py-1",value:y.name,onChange:R=>je("name",R.target.value)})]}),l.jsxs("div",{className:"w-full md:w-32",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-1",children:""}),l.jsx("input",{className:"w-full bg-transparent border-b border-stone-800 text-xl font-light text-stone-500 outline-none focus:border-emerald-800 transition-colors py-2",value:y.age,onChange:R=>je("age",R.target.value)})]}),l.jsxs("div",{className:"w-full md:w-32",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-1",children:""}),l.jsx("input",{className:"w-full bg-transparent border-b border-stone-800 text-xl font-light text-stone-500 outline-none focus:border-emerald-800 transition-colors py-2",value:y.height||"",placeholder:". 180 ",onChange:R=>je("height",R.target.value)})]})]})}):l.jsxs("div",{className:"space-y-4 mb-6",children:[l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 md:gap-6",children:[l.jsx("h1",{className:"text-3xl md:text-5xl font-serif font-bold text-stone-100 leading-tight",children:y.name}),l.jsxs("div",{className:"flex items-center gap-2",children:[y.age&&l.jsxs("div",{className:"bg-stone-900 border border-stone-800 px-3 py-1 rounded-xl flex items-baseline gap-1.5 shadow-lg",children:[l.jsx("span",{className:"text-stone-100 font-bold text-lg",children:y.age.toString().replace(/[^0-9]/g,"")||y.age}),l.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-emerald-500/70",children:""})]}),y.height&&l.jsxs("div",{className:"bg-stone-900 border border-stone-800 px-3 py-1 rounded-xl flex items-baseline gap-1.5 shadow-lg",children:[l.jsx("span",{className:"text-stone-100 font-bold text-lg",children:y.height.toString().replace(/[^0-9]/g,"")||y.height}),l.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-emerald-500/70",children:""})]})]})]}),Ce&&l.jsxs("div",{className:"inline-flex items-center gap-2 bg-emerald-900/10 border border-emerald-900/30 px-3 py-1.5 rounded-full mt-2",children:[l.jsx("span",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"}),l.jsx("span",{className:"text-[10px] uppercase tracking-widest font-bold text-emerald-500",children:Ce})]})]}),l.jsx("div",{className:"h-px bg-stone-900 w-full mb-6 md:mb-8"}),l.jsxs("section",{className:"space-y-4 mb-8",children:[l.jsx("h4",{className:"text-emerald-500 text-sm font-semibold uppercase tracking-wider",children:""}),t?l.jsx("textarea",{className:"w-full bg-stone-900/20 border border-stone-800 rounded-xl p-4 text-stone-200 text-base md:text-lg leading-relaxed font-light outline-none focus:border-emerald-900 transition-colors resize-none break-words",rows:12,value:y.additionalInfo,onChange:R=>je("additionalInfo",R.target.value)}):l.jsx("p",{className:"text-stone-300 text-base md:text-lg leading-relaxed font-light whitespace-pre-wrap break-words",children:y.additionalInfo})]}),ve.length>0&&l.jsxs("div",{className:"space-y-3 mb-6",children:[l.jsxs("button",{onClick:()=>ne(!B),className:"w-full flex items-center justify-between bg-[#0f0f0f]/30 border border-stone-900 p-4 md:p-5 rounded-xl transition-all group hover:border-amber-900/30 shadow-md",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-amber-600 font-bold tracking-widest text-xs uppercase",children:"  "}),l.jsxs("span",{className:"text-stone-600 text-sm",children:["(",ve.length,")"]})]}),l.jsx("svg",{className:`w-4 h-4 text-stone-600 transition-transform duration-300 ${B?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]}),l.jsx("div",{className:`grid transition-[grid-template-rows,opacity] duration-500 ease-[cubic-bezier(0.4,0,0.2,1)] ${B?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"}`,children:l.jsx("div",{className:"overflow-hidden",children:l.jsx("div",{className:"space-y-4 pt-4",children:ve.map(R=>{const Q=r.find(xe=>xe.id===R.authorId),ge=r.find(xe=>xe.id===R.targetId),j=R.authorId===s.id,se=Oe.has(R.id);return l.jsxs("div",{className:"bg-stone-900/20 border border-stone-900/50 rounded-xl p-4 md:p-5 hover:border-emerald-900/30 transition-colors",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3 border-b border-stone-900/50 pb-2",children:[l.jsx("div",{className:"flex items-center gap-2",children:j?l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-stone-600",children:":"}),l.jsx("span",{className:"text-[10px] uppercase tracking-widest font-bold text-emerald-500",children:ge?ge.name:""})]}):l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("span",{className:"text-[9px] uppercase tracking-widest font-black text-stone-600",children:":"}),l.jsx("span",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-300",children:Q?Q.name:""})]})}),l.jsx("span",{className:"text-[9px] uppercase font-bold text-stone-700",children:R.date})]}),l.jsx("h5",{className:"text-stone-200 font-serif italic text-xl mb-2 break-words",children:R.title}),!se&&l.jsxs("button",{onClick:()=>we(R.id),className:"text-[9px] uppercase tracking-[0.2em] font-black text-stone-600 hover:text-emerald-500 transition-colors pt-2 flex items-center gap-1 outline-none",children:["",l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),l.jsx("div",{className:`grid transition-[grid-template-rows,opacity] duration-500 ease-[cubic-bezier(0.4,0,0.2,1)] ${se?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"}`,children:l.jsx("div",{className:"overflow-hidden",children:l.jsxs("div",{className:"pt-2",children:[l.jsx("div",{className:"text-stone-400 text-sm md:text-base leading-relaxed whitespace-pre-wrap font-light break-words",children:wc(R.content,x,void 0,void 0,r)}),l.jsxs("button",{onClick:()=>we(R.id),className:"text-[9px] uppercase tracking-[0.2em] font-black text-emerald-900 hover:text-emerald-600 transition-colors flex items-center gap-1 mt-4",children:[l.jsx("svg",{className:"w-3 h-3 rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),""]})]})})})]},R.id)})})})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex flex-col gap-4",children:[t&&l.jsxs("button",{onClick:$,className:`w-full py-4 rounded-xl border transition-all text-[10px] uppercase font-bold tracking-[0.2em] flex items-center justify-center gap-3 ${ce?"bg-emerald-500 border-emerald-400 text-black shadow-[0_0_20px_rgba(16,185,129,0.2)]":"bg-emerald-900/20 border-emerald-900/50 text-emerald-400 hover:bg-emerald-900/30"}`,children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:ce?"M6 18L18 6M6 6l12 12":"M12 4v16m8-8H4"})}),ce?"":" "]}),l.jsxs("button",{onClick:()=>D(!k),className:"w-full flex items-center justify-between bg-[#0f0f0f]/30 border border-stone-900 p-4 md:p-5 rounded-xl transition-all group hover:border-emerald-900/30 shadow-md",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-emerald-500 font-bold tracking-widest text-xs uppercase",children:""}),l.jsxs("span",{className:"text-stone-600 text-sm",children:["(",((ft=y.connections)==null?void 0:ft.length)||0,")"]})]}),l.jsx("svg",{className:`w-4 h-4 text-stone-600 transition-transform duration-300 ${k?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]})]}),t&&ce&&l.jsxs("div",{className:"animate-reveal-details bg-[#0a0a0a] border border-emerald-900/30 rounded-2xl p-4 md:p-6 space-y-4 shadow-2xl overflow-hidden relative",children:[l.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:l.jsx("input",{autoFocus:!0,type:"text",placeholder:"   ...",className:"flex-grow bg-stone-950 border border-stone-800 rounded-xl px-4 py-3 text-sm text-stone-200 outline-none focus:border-emerald-500/50 transition-colors",value:M,onChange:R=>L(R.target.value)})}),l.jsx("div",{className:"flex flex-wrap gap-1.5 max-h-24 overflow-y-auto custom-scrollbar",children:o.map(R=>l.jsx("button",{onClick:()=>U(R),className:`px-2 py-1 rounded-lg text-[9px] uppercase font-bold tracking-wider transition-all border ${_e.includes(R)?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:R},R))}),l.jsx("div",{className:"flex flex-col gap-2 max-h-60 overflow-y-auto custom-scrollbar pr-2",children:Se.length>0?Se.map(R=>l.jsxs("button",{onClick:()=>te(R),className:"flex items-center gap-4 p-3 bg-stone-900/50 border border-stone-800 rounded-xl hover:bg-emerald-900/20 hover:border-emerald-900/40 transition-all text-left group",children:[l.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:l.jsx("img",{src:R.imageUrl,style:{objectFit:"cover",objectPosition:`${R.miniImageX??50}% ${R.miniImageY??50}%`,transformOrigin:`${R.miniImageX??50}% ${R.miniImageY??50}%`,transform:`scale(${R.miniImageScale??1})`},className:"w-full h-full",alt:""})}),l.jsxs("div",{className:"min-w-0 flex-grow",children:[l.jsx("span",{className:"text-stone-200 font-bold text-sm block truncate group-hover:text-emerald-400",children:R.name}),l.jsx("span",{className:"text-[10px] text-stone-600 uppercase tracking-widest block truncate",children:"  "})]}),l.jsx("svg",{className:"w-4 h-4 text-emerald-500 opacity-0 group-hover:opacity-100 transition-all",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})]},R.id)):l.jsx("p",{className:"text-stone-700 italic text-xs py-4 text-center",children:"  "})})]}),l.jsx("div",{className:`grid transition-[grid-template-rows,opacity] duration-500 ease-[cubic-bezier(0.4,0,0.2,1)] ${k?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"}`,children:l.jsx("div",{className:"overflow-hidden",children:l.jsx("div",{className:"space-y-3 pt-3",children:l.jsx("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-xl overflow-hidden divide-y divide-stone-900/50",children:y.connections&&y.connections.length>0?y.connections.map(R=>{const Q=r.find(ge=>ge&&ge.id===R.id);return l.jsxs("div",{className:"p-4 flex flex-row items-center gap-4 group hover:bg-stone-900/20 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-4 flex-grow min-w-0",children:[l.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 rounded-full overflow-hidden border border-stone-800 shrink-0 bg-black",children:l.jsx("img",{src:(Q==null?void 0:Q.imageUrl)||"",style:{objectFit:"cover",objectPosition:`${(Q==null?void 0:Q.miniImageX)??50}% ${(Q==null?void 0:Q.miniImageY)??50}%`,transformOrigin:`${(Q==null?void 0:Q.miniImageX)??50}% ${(Q==null?void 0:Q.miniImageY)??50}%`,transform:`scale(${(Q==null?void 0:Q.miniImageScale)??1})`},className:"w-full h-full",alt:""})}),l.jsxs("div",{className:"flex-grow min-w-0",children:[l.jsx("p",{className:"text-stone-200 font-bold text-sm truncate",children:R.name}),t?l.jsx("input",{className:"bg-transparent border-b border-stone-800 text-xs text-stone-500 outline-none focus:border-emerald-500 py-1 w-full max-w-[150px]",value:R.role,onChange:ge=>O(R.id,ge.target.value)}):l.jsx("p",{className:"text-stone-600 text-xs mt-1 font-medium truncate",children:R.role})]})]}),l.jsxs("div",{className:"flex items-center justify-end gap-5 shrink-0",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[t?l.jsx("input",{type:"color",className:"w-6 h-6 rounded-sm bg-transparent border-none cursor-pointer p-0 appearance-none shadow-lg",value:R.color||"#ef4444",onChange:ge=>A(R.id,ge.target.value)}):l.jsx("div",{className:"w-4 h-4 rounded-sm shadow-sm",style:{backgroundColor:R.color||"#ef4444"}}),l.jsx("button",{onClick:()=>x(R.id),className:"text-stone-700 hover:text-stone-100 transition-colors text-[9px] md:text-[10px] uppercase font-bold tracking-[0.2em]",children:""})]}),t&&l.jsx("button",{onClick:()=>he(R.id),className:"text-stone-800 hover:text-red-500 transition-colors p-1",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})]},R.id)}):l.jsx("div",{className:"p-10 text-center text-stone-700 italic text-sm",children:"  "})})})})})]})]})})]})]})},ax=({initialData:s,availableTags:t,availableHiddenTags:r,onSave:o,onClose:c})=>{const[d,f]=F.useState({name:"",age:"",height:"",imageUrl:"",additionalInfo:"",imageScale:1,imageX:50,imageY:50,tags:[],hiddenTags:[]}),[p,g]=F.useState(!1);F.useEffect(()=>{var v;s&&f({name:s.name,age:s.age.toString(),height:((v=s.height)==null?void 0:v.toString())||"",imageUrl:s.imageUrl,additionalInfo:s.additionalInfo,imageScale:s.imageScale??1,imageX:s.imageX??50,imageY:s.imageY??50,tags:s.tags||[],hiddenTags:s.hiddenTags||[]})},[s]);const x=(v,k)=>{f(k?D=>({...D,hiddenTags:D.hiddenTags.includes(v)?D.hiddenTags.filter(B=>B!==v):[...D.hiddenTags,v]}):D=>({...D,tags:D.tags.includes(v)?D.tags.filter(B=>B!==v):[...D.tags,v]}))},C=async v=>{var D;const k=(D=v.target.files)==null?void 0:D[0];if(k){g(!0);try{const B=await zo(k);f(ne=>({...ne,imageUrl:B}))}catch(B){console.error("Error processing image",B),alert("   .")}finally{g(!1)}}},y=v=>{v.preventDefault();const k={id:(s==null?void 0:s.id)||Date.now().toString(),name:d.name,age:d.age,height:d.height,imageUrl:d.imageUrl||`https://picsum.photos/seed/${Date.now()}/400/500`,additionalInfo:d.additionalInfo,tags:d.tags,hiddenTags:d.hiddenTags,connections:(s==null?void 0:s.connections)||[],imageScale:d.imageScale,imageX:d.imageX,imageY:d.imageY};o(k)};return l.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center p-4 bg-black/95 backdrop-blur-2xl animate-in fade-in duration-300",children:l.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-2xl rounded-[2rem] md:rounded-[3rem] overflow-hidden shadow-[0_0_120px_rgba(0,0,0,1)] border-white/5 flex flex-col max-h-[90vh]",children:[l.jsxs("div",{className:"p-6 md:p-10 border-b border-stone-900 flex justify-between items-center bg-gradient-to-b from-stone-900/30 to-transparent shrink-0",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl md:text-3xl font-serif text-stone-100 italic",children:s?" ":" "}),l.jsx("p",{className:"text-stone-600 text-[10px] uppercase tracking-widest mt-1",children:"  "})]}),l.jsx("button",{onClick:c,className:"text-stone-700 hover:text-white transition-all p-2 md:p-3 hover:bg-white/5 rounded-full",children:l.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]}),l.jsxs("form",{onSubmit:y,className:"p-6 md:p-10 space-y-8 md:space-y-10 overflow-y-auto custom-scrollbar flex-grow",children:[l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:"  "}),l.jsx("input",{required:!0,className:"w-full bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-4 text-stone-100 outline-none focus:border-emerald-500/30 transition-all font-serif italic text-lg shadow-inner",value:d.name,onChange:v=>f({...d,name:v.target.value})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:""}),l.jsx("input",{required:!0,className:"w-full bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-4 text-stone-100 outline-none focus:border-emerald-500/30 transition-all shadow-inner",value:d.age,onChange:v=>f({...d,age:v.target.value})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:""}),l.jsx("input",{className:"w-full bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-4 text-stone-100 outline-none focus:border-emerald-500/30 transition-all shadow-inner",value:d.height,placeholder:". 185 ",onChange:v=>f({...d,height:v.target.value})})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-end px-1",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600",children:"  ()"}),l.jsxs("span",{className:"text-[9px] text-stone-800 font-black uppercase tracking-widest",children:[": ",d.tags.length]})]}),l.jsx("div",{className:"flex flex-wrap gap-2 p-6 bg-black/30 border border-stone-900 rounded-[2rem] min-h-[80px] shadow-inner",children:t.length===0?l.jsx("p",{className:"text-stone-800 italic text-xs w-full text-center py-4",children:"     -"}):t.map(v=>{const k=d.tags.includes(v);return l.jsx("button",{type:"button",onClick:()=>x(v,!1),className:`px-4 py-2 rounded-xl text-[10px] uppercase tracking-wider font-black transition-all border ${k?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":"bg-stone-900/20 border-stone-800/40 text-stone-600 hover:border-stone-700 hover:text-stone-400"}`,children:v},v)})})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-end px-1",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-amber-600",children:"  ()"}),l.jsxs("span",{className:"text-[9px] text-amber-900/60 font-black uppercase tracking-widest",children:[": ",d.hiddenTags.length]})]}),l.jsx("div",{className:"flex flex-wrap gap-2 p-6 bg-black/30 border border-amber-900/20 rounded-[2rem] min-h-[80px] shadow-inner",children:r.length===0?l.jsx("p",{className:"text-stone-800 italic text-xs w-full text-center py-4",children:"    "}):r.map(v=>{const k=d.hiddenTags.includes(v);return l.jsx("button",{type:"button",onClick:()=>x(v,!0),className:`px-4 py-2 rounded-xl text-[10px] uppercase tracking-wider font-black transition-all border ${k?"bg-amber-500/10 border-amber-500/40 text-amber-400 shadow-[0_0_15px_rgba(245,158,11,0.1)]":"bg-stone-900/20 border-stone-800/40 text-stone-600 hover:border-amber-900/30 hover:text-amber-500/50"}`,children:v},v)})})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:" (  )"}),l.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[l.jsx("input",{className:"flex-grow bg-stone-900/30 border border-stone-800 rounded-2xl px-5 py-3 text-xs text-stone-500 outline-none focus:border-emerald-500/30 transition-all",placeholder:"    ...",value:d.imageUrl.startsWith("data:")?"":d.imageUrl,onChange:v=>f({...d,imageUrl:v.target.value})}),l.jsxs("label",{className:`cursor-pointer bg-stone-900/50 hover:bg-stone-800 px-5 py-3 rounded-2xl transition-all flex items-center justify-center border border-stone-800 gap-2 ${p?"opacity-50 cursor-wait":""}`,children:[l.jsx("input",{type:"file",accept:"image/*",onChange:C,className:"hidden",disabled:p}),l.jsx("svg",{className:"w-5 h-5 text-stone-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),d.imageUrl.startsWith("data:")&&l.jsx("span",{className:"text-[9px] font-bold text-emerald-500 uppercase tracking-wider",children:""})]})]}),d.imageUrl.startsWith("data:")&&l.jsx("p",{className:"text-[9px] text-emerald-500/70 px-2",children:"    ."})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 ml-1",children:" "}),l.jsx("textarea",{required:!0,rows:8,className:"w-full bg-stone-900/30 border border-stone-800 rounded-[2rem] px-8 py-6 text-stone-300 text-base leading-relaxed outline-none focus:border-emerald-900/30 transition-all resize-none shadow-inner custom-scrollbar",value:d.additionalInfo,onChange:v=>f({...d,additionalInfo:v.target.value})})]})]}),l.jsxs("div",{className:"p-6 md:p-10 border-t border-stone-900 bg-stone-900/10 flex gap-4 md:gap-6 shrink-0",children:[l.jsx("button",{type:"button",onClick:c,className:"flex-1 py-4 md:py-5 text-[10px] uppercase tracking-[0.3em] font-black text-stone-600 hover:text-stone-300 transition-all",children:""}),l.jsx("button",{onClick:y,disabled:p,className:"flex-[2] py-4 md:py-5 bg-white hover:bg-emerald-50 text-black rounded-2xl text-[10px] uppercase tracking-[0.3em] font-black transition-all shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",children:p?"...":""})]})]})})},cx=({characters:s,availableTags:t,availableHiddenTags:r,onDelete:o,onEdit:c,onAdd:d,onUpdateTags:f,onUpdateHiddenTags:p,onDownloadDB:g,onUploadDB:x})=>{const[C,y]=F.useState(""),[v,k]=F.useState(""),D=F.useRef(null),B=M=>{M.preventDefault();const L=C.trim().toLowerCase();L&&!t.includes(L)&&(f([...t,L]),y(""))},ne=M=>{M.preventDefault();const L=v.trim().toLowerCase();L&&!r.includes(L)&&(p([...r,L]),k(""))},ce=M=>{f(t.filter(L=>L!==M))},ie=M=>{p(r.filter(L=>L!==M))},ke=(M,L,_e=!1)=>{const ae=_e?[...r]:[...t],Ce=_e?p:f;L==="left"&&M>0?[ae[M-1],ae[M]]=[ae[M],ae[M-1]]:L==="right"&&M<ae.length-1&&([ae[M+1],ae[M]]=[ae[M],ae[M+1]]),Ce(ae)},le=(M=!1)=>{window.confirm(` ,      ${M?"":""} ?`)&&(M?p([]):f([]))},Oe=M=>{var ae;const L=(ae=M.target.files)==null?void 0:ae[0];if(!L)return;const _e=new FileReader;_e.onload=Ce=>{var je;const ve=(je=Ce.target)==null?void 0:je.result;typeof ve=="string"&&x(ve)},_e.readAsText(L),D.current&&(D.current.value="")},K=(M,L)=>l.jsx("div",{className:"flex flex-wrap gap-2 max-h-[300px] overflow-y-auto custom-scrollbar pr-2",children:M.length===0?l.jsx("p",{className:"text-stone-800 italic text-[10px] w-full text-center py-8",children:" ."}):M.map((_e,ae)=>l.jsxs("div",{className:`group flex items-center border rounded-xl pr-2 pl-1 py-1 transition-all hover:bg-stone-900 ${L?"bg-amber-900/10 border-amber-900/30 hover:border-amber-700":"bg-stone-900/50 border-stone-800/50 hover:border-stone-600"}`,children:[l.jsx("button",{onClick:()=>ke(ae,"left",L),disabled:ae===0,className:`p-1 text-stone-600 hover:text-emerald-500 transition-all ${ae===0?"opacity-0 pointer-events-none":"opacity-0 group-hover:opacity-100"}`,children:l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M15 19l-7-7 7-7"})})}),l.jsx("span",{className:`text-[10px] uppercase tracking-wider font-bold px-1 select-none ${L?"text-amber-500":"text-stone-500"}`,children:_e}),l.jsx("button",{onClick:()=>ke(ae,"right",L),disabled:ae===M.length-1,className:`p-1 text-stone-600 hover:text-emerald-500 transition-all ${ae===M.length-1?"opacity-0 pointer-events-none":"opacity-0 group-hover:opacity-100"}`,children:l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M9 5l7 7-7 7"})})}),l.jsx("div",{className:`w-px h-3 mx-1 ${L?"bg-amber-900/30":"bg-stone-800"}`}),l.jsx("button",{onClick:()=>L?ie(_e):ce(_e),className:"text-stone-700 hover:text-red-500 transition-colors ml-1",children:l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:l.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]},_e))});return l.jsxs("div",{className:"space-y-12 animate-in fade-in duration-700 pb-32",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-6 border-b border-stone-900/50 pb-8",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100",children:""}),l.jsx("p",{className:"text-stone-500 uppercase tracking-widest text-[10px]",children:"   "})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("input",{type:"file",ref:D,onChange:Oe,accept:".json",className:"hidden"}),l.jsxs("button",{onClick:()=>{var M;return(M=D.current)==null?void 0:M.click()},className:"px-5 py-2.5 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 rounded-lg text-[10px] uppercase tracking-widest font-bold text-emerald-500 transition-all flex items-center gap-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})," "]}),l.jsxs("button",{onClick:g,className:"px-5 py-2.5 bg-stone-900/80 hover:bg-stone-800 border border-stone-700 rounded-lg text-[10px] uppercase tracking-widest font-bold text-stone-300 transition-all flex items-center gap-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})," "]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[l.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("h2",{className:"text-2xl font-serif text-stone-100 italic",children:" "}),l.jsx("span",{className:"text-[10px] bg-emerald-500/10 text-emerald-500 px-2 py-0.5 rounded-full font-black",children:s.length})]}),l.jsx("button",{onClick:d,className:"bg-white hover:bg-emerald-50 text-black px-6 py-2 rounded-full text-[10px] uppercase tracking-widest font-black transition-all",children:""})]}),l.jsx("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl overflow-hidden shadow-xl",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-left min-w-[600px]",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-stone-900 bg-stone-900/20",children:[l.jsx("th",{className:"px-6 py-5 text-[10px] uppercase tracking-widest font-black text-stone-600",children:""}),l.jsx("th",{className:"px-6 py-5 text-[10px] uppercase tracking-widest font-black text-stone-600",children:""}),l.jsx("th",{className:"px-6 py-5 text-[10px] uppercase tracking-widest font-black text-stone-600 text-right",children:""})]})}),l.jsx("tbody",{className:"divide-y divide-stone-900/50",children:s.map(M=>{var L,_e,ae,Ce;return l.jsxs("tr",{className:"hover:bg-stone-900/10 transition-colors",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:l.jsx("img",{src:M.imageUrl,style:{objectFit:"cover",objectPosition:`${M.miniImageX??50}% ${M.miniImageY??50}%`,transformOrigin:`${M.miniImageX??50}% ${M.miniImageY??50}%`,transform:`scale(${M.miniImageScale??1})`},className:"w-full h-full",alt:""})}),l.jsx("span",{className:"font-bold text-stone-200 text-sm tracking-wide",children:M.name})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsxs("div",{className:"flex flex-wrap gap-1",children:[(L=M.tags)==null?void 0:L.slice(0,3).map(ve=>l.jsx("span",{className:"text-[8px] uppercase bg-stone-900 px-1.5 py-0.5 rounded text-stone-500",children:ve},ve)),(((_e=M.tags)==null?void 0:_e.length)||0)>3&&l.jsxs("span",{className:"text-[8px] text-stone-700",children:["+",M.tags.length-3]})]}),l.jsxs("div",{className:"flex flex-wrap gap-1",children:[(ae=M.hiddenTags)==null?void 0:ae.slice(0,3).map(ve=>l.jsx("span",{className:"text-[8px] uppercase bg-amber-900/20 border border-amber-900/30 px-1.5 py-0.5 rounded text-amber-600",children:ve},ve)),(((Ce=M.hiddenTags)==null?void 0:Ce.length)||0)>3&&l.jsxs("span",{className:"text-[8px] text-amber-700",children:["+",M.hiddenTags.length-3]})]})]})}),l.jsxs("td",{className:"px-6 py-4 text-right space-x-3",children:[l.jsx("button",{onClick:()=>c(M),className:"text-emerald-500/70 hover:text-emerald-500 text-[10px] font-black uppercase tracking-widest transition-colors",children:""}),l.jsx("button",{onClick:()=>o(M.id),className:"text-stone-800 hover:text-red-500 text-[10px] font-black uppercase tracking-widest transition-colors",children:""})]})]},M.id)})})]})})})]}),l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl p-6 space-y-6 shadow-xl",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h2",{className:"text-xl font-serif text-stone-100 italic",children:" "}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-[10px] bg-stone-800 text-stone-400 px-2 py-0.5 rounded-full font-black",children:t.length}),t.length>0&&l.jsx("button",{onClick:()=>le(!1),className:"text-[8px] text-red-900 hover:text-red-500 uppercase font-black",children:""})]})]}),l.jsxs("form",{onSubmit:B,className:"flex gap-2",children:[l.jsx("input",{type:"text",value:C,onChange:M=>y(M.target.value),placeholder:" ...",className:"flex-grow bg-black/50 border border-stone-800 rounded-xl px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-all"}),l.jsx("button",{className:"bg-stone-800 hover:bg-stone-700 text-white p-2 rounded-xl transition-all",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{d:"M12 4v16m8-8H4",strokeWidth:2.5})})})]}),K(t,!1)]}),l.jsxs("div",{className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl p-6 space-y-6 shadow-xl relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-amber-500/5 rounded-full blur-2xl -translate-y-10 translate-x-10 pointer-events-none"}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h2",{className:"text-xl font-serif text-amber-500 italic",children:" "}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-[10px] bg-amber-900/20 text-amber-500 px-2 py-0.5 rounded-full font-black",children:r.length}),r.length>0&&l.jsx("button",{onClick:()=>le(!0),className:"text-[8px] text-red-900 hover:text-red-500 uppercase font-black",children:""})]})]}),l.jsxs("form",{onSubmit:ne,className:"flex gap-2",children:[l.jsx("input",{type:"text",value:v,onChange:M=>k(M.target.value),placeholder:"  ...",className:"flex-grow bg-black/50 border border-amber-900/30 rounded-xl px-3 py-2 text-xs text-stone-200 outline-none focus:border-amber-500/50 transition-all placeholder-amber-900/50"}),l.jsx("button",{className:"bg-amber-900/20 hover:bg-amber-900/40 text-amber-500 border border-amber-900/30 p-2 rounded-xl transition-all",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{d:"M12 4v16m8-8H4",strokeWidth:2.5})})})]}),K(r,!0)]})]})]})]})},ux="modulepreload",dx=function(s){return"/raz/"+s},yf={},_f=function(t,r,o){let c=Promise.resolve();if(r&&r.length>0){let f=function(x){return Promise.all(x.map(C=>Promise.resolve(C).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),g=(p==null?void 0:p.nonce)||(p==null?void 0:p.getAttribute("nonce"));c=f(r.map(x=>{if(x=dx(x),x in yf)return;yf[x]=!0;const C=x.endsWith(".css"),y=C?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${y}`))return;const v=document.createElement("link");if(v.rel=C?"stylesheet":ux,C||(v.as="script"),v.crossOrigin="",v.href=x,g&&v.setAttribute("nonce",g),document.head.appendChild(v),C)return new Promise((k,D)=>{v.addEventListener("load",k),v.addEventListener("error",()=>D(new Error(`Unable to preload CSS for ${x}`)))})}))}function d(f){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=f,window.dispatchEvent(p),!p.defaultPrevented)throw f}return c.then(f=>{for(const p of f||[])p.status==="rejected"&&d(p.reason);return t().catch(d)})},hx=({characters:s,availableTags:t,availableHiddenTags:r,filterStates:o,onToggleTag:c,onClearFilters:d,onSelectCharacter:f})=>{var ge;const[p,g]=F.useState("graph"),[x,C]=F.useState(""),[y,v]=F.useState(!1),[k,D]=F.useState(""),[B,ne]=F.useState([]),ce=F.useRef(null),[ie,ke]=F.useState(!1),[le,Oe]=F.useState(null),[K,M]=F.useState(null),[L,_e]=F.useState(0),[ae,Ce]=F.useState(!0),[ve,je]=F.useState(!1),Qe=F.useRef(null),Ee=F.useRef(null),Be=F.useRef(null),ee=F.useRef(null),Y=F.useRef(new Map),[q,w]=F.useState({x:0,y:0,k:1}),$=Object.keys(o).length;F.useEffect(()=>{if(p==="graph"){je(!0);const j=setTimeout(()=>je(!1),2200);return()=>clearTimeout(j)}},[le,ie,$,p]),F.useEffect(()=>{const j=se=>{ce.current&&!ce.current.contains(se.target)&&v(!1)};return y&&document.addEventListener("mousedown",j),()=>{document.removeEventListener("mousedown",j)}},[y]);const{nodes:te,links:he,uniqueColors:O}=F.useMemo(()=>{if(p!=="graph")return{nodes:[],links:[],uniqueColors:[]};const j=s.filter(G=>le&&G.id===le?!0:Object.entries(o).every(([z,pe])=>{var rn,Vt;const Re=(rn=G.tags)==null?void 0:rn.includes(z),De=(Vt=G.hiddenTags)==null?void 0:Vt.includes(z),He=Re||De;return pe==="include"?He:pe==="exclude"?!He:!0})),se=new Set(j.map(G=>G.id)),xe=new Set;le&&(xe.add(le),j.forEach(G=>{var z,pe;G.id===le&&((z=G.connections)==null||z.forEach(Re=>{se.has(Re.id)&&xe.add(Re.id)})),(pe=G.connections)!=null&&pe.some(Re=>Re.id===le)&&xe.add(G.id)}));const Ie=new Map,Te=[...t],$e=380,Me=260;Te.forEach((G,z)=>{const pe=z/Te.length*2*Math.PI;Ie.set(G,{x:500+Math.cos(pe)*$e,y:350+Math.sin(pe)*Me})});const b=j.map(G=>{const z=Y.current.get(G.id);let pe=!1;if(le)pe=!xe.has(G.id);else if(ie){const He=G.connections||[],rn=j.filter(Vt=>{var lr;return Vt.id!==G.id&&((lr=Vt.connections)==null?void 0:lr.some(ar=>ar.id===G.id))});pe=He.length+rn.length===0}let Re=500,De=350;if(!z)if(G.tags&&G.tags.length>0){let He=0,rn=0,Vt=0;G.tags.forEach(lr=>{const ar=Ie.get(lr);ar&&(He+=ar.x,rn+=ar.y,Vt++)}),Vt>0?(Re=He/Vt,De=rn/Vt,Re+=(Math.random()-.5)*80,De+=(Math.random()-.5)*80):(Re+=(Math.random()-.5)*150,De+=(Math.random()-.5)*150)}else Re+=(Math.random()-.5)*120,De+=(Math.random()-.5)*120;return{id:G.id,name:G.name,imageUrl:G.imageUrl,miniImageScale:G.miniImageScale,miniImageX:G.miniImageX,miniImageY:G.miniImageY,x:(z==null?void 0:z.x)??Re,y:(z==null?void 0:z.y)??De,vx:z==null?void 0:z.vx,vy:z==null?void 0:z.vy,isDimmed:pe,tags:G.tags,hiddenTags:G.hiddenTags}}),re=new Map;b.forEach(G=>re.set(G.id,G)),Y.current=re;const P=[],J=new Set,ue=new Map;return j.forEach(G=>{var z;(z=G.connections)==null||z.forEach(pe=>{if(se.has(pe.id)){const Re=pe.color||"#10b981";J.add(Re);let De=!1;le&&(De=G.id!==le&&pe.id!==le),P.push({source:G.id,target:pe.id,role:pe.role,color:Re,isDouble:!1,isHidden:De}),ue.set(`${G.id}-${pe.id}`,!0)}})}),P.forEach(G=>{const z=typeof G.source=="string"?G.source:G.source.id,pe=typeof G.target=="string"?G.target:G.target.id;ue.has(`${pe}-${z}`)&&(G.isDouble=!0)}),{nodes:b,links:P,uniqueColors:Array.from(J)}},[s,ie,le,o,t,p]),A=j=>{if(!Qe.current||!ee.current)return;const se=te.find(xe=>xe.id===j);!se||se.x===void 0||se.y===void 0||_f(()=>import("https://esm.sh/d3@7"),[]).then(xe=>{const Ie=xe.select(Qe.current),Te=1e3,$e=700,Me=.8,b=Te/2-se.x*Me,re=$e/2-se.y*Me;Ie.transition().duration(1200).ease(xe.easePolyInOut.exponent(3)).call(ee.current.transform,xe.zoomIdentity.translate(b,re).scale(Me))})};F.useEffect(()=>{if(le&&p==="graph"){const j=setTimeout(()=>A(le),100);return()=>clearTimeout(j)}},[le,p]),F.useEffect(()=>{!Qe.current||p!=="graph"||(Ce(!0),_f(()=>import("https://esm.sh/d3@7"),[]).then(j=>{const se=j.select(Qe.current),xe=j.select(Ee.current),Ie=j.zoom().scaleExtent([.1,4]).on("zoom",Me=>{xe.attr("transform",Me.transform),w({x:Me.transform.x,y:Me.transform.y,k:Me.transform.k}),M(null)});ee.current=Ie,se.call(Ie);const Te=j.forceSimulation(te).velocityDecay(.4).force("link",j.forceLink(he.filter(Me=>!Me.isHidden)).id(Me=>Me.id).distance(Me=>{const b=Me.source.tags||[],re=Me.target.tags||[],P=b.some(J=>re.includes(J));return b.length===0||re.length===0?250:P?150:450}).strength(le?.05:.03)).force("charge",j.forceManyBody().strength(le?-5e3:-3500)).force("x",j.forceX(500).strength(.05)).force("y",j.forceY(350).strength(.05)).force("collision",j.forceCollide().radius(90)).alphaDecay(.05);Te.on("tick",()=>{_e(Me=>Me+1),Te.alpha()<.2&&Ce(!1)}),Be.current=Te;const $e=Me=>{function b(J,ue){J.active||Me.alphaTarget(.3).restart(),ue.fx=ue.x,ue.fy=ue.y,M(null)}function re(J,ue){ue.fx=J.x,ue.fy=J.y}function P(J,ue){J.active||Me.alphaTarget(0),ue.fx=null,ue.fy=null}return j.drag().on("start",b).on("drag",re).on("end",P)};return xe.selectAll(".node-group").data(te).call($e(Te)),()=>Te.stop()}))},[te,he,p]);const U=j=>{const se=typeof j.source=="string"?te.find(Re=>Re.id===j.source):j.source,xe=typeof j.target=="string"?te.find(Re=>Re.id===j.target):j.target;if(!(se!=null&&se.x)||!(se!=null&&se.y)||!(xe!=null&&xe.x)||!(xe!=null&&xe.y))return null;const Ie=52,Te=xe.x-se.x,$e=xe.y-se.y,Me=Math.sqrt(Te*Te+$e*$e);if(Me<Ie*2.2)return null;const b=Te/Me,re=$e/Me,P=se.x+Ie*b,J=se.y+Ie*re,ue=xe.x-Ie*b,G=xe.y-Ie*re;let z="",pe={x:0,y:0};if(j.isDouble){const De=(se.x+xe.x)/2+-re*50,He=(se.y+xe.y)/2+b*50;z=`M${P},${J} Q${De},${He} ${ue},${G}`,pe.x=.25*P+.5*De+.25*ue,pe.y=.25*J+.5*He+.25*G}else z=`M${P},${J} L${ue},${G}`,pe.x=(P+ue)/2,pe.y=(J+G)/2;return{path:z,textPos:pe}},we=j=>j.replace("#",""),Se=j=>{ne(se=>se.includes(j)?se.filter(xe=>xe!==j):[...se,j])},qe=F.useMemo(()=>s.filter(j=>{const se=j.name.toLowerCase().includes(k.toLowerCase()),xe=B.length===0||B.every(Ie=>{var Te,$e;return((Te=j.tags)==null?void 0:Te.includes(Ie))||(($e=j.hiddenTags)==null?void 0:$e.includes(Ie))});return se&&xe}).sort((j,se)=>j.name.localeCompare(se.name)),[s,k,B]),{outgoingConnections:ft,incomingConnections:R,currentTableChar:Q}=F.useMemo(()=>{if(p!=="table"||!x)return{outgoingConnections:[],incomingConnections:[],currentTableChar:null};const j=s.find(Ie=>Ie.id===x),se=((j==null?void 0:j.connections)||[]).map(Ie=>{const Te=s.find($e=>$e.id===Ie.id);return{...Ie,targetChar:Te}}),xe=s.filter(Ie=>{var Te;return(Te=Ie.connections)==null?void 0:Te.some($e=>$e.id===x)}).map(Ie=>{var $e;const Te=($e=Ie.connections)==null?void 0:$e.find(Me=>Me.id===x);return{sourceChar:Ie,role:Te==null?void 0:Te.role,color:Te==null?void 0:Te.color}});return{outgoingConnections:se,incomingConnections:xe,currentTableChar:j}},[s,x,p]);return l.jsxs("div",{className:`flex flex-col h-full space-y-4 md:space-y-4 select-none relative ${ve?"is-mounting":""}`,onClick:()=>M(null),children:[l.jsxs("div",{className:"bg-[#0f0f0f]/50 border border-stone-900 rounded-2xl p-4 flex flex-col gap-4 backdrop-blur-sm shadow-lg relative z-20",children:[l.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[l.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[l.jsxs("div",{className:"bg-stone-950 p-1 rounded-lg border border-stone-800 flex items-center",children:[l.jsx("button",{onClick:()=>g("graph"),className:`px-4 py-1.5 rounded-md text-[10px] uppercase font-bold tracking-wider transition-all ${p==="graph"?"bg-stone-800 text-stone-100 shadow-sm":"text-stone-500 hover:text-stone-300"}`,children:""}),l.jsx("button",{onClick:()=>g("table"),className:`px-4 py-1.5 rounded-md text-[10px] uppercase font-bold tracking-wider transition-all ${p==="table"?"bg-stone-800 text-stone-100 shadow-sm":"text-stone-500 hover:text-stone-300"}`,children:""})]}),p==="graph"&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"h-6 w-px bg-stone-800 hidden md:block"}),l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[l.jsx("input",{type:"checkbox",checked:ie,disabled:!!le,onChange:j=>ke(j.target.checked),className:"sr-only"}),l.jsx("div",{className:`w-4 h-4 border border-stone-700 rounded transition-colors ${ie?"bg-emerald-600 border-emerald-500":"bg-transparent"}`,children:ie&&l.jsx("svg",{className:"w-3.5 h-3.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),l.jsx("span",{className:`text-[11px] uppercase tracking-wider font-bold text-stone-500 group-hover:text-stone-300 transition-colors ${le?"opacity-30":""}`,children:" "})]})]})]}),p==="graph"?le&&l.jsx("button",{onClick:()=>{Oe(null),Ce(!0)},className:"w-full md:w-auto bg-emerald-950/30 border border-emerald-900/50 text-emerald-500 px-4 py-2 rounded-full text-[10px] uppercase tracking-[0.2em] font-black hover:bg-emerald-900/40 transition-all",children:" "}):l.jsxs("div",{className:"w-full md:w-80 relative z-50",ref:ce,children:[l.jsxs("button",{onClick:()=>v(!y),className:"w-full bg-stone-950 border border-stone-800 text-stone-300 text-xs py-2.5 pl-4 pr-10 rounded-xl text-left focus:border-emerald-900 transition-colors flex items-center justify-between",children:[l.jsx("span",{className:x?"":"text-stone-500 italic",children:x?(ge=s.find(j=>j.id===x))==null?void 0:ge.name:"--   --"}),l.jsx("svg",{className:`w-4 h-4 text-stone-600 transition-transform ${y?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),y&&l.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-[#0a0a0a] border border-stone-800 rounded-xl shadow-2xl overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200 flex flex-col max-h-[400px]",children:[l.jsxs("div",{className:"p-3 bg-stone-900/50 border-b border-stone-900 space-y-3 shrink-0 backdrop-blur-md",children:[l.jsx("input",{type:"text",placeholder:"...",value:k,onChange:j=>D(j.target.value),className:"w-full bg-stone-950 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-colors",autoFocus:!0}),(t.length>0||r.length>0)&&l.jsxs("div",{className:"flex flex-wrap gap-1.5 max-h-20 overflow-y-auto custom-scrollbar",children:[t.map(j=>{const se=B.includes(j);return l.jsx("button",{onClick:()=>Se(j),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${se?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:j},j)}),r.map(j=>{const se=B.includes(j);return l.jsx("button",{onClick:()=>Se(j),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${se?"bg-amber-500/20 border-amber-500/40 text-amber-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-amber-500"}`,children:j},j)})]})]}),l.jsx("div",{className:"overflow-y-auto p-1 custom-scrollbar",children:qe.length>0?qe.map(j=>l.jsxs("button",{onClick:()=>{C(j.id),v(!1),D(""),ne([])},className:`w-full flex items-center gap-3 p-2 hover:bg-stone-900 rounded-lg text-left transition-colors group ${x===j.id?"bg-stone-900/80":""}`,children:[l.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:l.jsx("img",{src:j.imageUrl,style:{objectPosition:`${j.miniImageX??50}% ${j.miniImageY??50}%`,transform:`scale(${j.miniImageScale??1})`,transformOrigin:`${j.miniImageX??50}% ${j.miniImageY??50}%`},className:"w-full h-full object-cover",alt:""})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("span",{className:`text-xs font-bold block truncate ${x===j.id?"text-emerald-400":"text-stone-300"}`,children:j.name}),j.tags&&j.tags.length>0&&l.jsxs("span",{className:"text-[8px] text-stone-600 truncate block mt-0.5",children:[j.tags.slice(0,3).join(", "),j.tags.length>3?"...":""]})]}),x===j.id&&l.jsx("div",{className:"ml-auto text-emerald-500",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]},j.id)):l.jsx("div",{className:"text-center py-4 text-[10px] text-stone-600 italic",children:"  "})})]})]})]}),p==="graph"&&(t.length>0||r.length>0)&&l.jsxs("div",{className:"flex flex-wrap items-center gap-2 pt-3 border-t border-stone-800/50 animate-in fade-in slide-in-from-top-1 duration-500",children:[l.jsx("span",{className:"text-[9px] uppercase tracking-[0.2em] font-black text-stone-600 mr-2",children:":"}),t.map(j=>{const se=o[j]||"none";return l.jsxs("button",{onClick:()=>c(j),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${se==="include"?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":se==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-stone-400 hover:border-stone-700"}`,children:[se==="include"&&l.jsx("span",{className:"text-emerald-500",children:"+"}),se==="exclude"&&l.jsx("span",{className:"text-red-500",children:""}),j]},j)}),r.map(j=>{const se=o[j]||"none";return l.jsxs("button",{onClick:()=>c(j),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${se==="include"?"bg-amber-500/10 border-amber-500/40 text-amber-400 shadow-[0_0_15px_rgba(245,158,11,0.1)]":se==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-amber-500 hover:border-amber-900/30"}`,children:[se==="include"&&l.jsx("span",{className:"text-amber-500",children:"+"}),se==="exclude"&&l.jsx("span",{className:"text-red-500",children:""}),j]},j)}),$>0&&l.jsx("button",{onClick:d,className:"ml-2 text-[9px] uppercase tracking-[0.2em] font-black text-stone-700 hover:text-red-500 transition-colors",children:""})]})]}),l.jsxs("div",{className:"relative z-0 w-full h-full min-h-[500px] bg-[#030303] border border-stone-900 rounded-2xl overflow-hidden shadow-2xl graph-container-reveal",children:[p==="graph"&&l.jsxs(l.Fragment,{children:[l.jsxs("svg",{ref:Qe,viewBox:"0 0 1000 700",className:"w-full h-full touch-none cursor-grab active:cursor-grabbing",children:[l.jsx("defs",{children:O.map(j=>l.jsx("marker",{id:`arrow-${we(j)}`,markerWidth:"8",markerHeight:"6",refX:"7.5",refY:"3",orient:"auto",children:l.jsx("path",{d:"M0,0 L8,3 L0,6",fill:j})},`arrow-${we(j)}`))}),l.jsxs("g",{ref:Ee,children:[he.map((j,se)=>{const xe=U(j);if(!xe)return null;const Ie=j.color||"#10b981",Te=j.isHidden;return l.jsxs("g",{className:`transition-opacity duration-700 ${Te?"opacity-0":"opacity-100"}`,children:[l.jsx("path",{d:xe.path,fill:"none",stroke:Ie,strokeWidth:le?"3":"1.5",strokeOpacity:le?"0.8":"0.3",markerEnd:`url(#arrow-${we(Ie)})`,className:"link-path",style:ve?{animationDelay:`${se*.015}s`}:{}}),le&&j.role&&!Te&&l.jsxs("g",{transform:`translate(${xe.textPos.x}, ${xe.textPos.y})`,children:[l.jsx("text",{dy:"-14",textAnchor:"middle",className:"fill-[#030303] text-[10px] font-bold uppercase tracking-[0.2em]",style:{paintOrder:"stroke",stroke:"#030303",strokeWidth:"5px"},children:j.role}),l.jsx("text",{dy:"-14",textAnchor:"middle",fill:Ie,className:"text-[10px] font-bold uppercase tracking-[0.2em] opacity-90",children:j.role})]})]},`link-${se}-${L}`)}),te.map((j,se)=>{const xe=le===j.id;return l.jsx("g",{transform:`translate(${j.x||500}, ${j.y||350})`,className:`node-group cursor-pointer group ${j.isDimmed?"opacity-0 pointer-events-none":"opacity-100"}`,onClick:Ie=>{if(Ie.stopPropagation(),j.x&&j.y){const Te=j.x*q.k+q.x,$e=j.y*q.k+q.y;M({id:j.id,x:Te,y:$e})}},children:l.jsxs("g",{className:"node-animator",style:ve?{animationDelay:`${se*.06}s`}:{},children:[l.jsxs("g",{className:"node-content",children:[l.jsx("circle",{r:"48",fill:"#1c1917"}),l.jsx("circle",{r:"46",fill:"#050505",stroke:xe?"#10b981":"#292524",strokeWidth:xe?"4":"1.5"}),l.jsx("clipPath",{id:`clip-${j.id}`,children:l.jsx("circle",{r:"45"})}),l.jsx("foreignObject",{x:"-45",y:"-45",width:"90",height:"90",clipPath:`url(#clip-${j.id})`,children:l.jsx("div",{className:"w-full h-full bg-black flex items-center justify-center overflow-hidden",children:l.jsx("img",{src:j.imageUrl,alt:"",style:{width:"100%",height:"100%",objectFit:"cover",objectPosition:`${j.miniImageX??50}% ${j.miniImageY??50}%`,transformOrigin:`${j.miniImageX??50}% ${j.miniImageY??50}%`,transform:`scale(${j.miniImageScale??1})`},className:"opacity-90 group-hover:opacity-100 group-hover:scale-110 transition-all duration-500"})})})]}),l.jsx("text",{y:"70",textAnchor:"middle",className:"fill-stone-500 text-[12px] font-bold uppercase tracking-[0.15em] group-hover:fill-stone-100 transition-colors drop-shadow-[0_2px_2px_rgba(0,0,0,0.8)] font-serif",children:j.name})]})},j.id)})]})]}),ae&&l.jsx("div",{className:"absolute inset-0 bg-[#030303]/40 flex items-center justify-center backdrop-blur-[1px] pointer-events-none",children:l.jsx("div",{className:"text-[10px] uppercase tracking-[0.4em] font-black text-emerald-500/50 animate-pulse",children:" ..."})})]}),p==="table"&&l.jsx("div",{className:"w-full h-full overflow-y-auto custom-scrollbar p-6 md:p-10",children:x?l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16",children:[l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center gap-3 border-b border-stone-800 pb-4",children:[l.jsx("span",{className:"text-emerald-500 bg-emerald-900/10 px-2 py-1 rounded text-xs font-bold",children:"OUT"}),l.jsxs("h3",{className:"text-lg font-serif text-stone-200 italic",children:["  ",Q==null?void 0:Q.name,"?"]}),l.jsx("span",{className:"ml-auto text-stone-600 text-xs font-bold",children:ft.length})]}),l.jsx("div",{className:"space-y-3",children:ft.length===0?l.jsx("p",{className:"text-stone-700 text-xs italic py-4",children:"       ..."}):ft.map((j,se)=>{var xe,Ie,Te,$e,Me,b;return l.jsxs("div",{className:"flex items-start gap-4 p-4 bg-stone-900/30 border border-stone-900/50 rounded-xl hover:bg-stone-900/50 hover:border-emerald-900/30 transition-all group",children:[l.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:l.jsx("img",{src:(xe=j.targetChar)==null?void 0:xe.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${((Ie=j.targetChar)==null?void 0:Ie.miniImageX)??50}% ${((Te=j.targetChar)==null?void 0:Te.miniImageY)??50}%`,transform:`scale(${(($e=j.targetChar)==null?void 0:$e.miniImageScale)??1})`,transformOrigin:`${((Me=j.targetChar)==null?void 0:Me.miniImageX)??50}% ${((b=j.targetChar)==null?void 0:b.miniImageY)??50}%`},alt:""})}),l.jsxs("div",{className:"flex-grow min-w-0",children:[l.jsxs("div",{className:"flex justify-between items-baseline",children:[l.jsx("h4",{className:"text-stone-300 font-bold text-sm truncate",children:j.name}),l.jsx("button",{onClick:()=>f(j.id),className:"text-[9px] uppercase font-bold text-stone-700 hover:text-emerald-500 transition-colors opacity-0 group-hover:opacity-100",children:""})]}),l.jsx("p",{className:"text-stone-500 text-xs mt-1 font-medium",children:j.role})]}),l.jsx("div",{className:"w-1.5 h-8 rounded-full self-center",style:{backgroundColor:j.color||"#10b981"}})]},se)})})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center gap-3 border-b border-stone-800 pb-4",children:[l.jsx("span",{className:"text-blue-500 bg-blue-900/10 px-2 py-1 rounded text-xs font-bold",children:"IN"}),l.jsxs("h3",{className:"text-lg font-serif text-stone-200 italic",children:["  ",Q==null?void 0:Q.name,"?"]}),l.jsx("span",{className:"ml-auto text-stone-600 text-xs font-bold",children:R.length})]}),l.jsx("div",{className:"space-y-3",children:R.length===0?l.jsx("p",{className:"text-stone-700 text-xs italic py-4",children:"    ..."}):R.map((j,se)=>{var xe,Ie,Te,$e,Me,b,re;return l.jsxs("div",{className:"flex items-start gap-4 p-4 bg-stone-900/30 border border-stone-900/50 rounded-xl hover:bg-stone-900/50 hover:border-blue-900/30 transition-all group",children:[l.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden border border-stone-800 bg-black shrink-0",children:l.jsx("img",{src:(xe=j.sourceChar)==null?void 0:xe.imageUrl,className:"w-full h-full object-cover",style:{objectPosition:`${((Ie=j.sourceChar)==null?void 0:Ie.miniImageX)??50}% ${((Te=j.sourceChar)==null?void 0:Te.miniImageY)??50}%`,transform:`scale(${(($e=j.sourceChar)==null?void 0:$e.miniImageScale)??1})`,transformOrigin:`${((Me=j.sourceChar)==null?void 0:Me.miniImageX)??50}% ${((b=j.sourceChar)==null?void 0:b.miniImageY)??50}%`},alt:""})}),l.jsxs("div",{className:"flex-grow min-w-0",children:[l.jsxs("div",{className:"flex justify-between items-baseline",children:[l.jsx("h4",{className:"text-stone-300 font-bold text-sm truncate",children:(re=j.sourceChar)==null?void 0:re.name}),l.jsx("button",{onClick:()=>f(j.sourceChar.id),className:"text-[9px] uppercase font-bold text-stone-700 hover:text-blue-500 transition-colors opacity-0 group-hover:opacity-100",children:""})]}),l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx("span",{className:"text-stone-600 text-[10px] uppercase tracking-wider",children:"  :"}),l.jsx("p",{className:"text-stone-400 text-xs font-medium",children:j.role})]})]}),l.jsx("div",{className:"w-1.5 h-8 rounded-full self-center",style:{backgroundColor:j.color||"#10b981"}})]},se)})})]})]}):l.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-stone-600 space-y-4",children:[l.jsx("svg",{className:"w-16 h-16 opacity-30",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),l.jsx("p",{className:"text-sm italic font-serif opacity-70",children:"    ,    "})]})}),K&&p==="graph"&&l.jsx("div",{className:"absolute z-[100] animate-in zoom-in-95 fade-in duration-300",style:{left:K.x+40,top:K.y-40},onClick:j=>j.stopPropagation(),children:l.jsxs("div",{className:"bg-[#0f0f0f]/95 border border-stone-800 rounded-xl overflow-hidden shadow-2xl min-w-[200px] backdrop-blur-md",children:[l.jsx("button",{onClick:()=>f(K.id),className:"w-full text-left px-5 py-3 text-[11px] uppercase tracking-wider font-bold text-stone-200 hover:bg-emerald-900/40 border-b border-stone-900",children:" "}),l.jsx("button",{onClick:()=>{Oe(K.id),M(null),Ce(!0)},className:"w-full text-left px-5 py-3 text-[11px] uppercase tracking-wider font-bold text-emerald-400 hover:bg-emerald-900/40",children:" "})]})})]})]})},fx=({realms:s,worlds:t,characters:r,availableTags:o,availableHiddenTags:c,onUpdateRealms:d,onUpdateWorlds:f,isAdmin:p})=>{var se,xe,Ie,Te,$e,Me,b,re;const[g,x]=F.useState(null),[C,y]=F.useState(null);F.useEffect(()=>{window.scrollTo(0,0)},[g,C]);const[v,k]=F.useState(!1),[D,B]=F.useState(!1),[ne,ce]=F.useState(!1),[ie,ke]=F.useState(null),[le,Oe]=F.useState(!1),[K,M]=F.useState(""),[L,_e]=F.useState(!1),[ae,Ce]=F.useState({}),[ve,je]=F.useState({type:""}),[Qe,Ee]=F.useState(""),[Be,ee]=F.useState([]),Y=s.find(P=>P.id===g),q=t.find(P=>P.id===C),w=t.filter(P=>P.realmId===g),$=P=>{var J,ue;for(const G of t){if((J=G.characterIds)!=null&&J.includes(P))return G.name;if(G.subLocations){for(const z of G.subLocations)if((ue=z.characterIds)!=null&&ue.includes(P))return`${G.name} / ${z.name}`}}return null},te=P=>{Ce(P||{}),k(!0)},he=()=>{if(!ae.name)return;let P;if(ae.id)P=s.map(J=>J.id===ae.id?{...J,...ae}:J);else{const J={id:Date.now().toString(),name:ae.name,imageUrl:ae.imageUrl||"https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=1080&auto=format&fit=crop"};P=[...s,J]}d(P),k(!1),Ce({})},O=P=>{window.confirm("  ?  ,   .")&&(d(s.filter(J=>J.id!==P)),g===P&&x(null))},A=P=>{je(P||{type:"",realmId:g}),B(!0)},U=()=>{if(!ve.name||!g)return;let P;if(ve.id)P=t.map(J=>J.id===ve.id?{...J,...ve}:J);else{const J={id:Date.now().toString(),realmId:g,name:ve.name,type:ve.type||"",description:ve.description||"",imageUrl:ve.imageUrl||"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?q=80&w=800&auto=format&fit=crop",characterIds:[],subLocations:[]};P=[...t,J]}f(P),B(!1),je({type:""})},we=P=>{window.confirm("  ?")&&(f(t.filter(J=>J.id!==P)),C===P&&y(null))},Se=()=>{if(!q||!K.trim())return;const P={id:Date.now().toString(),name:K.trim(),characterIds:[]},J=t.map(ue=>ue.id===q.id?{...ue,subLocations:[...ue.subLocations||[],P]}:ue);f(J),M(""),Oe(!1)},qe=P=>{if(!q||!window.confirm("  ?        ."))return;const J=t.map(ue=>ue.id===q.id?{...ue,subLocations:(ue.subLocations||[]).filter(G=>G.id!==P)}:ue);f(J)},ft=P=>{if(!q)return;let J={...q};if(ie){const G=J.subLocations?[...J.subLocations]:[],z=G.findIndex(pe=>pe.id===ie);if(z>-1){const pe=G[z].characterIds||[],Re=pe.includes(P)?pe.filter(De=>De!==P):[...pe,P];G[z]={...G[z],characterIds:Re},J.subLocations=G}}else{const G=J.characterIds||[],z=G.includes(P)?G.filter(pe=>pe!==P):[...G,P];J.characterIds=z}const ue=t.map(G=>G.id===q.id?J:G);f(ue)},R=P=>{ee(J=>J.includes(P)?J.filter(ue=>ue!==P):[...J,P])},Q=(P=null)=>{ke(P),Ee(""),ee([]),ce(!0)},ge=async P=>{var ue;const J=(ue=P.target.files)==null?void 0:ue[0];if(J){_e(!0);try{const G=await zo(J);Ce(z=>({...z,imageUrl:G}))}finally{_e(!1)}}},j=async P=>{var ue;const J=(ue=P.target.files)==null?void 0:ue[0];if(J){_e(!0);try{const G=await zo(J);je(z=>({...z,imageUrl:G}))}finally{_e(!1)}}};if(C&&q){const P=ie?((xe=(se=q.subLocations)==null?void 0:se.find(z=>z.id===ie))==null?void 0:xe.characterIds)||[]:q.characterIds||[],J=r.filter(z=>!P.includes(z.id)),ue=J.filter(z=>{const pe=z.name.toLowerCase().includes(Qe.toLowerCase());if(Be.length===0)return pe;const Re=[...z.tags||[],...z.hiddenTags||[]];return pe&&Be.every(De=>Re.includes(De))}),G=(z,pe)=>{const Re=z||[],De=r.filter(He=>Re.includes(He.id));return De.length===0?l.jsx("p",{className:"text-stone-600 italic text-sm py-4",children:"  ..."}):l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:De.map((He,rn)=>l.jsxs("div",{style:{animationDelay:`${rn*50}ms`,animationFillMode:"both"},className:"animate-slide-up-fade bg-stone-900/30 border border-stone-800 rounded-xl p-3 flex items-center gap-3 group relative hover:bg-stone-900/50 hover:border-stone-700 transition-all",children:[l.jsx("div",{className:"w-10 h-10 rounded-full bg-black border border-stone-700 overflow-hidden shrink-0",children:l.jsx("img",{src:He.imageUrl,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",alt:"",style:{objectPosition:`${He.miniImageX??50}% ${He.miniImageY??50}%`,transform:`scale(${He.miniImageScale??1})`,transformOrigin:`${He.miniImageX??50}% ${He.miniImageY??50}%`}})}),l.jsx("span",{className:"text-stone-300 font-bold text-sm truncate group-hover:text-emerald-400 transition-colors",children:He.name}),p&&l.jsx("button",{onClick:()=>{ke(pe),setTimeout(()=>ft(He.id),0)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-stone-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all p-2",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},He.id))})};return l.jsxs("div",{className:"space-y-8 animate-epic-reveal pb-20",children:[l.jsxs("div",{className:"flex flex-col gap-6",children:[l.jsxs("button",{onClick:()=>y(null),className:"self-start flex items-center gap-2 text-stone-500 hover:text-emerald-500 transition-colors group",children:[l.jsx("svg",{className:"w-5 h-5 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsxs("span",{className:"text-xs font-bold uppercase tracking-widest",children:["  ",Y==null?void 0:Y.name]})]}),l.jsxs("div",{className:"relative h-[300px] md:h-[400px] rounded-3xl overflow-hidden border border-stone-900 group shadow-2xl animate-slide-up-fade",style:{animationDelay:"0.1s"},children:[l.jsx("img",{src:q.imageUrl,className:"w-full h-full object-cover transition-transform duration-[3s] ease-out group-hover:scale-105",alt:q.name}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#050505] via-transparent to-transparent opacity-90"}),l.jsx("div",{className:"absolute bottom-0 left-0 p-8 md:p-12 w-full",children:l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4",children:[l.jsxs("div",{className:"animate-slide-up-fade",style:{animationDelay:"0.2s"},children:[l.jsx("div",{className:"inline-block px-3 py-1 bg-emerald-900/40 border border-emerald-500/30 rounded-lg text-emerald-400 text-[10px] font-bold uppercase tracking-widest mb-3 backdrop-blur-md",children:q.type}),l.jsx("h1",{className:"text-4xl md:text-6xl font-serif font-medium text-stone-100 drop-shadow-xl",children:q.name})]}),p&&l.jsxs("div",{className:"flex gap-3 animate-slide-up-fade",style:{animationDelay:"0.3s"},children:[l.jsx("button",{onClick:()=>A(q),className:"bg-white/10 hover:bg-white/20 backdrop-blur-md text-stone-200 px-5 py-2 rounded-full text-[10px] uppercase font-bold tracking-widest transition-all border border-white/10",children:""}),l.jsx("button",{onClick:()=>we(q.id),className:"bg-red-900/20 hover:bg-red-900/40 backdrop-blur-md text-red-400 px-5 py-2 rounded-full text-[10px] uppercase font-bold tracking-widest transition-all border border-red-900/30",children:""})]})]})})]}),l.jsx("div",{className:"max-w-4xl animate-slide-up-fade",style:{animationDelay:"0.4s"},children:l.jsx("p",{className:"text-lg md:text-xl font-serif text-stone-300 leading-relaxed whitespace-pre-wrap",children:q.description})}),l.jsx("div",{className:"h-px bg-stone-900 w-full my-4"}),l.jsxs("div",{className:"space-y-10",children:[l.jsxs("div",{className:"space-y-4 animate-slide-up-fade",style:{animationDelay:"0.5s"},children:[l.jsxs("div",{className:"flex justify-between items-center border-b border-stone-800/50 pb-2",children:[l.jsx("h3",{className:"text-xl font-serif text-stone-200 italic",children:" "}),p&&l.jsx("button",{onClick:()=>Q(null),className:"text-emerald-500 hover:text-emerald-400 text-[10px] uppercase font-bold tracking-widest transition-colors flex items-center gap-2",children:"+ "})]}),G(q.characterIds||[],null)]}),(Ie=q.subLocations)==null?void 0:Ie.map((z,pe)=>l.jsxs("div",{className:"space-y-4 pt-4 animate-slide-up-fade",style:{animationDelay:`${(pe+6)*100}ms`},children:[l.jsxs("div",{className:"flex justify-between items-center border-b border-stone-800/50 pb-2",children:[l.jsxs("div",{className:"flex items-baseline gap-3",children:[l.jsx("h3",{className:"text-xl font-serif text-stone-300 italic",children:z.name}),p&&l.jsx("button",{onClick:()=>qe(z.id),className:"text-stone-700 hover:text-red-500 transition-colors",children:l.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),p&&l.jsx("button",{onClick:()=>Q(z.id),className:"text-emerald-500 hover:text-emerald-400 text-[10px] uppercase font-bold tracking-widest transition-colors flex items-center gap-2",children:"+ "})]}),G(z.characterIds||[],z.id)]},z.id)),p&&l.jsx("div",{className:"pt-4 animate-slide-up-fade",style:{animationDelay:"0.8s"},children:le?l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("input",{autoFocus:!0,placeholder:" ...",className:"bg-stone-900 border border-stone-800 rounded-lg px-3 py-2 text-sm text-stone-200 outline-none focus:border-emerald-900 w-64",value:K,onChange:z=>M(z.target.value),onKeyDown:z=>z.key==="Enter"&&Se()}),l.jsx("button",{onClick:Se,className:"text-emerald-500 hover:text-emerald-400 font-bold p-2 bg-stone-900 rounded-lg",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),l.jsx("button",{onClick:()=>Oe(!1),className:"text-stone-600 hover:text-stone-400 font-bold p-2",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):l.jsxs("button",{onClick:()=>Oe(!0),className:"flex items-center gap-2 text-stone-600 hover:text-emerald-500 transition-colors group",children:[l.jsx("div",{className:"w-8 h-8 rounded-full border border-stone-800 group-hover:border-emerald-500/50 flex items-center justify-center transition-colors",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),l.jsx("span",{className:"text-[10px] uppercase font-bold tracking-widest",children:" "})]})})]})]}),ne&&l.jsx("div",{className:"fixed inset-0 z-[120] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",onClick:()=>ce(!1),children:l.jsxs("div",{className:"bg-[#0f0f0f] border border-stone-800 w-full max-w-lg rounded-2xl shadow-2xl flex flex-col max-h-[85vh] animate-in zoom-in-95 duration-300",onClick:z=>z.stopPropagation(),children:[l.jsxs("div",{className:"p-6 border-b border-stone-900 shrink-0 space-y-4 bg-[#0f0f0f] rounded-t-2xl z-10",children:[l.jsxs("h3",{className:"text-xl font-serif text-stone-100 shrink-0",children:[" : ",ie?($e=(Te=q.subLocations)==null?void 0:Te.find(z=>z.id===ie))==null?void 0:$e.name:" "]}),l.jsx("input",{type:"text",placeholder:"  ...",value:Qe,onChange:z=>Ee(z.target.value),className:"w-full bg-stone-900 border border-stone-800 rounded-lg px-3 py-2 text-xs text-stone-200 outline-none focus:border-emerald-500/50 transition-colors",autoFocus:!0}),(o.length>0||c.length>0)&&l.jsxs("div",{className:"flex flex-wrap gap-1.5 max-h-24 overflow-y-auto custom-scrollbar",children:[o.map(z=>{const pe=Be.includes(z);return l.jsx("button",{onClick:()=>R(z),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${pe?"bg-emerald-500/20 border-emerald-500/40 text-emerald-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-stone-400"}`,children:z},z)}),c.map(z=>{const pe=Be.includes(z);return l.jsx("button",{onClick:()=>R(z),className:`px-2 py-1 rounded text-[9px] uppercase font-bold tracking-wider transition-all border ${pe?"bg-amber-500/20 border-amber-500/40 text-amber-400":"bg-stone-900 border-stone-800 text-stone-600 hover:text-amber-500"}`,children:z},z)})]})]}),l.jsx("div",{className:"overflow-y-auto custom-scrollbar flex-grow p-4 space-y-1",children:ue.length===0?l.jsx("div",{className:"text-center py-8 text-stone-600 italic text-sm",children:J.length===0?"      .":"  ."}):ue.map(z=>{const pe=$(z.id),Re=!!pe;return l.jsxs("button",{onClick:()=>!Re&&ft(z.id),disabled:Re,className:`w-full flex items-center gap-3 p-2 rounded-lg transition-colors group text-left ${Re?"opacity-50 cursor-not-allowed bg-stone-900/20":"hover:bg-stone-900"}`,children:[l.jsx("div",{className:"w-8 h-8 rounded-full bg-black border border-stone-800 overflow-hidden shrink-0",children:l.jsx("img",{src:z.imageUrl,className:"w-full h-full object-cover",alt:"",style:{objectPosition:`${z.miniImageX??50}% ${z.miniImageY??50}%`,transform:`scale(${z.miniImageScale??1})`,transformOrigin:`${z.miniImageX??50}% ${z.miniImageY??50}%`}})}),l.jsxs("div",{className:"min-w-0 flex-grow",children:[l.jsx("span",{className:`text-stone-300 text-sm font-bold block truncate ${!Re&&"group-hover:text-emerald-400"}`,children:z.name}),Re?l.jsxs("span",{className:"text-[10px] text-red-500/70 font-bold uppercase tracking-wider block truncate",children:[": ",pe]}):l.jsx(l.Fragment,{children:Be.length>0&&l.jsx("span",{className:"text-[8px] text-stone-600 block truncate",children:Be.filter(De=>(z.tags||[]).includes(De)||(z.hiddenTags||[]).includes(De)).join(", ")})})]}),!Re&&l.jsx("span",{className:"ml-auto text-emerald-500 opacity-0 group-hover:opacity-100",children:"+"})]},z.id)})}),l.jsx("div",{className:"p-4 border-t border-stone-900 shrink-0",children:l.jsx("button",{onClick:()=>ce(!1),className:"w-full py-3 bg-stone-900 hover:bg-stone-800 text-stone-400 rounded-xl text-[10px] uppercase font-bold tracking-widest",children:""})})]})})]})}return g?l.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-500",children:[l.jsxs("div",{className:"flex flex-col gap-6",children:[l.jsxs("button",{onClick:()=>x(null),className:"self-start flex items-center gap-2 text-stone-500 hover:text-emerald-500 transition-colors group",children:[l.jsx("svg",{className:"w-5 h-5 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"  "})]}),l.jsxs("div",{className:"flex justify-between items-end border-b border-stone-800 pb-8",children:[l.jsxs("div",{className:"flex items-center gap-6 animate-in slide-in-from-bottom-2 duration-700",children:[l.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-2xl overflow-hidden border border-stone-800 bg-black shadow-lg",children:l.jsx("img",{src:Y==null?void 0:Y.imageUrl,className:"w-full h-full object-cover",alt:""})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl md:text-5xl font-serif font-medium text-stone-100",children:Y==null?void 0:Y.name}),l.jsxs("p",{className:"text-stone-500 uppercase tracking-widest text-[10px] mt-2",children:[": ",w.length]})]})]}),p&&l.jsxs("div",{className:"flex gap-2 flex-col md:flex-row",children:[l.jsx("button",{onClick:()=>te(Y),className:"bg-stone-900/50 border border-stone-800 text-stone-400 px-6 py-3 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-stone-900 transition-all mb-1",children:". "}),l.jsx("button",{onClick:()=>A(),className:"bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 px-6 py-3 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-emerald-900/30 transition-all mb-1",children:"+ "})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[w.length===0&&l.jsx("div",{className:"col-span-full py-20 text-center text-stone-700 italic",children:"     .   ."}),w.map((P,J)=>{var ue,G,z,pe;return l.jsxs("div",{onClick:()=>y(P.id),style:{animationDelay:`${J*100}ms`,animationFillMode:"both"},className:"animate-slide-up-fade bg-[#0f0f0f]/30 border border-stone-900 rounded-2xl overflow-hidden group hover:border-emerald-900/30 transition-all flex flex-col cursor-pointer active:scale-95 shadow-lg",children:[l.jsxs("div",{className:"aspect-video relative overflow-hidden",children:[l.jsx("img",{src:P.imageUrl,className:"w-full h-full object-cover opacity-60 group-hover:opacity-100 transition-all duration-[2s] group-hover:scale-110 ease-out",alt:""}),l.jsx("div",{className:"absolute top-4 left-4 bg-black/80 px-3 py-1 rounded text-[9px] uppercase tracking-widest font-bold text-emerald-500 border border-emerald-900/50 backdrop-blur-sm",children:P.type}),(((ue=P.characterIds)==null?void 0:ue.length)||0)+(((G=P.subLocations)==null?void 0:G.reduce((Re,De)=>{var He;return Re+(((He=De.characterIds)==null?void 0:He.length)||0)},0))||0)>0&&l.jsx("div",{className:"absolute bottom-4 right-4 bg-black/60 backdrop-blur-md px-2 py-1 rounded flex items-center gap-2",children:l.jsxs("span",{className:"text-[9px] text-stone-300 font-bold uppercase tracking-widest",children:[(((z=P.characterIds)==null?void 0:z.length)||0)+(((pe=P.subLocations)==null?void 0:pe.reduce((Re,De)=>{var He;return Re+(((He=De.characterIds)==null?void 0:He.length)||0)},0))||0)," ."]})})]}),l.jsxs("div",{className:"p-6 space-y-3 flex-grow flex flex-col relative z-10 bg-[#0f0f0f]",children:[l.jsx("h3",{className:"text-xl font-serif text-stone-100 group-hover:text-emerald-200 transition-colors",children:P.name}),l.jsx("p",{className:"text-stone-500 text-sm leading-relaxed line-clamp-3 mb-2",children:P.description}),p&&l.jsxs("div",{className:"mt-auto pt-4 border-t border-stone-900/50 flex justify-between",children:[l.jsx("button",{onClick:Re=>{Re.stopPropagation(),A(P)},className:"text-[9px] font-bold uppercase tracking-widest text-stone-600 hover:text-white",children:"."}),l.jsx("button",{onClick:Re=>{Re.stopPropagation(),we(P.id)},className:"text-[9px] font-bold uppercase tracking-widest text-stone-600 hover:text-red-500",children:""})]})]})]},P.id)})]}),D&&l.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-md flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-lg rounded-2xl p-6 md:p-8 space-y-6 max-h-[90vh] flex flex-col overflow-hidden shadow-2xl animate-in zoom-in-95 duration-200",children:[l.jsx("h2",{className:"text-2xl font-serif text-stone-100 shrink-0",children:ve.id?"":" "}),l.jsxs("div",{className:"space-y-4 overflow-y-auto custom-scrollbar pr-2 flex-grow",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600",children:""}),l.jsx("input",{className:"w-full bg-stone-900 border border-stone-800 p-3 rounded-lg text-stone-200 outline-none focus:border-emerald-900",value:ve.name||"",onChange:P=>je({...ve,name:P.target.value}),placeholder:" ..."})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600",children:""}),l.jsxs("select",{className:"w-full bg-stone-900 border border-stone-800 p-3 rounded-lg text-stone-200 outline-none focus:border-emerald-900",value:ve.type,onChange:P=>je({...ve,type:P.target.value}),children:[l.jsx("option",{children:""}),l.jsx("option",{children:""}),l.jsx("option",{children:""}),l.jsx("option",{children:""})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600",children:""}),l.jsx("textarea",{placeholder:"  ...",className:"w-full bg-stone-900 border border-stone-800 p-3 rounded-lg text-stone-200 h-32 outline-none resize-none focus:border-emerald-900",value:ve.description||"",onChange:P=>je({...ve,description:P.target.value})})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600",children:""}),l.jsxs("div",{className:"flex gap-4 items-center",children:[l.jsxs("label",{className:`flex-1 cursor-pointer bg-stone-900 hover:bg-stone-800 p-3 rounded-lg border border-stone-800 flex items-center justify-center gap-2 transition-colors ${L?"opacity-50":""}`,children:[l.jsx("input",{type:"file",onChange:j,className:"hidden",disabled:L,accept:"image/*"}),l.jsx("span",{className:"text-[10px] text-stone-400 font-bold uppercase",children:L?"...":""})]}),l.jsx("input",{className:"flex-[1.5] bg-stone-900 border border-stone-800 p-3 rounded-lg text-xs text-stone-400 outline-none",placeholder:"...",value:(Me=ve.imageUrl)!=null&&Me.startsWith("data:")?"":ve.imageUrl||"",onChange:P=>je({...ve,imageUrl:P.target.value})})]}),ve.imageUrl&&l.jsx("img",{src:ve.imageUrl,className:"h-20 w-full object-cover rounded mt-2 opacity-50"})]})]}),l.jsxs("div",{className:"flex gap-4 shrink-0 pt-2 border-t border-stone-900 mt-2",children:[l.jsx("button",{onClick:()=>B(!1),className:"flex-1 py-3 text-[10px] font-bold uppercase text-stone-500 hover:text-stone-300",children:""}),l.jsx("button",{onClick:U,disabled:L||!ve.name,className:"flex-1 py-3 bg-emerald-900/30 text-emerald-500 border border-emerald-900/50 rounded-lg font-bold text-[10px] uppercase disabled:opacity-50 hover:bg-emerald-900/50 transition-colors",children:""})]})]})}),v&&l.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-md flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-lg rounded-3xl p-8 space-y-6 shadow-2xl animate-in zoom-in-95 duration-300",children:[l.jsx("h2",{className:"text-2xl font-serif text-stone-100",children:" "}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-2",children:""}),l.jsx("input",{className:"w-full bg-stone-900 border border-stone-800 p-4 rounded-xl text-stone-200 outline-none focus:border-emerald-900",value:ae.name||"",onChange:P=>Ce({...ae,name:P.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-2",children:""}),l.jsxs("div",{className:"flex gap-4 items-center",children:[l.jsxs("label",{className:`flex-1 cursor-pointer bg-stone-900 hover:bg-stone-800 p-4 rounded-xl border border-stone-800 flex items-center justify-center gap-2 ${L?"opacity-50":""}`,children:[l.jsx("input",{type:"file",onChange:ge,className:"hidden",disabled:L,accept:"image/*"}),l.jsx("span",{className:"text-xs text-stone-400 font-bold uppercase",children:L?"...":""})]}),l.jsx("input",{className:"flex-[2] bg-stone-900 border border-stone-800 p-4 rounded-xl text-xs text-stone-400 outline-none",placeholder:"...",value:(b=ae.imageUrl)!=null&&b.startsWith("data:")?"":ae.imageUrl||"",onChange:P=>Ce({...ae,imageUrl:P.target.value})})]})]})]}),l.jsxs("div",{className:"flex gap-4 pt-4",children:[l.jsx("button",{onClick:()=>k(!1),className:"flex-1 py-4 text-[10px] uppercase font-bold text-stone-500 hover:text-stone-300",children:""}),l.jsx("button",{onClick:he,disabled:!ae.name||L,className:"flex-1 py-4 bg-emerald-900/30 text-emerald-500 border border-emerald-900/50 rounded-xl font-bold text-[10px] uppercase hover:bg-emerald-900/50 transition-all disabled:opacity-50",children:""})]})]})})]}):l.jsxs("div",{className:"space-y-12 animate-in fade-in duration-700 pb-20",children:[l.jsxs("div",{className:"flex justify-between items-baseline",children:[l.jsx("div",{className:"space-y-2",children:l.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100",children:""})}),p&&l.jsx("button",{onClick:()=>te(),className:"bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 px-6 py-3 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-emerald-900/30 transition-all",children:"  "})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[s.length===0&&l.jsx("div",{className:"col-span-full py-20 text-center",children:l.jsx("p",{className:"text-stone-700 italic font-serif text-xl",children:" .   ."})}),s.map((P,J)=>l.jsxs("div",{onClick:()=>x(P.id),style:{animationDelay:`${J*150}ms`,animationFillMode:"both"},className:"animate-slide-up-fade bg-[#0f0f0f]/30 border border-stone-900 rounded-3xl overflow-hidden group cursor-pointer relative shadow-lg hover:shadow-emerald-900/10 hover:border-emerald-900/40 transition-all active:scale-95",children:[l.jsxs("div",{className:"aspect-[16/9] relative",children:[l.jsx("img",{src:P.imageUrl,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-all duration-[2s] ease-out group-hover:scale-110",alt:P.name}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-80"}),l.jsx("h3",{className:"absolute bottom-6 left-6 text-3xl font-serif text-stone-100 z-10 font-bold group-hover:text-emerald-100 transition-colors drop-shadow-md",children:P.name})]}),p&&l.jsxs("div",{className:"absolute top-4 right-4 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx("button",{onClick:ue=>{ue.stopPropagation(),te(P)},className:"bg-black/50 hover:bg-white text-white hover:text-black p-2 rounded-full backdrop-blur-sm transition-all",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),l.jsx("button",{onClick:ue=>{ue.stopPropagation(),O(P.id)},className:"bg-black/50 hover:bg-red-900/80 text-white p-2 rounded-full backdrop-blur-sm transition-all",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]},P.id))]}),v&&l.jsx("div",{className:"fixed inset-0 z-[110] bg-black/90 backdrop-blur-md flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[#0a0a0a] border border-stone-800 w-full max-w-lg rounded-3xl p-8 space-y-6 shadow-2xl animate-in zoom-in-95 duration-300",children:[l.jsx("h2",{className:"text-2xl font-serif text-stone-100",children:ae.id?" ":" "}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-2",children:""}),l.jsx("input",{autoFocus:!0,className:"w-full bg-stone-900 border border-stone-800 p-4 rounded-xl text-stone-200 outline-none focus:border-emerald-900 transition-colors",value:ae.name||"",onChange:P=>Ce({...ae,name:P.target.value}),placeholder:":  "})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-stone-600 block mb-2",children:""}),l.jsxs("div",{className:"flex gap-4 items-center",children:[l.jsxs("label",{className:`flex-1 cursor-pointer bg-stone-900 hover:bg-stone-800 p-4 rounded-xl border border-stone-800 flex items-center justify-center gap-2 transition-colors ${L?"opacity-50":""}`,children:[l.jsx("input",{type:"file",onChange:ge,className:"hidden",disabled:L,accept:"image/*"}),l.jsx("span",{className:"text-xs text-stone-400 font-bold uppercase",children:L?"...":""})]}),l.jsx("input",{className:"flex-[2] bg-stone-900 border border-stone-800 p-4 rounded-xl text-xs text-stone-400 outline-none",placeholder:"...",value:(re=ae.imageUrl)!=null&&re.startsWith("data:")?"":ae.imageUrl||"",onChange:P=>Ce({...ae,imageUrl:P.target.value})})]})]})]}),l.jsxs("div",{className:"flex gap-4 pt-4",children:[l.jsx("button",{onClick:()=>k(!1),className:"flex-1 py-4 text-[10px] uppercase font-bold text-stone-500 hover:text-stone-300",children:""}),l.jsx("button",{onClick:he,disabled:!ae.name||L,className:"flex-1 py-4 bg-emerald-900/30 text-emerald-500 border border-emerald-900/50 rounded-xl font-bold text-[10px] uppercase hover:bg-emerald-900/50 transition-all disabled:opacity-50",children:""})]})]})})]})},px=({sessions:s,characters:t,onUpdate:r,isAdmin:o})=>{const[c,d]=F.useState(null),[f,p]=F.useState(null),[g,x]=F.useState("");F.useEffect(()=>{window.scrollTo(0,0)},[c]);const[C,y]=F.useState(!1),[v,k]=F.useState(""),[D,B]=F.useState(""),ne=F.useRef(null),ce=s.find(K=>K.id===c);F.useEffect(()=>{ne.current&&ne.current.scrollIntoView({behavior:"smooth"})},[ce==null?void 0:ce.posts.length,c]);const ie=()=>{if(!v.trim())return;const K={id:Date.now().toString(),name:v,description:D,posts:[]};r([...s,K]),y(!1),k(""),B("")},ke=K=>{window.confirm("     ?")&&(r(s.filter(M=>M.id!==K)),c===K&&d(null))},le=K=>{if(!g.trim()||!f||!c)return;const M={id:Date.now().toString(),characterId:f,content:g,timestamp:Date.now(),type:"speech"},L=s.map(_e=>_e.id===c?{..._e,posts:[..._e.posts,M]}:_e);r(L),x("")},Oe=K=>new Date(K).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return c?l.jsxs("div",{className:"h-[calc(100vh-8rem)] flex flex-col animate-in fade-in duration-300",children:[l.jsx("div",{className:"flex items-center justify-between pb-4 border-b border-stone-900 shrink-0",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:()=>d(null),className:"p-2 hover:bg-stone-900 rounded-full text-stone-500 transition-colors",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-serif text-stone-100 italic",children:ce==null?void 0:ce.name}),l.jsx("p",{className:"text-[10px] uppercase tracking-widest text-stone-500",children:ce==null?void 0:ce.description})]})]})}),l.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar py-6 space-y-8 pr-2",children:[(ce==null?void 0:ce.posts.length)===0?l.jsx("div",{className:"text-center text-stone-700 italic text-sm mt-10",children:"...   ,   ."}):ce==null?void 0:ce.posts.map(K=>{const M=t.find(L=>L.id===K.characterId);return M?l.jsxs("div",{className:"flex gap-4 md:gap-6 group animate-in slide-in-from-bottom-2 duration-500",children:[l.jsx("div",{className:"shrink-0 flex flex-col items-center gap-2 mt-1",children:l.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 rounded-full border border-stone-800 overflow-hidden bg-black shadow-lg",children:l.jsx("img",{src:M.imageUrl,alt:M.name,style:{objectFit:"cover",objectPosition:`${M.miniImageX??50}% ${M.miniImageY??50}%`,transformOrigin:`${M.miniImageX??50}% ${M.miniImageY??50}%`,transform:`scale(${M.miniImageScale??1})`},className:"w-full h-full"})})}),l.jsxs("div",{className:"flex-grow max-w-4xl",children:[l.jsxs("div",{className:"flex items-baseline gap-3 mb-1",children:[l.jsx("span",{className:"text-stone-300 font-bold text-sm tracking-wide",children:M.name}),l.jsx("span",{className:"text-[9px] text-stone-700 font-mono",children:Oe(K.timestamp)})]}),l.jsx("div",{className:"text-stone-400 leading-relaxed font-serif whitespace-pre-wrap text-[15px] md:text-[16px]",children:K.content})]})]},K.id):null}),l.jsx("div",{ref:ne})]}),l.jsx("div",{className:"mt-4 pt-4 border-t border-stone-900 shrink-0 bg-[#050505] z-10",children:l.jsxs("div",{className:"flex flex-col gap-3",children:[l.jsx("div",{className:"flex gap-2 overflow-x-auto custom-scrollbar pb-3",children:t.map(K=>{const M=f===K.id;return l.jsxs("button",{onClick:()=>p(K.id),className:`flex items-center gap-3 px-4 py-2.5 rounded-xl transition-all shrink-0 border relative ${M?"bg-stone-900/80 border-stone-800 text-stone-100":"bg-transparent border-transparent text-stone-500 hover:text-stone-400"}`,children:[l.jsx("div",{className:"w-7 h-7 rounded-full overflow-hidden bg-black shrink-0",children:l.jsx("img",{src:K.imageUrl,style:{objectFit:"cover",objectPosition:`${K.miniImageX??50}% ${K.miniImageY??50}%`,transformOrigin:`${K.miniImageX??50}% ${K.miniImageY??50}%`,transform:`scale(${K.miniImageScale??1})`},className:"w-full h-full",alt:""})}),l.jsx("span",{className:"text-[11px] font-bold uppercase tracking-wider",children:K.name}),M&&l.jsx("div",{className:"ml-1 w-2.5 h-2.5 rounded-sm bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)] animate-in zoom-in-50 duration-300"})]},K.id)})}),l.jsxs("div",{className:"relative",children:[l.jsx("textarea",{value:g,onChange:K=>x(K.target.value),onKeyDown:K=>{K.key==="Enter"&&!K.shiftKey&&(K.preventDefault(),le())},placeholder:f?" -...":"  ...",disabled:!f,className:"w-full bg-[#0f0f0f] border border-stone-800 rounded-xl p-4 pr-14 text-stone-300 outline-none focus:border-emerald-900/50 transition-colors resize-none h-24 custom-scrollbar font-serif"}),l.jsx("button",{onClick:()=>le(),disabled:!g.trim()||!f,className:"absolute right-3 bottom-3 p-2 bg-stone-800 text-stone-400 rounded-lg hover:bg-emerald-600 hover:text-white disabled:opacity-30 disabled:hover:bg-stone-800 disabled:hover:text-stone-400 transition-all",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})]})})]}):l.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[l.jsxs("div",{className:"flex justify-between items-baseline",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-medium text-stone-100",children:""}),l.jsx("p",{className:"text-stone-500 uppercase tracking-widest text-[10px]",children:"   "})]}),l.jsx("button",{onClick:()=>y(!0),className:"bg-emerald-900/20 border border-emerald-900/50 text-emerald-500 px-6 py-2 rounded-full text-[10px] uppercase tracking-widest font-bold hover:bg-emerald-900/30 transition-all",children:"+  "})]}),C&&l.jsxs("div",{className:"bg-[#0f0f0f]/50 border border-stone-800 p-6 rounded-2xl space-y-4 animate-in slide-in-from-top-4",children:[l.jsx("input",{autoFocus:!0,placeholder:"   ...",className:"w-full bg-stone-900/50 border border-stone-800 p-3 rounded-lg text-stone-200 outline-none focus:border-emerald-900",value:v,onChange:K=>k(K.target.value)}),l.jsx("input",{placeholder:" ...",className:"w-full bg-stone-900/50 border border-stone-800 p-3 rounded-lg text-stone-400 outline-none focus:border-emerald-900 text-sm",value:D,onChange:K=>B(K.target.value)}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:()=>y(!1),className:"px-4 py-2 text-[10px] uppercase font-bold text-stone-500",children:""}),l.jsx("button",{onClick:ie,className:"px-6 py-2 bg-emerald-700 hover:bg-emerald-600 text-white rounded-lg text-[10px] uppercase font-bold transition-colors",children:""})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[s.length===0&&!C&&l.jsx("div",{className:"col-span-full text-center py-20 opacity-50 italic font-serif",children:"   .   ."}),s.map(K=>l.jsxs("div",{onClick:()=>d(K.id),className:"bg-[#0f0f0f]/30 border border-stone-900 rounded-2xl p-6 cursor-pointer hover:border-emerald-900/50 hover:bg-stone-900/30 transition-all group flex flex-col h-[200px]",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("h3",{className:"text-xl font-serif text-stone-200 group-hover:text-emerald-400 transition-colors",children:K.name}),l.jsxs("span",{className:"text-[10px] bg-stone-900 text-stone-500 px-2 py-1 rounded-md font-mono",children:[K.posts.length," "]})]}),l.jsx("p",{className:"text-sm text-stone-500 mt-2 line-clamp-2",children:K.description}),l.jsxs("div",{className:"mt-auto pt-4 border-t border-stone-900/50 flex justify-between items-center",children:[l.jsx("span",{className:"text-[9px] uppercase tracking-widest text-stone-600 font-bold group-hover:text-stone-400",children:"  "}),o&&l.jsx("button",{onClick:M=>{M.stopPropagation(),ke(K.id)},className:"text-stone-800 hover:text-red-500 p-1 transition-colors",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},K.id))]})]})},mx=({onConnect:s,onDisconnect:t,onClose:r,isConnected:o})=>l.jsx("div",{className:"fixed inset-0 z-[120] bg-black/95 backdrop-blur-md flex items-center justify-center p-6",onClick:r,children:l.jsxs("div",{className:"bg-[#0a0a0a] border border-emerald-900/50 w-full max-w-lg rounded-3xl p-8 space-y-8 shadow-[0_0_80px_rgba(16,185,129,0.05)]",onClick:c=>c.stopPropagation(),children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-serif text-emerald-500 italic",children:" "}),l.jsx("p",{className:"text-stone-500 text-[10px] uppercase tracking-widest mt-2",children:"  "})]}),l.jsx("button",{onClick:r,className:"text-stone-600 hover:text-stone-300 transition-colors",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o?l.jsxs("div",{className:"space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[l.jsxs("div",{className:"p-6 rounded-2xl border bg-emerald-950/20 border-emerald-500/30",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"w-3 h-3 rounded-full animate-pulse bg-emerald-500"}),l.jsx("span",{className:"text-sm font-bold uppercase tracking-widest text-emerald-400",children:" "})]}),l.jsx("div",{className:"space-y-2",children:l.jsx("p",{className:"text-[10px] text-stone-600 mt-2 leading-relaxed",children:"     .  ,     ,    ."})})]}),l.jsx("button",{onClick:t,className:"w-full py-4 rounded-xl border border-red-900/30 text-red-500/70 hover:bg-red-950/20 hover:text-red-500 hover:border-red-900/60 transition-all text-[10px] uppercase font-bold tracking-[0.2em]",children:" "})]}):l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{className:"bg-stone-900/30 border border-stone-800 rounded-2xl p-6 text-center space-y-4",children:[l.jsx("div",{className:"w-16 h-16 bg-stone-900 rounded-full flex items-center justify-center mx-auto text-stone-600",children:l.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),l.jsx("p",{className:"text-stone-400 text-sm leading-relaxed",children:"  ,           ."})]}),l.jsx("button",{onClick:s,className:"w-full py-5 bg-emerald-900/20 hover:bg-emerald-900/30 border border-emerald-900/50 hover:border-emerald-500/50 text-emerald-500 rounded-xl text-[11px] uppercase font-bold tracking-[0.25em] transition-all shadow-lg shadow-emerald-900/10",children:""}),l.jsx("p",{className:"text-[9px] text-stone-600 text-center border-t border-stone-900 pt-4",children:":          ."})]})]})}),wf=["","","","","","",""],bf=["","NPC","","",""],ac=[{id:"1",name:" ",age:34,height:"182 ",imageUrl:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?q=80&w=800&auto=format&fit=crop",tags:["","",""],hiddenTags:[""],connections:[{id:"2",name:"  ",role:""}],additionalInfo:"      ,     . ,         ,         .     ,    ."},{id:"2",name:"  ",age:21,height:"168 ",imageUrl:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?q=80&w=800&auto=format&fit=crop",tags:["",""],hiddenTags:["",""],connections:[{id:"1",name:" ",role:"  "}],additionalInfo:"   ,          .         .    ,        ."},{id:"3",name:"",age:"124 ",height:"195 ",imageUrl:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?q=80&w=800&auto=format&fit=crop",tags:["",""],hiddenTags:["NPC"],connections:[{id:"1",name:" ",role:" "}],additionalInfo:"  ,       .         .      ."}],gx=()=>{};var Nf={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bp={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z=function(s,t){if(!s)throw ds(t)},ds=function(s){return new Error("Firebase Database ("+bp.SDK_VERSION+") INTERNAL ASSERT FAILED: "+s)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Np=function(s){const t=[];let r=0;for(let o=0;o<s.length;o++){let c=s.charCodeAt(o);c<128?t[r++]=c:c<2048?(t[r++]=c>>6|192,t[r++]=c&63|128):(c&64512)===55296&&o+1<s.length&&(s.charCodeAt(o+1)&64512)===56320?(c=65536+((c&1023)<<10)+(s.charCodeAt(++o)&1023),t[r++]=c>>18|240,t[r++]=c>>12&63|128,t[r++]=c>>6&63|128,t[r++]=c&63|128):(t[r++]=c>>12|224,t[r++]=c>>6&63|128,t[r++]=c&63|128)}return t},xx=function(s){const t=[];let r=0,o=0;for(;r<s.length;){const c=s[r++];if(c<128)t[o++]=String.fromCharCode(c);else if(c>191&&c<224){const d=s[r++];t[o++]=String.fromCharCode((c&31)<<6|d&63)}else if(c>239&&c<365){const d=s[r++],f=s[r++],p=s[r++],g=((c&7)<<18|(d&63)<<12|(f&63)<<6|p&63)-65536;t[o++]=String.fromCharCode(55296+(g>>10)),t[o++]=String.fromCharCode(56320+(g&1023))}else{const d=s[r++],f=s[r++];t[o++]=String.fromCharCode((c&15)<<12|(d&63)<<6|f&63)}}return t.join("")},Wc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,t){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let c=0;c<s.length;c+=3){const d=s[c],f=c+1<s.length,p=f?s[c+1]:0,g=c+2<s.length,x=g?s[c+2]:0,C=d>>2,y=(d&3)<<4|p>>4;let v=(p&15)<<2|x>>6,k=x&63;g||(k=64,f||(v=64)),o.push(r[C],r[y],r[v],r[k])}return o.join("")},encodeString(s,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(s):this.encodeByteArray(Np(s),t)},decodeString(s,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(s):xx(this.decodeStringToByteArray(s,t))},decodeStringToByteArray(s,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let c=0;c<s.length;){const d=r[s.charAt(c++)],p=c<s.length?r[s.charAt(c)]:0;++c;const x=c<s.length?r[s.charAt(c)]:64;++c;const y=c<s.length?r[s.charAt(c)]:64;if(++c,d==null||p==null||x==null||y==null)throw new vx;const v=d<<2|p>>4;if(o.push(v),x!==64){const k=p<<4&240|x>>2;if(o.push(k),y!==64){const D=x<<6&192|y;o.push(D)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class vx extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const kp=function(s){const t=Np(s);return Wc.encodeByteArray(t,!0)},Uo=function(s){return kp(s).replace(/\./g,"")},bc=function(s){try{return Wc.decodeString(s,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yx(s){return Cp(void 0,s)}function Cp(s,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const r=t;return new Date(r.getTime());case Object:s===void 0&&(s={});break;case Array:s=[];break;default:return t}for(const r in t)!t.hasOwnProperty(r)||!_x(r)||(s[r]=Cp(s[r],t[r]));return s}function _x(s){return s!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx=()=>wx().__FIREBASE_DEFAULTS__,Nx=()=>{if(typeof process>"u"||typeof Nf>"u")return;const s=Nf.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},kx=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=s&&bc(s[1]);return t&&JSON.parse(t)},Sp=()=>{try{return gx()||bx()||Nx()||kx()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Cx=s=>{var t,r;return(r=(t=Sp())==null?void 0:t.emulatorHosts)==null?void 0:r[s]},Sx=s=>{const t=Cx(s);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const o=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),o]:[t.substring(0,r),o]},jp=()=>{var s;return(s=Sp())==null?void 0:s.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,o)=>{r?this.reject(r):this.resolve(o),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,o))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function jx(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ex(s,t){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},o=t||"demo-project",c=s.iat||0,d=s.sub||s.user_id;if(!d)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const f={iss:`https://securetoken.google.com/${o}`,aud:o,iat:c,exp:c+3600,auth_time:c,sub:d,user_id:d,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Uo(JSON.stringify(r)),Uo(JSON.stringify(f)),""].join(".")}const si={};function Ix(){const s={prod:[],emulator:[]};for(const t of Object.keys(si))si[t]?s.emulator.push(t):s.prod.push(t);return s}function Tx(s){let t=document.getElementById(s),r=!1;return t||(t=document.createElement("div"),t.setAttribute("id",s),r=!0),{created:r,element:t}}let kf=!1;function Rx(s,t){if(typeof window>"u"||typeof document>"u"||!Bc(window.location.host)||si[s]===t||si[s]||kf)return;si[s]=t;function r(v){return`__firebase__banner__${v}`}const o="__firebase__banner",d=Ix().prod.length>0;function f(){const v=document.getElementById(o);v&&v.remove()}function p(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function g(v,k){v.setAttribute("width","24"),v.setAttribute("id",k),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function x(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{kf=!0,f()},v}function C(v,k){v.setAttribute("id",k),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function y(){const v=Tx(o),k=r("text"),D=document.getElementById(k)||document.createElement("span"),B=r("learnmore"),ne=document.getElementById(B)||document.createElement("a"),ce=r("preprendIcon"),ie=document.getElementById(ce)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const ke=v.element;p(ke),C(ne,B);const le=x();g(ie,ce),ke.append(ie,D,ne,le),document.body.appendChild(ke)}d?(D.innerText="Preview backend disconnected.",ie.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ie.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,D.innerText="Preview backend running in this workspace."),D.setAttribute("id",k)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lx(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ep(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Lx())}function Px(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Mx(){return bp.NODE_ADMIN===!0}function Dx(){try{return typeof indexedDB=="object"}catch{return!1}}function Ox(){return new Promise((s,t)=>{try{let r=!0;const o="validate-browser-context-for-indexeddb-analytics-module",c=self.indexedDB.open(o);c.onsuccess=()=>{c.result.close(),r||self.indexedDB.deleteDatabase(o),s(!0)},c.onupgradeneeded=()=>{r=!1},c.onerror=()=>{var d;t(((d=c.error)==null?void 0:d.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ax="FirebaseError";class yi extends Error{constructor(t,r,o){super(r),this.code=t,this.customData=o,this.name=Ax,Object.setPrototypeOf(this,yi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ip.prototype.create)}}class Ip{constructor(t,r,o){this.service=t,this.serviceName=r,this.errors=o}create(t,...r){const o=r[0]||{},c=`${this.service}/${t}`,d=this.errors[t],f=d?Fx(d,o):"Error",p=`${this.serviceName}: ${f} (${c}).`;return new yi(c,p,o)}}function Fx(s,t){return s.replace($x,(r,o)=>{const c=t[o];return c!=null?String(c):`<${o}?>`})}const $x=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(s){return JSON.parse(s)}function bt(s){return JSON.stringify(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp=function(s){let t={},r={},o={},c="";try{const d=s.split(".");t=ui(bc(d[0])||""),r=ui(bc(d[1])||""),c=d[2],o=r.d||{},delete r.d}catch{}return{header:t,claims:r,data:o,signature:c}},zx=function(s){const t=Tp(s),r=t.claims;return!!r&&typeof r=="object"&&r.hasOwnProperty("iat")},Ux=function(s){const t=Tp(s).claims;return typeof t=="object"&&t.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mn(s,t){return Object.prototype.hasOwnProperty.call(s,t)}function ls(s,t){if(Object.prototype.hasOwnProperty.call(s,t))return s[t]}function Cf(s){for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t))return!1;return!0}function Wo(s,t,r){const o={};for(const c in s)Object.prototype.hasOwnProperty.call(s,c)&&(o[c]=t.call(r,s[c],c,s));return o}function Bo(s,t){if(s===t)return!0;const r=Object.keys(s),o=Object.keys(t);for(const c of r){if(!o.includes(c))return!1;const d=s[c],f=t[c];if(Sf(d)&&Sf(f)){if(!Bo(d,f))return!1}else if(d!==f)return!1}for(const c of o)if(!r.includes(c))return!1;return!0}function Sf(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(s){const t=[];for(const[r,o]of Object.entries(s))Array.isArray(o)?o.forEach(c=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(c))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(o));return t.length?"&"+t.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,r){r||(r=0);const o=this.W_;if(typeof t=="string")for(let y=0;y<16;y++)o[y]=t.charCodeAt(r)<<24|t.charCodeAt(r+1)<<16|t.charCodeAt(r+2)<<8|t.charCodeAt(r+3),r+=4;else for(let y=0;y<16;y++)o[y]=t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3],r+=4;for(let y=16;y<80;y++){const v=o[y-3]^o[y-8]^o[y-14]^o[y-16];o[y]=(v<<1|v>>>31)&4294967295}let c=this.chain_[0],d=this.chain_[1],f=this.chain_[2],p=this.chain_[3],g=this.chain_[4],x,C;for(let y=0;y<80;y++){y<40?y<20?(x=p^d&(f^p),C=1518500249):(x=d^f^p,C=1859775393):y<60?(x=d&f|p&(d|f),C=2400959708):(x=d^f^p,C=3395469782);const v=(c<<5|c>>>27)+x+g+C+o[y]&4294967295;g=p,p=f,f=(d<<30|d>>>2)&4294967295,d=c,c=v}this.chain_[0]=this.chain_[0]+c&4294967295,this.chain_[1]=this.chain_[1]+d&4294967295,this.chain_[2]=this.chain_[2]+f&4294967295,this.chain_[3]=this.chain_[3]+p&4294967295,this.chain_[4]=this.chain_[4]+g&4294967295}update(t,r){if(t==null)return;r===void 0&&(r=t.length);const o=r-this.blockSize;let c=0;const d=this.buf_;let f=this.inbuf_;for(;c<r;){if(f===0)for(;c<=o;)this.compress_(t,c),c+=this.blockSize;if(typeof t=="string"){for(;c<r;)if(d[f]=t.charCodeAt(c),++f,++c,f===this.blockSize){this.compress_(d),f=0;break}}else for(;c<r;)if(d[f]=t[c],++f,++c,f===this.blockSize){this.compress_(d),f=0;break}}this.inbuf_=f,this.total_+=r}digest(){const t=[];let r=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let c=this.blockSize-1;c>=56;c--)this.buf_[c]=r&255,r/=256;this.compress_(this.buf_);let o=0;for(let c=0;c<5;c++)for(let d=24;d>=0;d-=8)t[o]=this.chain_[c]>>d&255,++o;return t}}function Hc(s,t){return`${s} failed: ${t} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hx=function(s){const t=[];let r=0;for(let o=0;o<s.length;o++){let c=s.charCodeAt(o);if(c>=55296&&c<=56319){const d=c-55296;o++,Z(o<s.length,"Surrogate pair missing trail surrogate.");const f=s.charCodeAt(o)-56320;c=65536+(d<<10)+f}c<128?t[r++]=c:c<2048?(t[r++]=c>>6|192,t[r++]=c&63|128):c<65536?(t[r++]=c>>12|224,t[r++]=c>>6&63|128,t[r++]=c&63|128):(t[r++]=c>>18|240,t[r++]=c>>12&63|128,t[r++]=c>>6&63|128,t[r++]=c&63|128)}return t},ol=function(s){let t=0;for(let r=0;r<s.length;r++){const o=s.charCodeAt(r);o<128?t++:o<2048?t+=2:o>=55296&&o<=56319?(t+=4,r++):t+=3}return t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _i(s){return s&&s._delegate?s._delegate:s}class di{constructor(t,r,o){this.name=t,this.instanceFactory=r,this.type=o,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vx{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const o=new il;if(this.instancesDeferred.set(r,o),this.isInitialized(r)||this.shouldAutoInitialize())try{const c=this.getOrInitializeService({instanceIdentifier:r});c&&o.resolve(c)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),o=(t==null?void 0:t.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(c){if(o)return null;throw c}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Qx(t))try{this.getOrInitializeService({instanceIdentifier:br})}catch{}for(const[r,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(r);try{const d=this.getOrInitializeService({instanceIdentifier:c});o.resolve(d)}catch{}}}}clearInstance(t=br){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=br){return this.instances.has(t)}getOptions(t=br){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(`${this.name}(${o}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const c=this.getOrInitializeService({instanceIdentifier:o,options:r});for(const[d,f]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(d);o===p&&f.resolve(c)}return c}onInit(t,r){const o=this.normalizeInstanceIdentifier(r),c=this.onInitCallbacks.get(o)??new Set;c.add(t),this.onInitCallbacks.set(o,c);const d=this.instances.get(o);return d&&t(d,o),()=>{c.delete(t)}}invokeOnInitCallbacks(t,r){const o=this.onInitCallbacks.get(r);if(o)for(const c of o)try{c(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let o=this.instances.get(t);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:Yx(t),options:r}),this.instances.set(t,o),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(o,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,o)}catch{}return o||null}normalizeInstanceIdentifier(t=br){return this.component?this.component.multipleInstances?t:br:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Yx(s){return s===br?void 0:s}function Qx(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new Vx(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ze;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Ze||(Ze={}));const qx={debug:Ze.DEBUG,verbose:Ze.VERBOSE,info:Ze.INFO,warn:Ze.WARN,error:Ze.ERROR,silent:Ze.SILENT},Xx=Ze.INFO,Kx={[Ze.DEBUG]:"log",[Ze.VERBOSE]:"log",[Ze.INFO]:"info",[Ze.WARN]:"warn",[Ze.ERROR]:"error"},Jx=(s,t,...r)=>{if(t<s.logLevel)return;const o=new Date().toISOString(),c=Kx[t];if(c)console[c](`[${o}]  ${s.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Rp{constructor(t){this.name=t,this._logLevel=Xx,this._logHandler=Jx,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Ze))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?qx[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Ze.DEBUG,...t),this._logHandler(this,Ze.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Ze.VERBOSE,...t),this._logHandler(this,Ze.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Ze.INFO,...t),this._logHandler(this,Ze.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Ze.WARN,...t),this._logHandler(this,Ze.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Ze.ERROR,...t),this._logHandler(this,Ze.ERROR,...t)}}const Zx=(s,t)=>t.some(r=>s instanceof r);let jf,Ef;function ev(){return jf||(jf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function tv(){return Ef||(Ef=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Lp=new WeakMap,Nc=new WeakMap,Pp=new WeakMap,cc=new WeakMap,Vc=new WeakMap;function nv(s){const t=new Promise((r,o)=>{const c=()=>{s.removeEventListener("success",d),s.removeEventListener("error",f)},d=()=>{r(er(s.result)),c()},f=()=>{o(s.error),c()};s.addEventListener("success",d),s.addEventListener("error",f)});return t.then(r=>{r instanceof IDBCursor&&Lp.set(r,s)}).catch(()=>{}),Vc.set(t,s),t}function rv(s){if(Nc.has(s))return;const t=new Promise((r,o)=>{const c=()=>{s.removeEventListener("complete",d),s.removeEventListener("error",f),s.removeEventListener("abort",f)},d=()=>{r(),c()},f=()=>{o(s.error||new DOMException("AbortError","AbortError")),c()};s.addEventListener("complete",d),s.addEventListener("error",f),s.addEventListener("abort",f)});Nc.set(s,t)}let kc={get(s,t,r){if(s instanceof IDBTransaction){if(t==="done")return Nc.get(s);if(t==="objectStoreNames")return s.objectStoreNames||Pp.get(s);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return er(s[t])},set(s,t,r){return s[t]=r,!0},has(s,t){return s instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in s}};function sv(s){kc=s(kc)}function iv(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const o=s.call(uc(this),t,...r);return Pp.set(o,t.sort?t.sort():[t]),er(o)}:tv().includes(s)?function(...t){return s.apply(uc(this),t),er(Lp.get(this))}:function(...t){return er(s.apply(uc(this),t))}}function ov(s){return typeof s=="function"?iv(s):(s instanceof IDBTransaction&&rv(s),Zx(s,ev())?new Proxy(s,kc):s)}function er(s){if(s instanceof IDBRequest)return nv(s);if(cc.has(s))return cc.get(s);const t=ov(s);return t!==s&&(cc.set(s,t),Vc.set(t,s)),t}const uc=s=>Vc.get(s);function lv(s,t,{blocked:r,upgrade:o,blocking:c,terminated:d}={}){const f=indexedDB.open(s,t),p=er(f);return o&&f.addEventListener("upgradeneeded",g=>{o(er(f.result),g.oldVersion,g.newVersion,er(f.transaction),g)}),r&&f.addEventListener("blocked",g=>r(g.oldVersion,g.newVersion,g)),p.then(g=>{d&&g.addEventListener("close",()=>d()),c&&g.addEventListener("versionchange",x=>c(x.oldVersion,x.newVersion,x))}).catch(()=>{}),p}const av=["get","getKey","getAll","getAllKeys","count"],cv=["put","add","delete","clear"],dc=new Map;function If(s,t){if(!(s instanceof IDBDatabase&&!(t in s)&&typeof t=="string"))return;if(dc.get(t))return dc.get(t);const r=t.replace(/FromIndex$/,""),o=t!==r,c=cv.includes(r);if(!(r in(o?IDBIndex:IDBObjectStore).prototype)||!(c||av.includes(r)))return;const d=async function(f,...p){const g=this.transaction(f,c?"readwrite":"readonly");let x=g.store;return o&&(x=x.index(p.shift())),(await Promise.all([x[r](...p),c&&g.done]))[0]};return dc.set(t,d),d}sv(s=>({...s,get:(t,r,o)=>If(t,r)||s.get(t,r,o),has:(t,r)=>!!If(t,r)||s.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(dv(r)){const o=r.getImmediate();return`${o.library}/${o.version}`}else return null}).filter(r=>r).join(" ")}}function dv(s){const t=s.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Cc="@firebase/app",Tf="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn=new Rp("@firebase/app"),hv="@firebase/app-compat",fv="@firebase/analytics-compat",pv="@firebase/analytics",mv="@firebase/app-check-compat",gv="@firebase/app-check",xv="@firebase/auth",vv="@firebase/auth-compat",yv="@firebase/database",_v="@firebase/data-connect",wv="@firebase/database-compat",bv="@firebase/functions",Nv="@firebase/functions-compat",kv="@firebase/installations",Cv="@firebase/installations-compat",Sv="@firebase/messaging",jv="@firebase/messaging-compat",Ev="@firebase/performance",Iv="@firebase/performance-compat",Tv="@firebase/remote-config",Rv="@firebase/remote-config-compat",Lv="@firebase/storage",Pv="@firebase/storage-compat",Mv="@firebase/firestore",Dv="@firebase/ai",Ov="@firebase/firestore-compat",Av="firebase",Fv="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sc="[DEFAULT]",$v={[Cc]:"fire-core",[hv]:"fire-core-compat",[pv]:"fire-analytics",[fv]:"fire-analytics-compat",[gv]:"fire-app-check",[mv]:"fire-app-check-compat",[xv]:"fire-auth",[vv]:"fire-auth-compat",[yv]:"fire-rtdb",[_v]:"fire-data-connect",[wv]:"fire-rtdb-compat",[bv]:"fire-fn",[Nv]:"fire-fn-compat",[kv]:"fire-iid",[Cv]:"fire-iid-compat",[Sv]:"fire-fcm",[jv]:"fire-fcm-compat",[Ev]:"fire-perf",[Iv]:"fire-perf-compat",[Tv]:"fire-rc",[Rv]:"fire-rc-compat",[Lv]:"fire-gcs",[Pv]:"fire-gcs-compat",[Mv]:"fire-fst",[Ov]:"fire-fst-compat",[Dv]:"fire-vertex","fire-js":"fire-js",[Av]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ho=new Map,zv=new Map,jc=new Map;function Rf(s,t){try{s.container.addComponent(t)}catch(r){Rn.debug(`Component ${t.name} failed to register with FirebaseApp ${s.name}`,r)}}function Vo(s){const t=s.name;if(jc.has(t))return Rn.debug(`There were multiple attempts to register component ${t}.`),!1;jc.set(t,s);for(const r of Ho.values())Rf(r,s);for(const r of zv.values())Rf(r,s);return!0}function Uv(s,t){const r=s.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),s.container.getProvider(t)}function Wv(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bv={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},tr=new Ip("app","Firebase",Bv);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(t,r,o){this._isDeleted=!1,this._options={...t},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=o,this.container.addComponent(new di("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw tr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vv=Fv;function Mp(s,t={}){let r=s;typeof t!="object"&&(t={name:t});const o={name:Sc,automaticDataCollectionEnabled:!0,...t},c=o.name;if(typeof c!="string"||!c)throw tr.create("bad-app-name",{appName:String(c)});if(r||(r=jp()),!r)throw tr.create("no-options");const d=Ho.get(c);if(d){if(Bo(r,d.options)&&Bo(o,d.config))return d;throw tr.create("duplicate-app",{appName:c})}const f=new Gx(c);for(const g of jc.values())f.addComponent(g);const p=new Hv(r,o,f);return Ho.set(c,p),p}function Yv(s=Sc){const t=Ho.get(s);if(!t&&s===Sc&&jp())return Mp();if(!t)throw tr.create("no-app",{appName:s});return t}function rs(s,t,r){let o=$v[s]??s;r&&(o+=`-${r}`);const c=o.match(/\s|\//),d=t.match(/\s|\//);if(c||d){const f=[`Unable to register library "${o}" with version "${t}":`];c&&f.push(`library name "${o}" contains illegal characters (whitespace or "/")`),c&&d&&f.push("and"),d&&f.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Rn.warn(f.join(" "));return}Vo(new di(`${o}-version`,()=>({library:o,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qv="firebase-heartbeat-database",Gv=1,hi="firebase-heartbeat-store";let hc=null;function Dp(){return hc||(hc=lv(Qv,Gv,{upgrade:(s,t)=>{switch(t){case 0:try{s.createObjectStore(hi)}catch(r){console.warn(r)}}}}).catch(s=>{throw tr.create("idb-open",{originalErrorMessage:s.message})})),hc}async function qv(s){try{const r=(await Dp()).transaction(hi),o=await r.objectStore(hi).get(Op(s));return await r.done,o}catch(t){if(t instanceof yi)Rn.warn(t.message);else{const r=tr.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Rn.warn(r.message)}}}async function Lf(s,t){try{const o=(await Dp()).transaction(hi,"readwrite");await o.objectStore(hi).put(t,Op(s)),await o.done}catch(r){if(r instanceof yi)Rn.warn(r.message);else{const o=tr.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Rn.warn(o.message)}}}function Op(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xv=1024,Kv=30;class Jv{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new ey(r),this._heartbeatsCachePromise=this._storage.read().then(o=>(this._heartbeatsCache=o,o))}async triggerHeartbeat(){var t,r;try{const c=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),d=Pf();if(((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===d||this._heartbeatsCache.heartbeats.some(f=>f.date===d))return;if(this._heartbeatsCache.heartbeats.push({date:d,agent:c}),this._heartbeatsCache.heartbeats.length>Kv){const f=ty(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(f,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(o){Rn.warn(o)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Pf(),{heartbeatsToSend:o,unsentEntries:c}=Zv(this._heartbeatsCache.heartbeats),d=Uo(JSON.stringify({version:2,heartbeats:o}));return this._heartbeatsCache.lastSentHeartbeatDate=r,c.length>0?(this._heartbeatsCache.heartbeats=c,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),d}catch(r){return Rn.warn(r),""}}}function Pf(){return new Date().toISOString().substring(0,10)}function Zv(s,t=Xv){const r=[];let o=s.slice();for(const c of s){const d=r.find(f=>f.agent===c.agent);if(d){if(d.dates.push(c.date),Mf(r)>t){d.dates.pop();break}}else if(r.push({agent:c.agent,dates:[c.date]}),Mf(r)>t){r.pop();break}o=o.slice(1)}return{heartbeatsToSend:r,unsentEntries:o}}class ey{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Dx()?Ox().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await qv(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const o=await this.read();return Lf(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??o.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const o=await this.read();return Lf(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...t.heartbeats]})}else return}}function Mf(s){return Uo(JSON.stringify({version:2,heartbeats:s})).length}function ty(s){if(s.length===0)return-1;let t=0,r=s[0].date;for(let o=1;o<s.length;o++)s[o].date<r&&(r=s[o].date,t=o);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ny(s){Vo(new di("platform-logger",t=>new uv(t),"PRIVATE")),Vo(new di("heartbeat",t=>new Jv(t),"PRIVATE")),rs(Cc,Tf,s),rs(Cc,Tf,"esm2020"),rs("fire-js","")}ny("");var ry="firebase",sy="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rs(ry,sy,"app");var Df={};const Of="@firebase/database",Af="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ap="";function iy(s){Ap=s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,r){r==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),bt(r))}get(t){const r=this.domStorage_.getItem(this.prefixedName_(t));return r==null?null:ui(r)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,r){r==null?delete this.cache_[t]:this.cache_[t]=r}get(t){return Mn(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fp=function(s){try{if(typeof window<"u"&&typeof window[s]<"u"){const t=window[s];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new oy(t)}}catch{}return new ly},kr=Fp("localStorage"),ay=Fp("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss=new Rp("@firebase/database"),cy=(function(){let s=1;return function(){return s++}})(),$p=function(s){const t=Hx(s),r=new Bx;r.update(t);const o=r.digest();return Wc.encodeByteArray(o)},wi=function(...s){let t="";for(let r=0;r<s.length;r++){const o=s[r];Array.isArray(o)||o&&typeof o=="object"&&typeof o.length=="number"?t+=wi.apply(null,o):typeof o=="object"?t+=bt(o):t+=o,t+=" "}return t};let ii=null,Ff=!0;const uy=function(s,t){Z(!0,"Can't turn on custom loggers persistently."),ss.logLevel=Ze.VERBOSE,ii=ss.log.bind(ss)},Rt=function(...s){if(Ff===!0&&(Ff=!1,ii===null&&ay.get("logging_enabled")===!0&&uy()),ii){const t=wi.apply(null,s);ii(t)}},bi=function(s){return function(...t){Rt(s,...t)}},Ec=function(...s){const t="FIREBASE INTERNAL ERROR: "+wi(...s);ss.error(t)},Ln=function(...s){const t=`FIREBASE FATAL ERROR: ${wi(...s)}`;throw ss.error(t),new Error(t)},Bt=function(...s){const t="FIREBASE WARNING: "+wi(...s);ss.warn(t)},dy=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Bt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},zp=function(s){return typeof s=="number"&&(s!==s||s===Number.POSITIVE_INFINITY||s===Number.NEGATIVE_INFINITY)},hy=function(s){if(document.readyState==="complete")s();else{let t=!1;const r=function(){if(!document.body){setTimeout(r,Math.floor(10));return}t||(t=!0,s())};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&r()}),window.attachEvent("onload",r))}},as="[MIN_NAME]",Sr="[MAX_NAME]",hs=function(s,t){if(s===t)return 0;if(s===as||t===Sr)return-1;if(t===as||s===Sr)return 1;{const r=$f(s),o=$f(t);return r!==null?o!==null?r-o===0?s.length-t.length:r-o:-1:o!==null?1:s<t?-1:1}},fy=function(s,t){return s===t?0:s<t?-1:1},Zs=function(s,t){if(t&&s in t)return t[s];throw new Error("Missing required key ("+s+") in object: "+bt(t))},Yc=function(s){if(typeof s!="object"||s===null)return bt(s);const t=[];for(const o in s)t.push(o);t.sort();let r="{";for(let o=0;o<t.length;o++)o!==0&&(r+=","),r+=bt(t[o]),r+=":",r+=Yc(s[t[o]]);return r+="}",r},Up=function(s,t){const r=s.length;if(r<=t)return[s];const o=[];for(let c=0;c<r;c+=t)c+t>r?o.push(s.substring(c,r)):o.push(s.substring(c,c+t));return o};function Ht(s,t){for(const r in s)s.hasOwnProperty(r)&&t(r,s[r])}const Wp=function(s){Z(!zp(s),"Invalid JSON number");const t=11,r=52,o=(1<<t-1)-1;let c,d,f,p,g;s===0?(d=0,f=0,c=1/s===-1/0?1:0):(c=s<0,s=Math.abs(s),s>=Math.pow(2,1-o)?(p=Math.min(Math.floor(Math.log(s)/Math.LN2),o),d=p+o,f=Math.round(s*Math.pow(2,r-p)-Math.pow(2,r))):(d=0,f=Math.round(s/Math.pow(2,1-o-r))));const x=[];for(g=r;g;g-=1)x.push(f%2?1:0),f=Math.floor(f/2);for(g=t;g;g-=1)x.push(d%2?1:0),d=Math.floor(d/2);x.push(c?1:0),x.reverse();const C=x.join("");let y="";for(g=0;g<64;g+=8){let v=parseInt(C.substr(g,8),2).toString(16);v.length===1&&(v="0"+v),y=y+v}return y.toLowerCase()},py=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},my=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function gy(s,t){let r="Unknown Error";s==="too_big"?r="The data requested exceeds the maximum size that can be accessed with a single request.":s==="permission_denied"?r="Client doesn't have permission to access the desired data.":s==="unavailable"&&(r="The service is unavailable");const o=new Error(s+" at "+t._path.toString()+": "+r);return o.code=s.toUpperCase(),o}const xy=new RegExp("^-?(0*)\\d{1,10}$"),vy=-2147483648,yy=2147483647,$f=function(s){if(xy.test(s)){const t=Number(s);if(t>=vy&&t<=yy)return t}return null},fs=function(s){try{s()}catch(t){setTimeout(()=>{const r=t.stack||"";throw Bt("Exception was thrown by user callback.",r),t},Math.floor(0))}},_y=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},oi=function(s,t){const r=setTimeout(s,t);return typeof r=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(r):typeof r=="object"&&r.unref&&r.unref(),r};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(t,r){this.appCheckProvider=r,this.appName=t.name,Wv(t)&&t.settings.appCheckToken&&(this.serverAppAppCheckToken=t.settings.appCheckToken),this.appCheck=r==null?void 0:r.getImmediate({optional:!0}),this.appCheck||r==null||r.get().then(o=>this.appCheck=o)}getToken(t){if(this.serverAppAppCheckToken){if(t)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(t):new Promise((r,o)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(r,o):r(null)},0)})}addTokenChangeListener(t){var r;(r=this.appCheckProvider)==null||r.get().then(o=>o.addTokenListener(t))}notifyForInvalidToken(){Bt(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class by{constructor(t,r,o){this.appName_=t,this.firebaseOptions_=r,this.authProvider_=o,this.auth_=null,this.auth_=o.getImmediate({optional:!0}),this.auth_||o.onInit(c=>this.auth_=c)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(r=>r&&r.code==="auth/token-not-initialized"?(Rt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(r)):new Promise((r,o)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(r,o):r(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(r=>r.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(r=>r.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Bt(t)}}class $o{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}$o.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qc="5",Bp="v",Hp="s",Vp="r",Yp="f",Qp=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Gp="ls",qp="p",Ic="ac",Xp="websocket",Kp="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(t,r,o,c,d=!1,f="",p=!1,g=!1,x=null){this.secure=r,this.namespace=o,this.webSocketOnly=c,this.nodeAdmin=d,this.persistenceKey=f,this.includeNamespaceInQueryParams=p,this.isUsingEmulator=g,this.emulatorOptions=x,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=kr.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&kr.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",r=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${r}`}}function Ny(s){return s.host!==s.internalHost||s.isCustomHost()||s.includeNamespaceInQueryParams}function Zp(s,t,r){Z(typeof t=="string","typeof type must == string"),Z(typeof r=="object","typeof params must == object");let o;if(t===Xp)o=(s.secure?"wss://":"ws://")+s.internalHost+"/.ws?";else if(t===Kp)o=(s.secure?"https://":"http://")+s.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);Ny(s)&&(r.ns=s.namespace);const c=[];return Ht(r,(d,f)=>{c.push(d+"="+f)}),o+c.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{constructor(){this.counters_={}}incrementCounter(t,r=1){Mn(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=r}get(){return yx(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fc={},pc={};function Gc(s){const t=s.toString();return fc[t]||(fc[t]=new ky),fc[t]}function Cy(s,t){const r=s.toString();return pc[r]||(pc[r]=t()),pc[r]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sy{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,r){this.closeAfterResponse=t,this.onClose=r,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,r){for(this.pendingResponses[t]=r;this.pendingResponses[this.currentResponseNum];){const o=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let c=0;c<o.length;++c)o[c]&&fs(()=>{this.onMessage_(o[c])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zf="start",jy="close",Ey="pLPCommand",Iy="pRTLPCB",e0="id",t0="pw",n0="ser",Ty="cb",Ry="seg",Ly="ts",Py="d",My="dframe",r0=1870,s0=30,Dy=r0-s0,Oy=25e3,Ay=3e4;class ns{constructor(t,r,o,c,d,f,p){this.connId=t,this.repoInfo=r,this.applicationId=o,this.appCheckToken=c,this.authToken=d,this.transportSessionId=f,this.lastSessionId=p,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=bi(t),this.stats_=Gc(r),this.urlFn=g=>(this.appCheckToken&&(g[Ic]=this.appCheckToken),Zp(r,Kp,g))}open(t,r){this.curSegmentNum=0,this.onDisconnect_=r,this.myPacketOrderer=new Sy(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Ay)),hy(()=>{if(this.isClosed_)return;this.scriptTagHolder=new qc((...d)=>{const[f,p,g,x,C]=d;if(this.incrementIncomingBytes_(d),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,f===zf)this.id=p,this.password=g;else if(f===jy)p?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(p,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+f)},(...d)=>{const[f,p]=d;this.incrementIncomingBytes_(d),this.myPacketOrderer.handleResponse(f,p)},()=>{this.onClosed_()},this.urlFn);const o={};o[zf]="t",o[n0]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(o[Ty]=this.scriptTagHolder.uniqueCallbackIdentifier),o[Bp]=Qc,this.transportSessionId&&(o[Hp]=this.transportSessionId),this.lastSessionId&&(o[Gp]=this.lastSessionId),this.applicationId&&(o[qp]=this.applicationId),this.appCheckToken&&(o[Ic]=this.appCheckToken),typeof location<"u"&&location.hostname&&Qp.test(location.hostname)&&(o[Vp]=Yp);const c=this.urlFn(o);this.log_("Connecting via long-poll to "+c),this.scriptTagHolder.addTag(c,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ns.forceAllow_=!0}static forceDisallow(){ns.forceDisallow_=!0}static isAvailable(){return ns.forceAllow_?!0:!ns.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!py()&&!my()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const r=bt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const o=kp(r),c=Up(o,Dy);for(let d=0;d<c.length;d++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,c.length,c[d]),this.curSegmentNum++}addDisconnectPingFrame(t,r){this.myDisconnFrame=document.createElement("iframe");const o={};o[My]="t",o[e0]=t,o[t0]=r,this.myDisconnFrame.src=this.urlFn(o),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const r=bt(t).length;this.bytesReceived+=r,this.stats_.incrementCounter("bytes_received",r)}}class qc{constructor(t,r,o,c){this.onDisconnect=o,this.urlFn=c,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=cy(),window[Ey+this.uniqueCallbackIdentifier]=t,window[Iy+this.uniqueCallbackIdentifier]=r,this.myIFrame=qc.createIFrame_();let d="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(d='<script>document.domain="'+document.domain+'";<\/script>');const f="<html><body>"+d+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(f),this.myIFrame.doc.close()}catch(p){Rt("frame writing exception"),p.stack&&Rt(p.stack),Rt(p)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||Rt("No IE domain setting required")}catch{const o=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+o+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,r){for(this.myID=t,this.myPW=r,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t[e0]=this.myID,t[t0]=this.myPW,t[n0]=this.currentSerial;let r=this.urlFn(t),o="",c=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+s0+o.length<=r0;){const f=this.pendingSegs.shift();o=o+"&"+Ry+c+"="+f.seg+"&"+Ly+c+"="+f.ts+"&"+Py+c+"="+f.d,c++}return r=r+o,this.addLongPollTag_(r,this.currentSerial),!0}else return!1}enqueueSegment(t,r,o){this.pendingSegs.push({seg:t,ts:r,d:o}),this.alive&&this.newRequest_()}addLongPollTag_(t,r){this.outstandingRequests.add(r);const o=()=>{this.outstandingRequests.delete(r),this.newRequest_()},c=setTimeout(o,Math.floor(Oy)),d=()=>{clearTimeout(c),o()};this.addTag(t,d)}addTag(t,r){setTimeout(()=>{try{if(!this.sendNewPolls)return;const o=this.myIFrame.doc.createElement("script");o.type="text/javascript",o.async=!0,o.src=t,o.onload=o.onreadystatechange=function(){const c=o.readyState;(!c||c==="loaded"||c==="complete")&&(o.onload=o.onreadystatechange=null,o.parentNode&&o.parentNode.removeChild(o),r())},o.onerror=()=>{Rt("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(o)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fy=16384,$y=45e3;let Yo=null;typeof MozWebSocket<"u"?Yo=MozWebSocket:typeof WebSocket<"u"&&(Yo=WebSocket);class hn{constructor(t,r,o,c,d,f,p){this.connId=t,this.applicationId=o,this.appCheckToken=c,this.authToken=d,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=bi(this.connId),this.stats_=Gc(r),this.connURL=hn.connectionURL_(r,f,p,c,o),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,o,c,d){const f={};return f[Bp]=Qc,typeof location<"u"&&location.hostname&&Qp.test(location.hostname)&&(f[Vp]=Yp),r&&(f[Hp]=r),o&&(f[Gp]=o),c&&(f[Ic]=c),d&&(f[qp]=d),Zp(t,Xp,f)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,kr.set("previous_websocket_failure",!0);try{let o;Mx(),this.mySock=new Yo(this.connURL,[],o)}catch(o){this.log_("Error instantiating WebSocket.");const c=o.message||o.data;c&&this.log_(c),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=o=>{this.handleIncomingFrame(o)},this.mySock.onerror=o=>{this.log_("WebSocket error.  Closing connection.");const c=o.message||o.data;c&&this.log_(c),this.onClosed_()}}start(){}static forceDisallow(){hn.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=/Android ([0-9]{0,}\.[0-9]{0,})/,o=navigator.userAgent.match(r);o&&o.length>1&&parseFloat(o[1])<4.4&&(t=!0)}return!t&&Yo!==null&&!hn.forceDisallow_}static previouslyFailed(){return kr.isInMemoryStorage||kr.get("previous_websocket_failure")===!0}markConnectionHealthy(){kr.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const o=ui(r);this.onMessage(o)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(Z(this.frames===null,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{const o=this.extractFrameCount_(r);o!==null&&this.appendFrame_(o)}}send(t){this.resetKeepAlive();const r=bt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const o=Up(r,Fy);o.length>1&&this.sendString_(String(o.length));for(let c=0;c<o.length;c++)this.sendString_(o[c])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor($y))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}hn.responsesRequiredToBeHealthy=2;hn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{static get ALL_TRANSPORTS(){return[ns,hn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){const r=hn&&hn.isAvailable();let o=r&&!hn.previouslyFailed();if(t.webSocketOnly&&(r||Bt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[hn];else{const c=this.transports_=[];for(const d of fi.ALL_TRANSPORTS)d&&d.isAvailable()&&c.push(d);fi.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}fi.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zy=6e4,Uy=5e3,Wy=10*1024,By=100*1024,mc="t",Uf="d",Hy="s",Wf="r",Vy="e",Bf="o",Hf="a",Vf="n",Yf="p",Yy="h";class Qy{constructor(t,r,o,c,d,f,p,g,x,C){this.id=t,this.repoInfo_=r,this.applicationId_=o,this.appCheckToken_=c,this.authToken_=d,this.onMessage_=f,this.onReady_=p,this.onDisconnect_=g,this.onKill_=x,this.lastSessionId=C,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=bi("c:"+this.id+":"),this.transportManager_=new fi(r),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.conn_),o=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(r,o)},Math.floor(0));const c=t.healthyTimeout||0;c>0&&(this.healthyTimeout_=oi(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>By?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Wy?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(c)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return r=>{t===this.conn_?this.onConnectionLost_(r):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return r=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(r):t===this.secondaryConn_?this.onSecondaryMessageReceived_(r):this.log_("message on old connection"))}}sendRequest(t){const r={t:"d",d:t};this.sendData_(r)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(mc in t){const r=t[mc];r===Hf?this.upgradeIfSecondaryHealthy_():r===Wf?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):r===Bf&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const r=Zs("t",t),o=Zs("d",t);if(r==="c")this.onSecondaryControl_(o);else if(r==="d")this.pendingDataMessages.push(o);else throw new Error("Unknown protocol layer: "+r)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Yf,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Hf,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Vf,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const r=Zs("t",t),o=Zs("d",t);r==="c"?this.onControl_(o):r==="d"&&this.onDataMessage_(o)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const r=Zs(mc,t);if(Uf in t){const o=t[Uf];if(r===Yy){const c={...o};this.repoInfo_.isUsingEmulator&&(c.h=this.repoInfo_.host),this.onHandshake_(c)}else if(r===Vf){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let c=0;c<this.pendingDataMessages.length;++c)this.onDataMessage_(this.pendingDataMessages[c]);this.pendingDataMessages=[],this.tryCleanupConnection()}else r===Hy?this.onConnectionShutdown_(o):r===Wf?this.onReset_(o):r===Vy?Ec("Server Error: "+o):r===Bf?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Ec("Unknown control packet command: "+r)}}onHandshake_(t){const r=t.ts,o=t.v,c=t.h;this.sessionId=t.s,this.repoInfo_.host=c,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,r),Qc!==o&&Bt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.secondaryConn_),o=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,o),oi(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(zy))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,r){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(r,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):oi(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Uy))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Yf,d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(kr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{put(t,r,o,c){}merge(t,r,o,c){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,r,o){}onDisconnectMerge(t,r,o){}onDisconnectCancel(t,r){}reportStats(t){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(t){this.allowedEvents_=t,this.listeners_={},Z(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...r){if(Array.isArray(this.listeners_[t])){const o=[...this.listeners_[t]];for(let c=0;c<o.length;c++)o[c].callback.apply(o[c].context,r)}}on(t,r,o){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:r,context:o});const c=this.getInitialEvent(t);c&&r.apply(o,c)}off(t,r,o){this.validateEventType_(t);const c=this.listeners_[t]||[];for(let d=0;d<c.length;d++)if(c[d].callback===r&&(!o||o===c[d].context)){c.splice(d,1);return}}validateEventType_(t){Z(this.allowedEvents_.find(r=>r===t),"Unknown event: "+t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo extends o0{static getInstance(){return new Qo}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Ep()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(t){return Z(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf=32,Gf=768;class Ke{constructor(t,r){if(r===void 0){this.pieces_=t.split("/");let o=0;for(let c=0;c<this.pieces_.length;c++)this.pieces_[c].length>0&&(this.pieces_[o]=this.pieces_[c],o++);this.pieces_.length=o,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=r}toString(){let t="";for(let r=this.pieceNum_;r<this.pieces_.length;r++)this.pieces_[r]!==""&&(t+="/"+this.pieces_[r]);return t||"/"}}function Ge(){return new Ke("")}function Ae(s){return s.pieceNum_>=s.pieces_.length?null:s.pieces_[s.pieceNum_]}function rr(s){return s.pieces_.length-s.pieceNum_}function et(s){let t=s.pieceNum_;return t<s.pieces_.length&&t++,new Ke(s.pieces_,t)}function l0(s){return s.pieceNum_<s.pieces_.length?s.pieces_[s.pieces_.length-1]:null}function Gy(s){let t="";for(let r=s.pieceNum_;r<s.pieces_.length;r++)s.pieces_[r]!==""&&(t+="/"+encodeURIComponent(String(s.pieces_[r])));return t||"/"}function a0(s,t=0){return s.pieces_.slice(s.pieceNum_+t)}function c0(s){if(s.pieceNum_>=s.pieces_.length)return null;const t=[];for(let r=s.pieceNum_;r<s.pieces_.length-1;r++)t.push(s.pieces_[r]);return new Ke(t,0)}function gt(s,t){const r=[];for(let o=s.pieceNum_;o<s.pieces_.length;o++)r.push(s.pieces_[o]);if(t instanceof Ke)for(let o=t.pieceNum_;o<t.pieces_.length;o++)r.push(t.pieces_[o]);else{const o=t.split("/");for(let c=0;c<o.length;c++)o[c].length>0&&r.push(o[c])}return new Ke(r,0)}function Ue(s){return s.pieceNum_>=s.pieces_.length}function Ut(s,t){const r=Ae(s),o=Ae(t);if(r===null)return t;if(r===o)return Ut(et(s),et(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+s+")")}function Xc(s,t){if(rr(s)!==rr(t))return!1;for(let r=s.pieceNum_,o=t.pieceNum_;r<=s.pieces_.length;r++,o++)if(s.pieces_[r]!==t.pieces_[o])return!1;return!0}function fn(s,t){let r=s.pieceNum_,o=t.pieceNum_;if(rr(s)>rr(t))return!1;for(;r<s.pieces_.length;){if(s.pieces_[r]!==t.pieces_[o])return!1;++r,++o}return!0}class qy{constructor(t,r){this.errorPrefix_=r,this.parts_=a0(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let o=0;o<this.parts_.length;o++)this.byteLength_+=ol(this.parts_[o]);u0(this)}}function Xy(s,t){s.parts_.length>0&&(s.byteLength_+=1),s.parts_.push(t),s.byteLength_+=ol(t),u0(s)}function Ky(s){const t=s.parts_.pop();s.byteLength_-=ol(t),s.parts_.length>0&&(s.byteLength_-=1)}function u0(s){if(s.byteLength_>Gf)throw new Error(s.errorPrefix_+"has a key path longer than "+Gf+" bytes ("+s.byteLength_+").");if(s.parts_.length>Qf)throw new Error(s.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Qf+") or object contains a cycle "+Nr(s))}function Nr(s){return s.parts_.length===0?"":"in property '"+s.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc extends o0{static getInstance(){return new Kc}constructor(){super(["visible"]);let t,r;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(r="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(r="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(r="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(r="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,r&&document.addEventListener(r,()=>{const o=!document[t];o!==this.visible_&&(this.visible_=o,this.trigger("visible",o))},!1)}getInitialEvent(t){return Z(t==="visible","Unknown event type: "+t),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ei=1e3,Jy=300*1e3,qf=30*1e3,Zy=1.3,e1=3e4,t1="server_kill",Xf=3;class Tn extends i0{constructor(t,r,o,c,d,f,p,g){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=o,this.onConnectStatus_=c,this.onServerInfoUpdate_=d,this.authTokenProvider_=f,this.appCheckTokenProvider_=p,this.authOverride_=g,this.id=Tn.nextPersistentConnectionId_++,this.log_=bi("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ei,this.maxReconnectDelay_=Jy,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,g)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Kc.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Qo.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,o){const c=++this.requestNumber_,d={r:c,a:t,b:r};this.log_(bt(d)),Z(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(d),o&&(this.requestCBHash_[c]=o)}get(t){this.initConnection_();const r=new il,c={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:f=>{const p=f.d;f.s==="ok"?r.resolve(p):r.reject(p)}};this.outstandingGets_.push(c),this.outstandingGetCount_++;const d=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(d),r.promise}listen(t,r,o,c){this.initConnection_();const d=t._queryIdentifier,f=t._path.toString();this.log_("Listen called for "+f+" "+d),this.listens.has(f)||this.listens.set(f,new Map),Z(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Z(!this.listens.get(f).has(d),"listen() called twice for same path/queryId.");const p={onComplete:c,hashFn:r,query:t,tag:o};this.listens.get(f).set(d,p),this.connected_&&this.sendListen_(p)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,o=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(o)})}sendListen_(t){const r=t.query,o=r._path.toString(),c=r._queryIdentifier;this.log_("Listen on "+o+" for "+c);const d={p:o},f="q";t.tag&&(d.q=r._queryObject,d.t=t.tag),d.h=t.hashFn(),this.sendRequest(f,d,p=>{const g=p.d,x=p.s;Tn.warnOnListenWarnings_(g,r),(this.listens.get(o)&&this.listens.get(o).get(c))===t&&(this.log_("listen response",p),x!=="ok"&&this.removeListen_(o,c),t.onComplete&&t.onComplete(x,g))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&Mn(t,"w")){const o=ls(t,"w");if(Array.isArray(o)&&~o.indexOf("no_index")){const c='".indexOn": "'+r._queryParams.getIndex().toString()+'"',d=r._path.toString();Bt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${c} at ${d} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||Ux(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=qf)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=zx(t)?"auth":"gauth",o={cred:t};this.authOverride_===null?o.noauth=!0:typeof this.authOverride_=="object"&&(o.authvar=this.authOverride_),this.sendRequest(r,o,c=>{const d=c.s,f=c.d||"error";this.authToken_===t&&(d==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(d,f))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,o=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,o)})}unlisten(t,r){const o=t._path.toString(),c=t._queryIdentifier;this.log_("Unlisten called for "+o+" "+c),Z(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(o,c)&&this.connected_&&this.sendUnlisten_(o,c,t._queryObject,r)}sendUnlisten_(t,r,o,c){this.log_("Unlisten on "+t+" for "+r);const d={p:t},f="n";c&&(d.q=o,d.t=c),this.sendRequest(f,d)}onDisconnectPut(t,r,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,o):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:o})}onDisconnectMerge(t,r,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,o):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:o})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,o,c){const d={p:r,d:o};this.log_("onDisconnect "+t,d),this.sendRequest(t,d,f=>{c&&setTimeout(()=>{c(f.s,f.d)},Math.floor(0))})}put(t,r,o,c){this.putInternal("p",t,r,o,c)}merge(t,r,o,c){this.putInternal("m",t,r,o,c)}putInternal(t,r,o,c,d){this.initConnection_();const f={p:r,d:o};d!==void 0&&(f.h=d),this.outstandingPuts_.push({action:t,request:f,onComplete:c}),this.outstandingPutCount_++;const p=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(p):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,o=this.outstandingPuts_[t].request,c=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,o,d=>{this.log_(r+" response",d),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),c&&c(d.s,d.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,o=>{if(o.s!=="ok"){const d=o.d;this.log_("reportStats","Error sending stats: "+d)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+bt(t));const r=t.r,o=this.requestCBHash_[r];o&&(delete this.requestCBHash_[r],o(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):Ec("Unrecognized action received from server: "+bt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){Z(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ei,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=ei,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>e1&&(this.reconnectDelay_=ei),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Zy)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),o=this.onRealtimeDisconnect_.bind(this),c=this.id+":"+Tn.nextConnectionId_++,d=this.lastSessionId;let f=!1,p=null;const g=function(){p?p.close():(f=!0,o())},x=function(y){Z(p,"sendRequest call when we're not connected not allowed."),p.sendRequest(y)};this.realtime_={close:g,sendRequest:x};const C=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[y,v]=await Promise.all([this.authTokenProvider_.getToken(C),this.appCheckTokenProvider_.getToken(C)]);f?Rt("getToken() completed but was canceled"):(Rt("getToken() completed. Creating connection."),this.authToken_=y&&y.accessToken,this.appCheckToken_=v&&v.token,p=new Qy(c,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,o,k=>{Bt(k+" ("+this.repoInfo_.toString()+")"),this.interrupt(t1)},d))}catch(y){this.log_("Failed to get token: "+y),f||(this.repoInfo_.nodeAdmin&&Bt(y),g())}}}interrupt(t){Rt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Rt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Cf(this.interruptReasons_)&&(this.reconnectDelay_=ei,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let o;r?o=r.map(d=>Yc(d)).join("$"):o="default";const c=this.removeListen_(t,o);c&&c.onComplete&&c.onComplete("permission_denied")}removeListen_(t,r){const o=new Ke(t).toString();let c;if(this.listens.has(o)){const d=this.listens.get(o);c=d.get(r),d.delete(r),d.size===0&&this.listens.delete(o)}else c=void 0;return c}onAuthRevoked_(t,r){Rt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Xf&&(this.reconnectDelay_=qf,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Rt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Xf&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";t["sdk."+r+"."+Ap.replace(/\./g,"-")]=1,Ep()?t["framework.cordova"]=1:Px()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Qo.getInstance().currentlyOnline();return Cf(this.interruptReasons_)&&t}}Tn.nextPersistentConnectionId_=0;Tn.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(t,r){this.name=t,this.node=r}static Wrap(t,r){return new Fe(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,r){const o=new Fe(as,t),c=new Fe(as,r);return this.compare(o,c)!==0}minPost(){return Fe.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ao;class d0 extends ll{static get __EMPTY_NODE(){return Ao}static set __EMPTY_NODE(t){Ao=t}compare(t,r){return hs(t.name,r.name)}isDefinedOn(t){throw ds("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,r){return!1}minPost(){return Fe.MIN}maxPost(){return new Fe(Sr,Ao)}makePost(t,r){return Z(typeof t=="string","KeyIndex indexValue must always be a string."),new Fe(t,Ao)}toString(){return".key"}}const is=new d0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(t,r,o,c,d=null){this.isReverse_=c,this.resultGenerator_=d,this.nodeStack_=[];let f=1;for(;!t.isEmpty();)if(t=t,f=r?o(t.key,r):1,c&&(f*=-1),f<0)this.isReverse_?t=t.left:t=t.right;else if(f===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),r;if(this.resultGenerator_?r=this.resultGenerator_(t.key,t.value):r={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return r}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class wt{constructor(t,r,o,c,d){this.key=t,this.value=r,this.color=o??wt.RED,this.left=c??Wt.EMPTY_NODE,this.right=d??Wt.EMPTY_NODE}copy(t,r,o,c,d){return new wt(t??this.key,r??this.value,o??this.color,c??this.left,d??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,o){let c=this;const d=o(t,c.key);return d<0?c=c.copy(null,null,null,c.left.insert(t,r,o),null):d===0?c=c.copy(null,r,null,null,null):c=c.copy(null,null,null,null,c.right.insert(t,r,o)),c.fixUp_()}removeMin_(){if(this.left.isEmpty())return Wt.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let o,c;if(o=this,r(t,o.key)<0)!o.left.isEmpty()&&!o.left.isRed_()&&!o.left.left.isRed_()&&(o=o.moveRedLeft_()),o=o.copy(null,null,null,o.left.remove(t,r),null);else{if(o.left.isRed_()&&(o=o.rotateRight_()),!o.right.isEmpty()&&!o.right.isRed_()&&!o.right.left.isRed_()&&(o=o.moveRedRight_()),r(t,o.key)===0){if(o.right.isEmpty())return Wt.EMPTY_NODE;c=o.right.min_(),o=o.copy(c.key,c.value,null,null,o.right.removeMin_())}o=o.copy(null,null,null,null,o.right.remove(t,r))}return o.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,wt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,wt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}wt.RED=!0;wt.BLACK=!1;class n1{copy(t,r,o,c,d){return this}insert(t,r,o){return new wt(t,r,null)}remove(t,r){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Wt{constructor(t,r=Wt.EMPTY_NODE){this.comparator_=t,this.root_=r}insert(t,r){return new Wt(this.comparator_,this.root_.insert(t,r,this.comparator_).copy(null,null,wt.BLACK,null,null))}remove(t){return new Wt(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,wt.BLACK,null,null))}get(t){let r,o=this.root_;for(;!o.isEmpty();){if(r=this.comparator_(t,o.key),r===0)return o.value;r<0?o=o.left:r>0&&(o=o.right)}return null}getPredecessorKey(t){let r,o=this.root_,c=null;for(;!o.isEmpty();)if(r=this.comparator_(t,o.key),r===0){if(o.left.isEmpty())return c?c.key:null;for(o=o.left;!o.right.isEmpty();)o=o.right;return o.key}else r<0?o=o.left:r>0&&(c=o,o=o.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new Fo(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,r){return new Fo(this.root_,t,this.comparator_,!1,r)}getReverseIteratorFrom(t,r){return new Fo(this.root_,t,this.comparator_,!0,r)}getReverseIterator(t){return new Fo(this.root_,null,this.comparator_,!0,t)}}Wt.EMPTY_NODE=new n1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r1(s,t){return hs(s.name,t.name)}function Jc(s,t){return hs(s,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tc;function s1(s){Tc=s}const h0=function(s){return typeof s=="number"?"number:"+Wp(s):"string:"+s},f0=function(s){if(s.isLeafNode()){const t=s.val();Z(typeof t=="string"||typeof t=="number"||typeof t=="object"&&Mn(t,".sv"),"Priority must be a string or number.")}else Z(s===Tc||s.isEmpty(),"priority of unexpected type.");Z(s===Tc||s.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kf;class _t{static set __childrenNodeConstructor(t){Kf=t}static get __childrenNodeConstructor(){return Kf}constructor(t,r=_t.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,Z(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),f0(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new _t(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:_t.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Ue(t)?this:Ae(t)===".priority"?this.priorityNode_:_t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:_t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const o=Ae(t);return o===null?r:r.isEmpty()&&o!==".priority"?this:(Z(o!==".priority"||rr(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(o,_t.__childrenNodeConstructor.EMPTY_NODE.updateChild(et(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+h0(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",r==="number"?t+=Wp(this.value_):t+=this.value_,this.lazyHash_=$p(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===_t.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof _t.__childrenNodeConstructor?-1:(Z(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,o=typeof this.value_,c=_t.VALUE_TYPE_ORDER.indexOf(r),d=_t.VALUE_TYPE_ORDER.indexOf(o);return Z(c>=0,"Unknown leaf type: "+r),Z(d>=0,"Unknown leaf type: "+o),c===d?o==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:d-c}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}_t.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let p0,m0;function i1(s){p0=s}function o1(s){m0=s}class l1 extends ll{compare(t,r){const o=t.node.getPriority(),c=r.node.getPriority(),d=o.compareTo(c);return d===0?hs(t.name,r.name):d}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,r){return!t.getPriority().equals(r.getPriority())}minPost(){return Fe.MIN}maxPost(){return new Fe(Sr,new _t("[PRIORITY-POST]",m0))}makePost(t,r){const o=p0(t);return new Fe(r,new _t("[PRIORITY-POST]",o))}toString(){return".priority"}}const at=new l1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1=Math.log(2);class c1{constructor(t){const r=d=>parseInt(Math.log(d)/a1,10),o=d=>parseInt(Array(d+1).join("1"),2);this.count=r(t+1),this.current_=this.count-1;const c=o(this.count);this.bits_=t+1&c}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const Go=function(s,t,r,o){s.sort(t);const c=function(g,x){const C=x-g;let y,v;if(C===0)return null;if(C===1)return y=s[g],v=r?r(y):y,new wt(v,y.node,wt.BLACK,null,null);{const k=parseInt(C/2,10)+g,D=c(g,k),B=c(k+1,x);return y=s[k],v=r?r(y):y,new wt(v,y.node,wt.BLACK,D,B)}},d=function(g){let x=null,C=null,y=s.length;const v=function(D,B){const ne=y-D,ce=y;y-=D;const ie=c(ne+1,ce),ke=s[ne],le=r?r(ke):ke;k(new wt(le,ke.node,B,null,ie))},k=function(D){x?(x.left=D,x=D):(C=D,x=D)};for(let D=0;D<g.count;++D){const B=g.nextBitIsOne(),ne=Math.pow(2,g.count-(D+1));B?v(ne,wt.BLACK):(v(ne,wt.BLACK),v(ne,wt.RED))}return C},f=new c1(s.length),p=d(f);return new Wt(o||t,p)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gc;const ts={};class In{static get Default(){return Z(ts&&at,"ChildrenNode.ts has not been loaded"),gc=gc||new In({".priority":ts},{".priority":at}),gc}constructor(t,r){this.indexes_=t,this.indexSet_=r}get(t){const r=ls(this.indexes_,t);if(!r)throw new Error("No index defined for "+t);return r instanceof Wt?r:null}hasIndex(t){return Mn(this.indexSet_,t.toString())}addIndex(t,r){Z(t!==is,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const o=[];let c=!1;const d=r.getIterator(Fe.Wrap);let f=d.getNext();for(;f;)c=c||t.isDefinedOn(f.node),o.push(f),f=d.getNext();let p;c?p=Go(o,t.getCompare()):p=ts;const g=t.toString(),x={...this.indexSet_};x[g]=t;const C={...this.indexes_};return C[g]=p,new In(C,x)}addToIndexes(t,r){const o=Wo(this.indexes_,(c,d)=>{const f=ls(this.indexSet_,d);if(Z(f,"Missing index implementation for "+d),c===ts)if(f.isDefinedOn(t.node)){const p=[],g=r.getIterator(Fe.Wrap);let x=g.getNext();for(;x;)x.name!==t.name&&p.push(x),x=g.getNext();return p.push(t),Go(p,f.getCompare())}else return ts;else{const p=r.get(t.name);let g=c;return p&&(g=g.remove(new Fe(t.name,p))),g.insert(t,t.node)}});return new In(o,this.indexSet_)}removeFromIndexes(t,r){const o=Wo(this.indexes_,c=>{if(c===ts)return c;{const d=r.get(t.name);return d?c.remove(new Fe(t.name,d)):c}});return new In(o,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ti;class Le{static get EMPTY_NODE(){return ti||(ti=new Le(new Wt(Jc),null,In.Default))}constructor(t,r,o){this.children_=t,this.priorityNode_=r,this.indexMap_=o,this.lazyHash_=null,this.priorityNode_&&f0(this.priorityNode_),this.children_.isEmpty()&&Z(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ti}updatePriority(t){return this.children_.isEmpty()?this:new Le(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{const r=this.children_.get(t);return r===null?ti:r}}getChild(t){const r=Ae(t);return r===null?this:this.getImmediateChild(r).getChild(et(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(Z(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{const o=new Fe(t,r);let c,d;r.isEmpty()?(c=this.children_.remove(t),d=this.indexMap_.removeFromIndexes(o,this.children_)):(c=this.children_.insert(t,r),d=this.indexMap_.addToIndexes(o,this.children_));const f=c.isEmpty()?ti:this.priorityNode_;return new Le(c,f,d)}}updateChild(t,r){const o=Ae(t);if(o===null)return r;{Z(Ae(t)!==".priority"||rr(t)===1,".priority must be the last token in a path");const c=this.getImmediateChild(o).updateChild(et(t),r);return this.updateImmediateChild(o,c)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let o=0,c=0,d=!0;if(this.forEachChild(at,(f,p)=>{r[f]=p.val(t),o++,d&&Le.INTEGER_REGEXP_.test(f)?c=Math.max(c,Number(f)):d=!1}),!t&&d&&c<2*o){const f=[];for(const p in r)f[p]=r[p];return f}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+h0(this.getPriority().val())+":"),this.forEachChild(at,(r,o)=>{const c=o.hash();c!==""&&(t+=":"+r+":"+c)}),this.lazyHash_=t===""?"":$p(t)}return this.lazyHash_}getPredecessorChildName(t,r,o){const c=this.resolveIndex_(o);if(c){const d=c.getPredecessorKey(new Fe(t,r));return d?d.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const o=r.minKey();return o&&o.name}else return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new Fe(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const o=r.maxKey();return o&&o.name}else return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new Fe(r,this.children_.get(r)):null}forEachChild(t,r){const o=this.resolveIndex_(t);return o?o.inorderTraversal(c=>r(c.name,c.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const o=this.resolveIndex_(r);if(o)return o.getIteratorFrom(t,c=>c);{const c=this.children_.getIteratorFrom(t.name,Fe.Wrap);let d=c.peek();for(;d!=null&&r.compare(d,t)<0;)c.getNext(),d=c.peek();return c}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const o=this.resolveIndex_(r);if(o)return o.getReverseIteratorFrom(t,c=>c);{const c=this.children_.getReverseIteratorFrom(t.name,Fe.Wrap);let d=c.peek();for(;d!=null&&r.compare(d,t)>0;)c.getNext(),d=c.peek();return c}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Ni?-1:0}withIndex(t){if(t===is||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new Le(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===is||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){const o=this.getIterator(at),c=r.getIterator(at);let d=o.getNext(),f=c.getNext();for(;d&&f;){if(d.name!==f.name||!d.node.equals(f.node))return!1;d=o.getNext(),f=c.getNext()}return d===null&&f===null}else return!1;else return!1}}resolveIndex_(t){return t===is?null:this.indexMap_.get(t.toString())}}Le.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class u1 extends Le{constructor(){super(new Wt(Jc),Le.EMPTY_NODE,In.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return Le.EMPTY_NODE}isEmpty(){return!1}}const Ni=new u1;Object.defineProperties(Fe,{MIN:{value:new Fe(as,Le.EMPTY_NODE)},MAX:{value:new Fe(Sr,Ni)}});d0.__EMPTY_NODE=Le.EMPTY_NODE;_t.__childrenNodeConstructor=Le;s1(Ni);o1(Ni);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d1=!0;function St(s,t=null){if(s===null)return Le.EMPTY_NODE;if(typeof s=="object"&&".priority"in s&&(t=s[".priority"]),Z(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof s=="object"&&".value"in s&&s[".value"]!==null&&(s=s[".value"]),typeof s!="object"||".sv"in s){const r=s;return new _t(r,St(t))}if(!(s instanceof Array)&&d1){const r=[];let o=!1;if(Ht(s,(f,p)=>{if(f.substring(0,1)!=="."){const g=St(p);g.isEmpty()||(o=o||!g.getPriority().isEmpty(),r.push(new Fe(f,g)))}}),r.length===0)return Le.EMPTY_NODE;const d=Go(r,r1,f=>f.name,Jc);if(o){const f=Go(r,at.getCompare());return new Le(d,St(t),new In({".priority":f},{".priority":at}))}else return new Le(d,St(t),In.Default)}else{let r=Le.EMPTY_NODE;return Ht(s,(o,c)=>{if(Mn(s,o)&&o.substring(0,1)!=="."){const d=St(c);(d.isLeafNode()||!d.isEmpty())&&(r=r.updateImmediateChild(o,d))}}),r.updatePriority(St(t))}}i1(St);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1 extends ll{constructor(t){super(),this.indexPath_=t,Z(!Ue(t)&&Ae(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,r){const o=this.extractChild(t.node),c=this.extractChild(r.node),d=o.compareTo(c);return d===0?hs(t.name,r.name):d}makePost(t,r){const o=St(t),c=Le.EMPTY_NODE.updateChild(this.indexPath_,o);return new Fe(r,c)}maxPost(){const t=Le.EMPTY_NODE.updateChild(this.indexPath_,Ni);return new Fe(Sr,t)}toString(){return a0(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f1 extends ll{compare(t,r){const o=t.node.compareTo(r.node);return o===0?hs(t.name,r.name):o}isDefinedOn(t){return!0}indexedValueChanged(t,r){return!t.equals(r)}minPost(){return Fe.MIN}maxPost(){return Fe.MAX}makePost(t,r){const o=St(t);return new Fe(r,o)}toString(){return".value"}}const p1=new f1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(s){return{type:"value",snapshotNode:s}}function cs(s,t){return{type:"child_added",snapshotNode:t,childName:s}}function pi(s,t){return{type:"child_removed",snapshotNode:t,childName:s}}function mi(s,t,r){return{type:"child_changed",snapshotNode:t,childName:s,oldSnap:r}}function m1(s,t){return{type:"child_moved",snapshotNode:t,childName:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(t){this.index_=t}updateChild(t,r,o,c,d,f){Z(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const p=t.getImmediateChild(r);return p.getChild(c).equals(o.getChild(c))&&p.isEmpty()===o.isEmpty()||(f!=null&&(o.isEmpty()?t.hasChild(r)?f.trackChildChange(pi(r,p)):Z(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):p.isEmpty()?f.trackChildChange(cs(r,o)):f.trackChildChange(mi(r,o,p))),t.isLeafNode()&&o.isEmpty())?t:t.updateImmediateChild(r,o).withIndex(this.index_)}updateFullNode(t,r,o){return o!=null&&(t.isLeafNode()||t.forEachChild(at,(c,d)=>{r.hasChild(c)||o.trackChildChange(pi(c,d))}),r.isLeafNode()||r.forEachChild(at,(c,d)=>{if(t.hasChild(c)){const f=t.getImmediateChild(c);f.equals(d)||o.trackChildChange(mi(c,d,f))}else o.trackChildChange(cs(c,d))})),r.withIndex(this.index_)}updatePriority(t,r){return t.isEmpty()?Le.EMPTY_NODE:t.updatePriority(r)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(t){this.indexedFilter_=new Zc(t.getIndex()),this.index_=t.getIndex(),this.startPost_=gi.getStartPost_(t),this.endPost_=gi.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const r=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,o=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return r&&o}updateChild(t,r,o,c,d,f){return this.matches(new Fe(r,o))||(o=Le.EMPTY_NODE),this.indexedFilter_.updateChild(t,r,o,c,d,f)}updateFullNode(t,r,o){r.isLeafNode()&&(r=Le.EMPTY_NODE);let c=r.withIndex(this.index_);c=c.updatePriority(Le.EMPTY_NODE);const d=this;return r.forEachChild(at,(f,p)=>{d.matches(new Fe(f,p))||(c=c.updateImmediateChild(f,Le.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,c,o)}updatePriority(t,r){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const r=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),r)}else return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const r=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),r)}else return t.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{constructor(t){this.withinDirectionalStart=r=>this.reverse_?this.withinEndPost(r):this.withinStartPost(r),this.withinDirectionalEnd=r=>this.reverse_?this.withinStartPost(r):this.withinEndPost(r),this.withinStartPost=r=>{const o=this.index_.compare(this.rangedFilter_.getStartPost(),r);return this.startIsInclusive_?o<=0:o<0},this.withinEndPost=r=>{const o=this.index_.compare(r,this.rangedFilter_.getEndPost());return this.endIsInclusive_?o<=0:o<0},this.rangedFilter_=new gi(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,r,o,c,d,f){return this.rangedFilter_.matches(new Fe(r,o))||(o=Le.EMPTY_NODE),t.getImmediateChild(r).equals(o)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,r,o,c,d,f):this.fullLimitUpdateChild_(t,r,o,d,f)}updateFullNode(t,r,o){let c;if(r.isLeafNode()||r.isEmpty())c=Le.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<r.numChildren()&&r.isIndexed(this.index_)){c=Le.EMPTY_NODE.withIndex(this.index_);let d;this.reverse_?d=r.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):d=r.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let f=0;for(;d.hasNext()&&f<this.limit_;){const p=d.getNext();if(this.withinDirectionalStart(p))if(this.withinDirectionalEnd(p))c=c.updateImmediateChild(p.name,p.node),f++;else break;else continue}}else{c=r.withIndex(this.index_),c=c.updatePriority(Le.EMPTY_NODE);let d;this.reverse_?d=c.getReverseIterator(this.index_):d=c.getIterator(this.index_);let f=0;for(;d.hasNext();){const p=d.getNext();f<this.limit_&&this.withinDirectionalStart(p)&&this.withinDirectionalEnd(p)?f++:c=c.updateImmediateChild(p.name,Le.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,c,o)}updatePriority(t,r){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,r,o,c,d){let f;if(this.reverse_){const y=this.index_.getCompare();f=(v,k)=>y(k,v)}else f=this.index_.getCompare();const p=t;Z(p.numChildren()===this.limit_,"");const g=new Fe(r,o),x=this.reverse_?p.getFirstChild(this.index_):p.getLastChild(this.index_),C=this.rangedFilter_.matches(g);if(p.hasChild(r)){const y=p.getImmediateChild(r);let v=c.getChildAfterChild(this.index_,x,this.reverse_);for(;v!=null&&(v.name===r||p.hasChild(v.name));)v=c.getChildAfterChild(this.index_,v,this.reverse_);const k=v==null?1:f(v,g);if(C&&!o.isEmpty()&&k>=0)return d!=null&&d.trackChildChange(mi(r,o,y)),p.updateImmediateChild(r,o);{d!=null&&d.trackChildChange(pi(r,y));const B=p.updateImmediateChild(r,Le.EMPTY_NODE);return v!=null&&this.rangedFilter_.matches(v)?(d!=null&&d.trackChildChange(cs(v.name,v.node)),B.updateImmediateChild(v.name,v.node)):B}}else return o.isEmpty()?t:C&&f(x,g)>=0?(d!=null&&(d.trackChildChange(pi(x.name,x.node)),d.trackChildChange(cs(r,o))),p.updateImmediateChild(r,o).updateImmediateChild(x.name,Le.EMPTY_NODE)):t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=at}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return Z(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Z(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:as}hasEnd(){return this.endSet_}getIndexEndValue(){return Z(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Z(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Sr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return Z(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===at}copy(){const t=new eu;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function x1(s){return s.loadsAllData()?new Zc(s.getIndex()):s.hasLimit()?new g1(s):new gi(s)}function Jf(s){const t={};if(s.isDefault())return t;let r;if(s.index_===at?r="$priority":s.index_===p1?r="$value":s.index_===is?r="$key":(Z(s.index_ instanceof h1,"Unrecognized index type!"),r=s.index_.toString()),t.orderBy=bt(r),s.startSet_){const o=s.startAfterSet_?"startAfter":"startAt";t[o]=bt(s.indexStartValue_),s.startNameSet_&&(t[o]+=","+bt(s.indexStartName_))}if(s.endSet_){const o=s.endBeforeSet_?"endBefore":"endAt";t[o]=bt(s.indexEndValue_),s.endNameSet_&&(t[o]+=","+bt(s.indexEndName_))}return s.limitSet_&&(s.isViewFromLeft()?t.limitToFirst=s.limit_:t.limitToLast=s.limit_),t}function Zf(s){const t={};if(s.startSet_&&(t.sp=s.indexStartValue_,s.startNameSet_&&(t.sn=s.indexStartName_),t.sin=!s.startAfterSet_),s.endSet_&&(t.ep=s.indexEndValue_,s.endNameSet_&&(t.en=s.indexEndName_),t.ein=!s.endBeforeSet_),s.limitSet_){t.l=s.limit_;let r=s.viewFrom_;r===""&&(s.isViewFromLeft()?r="l":r="r"),t.vf=r}return s.index_!==at&&(t.i=s.index_.toString()),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo extends i0{reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,r){return r!==void 0?"tag$"+r:(Z(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}constructor(t,r,o,c){super(),this.repoInfo_=t,this.onDataUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=c,this.log_=bi("p:rest:"),this.listens_={}}listen(t,r,o,c){const d=t._path.toString();this.log_("Listen called for "+d+" "+t._queryIdentifier);const f=qo.getListenId_(t,o),p={};this.listens_[f]=p;const g=Jf(t._queryParams);this.restRequest_(d+".json",g,(x,C)=>{let y=C;if(x===404&&(y=null,x=null),x===null&&this.onDataUpdate_(d,y,!1,o),ls(this.listens_,f)===p){let v;x?x===401?v="permission_denied":v="rest_error:"+x:v="ok",c(v,null)}})}unlisten(t,r){const o=qo.getListenId_(t,r);delete this.listens_[o]}get(t){const r=Jf(t._queryParams),o=t._path.toString(),c=new il;return this.restRequest_(o+".json",r,(d,f)=>{let p=f;d===404&&(p=null,d=null),d===null?(this.onDataUpdate_(o,p,!1,null),c.resolve(p)):c.reject(new Error(p))}),c.promise}refreshAuthToken(t){}restRequest_(t,r={},o){return r.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([c,d])=>{c&&c.accessToken&&(r.auth=c.accessToken),d&&d.token&&(r.ac=d.token);const f=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+Wx(r);this.log_("Sending REST request for "+f);const p=new XMLHttpRequest;p.onreadystatechange=()=>{if(o&&p.readyState===4){this.log_("REST Response for "+f+" received. status:",p.status,"response:",p.responseText);let g=null;if(p.status>=200&&p.status<300){try{g=ui(p.responseText)}catch{Bt("Failed to parse JSON response for "+f+": "+p.responseText)}o(null,g)}else p.status!==401&&p.status!==404&&Bt("Got unsuccessful REST response for "+f+" Status: "+p.status),o(p.status);o=null}},p.open("GET",f,!0),p.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1{constructor(){this.rootNode_=Le.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,r){this.rootNode_=this.rootNode_.updateChild(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xo(){return{value:null,children:new Map}}function x0(s,t,r){if(Ue(t))s.value=r,s.children.clear();else if(s.value!==null)s.value=s.value.updateChild(t,r);else{const o=Ae(t);s.children.has(o)||s.children.set(o,Xo());const c=s.children.get(o);t=et(t),x0(c,t,r)}}function Rc(s,t,r){s.value!==null?r(t,s.value):y1(s,(o,c)=>{const d=new Ke(t.toString()+"/"+o);Rc(c,d,r)})}function y1(s,t){s.children.forEach((r,o)=>{t(o,r)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),r={...t};return this.last_&&Ht(this.last_,(o,c)=>{r[o]=r[o]-c}),this.last_=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ep=10*1e3,w1=30*1e3,b1=300*1e3;class N1{constructor(t,r){this.server_=r,this.statsToReport_={},this.statsListener_=new _1(t);const o=ep+(w1-ep)*Math.random();oi(this.reportStats_.bind(this),Math.floor(o))}reportStats_(){const t=this.statsListener_.get(),r={};let o=!1;Ht(t,(c,d)=>{d>0&&Mn(this.statsToReport_,c)&&(r[c]=d,o=!0)}),o&&this.server_.reportStats(r),oi(this.reportStats_.bind(this),Math.floor(Math.random()*2*b1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pn;(function(s){s[s.OVERWRITE=0]="OVERWRITE",s[s.MERGE=1]="MERGE",s[s.ACK_USER_WRITE=2]="ACK_USER_WRITE",s[s.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(pn||(pn={}));function v0(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function tu(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function nu(s){return{fromUser:!1,fromServer:!0,queryId:s,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(t,r,o){this.path=t,this.affectedTree=r,this.revert=o,this.type=pn.ACK_USER_WRITE,this.source=v0()}operationForChild(t){if(Ue(this.path)){if(this.affectedTree.value!=null)return Z(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const r=this.affectedTree.subtree(new Ke(t));return new Ko(Ge(),r,this.revert)}}else return Z(Ae(this.path)===t,"operationForChild called for unrelated child."),new Ko(et(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(t,r){this.source=t,this.path=r,this.type=pn.LISTEN_COMPLETE}operationForChild(t){return Ue(this.path)?new xi(this.source,Ge()):new xi(this.source,et(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(t,r,o){this.source=t,this.path=r,this.snap=o,this.type=pn.OVERWRITE}operationForChild(t){return Ue(this.path)?new jr(this.source,Ge(),this.snap.getImmediateChild(t)):new jr(this.source,et(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(t,r,o){this.source=t,this.path=r,this.children=o,this.type=pn.MERGE}operationForChild(t){if(Ue(this.path)){const r=this.children.subtree(new Ke(t));return r.isEmpty()?null:r.value?new jr(this.source,Ge(),r.value):new vi(this.source,Ge(),r)}else return Z(Ae(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new vi(this.source,et(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(t,r,o){this.node_=t,this.fullyInitialized_=r,this.filtered_=o}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(Ue(t))return this.isFullyInitialized()&&!this.filtered_;const r=Ae(t);return this.isCompleteForChild(r)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function C1(s,t,r,o){const c=[],d=[];return t.forEach(f=>{f.type==="child_changed"&&s.index_.indexedValueChanged(f.oldSnap,f.snapshotNode)&&d.push(m1(f.childName,f.snapshotNode))}),ni(s,c,"child_removed",t,o,r),ni(s,c,"child_added",t,o,r),ni(s,c,"child_moved",d,o,r),ni(s,c,"child_changed",t,o,r),ni(s,c,"value",t,o,r),c}function ni(s,t,r,o,c,d){const f=o.filter(p=>p.type===r);f.sort((p,g)=>j1(s,p,g)),f.forEach(p=>{const g=S1(s,p,d);c.forEach(x=>{x.respondsTo(p.type)&&t.push(x.createEvent(g,s.query_))})})}function S1(s,t,r){return t.type==="value"||t.type==="child_removed"||(t.prevName=r.getPredecessorChildName(t.childName,t.snapshotNode,s.index_)),t}function j1(s,t,r){if(t.childName==null||r.childName==null)throw ds("Should only compare child_ events.");const o=new Fe(t.childName,t.snapshotNode),c=new Fe(r.childName,r.snapshotNode);return s.index_.compare(o,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function al(s,t){return{eventCache:s,serverCache:t}}function li(s,t,r,o){return al(new Er(t,r,o),s.serverCache)}function y0(s,t,r,o){return al(s.eventCache,new Er(t,r,o))}function Lc(s){return s.eventCache.isFullyInitialized()?s.eventCache.getNode():null}function Ir(s){return s.serverCache.isFullyInitialized()?s.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xc;const E1=()=>(xc||(xc=new Wt(fy)),xc);class rt{static fromObject(t){let r=new rt(null);return Ht(t,(o,c)=>{r=r.set(new Ke(o),c)}),r}constructor(t,r=E1()){this.value=t,this.children=r}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,r){if(this.value!=null&&r(this.value))return{path:Ge(),value:this.value};if(Ue(t))return null;{const o=Ae(t),c=this.children.get(o);if(c!==null){const d=c.findRootMostMatchingPathAndValue(et(t),r);return d!=null?{path:gt(new Ke(o),d.path),value:d.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(Ue(t))return this;{const r=Ae(t),o=this.children.get(r);return o!==null?o.subtree(et(t)):new rt(null)}}set(t,r){if(Ue(t))return new rt(r,this.children);{const o=Ae(t),d=(this.children.get(o)||new rt(null)).set(et(t),r),f=this.children.insert(o,d);return new rt(this.value,f)}}remove(t){if(Ue(t))return this.children.isEmpty()?new rt(null):new rt(null,this.children);{const r=Ae(t),o=this.children.get(r);if(o){const c=o.remove(et(t));let d;return c.isEmpty()?d=this.children.remove(r):d=this.children.insert(r,c),this.value===null&&d.isEmpty()?new rt(null):new rt(this.value,d)}else return this}}get(t){if(Ue(t))return this.value;{const r=Ae(t),o=this.children.get(r);return o?o.get(et(t)):null}}setTree(t,r){if(Ue(t))return r;{const o=Ae(t),d=(this.children.get(o)||new rt(null)).setTree(et(t),r);let f;return d.isEmpty()?f=this.children.remove(o):f=this.children.insert(o,d),new rt(this.value,f)}}fold(t){return this.fold_(Ge(),t)}fold_(t,r){const o={};return this.children.inorderTraversal((c,d)=>{o[c]=d.fold_(gt(t,c),r)}),r(t,this.value,o)}findOnPath(t,r){return this.findOnPath_(t,Ge(),r)}findOnPath_(t,r,o){const c=this.value?o(r,this.value):!1;if(c)return c;if(Ue(t))return null;{const d=Ae(t),f=this.children.get(d);return f?f.findOnPath_(et(t),gt(r,d),o):null}}foreachOnPath(t,r){return this.foreachOnPath_(t,Ge(),r)}foreachOnPath_(t,r,o){if(Ue(t))return this;{this.value&&o(r,this.value);const c=Ae(t),d=this.children.get(c);return d?d.foreachOnPath_(et(t),gt(r,c),o):new rt(null)}}foreach(t){this.foreach_(Ge(),t)}foreach_(t,r){this.children.inorderTraversal((o,c)=>{c.foreach_(gt(t,o),r)}),this.value&&r(t,this.value)}foreachChild(t){this.children.inorderTraversal((r,o)=>{o.value&&t(r,o.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(t){this.writeTree_=t}static empty(){return new mn(new rt(null))}}function ai(s,t,r){if(Ue(t))return new mn(new rt(r));{const o=s.writeTree_.findRootMostValueAndPath(t);if(o!=null){const c=o.path;let d=o.value;const f=Ut(c,t);return d=d.updateChild(f,r),new mn(s.writeTree_.set(c,d))}else{const c=new rt(r),d=s.writeTree_.setTree(t,c);return new mn(d)}}}function tp(s,t,r){let o=s;return Ht(r,(c,d)=>{o=ai(o,gt(t,c),d)}),o}function np(s,t){if(Ue(t))return mn.empty();{const r=s.writeTree_.setTree(t,new rt(null));return new mn(r)}}function Pc(s,t){return Tr(s,t)!=null}function Tr(s,t){const r=s.writeTree_.findRootMostValueAndPath(t);return r!=null?s.writeTree_.get(r.path).getChild(Ut(r.path,t)):null}function rp(s){const t=[],r=s.writeTree_.value;return r!=null?r.isLeafNode()||r.forEachChild(at,(o,c)=>{t.push(new Fe(o,c))}):s.writeTree_.children.inorderTraversal((o,c)=>{c.value!=null&&t.push(new Fe(o,c.value))}),t}function nr(s,t){if(Ue(t))return s;{const r=Tr(s,t);return r!=null?new mn(new rt(r)):new mn(s.writeTree_.subtree(t))}}function Mc(s){return s.writeTree_.isEmpty()}function us(s,t){return _0(Ge(),s.writeTree_,t)}function _0(s,t,r){if(t.value!=null)return r.updateChild(s,t.value);{let o=null;return t.children.inorderTraversal((c,d)=>{c===".priority"?(Z(d.value!==null,"Priority writes must always be leaf nodes"),o=d.value):r=_0(gt(s,c),d,r)}),!r.getChild(s).isEmpty()&&o!==null&&(r=r.updateChild(gt(s,".priority"),o)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ru(s,t){return k0(t,s)}function I1(s,t,r,o,c){Z(o>s.lastWriteId,"Stacking an older write on top of newer ones"),c===void 0&&(c=!0),s.allWrites.push({path:t,snap:r,writeId:o,visible:c}),c&&(s.visibleWrites=ai(s.visibleWrites,t,r)),s.lastWriteId=o}function T1(s,t){for(let r=0;r<s.allWrites.length;r++){const o=s.allWrites[r];if(o.writeId===t)return o}return null}function R1(s,t){const r=s.allWrites.findIndex(p=>p.writeId===t);Z(r>=0,"removeWrite called with nonexistent writeId.");const o=s.allWrites[r];s.allWrites.splice(r,1);let c=o.visible,d=!1,f=s.allWrites.length-1;for(;c&&f>=0;){const p=s.allWrites[f];p.visible&&(f>=r&&L1(p,o.path)?c=!1:fn(o.path,p.path)&&(d=!0)),f--}if(c){if(d)return P1(s),!0;if(o.snap)s.visibleWrites=np(s.visibleWrites,o.path);else{const p=o.children;Ht(p,g=>{s.visibleWrites=np(s.visibleWrites,gt(o.path,g))})}return!0}else return!1}function L1(s,t){if(s.snap)return fn(s.path,t);for(const r in s.children)if(s.children.hasOwnProperty(r)&&fn(gt(s.path,r),t))return!0;return!1}function P1(s){s.visibleWrites=w0(s.allWrites,M1,Ge()),s.allWrites.length>0?s.lastWriteId=s.allWrites[s.allWrites.length-1].writeId:s.lastWriteId=-1}function M1(s){return s.visible}function w0(s,t,r){let o=mn.empty();for(let c=0;c<s.length;++c){const d=s[c];if(t(d)){const f=d.path;let p;if(d.snap)fn(r,f)?(p=Ut(r,f),o=ai(o,p,d.snap)):fn(f,r)&&(p=Ut(f,r),o=ai(o,Ge(),d.snap.getChild(p)));else if(d.children){if(fn(r,f))p=Ut(r,f),o=tp(o,p,d.children);else if(fn(f,r))if(p=Ut(f,r),Ue(p))o=tp(o,Ge(),d.children);else{const g=ls(d.children,Ae(p));if(g){const x=g.getChild(et(p));o=ai(o,Ge(),x)}}}else throw ds("WriteRecord should have .snap or .children")}}return o}function b0(s,t,r,o,c){if(!o&&!c){const d=Tr(s.visibleWrites,t);if(d!=null)return d;{const f=nr(s.visibleWrites,t);if(Mc(f))return r;if(r==null&&!Pc(f,Ge()))return null;{const p=r||Le.EMPTY_NODE;return us(f,p)}}}else{const d=nr(s.visibleWrites,t);if(!c&&Mc(d))return r;if(!c&&r==null&&!Pc(d,Ge()))return null;{const f=function(x){return(x.visible||c)&&(!o||!~o.indexOf(x.writeId))&&(fn(x.path,t)||fn(t,x.path))},p=w0(s.allWrites,f,t),g=r||Le.EMPTY_NODE;return us(p,g)}}}function D1(s,t,r){let o=Le.EMPTY_NODE;const c=Tr(s.visibleWrites,t);if(c)return c.isLeafNode()||c.forEachChild(at,(d,f)=>{o=o.updateImmediateChild(d,f)}),o;if(r){const d=nr(s.visibleWrites,t);return r.forEachChild(at,(f,p)=>{const g=us(nr(d,new Ke(f)),p);o=o.updateImmediateChild(f,g)}),rp(d).forEach(f=>{o=o.updateImmediateChild(f.name,f.node)}),o}else{const d=nr(s.visibleWrites,t);return rp(d).forEach(f=>{o=o.updateImmediateChild(f.name,f.node)}),o}}function O1(s,t,r,o,c){Z(o||c,"Either existingEventSnap or existingServerSnap must exist");const d=gt(t,r);if(Pc(s.visibleWrites,d))return null;{const f=nr(s.visibleWrites,d);return Mc(f)?c.getChild(r):us(f,c.getChild(r))}}function A1(s,t,r,o){const c=gt(t,r),d=Tr(s.visibleWrites,c);if(d!=null)return d;if(o.isCompleteForChild(r)){const f=nr(s.visibleWrites,c);return us(f,o.getNode().getImmediateChild(r))}else return null}function F1(s,t){return Tr(s.visibleWrites,t)}function $1(s,t,r,o,c,d,f){let p;const g=nr(s.visibleWrites,t),x=Tr(g,Ge());if(x!=null)p=x;else if(r!=null)p=us(g,r);else return[];if(p=p.withIndex(f),!p.isEmpty()&&!p.isLeafNode()){const C=[],y=f.getCompare(),v=d?p.getReverseIteratorFrom(o,f):p.getIteratorFrom(o,f);let k=v.getNext();for(;k&&C.length<c;)y(k,o)!==0&&C.push(k),k=v.getNext();return C}else return[]}function z1(){return{visibleWrites:mn.empty(),allWrites:[],lastWriteId:-1}}function Jo(s,t,r,o){return b0(s.writeTree,s.treePath,t,r,o)}function su(s,t){return D1(s.writeTree,s.treePath,t)}function sp(s,t,r,o){return O1(s.writeTree,s.treePath,t,r,o)}function Zo(s,t){return F1(s.writeTree,gt(s.treePath,t))}function U1(s,t,r,o,c,d){return $1(s.writeTree,s.treePath,t,r,o,c,d)}function iu(s,t,r){return A1(s.writeTree,s.treePath,t,r)}function N0(s,t){return k0(gt(s.treePath,t),s.writeTree)}function k0(s,t){return{treePath:s,writeTree:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(){this.changeMap=new Map}trackChildChange(t){const r=t.type,o=t.childName;Z(r==="child_added"||r==="child_changed"||r==="child_removed","Only child changes supported for tracking"),Z(o!==".priority","Only non-priority child changes can be tracked.");const c=this.changeMap.get(o);if(c){const d=c.type;if(r==="child_added"&&d==="child_removed")this.changeMap.set(o,mi(o,t.snapshotNode,c.snapshotNode));else if(r==="child_removed"&&d==="child_added")this.changeMap.delete(o);else if(r==="child_removed"&&d==="child_changed")this.changeMap.set(o,pi(o,c.oldSnap));else if(r==="child_changed"&&d==="child_added")this.changeMap.set(o,cs(o,t.snapshotNode));else if(r==="child_changed"&&d==="child_changed")this.changeMap.set(o,mi(o,t.snapshotNode,c.oldSnap));else throw ds("Illegal combination of changes: "+t+" occurred after "+c)}else this.changeMap.set(o,t)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1{getCompleteChild(t){return null}getChildAfterChild(t,r,o){return null}}const C0=new B1;class ou{constructor(t,r,o=null){this.writes_=t,this.viewCache_=r,this.optCompleteServerCache_=o}getCompleteChild(t){const r=this.viewCache_.eventCache;if(r.isCompleteForChild(t))return r.getNode().getImmediateChild(t);{const o=this.optCompleteServerCache_!=null?new Er(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return iu(this.writes_,t,o)}}getChildAfterChild(t,r,o){const c=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ir(this.viewCache_),d=U1(this.writes_,c,r,1,o,t);return d.length===0?null:d[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H1(s){return{filter:s}}function V1(s,t){Z(t.eventCache.getNode().isIndexed(s.filter.getIndex()),"Event snap not indexed"),Z(t.serverCache.getNode().isIndexed(s.filter.getIndex()),"Server snap not indexed")}function Y1(s,t,r,o,c){const d=new W1;let f,p;if(r.type===pn.OVERWRITE){const x=r;x.source.fromUser?f=Dc(s,t,x.path,x.snap,o,c,d):(Z(x.source.fromServer,"Unknown source."),p=x.source.tagged||t.serverCache.isFiltered()&&!Ue(x.path),f=el(s,t,x.path,x.snap,o,c,p,d))}else if(r.type===pn.MERGE){const x=r;x.source.fromUser?f=G1(s,t,x.path,x.children,o,c,d):(Z(x.source.fromServer,"Unknown source."),p=x.source.tagged||t.serverCache.isFiltered(),f=Oc(s,t,x.path,x.children,o,c,p,d))}else if(r.type===pn.ACK_USER_WRITE){const x=r;x.revert?f=K1(s,t,x.path,o,c,d):f=q1(s,t,x.path,x.affectedTree,o,c,d)}else if(r.type===pn.LISTEN_COMPLETE)f=X1(s,t,r.path,o,d);else throw ds("Unknown operation type: "+r.type);const g=d.getChanges();return Q1(t,f,g),{viewCache:f,changes:g}}function Q1(s,t,r){const o=t.eventCache;if(o.isFullyInitialized()){const c=o.getNode().isLeafNode()||o.getNode().isEmpty(),d=Lc(s);(r.length>0||!s.eventCache.isFullyInitialized()||c&&!o.getNode().equals(d)||!o.getNode().getPriority().equals(d.getPriority()))&&r.push(g0(Lc(t)))}}function S0(s,t,r,o,c,d){const f=t.eventCache;if(Zo(o,r)!=null)return t;{let p,g;if(Ue(r))if(Z(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const x=Ir(t),C=x instanceof Le?x:Le.EMPTY_NODE,y=su(o,C);p=s.filter.updateFullNode(t.eventCache.getNode(),y,d)}else{const x=Jo(o,Ir(t));p=s.filter.updateFullNode(t.eventCache.getNode(),x,d)}else{const x=Ae(r);if(x===".priority"){Z(rr(r)===1,"Can't have a priority with additional path components");const C=f.getNode();g=t.serverCache.getNode();const y=sp(o,r,C,g);y!=null?p=s.filter.updatePriority(C,y):p=f.getNode()}else{const C=et(r);let y;if(f.isCompleteForChild(x)){g=t.serverCache.getNode();const v=sp(o,r,f.getNode(),g);v!=null?y=f.getNode().getImmediateChild(x).updateChild(C,v):y=f.getNode().getImmediateChild(x)}else y=iu(o,x,t.serverCache);y!=null?p=s.filter.updateChild(f.getNode(),x,y,C,c,d):p=f.getNode()}}return li(t,p,f.isFullyInitialized()||Ue(r),s.filter.filtersNodes())}}function el(s,t,r,o,c,d,f,p){const g=t.serverCache;let x;const C=f?s.filter:s.filter.getIndexedFilter();if(Ue(r))x=C.updateFullNode(g.getNode(),o,null);else if(C.filtersNodes()&&!g.isFiltered()){const k=g.getNode().updateChild(r,o);x=C.updateFullNode(g.getNode(),k,null)}else{const k=Ae(r);if(!g.isCompleteForPath(r)&&rr(r)>1)return t;const D=et(r),ne=g.getNode().getImmediateChild(k).updateChild(D,o);k===".priority"?x=C.updatePriority(g.getNode(),ne):x=C.updateChild(g.getNode(),k,ne,D,C0,null)}const y=y0(t,x,g.isFullyInitialized()||Ue(r),C.filtersNodes()),v=new ou(c,y,d);return S0(s,y,r,c,v,p)}function Dc(s,t,r,o,c,d,f){const p=t.eventCache;let g,x;const C=new ou(c,t,d);if(Ue(r))x=s.filter.updateFullNode(t.eventCache.getNode(),o,f),g=li(t,x,!0,s.filter.filtersNodes());else{const y=Ae(r);if(y===".priority")x=s.filter.updatePriority(t.eventCache.getNode(),o),g=li(t,x,p.isFullyInitialized(),p.isFiltered());else{const v=et(r),k=p.getNode().getImmediateChild(y);let D;if(Ue(v))D=o;else{const B=C.getCompleteChild(y);B!=null?l0(v)===".priority"&&B.getChild(c0(v)).isEmpty()?D=B:D=B.updateChild(v,o):D=Le.EMPTY_NODE}if(k.equals(D))g=t;else{const B=s.filter.updateChild(p.getNode(),y,D,v,C,f);g=li(t,B,p.isFullyInitialized(),s.filter.filtersNodes())}}}return g}function ip(s,t){return s.eventCache.isCompleteForChild(t)}function G1(s,t,r,o,c,d,f){let p=t;return o.foreach((g,x)=>{const C=gt(r,g);ip(t,Ae(C))&&(p=Dc(s,p,C,x,c,d,f))}),o.foreach((g,x)=>{const C=gt(r,g);ip(t,Ae(C))||(p=Dc(s,p,C,x,c,d,f))}),p}function op(s,t,r){return r.foreach((o,c)=>{t=t.updateChild(o,c)}),t}function Oc(s,t,r,o,c,d,f,p){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let g=t,x;Ue(r)?x=o:x=new rt(null).setTree(r,o);const C=t.serverCache.getNode();return x.children.inorderTraversal((y,v)=>{if(C.hasChild(y)){const k=t.serverCache.getNode().getImmediateChild(y),D=op(s,k,v);g=el(s,g,new Ke(y),D,c,d,f,p)}}),x.children.inorderTraversal((y,v)=>{const k=!t.serverCache.isCompleteForChild(y)&&v.value===null;if(!C.hasChild(y)&&!k){const D=t.serverCache.getNode().getImmediateChild(y),B=op(s,D,v);g=el(s,g,new Ke(y),B,c,d,f,p)}}),g}function q1(s,t,r,o,c,d,f){if(Zo(c,r)!=null)return t;const p=t.serverCache.isFiltered(),g=t.serverCache;if(o.value!=null){if(Ue(r)&&g.isFullyInitialized()||g.isCompleteForPath(r))return el(s,t,r,g.getNode().getChild(r),c,d,p,f);if(Ue(r)){let x=new rt(null);return g.getNode().forEachChild(is,(C,y)=>{x=x.set(new Ke(C),y)}),Oc(s,t,r,x,c,d,p,f)}else return t}else{let x=new rt(null);return o.foreach((C,y)=>{const v=gt(r,C);g.isCompleteForPath(v)&&(x=x.set(C,g.getNode().getChild(v)))}),Oc(s,t,r,x,c,d,p,f)}}function X1(s,t,r,o,c){const d=t.serverCache,f=y0(t,d.getNode(),d.isFullyInitialized()||Ue(r),d.isFiltered());return S0(s,f,r,o,C0,c)}function K1(s,t,r,o,c,d){let f;if(Zo(o,r)!=null)return t;{const p=new ou(o,t,c),g=t.eventCache.getNode();let x;if(Ue(r)||Ae(r)===".priority"){let C;if(t.serverCache.isFullyInitialized())C=Jo(o,Ir(t));else{const y=t.serverCache.getNode();Z(y instanceof Le,"serverChildren would be complete if leaf node"),C=su(o,y)}C=C,x=s.filter.updateFullNode(g,C,d)}else{const C=Ae(r);let y=iu(o,C,t.serverCache);y==null&&t.serverCache.isCompleteForChild(C)&&(y=g.getImmediateChild(C)),y!=null?x=s.filter.updateChild(g,C,y,et(r),p,d):t.eventCache.getNode().hasChild(C)?x=s.filter.updateChild(g,C,Le.EMPTY_NODE,et(r),p,d):x=g,x.isEmpty()&&t.serverCache.isFullyInitialized()&&(f=Jo(o,Ir(t)),f.isLeafNode()&&(x=s.filter.updateFullNode(x,f,d)))}return f=t.serverCache.isFullyInitialized()||Zo(o,Ge())!=null,li(t,x,f,s.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{constructor(t,r){this.query_=t,this.eventRegistrations_=[];const o=this.query_._queryParams,c=new Zc(o.getIndex()),d=x1(o);this.processor_=H1(d);const f=r.serverCache,p=r.eventCache,g=c.updateFullNode(Le.EMPTY_NODE,f.getNode(),null),x=d.updateFullNode(Le.EMPTY_NODE,p.getNode(),null),C=new Er(g,f.isFullyInitialized(),c.filtersNodes()),y=new Er(x,p.isFullyInitialized(),d.filtersNodes());this.viewCache_=al(y,C),this.eventGenerator_=new k1(this.query_)}get query(){return this.query_}}function Z1(s){return s.viewCache_.serverCache.getNode()}function e_(s,t){const r=Ir(s.viewCache_);return r&&(s.query._queryParams.loadsAllData()||!Ue(t)&&!r.getImmediateChild(Ae(t)).isEmpty())?r.getChild(t):null}function lp(s){return s.eventRegistrations_.length===0}function t_(s,t){s.eventRegistrations_.push(t)}function ap(s,t,r){const o=[];if(r){Z(t==null,"A cancel should cancel all event registrations.");const c=s.query._path;s.eventRegistrations_.forEach(d=>{const f=d.createCancelEvent(r,c);f&&o.push(f)})}if(t){let c=[];for(let d=0;d<s.eventRegistrations_.length;++d){const f=s.eventRegistrations_[d];if(!f.matches(t))c.push(f);else if(t.hasAnyCallback()){c=c.concat(s.eventRegistrations_.slice(d+1));break}}s.eventRegistrations_=c}else s.eventRegistrations_=[];return o}function cp(s,t,r,o){t.type===pn.MERGE&&t.source.queryId!==null&&(Z(Ir(s.viewCache_),"We should always have a full cache before handling merges"),Z(Lc(s.viewCache_),"Missing event cache, even though we have a server cache"));const c=s.viewCache_,d=Y1(s.processor_,c,t,r,o);return V1(s.processor_,d.viewCache),Z(d.viewCache.serverCache.isFullyInitialized()||!c.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),s.viewCache_=d.viewCache,j0(s,d.changes,d.viewCache.eventCache.getNode(),null)}function n_(s,t){const r=s.viewCache_.eventCache,o=[];return r.getNode().isLeafNode()||r.getNode().forEachChild(at,(d,f)=>{o.push(cs(d,f))}),r.isFullyInitialized()&&o.push(g0(r.getNode())),j0(s,o,r.getNode(),t)}function j0(s,t,r,o){const c=o?[o]:s.eventRegistrations_;return C1(s.eventGenerator_,t,r,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tl;class r_{constructor(){this.views=new Map}}function s_(s){Z(!tl,"__referenceConstructor has already been defined"),tl=s}function i_(){return Z(tl,"Reference.ts has not been loaded"),tl}function o_(s){return s.views.size===0}function lu(s,t,r,o){const c=t.source.queryId;if(c!==null){const d=s.views.get(c);return Z(d!=null,"SyncTree gave us an op for an invalid query."),cp(d,t,r,o)}else{let d=[];for(const f of s.views.values())d=d.concat(cp(f,t,r,o));return d}}function l_(s,t,r,o,c){const d=t._queryIdentifier,f=s.views.get(d);if(!f){let p=Jo(r,c?o:null),g=!1;p?g=!0:o instanceof Le?(p=su(r,o),g=!1):(p=Le.EMPTY_NODE,g=!1);const x=al(new Er(p,g,!1),new Er(o,c,!1));return new J1(t,x)}return f}function a_(s,t,r,o,c,d){const f=l_(s,t,o,c,d);return s.views.has(t._queryIdentifier)||s.views.set(t._queryIdentifier,f),t_(f,r),n_(f,r)}function c_(s,t,r,o){const c=t._queryIdentifier,d=[];let f=[];const p=sr(s);if(c==="default")for(const[g,x]of s.views.entries())f=f.concat(ap(x,r,o)),lp(x)&&(s.views.delete(g),x.query._queryParams.loadsAllData()||d.push(x.query));else{const g=s.views.get(c);g&&(f=f.concat(ap(g,r,o)),lp(g)&&(s.views.delete(c),g.query._queryParams.loadsAllData()||d.push(g.query)))}return p&&!sr(s)&&d.push(new(i_())(t._repo,t._path)),{removed:d,events:f}}function E0(s){const t=[];for(const r of s.views.values())r.query._queryParams.loadsAllData()||t.push(r);return t}function os(s,t){let r=null;for(const o of s.views.values())r=r||e_(o,t);return r}function I0(s,t){if(t._queryParams.loadsAllData())return cl(s);{const o=t._queryIdentifier;return s.views.get(o)}}function T0(s,t){return I0(s,t)!=null}function sr(s){return cl(s)!=null}function cl(s){for(const t of s.views.values())if(t.query._queryParams.loadsAllData())return t;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nl;function u_(s){Z(!nl,"__referenceConstructor has already been defined"),nl=s}function d_(){return Z(nl,"Reference.ts has not been loaded"),nl}let h_=1;class up{constructor(t){this.listenProvider_=t,this.syncPointTree_=new rt(null),this.pendingWriteTree_=z1(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function R0(s,t,r,o,c){return I1(s.pendingWriteTree_,t,r,o,c),c?ki(s,new jr(v0(),t,r)):[]}function Cr(s,t,r=!1){const o=T1(s.pendingWriteTree_,t);if(R1(s.pendingWriteTree_,t)){let d=new rt(null);return o.snap!=null?d=d.set(Ge(),!0):Ht(o.children,f=>{d=d.set(new Ke(f),!0)}),ki(s,new Ko(o.path,d,r))}else return[]}function ul(s,t,r){return ki(s,new jr(tu(),t,r))}function f_(s,t,r){const o=rt.fromObject(r);return ki(s,new vi(tu(),t,o))}function p_(s,t){return ki(s,new xi(tu(),t))}function m_(s,t,r){const o=cu(s,r);if(o){const c=uu(o),d=c.path,f=c.queryId,p=Ut(d,t),g=new xi(nu(f),p);return du(s,d,g)}else return[]}function Ac(s,t,r,o,c=!1){const d=t._path,f=s.syncPointTree_.get(d);let p=[];if(f&&(t._queryIdentifier==="default"||T0(f,t))){const g=c_(f,t,r,o);o_(f)&&(s.syncPointTree_=s.syncPointTree_.remove(d));const x=g.removed;if(p=g.events,!c){const C=x.findIndex(v=>v._queryParams.loadsAllData())!==-1,y=s.syncPointTree_.findOnPath(d,(v,k)=>sr(k));if(C&&!y){const v=s.syncPointTree_.subtree(d);if(!v.isEmpty()){const k=v_(v);for(let D=0;D<k.length;++D){const B=k[D],ne=B.query,ce=M0(s,B);s.listenProvider_.startListening(ci(ne),rl(s,ne),ce.hashFn,ce.onComplete)}}}!y&&x.length>0&&!o&&(C?s.listenProvider_.stopListening(ci(t),null):x.forEach(v=>{const k=s.queryToTagMap.get(dl(v));s.listenProvider_.stopListening(ci(v),k)}))}y_(s,x)}return p}function g_(s,t,r,o){const c=cu(s,o);if(c!=null){const d=uu(c),f=d.path,p=d.queryId,g=Ut(f,t),x=new jr(nu(p),g,r);return du(s,f,x)}else return[]}function x_(s,t,r,o){const c=cu(s,o);if(c){const d=uu(c),f=d.path,p=d.queryId,g=Ut(f,t),x=rt.fromObject(r),C=new vi(nu(p),g,x);return du(s,f,C)}else return[]}function dp(s,t,r,o=!1){const c=t._path;let d=null,f=!1;s.syncPointTree_.foreachOnPath(c,(v,k)=>{const D=Ut(v,c);d=d||os(k,D),f=f||sr(k)});let p=s.syncPointTree_.get(c);p?(f=f||sr(p),d=d||os(p,Ge())):(p=new r_,s.syncPointTree_=s.syncPointTree_.set(c,p));let g;d!=null?g=!0:(g=!1,d=Le.EMPTY_NODE,s.syncPointTree_.subtree(c).foreachChild((k,D)=>{const B=os(D,Ge());B&&(d=d.updateImmediateChild(k,B))}));const x=T0(p,t);if(!x&&!t._queryParams.loadsAllData()){const v=dl(t);Z(!s.queryToTagMap.has(v),"View does not exist, but we have a tag");const k=__();s.queryToTagMap.set(v,k),s.tagToQueryMap.set(k,v)}const C=ru(s.pendingWriteTree_,c);let y=a_(p,t,r,C,d,g);if(!x&&!f&&!o){const v=I0(p,t);y=y.concat(w_(s,t,v))}return y}function au(s,t,r){const c=s.pendingWriteTree_,d=s.syncPointTree_.findOnPath(t,(f,p)=>{const g=Ut(f,t),x=os(p,g);if(x)return x});return b0(c,t,d,r,!0)}function ki(s,t){return L0(t,s.syncPointTree_,null,ru(s.pendingWriteTree_,Ge()))}function L0(s,t,r,o){if(Ue(s.path))return P0(s,t,r,o);{const c=t.get(Ge());r==null&&c!=null&&(r=os(c,Ge()));let d=[];const f=Ae(s.path),p=s.operationForChild(f),g=t.children.get(f);if(g&&p){const x=r?r.getImmediateChild(f):null,C=N0(o,f);d=d.concat(L0(p,g,x,C))}return c&&(d=d.concat(lu(c,s,o,r))),d}}function P0(s,t,r,o){const c=t.get(Ge());r==null&&c!=null&&(r=os(c,Ge()));let d=[];return t.children.inorderTraversal((f,p)=>{const g=r?r.getImmediateChild(f):null,x=N0(o,f),C=s.operationForChild(f);C&&(d=d.concat(P0(C,p,g,x)))}),c&&(d=d.concat(lu(c,s,o,r))),d}function M0(s,t){const r=t.query,o=rl(s,r);return{hashFn:()=>(Z1(t)||Le.EMPTY_NODE).hash(),onComplete:c=>{if(c==="ok")return o?m_(s,r._path,o):p_(s,r._path);{const d=gy(c,r);return Ac(s,r,null,d)}}}}function rl(s,t){const r=dl(t);return s.queryToTagMap.get(r)}function dl(s){return s._path.toString()+"$"+s._queryIdentifier}function cu(s,t){return s.tagToQueryMap.get(t)}function uu(s){const t=s.indexOf("$");return Z(t!==-1&&t<s.length-1,"Bad queryKey."),{queryId:s.substr(t+1),path:new Ke(s.substr(0,t))}}function du(s,t,r){const o=s.syncPointTree_.get(t);Z(o,"Missing sync point for query tag that we're tracking");const c=ru(s.pendingWriteTree_,t);return lu(o,r,c,null)}function v_(s){return s.fold((t,r,o)=>{if(r&&sr(r))return[cl(r)];{let c=[];return r&&(c=E0(r)),Ht(o,(d,f)=>{c=c.concat(f)}),c}})}function ci(s){return s._queryParams.loadsAllData()&&!s._queryParams.isDefault()?new(d_())(s._repo,s._path):s}function y_(s,t){for(let r=0;r<t.length;++r){const o=t[r];if(!o._queryParams.loadsAllData()){const c=dl(o),d=s.queryToTagMap.get(c);s.queryToTagMap.delete(c),s.tagToQueryMap.delete(d)}}}function __(){return h_++}function w_(s,t,r){const o=t._path,c=rl(s,t),d=M0(s,r),f=s.listenProvider_.startListening(ci(t),c,d.hashFn,d.onComplete),p=s.syncPointTree_.subtree(o);if(c)Z(!sr(p.value),"If we're adding a query, it shouldn't be shadowed");else{const g=p.fold((x,C,y)=>{if(!Ue(x)&&C&&sr(C))return[cl(C).query];{let v=[];return C&&(v=v.concat(E0(C).map(k=>k.query))),Ht(y,(k,D)=>{v=v.concat(D)}),v}});for(let x=0;x<g.length;++x){const C=g[x];s.listenProvider_.stopListening(ci(C),rl(s,C))}}return f}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(t){this.node_=t}getImmediateChild(t){const r=this.node_.getImmediateChild(t);return new hu(r)}node(){return this.node_}}class fu{constructor(t,r){this.syncTree_=t,this.path_=r}getImmediateChild(t){const r=gt(this.path_,t);return new fu(this.syncTree_,r)}node(){return au(this.syncTree_,this.path_)}}const b_=function(s){return s=s||{},s.timestamp=s.timestamp||new Date().getTime(),s},hp=function(s,t,r){if(!s||typeof s!="object")return s;if(Z(".sv"in s,"Unexpected leaf node or priority contents"),typeof s[".sv"]=="string")return N_(s[".sv"],t,r);if(typeof s[".sv"]=="object")return k_(s[".sv"],t);Z(!1,"Unexpected server value: "+JSON.stringify(s,null,2))},N_=function(s,t,r){switch(s){case"timestamp":return r.timestamp;default:Z(!1,"Unexpected server value: "+s)}},k_=function(s,t,r){s.hasOwnProperty("increment")||Z(!1,"Unexpected server value: "+JSON.stringify(s,null,2));const o=s.increment;typeof o!="number"&&Z(!1,"Unexpected increment value: "+o);const c=t.node();if(Z(c!==null&&typeof c<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!c.isLeafNode())return o;const f=c.getValue();return typeof f!="number"?o:f+o},C_=function(s,t,r,o){return pu(t,new fu(r,s),o)},D0=function(s,t,r){return pu(s,new hu(t),r)};function pu(s,t,r){const o=s.getPriority().val(),c=hp(o,t.getImmediateChild(".priority"),r);let d;if(s.isLeafNode()){const f=s,p=hp(f.getValue(),t,r);return p!==f.getValue()||c!==f.getPriority().val()?new _t(p,St(c)):s}else{const f=s;return d=f,c!==f.getPriority().val()&&(d=d.updatePriority(new _t(c))),f.forEachChild(at,(p,g)=>{const x=pu(g,t.getImmediateChild(p),r);x!==g&&(d=d.updateImmediateChild(p,x))}),d}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(t="",r=null,o={children:{},childCount:0}){this.name=t,this.parent=r,this.node=o}}function gu(s,t){let r=t instanceof Ke?t:new Ke(t),o=s,c=Ae(r);for(;c!==null;){const d=ls(o.node.children,c)||{children:{},childCount:0};o=new mu(c,o,d),r=et(r),c=Ae(r)}return o}function ps(s){return s.node.value}function O0(s,t){s.node.value=t,Fc(s)}function A0(s){return s.node.childCount>0}function S_(s){return ps(s)===void 0&&!A0(s)}function hl(s,t){Ht(s.node.children,(r,o)=>{t(new mu(r,s,o))})}function F0(s,t,r,o){r&&t(s),hl(s,c=>{F0(c,t,!0)})}function j_(s,t,r){let o=s.parent;for(;o!==null;){if(t(o))return!0;o=o.parent}return!1}function Ci(s){return new Ke(s.parent===null?s.name:Ci(s.parent)+"/"+s.name)}function Fc(s){s.parent!==null&&E_(s.parent,s.name,s)}function E_(s,t,r){const o=S_(r),c=Mn(s.node.children,t);o&&c?(delete s.node.children[t],s.node.childCount--,Fc(s)):!o&&!c&&(s.node.children[t]=r.node,s.node.childCount++,Fc(s))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I_=/[\[\].#$\/\u0000-\u001F\u007F]/,T_=/[\[\].#$\u0000-\u001F\u007F]/,vc=10*1024*1024,$0=function(s){return typeof s=="string"&&s.length!==0&&!I_.test(s)},z0=function(s){return typeof s=="string"&&s.length!==0&&!T_.test(s)},R_=function(s){return s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),z0(s)},L_=function(s,t,r,o){xu(Hc(s,"value"),t,r)},xu=function(s,t,r){const o=r instanceof Ke?new qy(r,s):r;if(t===void 0)throw new Error(s+"contains undefined "+Nr(o));if(typeof t=="function")throw new Error(s+"contains a function "+Nr(o)+" with contents = "+t.toString());if(zp(t))throw new Error(s+"contains "+t.toString()+" "+Nr(o));if(typeof t=="string"&&t.length>vc/3&&ol(t)>vc)throw new Error(s+"contains a string greater than "+vc+" utf8 bytes "+Nr(o)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let c=!1,d=!1;if(Ht(t,(f,p)=>{if(f===".value")c=!0;else if(f!==".priority"&&f!==".sv"&&(d=!0,!$0(f)))throw new Error(s+" contains an invalid key ("+f+") "+Nr(o)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Xy(o,f),xu(s,p,o),Ky(o)}),c&&d)throw new Error(s+' contains ".value" child '+Nr(o)+" in addition to actual children.")}},U0=function(s,t,r,o){if(!z0(r))throw new Error(Hc(s,t)+'was an invalid path = "'+r+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},P_=function(s,t,r,o){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),U0(s,t,r)},W0=function(s,t){if(Ae(t)===".info")throw new Error(s+" failed = Can't modify data under /.info/")},M_=function(s,t){const r=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!$0(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||r.length!==0&&!R_(r))throw new Error(Hc(s,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D_{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function vu(s,t){let r=null;for(let o=0;o<t.length;o++){const c=t[o],d=c.getPath();r!==null&&!Xc(d,r.path)&&(s.eventLists_.push(r),r=null),r===null&&(r={events:[],path:d}),r.events.push(c)}r&&s.eventLists_.push(r)}function B0(s,t,r){vu(s,r),H0(s,o=>Xc(o,t))}function Pn(s,t,r){vu(s,r),H0(s,o=>fn(o,t)||fn(t,o))}function H0(s,t){s.recursionDepth_++;let r=!0;for(let o=0;o<s.eventLists_.length;o++){const c=s.eventLists_[o];if(c){const d=c.path;t(d)?(O_(s.eventLists_[o]),s.eventLists_[o]=null):r=!1}}r&&(s.eventLists_=[]),s.recursionDepth_--}function O_(s){for(let t=0;t<s.events.length;t++){const r=s.events[t];if(r!==null){s.events[t]=null;const o=r.getEventRunner();ii&&Rt("event: "+r.toString()),fs(o)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_="repo_interrupt",F_=25;class $_{constructor(t,r,o,c){this.repoInfo_=t,this.forceRestClient_=r,this.authTokenProvider_=o,this.appCheckProvider_=c,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new D_,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Xo(),this.transactionQueueTree_=new mu,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function z_(s,t,r){if(s.stats_=Gc(s.repoInfo_),s.forceRestClient_||_y())s.server_=new qo(s.repoInfo_,(o,c,d,f)=>{fp(s,o,c,d,f)},s.authTokenProvider_,s.appCheckProvider_),setTimeout(()=>pp(s,!0),0);else{if(typeof r<"u"&&r!==null){if(typeof r!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{bt(r)}catch(o){throw new Error("Invalid authOverride provided: "+o)}}s.persistentConnection_=new Tn(s.repoInfo_,t,(o,c,d,f)=>{fp(s,o,c,d,f)},o=>{pp(s,o)},o=>{W_(s,o)},s.authTokenProvider_,s.appCheckProvider_,r),s.server_=s.persistentConnection_}s.authTokenProvider_.addTokenChangeListener(o=>{s.server_.refreshAuthToken(o)}),s.appCheckProvider_.addTokenChangeListener(o=>{s.server_.refreshAppCheckToken(o.token)}),s.statsReporter_=Cy(s.repoInfo_,()=>new N1(s.stats_,s.server_)),s.infoData_=new v1,s.infoSyncTree_=new up({startListening:(o,c,d,f)=>{let p=[];const g=s.infoData_.getNode(o._path);return g.isEmpty()||(p=ul(s.infoSyncTree_,o._path,g),setTimeout(()=>{f("ok")},0)),p},stopListening:()=>{}}),_u(s,"connected",!1),s.serverSyncTree_=new up({startListening:(o,c,d,f)=>(s.server_.listen(o,d,c,(p,g)=>{const x=f(p,g);Pn(s.eventQueue_,o._path,x)}),[]),stopListening:(o,c)=>{s.server_.unlisten(o,c)}})}function U_(s){const r=s.infoData_.getNode(new Ke(".info/serverTimeOffset")).val()||0;return new Date().getTime()+r}function yu(s){return b_({timestamp:U_(s)})}function fp(s,t,r,o,c){s.dataUpdateCount++;const d=new Ke(t);r=s.interceptServerDataCallback_?s.interceptServerDataCallback_(t,r):r;let f=[];if(c)if(o){const g=Wo(r,x=>St(x));f=x_(s.serverSyncTree_,d,g,c)}else{const g=St(r);f=g_(s.serverSyncTree_,d,g,c)}else if(o){const g=Wo(r,x=>St(x));f=f_(s.serverSyncTree_,d,g)}else{const g=St(r);f=ul(s.serverSyncTree_,d,g)}let p=d;f.length>0&&(p=fl(s,d)),Pn(s.eventQueue_,p,f)}function pp(s,t){_u(s,"connected",t),t===!1&&H_(s)}function W_(s,t){Ht(t,(r,o)=>{_u(s,r,o)})}function _u(s,t,r){const o=new Ke("/.info/"+t),c=St(r);s.infoData_.updateSnapshot(o,c);const d=ul(s.infoSyncTree_,o,c);Pn(s.eventQueue_,o,d)}function V0(s){return s.nextWriteId_++}function B_(s,t,r,o,c){wu(s,"set",{path:t.toString(),value:r,priority:o});const d=yu(s),f=St(r,o),p=au(s.serverSyncTree_,t),g=D0(f,p,d),x=V0(s),C=R0(s.serverSyncTree_,t,g,x,!0);vu(s.eventQueue_,C),s.server_.put(t.toString(),f.val(!0),(v,k)=>{const D=v==="ok";D||Bt("set at "+t+" failed: "+v);const B=Cr(s.serverSyncTree_,x,!D);Pn(s.eventQueue_,t,B),G_(s,c,v,k)});const y=X0(s,t);fl(s,y),Pn(s.eventQueue_,y,[])}function H_(s){wu(s,"onDisconnectEvents");const t=yu(s),r=Xo();Rc(s.onDisconnect_,Ge(),(c,d)=>{const f=C_(c,d,s.serverSyncTree_,t);x0(r,c,f)});let o=[];Rc(r,Ge(),(c,d)=>{o=o.concat(ul(s.serverSyncTree_,c,d));const f=X0(s,c);fl(s,f)}),s.onDisconnect_=Xo(),Pn(s.eventQueue_,Ge(),o)}function V_(s,t,r){let o;Ae(t._path)===".info"?o=dp(s.infoSyncTree_,t,r):o=dp(s.serverSyncTree_,t,r),B0(s.eventQueue_,t._path,o)}function Y_(s,t,r){let o;Ae(t._path)===".info"?o=Ac(s.infoSyncTree_,t,r):o=Ac(s.serverSyncTree_,t,r),B0(s.eventQueue_,t._path,o)}function Q_(s){s.persistentConnection_&&s.persistentConnection_.interrupt(A_)}function wu(s,...t){let r="";s.persistentConnection_&&(r=s.persistentConnection_.id+":"),Rt(r,...t)}function G_(s,t,r,o){t&&fs(()=>{if(r==="ok")t(null);else{const c=(r||"error").toUpperCase();let d=c;o&&(d+=": "+o);const f=new Error(d);f.code=c,t(f)}})}function Y0(s,t,r){return au(s.serverSyncTree_,t,r)||Le.EMPTY_NODE}function bu(s,t=s.transactionQueueTree_){if(t||pl(s,t),ps(t)){const r=G0(s,t);Z(r.length>0,"Sending zero length transaction queue"),r.every(c=>c.status===0)&&q_(s,Ci(t),r)}else A0(t)&&hl(t,r=>{bu(s,r)})}function q_(s,t,r){const o=r.map(x=>x.currentWriteId),c=Y0(s,t,o);let d=c;const f=c.hash();for(let x=0;x<r.length;x++){const C=r[x];Z(C.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),C.status=1,C.retryCount++;const y=Ut(t,C.path);d=d.updateChild(y,C.currentOutputSnapshotRaw)}const p=d.val(!0),g=t;s.server_.put(g.toString(),p,x=>{wu(s,"transaction put response",{path:g.toString(),status:x});let C=[];if(x==="ok"){const y=[];for(let v=0;v<r.length;v++)r[v].status=2,C=C.concat(Cr(s.serverSyncTree_,r[v].currentWriteId)),r[v].onComplete&&y.push(()=>r[v].onComplete(null,!0,r[v].currentOutputSnapshotResolved)),r[v].unwatcher();pl(s,gu(s.transactionQueueTree_,t)),bu(s,s.transactionQueueTree_),Pn(s.eventQueue_,t,C);for(let v=0;v<y.length;v++)fs(y[v])}else{if(x==="datastale")for(let y=0;y<r.length;y++)r[y].status===3?r[y].status=4:r[y].status=0;else{Bt("transaction at "+g.toString()+" failed: "+x);for(let y=0;y<r.length;y++)r[y].status=4,r[y].abortReason=x}fl(s,t)}},f)}function fl(s,t){const r=Q0(s,t),o=Ci(r),c=G0(s,r);return X_(s,c,o),o}function X_(s,t,r){if(t.length===0)return;const o=[];let c=[];const f=t.filter(p=>p.status===0).map(p=>p.currentWriteId);for(let p=0;p<t.length;p++){const g=t[p],x=Ut(r,g.path);let C=!1,y;if(Z(x!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),g.status===4)C=!0,y=g.abortReason,c=c.concat(Cr(s.serverSyncTree_,g.currentWriteId,!0));else if(g.status===0)if(g.retryCount>=F_)C=!0,y="maxretry",c=c.concat(Cr(s.serverSyncTree_,g.currentWriteId,!0));else{const v=Y0(s,g.path,f);g.currentInputSnapshot=v;const k=t[p].update(v.val());if(k!==void 0){xu("transaction failed: Data returned ",k,g.path);let D=St(k);typeof k=="object"&&k!=null&&Mn(k,".priority")||(D=D.updatePriority(v.getPriority()));const ne=g.currentWriteId,ce=yu(s),ie=D0(D,v,ce);g.currentOutputSnapshotRaw=D,g.currentOutputSnapshotResolved=ie,g.currentWriteId=V0(s),f.splice(f.indexOf(ne),1),c=c.concat(R0(s.serverSyncTree_,g.path,ie,g.currentWriteId,g.applyLocally)),c=c.concat(Cr(s.serverSyncTree_,ne,!0))}else C=!0,y="nodata",c=c.concat(Cr(s.serverSyncTree_,g.currentWriteId,!0))}Pn(s.eventQueue_,r,c),c=[],C&&(t[p].status=2,(function(v){setTimeout(v,Math.floor(0))})(t[p].unwatcher),t[p].onComplete&&(y==="nodata"?o.push(()=>t[p].onComplete(null,!1,t[p].currentInputSnapshot)):o.push(()=>t[p].onComplete(new Error(y),!1,null))))}pl(s,s.transactionQueueTree_);for(let p=0;p<o.length;p++)fs(o[p]);bu(s,s.transactionQueueTree_)}function Q0(s,t){let r,o=s.transactionQueueTree_;for(r=Ae(t);r!==null&&ps(o)===void 0;)o=gu(o,r),t=et(t),r=Ae(t);return o}function G0(s,t){const r=[];return q0(s,t,r),r.sort((o,c)=>o.order-c.order),r}function q0(s,t,r){const o=ps(t);if(o)for(let c=0;c<o.length;c++)r.push(o[c]);hl(t,c=>{q0(s,c,r)})}function pl(s,t){const r=ps(t);if(r){let o=0;for(let c=0;c<r.length;c++)r[c].status!==2&&(r[o]=r[c],o++);r.length=o,O0(t,r.length>0?r:void 0)}hl(t,o=>{pl(s,o)})}function X0(s,t){const r=Ci(Q0(s,t)),o=gu(s.transactionQueueTree_,t);return j_(o,c=>{yc(s,c)}),yc(s,o),F0(o,c=>{yc(s,c)}),r}function yc(s,t){const r=ps(t);if(r){const o=[];let c=[],d=-1;for(let f=0;f<r.length;f++)r[f].status===3||(r[f].status===1?(Z(d===f-1,"All SENT items should be at beginning of queue."),d=f,r[f].status=3,r[f].abortReason="set"):(Z(r[f].status===0,"Unexpected transaction status in abort"),r[f].unwatcher(),c=c.concat(Cr(s.serverSyncTree_,r[f].currentWriteId,!0)),r[f].onComplete&&o.push(r[f].onComplete.bind(null,new Error("set"),!1,null))));d===-1?O0(t,void 0):r.length=d+1,Pn(s.eventQueue_,Ci(t),c);for(let f=0;f<o.length;f++)fs(o[f])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K_(s){let t="";const r=s.split("/");for(let o=0;o<r.length;o++)if(r[o].length>0){let c=r[o];try{c=decodeURIComponent(c.replace(/\+/g," "))}catch{}t+="/"+c}return t}function J_(s){const t={};s.charAt(0)==="?"&&(s=s.substring(1));for(const r of s.split("&")){if(r.length===0)continue;const o=r.split("=");o.length===2?t[decodeURIComponent(o[0])]=decodeURIComponent(o[1]):Bt(`Invalid query segment '${r}' in query '${s}'`)}return t}const mp=function(s,t){const r=Z_(s),o=r.namespace;r.domain==="firebase.com"&&Ln(r.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!o||o==="undefined")&&r.domain!=="localhost"&&Ln("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r.secure||dy();const c=r.scheme==="ws"||r.scheme==="wss";return{repoInfo:new Jp(r.host,r.secure,o,c,t,"",o!==r.subdomain),path:new Ke(r.pathString)}},Z_=function(s){let t="",r="",o="",c="",d="",f=!0,p="https",g=443;if(typeof s=="string"){let x=s.indexOf("//");x>=0&&(p=s.substring(0,x-1),s=s.substring(x+2));let C=s.indexOf("/");C===-1&&(C=s.length);let y=s.indexOf("?");y===-1&&(y=s.length),t=s.substring(0,Math.min(C,y)),C<y&&(c=K_(s.substring(C,y)));const v=J_(s.substring(Math.min(s.length,y)));x=t.indexOf(":"),x>=0?(f=p==="https"||p==="wss",g=parseInt(t.substring(x+1),10)):x=t.length;const k=t.slice(0,x);if(k.toLowerCase()==="localhost")r="localhost";else if(k.split(".").length<=2)r=k;else{const D=t.indexOf(".");o=t.substring(0,D).toLowerCase(),r=t.substring(D+1),d=o}"ns"in v&&(d=v.ns)}return{host:t,port:g,domain:r,subdomain:o,secure:f,scheme:p,pathString:c,namespace:d}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{constructor(t,r,o,c){this.eventType=t,this.eventRegistration=r,this.snapshot=o,this.prevName=c}getPath(){const t=this.snapshot.ref;return this.eventType==="value"?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+bt(this.snapshot.exportVal())}}class tw{constructor(t,r,o){this.eventRegistration=t,this.error=r,this.path=o}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(t,r){this.snapshotCallback=t,this.cancelCallback=r}onValue(t,r){this.snapshotCallback.call(null,t,r)}onCancel(t){return Z(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(t,r,o,c){this._repo=t,this._path=r,this._queryParams=o,this._orderByCalled=c}get key(){return Ue(this._path)?null:l0(this._path)}get ref(){return new ir(this._repo,this._path)}get _queryIdentifier(){const t=Zf(this._queryParams),r=Yc(t);return r==="{}"?"default":r}get _queryObject(){return Zf(this._queryParams)}isEqual(t){if(t=_i(t),!(t instanceof Nu))return!1;const r=this._repo===t._repo,o=Xc(this._path,t._path),c=this._queryIdentifier===t._queryIdentifier;return r&&o&&c}toJSON(){return this.toString()}toString(){return this._repo.toString()+Gy(this._path)}}class ir extends Nu{constructor(t,r){super(t,r,new eu,!1)}get parent(){const t=c0(this._path);return t===null?null:new ir(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}}class sl{constructor(t,r,o){this._node=t,this.ref=r,this._index=o}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const r=new Ke(t),o=$c(this.ref,t);return new sl(this._node.getChild(r),o,at)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(o,c)=>t(new sl(c,$c(this.ref,o),at)))}hasChild(t){const r=new Ke(t);return!this._node.getChild(r).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Nt(s,t){return s=_i(s),s._checkNotDeleted("ref"),t!==void 0?$c(s._root,t):s._root}function $c(s,t){return s=_i(s),Ae(s._path)===null?P_("child","path",t):U0("child","path",t),new ir(s._repo,gt(s._path,t))}function Si(s){return W0("remove",s._path),or(s,null)}function or(s,t){s=_i(s),W0("set",s._path),L_("set",t,s._path);const r=new il;return B_(s._repo,s._path,t,null,r.wrapCallback(()=>{})),r.promise}class ku{constructor(t){this.callbackContext=t}respondsTo(t){return t==="value"}createEvent(t,r){const o=r._queryParams.getIndex();return new ew("value",this,new sl(t.snapshotNode,new ir(r._repo,r._path),o))}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,r){return this.callbackContext.hasCancelCallback?new tw(this,t,r):null}matches(t){return t instanceof ku?!t.callbackContext||!this.callbackContext?!0:t.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function rw(s,t,r,o,c){const d=new nw(r,void 0),f=new ku(d);return V_(s._repo,s,f),()=>Y_(s._repo,s,f)}function ms(s,t,r,o){return rw(s,"value",t)}s_(ir);u_(ir);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sw="FIREBASE_DATABASE_EMULATOR_HOST",zc={};let iw=!1;function ow(s,t,r,o){const c=t.lastIndexOf(":"),d=t.substring(0,c),f=Bc(d);s.repoInfo_=new Jp(t,f,s.repoInfo_.namespace,s.repoInfo_.webSocketOnly,s.repoInfo_.nodeAdmin,s.repoInfo_.persistenceKey,s.repoInfo_.includeNamespaceInQueryParams,!0,r),o&&(s.authTokenProvider_=o)}function lw(s,t,r,o,c){let d=o||s.options.databaseURL;d===void 0&&(s.options.projectId||Ln("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Rt("Using default host for project ",s.options.projectId),d=`${s.options.projectId}-default-rtdb.firebaseio.com`);let f=mp(d,c),p=f.repoInfo,g;typeof process<"u"&&Df&&(g=Df[sw]),g?(d=`http://${g}?ns=${p.namespace}`,f=mp(d,c),p=f.repoInfo):f.repoInfo.secure;const x=new by(s.name,s.options,t);M_("Invalid Firebase Database URL",f),Ue(f.path)||Ln("Database URL must point to the root of a Firebase Database (not including a child path).");const C=cw(p,s,x,new wy(s,r));return new uw(C,s)}function aw(s,t){const r=zc[t];(!r||r[s.key]!==s)&&Ln(`Database ${t}(${s.repoInfo_}) has already been deleted.`),Q_(s),delete r[s.key]}function cw(s,t,r,o){let c=zc[t.name];c||(c={},zc[t.name]=c);let d=c[s.toURLString()];return d&&Ln("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),d=new $_(s,iw,r,o),c[s.toURLString()]=d,d}class uw{constructor(t,r){this._repoInternal=t,this.app=r,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(z_(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ir(this._repo,Ge())),this._rootInternal}_delete(){return this._rootInternal!==null&&(aw(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&Ln("Cannot call "+t+" on a deleted database.")}}function dw(s=Yv(),t){const r=Uv(s,"database").getImmediate({identifier:t});if(!r._instanceStarted){const o=Sx("database");o&&hw(r,...o)}return r}function hw(s,t,r,o={}){s=_i(s),s._checkNotDeleted("useEmulator");const c=`${t}:${r}`,d=s._repoInternal;if(s._instanceStarted){if(c===s._repoInternal.repoInfo_.host&&Bo(o,d.repoInfo_.emulatorOptions))return;Ln("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let f;if(d.repoInfo_.nodeAdmin)o.mockUserToken&&Ln('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),f=new $o($o.OWNER);else if(o.mockUserToken){const p=typeof o.mockUserToken=="string"?o.mockUserToken:Ex(o.mockUserToken,s.app.options.projectId);f=new $o(p)}Bc(t)&&(jx(t),Rx("Database",!0)),ow(d,c,o,f)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fw(s){iy(Vv),Vo(new di("database",(t,{instanceIdentifier:r})=>{const o=t.getProvider("app").getImmediate(),c=t.getProvider("auth-internal"),d=t.getProvider("app-check-internal");return lw(o,c,d,r)},"PUBLIC").setMultipleInstances(!0)),rs(Of,Af,s),rs(Of,Af,"esm2020")}Tn.prototype.simpleListen=function(s,t){this.sendRequest("q",{p:s},t)};Tn.prototype.echo=function(s,t){this.sendRequest("echo",{d:s},t)};fw();const pw={apiKey:"AIzaSyCIA80U-Nb235O5SG_2d1TzdylvYQrzNUc",authDomain:"razlom-db061.firebaseapp.com",projectId:"razlom-db061",storageBucket:"razlom-db061.firebasestorage.app",messagingSenderId:"343432819418",appId:"1:343432819418:web:73f0fedc8a5e5a32912be3",measurementId:"G-EPLQFH5LMJ",databaseURL:"https://razlom-db061-default-rtdb.firebaseio.com"};let gp,We;try{gp=Mp(pw),We=dw(gp),console.log("Firebase initialized successfully (RTDB only)")}catch(s){console.error("Firebase init error:",s)}const ji=s=>{if(!s)return[];const t=Array.isArray(s)?s:Object.values(s),r=new Map;return t.forEach(o=>{o&&typeof o=="object"&&o.id&&r.set(o.id,o)}),Array.from(r.values())},ri=s=>(s||[]).reduce((t,r)=>(r&&r.id&&(t[r.id]=r),t),{}),mw=(s,t)=>{if(!We)return()=>{};const r=Nt(We,`rooms/${s}/characters`);return ms(r,o=>{t(ji(o.val()))})},gw=(s,t)=>{if(!We)return()=>{};const r=Nt(We,`rooms/${s}/realms`);return ms(r,o=>{t(ji(o.val()))})},xw=(s,t)=>{if(!We)return()=>{};const r=Nt(We,`rooms/${s}/worlds`);return ms(r,o=>{t(ji(o.val()))})},vw=(s,t)=>{if(!We)return()=>{};const r=Nt(We,`rooms/${s}/notes`);return ms(r,o=>{t(ji(o.val()))})},yw=(s,t)=>{if(!We)return()=>{};const r=Nt(We,`rooms/${s}/rpSessions`);return ms(r,o=>{t(ji(o.val()))})},xp=(s,t,r=!1)=>{if(!We)return()=>{};const c=Nt(We,`rooms/${s}/${r?"availableHiddenTags":"availableTags"}`);return ms(c,d=>{const f=d.val();t(Array.isArray(f)?f:[])})},_w=async(s,t)=>{if(!We)return;const r=Nt(We,`rooms/${s}`),o={...t,characters:ri(t.characters),realms:ri(t.realms),worlds:ri(t.worlds),notes:ri(t.notes),rpSessions:ri(t.rpSessions)};try{await or(r,o)}catch(c){console.error("Firebase write error:",c)}},ww=async(s,t)=>{if(!We||!t.id)return;const r=Nt(We,`rooms/${s}/characters/${t.id}`);try{await or(r,t)}catch(o){console.error("Error saving character:",o)}},bw=async(s,t)=>{if(!We)return;const r=Nt(We,`rooms/${s}/characters/${t}`);try{await Si(r)}catch(o){console.error("Error deleting character:",o)}},Nw=async(s,t)=>{if(!We||!t.id)return;const r=Nt(We,`rooms/${s}/realms/${t.id}`);try{await or(r,t)}catch(o){console.error(o)}},kw=async(s,t)=>{if(!We)return;const r=Nt(We,`rooms/${s}/realms/${t}`);try{await Si(r)}catch(o){console.error(o)}},Cw=async(s,t)=>{if(!We||!t.id)return;const r=Nt(We,`rooms/${s}/worlds/${t.id}`);try{await or(r,t)}catch(o){console.error(o)}},Sw=async(s,t)=>{if(!We)return;const r=Nt(We,`rooms/${s}/worlds/${t}`);try{await Si(r)}catch(o){console.error(o)}},jw=async(s,t)=>{if(!We||!t.id)return;const r=Nt(We,`rooms/${s}/notes/${t.id}`);try{await or(r,t)}catch(o){console.error(o)}},Ew=async(s,t)=>{if(!We)return;const r=Nt(We,`rooms/${s}/notes/${t}`);try{await Si(r)}catch(o){console.error(o)}},Iw=async(s,t)=>{if(!We||!t.id)return;const r=Nt(We,`rooms/${s}/rpSessions/${t.id}`);try{await or(r,t)}catch(o){console.error(o)}},Tw=async(s,t)=>{if(!We)return;const r=Nt(We,`rooms/${s}/rpSessions/${t}`);try{await Si(r)}catch(o){console.error(o)}},vp=async(s,t,r=!1)=>{if(!We)return;const c=Nt(We,`rooms/${s}/${r?"availableHiddenTags":"availableTags"}`);try{await or(c,t)}catch(d){console.error("Error saving tags:",d)}},yp="rp_haven_master_data_v3",ht="global_chronicles_main",zt=(s,t=[])=>Array.isArray(s)?s:t,Rw=()=>{const[s,t]=F.useState("characters"),[r,o]=F.useState(null),[c,d]=F.useState(""),[f,p]=F.useState({}),[g,x]=F.useState(!1),[C,y]=F.useState(!1),[v,k]=F.useState(null),[D,B]=F.useState(!1),[ne,ce]=F.useState(!1),[ie,ke]=F.useState(!0);F.useEffect(()=>{window.scrollTo(0,0)},[s,r]);const[le,Oe]=F.useState(!1),[K,M]=F.useState(ac),[L,_e]=F.useState(()=>{const O=localStorage.getItem(yp);if(O)try{const A=JSON.parse(O);return{characters:zt(A.characters,ac),realms:zt(A.realms),worlds:zt(A.worlds),notes:zt(A.notes),availableTags:zt(A.availableTags,wf),availableHiddenTags:zt(A.availableHiddenTags,bf),rpSessions:zt(A.rpSessions)}}catch(A){console.error("Failed to parse storage",A)}return{characters:ac,realms:[],worlds:[],notes:[],availableTags:wf,availableHiddenTags:bf,rpSessions:[]}});F.useEffect(()=>{M(L.characters)},[L.characters]),F.useEffect(()=>{if(ie){const O=mw(ht,R=>_e(Q=>({...Q,characters:R}))),A=gw(ht,R=>_e(Q=>({...Q,realms:R}))),U=xw(ht,R=>_e(Q=>({...Q,worlds:R}))),we=vw(ht,R=>_e(Q=>({...Q,notes:R}))),Se=yw(ht,R=>_e(Q=>({...Q,rpSessions:R}))),qe=xp(ht,R=>_e(Q=>({...Q,availableTags:R})),!1),ft=xp(ht,R=>_e(Q=>({...Q,availableHiddenTags:R})),!0);return()=>{O(),A(),U(),we(),Se(),qe(),ft()}}},[ie]);const ae=()=>{const O=L.characters.filter(A=>{const U=A.name.toLowerCase().includes(c.toLowerCase()),we=Object.entries(f).every(([Se,qe])=>{const ft=(A.tags||[]).includes(Se)||(A.hiddenTags||[]).includes(Se);return qe==="include"?ft:qe==="exclude"?!ft:!0});return U&&we});Oe(!0),setTimeout(()=>{M(O),requestAnimationFrame(()=>{Oe(!1)})},600)};F.useEffect(()=>{ae()},[c,f,L.characters]);const Ce=O=>{_e(O),B(!0),setTimeout(()=>B(!1),2e3);try{const A=JSON.parse(JSON.stringify(O));A.characters.forEach(U=>{U.imageUrl&&U.imageUrl.startsWith("data:")&&(U.imageUrl="")}),A.worlds.forEach(U=>{U.imageUrl&&U.imageUrl.startsWith("data:")&&(U.imageUrl="")}),A.realms.forEach(U=>{U.imageUrl&&U.imageUrl.startsWith("data:")&&(U.imageUrl="")}),localStorage.setItem(yp,JSON.stringify(A))}catch(A){console.warn("Local storage quota exceeded.",A)}},ve=O=>{const A=L.characters.some(U=>U.id===O.id)?L.characters.map(U=>U.id===O.id?O:U):[...L.characters,O];Ce({...L,characters:A}),y(!1),k(null),ie&&ww(ht,O)},je=O=>{if(window.confirm("    ?")){const A=L.characters.filter(U=>U.id!==O);Ce({...L,characters:A}),r===O&&o(null),ie&&bw(ht,O)}},Qe=O=>{ie&&(O.forEach(A=>{const U=L.notes.find(we=>we.id===A.id);(!U||JSON.stringify(U)!==JSON.stringify(A))&&jw(ht,A)}),L.notes.forEach(A=>{O.find(U=>U.id===A.id)||Ew(ht,A.id)})),Ce({...L,notes:O})},Ee=O=>{ie&&(O.forEach(A=>{const U=L.realms.find(we=>we.id===A.id);(!U||JSON.stringify(U)!==JSON.stringify(A))&&Nw(ht,A)}),L.realms.forEach(A=>{O.find(U=>U.id===A.id)||kw(ht,A.id)})),Ce({...L,realms:O})},Be=O=>{ie&&(O.forEach(A=>{const U=L.worlds.find(we=>we.id===A.id);(!U||JSON.stringify(U)!==JSON.stringify(A))&&Cw(ht,A)}),L.worlds.forEach(A=>{O.find(U=>U.id===A.id)||Sw(ht,A.id)})),Ce({...L,worlds:O})},ee=O=>{ie&&(O.forEach(A=>{const U=L.rpSessions.find(we=>we.id===A.id);(!U||JSON.stringify(U)!==JSON.stringify(A))&&Iw(ht,A)}),L.rpSessions.forEach(A=>{O.find(U=>U.id===A.id)||Tw(ht,A.id)})),Ce({...L,rpSessions:O})},Y=O=>{Ce({...L,availableTags:O}),ie&&vp(ht,O,!1)},q=O=>{Ce({...L,availableHiddenTags:O}),ie&&vp(ht,O,!0)},w=O=>{p(A=>{const U=A[O]||"none";let we="none";U==="none"?we="include":U==="include"?we="exclude":we="none";const Se={...A};return we==="none"?delete Se[O]:Se[O]=we,Se})},$=()=>{d(""),p({})},te=O=>{o(O),t("characters")},he=Object.keys(f).length;return l.jsxs(nx,{activeTab:s,setActiveTab:O=>{t(O),o(null),p({})},isAdmin:g,onToggleAdmin:()=>x(!g),onOpenSync:()=>ce(!0),isSyncActive:ie,onDownloadDB:()=>{const O=new Blob([JSON.stringify(L,null,2)],{type:"application/json"}),A=URL.createObjectURL(O),U=document.createElement("a");U.href=A,U.download=`rp-vault-${new Date().toISOString().slice(0,10)}.json`,U.click()},onUploadDB:O=>{const A=JSON.parse(O);if(window.confirm("  ?")){const U={characters:zt(A.characters),realms:zt(A.realms),worlds:zt(A.worlds),notes:zt(A.notes),availableTags:zt(A.availableTags),availableHiddenTags:zt(A.availableHiddenTags),rpSessions:zt(A.rpSessions)};Ce(U),ie&&_w(ht,U)}},children:[l.jsx("div",{className:`fixed top-20 md:top-6 right-6 z-[90] transition-all duration-500 pointer-events-none ${D?"opacity-100 translate-y-0":"opacity-0 -translate-y-4"}`,children:l.jsx("div",{className:"bg-emerald-950/80 border border-emerald-500/30 backdrop-blur-2xl px-5 py-2.5 rounded-2xl flex items-center gap-3 shadow-2xl",children:l.jsx("span",{className:"text-[10px] uppercase tracking-[0.2em] font-black text-emerald-400",children:""})})}),ne&&l.jsx(mx,{isConnected:ie,onConnect:()=>ke(!0),onDisconnect:()=>ke(!1),onClose:()=>ce(!1)}),l.jsxs("div",{className:"animate-tab-switch",children:[s==="characters"&&l.jsx("div",{className:"space-y-8",children:r?l.jsx(lx,{character:L.characters.find(O=>O.id===r),isAdmin:g,allCharacters:L.characters,availableTags:L.availableTags,availableHiddenTags:L.availableHiddenTags,worlds:L.worlds,notes:L.notes,onBack:()=>o(null),onSave:ve,onSelectCharacter:te}):l.jsxs("div",{className:"animate-reveal-list space-y-8",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-6",children:[l.jsx("input",{type:"text",placeholder:"  ...",value:c,onChange:O=>d(O.target.value),className:"w-full bg-transparent border-b border-stone-900 text-3xl outline-none font-serif italic py-4"}),g&&l.jsx("button",{onClick:()=>{k(null),y(!0)},className:"bg-white text-black px-8 py-3.5 rounded-full text-[10px] uppercase font-black transition-all shadow-xl",children:" "})]}),(L.availableTags.length>0||L.availableHiddenTags.length>0)&&l.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-4 bg-[#0f0f0f]/30 border border-stone-900/50 rounded-2xl",children:[l.jsx("span",{className:"text-[9px] uppercase tracking-[0.2em] font-black text-stone-600 mr-2",children:":"}),L.availableTags.map(O=>{const A=f[O]||"none";return l.jsxs("button",{onClick:()=>w(O),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${A==="include"?"bg-emerald-500/10 border-emerald-500/40 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":A==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-stone-400 hover:border-stone-700"}`,children:[A==="include"&&l.jsx("span",{className:"text-emerald-500 font-black",children:"+"}),A==="exclude"&&l.jsx("span",{className:"text-red-500 font-black",children:""}),O]},O)}),L.availableHiddenTags.map(O=>{const A=f[O]||"none";return l.jsxs("button",{onClick:()=>w(O),className:`px-3 py-1.5 rounded-xl text-[9px] uppercase tracking-wider font-black transition-all border flex items-center gap-2 ${A==="include"?"bg-amber-500/10 border-amber-500/40 text-amber-400 shadow-[0_0_15px_rgba(245,158,11,0.1)]":A==="exclude"?"bg-red-500/10 border-red-500/40 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]":"bg-stone-950/30 border-stone-900/50 text-stone-700 hover:text-amber-500 hover:border-amber-900/30"}`,children:[A==="include"&&l.jsx("span",{className:"text-amber-500 font-black",children:"+"}),A==="exclude"&&l.jsx("span",{className:"text-red-500 font-black",children:""}),O]},O)}),(he>0||c)&&l.jsx("button",{onClick:$,className:"ml-auto text-[9px] uppercase tracking-[0.2em] font-black text-stone-700 hover:text-red-500 transition-colors",children:" "})]}),l.jsxs("div",{className:"flex flex-wrap -mx-5 relative min-h-[400px]",children:[K.map((O,A)=>l.jsx(sx,{character:O,isVisible:!le,staggerIndex:A,onClick:o},O.id)),K.length===0&&!le&&l.jsx("div",{className:"w-full py-20 text-center text-stone-700 italic font-serif animate-in fade-in duration-700",children:"       ..."})]})]})}),s==="connections"&&l.jsx(hx,{characters:L.characters,availableTags:L.availableTags,availableHiddenTags:L.availableHiddenTags,filterStates:f,onToggleTag:w,onClearFilters:()=>p({}),onSelectCharacter:te}),s==="roleplay"&&l.jsx(px,{sessions:L.rpSessions,characters:L.characters,onUpdate:ee,isAdmin:g}),s==="worlds"&&l.jsx(fx,{realms:L.realms,worlds:L.worlds,characters:L.characters,availableTags:L.availableTags,availableHiddenTags:L.availableHiddenTags,onUpdateRealms:Ee,onUpdateWorlds:Be,isAdmin:g}),s==="notes"&&l.jsx(ox,{notes:L.notes,characters:L.characters,availableTags:L.availableTags,availableHiddenTags:L.availableHiddenTags,onUpdate:Qe,isAdmin:g,onSelectCharacter:te}),s==="admin"&&g&&l.jsx(cx,{characters:L.characters,availableTags:L.availableTags,availableHiddenTags:L.availableHiddenTags,onDelete:je,onEdit:O=>{k(O),y(!0)},onAdd:()=>{k(null),y(!0)},onUpdateTags:Y,onUpdateHiddenTags:q,onDownloadDB:()=>{},onUploadDB:()=>{}})]}),C&&l.jsx(ax,{initialData:v,availableTags:L.availableTags,availableHiddenTags:L.availableHiddenTags,onSave:ve,onClose:()=>y(!1)})]})},K0=document.getElementById("root");if(!K0)throw new Error("Could not find root element to mount to");const Lw=tx.createRoot(K0);Lw.render(l.jsx(wp.StrictMode,{children:l.jsx(Rw,{})}));
